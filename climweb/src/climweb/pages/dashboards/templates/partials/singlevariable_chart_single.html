{% load wagtailiconchooser_tags wagtailcore_tags %}
<div class="columns my-4">
    {% if index|divisibleby:2 and singlevariable_chart.description %}
    <div class="column description-column mt-3">
        <h3 class="chart-title" style="color:{{page.banner_background_color}}">{{ singlevariable_chart.title|richtext }}</h3>
        {% if singlevariable_chart.area_desc %}<p class="chart-area">{{singlevariable_chart.area_desc}} </p>{% endif %}
        <p>{{ singlevariable_chart.description|richtext }}</p>
    </div>
    <div class="column chart-column is-half">
        <div class="card elevation-1">
            <header class="card-header elevation-0" style="align-items:center">
                <p class="card-header-title">
                    {% if singlevariable_chart.description %}
                    {{ singlevariable_chart.dataset.dataset.title }}

                    {% else %}
                    {{singlevariable_chart.title}}

                    {% endif %}
                </p>
                
                {% if singlevariable_chart.dataset.dataset.metadata %}
                <button
                    class="card-header-icon js-modal-trigger"
                    aria-label="more options"
                    data-target="modal-{{ section_index }}-{{ index }}"
                >
                    <div class="icon is-small">
                        {% svg_icon "info-circle" %}
                    </div>
                </button>
                {% endif %}
                {% if singlevariable_chart.dataset.dataset.published and singlevariable_chart.dataset.dataset.public %}
             
                            <a class="card-header-icon button is-small is-dark is-rounded" href="{{ singlevariable_chart.mapviewer_map_url }}" target="_blank" rel="noopener" style="border-radius: 20px !important; ">
                                <span class="icon is-small">{% svg_icon "layer-group" %}</span><span>Mapviewer</span>
                            </a>

                {% endif %} 
            </header>
            <div class="card-content">
                {% if singlevariable_chart.chart_type == "warm_stripes" %}
                <div
                    class="warming-stripes-chart"
                    id="warming-stripes-{{ section_index }}-{{ index }}-{{block_index}}"
                    data-layer-id="{{ singlevariable_chart.dataset.id }}"
                    data-geostore-id="{{ singlevariable_chart.geostore_id|stringformat:"s" }}"
                    data-gid0="{% if singlevariable_chart.gid0 %}{{ singlevariable_chart.gid0 }}{% else %}{% endif %}"
                    data-gid1="{% if singlevariable_chart.gid1 %}{{ singlevariable_chart.gid1 }}{% else %}{% endif %}"
                    data-gid2="{% if singlevariable_chart.gid2 %}{{ singlevariable_chart.gid2 }}{% else %}{% endif %}"
                    data-datetime-format="{{ singlevariable_chart.dataset.date_format|default:'yyyy-MM-dd HH:mm' }}"
                ></div>
                {% elif singlevariable_chart.chart_type == "rain_stripes" %}
                <div
                    class="rainfall-stripes-chart"
                    id="rainfall-stripes-{{ section_index }}-{{ index }}-{{block_index}}"
                    data-layer-id="{{ singlevariable_chart.dataset.id }}"
                    data-geostore-id="{{ singlevariable_chart.geostore_id|stringformat:"s" }}"
                    data-gid0="{% if singlevariable_chart.gid0 %}{{ singlevariable_chart.gid0 }}{% else %}{% endif %}"
                    data-gid1="{% if singlevariable_chart.gid1 %}{{ singlevariable_chart.gid1 }}{% else %}{% endif %}"
                    data-gid2="{% if singlevariable_chart.gid2 %}{{ singlevariable_chart.gid2 }}{% else %}{% endif %}"
                    data-datetime-format="{{ singlevariable_chart.dataset.date_format|default:'yyyy-MM-dd HH:mm' }}"
                ></div>
                {% else %}
                <div
                    class="chart-container"
                    id="chart-{{ section_index }}-{{ index }}-{{block_index}}"
                    data-layer-id="{{ singlevariable_chart.dataset.id }}"
                    data-title="{{ singlevariable_chart.title }}"
                    data-color="{{ singlevariable_chart.chart_color|default:'#0b76e1' }}"
                    data-unit="{{ singlevariable_chart.data_unit|default:'' }}"
                    data-type="{{ singlevariable_chart.chart_type|default:'line' }}"
                    data-area-desc="{{ singlevariable_chart.area_desc }}"
                    data-admin-level="{{ singlevariable_chart.admin_level }}"
                    data-geostore-id="{{ singlevariable_chart.geostore_id|stringformat:"s" }}"
                    data-gid0="{% if singlevariable_chart.gid0 %}{{ singlevariable_chart.gid0 }}{% else %}{% endif %}"
                    data-gid1="{% if singlevariable_chart.gid1 %}{{ singlevariable_chart.gid1 }}{% else %}{% endif %}"
                    data-gid2="{% if singlevariable_chart.gid2 %}{{ singlevariable_chart.gid2 }}{% else %}{% endif %}"
                    data-datetime-format="{{ singlevariable_chart.dataset.date_format|default:'yyyy-MM-dd HH:mm' }}"
                ></div>
                {% endif %}
            </div>
            <footer class="card-footer">
                <div style="width: 100%" class="m-2">
                     <div class="field is-grouped">
                        <div class="control">
                            <input
                                class="datepicker-input input is-small"
                                type="text"
                                placeholder="Start Date"
                                id="{% if singlevariable_chart.chart_type == 'warm_stripes' %}date-start-warming-stripes-{% elif singlevariable_chart.chart_type == 'rain_stripes' %}date-start-rainfall-stripes-{% else %}date-start-chart-{% endif %}{{ section_index }}-{{ index }}-{{block_index}}"
                            />
                            
                        </div>
                        <div class="control">
                            <input
                                class="datepicker-input input is-small"
                                type="text"
                                placeholder="End Date"
                                id="{% if singlevariable_chart.chart_type == 'warm_stripes' %}date-end-warming-stripes-{% elif singlevariable_chart.chart_type == 'rain_stripes' %}date-end-rainfall-stripes-{% else %}date-end-chart-{% endif %}{{ section_index }}-{{ index }}-{{block_index}}"
                            />
                            
                        </div>
                    </div>
                   
                    <div
                        class="params"
                        id="paramsContainer-chart-{{ section_index }}-{{ index }}-{{block_index}}"
                    ></div>
                </div>
            </footer>
        </div>
    </div>
    {% elif singlevariable_chart.description %}
    <div class="column chart-column is-half">
        <div class="card elevation-1">
            <header class="card-header elevation-0" style="align-items:center">
                <p class="card-header-title">
                    {% if singlevariable_chart.description %}
                    {{ singlevariable_chart.dataset.dataset.title }}

                    {% else %}
                    {{singlevariable_chart.title}}
                    {% endif %}
                </p>
                
                {% if singlevariable_chart.dataset.dataset.metadata %}
                <button
                    class="card-header-icon js-modal-trigger"
                    aria-label="more options"
                    data-target="modal-{{ section_index }}-{{ index }}-{{block_index}}"
                >
                    <div class="icon is-small">
                        {% svg_icon "info-circle" %}
                    </div>
                </button>
                {% endif %}
                {% if singlevariable_chart.dataset.dataset.published and singlevariable_chart.dataset.dataset.public %}
             
                    <a class="card-header-icon button is-small is-dark is-rounded" href="{{ singlevariable_chart.mapviewer_map_url }}" target="_blank" rel="noopener" style="border-radius: 20px !important; ">
                        <span class="icon is-small">{% svg_icon "layer-group" %}</span><span>Mapviewer</span>
                    </a>

                {% endif %} 
            </header>
            <div class="card-content">
                {% if singlevariable_chart.chart_type == "warm_stripes" %}
                <div
                    class="warming-stripes-chart"
                    id="warming-stripes-{{ section_index }}-{{ index }}-{{block_index}}"
                    data-layer-id="{{ singlevariable_chart.dataset.id }}"
                    data-geostore-id="{{ singlevariable_chart.geostore_id|stringformat:"s" }}"
                    data-gid0="{% if singlevariable_chart.gid0 %}{{ singlevariable_chart.gid0 }}{% else %}{% endif %}"
                    data-gid1="{% if singlevariable_chart.gid1 %}{{ singlevariable_chart.gid1 }}{% else %}{% endif %}"
                    data-gid2="{% if singlevariable_chart.gid2 %}{{ singlevariable_chart.gid2 }}{% else %}{% endif %}"
                    data-datetime-format="{{ singlevariable_chart.dataset.date_format|default:'yyyy-MM-dd HH:mm' }}"
                ></div>
                {% elif singlevariable_chart.chart_type == "rain_stripes" %}
                <div
                    class="rainfall-stripes-chart"
                    id="rainfall-stripes-{{ section_index }}-{{ index }}-{{block_index}}"
                    data-layer-id="{{ singlevariable_chart.dataset.id }}"
                    data-geostore-id="{{ singlevariable_chart.geostore_id|stringformat:"s" }}"
                    data-gid0="{% if singlevariable_chart.gid0 %}{{ singlevariable_chart.gid0 }}{% else %}{% endif %}"
                    data-gid1="{% if singlevariable_chart.gid1 %}{{ singlevariable_chart.gid1 }}{% else %}{% endif %}"
                    data-gid2="{% if singlevariable_chart.gid2 %}{{ singlevariable_chart.gid2 }}{% else %}{% endif %}"
                    data-datetime-format="{{ singlevariable_chart.dataset.date_format|default:'yyyy-MM-dd HH:mm' }}"
                ></div> 
                {% else %}
                <div
                    class="chart-container"
                    id="chart-{{ section_index }}-{{ index }}-{{block_index}}"
                    data-layer-id="{{ singlevariable_chart.dataset.id }}"
                    data-title="{{ singlevariable_chart.title }}"
                    data-color="{{ singlevariable_chart.chart_color|default:'#0b76e1' }}"
                    data-unit="{{ singlevariable_chart.data_unit|default:'' }}"
                    data-type="{{ singlevariable_chart.chart_type|default:'line' }}"
                    data-area-desc="{{ singlevariable_chart.area_desc }}"
                    data-admin-level="{{ singlevariable_chart.admin_level }}"
                    data-geostore-id="{{ singlevariable_chart.geostore_id|stringformat:"s" }}"
                    data-gid0="{% if singlevariable_chart.gid0 %}{{ singlevariable_chart.gid0 }}{% else %}{% endif %}"
                    data-gid1="{% if singlevariable_chart.gid1 %}{{ singlevariable_chart.gid1 }}{% else %}{% endif %}"
                    data-gid2="{% if singlevariable_chart.gid2 %}{{ singlevariable_chart.gid2 }}{% else %}{% endif %}"
                    data-datetime-format="{{ singlevariable_chart.dataset.date_format|default:'yyyy-MM-dd HH:mm' }}"
                ></div>
                {% endif %}
            </div>
            <footer class="card-footer">
                <div style="width: 100%" class="m-2">
                    <div class="field is-grouped">
                        <div class="control">
                            <input
                                class="datepicker-input input is-small"
                                type="text"
                                placeholder="Start Date"
                                id="{% if singlevariable_chart.chart_type == 'warm_stripes' %}date-start-warming-stripes-{% elif singlevariable_chart.chart_type == 'rain_stripes' %}date-start-rainfall-stripes-{% else %}date-start-chart-{% endif %}{{ section_index }}-{{ index }}-{{block_index}}"
                            />
                            
                        </div>
                        <div class="control">
                            <input
                                class="datepicker-input input is-small"
                                type="text"
                                placeholder="End Date"
                                id="{% if singlevariable_chart.chart_type == 'warm_stripes' %}date-end-warming-stripes-{% elif singlevariable_chart.chart_type == 'rain_stripes' %}date-end-rainfall-stripes-{% else %}date-end-chart-{% endif %}{{ section_index }}-{{ index }}-{{block_index}}"
                            />
                            
                        </div>
                    </div>
                    <div
                        class="params"
                        id="paramsContainer-chart-{{ section_index }}-{{ index }}-{{block_index}}"
                    ></div>
                </div>
            </footer>
        </div>
    </div>
    <div class="column description-column mt-3">
        <h3 class="chart-title" style="color:{{page.banner_background_color}}">{{ singlevariable_chart.title|richtext }}</h3>
        {% if singlevariable_chart.area_desc %}<p class="chart-area">{{singlevariable_chart.area_desc}} </p>{% endif %}
        <p>{{ singlevariable_chart.description|richtext }}</p>
    </div>
    {% else %}
    <div class="column chart-column">
        <div class="card elevation-1">
            <header class="card-header elevation-0" style="align-items:center">
                <p class="card-header-title">
                    {% if singlevariable_chart.description %}
                    {{ singlevariable_chart.dataset.dataset.title }}

                    {% else %}
                    {{singlevariable_chart.title}}

                    {% endif %}
                </p>
                
                {% if singlevariable_chart.dataset.dataset.metadata %}
                <button
                    class="card-header-icon js-modal-trigger"
                    aria-label="more options"
                    data-target="modal-{{ section_index }}-{{ index }}-{{block_index}}"
                >
                    <div class="icon is-small">
                        {% svg_icon "info-circle" %}
                    </div>
                </button>
                {% endif %}
                {% if singlevariable_chart.dataset.dataset.published and singlevariable_chart.dataset.dataset.public %}
             
                    <a class="card-header-icon button is-small is-dark is-rounded" href="{{ singlevariable_chart.mapviewer_map_url }}" target="_blank" rel="noopener" style="border-radius: 20px !important; ">
                        <span class="icon is-small">{% svg_icon "layer-group" %}</span><span>Mapviewer</span>
                    </a>

                {% endif %} 
            </header>
            <div class="card-content">
                {% if singlevariable_chart.chart_type == "warm_stripes" %}
                <div
                    class="warming-stripes-chart"
                    id="warming-stripes-{{ section_index }}-{{ index }}-{{block_index}}"
                    data-layer-id="{{ singlevariable_chart.dataset.id }}"
                    data-geostore-id="{{ singlevariable_chart.geostore_id|stringformat:"s" }}"
                    data-gid0="{% if singlevariable_chart.gid0 %}{{ singlevariable_chart.gid0 }}{% else %}{% endif %}"
                    data-gid1="{% if singlevariable_chart.gid1 %}{{ singlevariable_chart.gid1 }}{% else %}{% endif %}"
                    data-gid2="{% if singlevariable_chart.gid2 %}{{ singlevariable_chart.gid2 }}{% else %}{% endif %}"
                    data-datetime-format="{{ singlevariable_chart.dataset.date_format|default:'yyyy-MM-dd HH:mm' }}"
                ></div>
                {% elif singlevariable_chart.chart_type == "rain_stripes" %}
                <div
                    class="rainfall-stripes-chart"
                    id="rainfall-stripes-{{ section_index }}-{{ index }}-{{block_index}}"
                    data-layer-id="{{ singlevariable_chart.dataset.id }}"
                    data-geostore-id="{{ singlevariable_chart.geostore_id|stringformat:"s" }}"
                    data-gid0="{% if singlevariable_chart.gid0 %}{{ singlevariable_chart.gid0 }}{% else %}{% endif %}"
                    data-gid1="{% if singlevariable_chart.gid1 %}{{ singlevariable_chart.gid1 }}{% else %}{% endif %}"
                    data-gid2="{% if singlevariable_chart.gid2 %}{{ singlevariable_chart.gid2 }}{% else %}{% endif %}"
                    data-datetime-format="{{ singlevariable_chart.dataset.date_format|default:'yyyy-MM-dd HH:mm' }}"
                ></div>
                {% else %}
                <div
                    class="chart-container"
                    id="chart-{{ section_index }}-{{ index }}-{{block_index}}"
                    data-layer-id="{{ singlevariable_chart.dataset.id }}"
                    data-title="{{ singlevariable_chart.title }}"
                    data-color="{{ singlevariable_chart.chart_color|default:'#0b76e1' }}"
                    data-unit="{{ singlevariable_chart.data_unit|default:'' }}"
                    data-type="{{ singlevariable_chart.chart_type|default:'line' }}"
                    data-area-desc="{{ singlevariable_chart.area_desc }}"
                    data-admin-level="{{ singlevariable_chart.admin_level }}"
                    data-geostore-id="{{ singlevariable_chart.geostore_id|stringformat:"s" }}"
                    data-gid0="{% if singlevariable_chart.gid0 %}{{ singlevariable_chart.gid0 }}{% else %}{% endif %}"
                    data-gid1="{% if singlevariable_chart.gid1 %}{{ singlevariable_chart.gid1 }}{% else %}{% endif %}"
                    data-gid2="{% if singlevariable_chart.gid2 %}{{ singlevariable_chart.gid2 }}{% else %}{% endif %}"
                    data-datetime-format="{{ singlevariable_chart.dataset.date_format|default:'yyyy-MM-dd HH:mm' }}"
                ></div>
                {% endif %}
            </div>
            <footer class="card-footer">
                <div style="width: 100%" class="m-2">
                    <div class="field is-grouped">
                        <div class="control">
                            <input
                                class="datepicker-input input is-small"
                                type="text"
                                placeholder="Start Date"
                                id="{% if singlevariable_chart.chart_type == 'warm_stripes' %}date-start-warming-stripes-{% elif singlevariable_chart.chart_type == 'rain_stripes' %}date-start-rainfall-stripes-{% else %}date-start-chart-{% endif %}{{ section_index }}-{{ index }}-{{block_index}}"
                            />
                            
                        </div>
                        <div class="control">
                            <input
                                class="datepicker-input input is-small"
                                type="text"
                                placeholder="End Date"
                                id="{% if singlevariable_chart.chart_type == 'warm_stripes' %}date-end-warming-stripes-{% elif singlevariable_chart.chart_type == 'rain_stripes' %}date-end-rainfall-stripes-{% else %}date-end-chart-{% endif %}{{ section_index }}-{{ index }}-{{block_index}}"
                            />
                            
                        </div>
                    </div>
                     <div
                    class="params"
                    id="paramsContainer-chart-{{ section_index }}-{{ index }}-{{block_index}}"
                ></div>
                </div>
            </footer>
        </div>
    </div>
    {% endif %}

    {% include "partials/modal.html" with metadata=singlevariable_chart.dataset.dataset.metadata section=section_index index=index block_index=block_index %}

</div>
