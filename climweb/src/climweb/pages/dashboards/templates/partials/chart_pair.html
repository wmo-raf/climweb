{% load wagtailiconchooser_tags %}

<div class="columns is-multiline my-4">
    {% for chart in charts %}

    <div class="column is-half chart-column">
        <div class="card elevation-1">
            <header class="card-header elevation-0">
                <p class="card-header-title">
                    {{ chart.title }}{% if admin_level != 0 %} in
                    {{chart.area_desc}}{% endif %}
                </p>
                {% if chart.dataset.dataset.published and chart.dataset.dataset.public %}
                <a
                    class="card-header-icon"
                    aria-label="more options"
                    href="{{chart.mapviewer_map_url}}"
                    target="_blank"
                    rel="noopener"
                >
                    <div class="icon is-small">
                        {% svg_icon "layer-group" %}
                    </div>
                </a>
                {% endif %} 
                {% if chart.dataset.dataset.metadata %}
                <button
                    class="card-header-icon js-modal-trigger"
                    aria-label="more options"
                    data-target="modal-{{ section_index }}-{{ index|add:forloop.counter0 }}"
                >
                    <div class="icon is-small">
                        {% svg_icon "info-circle" %}
                    </div>
                </button>
                {% endif %}

            </header>
            <div class="card-content">
                {% if chart.chart_type == "stripes" %}
                <div
                    class="warming-stripes-chart"
                    id="stripes-{{ section_index }}-{{ index|add:forloop.counter0 }}"
                    data-layer-id="{{ chart.dataset.id }}"
                    data-geostore-id="{{ chart.geostore_id|stringformat:"s" }}"
                    data-gid0="{% if chart.gid0 %}{{ chart.gid0 }}{% else %}{% endif %}"
                    data-gid1="{% if chart.gid1 %}{{ chart.gid1 }}{% else %}{% endif %}"
                    data-gid2="{% if chart.gid2 %}{{ chart.gid2 }}{% else %}{% endif %}"
                    data-datetime-format="{{ chart.dataset.date_format|default:'yyyy-MM-dd HH:mm' }}"
                ></div>
                {% else %}
                <div
                    class="chart-container"
                    id="chart-{{ section_index }}-{{ index|add:forloop.counter0 }}"
                    data-layer-id="{{ chart.dataset.id }}"
                    data-title="{{ chart.title }}"
                    data-color="{{ chart.chart_color|default:'#0b76e1' }}"
                    data-unit="{{ chart.data_unit|default:'' }}"
                    data-type="{{ chart.chart_type|default:'line' }}"
                    data-area-desc="{{ chart.area_desc }}"
                    data-admin-level="{{ chart.admin_level }}"
                    data-geostore-id="{{ chart.geostore_id }}"
                    data-gid0="{% if chart.gid0 %}{{ chart.gid0 }}{% else %}{% endif %}"
                    data-gid1="{% if chart.gid1 %}{{ chart.gid1 }}{% else %}{% endif %}"
                    data-gid2="{% if chart.gid2 %}{{ chart.gid2 }}{% else %}{% endif %}"
                    data-datetime-format="{{ chart.dataset.date_format|default:'yyyy-MM-dd HH:mm' }}"
                ></div>
                {% endif %}
            </div>
            <footer class="card-footer">
                <div style="width: 100%" class="m-2">
                    <div class="field is-grouped">
                        <div class="control">
                            <input
                                class="datepicker-input input is-small"
                                type="text"
                                placeholder="Start Date"
                                id="{% if chart.chart_type == 'stripes' %}date-start-stripes-{% else %}date-start-chart-{% endif %}{{ section_index }}-{{ index|add:forloop.counter0 }}"
                            />
                         
                        </div>
                        <div class="control">
                            <input
                                class="datepicker-input input is-small"
                                type="text"
                                placeholder="End Date"
                                id="{% if chart.chart_type == 'stripes' %}date-end-stripes-{% else %}date-end-chart-{% endif %}{{ section_index }}-{{ index|add:forloop.counter0 }}"
                            />
                         
                        </div>
                         
                    </div>
                    <div
                        class="params"
                        id="paramsContainer-chart-{{ section_index }}-{{ index|add:forloop.counter0 }}"
                    ></div>
                </div>
            </footer>
        </div>
    </div>
    {% include "partials/modal.html" with metadata=chart.dataset.dataset.metadata section=section_index index=index|add:forloop.counter0 %}

    {% endfor %}
</div>
