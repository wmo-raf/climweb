/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Mm(r){const n=Object.create(null);for(const u of r.split(","))n[u]=1;return u=>u in n}const Pr={},Nl=[],vi=()=>{},$1=()=>!1,tf=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),Im=r=>r.startsWith("onUpdate:"),Ln=Object.assign,Em=(r,n)=>{const u=r.indexOf(n);u>-1&&r.splice(u,1)},O1=Object.prototype.hasOwnProperty,mr=(r,n)=>O1.call(r,n),Bt=Array.isArray,Vl=r=>rf(r)==="[object Map]",R0=r=>rf(r)==="[object Set]",Vt=r=>typeof r=="function",Yr=r=>typeof r=="string",Ki=r=>typeof r=="symbol",Fr=r=>r!==null&&typeof r=="object",D0=r=>(Fr(r)||Vt(r))&&Vt(r.then)&&Vt(r.catch),L0=Object.prototype.toString,rf=r=>L0.call(r),F1=r=>rf(r).slice(8,-1),B0=r=>rf(r)==="[object Object]",Am=r=>Yr(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,Pu=Mm(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),nf=r=>{const n=Object.create(null);return u=>n[u]||(n[u]=r(u))},j1=/-(\w)/g,Uo=nf(r=>r.replace(j1,(n,u)=>u?u.toUpperCase():"")),N1=/\B([A-Z])/g,Ta=nf(r=>r.replace(N1,"-$1").toLowerCase()),of=nf(r=>r.charAt(0).toUpperCase()+r.slice(1)),Dp=nf(r=>r?`on${of(r)}`:""),zs=(r,n)=>!Object.is(r,n),Lp=(r,...n)=>{for(let u=0;u<r.length;u++)r[u](...n)},$0=(r,n,u,f=!1)=>{Object.defineProperty(r,n,{configurable:!0,enumerable:!1,writable:f,value:u})},V1=r=>{const n=parseFloat(r);return isNaN(n)?r:n},U1=r=>{const n=Yr(r)?Number(r):NaN;return isNaN(n)?r:n};let j_;const sf=()=>j_||(j_=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ls(r){if(Bt(r)){const n={};for(let u=0;u<r.length;u++){const f=r[u],y=Yr(f)?W1(f):Ls(f);if(y)for(const C in y)n[C]=y[C]}return n}else if(Yr(r)||Fr(r))return r}const Z1=/;(?![^(]*\))/g,G1=/:([^]+)/,q1=/\/\*[^]*?\*\//g;function W1(r){const n={};return r.replace(q1,"").split(Z1).forEach(u=>{if(u){const f=u.split(G1);f.length>1&&(n[f[0].trim()]=f[1].trim())}}),n}function af(r){let n="";if(Yr(r))n=r;else if(Bt(r))for(let u=0;u<r.length;u++){const f=af(r[u]);f&&(n+=f+" ")}else if(Fr(r))for(const u in r)r[u]&&(n+=u+" ");return n.trim()}const H1="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",X1=Mm(H1);function O0(r){return!!r||r===""}const F0=r=>!!(r&&r.__v_isRef===!0),ni=r=>Yr(r)?r:r==null?"":Bt(r)||Fr(r)&&(r.toString===L0||!Vt(r.toString))?F0(r)?ni(r.value):JSON.stringify(r,j0,2):String(r),j0=(r,n)=>F0(n)?j0(r,n.value):Vl(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((u,[f,y],C)=>(u[Bp(f,C)+" =>"]=y,u),{})}:R0(n)?{[`Set(${n.size})`]:[...n.values()].map(u=>Bp(u))}:Ki(n)?Bp(n):Fr(n)&&!Bt(n)&&!B0(n)?String(n):n,Bp=(r,n="")=>{var u;return Ki(r)?`Symbol(${(u=r.description)!=null?u:n})`:r};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ro;class N0{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ro,!n&&ro&&(this.index=(ro.scopes||(ro.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let n,u;if(this.scopes)for(n=0,u=this.scopes.length;n<u;n++)this.scopes[n].pause();for(n=0,u=this.effects.length;n<u;n++)this.effects[n].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let n,u;if(this.scopes)for(n=0,u=this.scopes.length;n<u;n++)this.scopes[n].resume();for(n=0,u=this.effects.length;n<u;n++)this.effects[n].resume()}}run(n){if(this._active){const u=ro;try{return ro=this,n()}finally{ro=u}}}on(){ro=this}off(){ro=this.parent}stop(n){if(this._active){this._active=!1;let u,f;for(u=0,f=this.effects.length;u<f;u++)this.effects[u].stop();for(this.effects.length=0,u=0,f=this.cleanups.length;u<f;u++)this.cleanups[u]();if(this.cleanups.length=0,this.scopes){for(u=0,f=this.scopes.length;u<f;u++)this.scopes[u].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!n){const y=this.parent.scopes.pop();y&&y!==this&&(this.parent.scopes[this.index]=y,y.index=this.index)}this.parent=void 0}}}function V0(r){return new N0(r)}function U0(){return ro}function Y1(r,n=!1){ro&&ro.cleanups.push(r)}let Er;const $p=new WeakSet;class Z0{constructor(n){this.fn=n,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ro&&ro.active&&ro.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,$p.has(this)&&($p.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||q0(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,N_(this),W0(this);const n=Er,u=ri;Er=this,ri=!0;try{return this.fn()}finally{H0(this),Er=n,ri=u,this.flags&=-3}}stop(){if(this.flags&1){for(let n=this.deps;n;n=n.nextDep)Dm(n);this.deps=this.depsTail=void 0,N_(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?$p.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){rm(this)&&this.run()}get dirty(){return rm(this)}}let G0=0,Mu,Iu;function q0(r,n=!1){if(r.flags|=8,n){r.next=Iu,Iu=r;return}r.next=Mu,Mu=r}function zm(){G0++}function Rm(){if(--G0>0)return;if(Iu){let n=Iu;for(Iu=void 0;n;){const u=n.next;n.next=void 0,n.flags&=-9,n=u}}let r;for(;Mu;){let n=Mu;for(Mu=void 0;n;){const u=n.next;if(n.next=void 0,n.flags&=-9,n.flags&1)try{n.trigger()}catch(f){r||(r=f)}n=u}}if(r)throw r}function W0(r){for(let n=r.deps;n;n=n.nextDep)n.version=-1,n.prevActiveLink=n.dep.activeLink,n.dep.activeLink=n}function H0(r){let n,u=r.depsTail,f=u;for(;f;){const y=f.prevDep;f.version===-1?(f===u&&(u=y),Dm(f),K1(f)):n=f,f.dep.activeLink=f.prevActiveLink,f.prevActiveLink=void 0,f=y}r.deps=n,r.depsTail=u}function rm(r){for(let n=r.deps;n;n=n.nextDep)if(n.dep.version!==n.version||n.dep.computed&&(X0(n.dep.computed)||n.dep.version!==n.version))return!0;return!!r._dirty}function X0(r){if(r.flags&4&&!(r.flags&16)||(r.flags&=-17,r.globalVersion===$u))return;r.globalVersion=$u;const n=r.dep;if(r.flags|=2,n.version>0&&!r.isSSR&&r.deps&&!rm(r)){r.flags&=-3;return}const u=Er,f=ri;Er=r,ri=!0;try{W0(r);const y=r.fn(r._value);(n.version===0||zs(y,r._value))&&(r._value=y,n.version++)}catch(y){throw n.version++,y}finally{Er=u,ri=f,H0(r),r.flags&=-3}}function Dm(r,n=!1){const{dep:u,prevSub:f,nextSub:y}=r;if(f&&(f.nextSub=y,r.prevSub=void 0),y&&(y.prevSub=f,r.nextSub=void 0),u.subs===r&&(u.subs=f,!f&&u.computed)){u.computed.flags&=-5;for(let C=u.computed.deps;C;C=C.nextDep)Dm(C,!0)}!n&&!--u.sc&&u.map&&u.map.delete(u.key)}function K1(r){const{prevDep:n,nextDep:u}=r;n&&(n.nextDep=u,r.prevDep=void 0),u&&(u.prevDep=n,r.nextDep=void 0)}let ri=!0;const Y0=[];function Os(){Y0.push(ri),ri=!1}function Fs(){const r=Y0.pop();ri=r===void 0?!0:r}function N_(r){const{cleanup:n}=r;if(r.cleanup=void 0,n){const u=Er;Er=void 0;try{n()}finally{Er=u}}}let $u=0;class J1{constructor(n,u){this.sub=n,this.dep=u,this.version=u.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Lm{constructor(n){this.computed=n,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(n){if(!Er||!ri||Er===this.computed)return;let u=this.activeLink;if(u===void 0||u.sub!==Er)u=this.activeLink=new J1(Er,this),Er.deps?(u.prevDep=Er.depsTail,Er.depsTail.nextDep=u,Er.depsTail=u):Er.deps=Er.depsTail=u,K0(u);else if(u.version===-1&&(u.version=this.version,u.nextDep)){const f=u.nextDep;f.prevDep=u.prevDep,u.prevDep&&(u.prevDep.nextDep=f),u.prevDep=Er.depsTail,u.nextDep=void 0,Er.depsTail.nextDep=u,Er.depsTail=u,Er.deps===u&&(Er.deps=f)}return u}trigger(n){this.version++,$u++,this.notify(n)}notify(n){zm();try{for(let u=this.subs;u;u=u.prevSub)u.sub.notify()&&u.sub.dep.notify()}finally{Rm()}}}function K0(r){if(r.dep.sc++,r.sub.flags&4){const n=r.dep.computed;if(n&&!r.dep.subs){n.flags|=20;for(let f=n.deps;f;f=f.nextDep)K0(f)}const u=r.dep.subs;u!==r&&(r.prevSub=u,u&&(u.nextSub=r)),r.dep.subs=r}}const Bd=new WeakMap,xa=Symbol(""),nm=Symbol(""),Ou=Symbol("");function Un(r,n,u){if(ri&&Er){let f=Bd.get(r);f||Bd.set(r,f=new Map);let y=f.get(u);y||(f.set(u,y=new Lm),y.map=f,y.key=u),y.track()}}function Wi(r,n,u,f,y,C){const b=Bd.get(r);if(!b){$u++;return}const a=I=>{I&&I.trigger()};if(zm(),n==="clear")b.forEach(a);else{const I=Bt(r),R=I&&Am(u);if(I&&u==="length"){const $=Number(f);b.forEach((N,q)=>{(q==="length"||q===Ou||!Ki(q)&&q>=$)&&a(N)})}else switch((u!==void 0||b.has(void 0))&&a(b.get(u)),R&&a(b.get(Ou)),n){case"add":I?R&&a(b.get("length")):(a(b.get(xa)),Vl(r)&&a(b.get(nm)));break;case"delete":I||(a(b.get(xa)),Vl(r)&&a(b.get(nm)));break;case"set":Vl(r)&&a(b.get(xa));break}}Rm()}function Q1(r,n){const u=Bd.get(r);return u&&u.get(n)}function Rl(r){const n=lr(r);return n===r?n:(Un(n,"iterate",Ou),Vo(r)?n:n.map(Zn))}function lf(r){return Un(r=lr(r),"iterate",Ou),r}const ew={__proto__:null,[Symbol.iterator](){return Op(this,Symbol.iterator,Zn)},concat(...r){return Rl(this).concat(...r.map(n=>Bt(n)?Rl(n):n))},entries(){return Op(this,"entries",r=>(r[1]=Zn(r[1]),r))},every(r,n){return Ui(this,"every",r,n,void 0,arguments)},filter(r,n){return Ui(this,"filter",r,n,u=>u.map(Zn),arguments)},find(r,n){return Ui(this,"find",r,n,Zn,arguments)},findIndex(r,n){return Ui(this,"findIndex",r,n,void 0,arguments)},findLast(r,n){return Ui(this,"findLast",r,n,Zn,arguments)},findLastIndex(r,n){return Ui(this,"findLastIndex",r,n,void 0,arguments)},forEach(r,n){return Ui(this,"forEach",r,n,void 0,arguments)},includes(...r){return Fp(this,"includes",r)},indexOf(...r){return Fp(this,"indexOf",r)},join(r){return Rl(this).join(r)},lastIndexOf(...r){return Fp(this,"lastIndexOf",r)},map(r,n){return Ui(this,"map",r,n,void 0,arguments)},pop(){return gu(this,"pop")},push(...r){return gu(this,"push",r)},reduce(r,...n){return V_(this,"reduce",r,n)},reduceRight(r,...n){return V_(this,"reduceRight",r,n)},shift(){return gu(this,"shift")},some(r,n){return Ui(this,"some",r,n,void 0,arguments)},splice(...r){return gu(this,"splice",r)},toReversed(){return Rl(this).toReversed()},toSorted(r){return Rl(this).toSorted(r)},toSpliced(...r){return Rl(this).toSpliced(...r)},unshift(...r){return gu(this,"unshift",r)},values(){return Op(this,"values",Zn)}};function Op(r,n,u){const f=lf(r),y=f[n]();return f!==r&&!Vo(r)&&(y._next=y.next,y.next=()=>{const C=y._next();return C.value&&(C.value=u(C.value)),C}),y}const tw=Array.prototype;function Ui(r,n,u,f,y,C){const b=lf(r),a=b!==r&&!Vo(r),I=b[n];if(I!==tw[n]){const N=I.apply(r,C);return a?Zn(N):N}let R=u;b!==r&&(a?R=function(N,q){return u.call(this,Zn(N),q,r)}:u.length>2&&(R=function(N,q){return u.call(this,N,q,r)}));const $=I.call(b,R,f);return a&&y?y($):$}function V_(r,n,u,f){const y=lf(r);let C=u;return y!==r&&(Vo(r)?u.length>3&&(C=function(b,a,I){return u.call(this,b,a,I,r)}):C=function(b,a,I){return u.call(this,b,Zn(a),I,r)}),y[n](C,...f)}function Fp(r,n,u){const f=lr(r);Un(f,"iterate",Ou);const y=f[n](...u);return(y===-1||y===!1)&&Fm(u[0])?(u[0]=lr(u[0]),f[n](...u)):y}function gu(r,n,u=[]){Os(),zm();const f=lr(r)[n].apply(r,u);return Rm(),Fs(),f}const rw=Mm("__proto__,__v_isRef,__isVue"),J0=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(Ki));function nw(r){Ki(r)||(r=String(r));const n=lr(this);return Un(n,"has",r),n.hasOwnProperty(r)}class Q0{constructor(n=!1,u=!1){this._isReadonly=n,this._isShallow=u}get(n,u,f){if(u==="__v_skip")return n.__v_skip;const y=this._isReadonly,C=this._isShallow;if(u==="__v_isReactive")return!y;if(u==="__v_isReadonly")return y;if(u==="__v_isShallow")return C;if(u==="__v_raw")return f===(y?C?fw:nv:C?rv:tv).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(f)?n:void 0;const b=Bt(n);if(!y){let I;if(b&&(I=ew[u]))return I;if(u==="hasOwnProperty")return nw}const a=Reflect.get(n,u,ln(n)?n:f);return(Ki(u)?J0.has(u):rw(u))||(y||Un(n,"get",u),C)?a:ln(a)?b&&Am(u)?a:a.value:Fr(a)?y?$m(a):Xl(a):a}}class ev extends Q0{constructor(n=!1){super(!1,n)}set(n,u,f,y){let C=n[u];if(!this._isShallow){const I=Sa(C);if(!Vo(f)&&!Sa(f)&&(C=lr(C),f=lr(f)),!Bt(n)&&ln(C)&&!ln(f))return I?!1:(C.value=f,!0)}const b=Bt(n)&&Am(u)?Number(u)<n.length:mr(n,u),a=Reflect.set(n,u,f,ln(n)?n:y);return n===lr(y)&&(b?zs(f,C)&&Wi(n,"set",u,f):Wi(n,"add",u,f)),a}deleteProperty(n,u){const f=mr(n,u);n[u];const y=Reflect.deleteProperty(n,u);return y&&f&&Wi(n,"delete",u,void 0),y}has(n,u){const f=Reflect.has(n,u);return(!Ki(u)||!J0.has(u))&&Un(n,"has",u),f}ownKeys(n){return Un(n,"iterate",Bt(n)?"length":xa),Reflect.ownKeys(n)}}class ow extends Q0{constructor(n=!1){super(!0,n)}set(n,u){return!0}deleteProperty(n,u){return!0}}const iw=new ev,sw=new ow,aw=new ev(!0);const om=r=>r,vd=r=>Reflect.getPrototypeOf(r);function lw(r,n,u){return function(...f){const y=this.__v_raw,C=lr(y),b=Vl(C),a=r==="entries"||r===Symbol.iterator&&b,I=r==="keys"&&b,R=y[r](...f),$=u?om:n?im:Zn;return!n&&Un(C,"iterate",I?nm:xa),{next(){const{value:N,done:q}=R.next();return q?{value:N,done:q}:{value:a?[$(N[0]),$(N[1])]:$(N),done:q}},[Symbol.iterator](){return this}}}}function bd(r){return function(...n){return r==="delete"?!1:r==="clear"?void 0:this}}function cw(r,n){const u={get(y){const C=this.__v_raw,b=lr(C),a=lr(y);r||(zs(y,a)&&Un(b,"get",y),Un(b,"get",a));const{has:I}=vd(b),R=n?om:r?im:Zn;if(I.call(b,y))return R(C.get(y));if(I.call(b,a))return R(C.get(a));C!==b&&C.get(y)},get size(){const y=this.__v_raw;return!r&&Un(lr(y),"iterate",xa),Reflect.get(y,"size",y)},has(y){const C=this.__v_raw,b=lr(C),a=lr(y);return r||(zs(y,a)&&Un(b,"has",y),Un(b,"has",a)),y===a?C.has(y):C.has(y)||C.has(a)},forEach(y,C){const b=this,a=b.__v_raw,I=lr(a),R=n?om:r?im:Zn;return!r&&Un(I,"iterate",xa),a.forEach(($,N)=>y.call(C,R($),R(N),b))}};return Ln(u,r?{add:bd("add"),set:bd("set"),delete:bd("delete"),clear:bd("clear")}:{add(y){!n&&!Vo(y)&&!Sa(y)&&(y=lr(y));const C=lr(this);return vd(C).has.call(C,y)||(C.add(y),Wi(C,"add",y,y)),this},set(y,C){!n&&!Vo(C)&&!Sa(C)&&(C=lr(C));const b=lr(this),{has:a,get:I}=vd(b);let R=a.call(b,y);R||(y=lr(y),R=a.call(b,y));const $=I.call(b,y);return b.set(y,C),R?zs(C,$)&&Wi(b,"set",y,C):Wi(b,"add",y,C),this},delete(y){const C=lr(this),{has:b,get:a}=vd(C);let I=b.call(C,y);I||(y=lr(y),I=b.call(C,y)),a&&a.call(C,y);const R=C.delete(y);return I&&Wi(C,"delete",y,void 0),R},clear(){const y=lr(this),C=y.size!==0,b=y.clear();return C&&Wi(y,"clear",void 0,void 0),b}}),["keys","values","entries",Symbol.iterator].forEach(y=>{u[y]=lw(y,r,n)}),u}function Bm(r,n){const u=cw(r,n);return(f,y,C)=>y==="__v_isReactive"?!r:y==="__v_isReadonly"?r:y==="__v_raw"?f:Reflect.get(mr(u,y)&&y in f?u:f,y,C)}const uw={get:Bm(!1,!1)},hw={get:Bm(!1,!0)},dw={get:Bm(!0,!1)};const tv=new WeakMap,rv=new WeakMap,nv=new WeakMap,fw=new WeakMap;function pw(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function mw(r){return r.__v_skip||!Object.isExtensible(r)?0:pw(F1(r))}function Xl(r){return Sa(r)?r:Om(r,!1,iw,uw,tv)}function gw(r){return Om(r,!1,aw,hw,rv)}function $m(r){return Om(r,!0,sw,dw,nv)}function Om(r,n,u,f,y){if(!Fr(r)||r.__v_raw&&!(n&&r.__v_isReactive))return r;const C=y.get(r);if(C)return C;const b=mw(r);if(b===0)return r;const a=new Proxy(r,b===2?f:u);return y.set(r,a),a}function Rs(r){return Sa(r)?Rs(r.__v_raw):!!(r&&r.__v_isReactive)}function Sa(r){return!!(r&&r.__v_isReadonly)}function Vo(r){return!!(r&&r.__v_isShallow)}function Fm(r){return r?!!r.__v_raw:!1}function lr(r){const n=r&&r.__v_raw;return n?lr(n):r}function jm(r){return!mr(r,"__v_skip")&&Object.isExtensible(r)&&$0(r,"__v_skip",!0),r}const Zn=r=>Fr(r)?Xl(r):r,im=r=>Fr(r)?$m(r):r;function ln(r){return r?r.__v_isRef===!0:!1}function _o(r){return ov(r,!1)}function _w(r){return ov(r,!0)}function ov(r,n){return ln(r)?r:new yw(r,n)}class yw{constructor(n,u){this.dep=new Lm,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=u?n:lr(n),this._value=u?n:Zn(n),this.__v_isShallow=u}get value(){return this.dep.track(),this._value}set value(n){const u=this._rawValue,f=this.__v_isShallow||Vo(n)||Sa(n);n=f?n:lr(n),zs(n,u)&&(this._rawValue=n,this._value=f?n:Zn(n),this.dep.trigger())}}function Ol(r){return ln(r)?r.value:r}const vw={get:(r,n,u)=>n==="__v_raw"?r:Ol(Reflect.get(r,n,u)),set:(r,n,u,f)=>{const y=r[n];return ln(y)&&!ln(u)?(y.value=u,!0):Reflect.set(r,n,u,f)}};function iv(r){return Rs(r)?r:new Proxy(r,vw)}function bw(r){const n=Bt(r)?new Array(r.length):{};for(const u in r)n[u]=ww(r,u);return n}class xw{constructor(n,u,f){this._object=n,this._key=u,this._defaultValue=f,this.__v_isRef=!0,this._value=void 0}get value(){const n=this._object[this._key];return this._value=n===void 0?this._defaultValue:n}set value(n){this._object[this._key]=n}get dep(){return Q1(lr(this._object),this._key)}}function ww(r,n,u){const f=r[n];return ln(f)?f:new xw(r,n,u)}class Cw{constructor(n,u,f){this.fn=n,this.setter=u,this._value=void 0,this.dep=new Lm(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=$u-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!u,this.isSSR=f}notify(){if(this.flags|=16,!(this.flags&8)&&Er!==this)return q0(this,!0),!0}get value(){const n=this.dep.track();return X0(this),n&&(n.version=this.dep.version),this._value}set value(n){this.setter&&this.setter(n)}}function Sw(r,n,u=!1){let f,y;return Vt(r)?f=r:(f=r.get,y=r.set),new Cw(f,y,u)}const xd={},$d=new WeakMap;let _a;function Tw(r,n=!1,u=_a){if(u){let f=$d.get(u);f||$d.set(u,f=[]),f.push(r)}}function kw(r,n,u=Pr){const{immediate:f,deep:y,once:C,scheduler:b,augmentJob:a,call:I}=u,R=be=>y?be:Vo(be)||y===!1||y===0?Hi(be,1):Hi(be);let $,N,q,V,ie=!1,Pe=!1;if(ln(r)?(N=()=>r.value,ie=Vo(r)):Rs(r)?(N=()=>R(r),ie=!0):Bt(r)?(Pe=!0,ie=r.some(be=>Rs(be)||Vo(be)),N=()=>r.map(be=>{if(ln(be))return be.value;if(Rs(be))return R(be);if(Vt(be))return I?I(be,2):be()})):Vt(r)?n?N=I?()=>I(r,2):r:N=()=>{if(q){Os();try{q()}finally{Fs()}}const be=_a;_a=$;try{return I?I(r,3,[V]):r(V)}finally{_a=be}}:N=vi,n&&y){const be=N,Oe=y===!0?1/0:y;N=()=>Hi(be(),Oe)}const Ne=U0(),xe=()=>{$.stop(),Ne&&Ne.active&&Em(Ne.effects,$)};if(C&&n){const be=n;n=(...Oe)=>{be(...Oe),xe()}}let Ge=Pe?new Array(r.length).fill(xd):xd;const qe=be=>{if(!(!($.flags&1)||!$.dirty&&!be))if(n){const Oe=$.run();if(y||ie||(Pe?Oe.some((ct,ut)=>zs(ct,Ge[ut])):zs(Oe,Ge))){q&&q();const ct=_a;_a=$;try{const ut=[Oe,Ge===xd?void 0:Pe&&Ge[0]===xd?[]:Ge,V];I?I(n,3,ut):n(...ut),Ge=Oe}finally{_a=ct}}}else $.run()};return a&&a(qe),$=new Z0(N),$.scheduler=b?()=>b(qe,!1):qe,V=be=>Tw(be,!1,$),q=$.onStop=()=>{const be=$d.get($);if(be){if(I)I(be,4);else for(const Oe of be)Oe();$d.delete($)}},n?f?qe(!0):Ge=$.run():b?b(qe.bind(null,!0),!0):$.run(),xe.pause=$.pause.bind($),xe.resume=$.resume.bind($),xe.stop=xe,xe}function Hi(r,n=1/0,u){if(n<=0||!Fr(r)||r.__v_skip||(u=u||new Set,u.has(r)))return r;if(u.add(r),n--,ln(r))Hi(r.value,n,u);else if(Bt(r))for(let f=0;f<r.length;f++)Hi(r[f],n,u);else if(R0(r)||Vl(r))r.forEach(f=>{Hi(f,n,u)});else if(B0(r)){for(const f in r)Hi(r[f],n,u);for(const f of Object.getOwnPropertySymbols(r))Object.prototype.propertyIsEnumerable.call(r,f)&&Hi(r[f],n,u)}return r}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function oh(r,n,u,f){try{return f?r(...f):r()}catch(y){cf(y,n,u)}}function oi(r,n,u,f){if(Vt(r)){const y=oh(r,n,u,f);return y&&D0(y)&&y.catch(C=>{cf(C,n,u)}),y}if(Bt(r)){const y=[];for(let C=0;C<r.length;C++)y.push(oi(r[C],n,u,f));return y}}function cf(r,n,u,f=!0){const y=n?n.vnode:null,{errorHandler:C,throwUnhandledErrorInProduction:b}=n&&n.appContext.config||Pr;if(n){let a=n.parent;const I=n.proxy,R=`https://vuejs.org/error-reference/#runtime-${u}`;for(;a;){const $=a.ec;if($){for(let N=0;N<$.length;N++)if($[N](r,I,R)===!1)return}a=a.parent}if(C){Os(),oh(C,null,10,[r,I,R]),Fs();return}}Pw(r,u,y,f,b)}function Pw(r,n,u,f=!0,y=!1){if(y)throw r;console.error(r)}const no=[];let gi=-1;const Ul=[];let Ps=null,Bl=0;const sv=Promise.resolve();let Od=null;function Nm(r){const n=Od||sv;return r?n.then(this?r.bind(this):r):n}function Mw(r){let n=gi+1,u=no.length;for(;n<u;){const f=n+u>>>1,y=no[f],C=Fu(y);C<r||C===r&&y.flags&2?n=f+1:u=f}return n}function Vm(r){if(!(r.flags&1)){const n=Fu(r),u=no[no.length-1];!u||!(r.flags&2)&&n>=Fu(u)?no.push(r):no.splice(Mw(n),0,r),r.flags|=1,av()}}function av(){Od||(Od=sv.then(cv))}function Iw(r){Bt(r)?Ul.push(...r):Ps&&r.id===-1?Ps.splice(Bl+1,0,r):r.flags&1||(Ul.push(r),r.flags|=1),av()}function U_(r,n,u=gi+1){for(;u<no.length;u++){const f=no[u];if(f&&f.flags&2){if(r&&f.id!==r.uid)continue;no.splice(u,1),u--,f.flags&4&&(f.flags&=-2),f(),f.flags&4||(f.flags&=-2)}}}function lv(r){if(Ul.length){const n=[...new Set(Ul)].sort((u,f)=>Fu(u)-Fu(f));if(Ul.length=0,Ps){Ps.push(...n);return}for(Ps=n,Bl=0;Bl<Ps.length;Bl++){const u=Ps[Bl];u.flags&4&&(u.flags&=-2),u.flags&8||u(),u.flags&=-2}Ps=null,Bl=0}}const Fu=r=>r.id==null?r.flags&2?-1:1/0:r.id;function cv(r){try{for(gi=0;gi<no.length;gi++){const n=no[gi];n&&!(n.flags&8)&&(n.flags&4&&(n.flags&=-2),oh(n,n.i,n.i?15:14),n.flags&4||(n.flags&=-2))}}finally{for(;gi<no.length;gi++){const n=no[gi];n&&(n.flags&=-2)}gi=-1,no.length=0,lv(),Od=null,(no.length||Ul.length)&&cv()}}let Sn=null,uv=null;function Fd(r){const n=Sn;return Sn=r,uv=r&&r.type.__scopeId||null,n}function jd(r,n=Sn,u){if(!n||r._n)return r;const f=(...y)=>{f._d&&ny(-1);const C=Fd(n);let b;try{b=r(...y)}finally{Fd(C),f._d&&ny(1)}return b};return f._n=!0,f._c=!0,f._d=!0,f}function Ew(r,n){if(Sn===null)return r;const u=mf(Sn),f=r.dirs||(r.dirs=[]);for(let y=0;y<n.length;y++){let[C,b,a,I=Pr]=n[y];C&&(Vt(C)&&(C={mounted:C,updated:C}),C.deep&&Hi(b),f.push({dir:C,instance:u,value:b,oldValue:void 0,arg:a,modifiers:I}))}return r}function fa(r,n,u,f){const y=r.dirs,C=n&&n.dirs;for(let b=0;b<y.length;b++){const a=y[b];C&&(a.oldValue=C[b].value);let I=a.dir[f];I&&(Os(),oi(I,u,8,[r.el,a,r,n]),Fs())}}const hv=Symbol("_vte"),dv=r=>r.__isTeleport,Eu=r=>r&&(r.disabled||r.disabled===""),Z_=r=>r&&(r.defer||r.defer===""),G_=r=>typeof SVGElement<"u"&&r instanceof SVGElement,q_=r=>typeof MathMLElement=="function"&&r instanceof MathMLElement,sm=(r,n)=>{const u=r&&r.to;return Yr(u)?n?n(u):null:u},fv={name:"Teleport",__isTeleport:!0,process(r,n,u,f,y,C,b,a,I,R){const{mc:$,pc:N,pbc:q,o:{insert:V,querySelector:ie,createText:Pe,createComment:Ne}}=R,xe=Eu(n.props);let{shapeFlag:Ge,children:qe,dynamicChildren:be}=n;if(r==null){const Oe=n.el=Pe(""),ct=n.anchor=Pe("");V(Oe,u,f),V(ct,u,f);const ut=(Qe,gt)=>{Ge&16&&(y&&y.isCE&&(y.ce._teleportTarget=Qe),$(qe,Qe,gt,y,C,b,a,I))},st=()=>{const Qe=n.target=sm(n.props,ie),gt=pv(Qe,n,Pe,V);Qe&&(b!=="svg"&&G_(Qe)?b="svg":b!=="mathml"&&q_(Qe)&&(b="mathml"),xe||(ut(Qe,gt),zd(n,!1)))};xe&&(ut(u,ct),zd(n,!0)),Z_(n.props)?to(()=>{st(),n.el.__isMounted=!0},C):st()}else{if(Z_(n.props)&&!r.el.__isMounted){to(()=>{fv.process(r,n,u,f,y,C,b,a,I,R),delete r.el.__isMounted},C);return}n.el=r.el,n.targetStart=r.targetStart;const Oe=n.anchor=r.anchor,ct=n.target=r.target,ut=n.targetAnchor=r.targetAnchor,st=Eu(r.props),Qe=st?u:ct,gt=st?Oe:ut;if(b==="svg"||G_(ct)?b="svg":(b==="mathml"||q_(ct))&&(b="mathml"),be?(q(r.dynamicChildren,be,Qe,y,C,b,a),Gm(r,n,!0)):I||N(r,n,Qe,gt,y,C,b,a,!1),xe)st?n.props&&r.props&&n.props.to!==r.props.to&&(n.props.to=r.props.to):wd(n,u,Oe,R,1);else if((n.props&&n.props.to)!==(r.props&&r.props.to)){const ot=n.target=sm(n.props,ie);ot&&wd(n,ot,null,R,0)}else st&&wd(n,ct,ut,R,1);zd(n,xe)}},remove(r,n,u,{um:f,o:{remove:y}},C){const{shapeFlag:b,children:a,anchor:I,targetStart:R,targetAnchor:$,target:N,props:q}=r;if(N&&(y(R),y($)),C&&y(I),b&16){const V=C||!Eu(q);for(let ie=0;ie<a.length;ie++){const Pe=a[ie];f(Pe,n,u,V,!!Pe.dynamicChildren)}}},move:wd,hydrate:Aw};function wd(r,n,u,{o:{insert:f},m:y},C=2){C===0&&f(r.targetAnchor,n,u);const{el:b,anchor:a,shapeFlag:I,children:R,props:$}=r,N=C===2;if(N&&f(b,n,u),(!N||Eu($))&&I&16)for(let q=0;q<R.length;q++)y(R[q],n,u,2);N&&f(a,n,u)}function Aw(r,n,u,f,y,C,{o:{nextSibling:b,parentNode:a,querySelector:I,insert:R,createText:$}},N){const q=n.target=sm(n.props,I);if(q){const V=Eu(n.props),ie=q._lpa||q.firstChild;if(n.shapeFlag&16)if(V)n.anchor=N(b(r),n,a(r),u,f,y,C),n.targetStart=ie,n.targetAnchor=ie&&b(ie);else{n.anchor=b(r);let Pe=ie;for(;Pe;){if(Pe&&Pe.nodeType===8){if(Pe.data==="teleport start anchor")n.targetStart=Pe;else if(Pe.data==="teleport anchor"){n.targetAnchor=Pe,q._lpa=n.targetAnchor&&b(n.targetAnchor);break}}Pe=b(Pe)}n.targetAnchor||pv(q,n,$,R),N(ie&&b(ie),n,q,u,f,y,C)}zd(n,V)}return n.anchor&&b(n.anchor)}const zw=fv;function zd(r,n){const u=r.ctx;if(u&&u.ut){let f,y;for(n?(f=r.el,y=r.anchor):(f=r.targetStart,y=r.targetAnchor);f&&f!==y;)f.nodeType===1&&f.setAttribute("data-v-owner",u.uid),f=f.nextSibling;u.ut()}}function pv(r,n,u,f){const y=n.targetStart=u(""),C=n.targetAnchor=u("");return y[hv]=C,r&&(f(y,r),f(C,r)),C}const Ms=Symbol("_leaveCb"),Cd=Symbol("_enterCb");function Rw(){const r={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return df(()=>{r.isMounted=!0}),wv(()=>{r.isUnmounting=!0}),r}const Fo=[Function,Array],mv={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Fo,onEnter:Fo,onAfterEnter:Fo,onEnterCancelled:Fo,onBeforeLeave:Fo,onLeave:Fo,onAfterLeave:Fo,onLeaveCancelled:Fo,onBeforeAppear:Fo,onAppear:Fo,onAfterAppear:Fo,onAppearCancelled:Fo},gv=r=>{const n=r.subTree;return n.component?gv(n.component):n},Dw={name:"BaseTransition",props:mv,setup(r,{slots:n}){const u=Wm(),f=Rw();return()=>{const y=n.default&&vv(n.default(),!0);if(!y||!y.length)return;const C=_v(y),b=lr(r),{mode:a}=b;if(f.isLeaving)return jp(C);const I=W_(C);if(!I)return jp(C);let R=am(I,b,f,u,N=>R=N);I.type!==oo&&ju(I,R);let $=u.subTree&&W_(u.subTree);if($&&$.type!==oo&&!va(I,$)&&gv(u).type!==oo){let N=am($,b,f,u);if(ju($,N),a==="out-in"&&I.type!==oo)return f.isLeaving=!0,N.afterLeave=()=>{f.isLeaving=!1,u.job.flags&8||u.update(),delete N.afterLeave,$=void 0},jp(C);a==="in-out"&&I.type!==oo?N.delayLeave=(q,V,ie)=>{const Pe=yv(f,$);Pe[String($.key)]=$,q[Ms]=()=>{V(),q[Ms]=void 0,delete R.delayedLeave,$=void 0},R.delayedLeave=()=>{ie(),delete R.delayedLeave,$=void 0}}:$=void 0}else $&&($=void 0);return C}}};function _v(r){let n=r[0];if(r.length>1){for(const u of r)if(u.type!==oo){n=u;break}}return n}const Lw=Dw;function yv(r,n){const{leavingVNodes:u}=r;let f=u.get(n.type);return f||(f=Object.create(null),u.set(n.type,f)),f}function am(r,n,u,f,y){const{appear:C,mode:b,persisted:a=!1,onBeforeEnter:I,onEnter:R,onAfterEnter:$,onEnterCancelled:N,onBeforeLeave:q,onLeave:V,onAfterLeave:ie,onLeaveCancelled:Pe,onBeforeAppear:Ne,onAppear:xe,onAfterAppear:Ge,onAppearCancelled:qe}=n,be=String(r.key),Oe=yv(u,r),ct=(Qe,gt)=>{Qe&&oi(Qe,f,9,gt)},ut=(Qe,gt)=>{const ot=gt[1];ct(Qe,gt),Bt(Qe)?Qe.every(Me=>Me.length<=1)&&ot():Qe.length<=1&&ot()},st={mode:b,persisted:a,beforeEnter(Qe){let gt=I;if(!u.isMounted)if(C)gt=Ne||I;else return;Qe[Ms]&&Qe[Ms](!0);const ot=Oe[be];ot&&va(r,ot)&&ot.el[Ms]&&ot.el[Ms](),ct(gt,[Qe])},enter(Qe){let gt=R,ot=$,Me=N;if(!u.isMounted)if(C)gt=xe||R,ot=Ge||$,Me=qe||N;else return;let Fe=!1;const tt=Qe[Cd]=At=>{Fe||(Fe=!0,At?ct(Me,[Qe]):ct(ot,[Qe]),st.delayedLeave&&st.delayedLeave(),Qe[Cd]=void 0)};gt?ut(gt,[Qe,tt]):tt()},leave(Qe,gt){const ot=String(r.key);if(Qe[Cd]&&Qe[Cd](!0),u.isUnmounting)return gt();ct(q,[Qe]);let Me=!1;const Fe=Qe[Ms]=tt=>{Me||(Me=!0,gt(),tt?ct(Pe,[Qe]):ct(ie,[Qe]),Qe[Ms]=void 0,Oe[ot]===r&&delete Oe[ot])};Oe[ot]=r,V?ut(V,[Qe,Fe]):Fe()},clone(Qe){const gt=am(Qe,n,u,f,y);return y&&y(gt),gt}};return st}function jp(r){if(uf(r))return r=$s(r),r.children=null,r}function W_(r){if(!uf(r))return dv(r.type)&&r.children?_v(r.children):r;const{shapeFlag:n,children:u}=r;if(u){if(n&16)return u[0];if(n&32&&Vt(u.default))return u.default()}}function ju(r,n){r.shapeFlag&6&&r.component?(r.transition=n,ju(r.component.subTree,n)):r.shapeFlag&128?(r.ssContent.transition=n.clone(r.ssContent),r.ssFallback.transition=n.clone(r.ssFallback)):r.transition=n}function vv(r,n=!1,u){let f=[],y=0;for(let C=0;C<r.length;C++){let b=r[C];const a=u==null?b.key:String(u)+String(b.key!=null?b.key:C);b.type===an?(b.patchFlag&128&&y++,f=f.concat(vv(b.children,n,a))):(n||b.type!==oo)&&f.push(a!=null?$s(b,{key:a}):b)}if(y>1)for(let C=0;C<f.length;C++)f[C].patchFlag=-2;return f}function Bw(){const r=Wm();return r?(r.appContext.config.idPrefix||"v")+"-"+r.ids[0]+r.ids[1]++:""}function bv(r){r.ids=[r.ids[0]+r.ids[2]+++"-",0,0]}function Nd(r,n,u,f,y=!1){if(Bt(r)){r.forEach((ie,Pe)=>Nd(ie,n&&(Bt(n)?n[Pe]:n),u,f,y));return}if(Zl(f)&&!y){f.shapeFlag&512&&f.type.__asyncResolved&&f.component.subTree.component&&Nd(r,n,u,f.component.subTree);return}const C=f.shapeFlag&4?mf(f.component):f.el,b=y?null:C,{i:a,r:I}=r,R=n&&n.r,$=a.refs===Pr?a.refs={}:a.refs,N=a.setupState,q=lr(N),V=N===Pr?()=>!1:ie=>mr(q,ie);if(R!=null&&R!==I&&(Yr(R)?($[R]=null,V(R)&&(N[R]=null)):ln(R)&&(R.value=null)),Vt(I))oh(I,a,12,[b,$]);else{const ie=Yr(I),Pe=ln(I);if(ie||Pe){const Ne=()=>{if(r.f){const xe=ie?V(I)?N[I]:$[I]:I.value;y?Bt(xe)&&Em(xe,C):Bt(xe)?xe.includes(C)||xe.push(C):ie?($[I]=[C],V(I)&&(N[I]=$[I])):(I.value=[C],r.k&&($[r.k]=I.value))}else ie?($[I]=b,V(I)&&(N[I]=b)):Pe&&(I.value=b,r.k&&($[r.k]=b))};b?(Ne.id=-1,to(Ne,u)):Ne()}}}sf().requestIdleCallback;sf().cancelIdleCallback;const Zl=r=>!!r.type.__asyncLoader,uf=r=>r.type.__isKeepAlive;function $w(r,n){xv(r,"a",n)}function Ow(r,n){xv(r,"da",n)}function xv(r,n,u=An){const f=r.__wdc||(r.__wdc=()=>{let y=u;for(;y;){if(y.isDeactivated)return;y=y.parent}return r()});if(hf(n,f,u),u){let y=u.parent;for(;y&&y.parent;)uf(y.parent.vnode)&&Fw(f,n,u,y),y=y.parent}}function Fw(r,n,u,f){const y=hf(n,r,f,!0);Um(()=>{Em(f[n],y)},u)}function hf(r,n,u=An,f=!1){if(u){const y=u[r]||(u[r]=[]),C=n.__weh||(n.__weh=(...b)=>{Os();const a=ih(u),I=oi(n,u,r,b);return a(),Fs(),I});return f?y.unshift(C):y.push(C),C}}const Ji=r=>(n,u=An)=>{(!Uu||r==="sp")&&hf(r,(...f)=>n(...f),u)},jw=Ji("bm"),df=Ji("m"),Nw=Ji("bu"),Vw=Ji("u"),wv=Ji("bum"),Um=Ji("um"),Uw=Ji("sp"),Zw=Ji("rtg"),Gw=Ji("rtc");function qw(r,n=An){hf("ec",r,n)}const Cv="components",Ww="directives";function Hw(r,n){return Sv(Cv,r,!0,n)||r}const Xw=Symbol.for("v-ndc");function Yw(r){return Sv(Ww,r)}function Sv(r,n,u=!0,f=!1){const y=Sn||An;if(y){const C=y.type;if(r===Cv){const a=$2(C,!1);if(a&&(a===n||a===Uo(n)||a===of(Uo(n))))return C}const b=H_(y[r]||C[r],n)||H_(y.appContext[r],n);return!b&&f?C:b}}function H_(r,n){return r&&(r[n]||r[Uo(n)]||r[of(Uo(n))])}function Wl(r,n,u,f){let y;const C=u,b=Bt(r);if(b||Yr(r)){const a=b&&Rs(r);let I=!1;a&&(I=!Vo(r),r=lf(r)),y=new Array(r.length);for(let R=0,$=r.length;R<$;R++)y[R]=n(I?Zn(r[R]):r[R],R,void 0,C)}else if(typeof r=="number"){y=new Array(r);for(let a=0;a<r;a++)y[a]=n(a+1,a,void 0,C)}else if(Fr(r))if(r[Symbol.iterator])y=Array.from(r,(a,I)=>n(a,I,void 0,C));else{const a=Object.keys(r);y=new Array(a.length);for(let I=0,R=a.length;I<R;I++){const $=a[I];y[I]=n(r[$],$,I,C)}}else y=[];return y}function Vd(r,n,u={},f,y){if(Sn.ce||Sn.parent&&Zl(Sn.parent)&&Sn.parent.ce)return n!=="default"&&(u.name=n),sr(),Bs(an,null,[Vr("slot",u,f)],64);let C=r[n];C&&C._c&&(C._d=!1),sr();const b=C&&Tv(C(u)),a=u.key||b&&b.key,I=Bs(an,{key:(a&&!Ki(a)?a:`_${n}`)+""},b||[],b&&r._===1?64:-2);return I.scopeId&&(I.slotScopeIds=[I.scopeId+"-s"]),C&&C._c&&(C._d=!0),I}function Tv(r){return r.some(n=>Vu(n)?!(n.type===oo||n.type===an&&!Tv(n.children)):!0)?r:null}const lm=r=>r?qv(r)?mf(r):lm(r.parent):null,Au=Ln(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>lm(r.parent),$root:r=>lm(r.root),$host:r=>r.ce,$emit:r=>r.emit,$options:r=>Pv(r),$forceUpdate:r=>r.f||(r.f=()=>{Vm(r.update)}),$nextTick:r=>r.n||(r.n=Nm.bind(r.proxy)),$watch:r=>v2.bind(r)}),Np=(r,n)=>r!==Pr&&!r.__isScriptSetup&&mr(r,n),Kw={get({_:r},n){if(n==="__v_skip")return!0;const{ctx:u,setupState:f,data:y,props:C,accessCache:b,type:a,appContext:I}=r;let R;if(n[0]!=="$"){const V=b[n];if(V!==void 0)switch(V){case 1:return f[n];case 2:return y[n];case 4:return u[n];case 3:return C[n]}else{if(Np(f,n))return b[n]=1,f[n];if(y!==Pr&&mr(y,n))return b[n]=2,y[n];if((R=r.propsOptions[0])&&mr(R,n))return b[n]=3,C[n];if(u!==Pr&&mr(u,n))return b[n]=4,u[n];cm&&(b[n]=0)}}const $=Au[n];let N,q;if($)return n==="$attrs"&&Un(r.attrs,"get",""),$(r);if((N=a.__cssModules)&&(N=N[n]))return N;if(u!==Pr&&mr(u,n))return b[n]=4,u[n];if(q=I.config.globalProperties,mr(q,n))return q[n]},set({_:r},n,u){const{data:f,setupState:y,ctx:C}=r;return Np(y,n)?(y[n]=u,!0):f!==Pr&&mr(f,n)?(f[n]=u,!0):mr(r.props,n)||n[0]==="$"&&n.slice(1)in r?!1:(C[n]=u,!0)},has({_:{data:r,setupState:n,accessCache:u,ctx:f,appContext:y,propsOptions:C}},b){let a;return!!u[b]||r!==Pr&&mr(r,b)||Np(n,b)||(a=C[0])&&mr(a,b)||mr(f,b)||mr(Au,b)||mr(y.config.globalProperties,b)},defineProperty(r,n,u){return u.get!=null?r._.accessCache[n]=0:mr(u,"value")&&this.set(r,n,u.value,null),Reflect.defineProperty(r,n,u)}};function X_(r){return Bt(r)?r.reduce((n,u)=>(n[u]=null,n),{}):r}let cm=!0;function Jw(r){const n=Pv(r),u=r.proxy,f=r.ctx;cm=!1,n.beforeCreate&&Y_(n.beforeCreate,r,"bc");const{data:y,computed:C,methods:b,watch:a,provide:I,inject:R,created:$,beforeMount:N,mounted:q,beforeUpdate:V,updated:ie,activated:Pe,deactivated:Ne,beforeDestroy:xe,beforeUnmount:Ge,destroyed:qe,unmounted:be,render:Oe,renderTracked:ct,renderTriggered:ut,errorCaptured:st,serverPrefetch:Qe,expose:gt,inheritAttrs:ot,components:Me,directives:Fe,filters:tt}=n;if(R&&Qw(R,f,null),b)for(const bt in b){const Pt=b[bt];Vt(Pt)&&(f[bt]=Pt.bind(u))}if(y){const bt=y.call(u,u);Fr(bt)&&(r.data=Xl(bt))}if(cm=!0,C)for(const bt in C){const Pt=C[bt],Ut=Vt(Pt)?Pt.bind(u,u):Vt(Pt.get)?Pt.get.bind(u,u):vi,dr=!Vt(Pt)&&Vt(Pt.set)?Pt.set.bind(u):vi,ir=cr({get:Ut,set:dr});Object.defineProperty(f,bt,{enumerable:!0,configurable:!0,get:()=>ir.value,set:Ht=>ir.value=Ht})}if(a)for(const bt in a)kv(a[bt],f,u,bt);if(I){const bt=Vt(I)?I.call(u):I;Reflect.ownKeys(bt).forEach(Pt=>{i2(Pt,bt[Pt])})}$&&Y_($,r,"c");function ft(bt,Pt){Bt(Pt)?Pt.forEach(Ut=>bt(Ut.bind(u))):Pt&&bt(Pt.bind(u))}if(ft(jw,N),ft(df,q),ft(Nw,V),ft(Vw,ie),ft($w,Pe),ft(Ow,Ne),ft(qw,st),ft(Gw,ct),ft(Zw,ut),ft(wv,Ge),ft(Um,be),ft(Uw,Qe),Bt(gt))if(gt.length){const bt=r.exposed||(r.exposed={});gt.forEach(Pt=>{Object.defineProperty(bt,Pt,{get:()=>u[Pt],set:Ut=>u[Pt]=Ut})})}else r.exposed||(r.exposed={});Oe&&r.render===vi&&(r.render=Oe),ot!=null&&(r.inheritAttrs=ot),Me&&(r.components=Me),Fe&&(r.directives=Fe),Qe&&bv(r)}function Qw(r,n,u=vi){Bt(r)&&(r=um(r));for(const f in r){const y=r[f];let C;Fr(y)?"default"in y?C=zu(y.from||f,y.default,!0):C=zu(y.from||f):C=zu(y),ln(C)?Object.defineProperty(n,f,{enumerable:!0,configurable:!0,get:()=>C.value,set:b=>C.value=b}):n[f]=C}}function Y_(r,n,u){oi(Bt(r)?r.map(f=>f.bind(n.proxy)):r.bind(n.proxy),n,u)}function kv(r,n,u,f){let y=f.includes(".")?jv(u,f):()=>u[f];if(Yr(r)){const C=n[r];Vt(C)&&jo(y,C)}else if(Vt(r))jo(y,r.bind(u));else if(Fr(r))if(Bt(r))r.forEach(C=>kv(C,n,u,f));else{const C=Vt(r.handler)?r.handler.bind(u):n[r.handler];Vt(C)&&jo(y,C,r)}}function Pv(r){const n=r.type,{mixins:u,extends:f}=n,{mixins:y,optionsCache:C,config:{optionMergeStrategies:b}}=r.appContext,a=C.get(n);let I;return a?I=a:!y.length&&!u&&!f?I=n:(I={},y.length&&y.forEach(R=>Ud(I,R,b,!0)),Ud(I,n,b)),Fr(n)&&C.set(n,I),I}function Ud(r,n,u,f=!1){const{mixins:y,extends:C}=n;C&&Ud(r,C,u,!0),y&&y.forEach(b=>Ud(r,b,u,!0));for(const b in n)if(!(f&&b==="expose")){const a=e2[b]||u&&u[b];r[b]=a?a(r[b],n[b]):n[b]}return r}const e2={data:K_,props:J_,emits:J_,methods:Su,computed:Su,beforeCreate:eo,created:eo,beforeMount:eo,mounted:eo,beforeUpdate:eo,updated:eo,beforeDestroy:eo,beforeUnmount:eo,destroyed:eo,unmounted:eo,activated:eo,deactivated:eo,errorCaptured:eo,serverPrefetch:eo,components:Su,directives:Su,watch:r2,provide:K_,inject:t2};function K_(r,n){return n?r?function(){return Ln(Vt(r)?r.call(this,this):r,Vt(n)?n.call(this,this):n)}:n:r}function t2(r,n){return Su(um(r),um(n))}function um(r){if(Bt(r)){const n={};for(let u=0;u<r.length;u++)n[r[u]]=r[u];return n}return r}function eo(r,n){return r?[...new Set([].concat(r,n))]:n}function Su(r,n){return r?Ln(Object.create(null),r,n):n}function J_(r,n){return r?Bt(r)&&Bt(n)?[...new Set([...r,...n])]:Ln(Object.create(null),X_(r),X_(n??{})):n}function r2(r,n){if(!r)return n;if(!n)return r;const u=Ln(Object.create(null),r);for(const f in n)u[f]=eo(r[f],n[f]);return u}function Mv(){return{app:null,config:{isNativeTag:$1,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let n2=0;function o2(r,n){return function(f,y=null){Vt(f)||(f=Ln({},f)),y!=null&&!Fr(y)&&(y=null);const C=Mv(),b=new WeakSet,a=[];let I=!1;const R=C.app={_uid:n2++,_component:f,_props:y,_container:null,_context:C,_instance:null,version:j2,get config(){return C.config},set config($){},use($,...N){return b.has($)||($&&Vt($.install)?(b.add($),$.install(R,...N)):Vt($)&&(b.add($),$(R,...N))),R},mixin($){return C.mixins.includes($)||C.mixins.push($),R},component($,N){return N?(C.components[$]=N,R):C.components[$]},directive($,N){return N?(C.directives[$]=N,R):C.directives[$]},mount($,N,q){if(!I){const V=R._ceVNode||Vr(f,y);return V.appContext=C,q===!0?q="svg":q===!1&&(q=void 0),r(V,$,q),I=!0,R._container=$,$.__vue_app__=R,mf(V.component)}},onUnmount($){a.push($)},unmount(){I&&(oi(a,R._instance,16),r(null,R._container),delete R._container.__vue_app__)},provide($,N){return C.provides[$]=N,R},runWithContext($){const N=wa;wa=R;try{return $()}finally{wa=N}}};return R}}let wa=null;function i2(r,n){if(An){let u=An.provides;const f=An.parent&&An.parent.provides;f===u&&(u=An.provides=Object.create(f)),u[r]=n}}function zu(r,n,u=!1){const f=An||Sn;if(f||wa){const y=wa?wa._context.provides:f?f.parent==null?f.vnode.appContext&&f.vnode.appContext.provides:f.parent.provides:void 0;if(y&&r in y)return y[r];if(arguments.length>1)return u&&Vt(n)?n.call(f&&f.proxy):n}}function s2(){return!!(An||Sn||wa)}const Iv={},Ev=()=>Object.create(Iv),Av=r=>Object.getPrototypeOf(r)===Iv;function a2(r,n,u,f=!1){const y={},C=Ev();r.propsDefaults=Object.create(null),zv(r,n,y,C);for(const b in r.propsOptions[0])b in y||(y[b]=void 0);u?r.props=f?y:gw(y):r.type.props?r.props=y:r.props=C,r.attrs=C}function l2(r,n,u,f){const{props:y,attrs:C,vnode:{patchFlag:b}}=r,a=lr(y),[I]=r.propsOptions;let R=!1;if((f||b>0)&&!(b&16)){if(b&8){const $=r.vnode.dynamicProps;for(let N=0;N<$.length;N++){let q=$[N];if(ff(r.emitsOptions,q))continue;const V=n[q];if(I)if(mr(C,q))V!==C[q]&&(C[q]=V,R=!0);else{const ie=Uo(q);y[ie]=hm(I,a,ie,V,r,!1)}else V!==C[q]&&(C[q]=V,R=!0)}}}else{zv(r,n,y,C)&&(R=!0);let $;for(const N in a)(!n||!mr(n,N)&&(($=Ta(N))===N||!mr(n,$)))&&(I?u&&(u[N]!==void 0||u[$]!==void 0)&&(y[N]=hm(I,a,N,void 0,r,!0)):delete y[N]);if(C!==a)for(const N in C)(!n||!mr(n,N))&&(delete C[N],R=!0)}R&&Wi(r.attrs,"set","")}function zv(r,n,u,f){const[y,C]=r.propsOptions;let b=!1,a;if(n)for(let I in n){if(Pu(I))continue;const R=n[I];let $;y&&mr(y,$=Uo(I))?!C||!C.includes($)?u[$]=R:(a||(a={}))[$]=R:ff(r.emitsOptions,I)||(!(I in f)||R!==f[I])&&(f[I]=R,b=!0)}if(C){const I=lr(u),R=a||Pr;for(let $=0;$<C.length;$++){const N=C[$];u[N]=hm(y,I,N,R[N],r,!mr(R,N))}}return b}function hm(r,n,u,f,y,C){const b=r[u];if(b!=null){const a=mr(b,"default");if(a&&f===void 0){const I=b.default;if(b.type!==Function&&!b.skipFactory&&Vt(I)){const{propsDefaults:R}=y;if(u in R)f=R[u];else{const $=ih(y);f=R[u]=I.call(null,n),$()}}else f=I;y.ce&&y.ce._setProp(u,f)}b[0]&&(C&&!a?f=!1:b[1]&&(f===""||f===Ta(u))&&(f=!0))}return f}const c2=new WeakMap;function Rv(r,n,u=!1){const f=u?c2:n.propsCache,y=f.get(r);if(y)return y;const C=r.props,b={},a=[];let I=!1;if(!Vt(r)){const $=N=>{I=!0;const[q,V]=Rv(N,n,!0);Ln(b,q),V&&a.push(...V)};!u&&n.mixins.length&&n.mixins.forEach($),r.extends&&$(r.extends),r.mixins&&r.mixins.forEach($)}if(!C&&!I)return Fr(r)&&f.set(r,Nl),Nl;if(Bt(C))for(let $=0;$<C.length;$++){const N=Uo(C[$]);Q_(N)&&(b[N]=Pr)}else if(C)for(const $ in C){const N=Uo($);if(Q_(N)){const q=C[$],V=b[N]=Bt(q)||Vt(q)?{type:q}:Ln({},q),ie=V.type;let Pe=!1,Ne=!0;if(Bt(ie))for(let xe=0;xe<ie.length;++xe){const Ge=ie[xe],qe=Vt(Ge)&&Ge.name;if(qe==="Boolean"){Pe=!0;break}else qe==="String"&&(Ne=!1)}else Pe=Vt(ie)&&ie.name==="Boolean";V[0]=Pe,V[1]=Ne,(Pe||mr(V,"default"))&&a.push(N)}}const R=[b,a];return Fr(r)&&f.set(r,R),R}function Q_(r){return r[0]!=="$"&&!Pu(r)}const Dv=r=>r[0]==="_"||r==="$stable",Zm=r=>Bt(r)?r.map(_i):[_i(r)],u2=(r,n,u)=>{if(n._n)return n;const f=jd((...y)=>Zm(n(...y)),u);return f._c=!1,f},Lv=(r,n,u)=>{const f=r._ctx;for(const y in r){if(Dv(y))continue;const C=r[y];if(Vt(C))n[y]=u2(y,C,f);else if(C!=null){const b=Zm(C);n[y]=()=>b}}},Bv=(r,n)=>{const u=Zm(n);r.slots.default=()=>u},$v=(r,n,u)=>{for(const f in n)(u||f!=="_")&&(r[f]=n[f])},h2=(r,n,u)=>{const f=r.slots=Ev();if(r.vnode.shapeFlag&32){const y=n._;y?($v(f,n,u),u&&$0(f,"_",y,!0)):Lv(n,f)}else n&&Bv(r,n)},d2=(r,n,u)=>{const{vnode:f,slots:y}=r;let C=!0,b=Pr;if(f.shapeFlag&32){const a=n._;a?u&&a===1?C=!1:$v(y,n,u):(C=!n.$stable,Lv(n,y)),b=n}else n&&(Bv(r,n),b={default:1});if(C)for(const a in y)!Dv(a)&&b[a]==null&&delete y[a]},to=k2;function f2(r){return p2(r)}function p2(r,n){const u=sf();u.__VUE__=!0;const{insert:f,remove:y,patchProp:C,createElement:b,createText:a,createComment:I,setText:R,setElementText:$,parentNode:N,nextSibling:q,setScopeId:V=vi,insertStaticContent:ie}=r,Pe=(ae,pe,Ie,Ke=null,We=null,He=null,lt=void 0,at=null,nt=!!pe.dynamicChildren)=>{if(ae===pe)return;ae&&!va(ae,pe)&&(Ke=Tn(ae),Ht(ae,We,He,!0),ae=null),pe.patchFlag===-2&&(nt=!1,pe.dynamicChildren=null);const{type:Xe,ref:It,shapeFlag:ht}=pe;switch(Xe){case pf:Ne(ae,pe,Ie,Ke);break;case oo:xe(ae,pe,Ie,Ke);break;case Up:ae==null&&Ge(pe,Ie,Ke,lt);break;case an:Me(ae,pe,Ie,Ke,We,He,lt,at,nt);break;default:ht&1?Oe(ae,pe,Ie,Ke,We,He,lt,at,nt):ht&6?Fe(ae,pe,Ie,Ke,We,He,lt,at,nt):(ht&64||ht&128)&&Xe.process(ae,pe,Ie,Ke,We,He,lt,at,nt,qn)}It!=null&&We&&Nd(It,ae&&ae.ref,He,pe||ae,!pe)},Ne=(ae,pe,Ie,Ke)=>{if(ae==null)f(pe.el=a(pe.children),Ie,Ke);else{const We=pe.el=ae.el;pe.children!==ae.children&&R(We,pe.children)}},xe=(ae,pe,Ie,Ke)=>{ae==null?f(pe.el=I(pe.children||""),Ie,Ke):pe.el=ae.el},Ge=(ae,pe,Ie,Ke)=>{[ae.el,ae.anchor]=ie(ae.children,pe,Ie,Ke,ae.el,ae.anchor)},qe=({el:ae,anchor:pe},Ie,Ke)=>{let We;for(;ae&&ae!==pe;)We=q(ae),f(ae,Ie,Ke),ae=We;f(pe,Ie,Ke)},be=({el:ae,anchor:pe})=>{let Ie;for(;ae&&ae!==pe;)Ie=q(ae),y(ae),ae=Ie;y(pe)},Oe=(ae,pe,Ie,Ke,We,He,lt,at,nt)=>{pe.type==="svg"?lt="svg":pe.type==="math"&&(lt="mathml"),ae==null?ct(pe,Ie,Ke,We,He,lt,at,nt):Qe(ae,pe,We,He,lt,at,nt)},ct=(ae,pe,Ie,Ke,We,He,lt,at)=>{let nt,Xe;const{props:It,shapeFlag:ht,transition:St,dirs:Dt}=ae;if(nt=ae.el=b(ae.type,He,It&&It.is,It),ht&8?$(nt,ae.children):ht&16&&st(ae.children,nt,null,Ke,We,Vp(ae,He),lt,at),Dt&&fa(ae,null,Ke,"created"),ut(nt,ae,ae.scopeId,lt,Ke),It){for(const Yt in It)Yt!=="value"&&!Pu(Yt)&&C(nt,Yt,null,It[Yt],He,Ke);"value"in It&&C(nt,"value",null,It.value,He),(Xe=It.onVnodeBeforeMount)&&mi(Xe,Ke,ae)}Dt&&fa(ae,null,Ke,"beforeMount");const Ft=m2(We,St);Ft&&St.beforeEnter(nt),f(nt,pe,Ie),((Xe=It&&It.onVnodeMounted)||Ft||Dt)&&to(()=>{Xe&&mi(Xe,Ke,ae),Ft&&St.enter(nt),Dt&&fa(ae,null,Ke,"mounted")},We)},ut=(ae,pe,Ie,Ke,We)=>{if(Ie&&V(ae,Ie),Ke)for(let He=0;He<Ke.length;He++)V(ae,Ke[He]);if(We){let He=We.subTree;if(pe===He||Vv(He.type)&&(He.ssContent===pe||He.ssFallback===pe)){const lt=We.vnode;ut(ae,lt,lt.scopeId,lt.slotScopeIds,We.parent)}}},st=(ae,pe,Ie,Ke,We,He,lt,at,nt=0)=>{for(let Xe=nt;Xe<ae.length;Xe++){const It=ae[Xe]=at?Is(ae[Xe]):_i(ae[Xe]);Pe(null,It,pe,Ie,Ke,We,He,lt,at)}},Qe=(ae,pe,Ie,Ke,We,He,lt)=>{const at=pe.el=ae.el;let{patchFlag:nt,dynamicChildren:Xe,dirs:It}=pe;nt|=ae.patchFlag&16;const ht=ae.props||Pr,St=pe.props||Pr;let Dt;if(Ie&&pa(Ie,!1),(Dt=St.onVnodeBeforeUpdate)&&mi(Dt,Ie,pe,ae),It&&fa(pe,ae,Ie,"beforeUpdate"),Ie&&pa(Ie,!0),(ht.innerHTML&&St.innerHTML==null||ht.textContent&&St.textContent==null)&&$(at,""),Xe?gt(ae.dynamicChildren,Xe,at,Ie,Ke,Vp(pe,We),He):lt||Pt(ae,pe,at,null,Ie,Ke,Vp(pe,We),He,!1),nt>0){if(nt&16)ot(at,ht,St,Ie,We);else if(nt&2&&ht.class!==St.class&&C(at,"class",null,St.class,We),nt&4&&C(at,"style",ht.style,St.style,We),nt&8){const Ft=pe.dynamicProps;for(let Yt=0;Yt<Ft.length;Yt++){const Zt=Ft[Yt],jr=ht[Zt],Rr=St[Zt];(Rr!==jr||Zt==="value")&&C(at,Zt,jr,Rr,We,Ie)}}nt&1&&ae.children!==pe.children&&$(at,pe.children)}else!lt&&Xe==null&&ot(at,ht,St,Ie,We);((Dt=St.onVnodeUpdated)||It)&&to(()=>{Dt&&mi(Dt,Ie,pe,ae),It&&fa(pe,ae,Ie,"updated")},Ke)},gt=(ae,pe,Ie,Ke,We,He,lt)=>{for(let at=0;at<pe.length;at++){const nt=ae[at],Xe=pe[at],It=nt.el&&(nt.type===an||!va(nt,Xe)||nt.shapeFlag&70)?N(nt.el):Ie;Pe(nt,Xe,It,null,Ke,We,He,lt,!0)}},ot=(ae,pe,Ie,Ke,We)=>{if(pe!==Ie){if(pe!==Pr)for(const He in pe)!Pu(He)&&!(He in Ie)&&C(ae,He,pe[He],null,We,Ke);for(const He in Ie){if(Pu(He))continue;const lt=Ie[He],at=pe[He];lt!==at&&He!=="value"&&C(ae,He,at,lt,We,Ke)}"value"in Ie&&C(ae,"value",pe.value,Ie.value,We)}},Me=(ae,pe,Ie,Ke,We,He,lt,at,nt)=>{const Xe=pe.el=ae?ae.el:a(""),It=pe.anchor=ae?ae.anchor:a("");let{patchFlag:ht,dynamicChildren:St,slotScopeIds:Dt}=pe;Dt&&(at=at?at.concat(Dt):Dt),ae==null?(f(Xe,Ie,Ke),f(It,Ie,Ke),st(pe.children||[],Ie,It,We,He,lt,at,nt)):ht>0&&ht&64&&St&&ae.dynamicChildren?(gt(ae.dynamicChildren,St,Ie,We,He,lt,at),(pe.key!=null||We&&pe===We.subTree)&&Gm(ae,pe,!0)):Pt(ae,pe,Ie,It,We,He,lt,at,nt)},Fe=(ae,pe,Ie,Ke,We,He,lt,at,nt)=>{pe.slotScopeIds=at,ae==null?pe.shapeFlag&512?We.ctx.activate(pe,Ie,Ke,lt,nt):tt(pe,Ie,Ke,We,He,lt,nt):At(ae,pe,nt)},tt=(ae,pe,Ie,Ke,We,He,lt)=>{const at=ae.component=z2(ae,Ke,We);if(uf(ae)&&(at.ctx.renderer=qn),R2(at,!1,lt),at.asyncDep){if(We&&We.registerDep(at,ft,lt),!ae.el){const nt=at.subTree=Vr(oo);xe(null,nt,pe,Ie)}}else ft(at,ae,pe,Ie,We,He,lt)},At=(ae,pe,Ie)=>{const Ke=pe.component=ae.component;if(S2(ae,pe,Ie))if(Ke.asyncDep&&!Ke.asyncResolved){bt(Ke,pe,Ie);return}else Ke.next=pe,Ke.update();else pe.el=ae.el,Ke.vnode=pe},ft=(ae,pe,Ie,Ke,We,He,lt)=>{const at=()=>{if(ae.isMounted){let{next:ht,bu:St,u:Dt,parent:Ft,vnode:Yt}=ae;{const yn=Ov(ae);if(yn){ht&&(ht.el=Yt.el,bt(ae,ht,lt)),yn.asyncDep.then(()=>{ae.isUnmounted||at()});return}}let Zt=ht,jr;pa(ae,!1),ht?(ht.el=Yt.el,bt(ae,ht,lt)):ht=Yt,St&&Lp(St),(jr=ht.props&&ht.props.onVnodeBeforeUpdate)&&mi(jr,Ft,ht,Yt),pa(ae,!0);const Rr=ty(ae),kn=ae.subTree;ae.subTree=Rr,Pe(kn,Rr,N(kn.el),Tn(kn),ae,We,He),ht.el=Rr.el,Zt===null&&T2(ae,Rr.el),Dt&&to(Dt,We),(jr=ht.props&&ht.props.onVnodeUpdated)&&to(()=>mi(jr,Ft,ht,Yt),We)}else{let ht;const{el:St,props:Dt}=pe,{bm:Ft,m:Yt,parent:Zt,root:jr,type:Rr}=ae,kn=Zl(pe);pa(ae,!1),Ft&&Lp(Ft),!kn&&(ht=Dt&&Dt.onVnodeBeforeMount)&&mi(ht,Zt,pe),pa(ae,!0);{jr.ce&&jr.ce._injectChildStyle(Rr);const yn=ae.subTree=ty(ae);Pe(null,yn,Ie,Ke,ae,We,He),pe.el=yn.el}if(Yt&&to(Yt,We),!kn&&(ht=Dt&&Dt.onVnodeMounted)){const yn=pe;to(()=>mi(ht,Zt,yn),We)}(pe.shapeFlag&256||Zt&&Zl(Zt.vnode)&&Zt.vnode.shapeFlag&256)&&ae.a&&to(ae.a,We),ae.isMounted=!0,pe=Ie=Ke=null}};ae.scope.on();const nt=ae.effect=new Z0(at);ae.scope.off();const Xe=ae.update=nt.run.bind(nt),It=ae.job=nt.runIfDirty.bind(nt);It.i=ae,It.id=ae.uid,nt.scheduler=()=>Vm(It),pa(ae,!0),Xe()},bt=(ae,pe,Ie)=>{pe.component=ae;const Ke=ae.vnode.props;ae.vnode=pe,ae.next=null,l2(ae,pe.props,Ke,Ie),d2(ae,pe.children,Ie),Os(),U_(ae),Fs()},Pt=(ae,pe,Ie,Ke,We,He,lt,at,nt=!1)=>{const Xe=ae&&ae.children,It=ae?ae.shapeFlag:0,ht=pe.children,{patchFlag:St,shapeFlag:Dt}=pe;if(St>0){if(St&128){dr(Xe,ht,Ie,Ke,We,He,lt,at,nt);return}else if(St&256){Ut(Xe,ht,Ie,Ke,We,He,lt,at,nt);return}}Dt&8?(It&16&&Kr(Xe,We,He),ht!==Xe&&$(Ie,ht)):It&16?Dt&16?dr(Xe,ht,Ie,Ke,We,He,lt,at,nt):Kr(Xe,We,He,!0):(It&8&&$(Ie,""),Dt&16&&st(ht,Ie,Ke,We,He,lt,at,nt))},Ut=(ae,pe,Ie,Ke,We,He,lt,at,nt)=>{ae=ae||Nl,pe=pe||Nl;const Xe=ae.length,It=pe.length,ht=Math.min(Xe,It);let St;for(St=0;St<ht;St++){const Dt=pe[St]=nt?Is(pe[St]):_i(pe[St]);Pe(ae[St],Dt,Ie,null,We,He,lt,at,nt)}Xe>It?Kr(ae,We,He,!0,!1,ht):st(pe,Ie,Ke,We,He,lt,at,nt,ht)},dr=(ae,pe,Ie,Ke,We,He,lt,at,nt)=>{let Xe=0;const It=pe.length;let ht=ae.length-1,St=It-1;for(;Xe<=ht&&Xe<=St;){const Dt=ae[Xe],Ft=pe[Xe]=nt?Is(pe[Xe]):_i(pe[Xe]);if(va(Dt,Ft))Pe(Dt,Ft,Ie,null,We,He,lt,at,nt);else break;Xe++}for(;Xe<=ht&&Xe<=St;){const Dt=ae[ht],Ft=pe[St]=nt?Is(pe[St]):_i(pe[St]);if(va(Dt,Ft))Pe(Dt,Ft,Ie,null,We,He,lt,at,nt);else break;ht--,St--}if(Xe>ht){if(Xe<=St){const Dt=St+1,Ft=Dt<It?pe[Dt].el:Ke;for(;Xe<=St;)Pe(null,pe[Xe]=nt?Is(pe[Xe]):_i(pe[Xe]),Ie,Ft,We,He,lt,at,nt),Xe++}}else if(Xe>St)for(;Xe<=ht;)Ht(ae[Xe],We,He,!0),Xe++;else{const Dt=Xe,Ft=Xe,Yt=new Map;for(Xe=Ft;Xe<=St;Xe++){const ge=pe[Xe]=nt?Is(pe[Xe]):_i(pe[Xe]);ge.key!=null&&Yt.set(ge.key,Xe)}let Zt,jr=0;const Rr=St-Ft+1;let kn=!1,yn=0;const xo=new Array(Rr);for(Xe=0;Xe<Rr;Xe++)xo[Xe]=0;for(Xe=Dt;Xe<=ht;Xe++){const ge=ae[Xe];if(jr>=Rr){Ht(ge,We,He,!0);continue}let z;if(ge.key!=null)z=Yt.get(ge.key);else for(Zt=Ft;Zt<=St;Zt++)if(xo[Zt-Ft]===0&&va(ge,pe[Zt])){z=Zt;break}z===void 0?Ht(ge,We,He,!0):(xo[z-Ft]=Xe+1,z>=yn?yn=z:kn=!0,Pe(ge,pe[z],Ie,null,We,He,lt,at,nt),jr++)}const io=kn?g2(xo):Nl;for(Zt=io.length-1,Xe=Rr-1;Xe>=0;Xe--){const ge=Ft+Xe,z=pe[ge],W=ge+1<It?pe[ge+1].el:Ke;xo[Xe]===0?Pe(null,z,Ie,W,We,He,lt,at,nt):kn&&(Zt<0||Xe!==io[Zt]?ir(z,Ie,W,2):Zt--)}}},ir=(ae,pe,Ie,Ke,We=null)=>{const{el:He,type:lt,transition:at,children:nt,shapeFlag:Xe}=ae;if(Xe&6){ir(ae.component.subTree,pe,Ie,Ke);return}if(Xe&128){ae.suspense.move(pe,Ie,Ke);return}if(Xe&64){lt.move(ae,pe,Ie,qn);return}if(lt===an){f(He,pe,Ie);for(let ht=0;ht<nt.length;ht++)ir(nt[ht],pe,Ie,Ke);f(ae.anchor,pe,Ie);return}if(lt===Up){qe(ae,pe,Ie);return}if(Ke!==2&&Xe&1&&at)if(Ke===0)at.beforeEnter(He),f(He,pe,Ie),to(()=>at.enter(He),We);else{const{leave:ht,delayLeave:St,afterLeave:Dt}=at,Ft=()=>f(He,pe,Ie),Yt=()=>{ht(He,()=>{Ft(),Dt&&Dt()})};St?St(He,Ft,Yt):Yt()}else f(He,pe,Ie)},Ht=(ae,pe,Ie,Ke=!1,We=!1)=>{const{type:He,props:lt,ref:at,children:nt,dynamicChildren:Xe,shapeFlag:It,patchFlag:ht,dirs:St,cacheIndex:Dt}=ae;if(ht===-2&&(We=!1),at!=null&&Nd(at,null,Ie,ae,!0),Dt!=null&&(pe.renderCache[Dt]=void 0),It&256){pe.ctx.deactivate(ae);return}const Ft=It&1&&St,Yt=!Zl(ae);let Zt;if(Yt&&(Zt=lt&&lt.onVnodeBeforeUnmount)&&mi(Zt,pe,ae),It&6)Cr(ae.component,Ie,Ke);else{if(It&128){ae.suspense.unmount(Ie,Ke);return}Ft&&fa(ae,null,pe,"beforeUnmount"),It&64?ae.type.remove(ae,pe,Ie,qn,Ke):Xe&&!Xe.hasOnce&&(He!==an||ht>0&&ht&64)?Kr(Xe,pe,Ie,!1,!0):(He===an&&ht&384||!We&&It&16)&&Kr(nt,pe,Ie),Ke&&Mr(ae)}(Yt&&(Zt=lt&&lt.onVnodeUnmounted)||Ft)&&to(()=>{Zt&&mi(Zt,pe,ae),Ft&&fa(ae,null,pe,"unmounted")},Ie)},Mr=ae=>{const{type:pe,el:Ie,anchor:Ke,transition:We}=ae;if(pe===an){zr(Ie,Ke);return}if(pe===Up){be(ae);return}const He=()=>{y(Ie),We&&!We.persisted&&We.afterLeave&&We.afterLeave()};if(ae.shapeFlag&1&&We&&!We.persisted){const{leave:lt,delayLeave:at}=We,nt=()=>lt(Ie,He);at?at(ae.el,He,nt):nt()}else He()},zr=(ae,pe)=>{let Ie;for(;ae!==pe;)Ie=q(ae),y(ae),ae=Ie;y(pe)},Cr=(ae,pe,Ie)=>{const{bum:Ke,scope:We,job:He,subTree:lt,um:at,m:nt,a:Xe}=ae;ey(nt),ey(Xe),Ke&&Lp(Ke),We.stop(),He&&(He.flags|=8,Ht(lt,ae,pe,Ie)),at&&to(at,pe),to(()=>{ae.isUnmounted=!0},pe),pe&&pe.pendingBranch&&!pe.isUnmounted&&ae.asyncDep&&!ae.asyncResolved&&ae.suspenseId===pe.pendingId&&(pe.deps--,pe.deps===0&&pe.resolve())},Kr=(ae,pe,Ie,Ke=!1,We=!1,He=0)=>{for(let lt=He;lt<ae.length;lt++)Ht(ae[lt],pe,Ie,Ke,We)},Tn=ae=>{if(ae.shapeFlag&6)return Tn(ae.component.subTree);if(ae.shapeFlag&128)return ae.suspense.next();const pe=q(ae.anchor||ae.el),Ie=pe&&pe[hv];return Ie?q(Ie):pe};let Gn=!1;const cn=(ae,pe,Ie)=>{ae==null?pe._vnode&&Ht(pe._vnode,null,null,!0):Pe(pe._vnode||null,ae,pe,null,null,null,Ie),pe._vnode=ae,Gn||(Gn=!0,U_(),lv(),Gn=!1)},qn={p:Pe,um:Ht,m:ir,r:Mr,mt:tt,mc:st,pc:Pt,pbc:gt,n:Tn,o:r};return{render:cn,hydrate:void 0,createApp:o2(cn)}}function Vp({type:r,props:n},u){return u==="svg"&&r==="foreignObject"||u==="mathml"&&r==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:u}function pa({effect:r,job:n},u){u?(r.flags|=32,n.flags|=4):(r.flags&=-33,n.flags&=-5)}function m2(r,n){return(!r||r&&!r.pendingBranch)&&n&&!n.persisted}function Gm(r,n,u=!1){const f=r.children,y=n.children;if(Bt(f)&&Bt(y))for(let C=0;C<f.length;C++){const b=f[C];let a=y[C];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=y[C]=Is(y[C]),a.el=b.el),!u&&a.patchFlag!==-2&&Gm(b,a)),a.type===pf&&(a.el=b.el)}}function g2(r){const n=r.slice(),u=[0];let f,y,C,b,a;const I=r.length;for(f=0;f<I;f++){const R=r[f];if(R!==0){if(y=u[u.length-1],r[y]<R){n[f]=y,u.push(f);continue}for(C=0,b=u.length-1;C<b;)a=C+b>>1,r[u[a]]<R?C=a+1:b=a;R<r[u[C]]&&(C>0&&(n[f]=u[C-1]),u[C]=f)}}for(C=u.length,b=u[C-1];C-- >0;)u[C]=b,b=n[b];return u}function Ov(r){const n=r.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:Ov(n)}function ey(r){if(r)for(let n=0;n<r.length;n++)r[n].flags|=8}const _2=Symbol.for("v-scx"),y2=()=>zu(_2);function jo(r,n,u){return Fv(r,n,u)}function Fv(r,n,u=Pr){const{immediate:f,deep:y,flush:C,once:b}=u,a=Ln({},u),I=n&&f||!n&&C!=="post";let R;if(Uu){if(C==="sync"){const V=y2();R=V.__watcherHandles||(V.__watcherHandles=[])}else if(!I){const V=()=>{};return V.stop=vi,V.resume=vi,V.pause=vi,V}}const $=An;a.call=(V,ie,Pe)=>oi(V,$,ie,Pe);let N=!1;C==="post"?a.scheduler=V=>{to(V,$&&$.suspense)}:C!=="sync"&&(N=!0,a.scheduler=(V,ie)=>{ie?V():Vm(V)}),a.augmentJob=V=>{n&&(V.flags|=4),N&&(V.flags|=2,$&&(V.id=$.uid,V.i=$))};const q=kw(r,n,a);return Uu&&(R?R.push(q):I&&q()),q}function v2(r,n,u){const f=this.proxy,y=Yr(r)?r.includes(".")?jv(f,r):()=>f[r]:r.bind(f,f);let C;Vt(n)?C=n:(C=n.handler,u=n);const b=ih(this),a=Fv(y,C.bind(f),u);return b(),a}function jv(r,n){const u=n.split(".");return()=>{let f=r;for(let y=0;y<u.length&&f;y++)f=f[u[y]];return f}}const b2=(r,n)=>n==="modelValue"||n==="model-value"?r.modelModifiers:r[`${n}Modifiers`]||r[`${Uo(n)}Modifiers`]||r[`${Ta(n)}Modifiers`];function x2(r,n,...u){if(r.isUnmounted)return;const f=r.vnode.props||Pr;let y=u;const C=n.startsWith("update:"),b=C&&b2(f,n.slice(7));b&&(b.trim&&(y=u.map($=>Yr($)?$.trim():$)),b.number&&(y=u.map(V1)));let a,I=f[a=Dp(n)]||f[a=Dp(Uo(n))];!I&&C&&(I=f[a=Dp(Ta(n))]),I&&oi(I,r,6,y);const R=f[a+"Once"];if(R){if(!r.emitted)r.emitted={};else if(r.emitted[a])return;r.emitted[a]=!0,oi(R,r,6,y)}}function Nv(r,n,u=!1){const f=n.emitsCache,y=f.get(r);if(y!==void 0)return y;const C=r.emits;let b={},a=!1;if(!Vt(r)){const I=R=>{const $=Nv(R,n,!0);$&&(a=!0,Ln(b,$))};!u&&n.mixins.length&&n.mixins.forEach(I),r.extends&&I(r.extends),r.mixins&&r.mixins.forEach(I)}return!C&&!a?(Fr(r)&&f.set(r,null),null):(Bt(C)?C.forEach(I=>b[I]=null):Ln(b,C),Fr(r)&&f.set(r,b),b)}function ff(r,n){return!r||!tf(n)?!1:(n=n.slice(2).replace(/Once$/,""),mr(r,n[0].toLowerCase()+n.slice(1))||mr(r,Ta(n))||mr(r,n))}function ty(r){const{type:n,vnode:u,proxy:f,withProxy:y,propsOptions:[C],slots:b,attrs:a,emit:I,render:R,renderCache:$,props:N,data:q,setupState:V,ctx:ie,inheritAttrs:Pe}=r,Ne=Fd(r);let xe,Ge;try{if(u.shapeFlag&4){const be=y||f,Oe=be;xe=_i(R.call(Oe,be,$,N,V,q,ie)),Ge=a}else{const be=n;xe=_i(be.length>1?be(N,{attrs:a,slots:b,emit:I}):be(N,null)),Ge=n.props?a:w2(a)}}catch(be){Ru.length=0,cf(be,r,1),xe=Vr(oo)}let qe=xe;if(Ge&&Pe!==!1){const be=Object.keys(Ge),{shapeFlag:Oe}=qe;be.length&&Oe&7&&(C&&be.some(Im)&&(Ge=C2(Ge,C)),qe=$s(qe,Ge,!1,!0))}return u.dirs&&(qe=$s(qe,null,!1,!0),qe.dirs=qe.dirs?qe.dirs.concat(u.dirs):u.dirs),u.transition&&ju(qe,u.transition),xe=qe,Fd(Ne),xe}const w2=r=>{let n;for(const u in r)(u==="class"||u==="style"||tf(u))&&((n||(n={}))[u]=r[u]);return n},C2=(r,n)=>{const u={};for(const f in r)(!Im(f)||!(f.slice(9)in n))&&(u[f]=r[f]);return u};function S2(r,n,u){const{props:f,children:y,component:C}=r,{props:b,children:a,patchFlag:I}=n,R=C.emitsOptions;if(n.dirs||n.transition)return!0;if(u&&I>=0){if(I&1024)return!0;if(I&16)return f?ry(f,b,R):!!b;if(I&8){const $=n.dynamicProps;for(let N=0;N<$.length;N++){const q=$[N];if(b[q]!==f[q]&&!ff(R,q))return!0}}}else return(y||a)&&(!a||!a.$stable)?!0:f===b?!1:f?b?ry(f,b,R):!0:!!b;return!1}function ry(r,n,u){const f=Object.keys(n);if(f.length!==Object.keys(r).length)return!0;for(let y=0;y<f.length;y++){const C=f[y];if(n[C]!==r[C]&&!ff(u,C))return!0}return!1}function T2({vnode:r,parent:n},u){for(;n;){const f=n.subTree;if(f.suspense&&f.suspense.activeBranch===r&&(f.el=r.el),f===r)(r=n.vnode).el=u,n=n.parent;else break}}const Vv=r=>r.__isSuspense;function k2(r,n){n&&n.pendingBranch?Bt(r)?n.effects.push(...r):n.effects.push(r):Iw(r)}const an=Symbol.for("v-fgt"),pf=Symbol.for("v-txt"),oo=Symbol.for("v-cmt"),Up=Symbol.for("v-stc"),Ru=[];let Ao=null;function sr(r=!1){Ru.push(Ao=r?null:[])}function P2(){Ru.pop(),Ao=Ru[Ru.length-1]||null}let Nu=1;function ny(r,n=!1){Nu+=r,r<0&&Ao&&n&&(Ao.hasOnce=!0)}function Uv(r){return r.dynamicChildren=Nu>0?Ao||Nl:null,P2(),Nu>0&&Ao&&Ao.push(r),r}function Ar(r,n,u,f,y,C){return Uv(Wt(r,n,u,f,y,C,!0))}function Bs(r,n,u,f,y){return Uv(Vr(r,n,u,f,y,!0))}function Vu(r){return r?r.__v_isVNode===!0:!1}function va(r,n){return r.type===n.type&&r.key===n.key}const Zv=({key:r})=>r??null,Rd=({ref:r,ref_key:n,ref_for:u})=>(typeof r=="number"&&(r=""+r),r!=null?Yr(r)||ln(r)||Vt(r)?{i:Sn,r,k:n,f:!!u}:r:null);function Wt(r,n=null,u=null,f=0,y=null,C=r===an?0:1,b=!1,a=!1){const I={__v_isVNode:!0,__v_skip:!0,type:r,props:n,key:n&&Zv(n),ref:n&&Rd(n),scopeId:uv,slotScopeIds:null,children:u,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:C,patchFlag:f,dynamicProps:y,dynamicChildren:null,appContext:null,ctx:Sn};return a?(qm(I,u),C&128&&r.normalize(I)):u&&(I.shapeFlag|=Yr(u)?8:16),Nu>0&&!b&&Ao&&(I.patchFlag>0||C&6)&&I.patchFlag!==32&&Ao.push(I),I}const Vr=M2;function M2(r,n=null,u=null,f=0,y=null,C=!1){if((!r||r===Xw)&&(r=oo),Vu(r)){const a=$s(r,n,!0);return u&&qm(a,u),Nu>0&&!C&&Ao&&(a.shapeFlag&6?Ao[Ao.indexOf(r)]=a:Ao.push(a)),a.patchFlag=-2,a}if(O2(r)&&(r=r.__vccOpts),n){n=I2(n);let{class:a,style:I}=n;a&&!Yr(a)&&(n.class=af(a)),Fr(I)&&(Fm(I)&&!Bt(I)&&(I=Ln({},I)),n.style=Ls(I))}const b=Yr(r)?1:Vv(r)?128:dv(r)?64:Fr(r)?4:Vt(r)?2:0;return Wt(r,n,u,f,y,b,C,!0)}function I2(r){return r?Fm(r)||Av(r)?Ln({},r):r:null}function $s(r,n,u=!1,f=!1){const{props:y,ref:C,patchFlag:b,children:a,transition:I}=r,R=n?Ds(y||{},n):y,$={__v_isVNode:!0,__v_skip:!0,type:r.type,props:R,key:R&&Zv(R),ref:n&&n.ref?u&&C?Bt(C)?C.concat(Rd(n)):[C,Rd(n)]:Rd(n):C,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:a,target:r.target,targetStart:r.targetStart,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:n&&r.type!==an?b===-1?16:b|16:b,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:I,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&$s(r.ssContent),ssFallback:r.ssFallback&&$s(r.ssFallback),el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce};return I&&f&&ju($,I.clone($)),$}function Gv(r=" ",n=0){return Vr(pf,null,r,n)}function Zo(r="",n=!1){return n?(sr(),Bs(oo,null,r)):Vr(oo,null,r)}function _i(r){return r==null||typeof r=="boolean"?Vr(oo):Bt(r)?Vr(an,null,r.slice()):Vu(r)?Is(r):Vr(pf,null,String(r))}function Is(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:$s(r)}function qm(r,n){let u=0;const{shapeFlag:f}=r;if(n==null)n=null;else if(Bt(n))u=16;else if(typeof n=="object")if(f&65){const y=n.default;y&&(y._c&&(y._d=!1),qm(r,y()),y._c&&(y._d=!0));return}else{u=32;const y=n._;!y&&!Av(n)?n._ctx=Sn:y===3&&Sn&&(Sn.slots._===1?n._=1:(n._=2,r.patchFlag|=1024))}else Vt(n)?(n={default:n,_ctx:Sn},u=32):(n=String(n),f&64?(u=16,n=[Gv(n)]):u=8);r.children=n,r.shapeFlag|=u}function Ds(...r){const n={};for(let u=0;u<r.length;u++){const f=r[u];for(const y in f)if(y==="class")n.class!==f.class&&(n.class=af([n.class,f.class]));else if(y==="style")n.style=Ls([n.style,f.style]);else if(tf(y)){const C=n[y],b=f[y];b&&C!==b&&!(Bt(C)&&C.includes(b))&&(n[y]=C?[].concat(C,b):b)}else y!==""&&(n[y]=f[y])}return n}function mi(r,n,u,f=null){oi(r,n,7,[u,f])}const E2=Mv();let A2=0;function z2(r,n,u){const f=r.type,y=(n?n.appContext:r.appContext)||E2,C={uid:A2++,vnode:r,type:f,parent:n,appContext:y,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new N0(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(y.provides),ids:n?n.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Rv(f,y),emitsOptions:Nv(f,y),emit:null,emitted:null,propsDefaults:Pr,inheritAttrs:f.inheritAttrs,ctx:Pr,data:Pr,props:Pr,attrs:Pr,slots:Pr,refs:Pr,setupState:Pr,setupContext:null,suspense:u,suspenseId:u?u.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return C.ctx={_:C},C.root=n?n.root:C,C.emit=x2.bind(null,C),r.ce&&r.ce(C),C}let An=null;const Wm=()=>An||Sn;let Zd,dm;{const r=sf(),n=(u,f)=>{let y;return(y=r[u])||(y=r[u]=[]),y.push(f),C=>{y.length>1?y.forEach(b=>b(C)):y[0](C)}};Zd=n("__VUE_INSTANCE_SETTERS__",u=>An=u),dm=n("__VUE_SSR_SETTERS__",u=>Uu=u)}const ih=r=>{const n=An;return Zd(r),r.scope.on(),()=>{r.scope.off(),Zd(n)}},oy=()=>{An&&An.scope.off(),Zd(null)};function qv(r){return r.vnode.shapeFlag&4}let Uu=!1;function R2(r,n=!1,u=!1){n&&dm(n);const{props:f,children:y}=r.vnode,C=qv(r);a2(r,f,C,n),h2(r,y,u);const b=C?D2(r,n):void 0;return n&&dm(!1),b}function D2(r,n){const u=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,Kw);const{setup:f}=u;if(f){Os();const y=r.setupContext=f.length>1?B2(r):null,C=ih(r),b=oh(f,r,0,[r.props,y]),a=D0(b);if(Fs(),C(),(a||r.sp)&&!Zl(r)&&bv(r),a){if(b.then(oy,oy),n)return b.then(I=>{iy(r,I)}).catch(I=>{cf(I,r,0)});r.asyncDep=b}else iy(r,b)}else Wv(r)}function iy(r,n,u){Vt(n)?r.type.__ssrInlineRender?r.ssrRender=n:r.render=n:Fr(n)&&(r.setupState=iv(n)),Wv(r)}function Wv(r,n,u){const f=r.type;r.render||(r.render=f.render||vi);{const y=ih(r);Os();try{Jw(r)}finally{Fs(),y()}}}const L2={get(r,n){return Un(r,"get",""),r[n]}};function B2(r){const n=u=>{r.exposed=u||{}};return{attrs:new Proxy(r.attrs,L2),slots:r.slots,emit:r.emit,expose:n}}function mf(r){return r.exposed?r.exposeProxy||(r.exposeProxy=new Proxy(iv(jm(r.exposed)),{get(n,u){if(u in n)return n[u];if(u in Au)return Au[u](r)},has(n,u){return u in n||u in Au}})):r.proxy}function $2(r,n=!0){return Vt(r)?r.displayName||r.name:r.name||n&&r.__name}function O2(r){return Vt(r)&&"__vccOpts"in r}const cr=(r,n)=>Sw(r,n,Uu);function F2(r,n,u){const f=arguments.length;return f===2?Fr(n)&&!Bt(n)?Vu(n)?Vr(r,null,[n]):Vr(r,n):Vr(r,null,n):(f>3?u=Array.prototype.slice.call(arguments,2):f===3&&Vu(u)&&(u=[u]),Vr(r,n,u))}const j2="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let fm;const sy=typeof window<"u"&&window.trustedTypes;if(sy)try{fm=sy.createPolicy("vue",{createHTML:r=>r})}catch{}const Hv=fm?r=>fm.createHTML(r):r=>r,N2="http://www.w3.org/2000/svg",V2="http://www.w3.org/1998/Math/MathML",qi=typeof document<"u"?document:null,ay=qi&&qi.createElement("template"),U2={insert:(r,n,u)=>{n.insertBefore(r,u||null)},remove:r=>{const n=r.parentNode;n&&n.removeChild(r)},createElement:(r,n,u,f)=>{const y=n==="svg"?qi.createElementNS(N2,r):n==="mathml"?qi.createElementNS(V2,r):u?qi.createElement(r,{is:u}):qi.createElement(r);return r==="select"&&f&&f.multiple!=null&&y.setAttribute("multiple",f.multiple),y},createText:r=>qi.createTextNode(r),createComment:r=>qi.createComment(r),setText:(r,n)=>{r.nodeValue=n},setElementText:(r,n)=>{r.textContent=n},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>qi.querySelector(r),setScopeId(r,n){r.setAttribute(n,"")},insertStaticContent(r,n,u,f,y,C){const b=u?u.previousSibling:n.lastChild;if(y&&(y===C||y.nextSibling))for(;n.insertBefore(y.cloneNode(!0),u),!(y===C||!(y=y.nextSibling)););else{ay.innerHTML=Hv(f==="svg"?`<svg>${r}</svg>`:f==="mathml"?`<math>${r}</math>`:r);const a=ay.content;if(f==="svg"||f==="mathml"){const I=a.firstChild;for(;I.firstChild;)a.appendChild(I.firstChild);a.removeChild(I)}n.insertBefore(a,u)}return[b?b.nextSibling:n.firstChild,u?u.previousSibling:n.lastChild]}},Ss="transition",_u="animation",Zu=Symbol("_vtc"),Xv={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Z2=Ln({},mv,Xv),G2=r=>(r.displayName="Transition",r.props=Z2,r),q2=G2((r,{slots:n})=>F2(Lw,W2(r),n)),ma=(r,n=[])=>{Bt(r)?r.forEach(u=>u(...n)):r&&r(...n)},ly=r=>r?Bt(r)?r.some(n=>n.length>1):r.length>1:!1;function W2(r){const n={};for(const Me in r)Me in Xv||(n[Me]=r[Me]);if(r.css===!1)return n;const{name:u="v",type:f,duration:y,enterFromClass:C=`${u}-enter-from`,enterActiveClass:b=`${u}-enter-active`,enterToClass:a=`${u}-enter-to`,appearFromClass:I=C,appearActiveClass:R=b,appearToClass:$=a,leaveFromClass:N=`${u}-leave-from`,leaveActiveClass:q=`${u}-leave-active`,leaveToClass:V=`${u}-leave-to`}=r,ie=H2(y),Pe=ie&&ie[0],Ne=ie&&ie[1],{onBeforeEnter:xe,onEnter:Ge,onEnterCancelled:qe,onLeave:be,onLeaveCancelled:Oe,onBeforeAppear:ct=xe,onAppear:ut=Ge,onAppearCancelled:st=qe}=n,Qe=(Me,Fe,tt,At)=>{Me._enterCancelled=At,ga(Me,Fe?$:a),ga(Me,Fe?R:b),tt&&tt()},gt=(Me,Fe)=>{Me._isLeaving=!1,ga(Me,N),ga(Me,V),ga(Me,q),Fe&&Fe()},ot=Me=>(Fe,tt)=>{const At=Me?ut:Ge,ft=()=>Qe(Fe,Me,tt);ma(At,[Fe,ft]),cy(()=>{ga(Fe,Me?I:C),Zi(Fe,Me?$:a),ly(At)||uy(Fe,f,Pe,ft)})};return Ln(n,{onBeforeEnter(Me){ma(xe,[Me]),Zi(Me,C),Zi(Me,b)},onBeforeAppear(Me){ma(ct,[Me]),Zi(Me,I),Zi(Me,R)},onEnter:ot(!1),onAppear:ot(!0),onLeave(Me,Fe){Me._isLeaving=!0;const tt=()=>gt(Me,Fe);Zi(Me,N),Me._enterCancelled?(Zi(Me,q),fy()):(fy(),Zi(Me,q)),cy(()=>{Me._isLeaving&&(ga(Me,N),Zi(Me,V),ly(be)||uy(Me,f,Ne,tt))}),ma(be,[Me,tt])},onEnterCancelled(Me){Qe(Me,!1,void 0,!0),ma(qe,[Me])},onAppearCancelled(Me){Qe(Me,!0,void 0,!0),ma(st,[Me])},onLeaveCancelled(Me){gt(Me),ma(Oe,[Me])}})}function H2(r){if(r==null)return null;if(Fr(r))return[Zp(r.enter),Zp(r.leave)];{const n=Zp(r);return[n,n]}}function Zp(r){return U1(r)}function Zi(r,n){n.split(/\s+/).forEach(u=>u&&r.classList.add(u)),(r[Zu]||(r[Zu]=new Set)).add(n)}function ga(r,n){n.split(/\s+/).forEach(f=>f&&r.classList.remove(f));const u=r[Zu];u&&(u.delete(n),u.size||(r[Zu]=void 0))}function cy(r){requestAnimationFrame(()=>{requestAnimationFrame(r)})}let X2=0;function uy(r,n,u,f){const y=r._endId=++X2,C=()=>{y===r._endId&&f()};if(u!=null)return setTimeout(C,u);const{type:b,timeout:a,propCount:I}=Y2(r,n);if(!b)return f();const R=b+"end";let $=0;const N=()=>{r.removeEventListener(R,q),C()},q=V=>{V.target===r&&++$>=I&&N()};setTimeout(()=>{$<I&&N()},a+1),r.addEventListener(R,q)}function Y2(r,n){const u=window.getComputedStyle(r),f=ie=>(u[ie]||"").split(", "),y=f(`${Ss}Delay`),C=f(`${Ss}Duration`),b=hy(y,C),a=f(`${_u}Delay`),I=f(`${_u}Duration`),R=hy(a,I);let $=null,N=0,q=0;n===Ss?b>0&&($=Ss,N=b,q=C.length):n===_u?R>0&&($=_u,N=R,q=I.length):(N=Math.max(b,R),$=N>0?b>R?Ss:_u:null,q=$?$===Ss?C.length:I.length:0);const V=$===Ss&&/\b(transform|all)(,|$)/.test(f(`${Ss}Property`).toString());return{type:$,timeout:N,propCount:q,hasTransform:V}}function hy(r,n){for(;r.length<n.length;)r=r.concat(r);return Math.max(...n.map((u,f)=>dy(u)+dy(r[f])))}function dy(r){return r==="auto"?0:Number(r.slice(0,-1).replace(",","."))*1e3}function fy(){return document.body.offsetHeight}function K2(r,n,u){const f=r[Zu];f&&(n=(n?[n,...f]:[...f]).join(" ")),n==null?r.removeAttribute("class"):u?r.setAttribute("class",n):r.className=n}const py=Symbol("_vod"),J2=Symbol("_vsh"),Q2=Symbol(""),eC=/(^|;)\s*display\s*:/;function tC(r,n,u){const f=r.style,y=Yr(u);let C=!1;if(u&&!y){if(n)if(Yr(n))for(const b of n.split(";")){const a=b.slice(0,b.indexOf(":")).trim();u[a]==null&&Dd(f,a,"")}else for(const b in n)u[b]==null&&Dd(f,b,"");for(const b in u)b==="display"&&(C=!0),Dd(f,b,u[b])}else if(y){if(n!==u){const b=f[Q2];b&&(u+=";"+b),f.cssText=u,C=eC.test(u)}}else n&&r.removeAttribute("style");py in r&&(r[py]=C?f.display:"",r[J2]&&(f.display="none"))}const my=/\s*!important$/;function Dd(r,n,u){if(Bt(u))u.forEach(f=>Dd(r,n,f));else if(u==null&&(u=""),n.startsWith("--"))r.setProperty(n,u);else{const f=rC(r,n);my.test(u)?r.setProperty(Ta(f),u.replace(my,""),"important"):r[f]=u}}const gy=["Webkit","Moz","ms"],Gp={};function rC(r,n){const u=Gp[n];if(u)return u;let f=Uo(n);if(f!=="filter"&&f in r)return Gp[n]=f;f=of(f);for(let y=0;y<gy.length;y++){const C=gy[y]+f;if(C in r)return Gp[n]=C}return n}const _y="http://www.w3.org/1999/xlink";function yy(r,n,u,f,y,C=X1(n)){f&&n.startsWith("xlink:")?u==null?r.removeAttributeNS(_y,n.slice(6,n.length)):r.setAttributeNS(_y,n,u):u==null||C&&!O0(u)?r.removeAttribute(n):r.setAttribute(n,C?"":Ki(u)?String(u):u)}function vy(r,n,u,f,y){if(n==="innerHTML"||n==="textContent"){u!=null&&(r[n]=n==="innerHTML"?Hv(u):u);return}const C=r.tagName;if(n==="value"&&C!=="PROGRESS"&&!C.includes("-")){const a=C==="OPTION"?r.getAttribute("value")||"":r.value,I=u==null?r.type==="checkbox"?"on":"":String(u);(a!==I||!("_value"in r))&&(r.value=I),u==null&&r.removeAttribute(n),r._value=u;return}let b=!1;if(u===""||u==null){const a=typeof r[n];a==="boolean"?u=O0(u):u==null&&a==="string"?(u="",b=!0):a==="number"&&(u=0,b=!0)}try{r[n]=u}catch{}b&&r.removeAttribute(y||n)}function nC(r,n,u,f){r.addEventListener(n,u,f)}function oC(r,n,u,f){r.removeEventListener(n,u,f)}const by=Symbol("_vei");function iC(r,n,u,f,y=null){const C=r[by]||(r[by]={}),b=C[n];if(f&&b)b.value=f;else{const[a,I]=sC(n);if(f){const R=C[n]=cC(f,y);nC(r,a,R,I)}else b&&(oC(r,a,b,I),C[n]=void 0)}}const xy=/(?:Once|Passive|Capture)$/;function sC(r){let n;if(xy.test(r)){n={};let f;for(;f=r.match(xy);)r=r.slice(0,r.length-f[0].length),n[f[0].toLowerCase()]=!0}return[r[2]===":"?r.slice(3):Ta(r.slice(2)),n]}let qp=0;const aC=Promise.resolve(),lC=()=>qp||(aC.then(()=>qp=0),qp=Date.now());function cC(r,n){const u=f=>{if(!f._vts)f._vts=Date.now();else if(f._vts<=u.attached)return;oi(uC(f,u.value),n,5,[f])};return u.value=r,u.attached=lC(),u}function uC(r,n){if(Bt(n)){const u=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{u.call(r),r._stopped=!0},n.map(f=>y=>!y._stopped&&f&&f(y))}else return n}const wy=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)>96&&r.charCodeAt(2)<123,hC=(r,n,u,f,y,C)=>{const b=y==="svg";n==="class"?K2(r,f,b):n==="style"?tC(r,u,f):tf(n)?Im(n)||iC(r,n,u,f,C):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):dC(r,n,f,b))?(vy(r,n,f),!r.tagName.includes("-")&&(n==="value"||n==="checked"||n==="selected")&&yy(r,n,f,b,C,n!=="value")):r._isVueCE&&(/[A-Z]/.test(n)||!Yr(f))?vy(r,Uo(n),f,C,n):(n==="true-value"?r._trueValue=f:n==="false-value"&&(r._falseValue=f),yy(r,n,f,b))};function dC(r,n,u,f){if(f)return!!(n==="innerHTML"||n==="textContent"||n in r&&wy(n)&&Vt(u));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&r.tagName==="INPUT"||n==="type"&&r.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const y=r.tagName;if(y==="IMG"||y==="VIDEO"||y==="CANVAS"||y==="SOURCE")return!1}return wy(n)&&Yr(u)?!1:n in r}const fC=Ln({patchProp:hC},U2);let Cy;function pC(){return Cy||(Cy=f2(fC))}const mC=(...r)=>{const n=pC().createApp(...r),{mount:u}=n;return n.mount=f=>{const y=_C(f);if(!y)return;const C=n._component;!Vt(C)&&!C.render&&!C.template&&(C.template=y.innerHTML),y.nodeType===1&&(y.textContent="");const b=u(y,!1,gC(y));return y instanceof Element&&(y.removeAttribute("v-cloak"),y.setAttribute("data-v-app","")),b},n};function gC(r){if(r instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&r instanceof MathMLElement)return"mathml"}function _C(r){return Yr(r)?document.querySelector(r):r}/*!
 * pinia v3.0.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let Yv;const gf=r=>Yv=r,Kv=Symbol();function pm(r){return r&&typeof r=="object"&&Object.prototype.toString.call(r)==="[object Object]"&&typeof r.toJSON!="function"}var Du;(function(r){r.direct="direct",r.patchObject="patch object",r.patchFunction="patch function"})(Du||(Du={}));function yC(){const r=V0(!0),n=r.run(()=>_o({}));let u=[],f=[];const y=jm({install(C){gf(y),y._a=C,C.provide(Kv,y),C.config.globalProperties.$pinia=y,f.forEach(b=>u.push(b)),f=[]},use(C){return this._a?u.push(C):f.push(C),this},_p:u,_a:null,_e:r,_s:new Map,state:n});return y}const Jv=()=>{};function Sy(r,n,u,f=Jv){r.push(n);const y=()=>{const C=r.indexOf(n);C>-1&&(r.splice(C,1),f())};return!u&&U0()&&Y1(y),y}function Dl(r,...n){r.slice().forEach(u=>{u(...n)})}const vC=r=>r(),Ty=Symbol(),Wp=Symbol();function mm(r,n){r instanceof Map&&n instanceof Map?n.forEach((u,f)=>r.set(f,u)):r instanceof Set&&n instanceof Set&&n.forEach(r.add,r);for(const u in n){if(!n.hasOwnProperty(u))continue;const f=n[u],y=r[u];pm(y)&&pm(f)&&r.hasOwnProperty(u)&&!ln(f)&&!Rs(f)?r[u]=mm(y,f):r[u]=f}return r}const bC=Symbol();function xC(r){return!pm(r)||!r.hasOwnProperty(bC)}const{assign:ks}=Object;function wC(r){return!!(ln(r)&&r.effect)}function CC(r,n,u,f){const{state:y,actions:C,getters:b}=n,a=u.state.value[r];let I;function R(){a||(u.state.value[r]=y?y():{});const $=bw(u.state.value[r]);return ks($,C,Object.keys(b||{}).reduce((N,q)=>(N[q]=jm(cr(()=>{gf(u);const V=u._s.get(r);return b[q].call(V,V)})),N),{}))}return I=Qv(r,R,n,u,f,!0),I}function Qv(r,n,u={},f,y,C){let b;const a=ks({actions:{}},u),I={deep:!0};let R,$,N=[],q=[],V;const ie=f.state.value[r];!C&&!ie&&(f.state.value[r]={}),_o({});let Pe;function Ne(st){let Qe;R=$=!1,typeof st=="function"?(st(f.state.value[r]),Qe={type:Du.patchFunction,storeId:r,events:V}):(mm(f.state.value[r],st),Qe={type:Du.patchObject,payload:st,storeId:r,events:V});const gt=Pe=Symbol();Nm().then(()=>{Pe===gt&&(R=!0)}),$=!0,Dl(N,Qe,f.state.value[r])}const xe=C?function(){const{state:Qe}=u,gt=Qe?Qe():{};this.$patch(ot=>{ks(ot,gt)})}:Jv;function Ge(){b.stop(),N=[],q=[],f._s.delete(r)}const qe=(st,Qe="")=>{if(Ty in st)return st[Wp]=Qe,st;const gt=function(){gf(f);const ot=Array.from(arguments),Me=[],Fe=[];function tt(bt){Me.push(bt)}function At(bt){Fe.push(bt)}Dl(q,{args:ot,name:gt[Wp],store:Oe,after:tt,onError:At});let ft;try{ft=st.apply(this&&this.$id===r?this:Oe,ot)}catch(bt){throw Dl(Fe,bt),bt}return ft instanceof Promise?ft.then(bt=>(Dl(Me,bt),bt)).catch(bt=>(Dl(Fe,bt),Promise.reject(bt))):(Dl(Me,ft),ft)};return gt[Ty]=!0,gt[Wp]=Qe,gt},be={_p:f,$id:r,$onAction:Sy.bind(null,q),$patch:Ne,$reset:xe,$subscribe(st,Qe={}){const gt=Sy(N,st,Qe.detached,()=>ot()),ot=b.run(()=>jo(()=>f.state.value[r],Me=>{(Qe.flush==="sync"?$:R)&&st({storeId:r,type:Du.direct,events:V},Me)},ks({},I,Qe)));return gt},$dispose:Ge},Oe=Xl(be);f._s.set(r,Oe);const ut=(f._a&&f._a.runWithContext||vC)(()=>f._e.run(()=>(b=V0()).run(()=>n({action:qe}))));for(const st in ut){const Qe=ut[st];if(ln(Qe)&&!wC(Qe)||Rs(Qe))C||(ie&&xC(Qe)&&(ln(Qe)?Qe.value=ie[st]:mm(Qe,ie[st])),f.state.value[r][st]=Qe);else if(typeof Qe=="function"){const gt=qe(Qe,st);ut[st]=gt,a.actions[st]=Qe}}return ks(Oe,ut),ks(lr(Oe),ut),Object.defineProperty(Oe,"$state",{get:()=>f.state.value[r],set:st=>{Ne(Qe=>{ks(Qe,st)})}}),f._p.forEach(st=>{ks(Oe,b.run(()=>st({store:Oe,app:f._a,pinia:f,options:a})))}),ie&&C&&u.hydrate&&u.hydrate(Oe.$state,ie),R=!0,$=!0,Oe}/*! #__NO_SIDE_EFFECTS__ */function SC(r,n,u){let f;const y=typeof n=="function";f=y?u:n;function C(b,a){const I=s2();return b=b||(I?zu(Kv,null):null),b&&gf(b),b=Yv,b._s.has(r)||(y?Qv(r,n,f,b):CC(r,f,b)),b._s.get(r)}return C.$id=r,C}const TC="csrfToken",ky="djangoSlot",kC={install(r,n){var f;r.config.globalProperties.$djangoSlots={};for(const y of n.rootElement.children)y instanceof HTMLElement&&ky in y.dataset&&(r.config.globalProperties.$djangoSlots[y.dataset[ky]]=y.outerHTML);r.config.globalProperties.$rootElement=n.rootElement;const u=window.vueProvided||{};Object.keys(u).forEach(y=>{r.provide(y,u[y])}),r.provide(TC,(f=window.document.querySelector("[name=csrfmiddlewaretoken]"))==null?void 0:f.value)}},PC=({dataset:r,component:n})=>(Object.keys(r).forEach(function(f){if(f in n.props){const y=n.props[f].type;r[f]=y===Date?new y(r[f]):y(r[f])}}),r);var MC=Object.defineProperty,Py=Object.getOwnPropertySymbols,IC=Object.prototype.hasOwnProperty,EC=Object.prototype.propertyIsEnumerable,My=(r,n,u)=>n in r?MC(r,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):r[n]=u,AC=(r,n)=>{for(var u in n||(n={}))IC.call(n,u)&&My(r,u,n[u]);if(Py)for(var u of Py(n))EC.call(n,u)&&My(r,u,n[u]);return r};function _f(r){return r==null||r===""||Array.isArray(r)&&r.length===0||!(r instanceof Date)&&typeof r=="object"&&Object.keys(r).length===0}function Hm(r){return typeof r=="function"&&"call"in r&&"apply"in r}function Or(r){return!_f(r)}function xi(r,n=!0){return r instanceof Object&&r.constructor===Object&&(n||Object.keys(r).length!==0)}function eb(r={},n={}){const u=AC({},r);return Object.keys(n).forEach(f=>{const y=f;xi(n[y])&&y in r&&xi(r[y])?u[y]=eb(r[y],n[y]):u[y]=n[y]}),u}function zC(...r){return r.reduce((n,u,f)=>f===0?u:eb(n,u),{})}function No(r,...n){return Hm(r)?r(...n):r}function vo(r,n=!0){return typeof r=="string"&&(n||r!=="")}function yi(r){return vo(r)?r.replace(/(-|_)/g,"").toLowerCase():r}function Xm(r,n="",u={}){const f=yi(n).split("."),y=f.shift();if(y){if(xi(r)){const C=Object.keys(r).find(b=>yi(b)===y)||"";return Xm(No(r[C],u),f.join("."),u)}return}return No(r,u)}function yf(r,n=!0){return Array.isArray(r)&&(n||r.length!==0)}function RC(r){return Or(r)&&!isNaN(r)}function Xi(r,n){if(n){const u=n.test(r);return n.lastIndex=0,u}return!1}function DC(...r){return zC(...r)}function Lu(r){return r&&r.replace(/\/\*(?:(?!\*\/)[\s\S])*\*\/|[\r\n\t]+/g,"").replace(/ {2,}/g," ").replace(/ ([{:}]) /g,"$1").replace(/([;,]) /g,"$1").replace(/ !/g,"!").replace(/: /g,":")}function LC(r){return vo(r,!1)?r[0].toUpperCase()+r.slice(1):r}function tb(r){return vo(r)?r.replace(/(_)/g,"-").replace(/[A-Z]/g,(n,u)=>u===0?n:"-"+n.toLowerCase()).toLowerCase():r}function Iy(r){return vo(r)?r.replace(/[A-Z]/g,(n,u)=>u===0?n:"."+n.toLowerCase()).toLowerCase():r}function Ym(){const r=new Map;return{on(n,u){let f=r.get(n);return f?f.push(u):f=[u],r.set(n,f),this},off(n,u){const f=r.get(n);return f&&f.splice(f.indexOf(u)>>>0,1),this},emit(n,u){const f=r.get(n);f&&f.forEach(y=>{y(u)})},clear(){r.clear()}}}function BC(r,n){return r?r.classList?r.classList.contains(n):new RegExp("(^| )"+n+"( |$)","gi").test(r.className):!1}function rb(r,n){if(r&&n){const u=f=>{BC(r,f)||(r.classList?r.classList.add(f):r.className+=" "+f)};[n].flat().filter(Boolean).forEach(f=>f.split(" ").forEach(u))}}function Hp(r,n){if(r&&n){const u=f=>{r.classList?r.classList.remove(f):r.className=r.className.replace(new RegExp("(^|\\b)"+f.split(" ").join("|")+"(\\b|$)","gi")," ")};[n].flat().filter(Boolean).forEach(f=>f.split(" ").forEach(u))}}function Ey(r){for(const n of document==null?void 0:document.styleSheets)try{for(const u of n==null?void 0:n.cssRules)for(const f of u==null?void 0:u.style)if(r.test(f))return{name:f,value:u.style.getPropertyValue(f).trim()}}catch{}return null}function $C(r){const n={width:0,height:0};return r&&(r.style.visibility="hidden",r.style.display="block",n.width=r.offsetWidth,n.height=r.offsetHeight,r.style.display="none",r.style.visibility="visible"),n}function OC(){const r=window,n=document,u=n.documentElement,f=n.getElementsByTagName("body")[0],y=r.innerWidth||u.clientWidth||f.clientWidth,C=r.innerHeight||u.clientHeight||f.clientHeight;return{width:y,height:C}}function gm(r){return r?Math.abs(r.scrollLeft):0}function FC(){const r=document.documentElement;return(window.pageXOffset||gm(r))-(r.clientLeft||0)}function jC(){const r=document.documentElement;return(window.pageYOffset||r.scrollTop)-(r.clientTop||0)}function NC(r,n,u=!0){var f,y,C,b;if(r){const a=r.offsetParent?{width:r.offsetWidth,height:r.offsetHeight}:$C(r),I=a.height,R=a.width,$=n.offsetHeight,N=n.offsetWidth,q=n.getBoundingClientRect(),V=jC(),ie=FC(),Pe=OC();let Ne,xe,Ge="top";q.top+$+I>Pe.height?(Ne=q.top+V-I,Ge="bottom",Ne<0&&(Ne=V)):Ne=$+q.top+V,q.left+R>Pe.width?xe=Math.max(0,q.left+ie+N-R):xe=q.left+ie,r.style.top=Ne+"px",r.style.insetInlineStart=xe+"px",r.style.transformOrigin=Ge,u&&(r.style.marginTop=Ge==="bottom"?`calc(${(y=(f=Ey(/-anchor-gutter$/))==null?void 0:f.value)!=null?y:"2px"} * -1)`:(b=(C=Ey(/-anchor-gutter$/))==null?void 0:C.value)!=null?b:"")}}function VC(r,n){r&&(typeof n=="string"?r.style.cssText=n:Object.entries(n||{}).forEach(([u,f])=>r.style[u]=f))}function UC(r,n){return r instanceof HTMLElement?r.offsetWidth:0}function nb(r){if(r){let n=r.parentNode;return n&&n instanceof ShadowRoot&&n.host&&(n=n.host),n}return null}function ZC(r){return!!(r!==null&&typeof r<"u"&&r.nodeName&&nb(r))}function ka(r){return typeof HTMLElement<"u"?r instanceof HTMLElement:r!==null&&typeof r=="object"&&r.nodeType===1&&typeof r.nodeName=="string"}function Gd(r,n={}){if(ka(r)){const u=(f,y)=>{var C,b;const a=(C=r==null?void 0:r.$attrs)!=null&&C[f]?[(b=r==null?void 0:r.$attrs)==null?void 0:b[f]]:[];return[y].flat().reduce((I,R)=>{if(R!=null){const $=typeof R;if($==="string"||$==="number")I.push(R);else if($==="object"){const N=Array.isArray(R)?u(f,R):Object.entries(R).map(([q,V])=>f==="style"&&(V||V===0)?`${q.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${V}`:V?q:void 0);I=N.length?I.concat(N.filter(q=>!!q)):I}}return I},a)};Object.entries(n).forEach(([f,y])=>{if(y!=null){const C=f.match(/^on(.+)/);C?r.addEventListener(C[1].toLowerCase(),y):f==="p-bind"||f==="pBind"?Gd(r,y):(y=f==="class"?[...new Set(u("class",y))].join(" ").trim():f==="style"?u("style",y).join(";").trim():y,(r.$attrs=r.$attrs||{})&&(r.$attrs[f]=y),r.setAttribute(f,y))}})}}function ob(r,n={},...u){{const f=document.createElement(r);return Gd(f,n),f.append(...u),f}}function GC(r,n){return ka(r)?Array.from(r.querySelectorAll(n)):[]}function ib(r,n){return ka(r)?r.matches(n)?r:r.querySelector(n):null}function Tu(r,n){r&&document.activeElement!==r&&r.focus(n)}function qC(r,n){if(ka(r)){const u=r.getAttribute(n);return isNaN(u)?u==="true"||u==="false"?u==="true":u:+u}}function sb(r,n=""){const u=GC(r,`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
            [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
            input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
            select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
            textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
            [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
            [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n}`),f=[];for(const y of u)getComputedStyle(y).display!="none"&&getComputedStyle(y).visibility!="hidden"&&f.push(y);return f}function yu(r,n){const u=sb(r,n);return u.length>0?u[0]:null}function Ay(r){if(r){let n=r.offsetHeight;const u=getComputedStyle(r);return n-=parseFloat(u.paddingTop)+parseFloat(u.paddingBottom)+parseFloat(u.borderTopWidth)+parseFloat(u.borderBottomWidth),n}return 0}function WC(r,n){const u=sb(r,n);return u.length>0?u[u.length-1]:null}function _m(r){if(r){const n=r.getBoundingClientRect();return{top:n.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:n.left+(window.pageXOffset||gm(document.documentElement)||gm(document.body)||0)}}return{top:"auto",left:"auto"}}function HC(r,n){return r?r.offsetHeight:0}function ab(r,n=[]){const u=nb(r);return u===null?n:ab(u,n.concat([u]))}function XC(r){const n=[];if(r){const u=ab(r),f=/(auto|scroll)/,y=C=>{try{const b=window.getComputedStyle(C,null);return f.test(b.getPropertyValue("overflow"))||f.test(b.getPropertyValue("overflowX"))||f.test(b.getPropertyValue("overflowY"))}catch{return!1}};for(const C of u){const b=C.nodeType===1&&C.dataset.scrollselectors;if(b){const a=b.split(",");for(const I of a){const R=ib(C,I);R&&y(R)&&n.push(R)}}C.nodeType!==9&&y(C)&&n.push(C)}}return n}function zy(r){if(r){let n=r.offsetWidth;const u=getComputedStyle(r);return n-=parseFloat(u.paddingLeft)+parseFloat(u.paddingRight)+parseFloat(u.borderLeftWidth)+parseFloat(u.borderRightWidth),n}return 0}function Km(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function Ry(r,n=""){return ka(r)?r.matches(`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
            [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
            input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
            select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
            textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
            [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},
            [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n}`):!1}function YC(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function lb(r,n="",u){ka(r)&&u!==null&&u!==void 0&&r.setAttribute(n,u)}var Sd={};function KC(r="pui_id_"){return Object.hasOwn(Sd,r)||(Sd[r]=0),Sd[r]++,`${r}${Sd[r]}`}function JC(){let r=[];const n=(b,a,I=999)=>{const R=y(b,a,I),$=R.value+(R.key===b?0:I)+1;return r.push({key:b,value:$}),$},u=b=>{r=r.filter(a=>a.value!==b)},f=(b,a)=>y(b).value,y=(b,a,I=0)=>[...r].reverse().find(R=>!0)||{key:b,value:I},C=b=>b&&parseInt(b.style.zIndex,10)||0;return{get:C,set:(b,a,I)=>{a&&(a.style.zIndex=String(n(b,!0,I)))},clear:b=>{b&&(u(C(b)),b.style.zIndex="")},getCurrent:b=>f(b)}}var Xp=JC(),QC=Object.defineProperty,eS=Object.defineProperties,tS=Object.getOwnPropertyDescriptors,qd=Object.getOwnPropertySymbols,cb=Object.prototype.hasOwnProperty,ub=Object.prototype.propertyIsEnumerable,Dy=(r,n,u)=>n in r?QC(r,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):r[n]=u,ei=(r,n)=>{for(var u in n||(n={}))cb.call(n,u)&&Dy(r,u,n[u]);if(qd)for(var u of qd(n))ub.call(n,u)&&Dy(r,u,n[u]);return r},Yp=(r,n)=>eS(r,tS(n)),Gi=(r,n)=>{var u={};for(var f in r)cb.call(r,f)&&n.indexOf(f)<0&&(u[f]=r[f]);if(r!=null&&qd)for(var f of qd(r))n.indexOf(f)<0&&ub.call(r,f)&&(u[f]=r[f]);return u},rS=Ym(),Dn=rS;function Ly(r,n){yf(r)?r.push(...n||[]):xi(r)&&Object.assign(r,n)}function nS(r){return xi(r)&&r.hasOwnProperty("$value")&&r.hasOwnProperty("$type")?r.$value:r}function oS(r){return r.replaceAll(/ /g,"").replace(/[^\w]/g,"-")}function ym(r="",n=""){return oS(`${vo(r,!1)&&vo(n,!1)?`${r}-`:r}${n}`)}function hb(r="",n=""){return`--${ym(r,n)}`}function iS(r=""){const n=(r.match(/{/g)||[]).length,u=(r.match(/}/g)||[]).length;return(n+u)%2!==0}function db(r,n="",u="",f=[],y){if(vo(r)){const C=/{([^}]*)}/g,b=r.trim();if(iS(b))return;if(Xi(b,C)){const a=b.replaceAll(C,$=>{const q=$.replace(/{|}/g,"").split(".").filter(V=>!f.some(ie=>Xi(V,ie)));return`var(${hb(u,tb(q.join("-")))}${Or(y)?`, ${y}`:""})`}),I=/(\d+\s+[\+\-\*\/]\s+\d+)/g,R=/var\([^)]+\)/g;return Xi(a.replace(R,"0"),I)?`calc(${a})`:a}return b}else if(RC(r))return r}function sS(r,n,u){vo(n,!1)&&r.push(`${n}:${u};`)}function $l(r,n){return r?`${r}{${n}}`:""}var aS=r=>{var n;const u=vr.getTheme(),f=vm(u,r,void 0,"variable"),y=(n=f==null?void 0:f.match(/--[\w-]+/g))==null?void 0:n[0],C=vm(u,r,void 0,"value");return{name:y,variable:f,value:C}},Bu=(...r)=>vm(vr.getTheme(),...r),vm=(r={},n,u,f)=>{if(n){const{variable:y,options:C}=vr.defaults||{},{prefix:b,transform:a}=(r==null?void 0:r.options)||C||{},R=Xi(n,/{([^}]*)}/g)?n:`{${n}}`;return f==="value"||_f(f)&&a==="strict"?vr.getTokenValue(n):db(R,void 0,b,[y.excludedKeyRegex],u)}return""};function lS(r,n={}){const u=vr.defaults.variable,{prefix:f=u.prefix,selector:y=u.selector,excludedKeyRegex:C=u.excludedKeyRegex}=n,b=(R,$="")=>Object.entries(R).reduce((N,[q,V])=>{const ie=Xi(q,C)?ym($):ym($,tb(q)),Pe=nS(V);if(xi(Pe)){const{variables:Ne,tokens:xe}=b(Pe,ie);Ly(N.tokens,xe),Ly(N.variables,Ne)}else N.tokens.push((f?ie.replace(`${f}-`,""):ie).replaceAll("-",".")),sS(N.variables,hb(ie),db(Pe,ie,f,[C]));return N},{variables:[],tokens:[]}),{variables:a,tokens:I}=b(r,f);return{value:a,tokens:I,declarations:a.join(""),css:$l(y,a.join(""))}}var Qo={regex:{rules:{class:{pattern:/^\.([a-zA-Z][\w-]*)$/,resolve(r){return{type:"class",selector:r,matched:this.pattern.test(r.trim())}}},attr:{pattern:/^\[(.*)\]$/,resolve(r){return{type:"attr",selector:`:root${r}`,matched:this.pattern.test(r.trim())}}},media:{pattern:/^@media (.*)$/,resolve(r){return{type:"media",selector:`${r}{:root{[CSS]}}`,matched:this.pattern.test(r.trim())}}},system:{pattern:/^system$/,resolve(r){return{type:"system",selector:"@media (prefers-color-scheme: dark){:root{[CSS]}}",matched:this.pattern.test(r.trim())}}},custom:{resolve(r){return{type:"custom",selector:r,matched:!0}}}},resolve(r){const n=Object.keys(this.rules).filter(u=>u!=="custom").map(u=>this.rules[u]);return[r].flat().map(u=>{var f;return(f=n.map(y=>y.resolve(u)).find(y=>y.matched))!=null?f:this.rules.custom.resolve(u)})}},_toVariables(r,n){return lS(r,{prefix:n==null?void 0:n.prefix})},getCommon({name:r="",theme:n={},params:u,set:f,defaults:y}){var C,b,a,I,R,$,N;const{preset:q,options:V}=n;let ie,Pe,Ne,xe,Ge,qe,be;if(Or(q)&&V.transform!=="strict"){const{primitive:Oe,semantic:ct,extend:ut}=q,st=ct||{},{colorScheme:Qe}=st,gt=Gi(st,["colorScheme"]),ot=ut||{},{colorScheme:Me}=ot,Fe=Gi(ot,["colorScheme"]),tt=Qe||{},{dark:At}=tt,ft=Gi(tt,["dark"]),bt=Me||{},{dark:Pt}=bt,Ut=Gi(bt,["dark"]),dr=Or(Oe)?this._toVariables({primitive:Oe},V):{},ir=Or(gt)?this._toVariables({semantic:gt},V):{},Ht=Or(ft)?this._toVariables({light:ft},V):{},Mr=Or(At)?this._toVariables({dark:At},V):{},zr=Or(Fe)?this._toVariables({semantic:Fe},V):{},Cr=Or(Ut)?this._toVariables({light:Ut},V):{},Kr=Or(Pt)?this._toVariables({dark:Pt},V):{},[Tn,Gn]=[(C=dr.declarations)!=null?C:"",dr.tokens],[cn,qn]=[(b=ir.declarations)!=null?b:"",ir.tokens||[]],[Jr,ae]=[(a=Ht.declarations)!=null?a:"",Ht.tokens||[]],[pe,Ie]=[(I=Mr.declarations)!=null?I:"",Mr.tokens||[]],[Ke,We]=[(R=zr.declarations)!=null?R:"",zr.tokens||[]],[He,lt]=[($=Cr.declarations)!=null?$:"",Cr.tokens||[]],[at,nt]=[(N=Kr.declarations)!=null?N:"",Kr.tokens||[]];ie=this.transformCSS(r,Tn,"light","variable",V,f,y),Pe=Gn;const Xe=this.transformCSS(r,`${cn}${Jr}`,"light","variable",V,f,y),It=this.transformCSS(r,`${pe}`,"dark","variable",V,f,y);Ne=`${Xe}${It}`,xe=[...new Set([...qn,...ae,...Ie])];const ht=this.transformCSS(r,`${Ke}${He}color-scheme:light`,"light","variable",V,f,y),St=this.transformCSS(r,`${at}color-scheme:dark`,"dark","variable",V,f,y);Ge=`${ht}${St}`,qe=[...new Set([...We,...lt,...nt])],be=No(q.css,{dt:Bu})}return{primitive:{css:ie,tokens:Pe},semantic:{css:Ne,tokens:xe},global:{css:Ge,tokens:qe},style:be}},getPreset({name:r="",preset:n={},options:u,params:f,set:y,defaults:C,selector:b}){var a,I,R;let $,N,q;if(Or(n)&&u.transform!=="strict"){const V=r.replace("-directive",""),ie=n,{colorScheme:Pe,extend:Ne,css:xe}=ie,Ge=Gi(ie,["colorScheme","extend","css"]),qe=Ne||{},{colorScheme:be}=qe,Oe=Gi(qe,["colorScheme"]),ct=Pe||{},{dark:ut}=ct,st=Gi(ct,["dark"]),Qe=be||{},{dark:gt}=Qe,ot=Gi(Qe,["dark"]),Me=Or(Ge)?this._toVariables({[V]:ei(ei({},Ge),Oe)},u):{},Fe=Or(st)?this._toVariables({[V]:ei(ei({},st),ot)},u):{},tt=Or(ut)?this._toVariables({[V]:ei(ei({},ut),gt)},u):{},[At,ft]=[(a=Me.declarations)!=null?a:"",Me.tokens||[]],[bt,Pt]=[(I=Fe.declarations)!=null?I:"",Fe.tokens||[]],[Ut,dr]=[(R=tt.declarations)!=null?R:"",tt.tokens||[]],ir=this.transformCSS(V,`${At}${bt}`,"light","variable",u,y,C,b),Ht=this.transformCSS(V,Ut,"dark","variable",u,y,C,b);$=`${ir}${Ht}`,N=[...new Set([...ft,...Pt,...dr])],q=No(xe,{dt:Bu})}return{css:$,tokens:N,style:q}},getPresetC({name:r="",theme:n={},params:u,set:f,defaults:y}){var C;const{preset:b,options:a}=n,I=(C=b==null?void 0:b.components)==null?void 0:C[r];return this.getPreset({name:r,preset:I,options:a,params:u,set:f,defaults:y})},getPresetD({name:r="",theme:n={},params:u,set:f,defaults:y}){var C,b;const a=r.replace("-directive",""),{preset:I,options:R}=n,$=((C=I==null?void 0:I.components)==null?void 0:C[a])||((b=I==null?void 0:I.directives)==null?void 0:b[a]);return this.getPreset({name:a,preset:$,options:R,params:u,set:f,defaults:y})},applyDarkColorScheme(r){return!(r.darkModeSelector==="none"||r.darkModeSelector===!1)},getColorSchemeOption(r,n){var u;return this.applyDarkColorScheme(r)?this.regex.resolve(r.darkModeSelector===!0?n.options.darkModeSelector:(u=r.darkModeSelector)!=null?u:n.options.darkModeSelector):[]},getLayerOrder(r,n={},u,f){const{cssLayer:y}=n;return y?`@layer ${No(y.order||"primeui",u)}`:""},getCommonStyleSheet({name:r="",theme:n={},params:u,props:f={},set:y,defaults:C}){const b=this.getCommon({name:r,theme:n,params:u,set:y,defaults:C}),a=Object.entries(f).reduce((I,[R,$])=>I.push(`${R}="${$}"`)&&I,[]).join(" ");return Object.entries(b||{}).reduce((I,[R,$])=>{if($!=null&&$.css){const N=Lu($==null?void 0:$.css),q=`${R}-variables`;I.push(`<style type="text/css" data-primevue-style-id="${q}" ${a}>${N}</style>`)}return I},[]).join("")},getStyleSheet({name:r="",theme:n={},params:u,props:f={},set:y,defaults:C}){var b;const a={name:r,theme:n,params:u,set:y,defaults:C},I=(b=r.includes("-directive")?this.getPresetD(a):this.getPresetC(a))==null?void 0:b.css,R=Object.entries(f).reduce(($,[N,q])=>$.push(`${N}="${q}"`)&&$,[]).join(" ");return I?`<style type="text/css" data-primevue-style-id="${r}-variables" ${R}>${Lu(I)}</style>`:""},createTokens(r={},n,u="",f="",y={}){return Object.entries(r).forEach(([C,b])=>{const a=Xi(C,n.variable.excludedKeyRegex)?u:u?`${u}.${Iy(C)}`:Iy(C),I=f?`${f}.${C}`:C;xi(b)?this.createTokens(b,n,a,I,y):(y[a]||(y[a]={paths:[],computed(R,$={}){var N,q;return this.paths.length===1?(N=this.paths[0])==null?void 0:N.computed(this.paths[0].scheme,$.binding):R&&R!=="none"?(q=this.paths.find(V=>V.scheme===R))==null?void 0:q.computed(R,$.binding):this.paths.map(V=>V.computed(V.scheme,$[V.scheme]))}}),y[a].paths.push({path:I,value:b,scheme:I.includes("colorScheme.light")?"light":I.includes("colorScheme.dark")?"dark":"none",computed(R,$={}){const N=/{([^}]*)}/g;let q=b;if($.name=this.path,$.binding||($.binding={}),Xi(b,N)){const ie=b.trim().replaceAll(N,xe=>{var Ge;const qe=xe.replace(/{|}/g,""),be=(Ge=y[qe])==null?void 0:Ge.computed(R,$);return yf(be)&&be.length===2?`light-dark(${be[0].value},${be[1].value})`:be==null?void 0:be.value}),Pe=/(\d+\w*\s+[\+\-\*\/]\s+\d+\w*)/g,Ne=/var\([^)]+\)/g;q=Xi(ie.replace(Ne,"0"),Pe)?`calc(${ie})`:ie}return _f($.binding)&&delete $.binding,{colorScheme:R,path:this.path,paths:$,value:q.includes("undefined")?void 0:q}}}))}),y},getTokenValue(r,n,u){var f;const C=(I=>I.split(".").filter($=>!Xi($.toLowerCase(),u.variable.excludedKeyRegex)).join("."))(n),b=n.includes("colorScheme.light")?"light":n.includes("colorScheme.dark")?"dark":void 0,a=[(f=r[C])==null?void 0:f.computed(b)].flat().filter(I=>I);return a.length===1?a[0].value:a.reduce((I={},R)=>{const $=R,{colorScheme:N}=$,q=Gi($,["colorScheme"]);return I[N]=q,I},void 0)},getSelectorRule(r,n,u,f){return u==="class"||u==="attr"?$l(Or(n)?`${r}${n},${r} ${n}`:r,f):$l(r,Or(n)?$l(n,f):f)},transformCSS(r,n,u,f,y={},C,b,a){if(Or(n)){const{cssLayer:I}=y;if(f!=="style"){const R=this.getColorSchemeOption(y,b);n=u==="dark"?R.reduce(($,{type:N,selector:q})=>(Or(q)&&($+=q.includes("[CSS]")?q.replace("[CSS]",n):this.getSelectorRule(q,a,N,n)),$),""):$l(a??":root",n)}if(I){const R={name:"primeui"};xi(I)&&(R.name=No(I.name,{name:r,type:f})),Or(R.name)&&(n=$l(`@layer ${R.name}`,n),C==null||C.layerNames(R.name))}return n}return""}},vr={defaults:{variable:{prefix:"p",selector:":root",excludedKeyRegex:/^(primitive|semantic|components|directives|variables|colorscheme|light|dark|common|root|states|extend|css)$/gi},options:{prefix:"p",darkModeSelector:"system",cssLayer:!1}},_theme:void 0,_layerNames:new Set,_loadedStyleNames:new Set,_loadingStyles:new Set,_tokens:{},update(r={}){const{theme:n}=r;n&&(this._theme=Yp(ei({},n),{options:ei(ei({},this.defaults.options),n.options)}),this._tokens=Qo.createTokens(this.preset,this.defaults),this.clearLoadedStyleNames())},get theme(){return this._theme},get preset(){var r;return((r=this.theme)==null?void 0:r.preset)||{}},get options(){var r;return((r=this.theme)==null?void 0:r.options)||{}},get tokens(){return this._tokens},getTheme(){return this.theme},setTheme(r){this.update({theme:r}),Dn.emit("theme:change",r)},getPreset(){return this.preset},setPreset(r){this._theme=Yp(ei({},this.theme),{preset:r}),this._tokens=Qo.createTokens(r,this.defaults),this.clearLoadedStyleNames(),Dn.emit("preset:change",r),Dn.emit("theme:change",this.theme)},getOptions(){return this.options},setOptions(r){this._theme=Yp(ei({},this.theme),{options:r}),this.clearLoadedStyleNames(),Dn.emit("options:change",r),Dn.emit("theme:change",this.theme)},getLayerNames(){return[...this._layerNames]},setLayerNames(r){this._layerNames.add(r)},getLoadedStyleNames(){return this._loadedStyleNames},isStyleNameLoaded(r){return this._loadedStyleNames.has(r)},setLoadedStyleName(r){this._loadedStyleNames.add(r)},deleteLoadedStyleName(r){this._loadedStyleNames.delete(r)},clearLoadedStyleNames(){this._loadedStyleNames.clear()},getTokenValue(r){return Qo.getTokenValue(this.tokens,r,this.defaults)},getCommon(r="",n){return Qo.getCommon({name:r,theme:this.theme,params:n,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getComponent(r="",n){const u={name:r,theme:this.theme,params:n,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return Qo.getPresetC(u)},getDirective(r="",n){const u={name:r,theme:this.theme,params:n,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return Qo.getPresetD(u)},getCustomPreset(r="",n,u,f){const y={name:r,preset:n,options:this.options,selector:u,params:f,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return Qo.getPreset(y)},getLayerOrderCSS(r=""){return Qo.getLayerOrder(r,this.options,{names:this.getLayerNames()},this.defaults)},transformCSS(r="",n,u="style",f){return Qo.transformCSS(r,n,f,u,this.options,{layerNames:this.setLayerNames.bind(this)},this.defaults)},getCommonStyleSheet(r="",n,u={}){return Qo.getCommonStyleSheet({name:r,theme:this.theme,params:n,props:u,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getStyleSheet(r,n,u={}){return Qo.getStyleSheet({name:r,theme:this.theme,params:n,props:u,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},onStyleMounted(r){this._loadingStyles.add(r)},onStyleUpdated(r){this._loadingStyles.add(r)},onStyleLoaded(r,{name:n}){this._loadingStyles.size&&(this._loadingStyles.delete(n),Dn.emit(`theme:${n}:load`,r),!this._loadingStyles.size&&Dn.emit("theme:load"))}},Vn={STARTS_WITH:"startsWith",CONTAINS:"contains",NOT_CONTAINS:"notContains",ENDS_WITH:"endsWith",EQUALS:"equals",NOT_EQUALS:"notEquals",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"lte",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"gte",DATE_IS:"dateIs",DATE_IS_NOT:"dateIsNot",DATE_BEFORE:"dateBefore",DATE_AFTER:"dateAfter"},cS=({dt:r})=>`
*,
::before,
::after {
    box-sizing: border-box;
}

/* Non vue overlay animations */
.p-connected-overlay {
    opacity: 0;
    transform: scaleY(0.8);
    transition: transform 0.12s cubic-bezier(0, 0, 0.2, 1),
        opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
}

.p-connected-overlay-visible {
    opacity: 1;
    transform: scaleY(1);
}

.p-connected-overlay-hidden {
    opacity: 0;
    transform: scaleY(1);
    transition: opacity 0.1s linear;
}

/* Vue based overlay animations */
.p-connected-overlay-enter-from {
    opacity: 0;
    transform: scaleY(0.8);
}

.p-connected-overlay-leave-to {
    opacity: 0;
}

.p-connected-overlay-enter-active {
    transition: transform 0.12s cubic-bezier(0, 0, 0.2, 1),
        opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
}

.p-connected-overlay-leave-active {
    transition: opacity 0.1s linear;
}

/* Toggleable Content */
.p-toggleable-content-enter-from,
.p-toggleable-content-leave-to {
    max-height: 0;
}

.p-toggleable-content-enter-to,
.p-toggleable-content-leave-from {
    max-height: 1000px;
}

.p-toggleable-content-leave-active {
    overflow: hidden;
    transition: max-height 0.45s cubic-bezier(0, 1, 0, 1);
}

.p-toggleable-content-enter-active {
    overflow: hidden;
    transition: max-height 1s ease-in-out;
}

.p-disabled,
.p-disabled * {
    cursor: default;
    pointer-events: none;
    user-select: none;
}

.p-disabled,
.p-component:disabled {
    opacity: ${r("disabled.opacity")};
}

.pi {
    font-size: ${r("icon.size")};
}

.p-icon {
    width: ${r("icon.size")};
    height: ${r("icon.size")};
}

.p-overlay-mask {
    background: ${r("mask.background")};
    color: ${r("mask.color")};
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.p-overlay-mask-enter {
    animation: p-overlay-mask-enter-animation ${r("mask.transition.duration")} forwards;
}

.p-overlay-mask-leave {
    animation: p-overlay-mask-leave-animation ${r("mask.transition.duration")} forwards;
}

@keyframes p-overlay-mask-enter-animation {
    from {
        background: transparent;
    }
    to {
        background: ${r("mask.background")};
    }
}
@keyframes p-overlay-mask-leave-animation {
    from {
        background: ${r("mask.background")};
    }
    to {
        background: transparent;
    }
}
`;function Gu(r){"@babel/helpers - typeof";return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Gu(r)}function By(r,n){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(r);n&&(f=f.filter(function(y){return Object.getOwnPropertyDescriptor(r,y).enumerable})),u.push.apply(u,f)}return u}function $y(r){for(var n=1;n<arguments.length;n++){var u=arguments[n]!=null?arguments[n]:{};n%2?By(Object(u),!0).forEach(function(f){uS(r,f,u[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):By(Object(u)).forEach(function(f){Object.defineProperty(r,f,Object.getOwnPropertyDescriptor(u,f))})}return r}function uS(r,n,u){return(n=hS(n))in r?Object.defineProperty(r,n,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[n]=u,r}function hS(r){var n=dS(r,"string");return Gu(n)=="symbol"?n:n+""}function dS(r,n){if(Gu(r)!="object"||!r)return r;var u=r[Symbol.toPrimitive];if(u!==void 0){var f=u.call(r,n);if(Gu(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}function fS(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Wm()?df(r):n?r():Nm(r)}var pS=0;function mS(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=_o(!1),f=_o(r),y=_o(null),C=Km()?window.document:void 0,b=n.document,a=b===void 0?C:b,I=n.immediate,R=I===void 0?!0:I,$=n.manual,N=$===void 0?!1:$,q=n.name,V=q===void 0?"style_".concat(++pS):q,ie=n.id,Pe=ie===void 0?void 0:ie,Ne=n.media,xe=Ne===void 0?void 0:Ne,Ge=n.nonce,qe=Ge===void 0?void 0:Ge,be=n.first,Oe=be===void 0?!1:be,ct=n.onMounted,ut=ct===void 0?void 0:ct,st=n.onUpdated,Qe=st===void 0?void 0:st,gt=n.onLoad,ot=gt===void 0?void 0:gt,Me=n.props,Fe=Me===void 0?{}:Me,tt=function(){},At=function(Pt){var Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(a){var dr=$y($y({},Fe),Ut),ir=dr.name||V,Ht=dr.id||Pe,Mr=dr.nonce||qe;y.value=a.querySelector('style[data-primevue-style-id="'.concat(ir,'"]'))||a.getElementById(Ht)||a.createElement("style"),y.value.isConnected||(f.value=Pt||r,Gd(y.value,{type:"text/css",id:Ht,media:xe,nonce:Mr}),Oe?a.head.prepend(y.value):a.head.appendChild(y.value),lb(y.value,"data-primevue-style-id",ir),Gd(y.value,dr),y.value.onload=function(zr){return ot==null?void 0:ot(zr,{name:ir})},ut==null||ut(ir)),!u.value&&(tt=jo(f,function(zr){y.value.textContent=zr,Qe==null||Qe(ir)},{immediate:!0}),u.value=!0)}},ft=function(){!a||!u.value||(tt(),ZC(y.value)&&a.head.removeChild(y.value),u.value=!1)};return R&&!N&&fS(At),{id:Pe,name:V,el:y,css:f,unload:ft,load:At,isLoaded:$m(u)}}function qu(r){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},qu(r)}function Oy(r,n){return vS(r)||yS(r,n)||_S(r,n)||gS()}function gS(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _S(r,n){if(r){if(typeof r=="string")return Fy(r,n);var u={}.toString.call(r).slice(8,-1);return u==="Object"&&r.constructor&&(u=r.constructor.name),u==="Map"||u==="Set"?Array.from(r):u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?Fy(r,n):void 0}}function Fy(r,n){(n==null||n>r.length)&&(n=r.length);for(var u=0,f=Array(n);u<n;u++)f[u]=r[u];return f}function yS(r,n){var u=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(u!=null){var f,y,C,b,a=[],I=!0,R=!1;try{if(C=(u=u.call(r)).next,n!==0)for(;!(I=(f=C.call(u)).done)&&(a.push(f.value),a.length!==n);I=!0);}catch($){R=!0,y=$}finally{try{if(!I&&u.return!=null&&(b=u.return(),Object(b)!==b))return}finally{if(R)throw y}}return a}}function vS(r){if(Array.isArray(r))return r}function jy(r,n){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(r);n&&(f=f.filter(function(y){return Object.getOwnPropertyDescriptor(r,y).enumerable})),u.push.apply(u,f)}return u}function Kp(r){for(var n=1;n<arguments.length;n++){var u=arguments[n]!=null?arguments[n]:{};n%2?jy(Object(u),!0).forEach(function(f){bS(r,f,u[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):jy(Object(u)).forEach(function(f){Object.defineProperty(r,f,Object.getOwnPropertyDescriptor(u,f))})}return r}function bS(r,n,u){return(n=xS(n))in r?Object.defineProperty(r,n,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[n]=u,r}function xS(r){var n=wS(r,"string");return qu(n)=="symbol"?n:n+""}function wS(r,n){if(qu(r)!="object"||!r)return r;var u=r[Symbol.toPrimitive];if(u!==void 0){var f=u.call(r,n);if(qu(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}var CS=function(n){var u=n.dt;return`
.p-hidden-accessible {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    opacity: 0;
    overflow: hidden;
    padding: 0;
    pointer-events: none;
    position: absolute;
    white-space: nowrap;
    width: 1px;
}

.p-overflow-hidden {
    overflow: hidden;
    padding-right: `.concat(u("scrollbar.width"),`;
}
`)},SS={},TS={},qr={name:"base",css:CS,style:cS,classes:SS,inlineStyles:TS,load:function(n){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(C){return C},y=f(No(n,{dt:Bu}));return Or(y)?mS(Lu(y),Kp({name:this.name},u)):{}},loadCSS:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.load(this.css,n)},loadStyle:function(){var n=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.load(this.style,u,function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return vr.transformCSS(u.name||n.name,"".concat(y).concat(f))})},getCommonTheme:function(n){return vr.getCommon(this.name,n)},getComponentTheme:function(n){return vr.getComponent(this.name,n)},getDirectiveTheme:function(n){return vr.getDirective(this.name,n)},getPresetTheme:function(n,u,f){return vr.getCustomPreset(this.name,n,u,f)},getLayerOrderThemeCSS:function(){return vr.getLayerOrderCSS(this.name)},getStyleSheet:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.css){var f=No(this.css,{dt:Bu})||"",y=Lu("".concat(f).concat(n)),C=Object.entries(u).reduce(function(b,a){var I=Oy(a,2),R=I[0],$=I[1];return b.push("".concat(R,'="').concat($,'"'))&&b},[]).join(" ");return Or(y)?'<style type="text/css" data-primevue-style-id="'.concat(this.name,'" ').concat(C,">").concat(y,"</style>"):""}return""},getCommonThemeStyleSheet:function(n){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vr.getCommonStyleSheet(this.name,n,u)},getThemeStyleSheet:function(n){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=[vr.getStyleSheet(this.name,n,u)];if(this.style){var y=this.name==="base"?"global-style":"".concat(this.name,"-style"),C=No(this.style,{dt:Bu}),b=Lu(vr.transformCSS(y,C)),a=Object.entries(u).reduce(function(I,R){var $=Oy(R,2),N=$[0],q=$[1];return I.push("".concat(N,'="').concat(q,'"'))&&I},[]).join(" ");Or(b)&&f.push('<style type="text/css" data-primevue-style-id="'.concat(y,'" ').concat(a,">").concat(b,"</style>"))}return f.join("")},extend:function(n){return Kp(Kp({},this),{},{css:void 0,style:void 0},n)}},As=Ym();function Wu(r){"@babel/helpers - typeof";return Wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Wu(r)}function Ny(r,n){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(r);n&&(f=f.filter(function(y){return Object.getOwnPropertyDescriptor(r,y).enumerable})),u.push.apply(u,f)}return u}function Td(r){for(var n=1;n<arguments.length;n++){var u=arguments[n]!=null?arguments[n]:{};n%2?Ny(Object(u),!0).forEach(function(f){kS(r,f,u[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):Ny(Object(u)).forEach(function(f){Object.defineProperty(r,f,Object.getOwnPropertyDescriptor(u,f))})}return r}function kS(r,n,u){return(n=PS(n))in r?Object.defineProperty(r,n,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[n]=u,r}function PS(r){var n=MS(r,"string");return Wu(n)=="symbol"?n:n+""}function MS(r,n){if(Wu(r)!="object"||!r)return r;var u=r[Symbol.toPrimitive];if(u!==void 0){var f=u.call(r,n);if(Wu(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}var IS={ripple:!1,inputStyle:null,inputVariant:null,locale:{startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",completed:"Completed",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",today:"Today",weekHeader:"Wk",firstDayOfWeek:0,showMonthAfterYear:!1,dateFormat:"mm/dd/yy",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyFilterMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",fileChosenMessage:"{0} files",noFileChosenMessage:"No file chosen",emptyMessage:"No available options",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"Page {page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left",listLabel:"Option List"}},filterMatchModeOptions:{text:[Vn.STARTS_WITH,Vn.CONTAINS,Vn.NOT_CONTAINS,Vn.ENDS_WITH,Vn.EQUALS,Vn.NOT_EQUALS],numeric:[Vn.EQUALS,Vn.NOT_EQUALS,Vn.LESS_THAN,Vn.LESS_THAN_OR_EQUAL_TO,Vn.GREATER_THAN,Vn.GREATER_THAN_OR_EQUAL_TO],date:[Vn.DATE_IS,Vn.DATE_IS_NOT,Vn.DATE_BEFORE,Vn.DATE_AFTER]},zIndex:{modal:1100,overlay:1e3,menu:1e3,tooltip:1100},theme:void 0,unstyled:!1,pt:void 0,ptOptions:{mergeSections:!0,mergeProps:!1},csp:{nonce:void 0}},ES=Symbol();function AS(r,n){var u={config:Xl(n)};return r.config.globalProperties.$primevue=u,r.provide(ES,u),zS(),RS(r,u),u}var Fl=[];function zS(){Dn.clear(),Fl.forEach(function(r){return r==null?void 0:r()}),Fl=[]}function RS(r,n){var u=_o(!1),f=function(){var R;if(((R=n.config)===null||R===void 0?void 0:R.theme)!=="none"&&!vr.isStyleNameLoaded("common")){var $,N,q=(($=qr.getCommonTheme)===null||$===void 0?void 0:$.call(qr))||{},V=q.primitive,ie=q.semantic,Pe=q.global,Ne=q.style,xe={nonce:(N=n.config)===null||N===void 0||(N=N.csp)===null||N===void 0?void 0:N.nonce};qr.load(V==null?void 0:V.css,Td({name:"primitive-variables"},xe)),qr.load(ie==null?void 0:ie.css,Td({name:"semantic-variables"},xe)),qr.load(Pe==null?void 0:Pe.css,Td({name:"global-variables"},xe)),qr.loadStyle(Td({name:"global-style"},xe),Ne),vr.setLoadedStyleName("common")}};Dn.on("theme:change",function(I){u.value||(r.config.globalProperties.$primevue.config.theme=I,u.value=!0)});var y=jo(n.config,function(I,R){As.emit("config:change",{newValue:I,oldValue:R})},{immediate:!0,deep:!0}),C=jo(function(){return n.config.ripple},function(I,R){As.emit("config:ripple:change",{newValue:I,oldValue:R})},{immediate:!0,deep:!0}),b=jo(function(){return n.config.theme},function(I,R){u.value||vr.setTheme(I),n.config.unstyled||f(),u.value=!1,As.emit("config:theme:change",{newValue:I,oldValue:R})},{immediate:!0,deep:!1}),a=jo(function(){return n.config.unstyled},function(I,R){!I&&n.config.theme&&f(),As.emit("config:unstyled:change",{newValue:I,oldValue:R})},{immediate:!0,deep:!0});Fl.push(y),Fl.push(C),Fl.push(b),Fl.push(a)}var DS={install:function(n,u){var f=DC(IS,u);AS(n,f)}},LS={transitionDuration:"{transition.duration}"},BS={borderWidth:"0 0 1px 0",borderColor:"{content.border.color}"},$S={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",padding:"1.125rem",fontWeight:"600",borderRadius:"0",borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",hoverBackground:"{content.background}",activeBackground:"{content.background}",activeHoverBackground:"{content.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},toggleIcon:{color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}"},first:{topBorderRadius:"{content.border.radius}",borderWidth:"0"},last:{bottomBorderRadius:"{content.border.radius}",activeBottomBorderRadius:"0"}},OS={borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",color:"{text.color}",padding:"0 1.125rem 1.125rem 1.125rem"},FS={root:LS,panel:BS,header:$S,content:OS},jS={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},NS={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},VS={padding:"{list.padding}",gap:"{list.gap}"},US={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},ZS={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},GS={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},qS={borderRadius:"{border.radius.sm}"},WS={padding:"{list.option.padding}"},HS={light:{chip:{focusBackground:"{surface.200}",focusColor:"{surface.800}"},dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",focusColor:"{surface.0}"},dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"}}},XS={root:jS,overlay:NS,list:VS,option:US,optionGroup:ZS,dropdown:GS,chip:qS,emptyMessage:WS,colorScheme:HS},YS={width:"2rem",height:"2rem",fontSize:"1rem",background:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},KS={size:"1rem"},JS={borderColor:"{content.background}",offset:"-0.75rem"},QS={width:"3rem",height:"3rem",fontSize:"1.5rem",icon:{size:"1.5rem"},group:{offset:"-1rem"}},eT={width:"4rem",height:"4rem",fontSize:"2rem",icon:{size:"2rem"},group:{offset:"-1.5rem"}},tT={root:YS,icon:KS,group:JS,lg:QS,xl:eT},rT={borderRadius:"{border.radius.md}",padding:"0 0.5rem",fontSize:"0.75rem",fontWeight:"700",minWidth:"1.5rem",height:"1.5rem"},nT={size:"0.5rem"},oT={fontSize:"0.625rem",minWidth:"1.25rem",height:"1.25rem"},iT={fontSize:"0.875rem",minWidth:"1.75rem",height:"1.75rem"},sT={fontSize:"1rem",minWidth:"2rem",height:"2rem"},aT={light:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.500}",color:"{surface.0}"},info:{background:"{sky.500}",color:"{surface.0}"},warn:{background:"{orange.500}",color:"{surface.0}"},danger:{background:"{red.500}",color:"{surface.0}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"{green.400}",color:"{green.950}"},info:{background:"{sky.400}",color:"{sky.950}"},warn:{background:"{orange.400}",color:"{orange.950}"},danger:{background:"{red.400}",color:"{red.950}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},lT={root:rT,dot:nT,sm:oT,lg:iT,xl:sT,colorScheme:aT},cT={borderRadius:{none:"0",xs:"2px",sm:"4px",md:"6px",lg:"8px",xl:"12px"},emerald:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b",950:"#022c22"},green:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d",950:"#052e16"},lime:{50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314",950:"#1a2e05"},red:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d",950:"#450a0a"},orange:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12",950:"#431407"},amber:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f",950:"#451a03"},yellow:{50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12",950:"#422006"},teal:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a",950:"#042f2e"},cyan:{50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63",950:"#083344"},sky:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e",950:"#082f49"},blue:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a",950:"#172554"},indigo:{50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81",950:"#1e1b4b"},violet:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95",950:"#2e1065"},purple:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87",950:"#3b0764"},fuchsia:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75",950:"#4a044e"},pink:{50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843",950:"#500724"},rose:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337",950:"#4c0519"},slate:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a",950:"#020617"},gray:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827",950:"#030712"},zinc:{50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b",950:"#09090b"},neutral:{50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717",950:"#0a0a0a"},stone:{50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917",950:"#0c0a09"}},uT={transitionDuration:"0.2s",focusRing:{width:"1px",style:"solid",color:"{primary.color}",offset:"2px",shadow:"none"},disabledOpacity:"0.6",iconSize:"1rem",anchorGutter:"2px",primary:{50:"{emerald.50}",100:"{emerald.100}",200:"{emerald.200}",300:"{emerald.300}",400:"{emerald.400}",500:"{emerald.500}",600:"{emerald.600}",700:"{emerald.700}",800:"{emerald.800}",900:"{emerald.900}",950:"{emerald.950}"},formField:{paddingX:"0.75rem",paddingY:"0.5rem",sm:{fontSize:"0.875rem",paddingX:"0.625rem",paddingY:"0.375rem"},lg:{fontSize:"1.125rem",paddingX:"0.875rem",paddingY:"0.625rem"},borderRadius:"{border.radius.md}",focusRing:{width:"0",style:"none",color:"transparent",offset:"0",shadow:"none"},transitionDuration:"{transition.duration}"},list:{padding:"0.25rem 0.25rem",gap:"2px",header:{padding:"0.5rem 1rem 0.25rem 1rem"},option:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}"},optionGroup:{padding:"0.5rem 0.75rem",fontWeight:"600"}},content:{borderRadius:"{border.radius.md}"},mask:{transitionDuration:"0.15s"},navigation:{list:{padding:"0.25rem 0.25rem",gap:"2px"},item:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}",gap:"0.5rem"},submenuLabel:{padding:"0.5rem 0.75rem",fontWeight:"600"},submenuIcon:{size:"0.875rem"}},overlay:{select:{borderRadius:"{border.radius.md}",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},popover:{borderRadius:"{border.radius.md}",padding:"0.75rem",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},modal:{borderRadius:"{border.radius.xl}",padding:"1.25rem",shadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1)"},navigation:{shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"}},colorScheme:{light:{surface:{0:"#ffffff",50:"{slate.50}",100:"{slate.100}",200:"{slate.200}",300:"{slate.300}",400:"{slate.400}",500:"{slate.500}",600:"{slate.600}",700:"{slate.700}",800:"{slate.800}",900:"{slate.900}",950:"{slate.950}"},primary:{color:"{primary.500}",contrastColor:"#ffffff",hoverColor:"{primary.600}",activeColor:"{primary.700}"},highlight:{background:"{primary.50}",focusBackground:"{primary.100}",color:"{primary.700}",focusColor:"{primary.800}"},mask:{background:"rgba(0,0,0,0.4)",color:"{surface.200}"},formField:{background:"{surface.0}",disabledBackground:"{surface.200}",filledBackground:"{surface.50}",filledHoverBackground:"{surface.50}",filledFocusBackground:"{surface.50}",borderColor:"{surface.300}",hoverBorderColor:"{surface.400}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.400}",color:"{surface.700}",disabledColor:"{surface.500}",placeholderColor:"{surface.500}",invalidPlaceholderColor:"{red.600}",floatLabelColor:"{surface.500}",floatLabelFocusColor:"{primary.600}",floatLabelActiveColor:"{surface.500}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.700}",hoverColor:"{surface.800}",mutedColor:"{surface.500}",hoverMutedColor:"{surface.600}"},content:{background:"{surface.0}",hoverBackground:"{surface.100}",borderColor:"{surface.200}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},popover:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},modal:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.100}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.100}",activeBackground:"{surface.100}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}}},dark:{surface:{0:"#ffffff",50:"{zinc.50}",100:"{zinc.100}",200:"{zinc.200}",300:"{zinc.300}",400:"{zinc.400}",500:"{zinc.500}",600:"{zinc.600}",700:"{zinc.700}",800:"{zinc.800}",900:"{zinc.900}",950:"{zinc.950}"},primary:{color:"{primary.400}",contrastColor:"{surface.900}",hoverColor:"{primary.300}",activeColor:"{primary.200}"},highlight:{background:"color-mix(in srgb, {primary.400}, transparent 84%)",focusBackground:"color-mix(in srgb, {primary.400}, transparent 76%)",color:"rgba(255,255,255,.87)",focusColor:"rgba(255,255,255,.87)"},mask:{background:"rgba(0,0,0,0.6)",color:"{surface.200}"},formField:{background:"{surface.950}",disabledBackground:"{surface.700}",filledBackground:"{surface.800}",filledHoverBackground:"{surface.800}",filledFocusBackground:"{surface.800}",borderColor:"{surface.600}",hoverBorderColor:"{surface.500}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.300}",color:"{surface.0}",disabledColor:"{surface.400}",placeholderColor:"{surface.400}",invalidPlaceholderColor:"{red.400}",floatLabelColor:"{surface.400}",floatLabelFocusColor:"{primary.color}",floatLabelActiveColor:"{surface.400}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.0}",hoverColor:"{surface.0}",mutedColor:"{surface.400}",hoverMutedColor:"{surface.300}"},content:{background:"{surface.900}",hoverBackground:"{surface.800}",borderColor:"{surface.700}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},popover:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},modal:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.800}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.800}",activeBackground:"{surface.800}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}}}}},hT={primitive:cT,semantic:uT},dT={borderRadius:"{content.border.radius}"},fT={root:dT},pT={padding:"1rem",background:"{content.background}",gap:"0.5rem",transitionDuration:"{transition.duration}"},mT={color:"{text.muted.color}",hoverColor:"{text.color}",borderRadius:"{content.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",hoverColor:"{navigation.item.icon.focus.color}"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},gT={color:"{navigation.item.icon.color}"},_T={root:pT,item:mT,separator:gT},yT={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",gap:"0.5rem",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",iconOnlyWidth:"2.5rem",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}",iconOnlyWidth:"2rem"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}",iconOnlyWidth:"3rem"},label:{fontWeight:"500"},raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"},badgeSize:"1rem",transitionDuration:"{form.field.transition.duration}"},vT={light:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",borderColor:"{surface.100}",hoverBorderColor:"{surface.200}",activeBorderColor:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}",focusRing:{color:"{surface.600}",shadow:"none"}},info:{background:"{sky.500}",hoverBackground:"{sky.600}",activeBackground:"{sky.700}",borderColor:"{sky.500}",hoverBorderColor:"{sky.600}",activeBorderColor:"{sky.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{sky.500}",shadow:"none"}},success:{background:"{green.500}",hoverBackground:"{green.600}",activeBackground:"{green.700}",borderColor:"{green.500}",hoverBorderColor:"{green.600}",activeBorderColor:"{green.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{green.500}",shadow:"none"}},warn:{background:"{orange.500}",hoverBackground:"{orange.600}",activeBackground:"{orange.700}",borderColor:"{orange.500}",hoverBorderColor:"{orange.600}",activeBorderColor:"{orange.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{orange.500}",shadow:"none"}},help:{background:"{purple.500}",hoverBackground:"{purple.600}",activeBackground:"{purple.700}",borderColor:"{purple.500}",hoverBorderColor:"{purple.600}",activeBorderColor:"{purple.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{purple.500}",shadow:"none"}},danger:{background:"{red.500}",hoverBackground:"{red.600}",activeBackground:"{red.700}",borderColor:"{red.500}",hoverBorderColor:"{red.600}",activeBorderColor:"{red.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{red.500}",shadow:"none"}},contrast:{background:"{surface.950}",hoverBackground:"{surface.900}",activeBackground:"{surface.800}",borderColor:"{surface.950}",hoverBorderColor:"{surface.900}",activeBorderColor:"{surface.800}",color:"{surface.0}",hoverColor:"{surface.0}",activeColor:"{surface.0}",focusRing:{color:"{surface.950}",shadow:"none"}}},outlined:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",borderColor:"{primary.200}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",borderColor:"{green.200}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",borderColor:"{sky.200}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",borderColor:"{orange.200}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",borderColor:"{purple.200}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",borderColor:"{red.200}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.700}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.700}"}},text:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.700}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}},dark:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",borderColor:"{surface.800}",hoverBorderColor:"{surface.700}",activeBorderColor:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}",focusRing:{color:"{surface.300}",shadow:"none"}},info:{background:"{sky.400}",hoverBackground:"{sky.300}",activeBackground:"{sky.200}",borderColor:"{sky.400}",hoverBorderColor:"{sky.300}",activeBorderColor:"{sky.200}",color:"{sky.950}",hoverColor:"{sky.950}",activeColor:"{sky.950}",focusRing:{color:"{sky.400}",shadow:"none"}},success:{background:"{green.400}",hoverBackground:"{green.300}",activeBackground:"{green.200}",borderColor:"{green.400}",hoverBorderColor:"{green.300}",activeBorderColor:"{green.200}",color:"{green.950}",hoverColor:"{green.950}",activeColor:"{green.950}",focusRing:{color:"{green.400}",shadow:"none"}},warn:{background:"{orange.400}",hoverBackground:"{orange.300}",activeBackground:"{orange.200}",borderColor:"{orange.400}",hoverBorderColor:"{orange.300}",activeBorderColor:"{orange.200}",color:"{orange.950}",hoverColor:"{orange.950}",activeColor:"{orange.950}",focusRing:{color:"{orange.400}",shadow:"none"}},help:{background:"{purple.400}",hoverBackground:"{purple.300}",activeBackground:"{purple.200}",borderColor:"{purple.400}",hoverBorderColor:"{purple.300}",activeBorderColor:"{purple.200}",color:"{purple.950}",hoverColor:"{purple.950}",activeColor:"{purple.950}",focusRing:{color:"{purple.400}",shadow:"none"}},danger:{background:"{red.400}",hoverBackground:"{red.300}",activeBackground:"{red.200}",borderColor:"{red.400}",hoverBorderColor:"{red.300}",activeBorderColor:"{red.200}",color:"{red.950}",hoverColor:"{red.950}",activeColor:"{red.950}",focusRing:{color:"{red.400}",shadow:"none"}},contrast:{background:"{surface.0}",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{surface.0}",hoverBorderColor:"{surface.100}",activeBorderColor:"{surface.200}",color:"{surface.950}",hoverColor:"{surface.950}",activeColor:"{surface.950}",focusRing:{color:"{surface.0}",shadow:"none"}}},outlined:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",borderColor:"{primary.700}",color:"{primary.color}"},secondary:{hoverBackground:"rgba(255,255,255,0.04)",activeBackground:"rgba(255,255,255,0.16)",borderColor:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",borderColor:"{green.700}",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",borderColor:"{sky.700}",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",borderColor:"{orange.700}",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",borderColor:"{purple.700}",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",borderColor:"{red.700}",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.500}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.600}",color:"{surface.0}"}},text:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",color:"{primary.color}"},secondary:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}}},bT={root:yT,colorScheme:vT},xT={background:"{content.background}",borderRadius:"{border.radius.xl}",color:"{content.color}",shadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)"},wT={padding:"1.25rem",gap:"0.5rem"},CT={gap:"0.5rem"},ST={fontSize:"1.25rem",fontWeight:"500"},TT={color:"{text.muted.color}"},kT={root:xT,body:wT,caption:CT,title:ST,subtitle:TT},PT={transitionDuration:"{transition.duration}"},MT={gap:"0.25rem"},IT={padding:"1rem",gap:"0.5rem"},ET={width:"2rem",height:"0.5rem",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},AT={light:{indicator:{background:"{surface.200}",hoverBackground:"{surface.300}",activeBackground:"{primary.color}"}},dark:{indicator:{background:"{surface.700}",hoverBackground:"{surface.600}",activeBackground:"{primary.color}"}}},zT={root:PT,content:MT,indicatorList:IT,indicator:ET,colorScheme:AT},RT={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},DT={width:"2.5rem",color:"{form.field.icon.color}"},LT={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},BT={padding:"{list.padding}",gap:"{list.gap}",mobileIndent:"1rem"},$T={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",icon:{color:"{list.option.icon.color}",focusColor:"{list.option.icon.focus.color}",size:"0.875rem"}},OT={color:"{form.field.icon.color}"},FT={root:RT,dropdown:DT,overlay:LT,list:BT,option:$T,clearIcon:OT},jT={borderRadius:"{border.radius.sm}",width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},NT={size:"0.875rem",color:"{form.field.color}",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.75rem"},lg:{size:"1rem"}},VT={root:jT,icon:NT},UT={borderRadius:"16px",paddingX:"0.75rem",paddingY:"0.5rem",gap:"0.5rem",transitionDuration:"{transition.duration}"},ZT={width:"2rem",height:"2rem"},GT={size:"1rem"},qT={size:"1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"}},WT={light:{root:{background:"{surface.100}",color:"{surface.800}"},icon:{color:"{surface.800}"},removeIcon:{color:"{surface.800}"}},dark:{root:{background:"{surface.800}",color:"{surface.0}"},icon:{color:"{surface.0}"},removeIcon:{color:"{surface.0}"}}},HT={root:UT,image:ZT,icon:GT,removeIcon:qT,colorScheme:WT},XT={transitionDuration:"{transition.duration}"},YT={width:"1.5rem",height:"1.5rem",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},KT={shadow:"{overlay.popover.shadow}",borderRadius:"{overlay.popover.borderRadius}"},JT={light:{panel:{background:"{surface.800}",borderColor:"{surface.900}"},handle:{color:"{surface.0}"}},dark:{panel:{background:"{surface.900}",borderColor:"{surface.700}"},handle:{color:"{surface.0}"}}},QT={root:XT,preview:YT,panel:KT,colorScheme:JT},ek={size:"2rem",color:"{overlay.modal.color}"},tk={gap:"1rem"},rk={icon:ek,content:tk},nk={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},ok={padding:"{overlay.popover.padding}",gap:"1rem"},ik={size:"1.5rem",color:"{overlay.popover.color}"},sk={gap:"0.5rem",padding:"0 {overlay.popover.padding} {overlay.popover.padding} {overlay.popover.padding}"},ak={root:nk,content:ok,icon:ik,footer:sk},lk={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},ck={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},uk={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},hk={mobileIndent:"1rem"},dk={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},fk={borderColor:"{content.border.color}"},pk={root:lk,list:ck,item:uk,submenu:hk,submenuIcon:dk,separator:fk},mk={transitionDuration:"{transition.duration}"},gk={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},_k={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{datatable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},yk={fontWeight:"600"},vk={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},bk={borderColor:"{datatable.border.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},xk={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},wk={fontWeight:"600"},Ck={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},Sk={color:"{primary.color}"},Tk={width:"0.5rem"},kk={width:"1px",color:"{primary.color}"},Pk={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},Mk={size:"2rem"},Ik={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Ek={inlineGap:"0.5rem",overlaySelect:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},overlayPopover:{background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}",gap:"0.5rem"},rule:{borderColor:"{content.border.color}"},constraintList:{padding:"{list.padding}",gap:"{list.gap}"},constraint:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",separator:{borderColor:"{content.border.color}"},padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"}},Ak={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},zk={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},Rk={light:{root:{borderColor:"{content.border.color}"},row:{stripedBackground:"{surface.50}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},row:{stripedBackground:"{surface.950}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},Dk={root:mk,header:gk,headerCell:_k,columnTitle:yk,row:vk,bodyCell:bk,footerCell:xk,columnFooter:wk,footer:Ck,dropPoint:Sk,columnResizer:Tk,resizeIndicator:kk,sortIcon:Pk,loadingIcon:Mk,rowToggleButton:Ik,filter:Ek,paginatorTop:Ak,paginatorBottom:zk,colorScheme:Rk},Lk={borderColor:"transparent",borderWidth:"0",borderRadius:"0",padding:"0"},Bk={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",borderRadius:"0"},$k={background:"{content.background}",color:"{content.color}",borderColor:"transparent",borderWidth:"0",padding:"0",borderRadius:"0"},Ok={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"1px 0 0 0",padding:"0.75rem 1rem",borderRadius:"0"},Fk={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},jk={borderColor:"{content.border.color}",borderWidth:"1px 0 0 0"},Nk={root:Lk,header:Bk,content:$k,footer:Ok,paginatorTop:Fk,paginatorBottom:jk},Vk={transitionDuration:"{transition.duration}"},Uk={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}"},Zk={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",padding:"0 0 0.5rem 0"},Gk={gap:"0.5rem",fontWeight:"500"},qk={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Wk={color:"{form.field.icon.color}"},Hk={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},Xk={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},Yk={borderColor:"{content.border.color}",gap:"{overlay.popover.padding}"},Kk={margin:"0.5rem 0 0 0"},Jk={padding:"0.25rem",fontWeight:"500",color:"{content.color}"},Qk={hoverBackground:"{content.hover.background}",selectedBackground:"{primary.color}",rangeSelectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{primary.contrast.color}",rangeSelectedColor:"{highlight.color}",width:"2rem",height:"2rem",borderRadius:"50%",padding:"0.25rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},eP={margin:"0.5rem 0 0 0"},tP={padding:"0.375rem",borderRadius:"{content.border.radius}"},rP={margin:"0.5rem 0 0 0"},nP={padding:"0.375rem",borderRadius:"{content.border.radius}"},oP={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}"},iP={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}",gap:"0.5rem",buttonGap:"0.25rem"},sP={light:{dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"},today:{background:"{surface.200}",color:"{surface.900}"}},dark:{dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"},today:{background:"{surface.700}",color:"{surface.0}"}}},aP={root:Vk,panel:Uk,header:Zk,title:Gk,dropdown:qk,inputIcon:Wk,selectMonth:Hk,selectYear:Xk,group:Yk,dayView:Kk,weekDay:Jk,date:Qk,monthView:eP,month:tP,yearView:rP,year:nP,buttonbar:oP,timePicker:iP,colorScheme:sP},lP={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",borderRadius:"{overlay.modal.border.radius}",shadow:"{overlay.modal.shadow}"},cP={padding:"{overlay.modal.padding}",gap:"0.5rem"},uP={fontSize:"1.25rem",fontWeight:"600"},hP={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},dP={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}",gap:"0.5rem"},fP={root:lP,header:cP,title:uP,content:hP,footer:dP},pP={borderColor:"{content.border.color}"},mP={background:"{content.background}",color:"{text.color}"},gP={margin:"1rem 0",padding:"0 1rem",content:{padding:"0 0.5rem"}},_P={margin:"0 1rem",padding:"0.5rem 0",content:{padding:"0.5rem 0"}},yP={root:pP,content:mP,horizontal:gP,vertical:_P},vP={background:"rgba(255, 255, 255, 0.1)",borderColor:"rgba(255, 255, 255, 0.2)",padding:"0.5rem",borderRadius:"{border.radius.xl}"},bP={borderRadius:"{content.border.radius}",padding:"0.5rem",size:"3rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},xP={root:vP,item:bP},wP={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",shadow:"{overlay.modal.shadow}"},CP={padding:"{overlay.modal.padding}"},SP={fontSize:"1.5rem",fontWeight:"600"},TP={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},kP={padding:"{overlay.modal.padding}"},PP={root:wP,header:CP,title:SP,content:TP,footer:kP},MP={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}"},IP={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},EP={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}",padding:"{list.padding}"},AP={focusBackground:"{list.option.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},zP={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},RP={toolbar:MP,toolbarItem:IP,overlay:EP,overlayOption:AP,content:zP},DP={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",padding:"0 1.125rem 1.125rem 1.125rem",transitionDuration:"{transition.duration}"},LP={background:"{content.background}",hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",borderRadius:"{content.border.radius}",borderWidth:"1px",borderColor:"transparent",padding:"0.5rem 0.75rem",gap:"0.5rem",fontWeight:"600",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},BP={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}"},$P={padding:"0"},OP={root:DP,legend:LP,toggleIcon:BP,content:$P},FP={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},jP={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"unset",borderWidth:"0",borderRadius:"0",gap:"0.5rem"},NP={highlightBorderColor:"{primary.color}",padding:"0 1.125rem 1.125rem 1.125rem",gap:"1rem"},VP={padding:"1rem",gap:"1rem",borderColor:"{content.border.color}",info:{gap:"0.5rem"}},UP={gap:"0.5rem"},ZP={height:"0.25rem"},GP={gap:"0.5rem"},qP={root:FP,header:jP,content:NP,file:VP,fileList:UP,progressbar:ZP,basic:GP},WP={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",activeColor:"{form.field.float.label.active.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",positionY:"{form.field.padding.y}",fontWeight:"500",active:{fontSize:"0.75rem",fontWeight:"400"}},HP={active:{top:"-1.25rem"}},XP={input:{paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},active:{top:"{form.field.padding.y}"}},YP={borderRadius:"{border.radius.xs}",active:{background:"{form.field.background}",padding:"0 0.125rem"}},KP={root:WP,over:HP,in:XP,on:YP},JP={borderWidth:"1px",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},QP={background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.100}",hoverColor:"{surface.0}",size:"3rem",gutter:"0.5rem",prev:{borderRadius:"50%"},next:{borderRadius:"50%"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},eM={size:"1.5rem"},tM={background:"{content.background}",padding:"1rem 0.25rem"},rM={size:"2rem",borderRadius:"{content.border.radius}",gutter:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},nM={size:"1rem"},oM={background:"rgba(0, 0, 0, 0.5)",color:"{surface.100}",padding:"1rem"},iM={gap:"0.5rem",padding:"1rem"},sM={width:"1rem",height:"1rem",activeBackground:"{primary.color}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},aM={background:"rgba(0, 0, 0, 0.5)"},lM={background:"rgba(255, 255, 255, 0.4)",hoverBackground:"rgba(255, 255, 255, 0.6)",activeBackground:"rgba(255, 255, 255, 0.9)"},cM={size:"3rem",gutter:"0.5rem",background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.50}",hoverColor:"{surface.0}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},uM={size:"1.5rem"},hM={light:{thumbnailNavButton:{hoverBackground:"{surface.100}",color:"{surface.600}",hoverColor:"{surface.700}"},indicatorButton:{background:"{surface.200}",hoverBackground:"{surface.300}"}},dark:{thumbnailNavButton:{hoverBackground:"{surface.700}",color:"{surface.400}",hoverColor:"{surface.0}"},indicatorButton:{background:"{surface.700}",hoverBackground:"{surface.600}"}}},dM={root:JP,navButton:QP,navIcon:eM,thumbnailsContent:tM,thumbnailNavButton:rM,thumbnailNavButtonIcon:nM,caption:oM,indicatorList:iM,indicatorButton:sM,insetIndicatorList:aM,insetIndicatorButton:lM,closeButton:cM,closeButtonIcon:uM,colorScheme:hM},fM={color:"{form.field.icon.color}"},pM={icon:fM},mM={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",top:"{form.field.padding.y}",fontSize:"0.75rem",fontWeight:"400"},gM={paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},_M={root:mM,input:gM},yM={transitionDuration:"{transition.duration}"},vM={icon:{size:"1.5rem"},mask:{background:"{mask.background}",color:"{mask.color}"}},bM={position:{left:"auto",right:"1rem",top:"1rem",bottom:"auto"},blur:"8px",background:"rgba(255,255,255,0.1)",borderColor:"rgba(255,255,255,0.2)",borderWidth:"1px",borderRadius:"30px",padding:".5rem",gap:"0.5rem"},xM={hoverBackground:"rgba(255,255,255,0.1)",color:"{surface.50}",hoverColor:"{surface.0}",size:"3rem",iconSize:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},wM={root:yM,preview:vM,toolbar:bM,action:xM},CM={size:"15px",hoverSize:"30px",background:"rgba(255,255,255,0.3)",hoverBackground:"rgba(255,255,255,0.3)",borderColor:"unset",hoverBorderColor:"unset",borderWidth:"0",borderRadius:"50%",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"rgba(255,255,255,0.3)",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},SM={handle:CM},TM={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",gap:"0.5rem"},kM={fontWeight:"500"},PM={size:"1rem"},MM={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}}},IM={root:TM,text:kM,icon:PM,colorScheme:MM},EM={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{transition.duration}"},AM={hoverBackground:"{content.hover.background}",hoverColor:"{content.hover.color}"},zM={root:EM,display:AM},RM={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},DM={borderRadius:"{border.radius.sm}"},LM={light:{chip:{focusBackground:"{surface.200}",color:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",color:"{surface.0}"}}},BM={root:RM,chip:DM,colorScheme:LM},$M={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.icon.color}",borderRadius:"{form.field.border.radius}",padding:"0.5rem",minWidth:"2.5rem"},OM={addon:$M},FM={transitionDuration:"{transition.duration}"},jM={width:"2.5rem",borderRadius:"{form.field.border.radius}",verticalPadding:"{form.field.padding.y}"},NM={light:{button:{background:"transparent",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.500}",activeColor:"{surface.600}"}},dark:{button:{background:"transparent",hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.300}",activeColor:"{surface.200}"}}},VM={root:FM,button:jM,colorScheme:NM},UM={gap:"0.5rem"},ZM={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"}},GM={root:UM,input:ZM},qM={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},WM={root:qM},HM={transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},XM={background:"{primary.color}"},YM={background:"{content.border.color}"},KM={color:"{text.muted.color}"},JM={root:HM,value:XM,range:YM,text:KM},QM={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",borderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",shadow:"{form.field.shadow}",borderRadius:"{form.field.border.radius}",transitionDuration:"{form.field.transition.duration}"},eI={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},tI={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},rI={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},nI={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},oI={padding:"{list.option.padding}"},iI={light:{option:{stripedBackground:"{surface.50}"}},dark:{option:{stripedBackground:"{surface.900}"}}},sI={root:QM,list:eI,option:tI,optionGroup:rI,checkmark:nI,emptyMessage:oI,colorScheme:iI},aI={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",verticalOrientation:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},horizontalOrientation:{padding:"0.5rem 0.75rem",gap:"0.5rem"},transitionDuration:"{transition.duration}"},lI={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},cI={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},uI={padding:"0",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",shadow:"{overlay.navigation.shadow}",gap:"0.5rem"},hI={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},dI={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background.}",color:"{navigation.submenu.label.color}"},fI={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},pI={borderColor:"{content.border.color}"},mI={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},gI={root:aI,baseItem:lI,item:cI,overlay:uI,submenu:hI,submenuLabel:dI,submenuIcon:fI,separator:pI,mobileButton:mI},_I={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},yI={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},vI={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},bI={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background}",color:"{navigation.submenu.label.color}"},xI={borderColor:"{content.border.color}"},wI={root:_I,list:yI,item:vI,submenuLabel:bI,separator:xI},CI={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.5rem 0.75rem",transitionDuration:"{transition.duration}"},SI={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},TI={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},kI={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",mobileIndent:"1rem",icon:{size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"}},PI={borderColor:"{content.border.color}"},MI={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},II={root:CI,baseItem:SI,item:TI,submenu:kI,separator:PI,mobileButton:MI},EI={borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},AI={padding:"0.5rem 0.75rem",gap:"0.5rem",sm:{padding:"0.375rem 0.625rem"},lg:{padding:"0.625rem 0.875rem"}},zI={fontSize:"1rem",fontWeight:"500",sm:{fontSize:"0.875rem"},lg:{fontSize:"1.125rem"}},RI={size:"1.125rem",sm:{size:"1rem"},lg:{size:"1.25rem"}},DI={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},LI={size:"1rem",sm:{size:"0.875rem"},lg:{size:"1.125rem"}},BI={root:{borderWidth:"1px"}},$I={content:{padding:"0"}},OI={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}},outlined:{color:"{blue.600}",borderColor:"{blue.600}"},simple:{color:"{blue.600}"}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}},outlined:{color:"{green.600}",borderColor:"{green.600}"},simple:{color:"{green.600}"}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}},outlined:{color:"{yellow.600}",borderColor:"{yellow.600}"},simple:{color:"{yellow.600}"}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}},outlined:{color:"{red.600}",borderColor:"{red.600}"},simple:{color:"{red.600}"}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}},outlined:{color:"{surface.500}",borderColor:"{surface.500}"},simple:{color:"{surface.500}"}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}},outlined:{color:"{surface.950}",borderColor:"{surface.950}"},simple:{color:"{surface.950}"}}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}},outlined:{color:"{blue.500}",borderColor:"{blue.500}"},simple:{color:"{blue.500}"}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}},outlined:{color:"{green.500}",borderColor:"{green.500}"},simple:{color:"{green.500}"}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}},outlined:{color:"{yellow.500}",borderColor:"{yellow.500}"},simple:{color:"{yellow.500}"}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}},outlined:{color:"{red.500}",borderColor:"{red.500}"},simple:{color:"{red.500}"}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}},outlined:{color:"{surface.400}",borderColor:"{surface.400}"},simple:{color:"{surface.400}"}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}},outlined:{color:"{surface.0}",borderColor:"{surface.0}"},simple:{color:"{surface.0}"}}}},FI={root:EI,content:AI,text:zI,icon:RI,closeButton:DI,closeIcon:LI,outlined:BI,simple:$I,colorScheme:OI},jI={borderRadius:"{content.border.radius}",gap:"1rem"},NI={background:"{content.border.color}",size:"0.5rem"},VI={gap:"0.5rem"},UI={size:"0.5rem"},ZI={size:"1rem"},GI={verticalGap:"0.5rem",horizontalGap:"1rem"},qI={root:jI,meters:NI,label:VI,labelMarker:UI,labelIcon:ZI,labelList:GI},WI={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},HI={width:"2.5rem",color:"{form.field.icon.color}"},XI={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},YI={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},KI={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",gap:"0.5rem"},JI={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},QI={color:"{form.field.icon.color}"},eE={borderRadius:"{border.radius.sm}"},tE={padding:"{list.option.padding}"},rE={root:WI,dropdown:HI,overlay:XI,list:YI,option:KI,optionGroup:JI,chip:eE,clearIcon:QI,emptyMessage:tE},nE={gap:"1.125rem"},oE={gap:"0.5rem"},iE={root:nE,controls:oE},sE={gutter:"0.75rem",transitionDuration:"{transition.duration}"},aE={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{content.border.color}",color:"{content.color}",selectedColor:"{highlight.color}",hoverColor:"{content.hover.color}",padding:"0.75rem 1rem",toggleablePadding:"0.75rem 1rem 1.25rem 1rem",borderRadius:"{content.border.radius}"},lE={background:"{content.background}",hoverBackground:"{content.hover.background}",borderColor:"{content.border.color}",color:"{text.muted.color}",hoverColor:"{text.color}",size:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},cE={color:"{content.border.color}",borderRadius:"{content.border.radius}",height:"24px"},uE={root:sE,node:aE,nodeToggleButton:lE,connector:cE},hE={outline:{width:"2px",color:"{content.background}"}},dE={root:hE},fE={padding:"0.5rem 1rem",gap:"0.25rem",borderRadius:"{content.border.radius}",background:"{content.background}",color:"{content.color}",transitionDuration:"{transition.duration}"},pE={background:"transparent",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}",width:"2.5rem",height:"2.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},mE={color:"{text.muted.color}"},gE={maxWidth:"2.5rem"},_E={root:fE,navButton:pE,currentPageReport:mE,jumpToPageInput:gE},yE={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},vE={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"{content.border.color}",borderWidth:"0",borderRadius:"0"},bE={padding:"0.375rem 1.125rem"},xE={fontWeight:"600"},wE={padding:"0 1.125rem 1.125rem 1.125rem"},CE={padding:"0 1.125rem 1.125rem 1.125rem"},SE={root:yE,header:vE,toggleableHeader:bE,title:xE,content:wE,footer:CE},TE={gap:"0.5rem",transitionDuration:"{transition.duration}"},kE={background:"{content.background}",borderColor:"{content.border.color}",borderWidth:"1px",color:"{content.color}",padding:"0.25rem 0.25rem",borderRadius:"{content.border.radius}",first:{borderWidth:"1px",topBorderRadius:"{content.border.radius}"},last:{borderWidth:"1px",bottomBorderRadius:"{content.border.radius}"}},PE={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",gap:"0.5rem",padding:"{navigation.item.padding}",borderRadius:"{content.border.radius}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},ME={indent:"1rem"},IE={color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}"},EE={root:TE,panel:kE,item:PE,submenu:ME,submenuIcon:IE},AE={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:".75rem"},zE={color:"{form.field.icon.color}"},RE={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",padding:"{overlay.popover.padding}",shadow:"{overlay.popover.shadow}"},DE={gap:"0.5rem"},LE={light:{strength:{weakBackground:"{red.500}",mediumBackground:"{amber.500}",strongBackground:"{green.500}"}},dark:{strength:{weakBackground:"{red.400}",mediumBackground:"{amber.400}",strongBackground:"{green.400}"}}},BE={meter:AE,icon:zE,overlay:RE,content:DE,colorScheme:LE},$E={gap:"1.125rem"},OE={gap:"0.5rem"},FE={root:$E,controls:OE},jE={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},NE={padding:"{overlay.popover.padding}"},VE={root:jE,content:NE},UE={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:"1.25rem"},ZE={background:"{primary.color}"},GE={color:"{primary.contrast.color}",fontSize:"0.75rem",fontWeight:"600"},qE={root:UE,value:ZE,label:GE},WE={light:{root:{colorOne:"{red.500}",colorTwo:"{blue.500}",colorThree:"{green.500}",colorFour:"{yellow.500}"}},dark:{root:{colorOne:"{red.400}",colorTwo:"{blue.400}",colorThree:"{green.400}",colorFour:"{yellow.400}"}}},HE={colorScheme:WE},XE={width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},YE={size:"0.75rem",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.5rem"},lg:{size:"1rem"}},KE={root:XE,icon:YE},JE={gap:"0.25rem",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},QE={size:"1rem",color:"{text.muted.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"},eA={root:JE,icon:QE},tA={light:{root:{background:"rgba(0,0,0,0.1)"}},dark:{root:{background:"rgba(255,255,255,0.3)"}}},rA={colorScheme:tA},nA={transitionDuration:"{transition.duration}"},oA={size:"9px",borderRadius:"{border.radius.sm}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},iA={light:{bar:{background:"{surface.100}"}},dark:{bar:{background:"{surface.800}"}}},sA={root:nA,bar:oA,colorScheme:iA},aA={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},lA={width:"2.5rem",color:"{form.field.icon.color}"},cA={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},uA={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},hA={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},dA={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},fA={color:"{form.field.icon.color}"},pA={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},mA={padding:"{list.option.padding}"},gA={root:aA,dropdown:lA,overlay:cA,list:uA,option:hA,optionGroup:dA,clearIcon:fA,checkmark:pA,emptyMessage:mA},_A={borderRadius:"{form.field.border.radius}"},yA={light:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}},dark:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}}},vA={root:_A,colorScheme:yA},bA={borderRadius:"{content.border.radius}"},xA={light:{root:{background:"{surface.200}",animationBackground:"rgba(255,255,255,0.4)"}},dark:{root:{background:"rgba(255, 255, 255, 0.06)",animationBackground:"rgba(255, 255, 255, 0.04)"}}},wA={root:bA,colorScheme:xA},CA={transitionDuration:"{transition.duration}"},SA={background:"{content.border.color}",borderRadius:"{content.border.radius}",size:"3px"},TA={background:"{primary.color}"},kA={width:"20px",height:"20px",borderRadius:"50%",background:"{content.border.color}",hoverBackground:"{content.border.color}",content:{borderRadius:"50%",hoverBackground:"{content.background}",width:"16px",height:"16px",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.08), 0px 1px 1px 0px rgba(0, 0, 0, 0.14)"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},PA={light:{handle:{content:{background:"{surface.0}"}}},dark:{handle:{content:{background:"{surface.950}"}}}},MA={root:CA,track:SA,range:TA,handle:kA,colorScheme:PA},IA={gap:"0.5rem",transitionDuration:"{transition.duration}"},EA={root:IA},AA={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)"},zA={root:AA},RA={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",transitionDuration:"{transition.duration}"},DA={background:"{content.border.color}"},LA={size:"24px",background:"transparent",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},BA={root:RA,gutter:DA,handle:LA},$A={transitionDuration:"{transition.duration}"},OA={background:"{content.border.color}",activeBackground:"{primary.color}",margin:"0 0 0 1.625rem",size:"2px"},FA={padding:"0.5rem",gap:"1rem"},jA={padding:"0",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},NA={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},VA={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},UA={padding:"0.875rem 0.5rem 1.125rem 0.5rem"},ZA={background:"{content.background}",color:"{content.color}",padding:"0",indent:"1rem"},GA={root:$A,separator:OA,step:FA,stepHeader:jA,stepTitle:NA,stepNumber:VA,steppanels:UA,steppanel:ZA},qA={transitionDuration:"{transition.duration}"},WA={background:"{content.border.color}"},HA={borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},XA={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},YA={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},KA={root:qA,separator:WA,itemLink:HA,itemLabel:XA,itemNumber:YA},JA={transitionDuration:"{transition.duration}"},QA={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},e5={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},t5={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},r5={height:"1px",bottom:"-1px",background:"{primary.color}"},n5={root:JA,tablist:QA,item:e5,itemIcon:t5,activeBar:r5},o5={transitionDuration:"{transition.duration}"},i5={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},s5={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},a5={background:"{content.background}",color:"{content.color}",padding:"0.875rem 1.125rem 1.125rem 1.125rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"inset {focus.ring.shadow}"}},l5={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",width:"2.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},c5={height:"1px",bottom:"-1px",background:"{primary.color}"},u5={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},h5={root:o5,tablist:i5,tab:s5,tabpanel:a5,navButton:l5,activeBar:c5,colorScheme:u5},d5={transitionDuration:"{transition.duration}"},f5={background:"{content.background}",borderColor:"{content.border.color}"},p5={borderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},m5={background:"{content.background}",color:"{content.color}"},g5={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}"},_5={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},y5={root:d5,tabList:f5,tab:p5,tabPanel:m5,navButton:g5,colorScheme:_5},v5={fontSize:"0.875rem",fontWeight:"700",padding:"0.25rem 0.5rem",gap:"0.25rem",borderRadius:"{content.border.radius}",roundedBorderRadius:"{border.radius.xl}"},b5={size:"0.75rem"},x5={light:{primary:{background:"{primary.100}",color:"{primary.700}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.100}",color:"{green.700}"},info:{background:"{sky.100}",color:"{sky.700}"},warn:{background:"{orange.100}",color:"{orange.700}"},danger:{background:"{red.100}",color:"{red.700}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"color-mix(in srgb, {primary.500}, transparent 84%)",color:"{primary.300}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",color:"{green.300}"},info:{background:"color-mix(in srgb, {sky.500}, transparent 84%)",color:"{sky.300}"},warn:{background:"color-mix(in srgb, {orange.500}, transparent 84%)",color:"{orange.300}"},danger:{background:"color-mix(in srgb, {red.500}, transparent 84%)",color:"{red.300}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},w5={root:v5,icon:b5,colorScheme:x5},C5={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.color}",height:"18rem",padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{form.field.border.radius}"},S5={gap:"0.25rem"},T5={margin:"2px 0"},k5={root:C5,prompt:S5,commandResponse:T5},P5={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},M5={root:P5},I5={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},E5={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},A5={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},z5={mobileIndent:"1rem"},R5={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},D5={borderColor:"{content.border.color}"},L5={root:I5,list:E5,item:A5,submenu:z5,submenuIcon:R5,separator:D5},B5={minHeight:"5rem"},$5={eventContent:{padding:"1rem 0"}},O5={eventContent:{padding:"0 1rem"}},F5={size:"1.125rem",borderRadius:"50%",borderWidth:"2px",background:"{content.background}",borderColor:"{content.border.color}",content:{borderRadius:"50%",size:"0.375rem",background:"{primary.color}",insetShadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"}},j5={color:"{content.border.color}",size:"2px"},N5={event:B5,horizontal:$5,vertical:O5,eventMarker:F5,eventConnector:j5},V5={width:"25rem",borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},U5={size:"1.125rem"},Z5={padding:"{overlay.popover.padding}",gap:"0.5rem"},G5={gap:"0.5rem"},q5={fontWeight:"500",fontSize:"1rem"},W5={fontWeight:"500",fontSize:"0.875rem"},H5={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},X5={size:"1rem"},Y5={light:{blur:"1.5px",info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}}}},dark:{blur:"10px",info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",detailColor:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}}}}},K5={root:V5,icon:U5,content:Z5,text:G5,summary:q5,detail:W5,closeButton:H5,closeIcon:X5,colorScheme:Y5},J5={padding:"0.25rem",borderRadius:"{content.border.radius}",gap:"0.5rem",fontWeight:"500",disabledBackground:"{form.field.disabled.background}",disabledBorderColor:"{form.field.disabled.background}",disabledColor:"{form.field.disabled.color}",invalidBorderColor:"{form.field.invalid.border.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",padding:"0.25rem"},lg:{fontSize:"{form.field.lg.font.size}",padding:"0.25rem"}},Q5={disabledColor:"{form.field.disabled.color}"},ez={padding:"0.25rem 0.75rem",borderRadius:"{content.border.radius}",checkedShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.02), 0px 1px 2px 0px rgba(0, 0, 0, 0.04)",sm:{padding:"0.25rem 0.75rem"},lg:{padding:"0.25rem 0.75rem"}},tz={light:{root:{background:"{surface.100}",checkedBackground:"{surface.100}",hoverBackground:"{surface.100}",borderColor:"{surface.100}",color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}",checkedBorderColor:"{surface.100}"},content:{checkedBackground:"{surface.0}"},icon:{color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}"}},dark:{root:{background:"{surface.950}",checkedBackground:"{surface.950}",hoverBackground:"{surface.950}",borderColor:"{surface.950}",color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}",checkedBorderColor:"{surface.950}"},content:{checkedBackground:"{surface.800}"},icon:{color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}"}}},rz={root:J5,icon:Q5,content:ez,colorScheme:tz},nz={width:"2.5rem",height:"1.5rem",borderRadius:"30px",gap:"0.25rem",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},borderWidth:"1px",borderColor:"transparent",hoverBorderColor:"transparent",checkedBorderColor:"transparent",checkedHoverBorderColor:"transparent",invalidBorderColor:"{form.field.invalid.border.color}",transitionDuration:"{form.field.transition.duration}",slideDuration:"0.2s"},oz={borderRadius:"50%",size:"1rem"},iz={light:{root:{background:"{surface.300}",disabledBackground:"{form.field.disabled.background}",hoverBackground:"{surface.400}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.0}",disabledBackground:"{form.field.disabled.color}",hoverBackground:"{surface.0}",checkedBackground:"{surface.0}",checkedHoverBackground:"{surface.0}",color:"{text.muted.color}",hoverColor:"{text.color}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}},dark:{root:{background:"{surface.700}",disabledBackground:"{surface.600}",hoverBackground:"{surface.600}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.400}",disabledBackground:"{surface.900}",hoverBackground:"{surface.300}",checkedBackground:"{surface.900}",checkedHoverBackground:"{surface.900}",color:"{surface.900}",hoverColor:"{surface.800}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}}},sz={root:nz,handle:oz,colorScheme:iz},az={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.75rem"},lz={root:az},cz={maxWidth:"12.5rem",gutter:"0.25rem",shadow:"{overlay.popover.shadow}",padding:"0.5rem 0.75rem",borderRadius:"{overlay.popover.border.radius}"},uz={light:{root:{background:"{surface.700}",color:"{surface.0}"}},dark:{root:{background:"{surface.700}",color:"{surface.0}"}}},hz={root:cz,colorScheme:uz},dz={background:"{content.background}",color:"{content.color}",padding:"1rem",gap:"2px",indent:"1rem",transitionDuration:"{transition.duration}"},fz={padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.color}",hoverColor:"{text.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},gap:"0.25rem"},pz={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}"},mz={borderRadius:"50%",size:"1.75rem",hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedHoverColor:"{primary.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},gz={size:"2rem"},_z={margin:"0 0 0.5rem 0"},yz={root:dz,node:fz,nodeIcon:pz,nodeToggleButton:mz,loadingIcon:gz,filter:_z},vz={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},bz={width:"2.5rem",color:"{form.field.icon.color}"},xz={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},wz={padding:"{list.padding}"},Cz={padding:"{list.option.padding}"},Sz={borderRadius:"{border.radius.sm}"},Tz={color:"{form.field.icon.color}"},kz={root:vz,dropdown:bz,overlay:xz,tree:wz,emptyMessage:Cz,chip:Sz,clearIcon:Tz},Pz={transitionDuration:"{transition.duration}"},Mz={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},Iz={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{treetable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},Ez={fontWeight:"600"},Az={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},zz={borderColor:"{treetable.border.color}",padding:"0.75rem 1rem",gap:"0.5rem"},Rz={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",padding:"0.75rem 1rem"},Dz={fontWeight:"600"},Lz={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},Bz={width:"0.5rem"},$z={width:"1px",color:"{primary.color}"},Oz={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},Fz={size:"2rem"},jz={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Nz={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},Vz={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},Uz={light:{root:{borderColor:"{content.border.color}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},Zz={root:Pz,header:Mz,headerCell:Iz,columnTitle:Ez,row:Az,bodyCell:zz,footerCell:Rz,columnFooter:Dz,footer:Lz,columnResizer:Bz,resizeIndicator:$z,sortIcon:Oz,loadingIcon:Fz,nodeToggleButton:jz,paginatorTop:Nz,paginatorBottom:Vz,colorScheme:Uz},Gz={mask:{background:"{content.background}",color:"{text.muted.color}"},icon:{size:"2rem"}},qz={loader:Gz},Wz=Object.defineProperty,Hz=Object.defineProperties,Xz=Object.getOwnPropertyDescriptors,Vy=Object.getOwnPropertySymbols,Yz=Object.prototype.hasOwnProperty,Kz=Object.prototype.propertyIsEnumerable,Uy=(r,n,u)=>n in r?Wz(r,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):r[n]=u,Zy,Jz=(Zy=((r,n)=>{for(var u in n||(n={}))Yz.call(n,u)&&Uy(r,u,n[u]);if(Vy)for(var u of Vy(n))Kz.call(n,u)&&Uy(r,u,n[u]);return r})({},hT),Hz(Zy,Xz({components:{accordion:FS,autocomplete:XS,avatar:tT,badge:lT,blockui:fT,breadcrumb:_T,button:bT,card:kT,carousel:zT,cascadeselect:FT,checkbox:VT,chip:HT,colorpicker:QT,confirmdialog:rk,confirmpopup:ak,contextmenu:pk,datatable:Dk,dataview:Nk,datepicker:aP,dialog:fP,divider:yP,dock:xP,drawer:PP,editor:RP,fieldset:OP,fileupload:qP,floatlabel:KP,galleria:dM,iconfield:pM,iftalabel:_M,image:wM,imagecompare:SM,inlinemessage:IM,inplace:zM,inputchips:BM,inputgroup:OM,inputnumber:VM,inputotp:GM,inputtext:WM,knob:JM,listbox:sI,megamenu:gI,menu:wI,menubar:II,message:FI,metergroup:qI,multiselect:rE,orderlist:iE,organizationchart:uE,overlaybadge:dE,paginator:_E,panel:SE,panelmenu:EE,password:BE,picklist:FE,popover:VE,progressbar:qE,progressspinner:HE,radiobutton:KE,rating:eA,ripple:rA,scrollpanel:sA,select:gA,selectbutton:vA,skeleton:wA,slider:MA,speeddial:EA,splitbutton:zA,splitter:BA,stepper:GA,steps:KA,tabmenu:n5,tabs:h5,tabview:y5,tag:w5,terminal:k5,textarea:M5,tieredmenu:L5,timeline:N5,toast:K5,togglebutton:rz,toggleswitch:sz,toolbar:lz,tooltip:hz,tree:yz,treeselect:kz,treetable:Zz,virtualscroller:qz}})));function Qz(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ld={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.2.0/LICENSE.txt
 */var eR=Ld.exports,Gy;function tR(){return Gy||(Gy=1,function(r,n){(function(u,f){r.exports=f()})(eR,function(){var u={},f={};function y(b,a,I){if(f[b]=I,b==="index"){var R="var sharedModule = {}; ("+f.shared+")(sharedModule); ("+f.worker+")(sharedModule);",$={};return f.shared($),f.index(u,$),typeof window<"u"&&u.setWorkerUrl(window.URL.createObjectURL(new Blob([R],{type:"text/javascript"}))),u}}y("shared",["exports"],function(b){function a(i,t,s,l){return new(s||(s=Promise))(function(d,g){function _(k){try{S(l.next(k))}catch(M){g(M)}}function x(k){try{S(l.throw(k))}catch(M){g(M)}}function S(k){var M;k.done?d(k.value):(M=k.value,M instanceof s?M:new s(function(E){E(M)})).then(_,x)}S((l=l.apply(i,t||[])).next())})}function I(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var R,$;function N(){if($)return R;function i(t,s){this.x=t,this.y=s}return $=1,R=i,i.prototype={clone:function(){return new i(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,s){return this.clone()._rotateAround(t,s)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var s=t.x-this.x,l=t.y-this.y;return s*s+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,s){return Math.atan2(this.x*s-this.y*t,this.x*t+this.y*s)},_matMult:function(t){var s=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=s,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var s=Math.cos(t),l=Math.sin(t),d=l*this.x+s*this.y;return this.x=s*this.x-l*this.y,this.y=d,this},_rotateAround:function(t,s){var l=Math.cos(t),d=Math.sin(t),g=s.y+d*(this.x-s.x)+l*(this.y-s.y);return this.x=s.x+l*(this.x-s.x)-d*(this.y-s.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t},R}typeof SuppressedError=="function"&&SuppressedError;var q,V,ie=I(N()),Pe=function(){if(V)return q;function i(t,s,l,d){this.cx=3*t,this.bx=3*(l-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(d-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=s,this.p2x=l,this.p2y=d}return V=1,q=i,i.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,s){if(s===void 0&&(s=1e-6),t<0)return 0;if(t>1)return 1;for(var l=t,d=0;d<8;d++){var g=this.sampleCurveX(l)-t;if(Math.abs(g)<s)return l;var _=this.sampleCurveDerivativeX(l);if(Math.abs(_)<1e-6)break;l-=g/_}var x=0,S=1;for(l=t,d=0;d<20&&(g=this.sampleCurveX(l),!(Math.abs(g-t)<s));d++)t>g?x=l:S=l,l=.5*(S-x)+x;return l},solve:function(t,s){return this.sampleCurveY(this.solveCurveX(t,s))}},q}(),Ne=I(Pe);let xe,Ge;function qe(){return xe==null&&(xe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),xe}function be(){if(Ge==null&&(Ge=!1,qe())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let l=0;l<5*5;l++){const d=4*l;t.fillStyle=`rgb(${d},${d+1},${d+2})`,t.fillRect(l%5,Math.floor(l/5),1,1)}const s=t.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&s[l]!==l){Ge=!0;break}}}return Ge||!1}var Oe,ct=1e-6,ut=typeof Float32Array<"u"?Float32Array:Array;function st(){var i=new ut(9);return ut!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function Qe(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function gt(){var i=new ut(3);return ut!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function ot(i,t,s){var l=new ut(3);return l[0]=i,l[1]=t,l[2]=s,l}function Me(i,t,s){var l=t[0],d=t[1],g=t[2],_=t[3];return i[0]=s[0]*l+s[4]*d+s[8]*g+s[12]*_,i[1]=s[1]*l+s[5]*d+s[9]*g+s[13]*_,i[2]=s[2]*l+s[6]*d+s[10]*g+s[14]*_,i[3]=s[3]*l+s[7]*d+s[11]*g+s[15]*_,i}function Fe(){var i=new ut(4);return ut!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function tt(){var i=new ut(2);return ut!=Float32Array&&(i[0]=0,i[1]=0),i}function At(i,t){var s=new ut(2);return s[0]=i,s[1]=t,s}Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)}),gt(),Oe=new ut(4),ut!=Float32Array&&(Oe[0]=0,Oe[1]=0,Oe[2]=0,Oe[3]=0),gt(),ot(1,0,0),ot(0,1,0),Fe(),Fe(),st(),tt();const ft=8192;function bt(i,t,s){return t*(ft/(i.tileSize*Math.pow(2,s-i.tileID.overscaledZ)))}function Pt(i,t){return(i%t+t)%t}function Ut(i,t,s){return i*(1-s)+t*s}function dr(i){if(i<=0)return 0;if(i>=1)return 1;const t=i*i,s=t*i;return 4*(i<.5?s:3*(i-t)+s-.75)}function ir(i,t,s,l){const d=new Ne(i,t,s,l);return g=>d.solve(g)}const Ht=ir(.25,.1,.25,1);function Mr(i,t,s){return Math.min(s,Math.max(t,i))}function zr(i,t,s){const l=s-t,d=((i-t)%l+l)%l+t;return d===t?s:d}function Cr(i,...t){for(const s of t)for(const l in s)i[l]=s[l];return i}let Kr=1;function Tn(i,t,s){const l={};for(const d in i)l[d]=t.call(this,i[d],d,i);return l}function Gn(i,t,s){const l={};for(const d in i)t.call(this,i[d],d,i)&&(l[d]=i[d]);return l}function cn(i){return Array.isArray(i)?i.map(cn):typeof i=="object"&&i?Tn(i,cn):i}const qn={};function Jr(i){qn[i]||(typeof console<"u"&&console.warn(i),qn[i]=!0)}function ae(i,t,s){return(s.y-i.y)*(t.x-i.x)>(t.y-i.y)*(s.x-i.x)}function pe(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let Ie=null;function Ke(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const We="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function He(i,t,s,l,d){return a(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const g=new VideoFrame(i,{timestamp:0});try{const _=g==null?void 0:g.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const x=_.startsWith("BGR"),S=new Uint8ClampedArray(l*d*4);if(yield g.copyTo(S,function(k,M,E,B,F){const j=4*Math.max(1,0),Z=(Math.max(0,E)-E)*B*4+j,X=4*B,ee=Math.max(0,M),de=Math.max(0,E);return{rect:{x:ee,y:de,width:Math.min(k.width,M+B)-ee,height:Math.min(k.height,E+F)-de},layout:[{offset:Z,stride:X}]}}(i,t,s,l,d)),x)for(let k=0;k<S.length;k+=4){const M=S[k];S[k]=S[k+2],S[k+2]=M}return S}finally{g.close()}})}let lt,at;function nt(i,t,s,l){return i.addEventListener(t,s,l),{unsubscribe:()=>{i.removeEventListener(t,s,l)}}}function Xe(i){return i/Math.PI*180}const It="AbortError";function ht(){return new Error(It)}const St={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Dt(i){return St.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const Ft="global-dispatcher";class Yt extends Error{constructor(t,s,l,d){super(`AJAXError: ${s} (${t}): ${l}`),this.status=t,this.statusText=s,this.url=l,this.body=d}}const Zt=()=>pe(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,jr=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const l=Dt(i.url);if(l)return l(i,t);if(pe(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:Ft},t)}if(!(/^file:/.test(s=i.url)||/^file:/.test(Zt())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,d){return a(this,void 0,void 0,function*(){const g=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:Zt(),signal:d.signal});let _,x;l.type!=="json"||g.headers.has("Accept")||g.headers.set("Accept","application/json");try{_=yield fetch(g)}catch(k){throw new Yt(0,k.message,l.url,new Blob)}if(!_.ok){const k=yield _.blob();throw new Yt(_.status,_.statusText,l.url,k)}x=l.type==="arrayBuffer"||l.type==="image"?_.arrayBuffer():l.type==="json"?_.json():_.text();const S=yield x;if(d.signal.aborted)throw ht();return{data:S,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(i,t);if(pe(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:Ft},t)}var s;return function(l,d){return new Promise((g,_)=>{var x;const S=new XMLHttpRequest;S.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(S.responseType="arraybuffer");for(const k in l.headers)S.setRequestHeader(k,l.headers[k]);l.type==="json"&&(S.responseType="text",!((x=l.headers)===null||x===void 0)&&x.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=l.credentials==="include",S.onerror=()=>{_(new Error(S.statusText))},S.onload=()=>{if(!d.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let k=S.response;if(l.type==="json")try{k=JSON.parse(S.response)}catch(M){return void _(M)}g({data:k,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const k=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});_(new Yt(S.status,S.statusText,l.url,k))}},d.signal.addEventListener("abort",()=>{S.abort(),_(ht())}),S.send(l.body)})}(i,t)};function Rr(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const t=new URL(i),s=window.location;return t.protocol===s.protocol&&t.host===s.host}function kn(i,t,s){s[i]&&s[i].indexOf(t)!==-1||(s[i]=s[i]||[],s[i].push(t))}function yn(i,t,s){if(s&&s[i]){const l=s[i].indexOf(t);l!==-1&&s[i].splice(l,1)}}class xo{constructor(t,s={}){Cr(this,s),this.type=t}}class io extends xo{constructor(t,s={}){super("error",Cr({error:t},s))}}class ge{on(t,s){return this._listeners=this._listeners||{},kn(t,s,this._listeners),{unsubscribe:()=>{this.off(t,s)}}}off(t,s){return yn(t,s,this._listeners),yn(t,s,this._oneTimeListeners),this}once(t,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},kn(t,s,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,s){typeof t=="string"&&(t=new xo(t,s||{}));const l=t.type;if(this.listens(l)){t.target=this;const d=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const x of d)x.call(this,t);const g=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const x of g)yn(l,x,this._oneTimeListeners),x.call(this,t);const _=this._eventedParent;_&&(Cr(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(t))}else t instanceof io&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,s){return this._eventedParent=t,this._eventedParentData=s,this}}var z={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const W=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Y(i,t){const s={};for(const l in i)l!=="ref"&&(s[l]=i[l]);return W.forEach(l=>{l in t&&(s[l]=t[l])}),s}function te(i,t){if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(let s=0;s<i.length;s++)if(!te(i[s],t[s]))return!1;return!0}if(typeof i=="object"&&i!==null&&t!==null){if(typeof t!="object"||Object.keys(i).length!==Object.keys(t).length)return!1;for(const s in i)if(!te(i[s],t[s]))return!1;return!0}return i===t}function ce(i,t){i.push(t)}function _e(i,t,s){ce(s,{command:"addSource",args:[i,t[i]]})}function Te(i,t,s){ce(t,{command:"removeSource",args:[i]}),s[i]=!0}function me(i,t,s,l){Te(i,s,l),_e(i,t,s)}function De(i,t,s){let l;for(l in i[s])if(Object.prototype.hasOwnProperty.call(i[s],l)&&l!=="data"&&!te(i[s][l],t[s][l]))return!1;for(l in t[s])if(Object.prototype.hasOwnProperty.call(t[s],l)&&l!=="data"&&!te(i[s][l],t[s][l]))return!1;return!0}function Ee(i,t,s,l,d,g){i=i||{},t=t||{};for(const _ in i)Object.prototype.hasOwnProperty.call(i,_)&&(te(i[_],t[_])||s.push({command:g,args:[l,_,t[_],d]}));for(const _ in t)Object.prototype.hasOwnProperty.call(t,_)&&!Object.prototype.hasOwnProperty.call(i,_)&&(te(i[_],t[_])||s.push({command:g,args:[l,_,t[_],d]}))}function ye(i){return i.id}function je(i,t){return i[t.id]=t,i}class ve{constructor(t,s,l,d){this.message=(t?`${t}: `:"")+l,d&&(this.identifier=d),s!=null&&s.__line__&&(this.line=s.__line__)}}function it(i,...t){for(const s of t)for(const l in s)i[l]=s[l];return i}class xt extends Error{constructor(t,s){super(s),this.message=s,this.key=t}}class Lt{constructor(t,s=[]){this.parent=t,this.bindings={};for(const[l,d]of s)this.bindings[l]=d}concat(t){return new Lt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const zt={kind:"null"},$e={kind:"number"},_t={kind:"string"},mt={kind:"boolean"},Ot={kind:"color"},Rt={kind:"projectionDefinition"},jt={kind:"object"},Tt={kind:"value"},wi={kind:"collator"},Wr={kind:"formatted"},Qr={kind:"padding"},br={kind:"resolvedImage"},Pa={kind:"variableAnchorOffsetCollection"};function Bn(i,t){return{kind:"array",itemType:i,N:t}}function fr(i){if(i.kind==="array"){const t=fr(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const ah=[zt,$e,_t,mt,Ot,Rt,Wr,jt,Bn(Tt),Qr,br,Pa];function Ns(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Ns(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const s of ah)if(!Ns(s,t))return null}}return`Expected ${fr(i)} but found ${fr(t)} instead.`}function Yl(i,t){return t.some(s=>s.kind===i.kind)}function ii(i,t){return t.some(s=>s==="null"?i===null:s==="array"?Array.isArray(i):s==="object"?i&&!Array.isArray(i)&&typeof i=="object":s===typeof i)}function Qi(i,t){return i.kind==="array"&&t.kind==="array"?i.itemType.kind===t.itemType.kind&&typeof i.N=="number":i.kind===t.kind}const Kl=.96422,lh=.82521,ch=4/29,es=6/29,uh=3*es*es,xf=es*es*es,wf=Math.PI/180,Cf=180/Math.PI;function Jl(i){return(i%=360)<0&&(i+=360),i}function ts([i,t,s,l]){let d,g;const _=ec((.2225045*(i=Ql(i))+.7168786*(t=Ql(t))+.0606169*(s=Ql(s)))/1);i===t&&t===s?d=g=_:(d=ec((.4360747*i+.3850649*t+.1430804*s)/Kl),g=ec((.0139322*i+.0971045*t+.7141733*s)/lh));const x=116*_-16;return[x<0?0:x,500*(d-_),200*(_-g),l]}function Ql(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function ec(i){return i>xf?Math.pow(i,1/3):i/uh+ch}function rs([i,t,s,l]){let d=(i+16)/116,g=isNaN(t)?d:d+t/500,_=isNaN(s)?d:d-s/200;return d=1*rc(d),g=Kl*rc(g),_=lh*rc(_),[tc(3.1338561*g-1.6168667*d-.4906146*_),tc(-.9787684*g+1.9161415*d+.033454*_),tc(.0719453*g-.2289914*d+1.4052427*_),l]}function tc(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function rc(i){return i>es?i*i*i:uh*(i-ch)}function Ma(i){return parseInt(i.padEnd(2,i),16)/255}function nc(i,t){return Ci(t?i/100:i,0,1)}function Ci(i,t,s){return Math.min(Math.max(t,i),s)}function wo(i){return!i.some(Number.isNaN)}const Jt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Wn(i,t,s){return i+s*(t-i)}function so(i,t,s){return i.map((l,d)=>Wn(l,t[d],s))}class Qt{constructor(t,s,l,d=1,g=!0){this.r=t,this.g=s,this.b=l,this.a=d,g||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[t,s,l,d]))}static parse(t){if(t instanceof Qt)return t;if(typeof t!="string")return;const s=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const d=Jt[l];if(d){const[_,x,S]=d;return[_/255,x/255,S/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const _=l.length<6?1:2;let x=1;return[Ma(l.slice(x,x+=_)),Ma(l.slice(x,x+=_)),Ma(l.slice(x,x+=_)),Ma(l.slice(x,x+_)||"ff")]}if(l.startsWith("rgb")){const _=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[x,S,k,M,E,B,F,j,Z,X,ee,de]=_,ne=[M||" ",F||" ",X].join("");if(ne==="  "||ne==="  /"||ne===",,"||ne===",,,"){const O=[k,B,Z].join(""),H=O==="%%%"?100:O===""?255:0;if(H){const oe=[Ci(+S/H,0,1),Ci(+E/H,0,1),Ci(+j/H,0,1),ee?nc(+ee,de):1];if(wo(oe))return oe}}return}}const g=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[_,x,S,k,M,E,B,F,j]=g,Z=[S||" ",M||" ",B].join("");if(Z==="  "||Z==="  /"||Z===",,"||Z===",,,"){const X=[+x,Ci(+k,0,100),Ci(+E,0,100),F?nc(+F,j):1];if(wo(X))return function([ee,de,ne,O]){function H(oe){const Ce=(oe+ee/30)%12,Ve=de*Math.min(ne,1-ne);return ne-Ve*Math.max(-1,Math.min(Ce-3,9-Ce,1))}return ee=Jl(ee),de/=100,ne/=100,[H(0),H(8),H(4),O]}(X)}}}(t);return s?new Qt(...s,!1):void 0}get rgb(){const{r:t,g:s,b:l,a:d}=this,g=d||1/0;return this.overwriteGetter("rgb",[t/g,s/g,l/g,d])}get hcl(){return this.overwriteGetter("hcl",function(t){const[s,l,d,g]=ts(t),_=Math.sqrt(l*l+d*d);return[Math.round(1e4*_)?Jl(Math.atan2(d,l)*Cf):NaN,_,s,g]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ts(this.rgb))}overwriteGetter(t,s){return Object.defineProperty(this,t,{value:s}),s}toString(){const[t,s,l,d]=this.rgb;return`rgba(${[t,s,l].map(g=>Math.round(255*g)).join(",")},${d})`}static interpolate(t,s,l,d="rgb"){switch(d){case"rgb":{const[g,_,x,S]=so(t.rgb,s.rgb,l);return new Qt(g,_,x,S,!1)}case"hcl":{const[g,_,x,S]=t.hcl,[k,M,E,B]=s.hcl;let F,j;if(isNaN(g)||isNaN(k))isNaN(g)?isNaN(k)?F=NaN:(F=k,x!==1&&x!==0||(j=M)):(F=g,E!==1&&E!==0||(j=_));else{let ne=k-g;k>g&&ne>180?ne-=360:k<g&&g-k>180&&(ne+=360),F=g+l*ne}const[Z,X,ee,de]=function([ne,O,H,oe]){return ne=isNaN(ne)?0:ne*wf,rs([H,Math.cos(ne)*O,Math.sin(ne)*O,oe])}([F,j??Wn(_,M,l),Wn(x,E,l),Wn(S,B,l)]);return new Qt(Z,X,ee,de,!1)}case"lab":{const[g,_,x,S]=rs(so(t.lab,s.lab,l));return new Qt(g,_,x,S,!1)}}}}Qt.black=new Qt(0,0,0,1),Qt.white=new Qt(1,1,1,1),Qt.transparent=new Qt(0,0,0,0),Qt.red=new Qt(1,0,0,1);class Ia{constructor(t,s,l){this.sensitivity=t?s?"variant":"case":s?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,s){return this.collator.compare(t,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const oc=["bottom","center","top"];class ao{constructor(t,s,l,d,g,_){this.text=t,this.image=s,this.scale=l,this.fontStack=d,this.textColor=g,this.verticalAlign=_}}class vn{constructor(t){this.sections=t}static fromString(t){return new vn([new ao(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof vn?t:vn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class un{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof un)return t;if(typeof t=="number")return new un([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const s of t)if(typeof s!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new un(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,s,l){return new un(so(t.values,s.values,l))}}class Dr{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const ic=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class hn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof hn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let s=0;s<t.length;s+=2){const l=t[s],d=t[s+1];if(typeof l!="string"||!ic.has(l)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new hn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,s,l){const d=t.values,g=s.values;if(d.length!==g.length)throw new Dr(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${s.toString()}`);const _=[];for(let x=0;x<d.length;x+=2){if(d[x]!==g[x])throw new Dr(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${d[x]}, to[${x}]: ${g[x]}`);_.push(d[x]);const[S,k]=d[x+1],[M,E]=g[x+1];_.push([Wn(S,M,l),Wn(k,E,l)])}return new hn(_)}}class zn{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new zn({name:t,available:!1}):null}}class $n{constructor(t,s,l){this.from=t,this.to=s,this.transition=l}static interpolate(t,s,l){return new $n(t,s,l)}static parse(t){return t instanceof $n?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new $n(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new $n(t.from,t.to,t.transition):typeof t=="string"?new $n(t,t,1):void 0}}function Ea(i,t,s,l){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof s=="number"&&s>=0&&s<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[i,t,s,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[i,t,s,l]:[i,t,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Co(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof $n||i instanceof Qt||i instanceof Ia||i instanceof vn||i instanceof un||i instanceof hn||i instanceof zn)return!0;if(Array.isArray(i)){for(const t of i)if(!Co(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!Co(i[t]))return!1;return!0}return!1}function Hr(i){if(i===null)return zt;if(typeof i=="string")return _t;if(typeof i=="boolean")return mt;if(typeof i=="number")return $e;if(i instanceof Qt)return Ot;if(i instanceof $n)return Rt;if(i instanceof Ia)return wi;if(i instanceof vn)return Wr;if(i instanceof un)return Qr;if(i instanceof hn)return Pa;if(i instanceof zn)return br;if(Array.isArray(i)){const t=i.length;let s;for(const l of i){const d=Hr(l);if(s){if(s===d)continue;s=Tt;break}s=d}return Bn(s||Tt,t)}return jt}function si(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof Qt||i instanceof $n||i instanceof vn||i instanceof un||i instanceof hn||i instanceof zn?i.toString():JSON.stringify(i)}class lo{constructor(t,s){this.type=t,this.value=s}static parse(t,s){if(t.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Co(t[1]))return s.error("invalid value");const l=t[1];let d=Hr(l);const g=s.expectedType;return d.kind!=="array"||d.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(d=g),new lo(d,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Vs={string:_t,number:$e,boolean:mt,object:jt};class co{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");let l,d=1;const g=t[0];if(g==="array"){let x,S;if(t.length>2){const k=t[1];if(typeof k!="string"||!(k in Vs)||k==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);x=Vs[k],d++}else x=Tt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return s.error('The length argument to "array" must be a positive integer literal',2);S=t[2],d++}l=Bn(x,S)}else{if(!Vs[g])throw new Error(`Types doesn't contain name = ${g}`);l=Vs[g]}const _=[];for(;d<t.length;d++){const x=s.parse(t[d],d,Tt);if(!x)return null;_.push(x)}return new co(l,_)}evaluate(t){for(let s=0;s<this.args.length;s++){const l=this.args[s].evaluate(t);if(!Ns(this.type,Hr(l)))return l;if(s===this.args.length-1)throw new Dr(`Expected value to be of type ${fr(this.type)}, but found ${fr(Hr(l))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const sc={"to-boolean":mt,"to-color":Ot,"to-number":$e,"to-string":_t};class So{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");const l=t[0];if(!sc[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&t.length!==2)return s.error("Expected one argument.");const d=sc[l],g=[];for(let _=1;_<t.length;_++){const x=s.parse(t[_],_,Tt);if(!x)return null;g.push(x)}return new So(d,g)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let s,l;for(const d of this.args){if(s=d.evaluate(t),l=null,s instanceof Qt)return s;if(typeof s=="string"){const g=t.parseColor(s);if(g)return g}else if(Array.isArray(s)&&(l=s.length<3||s.length>4?`Invalid rgba value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Ea(s[0],s[1],s[2],s[3]),!l))return new Qt(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Dr(l||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const l of this.args){s=l.evaluate(t);const d=un.parse(s);if(d)return d}throw new Dr(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const l of this.args){s=l.evaluate(t);const d=hn.parse(s);if(d)return d}throw new Dr(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const l of this.args){if(s=l.evaluate(t),s===null)return 0;const d=Number(s);if(!isNaN(d))return d}throw new Dr(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return vn.fromString(si(this.args[0].evaluate(t)));case"resolvedImage":return zn.fromString(si(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return si(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Sr=["Unknown","Point","LineString","Polygon"];class Aa{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Sr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let s=this._parseColorCache[t];return s||(s=this._parseColorCache[t]=Qt.parse(t)),s}}class Xt{constructor(t,s,l=[],d,g=new Lt,_=[]){this.registry=t,this.path=l,this.key=l.map(x=>`[${x}]`).join(""),this.scope=g,this.errors=_,this.expectedType=d,this._isConstant=s}parse(t,s,l,d,g={}){return s?this.concat(s,l,d)._parse(t,g):this._parse(t,g)}_parse(t,s){function l(d,g,_){return _==="assert"?new co(g,[d]):_==="coerce"?new So(g,[d]):d}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=t[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[d];if(g){let _=g.parse(t,this);if(!_)return null;if(this.expectedType){const x=this.expectedType,S=_.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||S.kind!=="value")if(x.kind!=="projectionDefinition"||S.kind!=="string"&&S.kind!=="array")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(x.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(x.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(x,S))return null}else _=l(_,x,s.typeAnnotation||"coerce");else _=l(_,x,s.typeAnnotation||"coerce");else _=l(_,x,s.typeAnnotation||"coerce");else _=l(_,x,s.typeAnnotation||"coerce");else _=l(_,x,s.typeAnnotation||"assert")}if(!(_ instanceof lo)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const x=new Aa;try{_=new lo(_.type,_.evaluate(x))}catch(S){return this.error(S.message),null}}return _}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,s,l){const d=typeof t=="number"?this.path.concat(t):this.path,g=l?this.scope.concat(l):this.scope;return new Xt(this.registry,this._isConstant,d,s||null,g,this.errors)}error(t,...s){const l=`${this.key}${s.map(d=>`[${d}]`).join("")}`;this.errors.push(new xt(l,t))}checkSubtype(t,s){const l=Ns(t,s);return l&&this.error(l),l}}class $t{constructor(t,s){this.type=s.type,this.bindings=[].concat(t),this.result=s}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const s of this.bindings)t(s[1]);t(this.result)}static parse(t,s){if(t.length<4)return s.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let g=1;g<t.length-1;g+=2){const _=t[g];if(typeof _!="string")return s.error(`Expected string, but found ${typeof _} instead.`,g);if(/[^a-zA-Z0-9_]/.test(_))return s.error("Variable names must contain only alphanumeric characters or '_'.",g);const x=s.parse(t[g+1],g+1);if(!x)return null;l.push([_,x])}const d=s.parse(t[t.length-1],t.length-1,s.expectedType,l);return d?new $t(l,d):null}outputDefined(){return this.result.outputDefined()}}class ns{constructor(t,s){this.type=s.type,this.name=t,this.boundExpression=s}static parse(t,s){if(t.length!==2||typeof t[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const l=t[1];return s.scope.has(l)?new ns(l,s.scope.get(l)):s.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Kt{constructor(t,s,l){this.type=t,this.index=s,this.input=l}static parse(t,s){if(t.length!==3)return s.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=s.parse(t[1],1,$e),d=s.parse(t[2],2,Bn(s.expectedType||Tt));return l&&d?new Kt(d.type.itemType,l,d):null}evaluate(t){const s=this.index.evaluate(t),l=this.input.evaluate(t);if(s<0)throw new Dr(`Array index out of bounds: ${s} < 0.`);if(s>=l.length)throw new Dr(`Array index out of bounds: ${s} > ${l.length-1}.`);if(s!==Math.floor(s))throw new Dr(`Array index must be an integer, but found ${s} instead.`);return l[s]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Us{constructor(t,s){this.type=mt,this.needle=t,this.haystack=s}static parse(t,s){if(t.length!==3)return s.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=s.parse(t[1],1,Tt),d=s.parse(t[2],2,Tt);return l&&d?Yl(l.type,[mt,_t,$e,zt,Tt])?new Us(l,d):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${fr(l.type)} instead`):null}evaluate(t){const s=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!l)return!1;if(!ii(s,["boolean","string","number","null"]))throw new Dr(`Expected first argument to be of type boolean, string, number or null, but found ${fr(Hr(s))} instead.`);if(!ii(l,["string","array"]))throw new Dr(`Expected second argument to be of type array or string, but found ${fr(Hr(l))} instead.`);return l.indexOf(s)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class uo{constructor(t,s,l){this.type=$e,this.needle=t,this.haystack=s,this.fromIndex=l}static parse(t,s){if(t.length<=2||t.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=s.parse(t[1],1,Tt),d=s.parse(t[2],2,Tt);if(!l||!d)return null;if(!Yl(l.type,[mt,_t,$e,zt,Tt]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${fr(l.type)} instead`);if(t.length===4){const g=s.parse(t[3],3,$e);return g?new uo(l,d,g):null}return new uo(l,d)}evaluate(t){const s=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!ii(s,["boolean","string","number","null"]))throw new Dr(`Expected first argument to be of type boolean, string, number or null, but found ${fr(Hr(s))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(t)),ii(l,["string"])){const g=l.indexOf(s,d);return g===-1?-1:[...l.slice(0,g)].length}if(ii(l,["array"]))return l.indexOf(s,d);throw new Dr(`Expected second argument to be of type array or string, but found ${fr(Hr(l))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Zs{constructor(t,s,l,d,g,_){this.inputType=t,this.type=s,this.input=l,this.cases=d,this.outputs=g,this.otherwise=_}static parse(t,s){if(t.length<5)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return s.error("Expected an even number of arguments.");let l,d;s.expectedType&&s.expectedType.kind!=="value"&&(d=s.expectedType);const g={},_=[];for(let k=2;k<t.length-1;k+=2){let M=t[k];const E=t[k+1];Array.isArray(M)||(M=[M]);const B=s.concat(k);if(M.length===0)return B.error("Expected at least one branch label.");for(const j of M){if(typeof j!="number"&&typeof j!="string")return B.error("Branch labels must be numbers or strings.");if(typeof j=="number"&&Math.abs(j)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof j=="number"&&Math.floor(j)!==j)return B.error("Numeric branch labels must be integer values.");if(l){if(B.checkSubtype(l,Hr(j)))return null}else l=Hr(j);if(g[String(j)]!==void 0)return B.error("Branch labels must be unique.");g[String(j)]=_.length}const F=s.parse(E,k,d);if(!F)return null;d=d||F.type,_.push(F)}const x=s.parse(t[1],1,Tt);if(!x)return null;const S=s.parse(t[t.length-1],t.length-1,d);return S?x.type.kind!=="value"&&s.concat(1).checkSubtype(l,x.type)?null:new Zs(l,d,x,g,_,S):null}evaluate(t){const s=this.input.evaluate(t);return(Hr(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class za{constructor(t,s,l){this.type=t,this.branches=s,this.otherwise=l}static parse(t,s){if(t.length<4)return s.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return s.error("Expected an odd number of arguments.");let l;s.expectedType&&s.expectedType.kind!=="value"&&(l=s.expectedType);const d=[];for(let _=1;_<t.length-1;_+=2){const x=s.parse(t[_],_,mt);if(!x)return null;const S=s.parse(t[_+1],_+1,l);if(!S)return null;d.push([x,S]),l=l||S.type}const g=s.parse(t[t.length-1],t.length-1,l);if(!g)return null;if(!l)throw new Error("Can't infer output type");return new za(l,d,g)}evaluate(t){for(const[s,l]of this.branches)if(s.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[s,l]of this.branches)t(s),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class Gs{constructor(t,s,l,d){this.type=t,this.input=s,this.beginIndex=l,this.endIndex=d}static parse(t,s){if(t.length<=2||t.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=s.parse(t[1],1,Tt),d=s.parse(t[2],2,$e);if(!l||!d)return null;if(!Yl(l.type,[Bn(Tt),_t,Tt]))return s.error(`Expected first argument to be of type array or string, but found ${fr(l.type)} instead`);if(t.length===4){const g=s.parse(t[3],3,$e);return g?new Gs(l.type,l,d,g):null}return new Gs(l.type,l,d)}evaluate(t){const s=this.input.evaluate(t),l=this.beginIndex.evaluate(t);let d;if(this.endIndex&&(d=this.endIndex.evaluate(t)),ii(s,["string"]))return[...s].slice(l,d).join("");if(ii(s,["array"]))return s.slice(l,d);throw new Dr(`Expected first argument to be of type array or string, but found ${fr(Hr(s))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function os(i,t){const s=i.length-1;let l,d,g=0,_=s,x=0;for(;g<=_;)if(x=Math.floor((g+_)/2),l=i[x],d=i[x+1],l<=t){if(x===s||t<d)return x;g=x+1}else{if(!(l>t))throw new Dr("Input is not a number.");_=x-1}return 0}class is{constructor(t,s,l){this.type=t,this.input=s,this.labels=[],this.outputs=[];for(const[d,g]of l)this.labels.push(d),this.outputs.push(g)}static parse(t,s){if(t.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return s.error("Expected an even number of arguments.");const l=s.parse(t[1],1,$e);if(!l)return null;const d=[];let g=null;s.expectedType&&s.expectedType.kind!=="value"&&(g=s.expectedType);for(let _=1;_<t.length;_+=2){const x=_===1?-1/0:t[_],S=t[_+1],k=_,M=_+1;if(typeof x!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(d.length&&d[d.length-1][0]>=x)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const E=s.parse(S,M,g);if(!E)return null;g=g||E.type,d.push([x,E])}return new is(g,l,d)}evaluate(t){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(t);const d=this.input.evaluate(t);if(d<=s[0])return l[0].evaluate(t);const g=s.length;return d>=s[g-1]?l[g-1].evaluate(t):l[os(s,d)].evaluate(t)}eachChild(t){t(this.input);for(const s of this.outputs)t(s)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Sf(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Ra,ac,qs=function(){if(ac)return Ra;function i(t,s,l,d){this.cx=3*t,this.bx=3*(l-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(d-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=s,this.p2x=l,this.p2y=d}return ac=1,Ra=i,i.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,s){if(s===void 0&&(s=1e-6),t<0)return 0;if(t>1)return 1;for(var l=t,d=0;d<8;d++){var g=this.sampleCurveX(l)-t;if(Math.abs(g)<s)return l;var _=this.sampleCurveDerivativeX(l);if(Math.abs(_)<1e-6)break;l-=g/_}var x=0,S=1;for(l=t,d=0;d<20&&(g=this.sampleCurveX(l),!(Math.abs(g-t)<s));d++)t>g?x=l:S=l,l=.5*(S-x)+x;return l},solve:function(t,s){return this.sampleCurveY(this.solveCurveX(t,s))}},Ra}(),Pn=Sf(qs);class Mn{constructor(t,s,l,d,g){this.type=t,this.operator=s,this.interpolation=l,this.input=d,this.labels=[],this.outputs=[];for(const[_,x]of g)this.labels.push(_),this.outputs.push(x)}static interpolationFactor(t,s,l,d){let g=0;if(t.name==="exponential")g=Da(s,t.base,l,d);else if(t.name==="linear")g=Da(s,1,l,d);else if(t.name==="cubic-bezier"){const _=t.controlPoints;g=new Pn(_[0],_[1],_[2],_[3]).solve(Da(s,1,l,d))}return g}static parse(t,s){let[l,d,g,..._]=t;if(!Array.isArray(d)||d.length===0)return s.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const k=d[1];if(typeof k!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:k}}else{if(d[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const k=d.slice(1);if(k.length!==4||k.some(M=>typeof M!="number"||M<0||M>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:k}}}if(t.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(g=s.parse(g,2,$e),!g)return null;const x=[];let S=null;l==="interpolate-hcl"||l==="interpolate-lab"?S=Ot:s.expectedType&&s.expectedType.kind!=="value"&&(S=s.expectedType);for(let k=0;k<_.length;k+=2){const M=_[k],E=_[k+1],B=k+3,F=k+4;if(typeof M!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(x.length&&x[x.length-1][0]>=M)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const j=s.parse(E,F,S);if(!j)return null;S=S||j.type,x.push([M,j])}return Qi(S,$e)||Qi(S,Rt)||Qi(S,Ot)||Qi(S,Qr)||Qi(S,Pa)||Qi(S,Bn($e))?new Mn(S,l,d,g,x):s.error(`Type ${fr(S)} is not interpolatable.`)}evaluate(t){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(t);const d=this.input.evaluate(t);if(d<=s[0])return l[0].evaluate(t);const g=s.length;if(d>=s[g-1])return l[g-1].evaluate(t);const _=os(s,d),x=Mn.interpolationFactor(this.interpolation,d,s[_],s[_+1]),S=l[_].evaluate(t),k=l[_+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Wn(S,k,x);case"color":return Qt.interpolate(S,k,x);case"padding":return un.interpolate(S,k,x);case"variableAnchorOffsetCollection":return hn.interpolate(S,k,x);case"array":return so(S,k,x);case"projectionDefinition":return $n.interpolate(S,k,x)}case"interpolate-hcl":return Qt.interpolate(S,k,x,"hcl");case"interpolate-lab":return Qt.interpolate(S,k,x,"lab")}}eachChild(t){t(this.input);for(const s of this.outputs)t(s)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Da(i,t,s,l){const d=l-s,g=i-s;return d===0?0:t===1?g/d:(Math.pow(t,g)-1)/(Math.pow(t,d)-1)}const Hn={color:Qt.interpolate,number:Wn,padding:un.interpolate,variableAnchorOffsetCollection:hn.interpolate,array:so};class Ur{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");let l=null;const d=s.expectedType;d&&d.kind!=="value"&&(l=d);const g=[];for(const x of t.slice(1)){const S=s.parse(x,1+g.length,l,void 0,{typeAnnotation:"omit"});if(!S)return null;l=l||S.type,g.push(S)}if(!l)throw new Error("No output type");const _=d&&g.some(x=>Ns(d,x.type));return new Ur(_?Tt:l,g)}evaluate(t){let s,l=null,d=0;for(const g of this.args)if(d++,l=g.evaluate(t),l&&l instanceof zn&&!l.available&&(s||(s=l.name),l=null,d===this.args.length&&(l=s)),l!==null)break;return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function lc(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function La(i,t,s,l){return l.compare(t,s)===0}function Si(i,t,s){const l=i!=="=="&&i!=="!=";return class fb{constructor(g,_,x){this.type=mt,this.lhs=g,this.rhs=_,this.collator=x,this.hasUntypedArgument=g.type.kind==="value"||_.type.kind==="value"}static parse(g,_){if(g.length!==3&&g.length!==4)return _.error("Expected two or three arguments.");const x=g[0];let S=_.parse(g[1],1,Tt);if(!S)return null;if(!lc(x,S.type))return _.concat(1).error(`"${x}" comparisons are not supported for type '${fr(S.type)}'.`);let k=_.parse(g[2],2,Tt);if(!k)return null;if(!lc(x,k.type))return _.concat(2).error(`"${x}" comparisons are not supported for type '${fr(k.type)}'.`);if(S.type.kind!==k.type.kind&&S.type.kind!=="value"&&k.type.kind!=="value")return _.error(`Cannot compare types '${fr(S.type)}' and '${fr(k.type)}'.`);l&&(S.type.kind==="value"&&k.type.kind!=="value"?S=new co(k.type,[S]):S.type.kind!=="value"&&k.type.kind==="value"&&(k=new co(S.type,[k])));let M=null;if(g.length===4){if(S.type.kind!=="string"&&k.type.kind!=="string"&&S.type.kind!=="value"&&k.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(M=_.parse(g[3],3,wi),!M)return null}return new fb(S,k,M)}evaluate(g){const _=this.lhs.evaluate(g),x=this.rhs.evaluate(g);if(l&&this.hasUntypedArgument){const S=Hr(_),k=Hr(x);if(S.kind!==k.kind||S.kind!=="string"&&S.kind!=="number")throw new Dr(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${S.kind}, ${k.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const S=Hr(_),k=Hr(x);if(S.kind!=="string"||k.kind!=="string")return t(g,_,x)}return this.collator?s(g,_,x,this.collator.evaluate(g)):t(g,_,x)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}}}const Tf=Si("==",function(i,t,s){return t===s},La),Ba=Si("!=",function(i,t,s){return t!==s},function(i,t,s,l){return!La(0,t,s,l)}),cc=Si("<",function(i,t,s){return t<s},function(i,t,s,l){return l.compare(t,s)<0}),kf=Si(">",function(i,t,s){return t>s},function(i,t,s,l){return l.compare(t,s)>0}),$a=Si("<=",function(i,t,s){return t<=s},function(i,t,s,l){return l.compare(t,s)<=0}),Oa=Si(">=",function(i,t,s){return t>=s},function(i,t,s,l){return l.compare(t,s)>=0});class On{constructor(t,s,l){this.type=wi,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=s}static parse(t,s){if(t.length!==2)return s.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return s.error("Collator options argument must be an object.");const d=s.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,mt);if(!d)return null;const g=s.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,mt);if(!g)return null;let _=null;return l.locale&&(_=s.parse(l.locale,1,_t),!_)?null:new On(d,g,_)}evaluate(t){return new Ia(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Fa{constructor(t,s,l,d,g){this.type=_t,this.number=t,this.locale=s,this.currency=l,this.minFractionDigits=d,this.maxFractionDigits=g}static parse(t,s){if(t.length!==3)return s.error("Expected two arguments.");const l=s.parse(t[1],1,$e);if(!l)return null;const d=t[2];if(typeof d!="object"||Array.isArray(d))return s.error("NumberFormat options argument must be an object.");let g=null;if(d.locale&&(g=s.parse(d.locale,1,_t),!g))return null;let _=null;if(d.currency&&(_=s.parse(d.currency,1,_t),!_))return null;let x=null;if(d["min-fraction-digits"]&&(x=s.parse(d["min-fraction-digits"],1,$e),!x))return null;let S=null;return d["max-fraction-digits"]&&(S=s.parse(d["max-fraction-digits"],1,$e),!S)?null:new Fa(l,g,_,x,S)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Ti{constructor(t){this.type=Wr,this.sections=t}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return s.error("First argument must be an image or text section.");const d=[];let g=!1;for(let _=1;_<=t.length-1;++_){const x=t[_];if(g&&typeof x=="object"&&!Array.isArray(x)){g=!1;let S=null;if(x["font-scale"]&&(S=s.parse(x["font-scale"],1,$e),!S))return null;let k=null;if(x["text-font"]&&(k=s.parse(x["text-font"],1,Bn(_t)),!k))return null;let M=null;if(x["text-color"]&&(M=s.parse(x["text-color"],1,Ot),!M))return null;let E=null;if(x["vertical-align"]){if(typeof x["vertical-align"]=="string"&&!oc.includes(x["vertical-align"]))return s.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${x["vertical-align"]}' instead.`);if(E=s.parse(x["vertical-align"],1,_t),!E)return null}const B=d[d.length-1];B.scale=S,B.font=k,B.textColor=M,B.verticalAlign=E}else{const S=s.parse(t[_],1,Tt);if(!S)return null;const k=S.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,d.push({content:S,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Ti(d)}evaluate(t){return new vn(this.sections.map(s=>{const l=s.content.evaluate(t);return Hr(l)===br?new ao("",l,null,null,null,s.verticalAlign?s.verticalAlign.evaluate(t):null):new ao(si(l),null,s.scale?s.scale.evaluate(t):null,s.font?s.font.evaluate(t).join(","):null,s.textColor?s.textColor.evaluate(t):null,s.verticalAlign?s.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const s of this.sections)t(s.content),s.scale&&t(s.scale),s.font&&t(s.font),s.textColor&&t(s.textColor),s.verticalAlign&&t(s.verticalAlign)}outputDefined(){return!1}}class uc{constructor(t){this.type=br,this.input=t}static parse(t,s){if(t.length!==2)return s.error("Expected two arguments.");const l=s.parse(t[1],1,_t);return l?new uc(l):s.error("No image name provided.")}evaluate(t){const s=this.input.evaluate(t),l=zn.fromString(s);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(s)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}}class Ws{constructor(t){this.type=$e,this.input=t}static parse(t,s){if(t.length!==2)return s.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=s.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${fr(l.type)} instead.`):new Ws(l):null}evaluate(t){const s=this.input.evaluate(t);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new Dr(`Expected value to be of type string or array, but found ${fr(Hr(s))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const zo=8192;function Pf(i,t){const s=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(s*d*zo),Math.round(l*d*zo)]}function hc(i,t){const s=Math.pow(2,t.z);return[(d=(i[0]/zo+t.x)/s,360*d-180),(l=(i[1]/zo+t.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,d}function Hs(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function ai(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function Mf(i,t,s){const l=i[0]-t[0],d=i[1]-t[1],g=i[0]-s[0],_=i[1]-s[1];return l*_-g*d==0&&l*g<=0&&d*_<=0}function Xs(i,t,s,l){return(d=[l[0]-s[0],l[1]-s[1]])[0]*(g=[t[0]-i[0],t[1]-i[1]])[1]-d[1]*g[0]!=0&&!(!ph(i,t,s,l)||!ph(s,l,i,t));var d,g}function hh(i,t,s){for(const l of s)for(let d=0;d<l.length-1;++d)if(Xs(i,t,l[d],l[d+1]))return!0;return!1}function ss(i,t,s=!1){let l=!1;for(const x of t)for(let S=0;S<x.length-1;S++){if(Mf(i,x[S],x[S+1]))return s;(g=x[S])[1]>(d=i)[1]!=(_=x[S+1])[1]>d[1]&&d[0]<(_[0]-g[0])*(d[1]-g[1])/(_[1]-g[1])+g[0]&&(l=!l)}var d,g,_;return l}function dh(i,t){for(const s of t)if(ss(i,s))return!0;return!1}function fh(i,t){for(const s of i)if(!ss(s,t))return!1;for(let s=0;s<i.length-1;++s)if(hh(i[s],i[s+1],t))return!1;return!0}function If(i,t){for(const s of t)if(fh(i,s))return!0;return!1}function ph(i,t,s,l){const d=l[0]-s[0],g=l[1]-s[1],_=(i[0]-s[0])*g-d*(i[1]-s[1]),x=(t[0]-s[0])*g-d*(t[1]-s[1]);return _>0&&x<0||_<0&&x>0}function dc(i,t,s){const l=[];for(let d=0;d<i.length;d++){const g=[];for(let _=0;_<i[d].length;_++){const x=Pf(i[d][_],s);Hs(t,x),g.push(x)}l.push(g)}return l}function mh(i,t,s){const l=[];for(let d=0;d<i.length;d++){const g=dc(i[d],t,s);l.push(g)}return l}function fc(i,t,s,l){if(i[0]<s[0]||i[0]>s[2]){const d=.5*l;let g=i[0]-s[0]>d?-l:s[0]-i[0]>d?l:0;g===0&&(g=i[0]-s[2]>d?-l:s[2]-i[0]>d?l:0),i[0]+=g}Hs(t,i)}function pc(i,t,s,l){const d=Math.pow(2,l.z)*zo,g=[l.x*zo,l.y*zo],_=[];for(const x of i)for(const S of x){const k=[S.x+g[0],S.y+g[1]];fc(k,t,s,d),_.push(k)}return _}function mc(i,t,s,l){const d=Math.pow(2,l.z)*zo,g=[l.x*zo,l.y*zo],_=[];for(const S of i){const k=[];for(const M of S){const E=[M.x+g[0],M.y+g[1]];Hs(t,E),k.push(E)}_.push(k)}if(t[2]-t[0]<=d/2){(x=t)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const S of _)for(const k of S)fc(k,t,s,d)}var x;return _}class ki{constructor(t,s){this.type=mt,this.geojson=t,this.geometries=s}static parse(t,s){if(t.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Co(t[1])){const l=t[1];if(l.type==="FeatureCollection"){const d=[];for(const g of l.features){const{type:_,coordinates:x}=g.geometry;_==="Polygon"&&d.push(x),_==="MultiPolygon"&&d.push(...x)}if(d.length)return new ki(l,{type:"MultiPolygon",coordinates:d})}else if(l.type==="Feature"){const d=l.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new ki(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new ki(l,l)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(s,l){const d=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(l.type==="Polygon"){const x=dc(l.coordinates,g,_),S=pc(s.geometry(),d,g,_);if(!ai(d,g))return!1;for(const k of S)if(!ss(k,x))return!1}if(l.type==="MultiPolygon"){const x=mh(l.coordinates,g,_),S=pc(s.geometry(),d,g,_);if(!ai(d,g))return!1;for(const k of S)if(!dh(k,x))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(s,l){const d=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(l.type==="Polygon"){const x=dc(l.coordinates,g,_),S=mc(s.geometry(),d,g,_);if(!ai(d,g))return!1;for(const k of S)if(!fh(k,x))return!1}if(l.type==="MultiPolygon"){const x=mh(l.coordinates,g,_),S=mc(s.geometry(),d,g,_);if(!ai(d,g))return!1;for(const k of S)if(!If(k,x))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let gh=class{constructor(i=[],t=(s,l)=>s<l?-1:s>l?1:0){if(this.data=i,this.length=this.data.length,this.compare=t,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:t,compare:s}=this,l=t[i];for(;i>0;){const d=i-1>>1,g=t[d];if(s(l,g)>=0)break;t[i]=g,i=d}t[i]=l}_down(i){const{data:t,compare:s}=this,l=this.length>>1,d=t[i];for(;i<l;){let g=1+(i<<1);const _=g+1;if(_<this.length&&s(t[_],t[g])<0&&(g=_),s(t[g],d)>=0)break;t[i]=t[g],i=g}t[i]=d}};function _h(i,t,s=0,l=i.length-1,d=Ef){for(;l>s;){if(l-s>600){const S=l-s+1,k=t-s+1,M=Math.log(S),E=.5*Math.exp(2*M/3),B=.5*Math.sqrt(M*E*(S-E)/S)*(k-S/2<0?-1:1);_h(i,t,Math.max(s,Math.floor(t-k*E/S+B)),Math.min(l,Math.floor(t+(S-k)*E/S+B)),d)}const g=i[t];let _=s,x=l;for(Pi(i,s,t),d(i[l],g)>0&&Pi(i,s,l);_<x;){for(Pi(i,_,x),_++,x--;d(i[_],g)<0;)_++;for(;d(i[x],g)>0;)x--}d(i[s],g)===0?Pi(i,s,x):(x++,Pi(i,x,l)),x<=t&&(s=x+1),t<=x&&(l=x-1)}}function Pi(i,t,s){const l=i[t];i[t]=i[s],i[s]=l}function Ef(i,t){return i<t?-1:i>t?1:0}function ja(i,t){if(i.length<=1)return[i];const s=[];let l,d;for(const g of i){const _=yh(g);_!==0&&(g.area=Math.abs(_),d===void 0&&(d=_<0),d===_<0?(l&&s.push(l),l=[g]):l.push(g))}if(l&&s.push(l),t>1)for(let g=0;g<s.length;g++)s[g].length<=t||(_h(s[g],t,1,s[g].length-1,Af),s[g]=s[g].slice(0,t));return s}function Af(i,t){return t.area-i.area}function yh(i){let t=0;for(let s,l,d=0,g=i.length,_=g-1;d<g;_=d++)s=i[d],l=i[_],t+=(l.x-s.x)*(s.y+l.y);return t}const gc=1/298.257223563,vh=gc*(2-gc),bh=Math.PI/180;class Na{constructor(t){const s=6378.137*bh*1e3,l=Math.cos(t*bh),d=1/(1-vh*(1-l*l)),g=Math.sqrt(d);this.kx=s*g*l,this.ky=s*g*d*(1-vh)}distance(t,s){const l=this.wrap(t[0]-s[0])*this.kx,d=(t[1]-s[1])*this.ky;return Math.sqrt(l*l+d*d)}pointOnLine(t,s){let l,d,g,_,x=1/0;for(let S=0;S<t.length-1;S++){let k=t[S][0],M=t[S][1],E=this.wrap(t[S+1][0]-k)*this.kx,B=(t[S+1][1]-M)*this.ky,F=0;E===0&&B===0||(F=(this.wrap(s[0]-k)*this.kx*E+(s[1]-M)*this.ky*B)/(E*E+B*B),F>1?(k=t[S+1][0],M=t[S+1][1]):F>0&&(k+=E/this.kx*F,M+=B/this.ky*F)),E=this.wrap(s[0]-k)*this.kx,B=(s[1]-M)*this.ky;const j=E*E+B*B;j<x&&(x=j,l=k,d=M,g=S,_=F)}return{point:[l,d],index:g,t:Math.max(0,Math.min(1,_))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function _c(i,t){return t[0]-i[0]}function Va(i){return i[1]-i[0]+1}function qo(i,t){return i[1]>=i[0]&&i[1]<t}function yc(i,t){if(i[0]>i[1])return[null,null];const s=Va(i);if(t){if(s===2)return[i,null];const d=Math.floor(s/2);return[[i[0],i[0]+d],[i[0]+d,i[1]]]}if(s===1)return[i,null];const l=Math.floor(s/2)-1;return[[i[0],i[0]+l],[i[0]+l+1,i[1]]]}function Ua(i,t){if(!qo(t,i.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let l=t[0];l<=t[1];++l)Hs(s,i[l]);return s}function vc(i){const t=[1/0,1/0,-1/0,-1/0];for(const s of i)for(const l of s)Hs(t,l);return t}function xh(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function bc(i,t,s){if(!xh(i)||!xh(t))return NaN;let l=0,d=0;return i[2]<t[0]&&(l=t[0]-i[2]),i[0]>t[2]&&(l=i[0]-t[2]),i[1]>t[3]&&(d=i[1]-t[3]),i[3]<t[1]&&(d=t[1]-i[3]),s.distance([0,0],[l,d])}function Mi(i,t,s){const l=s.pointOnLine(t,i);return s.distance(i,l.point)}function tr(i,t,s,l,d){const g=Math.min(Mi(i,[s,l],d),Mi(t,[s,l],d)),_=Math.min(Mi(s,[i,t],d),Mi(l,[i,t],d));return Math.min(g,_)}function zf(i,t,s,l,d){if(!qo(t,i.length)||!qo(l,s.length))return 1/0;let g=1/0;for(let _=t[0];_<t[1];++_){const x=i[_],S=i[_+1];for(let k=l[0];k<l[1];++k){const M=s[k],E=s[k+1];if(Xs(x,S,M,E))return 0;g=Math.min(g,tr(x,S,M,E,d))}}return g}function Rf(i,t,s,l,d){if(!qo(t,i.length)||!qo(l,s.length))return NaN;let g=1/0;for(let _=t[0];_<=t[1];++_)for(let x=l[0];x<=l[1];++x)if(g=Math.min(g,d.distance(i[_],s[x])),g===0)return g;return g}function Df(i,t,s){if(ss(i,t,!0))return 0;let l=1/0;for(const d of t){const g=d[0],_=d[d.length-1];if(g!==_&&(l=Math.min(l,Mi(i,[_,g],s)),l===0))return l;const x=s.pointOnLine(d,i);if(l=Math.min(l,s.distance(i,x.point)),l===0)return l}return l}function Lf(i,t,s,l){if(!qo(t,i.length))return NaN;for(let g=t[0];g<=t[1];++g)if(ss(i[g],s,!0))return 0;let d=1/0;for(let g=t[0];g<t[1];++g){const _=i[g],x=i[g+1];for(const S of s)for(let k=0,M=S.length,E=M-1;k<M;E=k++){const B=S[E],F=S[k];if(Xs(_,x,B,F))return 0;d=Math.min(d,tr(_,x,B,F,l))}}return d}function wh(i,t){for(const s of i)for(const l of s)if(ss(l,t,!0))return!0;return!1}function Bf(i,t,s,l=1/0){const d=vc(i),g=vc(t);if(l!==1/0&&bc(d,g,s)>=l)return l;if(ai(d,g)){if(wh(i,t))return 0}else if(wh(t,i))return 0;let _=1/0;for(const x of i)for(let S=0,k=x.length,M=k-1;S<k;M=S++){const E=x[M],B=x[S];for(const F of t)for(let j=0,Z=F.length,X=Z-1;j<Z;X=j++){const ee=F[X],de=F[j];if(Xs(E,B,ee,de))return 0;_=Math.min(_,tr(E,B,ee,de,s))}}return _}function Ch(i,t,s,l,d,g){if(!g)return;const _=bc(Ua(l,g),d,s);_<t&&i.push([_,g,[0,0]])}function Za(i,t,s,l,d,g,_){if(!g||!_)return;const x=bc(Ua(l,g),Ua(d,_),s);x<t&&i.push([x,g,_])}function Ga(i,t,s,l,d=1/0){let g=Math.min(l.distance(i[0],s[0][0]),d);if(g===0)return g;const _=new gh([[0,[0,i.length-1],[0,0]]],_c),x=vc(s);for(;_.length>0;){const S=_.pop();if(S[0]>=g)continue;const k=S[1],M=t?50:100;if(Va(k)<=M){if(!qo(k,i.length))return NaN;if(t){const E=Lf(i,k,s,l);if(isNaN(E)||E===0)return E;g=Math.min(g,E)}else for(let E=k[0];E<=k[1];++E){const B=Df(i[E],s,l);if(g=Math.min(g,B),g===0)return 0}}else{const E=yc(k,t);Ch(_,g,l,i,x,E[0]),Ch(_,g,l,i,x,E[1])}}return g}function qa(i,t,s,l,d,g=1/0){let _=Math.min(g,d.distance(i[0],s[0]));if(_===0)return _;const x=new gh([[0,[0,i.length-1],[0,s.length-1]]],_c);for(;x.length>0;){const S=x.pop();if(S[0]>=_)continue;const k=S[1],M=S[2],E=t?50:100,B=l?50:100;if(Va(k)<=E&&Va(M)<=B){if(!qo(k,i.length)&&qo(M,s.length))return NaN;let F;if(t&&l)F=zf(i,k,s,M,d),_=Math.min(_,F);else if(t&&!l){const j=i.slice(k[0],k[1]+1);for(let Z=M[0];Z<=M[1];++Z)if(F=Mi(s[Z],j,d),_=Math.min(_,F),_===0)return _}else if(!t&&l){const j=s.slice(M[0],M[1]+1);for(let Z=k[0];Z<=k[1];++Z)if(F=Mi(i[Z],j,d),_=Math.min(_,F),_===0)return _}else F=Rf(i,k,s,M,d),_=Math.min(_,F)}else{const F=yc(k,t),j=yc(M,l);Za(x,_,d,i,s,F[0],j[0]),Za(x,_,d,i,s,F[0],j[1]),Za(x,_,d,i,s,F[1],j[0]),Za(x,_,d,i,s,F[1],j[1])}}return _}function xc(i){return i.type==="MultiPolygon"?i.coordinates.map(t=>({type:"Polygon",coordinates:t})):i.type==="MultiLineString"?i.coordinates.map(t=>({type:"LineString",coordinates:t})):i.type==="MultiPoint"?i.coordinates.map(t=>({type:"Point",coordinates:t})):[i]}class Ii{constructor(t,s){this.type=$e,this.geojson=t,this.geometries=s}static parse(t,s){if(t.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Co(t[1])){const l=t[1];if(l.type==="FeatureCollection")return new Ii(l,l.features.map(d=>xc(d.geometry)).flat());if(l.type==="Feature")return new Ii(l,xc(l.geometry));if("type"in l&&"coordinates"in l)return new Ii(l,xc(l))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(s,l){const d=s.geometry(),g=d.flat().map(S=>hc([S.x,S.y],s.canonical));if(d.length===0)return NaN;const _=new Na(g[0][1]);let x=1/0;for(const S of l){switch(S.type){case"Point":x=Math.min(x,qa(g,!1,[S.coordinates],!1,_,x));break;case"LineString":x=Math.min(x,qa(g,!1,S.coordinates,!0,_,x));break;case"Polygon":x=Math.min(x,Ga(g,!1,S.coordinates,_,x))}if(x===0)return x}return x}(t,this.geometries);if(t.geometryType()==="LineString")return function(s,l){const d=s.geometry(),g=d.flat().map(S=>hc([S.x,S.y],s.canonical));if(d.length===0)return NaN;const _=new Na(g[0][1]);let x=1/0;for(const S of l){switch(S.type){case"Point":x=Math.min(x,qa(g,!0,[S.coordinates],!1,_,x));break;case"LineString":x=Math.min(x,qa(g,!0,S.coordinates,!0,_,x));break;case"Polygon":x=Math.min(x,Ga(g,!0,S.coordinates,_,x))}if(x===0)return x}return x}(t,this.geometries);if(t.geometryType()==="Polygon")return function(s,l){const d=s.geometry();if(d.length===0||d[0].length===0)return NaN;const g=ja(d,0).map(S=>S.map(k=>k.map(M=>hc([M.x,M.y],s.canonical)))),_=new Na(g[0][0][0][1]);let x=1/0;for(const S of l)for(const k of g){switch(S.type){case"Point":x=Math.min(x,Ga([S.coordinates],!1,k,_,x));break;case"LineString":x=Math.min(x,Ga(S.coordinates,!0,k,_,x));break;case"Polygon":x=Math.min(x,Bf(k,S.coordinates,_,x))}if(x===0)return x}return x}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const as={"==":Tf,"!=":Ba,">":kf,"<":cc,">=":Oa,"<=":$a,array:co,at:Kt,boolean:co,case:za,coalesce:Ur,collator:On,format:Ti,image:uc,in:Us,"index-of":uo,interpolate:Mn,"interpolate-hcl":Mn,"interpolate-lab":Mn,length:Ws,let:$t,literal:lo,match:Zs,number:co,"number-format":Fa,object:co,slice:Gs,step:is,string:co,"to-boolean":So,"to-color":So,"to-number":So,"to-string":So,var:ns,within:ki,distance:Ii};class ho{constructor(t,s,l,d){this.name=t,this.type=s,this._evaluate=l,this.args=d}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,s){const l=t[0],d=ho.definitions[l];if(!d)return s.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(d)?d[0]:d.type,_=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,x=_.filter(([k])=>!Array.isArray(k)||k.length===t.length-1);let S=null;for(const[k,M]of x){S=new Xt(s.registry,Wa,s.path,null,s.scope);const E=[];let B=!1;for(let F=1;F<t.length;F++){const j=t[F],Z=Array.isArray(k)?k[F-1]:k.type,X=S.parse(j,1+E.length,Z);if(!X){B=!0;break}E.push(X)}if(!B)if(Array.isArray(k)&&k.length!==E.length)S.error(`Expected ${k.length} arguments, but found ${E.length} instead.`);else{for(let F=0;F<E.length;F++){const j=Array.isArray(k)?k[F]:k.type,Z=E[F];S.concat(F+1).checkSubtype(j,Z.type)}if(S.errors.length===0)return new ho(l,g,M,E)}}if(x.length===1)s.errors.push(...S.errors);else{const k=(x.length?x:_).map(([E])=>{return B=E,Array.isArray(B)?`(${B.map(fr).join(", ")})`:`(${fr(B.type)}...)`;var B}).join(" | "),M=[];for(let E=1;E<t.length;E++){const B=s.parse(t[E],1+M.length);if(!B)return null;M.push(fr(B.type))}s.error(`Expected arguments of type ${k}, but found (${M.join(", ")}) instead.`)}return null}static register(t,s){ho.definitions=s;for(const l in s)t[l]=ho}}function Sh(i,[t,s,l,d]){t=t.evaluate(i),s=s.evaluate(i),l=l.evaluate(i);const g=d?d.evaluate(i):1,_=Ea(t,s,l,g);if(_)throw new Dr(_);return new Qt(t/255,s/255,l/255,g,!1)}function Th(i,t){return i in t}function wc(i,t){const s=t[i];return s===void 0?null:s}function Ei(i){return{type:i}}function Wa(i){if(i instanceof ns)return Wa(i.boundExpression);if(i instanceof ho&&i.name==="error"||i instanceof On||i instanceof ki||i instanceof Ii)return!1;const t=i instanceof So||i instanceof co;let s=!0;return i.eachChild(l=>{s=t?s&&Wa(l):s&&l instanceof lo}),!!s&&Ha(i)&&Xa(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ha(i){if(i instanceof ho&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof ki||i instanceof Ii)return!1;let t=!0;return i.eachChild(s=>{t&&!Ha(s)&&(t=!1)}),t}function Ys(i){if(i instanceof ho&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(s=>{t&&!Ys(s)&&(t=!1)}),t}function Xa(i,t){if(i instanceof ho&&t.indexOf(i.name)>=0)return!1;let s=!0;return i.eachChild(l=>{s&&!Xa(l,t)&&(s=!1)}),s}function kh(i){return{result:"success",value:i}}function ls(i){return{result:"error",value:i}}function cs(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function Ph(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Cc(i){return!!i.expression&&i.expression.interpolated}function er(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Ya(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function $f(i){return i}function Mh(i,t){const s=t.type==="color",l=i.stops&&typeof i.stops[0][0]=="object",d=l||!(l||i.property!==void 0),g=i.type||(Cc(t)?"exponential":"interval");if(s||t.type==="padding"){const M=s?Qt.parse:un.parse;(i=it({},i)).stops&&(i.stops=i.stops.map(E=>[E[0],M(E[1])])),i.default=M(i.default?i.default:t.default)}if(i.colorSpace&&(_=i.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var _;let x,S,k;if(g==="exponential")x=Ih;else if(g==="interval")x=Ff;else if(g==="categorical"){x=Of,S=Object.create(null);for(const M of i.stops)S[M[0]]=M[1];k=typeof i.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);x=Eh}if(l){const M={},E=[];for(let j=0;j<i.stops.length;j++){const Z=i.stops[j],X=Z[0].zoom;M[X]===void 0&&(M[X]={zoom:X,type:i.type,property:i.property,default:i.default,stops:[]},E.push(X)),M[X].stops.push([Z[0].value,Z[1]])}const B=[];for(const j of E)B.push([M[j].zoom,Mh(M[j],t)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:Mn.interpolationFactor.bind(void 0,F),zoomStops:B.map(j=>j[0]),evaluate:({zoom:j},Z)=>Ih({stops:B,base:i.base},t,j).evaluate(j,Z)}}if(d){const M=g==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Mn.interpolationFactor.bind(void 0,M),zoomStops:i.stops.map(E=>E[0]),evaluate:({zoom:E})=>x(i,t,E,S,k)}}return{kind:"source",evaluate(M,E){const B=E&&E.properties?E.properties[i.property]:void 0;return B===void 0?Ai(i.default,t.default):x(i,t,B,S,k)}}}function Ai(i,t,s){return i!==void 0?i:t!==void 0?t:s!==void 0?s:void 0}function Of(i,t,s,l,d){return Ai(typeof s===d?l[s]:void 0,i.default,t.default)}function Ff(i,t,s){if(er(s)!=="number")return Ai(i.default,t.default);const l=i.stops.length;if(l===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[l-1][0])return i.stops[l-1][1];const d=os(i.stops.map(g=>g[0]),s);return i.stops[d][1]}function Ih(i,t,s){const l=i.base!==void 0?i.base:1;if(er(s)!=="number")return Ai(i.default,t.default);const d=i.stops.length;if(d===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[d-1][0])return i.stops[d-1][1];const g=os(i.stops.map(M=>M[0]),s),_=function(M,E,B,F){const j=F-B,Z=M-B;return j===0?0:E===1?Z/j:(Math.pow(E,Z)-1)/(Math.pow(E,j)-1)}(s,l,i.stops[g][0],i.stops[g+1][0]),x=i.stops[g][1],S=i.stops[g+1][1],k=Hn[t.type]||$f;return typeof x.evaluate=="function"?{evaluate(...M){const E=x.evaluate.apply(void 0,M),B=S.evaluate.apply(void 0,M);if(E!==void 0&&B!==void 0)return k(E,B,_,i.colorSpace)}}:k(x,S,_,i.colorSpace)}function Eh(i,t,s){switch(t.type){case"color":s=Qt.parse(s);break;case"formatted":s=vn.fromString(s.toString());break;case"resolvedImage":s=zn.fromString(s.toString());break;case"padding":s=un.parse(s);break;default:er(s)===t.type||t.type==="enum"&&t.values[s]||(s=void 0)}return Ai(s,i.default,t.default)}ho.register(as,{error:[{kind:"error"},[_t],(i,[t])=>{throw new Dr(t.evaluate(i))}],typeof:[_t,[Tt],(i,[t])=>fr(Hr(t.evaluate(i)))],"to-rgba":[Bn($e,4),[Ot],(i,[t])=>{const[s,l,d,g]=t.evaluate(i).rgb;return[255*s,255*l,255*d,g]}],rgb:[Ot,[$e,$e,$e],Sh],rgba:[Ot,[$e,$e,$e,$e],Sh],has:{type:mt,overloads:[[[_t],(i,[t])=>Th(t.evaluate(i),i.properties())],[[_t,jt],(i,[t,s])=>Th(t.evaluate(i),s.evaluate(i))]]},get:{type:Tt,overloads:[[[_t],(i,[t])=>wc(t.evaluate(i),i.properties())],[[_t,jt],(i,[t,s])=>wc(t.evaluate(i),s.evaluate(i))]]},"feature-state":[Tt,[_t],(i,[t])=>wc(t.evaluate(i),i.featureState||{})],properties:[jt,[],i=>i.properties()],"geometry-type":[_t,[],i=>i.geometryType()],id:[Tt,[],i=>i.id()],zoom:[$e,[],i=>i.globals.zoom],"heatmap-density":[$e,[],i=>i.globals.heatmapDensity||0],"line-progress":[$e,[],i=>i.globals.lineProgress||0],accumulated:[Tt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[$e,Ei($e),(i,t)=>{let s=0;for(const l of t)s+=l.evaluate(i);return s}],"*":[$e,Ei($e),(i,t)=>{let s=1;for(const l of t)s*=l.evaluate(i);return s}],"-":{type:$e,overloads:[[[$e,$e],(i,[t,s])=>t.evaluate(i)-s.evaluate(i)],[[$e],(i,[t])=>-t.evaluate(i)]]},"/":[$e,[$e,$e],(i,[t,s])=>t.evaluate(i)/s.evaluate(i)],"%":[$e,[$e,$e],(i,[t,s])=>t.evaluate(i)%s.evaluate(i)],ln2:[$e,[],()=>Math.LN2],pi:[$e,[],()=>Math.PI],e:[$e,[],()=>Math.E],"^":[$e,[$e,$e],(i,[t,s])=>Math.pow(t.evaluate(i),s.evaluate(i))],sqrt:[$e,[$e],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[$e,[$e],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[$e,[$e],(i,[t])=>Math.log(t.evaluate(i))],log2:[$e,[$e],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[$e,[$e],(i,[t])=>Math.sin(t.evaluate(i))],cos:[$e,[$e],(i,[t])=>Math.cos(t.evaluate(i))],tan:[$e,[$e],(i,[t])=>Math.tan(t.evaluate(i))],asin:[$e,[$e],(i,[t])=>Math.asin(t.evaluate(i))],acos:[$e,[$e],(i,[t])=>Math.acos(t.evaluate(i))],atan:[$e,[$e],(i,[t])=>Math.atan(t.evaluate(i))],min:[$e,Ei($e),(i,t)=>Math.min(...t.map(s=>s.evaluate(i)))],max:[$e,Ei($e),(i,t)=>Math.max(...t.map(s=>s.evaluate(i)))],abs:[$e,[$e],(i,[t])=>Math.abs(t.evaluate(i))],round:[$e,[$e],(i,[t])=>{const s=t.evaluate(i);return s<0?-Math.round(-s):Math.round(s)}],floor:[$e,[$e],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[$e,[$e],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[mt,[_t,Tt],(i,[t,s])=>i.properties()[t.value]===s.value],"filter-id-==":[mt,[Tt],(i,[t])=>i.id()===t.value],"filter-type-==":[mt,[_t],(i,[t])=>i.geometryType()===t.value],"filter-<":[mt,[_t,Tt],(i,[t,s])=>{const l=i.properties()[t.value],d=s.value;return typeof l==typeof d&&l<d}],"filter-id-<":[mt,[Tt],(i,[t])=>{const s=i.id(),l=t.value;return typeof s==typeof l&&s<l}],"filter->":[mt,[_t,Tt],(i,[t,s])=>{const l=i.properties()[t.value],d=s.value;return typeof l==typeof d&&l>d}],"filter-id->":[mt,[Tt],(i,[t])=>{const s=i.id(),l=t.value;return typeof s==typeof l&&s>l}],"filter-<=":[mt,[_t,Tt],(i,[t,s])=>{const l=i.properties()[t.value],d=s.value;return typeof l==typeof d&&l<=d}],"filter-id-<=":[mt,[Tt],(i,[t])=>{const s=i.id(),l=t.value;return typeof s==typeof l&&s<=l}],"filter->=":[mt,[_t,Tt],(i,[t,s])=>{const l=i.properties()[t.value],d=s.value;return typeof l==typeof d&&l>=d}],"filter-id->=":[mt,[Tt],(i,[t])=>{const s=i.id(),l=t.value;return typeof s==typeof l&&s>=l}],"filter-has":[mt,[Tt],(i,[t])=>t.value in i.properties()],"filter-has-id":[mt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[mt,[Bn(_t)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[mt,[Bn(Tt)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[mt,[_t,Bn(Tt)],(i,[t,s])=>s.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[mt,[_t,Bn(Tt)],(i,[t,s])=>function(l,d,g,_){for(;g<=_;){const x=g+_>>1;if(d[x]===l)return!0;d[x]>l?_=x-1:g=x+1}return!1}(i.properties()[t.value],s.value,0,s.value.length-1)],all:{type:mt,overloads:[[[mt,mt],(i,[t,s])=>t.evaluate(i)&&s.evaluate(i)],[Ei(mt),(i,t)=>{for(const s of t)if(!s.evaluate(i))return!1;return!0}]]},any:{type:mt,overloads:[[[mt,mt],(i,[t,s])=>t.evaluate(i)||s.evaluate(i)],[Ei(mt),(i,t)=>{for(const s of t)if(s.evaluate(i))return!0;return!1}]]},"!":[mt,[mt],(i,[t])=>!t.evaluate(i)],"is-supported-script":[mt,[_t],(i,[t])=>{const s=i.globals&&i.globals.isSupportedScript;return!s||s(t.evaluate(i))}],upcase:[_t,[_t],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[_t,[_t],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[_t,Ei(Tt),(i,t)=>t.map(s=>si(s.evaluate(i))).join("")],"resolved-locale":[_t,[wi],(i,[t])=>t.evaluate(i).resolvedLocale()]});class Sc{constructor(t,s){var l;this.expression=t,this._warningHistory={},this._evaluator=new Aa,this._defaultValue=s?(l=s).type==="color"&&Ya(l.default)?new Qt(0,0,0,0):l.type==="color"?Qt.parse(l.default)||null:l.type==="padding"?un.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?hn.parse(l.default)||null:l.type==="projectionDefinition"?$n.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(t,s,l,d,g,_){return this._evaluator.globals=t,this._evaluator.feature=s,this._evaluator.featureState=l,this._evaluator.canonical=d,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(t,s,l,d,g,_){this._evaluator.globals=t,this._evaluator.feature=s||null,this._evaluator.featureState=l||null,this._evaluator.canonical=d,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_||null;try{const x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new Dr(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(x)} instead.`);return x}catch(x){return this._warningHistory[x.message]||(this._warningHistory[x.message]=!0,typeof console<"u"&&console.warn(x.message)),this._defaultValue}}}function Ka(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in as}function zi(i,t){const s=new Xt(as,Wa,[],t?function(d){const g={color:Ot,string:_t,number:$e,enum:_t,boolean:mt,formatted:Wr,padding:Qr,projectionDefinition:Rt,resolvedImage:br,variableAnchorOffsetCollection:Pa};return d.type==="array"?Bn(g[d.value]||Tt,d.length):g[d.type]}(t):void 0),l=s.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?kh(new Sc(l,t)):ls(s.errors)}class Ja{constructor(t,s){this.kind=t,this._styleExpression=s,this.isStateDependent=t!=="constant"&&!Ys(s.expression)}evaluateWithoutErrorHandling(t,s,l,d,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,s,l,d,g,_)}evaluate(t,s,l,d,g,_){return this._styleExpression.evaluate(t,s,l,d,g,_)}}class Tc{constructor(t,s,l,d){this.kind=t,this.zoomStops=l,this._styleExpression=s,this.isStateDependent=t!=="camera"&&!Ys(s.expression),this.interpolationType=d}evaluateWithoutErrorHandling(t,s,l,d,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,s,l,d,g,_)}evaluate(t,s,l,d,g,_){return this._styleExpression.evaluate(t,s,l,d,g,_)}interpolationFactor(t,s,l){return this.interpolationType?Mn.interpolationFactor(this.interpolationType,t,s,l):0}}function Ah(i,t){const s=zi(i,t);if(s.result==="error")return s;const l=s.value.expression,d=Ha(l);if(!d&&!cs(t))return ls([new xt("","data expressions not supported")]);const g=Xa(l,["zoom"]);if(!g&&!Ph(t))return ls([new xt("","zoom expressions not supported")]);const _=el(l);return _||g?_ instanceof xt?ls([_]):_ instanceof Mn&&!Cc(t)?ls([new xt("",'"interpolate" expressions cannot be used with this property')]):kh(_?new Tc(d?"camera":"composite",s.value,_.labels,_ instanceof Mn?_.interpolation:void 0):new Ja(d?"constant":"source",s.value)):ls([new xt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Qa{constructor(t,s){this._parameters=t,this._specification=s,it(this,Mh(this._parameters,this._specification))}static deserialize(t){return new Qa(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function el(i){let t=null;if(i instanceof $t)t=el(i.result);else if(i instanceof Ur){for(const s of i.args)if(t=el(s),t)break}else(i instanceof is||i instanceof Mn)&&i.input instanceof ho&&i.input.name==="zoom"&&(t=i);return t instanceof xt||i.eachChild(s=>{const l=el(s);l instanceof xt?t=l:!t&&l?t=new xt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new xt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function kc(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!kc(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const zh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function tl(i){if(i==null)return{filter:()=>!0,needGeometry:!1};kc(i)||(i=Ks(i));const t=zi(i,zh);if(t.result==="error")throw new Error(t.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,l,d)=>t.value.evaluate(s,l,{},d),needGeometry:Rh(i)}}function jf(i,t){return i<t?-1:i>t?1:0}function Rh(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let t=1;t<i.length;t++)if(Rh(i[t]))return!0;return!1}function Ks(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?rl(i[1],i[2],"=="):t==="!="?us(rl(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?rl(i[1],i[2],t):t==="any"?(s=i.slice(1),["any"].concat(s.map(Ks))):t==="all"?["all"].concat(i.slice(1).map(Ks)):t==="none"?["all"].concat(i.slice(1).map(Ks).map(us)):t==="in"?Pc(i[1],i.slice(2)):t==="!in"?us(Pc(i[1],i.slice(2))):t==="has"?Mc(i[1]):t!=="!has"||us(Mc(i[1]));var s}function rl(i,t,s){switch(i){case"$type":return[`filter-type-${s}`,t];case"$id":return[`filter-id-${s}`,t];default:return[`filter-${s}`,i,t]}}function Pc(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(s=>typeof s!=typeof t[0])?["filter-in-large",i,["literal",t.sort(jf)]]:["filter-in-small",i,["literal",t]]}}function Mc(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function us(i){return["!",i]}function Js(i){const t=typeof i;if(t==="number"||t==="boolean"||t==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let d="[";for(const g of i)d+=`${Js(g)},`;return`${d}]`}const s=Object.keys(i).sort();let l="{";for(let d=0;d<s.length;d++)l+=`${JSON.stringify(s[d])}:${Js(i[s[d]])},`;return`${l}}`}function Ic(i){let t="";for(const s of W)t+=`/${Js(i[s])}`;return t}function Qs(i){const t=i.value;return t?[new ve(i.key,t,"constants have been deprecated as of v8")]:[]}function Nr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Ri(i){if(Array.isArray(i))return i.map(Ri);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const s in i)t[s]=Ri(i[s]);return t}return Nr(i)}function fo(i){const t=i.key,s=i.value,l=i.valueSpec||{},d=i.objectElementValidators||{},g=i.style,_=i.styleSpec,x=i.validateSpec;let S=[];const k=er(s);if(k!=="object")return[new ve(t,s,`object expected, ${k} found`)];for(const M in s){const E=M.split(".")[0],B=l[E]||l["*"];let F;if(d[E])F=d[E];else if(l[E])F=x;else if(d["*"])F=d["*"];else{if(!l["*"]){S.push(new ve(t,s[M],`unknown property "${M}"`));continue}F=x}S=S.concat(F({key:(t&&`${t}.`)+M,value:s[M],valueSpec:B,style:g,styleSpec:_,object:s,objectKey:M,validateSpec:x},s))}for(const M in l)d[M]||l[M].required&&l[M].default===void 0&&s[M]===void 0&&S.push(new ve(t,s,`missing required property "${M}"`));return S}function Ec(i){const t=i.value,s=i.valueSpec,l=i.style,d=i.styleSpec,g=i.key,_=i.arrayElementValidator||i.validateSpec;if(er(t)!=="array")return[new ve(g,t,`array expected, ${er(t)} found`)];if(s.length&&t.length!==s.length)return[new ve(g,t,`array length ${s.length} expected, length ${t.length} found`)];if(s["min-length"]&&t.length<s["min-length"])return[new ve(g,t,`array length at least ${s["min-length"]} expected, length ${t.length} found`)];let x={type:s.value,values:s.values};d.$version<7&&(x.function=s.function),er(s.value)==="object"&&(x=s.value);let S=[];for(let k=0;k<t.length;k++)S=S.concat(_({array:t,arrayIndex:k,value:t[k],valueSpec:x,validateSpec:i.validateSpec,style:l,styleSpec:d,key:`${g}[${k}]`}));return S}function Ac(i){const t=i.key,s=i.value,l=i.valueSpec;let d=er(s);return d==="number"&&s!=s&&(d="NaN"),d!=="number"?[new ve(t,s,`number expected, ${d} found`)]:"minimum"in l&&s<l.minimum?[new ve(t,s,`${s} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&s>l.maximum?[new ve(t,s,`${s} is greater than the maximum value ${l.maximum}`)]:[]}function Dh(i){const t=i.valueSpec,s=Nr(i.value.type);let l,d,g,_={};const x=s!=="categorical"&&i.value.property===void 0,S=!x,k=er(i.value.stops)==="array"&&er(i.value.stops[0])==="array"&&er(i.value.stops[0][0])==="object",M=fo({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(F){if(s==="identity")return[new ve(F.key,F.value,'identity function may not have a "stops" property')];let j=[];const Z=F.value;return j=j.concat(Ec({key:F.key,value:Z,valueSpec:F.valueSpec,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:E})),er(Z)==="array"&&Z.length===0&&j.push(new ve(F.key,Z,"array must have at least one stop")),j},default:function(F){return F.validateSpec({key:F.key,value:F.value,valueSpec:t,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec})}}});return s==="identity"&&x&&M.push(new ve(i.key,i.value,'missing required property "property"')),s==="identity"||i.value.stops||M.push(new ve(i.key,i.value,'missing required property "stops"')),s==="exponential"&&i.valueSpec.expression&&!Cc(i.valueSpec)&&M.push(new ve(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(S&&!cs(i.valueSpec)?M.push(new ve(i.key,i.value,"property functions not supported")):x&&!Ph(i.valueSpec)&&M.push(new ve(i.key,i.value,"zoom functions not supported"))),s!=="categorical"&&!k||i.value.property!==void 0||M.push(new ve(i.key,i.value,'"property" property is required')),M;function E(F){let j=[];const Z=F.value,X=F.key;if(er(Z)!=="array")return[new ve(X,Z,`array expected, ${er(Z)} found`)];if(Z.length!==2)return[new ve(X,Z,`array length 2 expected, length ${Z.length} found`)];if(k){if(er(Z[0])!=="object")return[new ve(X,Z,`object expected, ${er(Z[0])} found`)];if(Z[0].zoom===void 0)return[new ve(X,Z,"object stop key must have zoom")];if(Z[0].value===void 0)return[new ve(X,Z,"object stop key must have value")];if(g&&g>Nr(Z[0].zoom))return[new ve(X,Z[0].zoom,"stop zoom values must appear in ascending order")];Nr(Z[0].zoom)!==g&&(g=Nr(Z[0].zoom),d=void 0,_={}),j=j.concat(fo({key:`${X}[0]`,value:Z[0],valueSpec:{zoom:{}},validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:Ac,value:B}}))}else j=j.concat(B({key:`${X}[0]`,value:Z[0],validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec},Z));return Ka(Ri(Z[1]))?j.concat([new ve(`${X}[1]`,Z[1],"expressions are not allowed in function stops.")]):j.concat(F.validateSpec({key:`${X}[1]`,value:Z[1],valueSpec:t,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec}))}function B(F,j){const Z=er(F.value),X=Nr(F.value),ee=F.value!==null?F.value:j;if(l){if(Z!==l)return[new ve(F.key,ee,`${Z} stop domain type must match previous stop domain type ${l}`)]}else l=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean")return[new ve(F.key,ee,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&s!=="categorical"){let de=`number expected, ${Z} found`;return cs(t)&&s===void 0&&(de+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ve(F.key,ee,de)]}return s!=="categorical"||Z!=="number"||isFinite(X)&&Math.floor(X)===X?s!=="categorical"&&Z==="number"&&d!==void 0&&X<d?[new ve(F.key,ee,"stop domain values must appear in ascending order")]:(d=X,s==="categorical"&&X in _?[new ve(F.key,ee,"stop domain values must be unique")]:(_[X]=!0,[])):[new ve(F.key,ee,`integer expected, found ${X}`)]}}function Di(i){const t=(i.expressionContext==="property"?Ah:zi)(Ri(i.value),i.valueSpec);if(t.result==="error")return t.value.map(l=>new ve(`${i.key}${l.key}`,i.value,l.message));const s=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!s.outputDefined())return[new ve(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Ys(s))return[new ve(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Ys(s))return[new ve(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Xa(s,["zoom","feature-state"]))return[new ve(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!Ha(s))return[new ve(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function hs(i){const t=i.key,s=i.value,l=i.valueSpec,d=[];return Array.isArray(l.values)?l.values.indexOf(Nr(s))===-1&&d.push(new ve(t,s,`expected one of [${l.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(l.values).indexOf(Nr(s))===-1&&d.push(new ve(t,s,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(s)} found`)),d}function ds(i){return kc(Ri(i.value))?Di(it({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Lh(i)}function Lh(i){const t=i.value,s=i.key;if(er(t)!=="array")return[new ve(s,t,`array expected, ${er(t)} found`)];const l=i.styleSpec;let d,g=[];if(t.length<1)return[new ve(s,t,"filter array must have at least 1 element")];switch(g=g.concat(hs({key:`${s}[0]`,value:t[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),Nr(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Nr(t[1])==="$type"&&g.push(new ve(s,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&g.push(new ve(s,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(d=er(t[1]),d!=="string"&&g.push(new ve(`${s}[1]`,t[1],`string expected, ${d} found`)));for(let _=2;_<t.length;_++)d=er(t[_]),Nr(t[1])==="$type"?g=g.concat(hs({key:`${s}[${_}]`,value:t[_],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&g.push(new ve(`${s}[${_}]`,t[_],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let _=1;_<t.length;_++)g=g.concat(Lh({key:`${s}[${_}]`,value:t[_],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":d=er(t[1]),t.length!==2?g.push(new ve(s,t,`filter array for "${t[0]}" operator must have 2 elements`)):d!=="string"&&g.push(new ve(`${s}[1]`,t[1],`string expected, ${d} found`))}return g}function zc(i,t){const s=i.key,l=i.validateSpec,d=i.style,g=i.styleSpec,_=i.value,x=i.objectKey,S=g[`${t}_${i.layerType}`];if(!S)return[];const k=x.match(/^(.*)-transition$/);if(t==="paint"&&k&&S[k[1]]&&S[k[1]].transition)return l({key:s,value:_,valueSpec:g.transition,style:d,styleSpec:g});const M=i.valueSpec||S[x];if(!M)return[new ve(s,_,`unknown property "${x}"`)];let E;if(er(_)==="string"&&cs(M)&&!M.tokens&&(E=/^{([^}]+)}$/.exec(_)))return[new ve(s,_,`"${x}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(E[1])} }\`.`)];const B=[];return i.layerType==="symbol"&&(x==="text-field"&&d&&!d.glyphs&&B.push(new ve(s,_,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&Ya(Ri(_))&&Nr(_.type)==="identity"&&B.push(new ve(s,_,'"text-font" does not support identity functions'))),B.concat(l({key:i.key,value:_,valueSpec:M,style:d,styleSpec:g,expressionContext:"property",propertyType:t,propertyKey:x}))}function Rc(i){return zc(i,"paint")}function Bh(i){return zc(i,"layout")}function Dc(i){let t=[];const s=i.value,l=i.key,d=i.style,g=i.styleSpec;s.type||s.ref||t.push(new ve(l,s,'either "type" or "ref" is required'));let _=Nr(s.type);const x=Nr(s.ref);if(s.id){const S=Nr(s.id);for(let k=0;k<i.arrayIndex;k++){const M=d.layers[k];Nr(M.id)===S&&t.push(new ve(l,s.id,`duplicate layer id "${s.id}", previously used at line ${M.id.__line__}`))}}if("ref"in s){let S;["type","source","source-layer","filter","layout"].forEach(k=>{k in s&&t.push(new ve(l,s[k],`"${k}" is prohibited for ref layers`))}),d.layers.forEach(k=>{Nr(k.id)===x&&(S=k)}),S?S.ref?t.push(new ve(l,s.ref,"ref cannot reference another ref layer")):_=Nr(S.type):t.push(new ve(l,s.ref,`ref layer "${x}" not found`))}else if(_!=="background")if(s.source){const S=d.sources&&d.sources[s.source],k=S&&Nr(S.type);S?k==="vector"&&_==="raster"?t.push(new ve(l,s.source,`layer "${s.id}" requires a raster source`)):k!=="raster-dem"&&_==="hillshade"?t.push(new ve(l,s.source,`layer "${s.id}" requires a raster-dem source`)):k==="raster"&&_!=="raster"?t.push(new ve(l,s.source,`layer "${s.id}" requires a vector source`)):k!=="vector"||s["source-layer"]?k==="raster-dem"&&_!=="hillshade"?t.push(new ve(l,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!s.paint||!s.paint["line-gradient"]||k==="geojson"&&S.lineMetrics||t.push(new ve(l,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new ve(l,s,`layer "${s.id}" must specify a "source-layer"`)):t.push(new ve(l,s.source,`source "${s.source}" not found`))}else t.push(new ve(l,s,'missing required property "source"'));return t=t.concat(fo({key:l,value:s,valueSpec:g.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${l}.type`,value:s.type,valueSpec:g.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:s,objectKey:"type"}),filter:ds,layout:S=>fo({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":k=>Bh(it({layerType:_},k))}}),paint:S=>fo({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":k=>Rc(it({layerType:_},k))}})}})),t}function li(i){const t=i.value,s=i.key,l=er(t);return l!=="string"?[new ve(s,t,`string expected, ${l} found`)]:[]}const fs={promoteId:function({key:i,value:t}){if(er(t)==="string")return li({key:i,value:t});{const s=[];for(const l in t)s.push(...li({key:`${i}.${l}`,value:t[l]}));return s}}};function $h(i){const t=i.value,s=i.key,l=i.styleSpec,d=i.style,g=i.validateSpec;if(!t.type)return[new ve(s,t,'"type" is required')];const _=Nr(t.type);let x;switch(_){case"vector":case"raster":return x=fo({key:s,value:t,valueSpec:l[`source_${_.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:fs,validateSpec:g}),x;case"raster-dem":return x=function(S){var k;const M=(k=S.sourceName)!==null&&k!==void 0?k:"",E=S.value,B=S.styleSpec,F=B.source_raster_dem,j=S.style;let Z=[];const X=er(E);if(E===void 0)return Z;if(X!=="object")return Z.push(new ve("source_raster_dem",E,`object expected, ${X} found`)),Z;const ee=Nr(E.encoding)==="custom",de=["redFactor","greenFactor","blueFactor","baseShift"],ne=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const O in E)!ee&&de.includes(O)?Z.push(new ve(O,E[O],`In "${M}": "${O}" is only valid when "encoding" is set to "custom". ${ne} encoding found`)):F[O]?Z=Z.concat(S.validateSpec({key:O,value:E[O],valueSpec:F[O],validateSpec:S.validateSpec,style:j,styleSpec:B})):Z.push(new ve(O,E[O],`unknown property "${O}"`));return Z}({sourceName:s,value:t,style:i.style,styleSpec:l,validateSpec:g}),x;case"geojson":if(x=fo({key:s,value:t,valueSpec:l.source_geojson,style:d,styleSpec:l,validateSpec:g,objectElementValidators:fs}),t.cluster)for(const S in t.clusterProperties){const[k,M]=t.clusterProperties[S],E=typeof k=="string"?[k,["accumulated"],["get",S]]:k;x.push(...Di({key:`${s}.${S}.map`,value:M,expressionContext:"cluster-map"})),x.push(...Di({key:`${s}.${S}.reduce`,value:E,expressionContext:"cluster-reduce"}))}return x;case"video":return fo({key:s,value:t,valueSpec:l.source_video,style:d,validateSpec:g,styleSpec:l});case"image":return fo({key:s,value:t,valueSpec:l.source_image,style:d,validateSpec:g,styleSpec:l});case"canvas":return[new ve(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return hs({key:`${s}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Oh(i){const t=i.value,s=i.styleSpec,l=s.light,d=i.style;let g=[];const _=er(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new ve("light",t,`object expected, ${_} found`)]),g;for(const x in t){const S=x.match(/^(.*)-transition$/);g=g.concat(S&&l[S[1]]&&l[S[1]].transition?i.validateSpec({key:x,value:t[x],valueSpec:s.transition,validateSpec:i.validateSpec,style:d,styleSpec:s}):l[x]?i.validateSpec({key:x,value:t[x],valueSpec:l[x],validateSpec:i.validateSpec,style:d,styleSpec:s}):[new ve(x,t[x],`unknown property "${x}"`)])}return g}function Fh(i){const t=i.value,s=i.styleSpec,l=s.sky,d=i.style,g=er(t);if(t===void 0)return[];if(g!=="object")return[new ve("sky",t,`object expected, ${g} found`)];let _=[];for(const x in t)_=_.concat(l[x]?i.validateSpec({key:x,value:t[x],valueSpec:l[x],style:d,styleSpec:s}):[new ve(x,t[x],`unknown property "${x}"`)]);return _}function jh(i){const t=i.value,s=i.styleSpec,l=s.terrain,d=i.style;let g=[];const _=er(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new ve("terrain",t,`object expected, ${_} found`)]),g;for(const x in t)g=g.concat(l[x]?i.validateSpec({key:x,value:t[x],valueSpec:l[x],validateSpec:i.validateSpec,style:d,styleSpec:s}):[new ve(x,t[x],`unknown property "${x}"`)]);return g}function Nh(i){let t=[];const s=i.value,l=i.key;if(Array.isArray(s)){const d=[],g=[];for(const _ in s)s[_].id&&d.includes(s[_].id)&&t.push(new ve(l,s,`all the sprites' ids must be unique, but ${s[_].id} is duplicated`)),d.push(s[_].id),s[_].url&&g.includes(s[_].url)&&t.push(new ve(l,s,`all the sprites' URLs must be unique, but ${s[_].url} is duplicated`)),g.push(s[_].url),t=t.concat(fo({key:`${l}[${_}]`,value:s[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return t}return li({key:l,value:s})}const Vh={"*":()=>[],array:Ec,boolean:function(i){const t=i.value,s=i.key,l=er(t);return l!=="boolean"?[new ve(s,t,`boolean expected, ${l} found`)]:[]},number:Ac,color:function(i){const t=i.key,s=i.value,l=er(s);return l!=="string"?[new ve(t,s,`color expected, ${l} found`)]:Qt.parse(String(s))?[]:[new ve(t,s,`color expected, "${s}" found`)]},constants:Qs,enum:hs,filter:ds,function:Dh,layer:Dc,object:fo,source:$h,light:Oh,sky:Fh,terrain:jh,projection:function(i){const t=i.value,s=i.styleSpec,l=s.projection,d=i.style,g=er(t);if(t===void 0)return[];if(g!=="object")return[new ve("projection",t,`object expected, ${g} found`)];let _=[];for(const x in t)_=_.concat(l[x]?i.validateSpec({key:x,value:t[x],valueSpec:l[x],style:d,styleSpec:s}):[new ve(x,t[x],`unknown property "${x}"`)]);return _},projectionDefinition:function(i){const t=i.key;let s=i.value;s=s instanceof String?s.valueOf():s;const l=er(s);return l!=="array"||function(d){return Array.isArray(d)&&d.length===3&&typeof d[0]=="string"&&typeof d[1]=="string"&&typeof d[2]=="number"}(s)||function(d){return!!["interpolate","step","literal"].includes(d[0])}(s)?["array","string"].includes(l)?[]:[new ve(t,s,`projection expected, invalid type "${l}" found`)]:[new ve(t,s,`projection expected, invalid array ${JSON.stringify(s)} found`)]},string:li,formatted:function(i){return li(i).length===0?[]:Di(i)},resolvedImage:function(i){return li(i).length===0?[]:Di(i)},padding:function(i){const t=i.key,s=i.value;if(er(s)==="array"){if(s.length<1||s.length>4)return[new ve(t,s,`padding requires 1 to 4 values; ${s.length} values found`)];const l={type:"number"};let d=[];for(let g=0;g<s.length;g++)d=d.concat(i.validateSpec({key:`${t}[${g}]`,value:s[g],validateSpec:i.validateSpec,valueSpec:l}));return d}return Ac({key:t,value:s,valueSpec:{}})},variableAnchorOffsetCollection:function(i){const t=i.key,s=i.value,l=er(s),d=i.styleSpec;if(l!=="array"||s.length<1||s.length%2!=0)return[new ve(t,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let g=[];for(let _=0;_<s.length;_+=2)g=g.concat(hs({key:`${t}[${_}]`,value:s[_],valueSpec:d.layout_symbol["text-anchor"]})),g=g.concat(Ec({key:`${t}[${_+1}]`,value:s[_+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:d}));return g},sprite:Nh};function ci(i){const t=i.value,s=i.valueSpec,l=i.styleSpec;return i.validateSpec=ci,s.expression&&Ya(Nr(t))?Dh(i):s.expression&&Ka(Ri(t))?Di(i):s.type&&Vh[s.type]?Vh[s.type](i):fo(it({},i,{valueSpec:s.type?l[s.type]:s}))}function ps(i){const t=i.value,s=i.key,l=li(i);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new ve(s,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new ve(s,t,'"glyphs" url must include a "{range}" token'))),l}function Lr(i,t=z){let s=[];return s=s.concat(ci({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,validateSpec:ci,objectElementValidators:{glyphs:ps,"*":()=>[]}})),i.constants&&(s=s.concat(Qs({key:"constants",value:i.constants}))),Lc(s)}function Fn(i){return function(t){return i({...t,validateSpec:ci})}}function Lc(i){return[].concat(i).sort((t,s)=>t.line-s.line)}function Ro(i){return function(...t){return Lc(i.apply(this,t))}}Lr.source=Ro(Fn($h)),Lr.sprite=Ro(Fn(Nh)),Lr.glyphs=Ro(Fn(ps)),Lr.light=Ro(Fn(Oh)),Lr.sky=Ro(Fn(Fh)),Lr.terrain=Ro(Fn(jh)),Lr.layer=Ro(Fn(Dc)),Lr.filter=Ro(Fn(ds)),Lr.paintProperty=Ro(Fn(Rc)),Lr.layoutProperty=Ro(Fn(Bh));const ms=Lr,ea=ms.light,Uh=ms.sky,Bc=ms.paintProperty,Nf=ms.layoutProperty;function nl(i,t){let s=!1;if(t&&t.length)for(const l of t)i.fire(new io(new Error(l.message))),s=!0;return s}class ta{constructor(t,s,l){const d=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(s=_[1])+2*(l=_[2]);for(let S=0;S<this.d*this.d;S++){const k=_[3+S],M=_[3+S+1];d.push(k===M?null:_.subarray(k,M))}const x=_[3+d.length+1];this.keys=_.subarray(_[3+d.length],x),this.bboxes=_.subarray(x),this.insert=this._insertReadonly}else{this.d=s+2*l;for(let _=0;_<this.d*this.d;_++)d.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=t,this.padding=l,this.scale=s/t,this.uid=0;const g=l/s*t;this.min=-g,this.max=t+g}insert(t,s,l,d,g){this._forEachCell(s,l,d,g,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(s),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(g)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,s,l,d,g,_){this.cells[g].push(_)}query(t,s,l,d,g){const _=this.min,x=this.max;if(t<=_&&s<=_&&x<=l&&x<=d&&!g)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(t,s,l,d,this._queryCell,S,{},g),S}}_queryCell(t,s,l,d,g,_,x,S){const k=this.cells[g];if(k!==null){const M=this.keys,E=this.bboxes;for(let B=0;B<k.length;B++){const F=k[B];if(x[F]===void 0){const j=4*F;(S?S(E[j+0],E[j+1],E[j+2],E[j+3]):t<=E[j+2]&&s<=E[j+3]&&l>=E[j+0]&&d>=E[j+1])?(x[F]=!0,_.push(M[F])):x[F]=!1}}}}_forEachCell(t,s,l,d,g,_,x,S){const k=this._convertToCellCoord(t),M=this._convertToCellCoord(s),E=this._convertToCellCoord(l),B=this._convertToCellCoord(d);for(let F=k;F<=E;F++)for(let j=M;j<=B;j++){const Z=this.d*j+F;if((!S||S(this._convertFromCellCoord(F),this._convertFromCellCoord(j),this._convertFromCellCoord(F+1),this._convertFromCellCoord(j+1)))&&g.call(this,t,s,l,d,Z,_,x,S))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,s=3+this.cells.length+1+1;let l=0;for(let _=0;_<this.cells.length;_++)l+=this.cells[_].length;const d=new Int32Array(s+l+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let g=s;for(let _=0;_<t.length;_++){const x=t[_];d[3+_]=g,d.set(x,g),g+=x.length}return d[3+t.length]=g,d.set(this.keys,g),g+=this.keys.length,d[3+t.length+1]=g,d.set(this.bboxes,g),g+=this.bboxes.length,d.buffer}static serialize(t,s){const l=t.toArrayBuffer();return s&&s.push(l),{buffer:l}}static deserialize(t){return new ta(t.buffer)}}const Xn={};function dt(i,t,s={}){if(Xn[i])throw new Error(`${i} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),Xn[i]={klass:t,omit:s.omit||[],shallow:s.shallow||[]}}dt("Object",Object),dt("TransferableGridIndex",ta),dt("Color",Qt),dt("Error",Error),dt("AJAXError",Yt),dt("ResolvedImage",zn),dt("StylePropertyFunction",Qa),dt("StyleExpression",Sc,{omit:["_evaluator"]}),dt("ZoomDependentExpression",Tc),dt("ZoomConstantExpression",Ja),dt("CompoundExpression",ho,{omit:["_evaluate"]});for(const i in as)as[i]._classRegistryKey||dt(`Expression_${i}`,as[i]);function gs(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function $c(i){return i.$name||i.constructor._classRegistryKey}function Zh(i){return!function(t){if(t===null||typeof t!="object")return!1;const s=$c(t);return!(!s||s==="Object")}(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||gs(i)||Ke(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function ui(i,t){if(Zh(i))return(gs(i)||Ke(i))&&t&&t.push(i),ArrayBuffer.isView(i)&&t&&t.push(i.buffer),i instanceof ImageData&&t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const g=[];for(const _ of i)g.push(ui(_,t));return g}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const s=$c(i);if(!s)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!Xn[s])throw new Error(`${s} is not registered.`);const{klass:l}=Xn[s],d=l.serialize?l.serialize(i,t):{};if(l.serialize){if(t&&d===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const g in i){if(!i.hasOwnProperty(g)||Xn[s].omit.indexOf(g)>=0)continue;const _=i[g];d[g]=Xn[s].shallow.indexOf(g)>=0?_:ui(_,t)}i instanceof Error&&(d.message=i.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(d.$name=s),d}function ra(i){if(Zh(i))return i;if(Array.isArray(i))return i.map(ra);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const t=$c(i)||"Object";if(!Xn[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:s}=Xn[t];if(!s)throw new Error(`can't deserialize unregistered class ${t}`);if(s.deserialize)return s.deserialize(i);const l=Object.create(s.prototype);for(const d of Object.keys(i)){if(d==="$name")continue;const g=i[d];l[d]=Xn[t].shallow.indexOf(d)>=0?g:ra(g)}return l}class ol{constructor(){this.first=!0}update(t,s){const l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=s),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}const Nt={"Latin-1 Supplement":i=>i>=128&&i<=255,"Hangul Jamo":i=>i>=4352&&i<=4607,Khmer:i=>i>=6016&&i<=6143,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Kanbun:i=>i>=12688&&i<=12703,"CJK Strokes":i=>i>=12736&&i<=12783,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Hangul Syllables":i=>i>=44032&&i<=55215,"Private Use Area":i=>i>=57344&&i<=63743,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function il(i){for(const t of i)if(jc(t.charCodeAt(0)))return!0;return!1}function Gh(i){for(const t of i)if(!Oc(t.charCodeAt(0)))return!1;return!0}function sl(i){const t=i.map(s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}}).filter(s=>s);return new RegExp(t.join("|"),"u")}const qh=sl(["Arab","Dupl","Mong","Ougr","Syrc"]);function Oc(i){return!qh.test(String.fromCodePoint(i))}const Fc=sl(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function jc(i){return!(i!==746&&i!==747&&(i<4352||!(Nt["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Nt["CJK Compatibility"](i)||Nt["CJK Strokes"](i)||!(!Nt["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Nt["Enclosed CJK Letters and Months"](i)||Nt["Ideographic Description Characters"](i)||Nt.Kanbun(i)||Nt.Katakana(i)&&i!==12540||!(!Nt["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Nt["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Nt["Vertical Forms"](i)||Nt["Yijing Hexagram Symbols"](i)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(i))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(i))||Fc.test(String.fromCodePoint(i)))))}function Nc(i){return!(jc(i)||function(t){return!!(Nt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Nt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Nt["Letterlike Symbols"](t)||Nt["Number Forms"](t)||Nt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Nt["Control Pictures"](t)&&t!==9251||Nt["Optical Character Recognition"](t)||Nt["Enclosed Alphanumerics"](t)||Nt["Geometric Shapes"](t)||Nt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Nt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Nt["CJK Symbols and Punctuation"](t)||Nt.Katakana(t)||Nt["Private Use Area"](t)||Nt["CJK Compatibility Forms"](t)||Nt["Small Form Variants"](t)||Nt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}const Vf=sl(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Vc(i){return Vf.test(String.fromCodePoint(i))}function Wh(i,t){return!(!t&&Vc(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Nt.Khmer(i))}function Hh(i){for(const t of i)if(Vc(t.charCodeAt(0)))return!0;return!1}const hi=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){if(hi.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(i,t){return a(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(i.pluginStatus!=="loading")return this.setState(i),i;const s=i.pluginURL,l=new Promise(g=>{this.loadScriptResolve=g});t(s);const d=new Promise(g=>setTimeout(()=>g(),this.TIMEOUT));if(yield Promise.race([l,d]),this.isParsed()){const g={pluginStatus:"loaded",pluginURL:s};return this.setState(g),g}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${s}`)})}};class Tr{constructor(t,s){this.zoom=t,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ol,this.transition={})}isSupportedScript(t){return function(s,l){for(const d of s)if(!Wh(d.charCodeAt(0),l))return!1;return!0}(t,hi.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,s=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*s}}}class na{constructor(t,s){this.property=t,this.value=s,this.expression=function(l,d){if(Ya(l))return new Qa(l,d);if(Ka(l)){const g=Ah(l,d);if(g.result==="error")throw new Error(g.value.map(_=>`${_.key}: ${_.message}`).join(", "));return g.value}{let g=l;return d.type==="color"&&typeof l=="string"?g=Qt.parse(l):d.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?d.type==="variableAnchorOffsetCollection"&&Array.isArray(l)?g=hn.parse(l):d.type==="projectionDefinition"&&typeof l=="string"&&(g=$n.parse(l)):g=un.parse(l),{kind:"constant",evaluate:()=>g}}}(s===void 0?t.specification.default:s,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,s,l){return this.property.possiblyEvaluate(this,t,s,l)}}class al{constructor(t){this.property=t,this.value=new na(t,void 0)}transitioned(t,s){return new Zc(this.property,this.value,s,Cr({},t.transition,this.transition),t.now)}untransitioned(){return new Zc(this.property,this.value,null,{},0)}}class Uc{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return cn(this._values[t].value.value)}setValue(t,s){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new al(this._values[t].property)),this._values[t].value=new na(this._values[t].property,s===null?void 0:cn(s))}getTransition(t){return cn(this._values[t].transition)}setTransition(t,s){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new al(this._values[t].property)),this._values[t].transition=cn(s)||void 0}serialize(){const t={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(t[s]=l);const d=this.getTransition(s);d!==void 0&&(t[`${s}-transition`]=d)}return t}transitioned(t,s){const l=new oa(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].transitioned(t,s._values[d]);return l}untransitioned(){const t=new oa(this._properties);for(const s of Object.keys(this._values))t._values[s]=this._values[s].untransitioned();return t}}class Zc{constructor(t,s,l,d,g){this.property=t,this.value=s,this.begin=g+d.delay||0,this.end=this.begin+d.duration||0,t.specification.transition&&(d.delay||d.duration)&&(this.prior=l)}possiblyEvaluate(t,s,l){const d=t.now||0,g=this.value.possiblyEvaluate(t,s,l),_=this.prior;if(_){if(d>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(d<this.begin)return _.possiblyEvaluate(t,s,l);{const x=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(t,s,l),g,dr(x))}}return g}}class oa{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,s,l){const d=new ll(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].possiblyEvaluate(t,s,l);return d}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Uf{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return cn(this._values[t].value)}setValue(t,s){this._values[t]=new na(this._values[t].property,s===null?void 0:cn(s))}serialize(){const t={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(t[s]=l)}return t}possiblyEvaluate(t,s,l){const d=new ll(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].possiblyEvaluate(t,s,l);return d}}class po{constructor(t,s,l){this.property=t,this.value=s,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,s,l,d){return this.property.evaluate(this.value,this.parameters,t,s,l,d)}}class ll{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class wt{constructor(t){this.specification=t}possiblyEvaluate(t,s){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(s)}interpolate(t,s,l){const d=Hn[this.specification.type];return d?d(t,s,l):t}}class Et{constructor(t,s){this.specification=t,this.overrides=s}possiblyEvaluate(t,s,l,d){return new po(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(s,null,{},l,d)}:t.expression,s)}interpolate(t,s,l){if(t.value.kind!=="constant"||s.value.kind!=="constant")return t;if(t.value.value===void 0||s.value.value===void 0)return new po(this,{kind:"constant",value:void 0},t.parameters);const d=Hn[this.specification.type];if(d){const g=d(t.value.value,s.value.value,l);return new po(this,{kind:"constant",value:g},t.parameters)}return t}evaluate(t,s,l,d,g,_){return t.kind==="constant"?t.value:t.evaluate(s,l,d,g,_)}}class ia extends Et{possiblyEvaluate(t,s,l,d){if(t.value===void 0)return new po(this,{kind:"constant",value:void 0},s);if(t.expression.kind==="constant"){const g=t.expression.evaluate(s,null,{},l,d),_=t.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,x=this._calculate(_,_,_,s);return new po(this,{kind:"constant",value:x},s)}if(t.expression.kind==="camera"){const g=this._calculate(t.expression.evaluate({zoom:s.zoom-1}),t.expression.evaluate({zoom:s.zoom}),t.expression.evaluate({zoom:s.zoom+1}),s);return new po(this,{kind:"constant",value:g},s)}return new po(this,t.expression,s)}evaluate(t,s,l,d,g,_){if(t.kind==="source"){const x=t.evaluate(s,l,d,g,_);return this._calculate(x,x,x,s)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(s.zoom)-1},l,d),t.evaluate({zoom:Math.floor(s.zoom)},l,d),t.evaluate({zoom:Math.floor(s.zoom)+1},l,d),s):t.value}_calculate(t,s,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:s}:{from:l,to:s}}interpolate(t){return t}}class cl{constructor(t){this.specification=t}possiblyEvaluate(t,s,l,d){if(t.value!==void 0){if(t.expression.kind==="constant"){const g=t.expression.evaluate(s,null,{},l,d);return this._calculate(g,g,g,s)}return this._calculate(t.expression.evaluate(new Tr(Math.floor(s.zoom-1),s)),t.expression.evaluate(new Tr(Math.floor(s.zoom),s)),t.expression.evaluate(new Tr(Math.floor(s.zoom+1),s)),s)}}_calculate(t,s,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:s}:{from:l,to:s}}interpolate(t){return t}}class Gc{constructor(t){this.specification=t}possiblyEvaluate(t,s,l,d){return!!t.expression.evaluate(s,null,{},l,d)}interpolate(){return!1}}class jn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in t){const l=t[s];l.specification.overridable&&this.overridableProperties.push(s);const d=this.defaultPropertyValues[s]=new na(l,void 0),g=this.defaultTransitionablePropertyValues[s]=new al(l);this.defaultTransitioningPropertyValues[s]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=d.possiblyEvaluate({})}}}dt("DataDrivenProperty",Et),dt("DataConstantProperty",wt),dt("CrossFadedDataDrivenProperty",ia),dt("CrossFadedProperty",cl),dt("ColorRampProperty",Gc);const Xh="-transition";class Do extends ge{constructor(t,s){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),s.layout&&(this._unevaluatedLayout=new Uf(s.layout)),s.paint)){this._transitionablePaint=new Uc(s.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ll(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,s,l={}){s!=null&&this._validate(Nf,`layers.${this.id}.layout.${t}`,t,s,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,s):this.visibility=s)}getPaintProperty(t){return t.endsWith(Xh)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,s,l={}){if(s!=null&&this._validate(Bc,`layers.${this.id}.paint.${t}`,t,s,l))return!1;if(t.endsWith(Xh))return this._transitionablePaint.setTransition(t.slice(0,-11),s||void 0),!1;{const d=this._transitionablePaint._values[t],g=d.property.specification["property-type"]==="cross-faded-data-driven",_=d.value.isDataDriven(),x=d.value;this._transitionablePaint.setValue(t,s),this._handleSpecialPaintPropertyUpdate(t);const S=this._transitionablePaint._values[t].value;return S.isDataDriven()||_||g||this._handleOverridablePaintPropertyUpdate(t,x,S)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,s,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,s){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,s)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Gn(t,(s,l)=>!(s===void 0||l==="layout"&&!Object.keys(s).length||l==="paint"&&!Object.keys(s).length))}_validate(t,s,l,d,g={}){return(!g||g.validate!==!1)&&nl(this,t.call(ms,{key:s,layerType:this.type,objectKey:l,value:d,styleSpec:z,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const s=this.paint.get(t);if(s instanceof po&&cs(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const Zf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Lo{constructor(t,s){this._structArray=t,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Br{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,s){return t._trim(),s&&(t.isTransferred=!0,s.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const s=Object.create(this.prototype);return s.arrayBuffer=t.arrayBuffer,s.length=t.length,s.capacity=t.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Zr(i,t=1){let s=0,l=0;return{members:i.map(d=>{const g=Zf[d.type].BYTES_PER_ELEMENT,_=s=Yh(s,Math.max(t,g)),x=d.components||1;return l=Math.max(l,g),s+=g*x,{name:d.name,type:d.type,components:x,offset:_}}),size:Yh(s,Math.max(l,t)),alignment:t}}function Yh(i,t){return Math.ceil(i/t)*t}class _s extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s){const l=this.length;return this.resize(l+1),this.emplace(l,t,s)}emplace(t,s,l){const d=2*t;return this.int16[d+0]=s,this.int16[d+1]=l,t}}_s.prototype.bytesPerElement=4,dt("StructArrayLayout2i4",_s);class ul extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,s,l)}emplace(t,s,l,d){const g=3*t;return this.int16[g+0]=s,this.int16[g+1]=l,this.int16[g+2]=d,t}}ul.prototype.bytesPerElement=6,dt("StructArrayLayout3i6",ul);class qc extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l,d){const g=this.length;return this.resize(g+1),this.emplace(g,t,s,l,d)}emplace(t,s,l,d,g){const _=4*t;return this.int16[_+0]=s,this.int16[_+1]=l,this.int16[_+2]=d,this.int16[_+3]=g,t}}qc.prototype.bytesPerElement=8,dt("StructArrayLayout4i8",qc);class Wo extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,t,s,l,d,g,_)}emplace(t,s,l,d,g,_,x){const S=6*t;return this.int16[S+0]=s,this.int16[S+1]=l,this.int16[S+2]=d,this.int16[S+3]=g,this.int16[S+4]=_,this.int16[S+5]=x,t}}Wo.prototype.bytesPerElement=12,dt("StructArrayLayout2i4i12",Wo);class hl extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,t,s,l,d,g,_)}emplace(t,s,l,d,g,_,x){const S=4*t,k=8*t;return this.int16[S+0]=s,this.int16[S+1]=l,this.uint8[k+4]=d,this.uint8[k+5]=g,this.uint8[k+6]=_,this.uint8[k+7]=x,t}}hl.prototype.bytesPerElement=8,dt("StructArrayLayout2i4ub8",hl);class Li extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s){const l=this.length;return this.resize(l+1),this.emplace(l,t,s)}emplace(t,s,l){const d=2*t;return this.float32[d+0]=s,this.float32[d+1]=l,t}}Li.prototype.bytesPerElement=8,dt("StructArrayLayout2f8",Li);class dl extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_,x,S,k,M){const E=this.length;return this.resize(E+1),this.emplace(E,t,s,l,d,g,_,x,S,k,M)}emplace(t,s,l,d,g,_,x,S,k,M,E){const B=10*t;return this.uint16[B+0]=s,this.uint16[B+1]=l,this.uint16[B+2]=d,this.uint16[B+3]=g,this.uint16[B+4]=_,this.uint16[B+5]=x,this.uint16[B+6]=S,this.uint16[B+7]=k,this.uint16[B+8]=M,this.uint16[B+9]=E,t}}dl.prototype.bytesPerElement=20,dt("StructArrayLayout10ui20",dl);class sa extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_,x,S,k,M,E,B){const F=this.length;return this.resize(F+1),this.emplace(F,t,s,l,d,g,_,x,S,k,M,E,B)}emplace(t,s,l,d,g,_,x,S,k,M,E,B,F){const j=12*t;return this.int16[j+0]=s,this.int16[j+1]=l,this.int16[j+2]=d,this.int16[j+3]=g,this.uint16[j+4]=_,this.uint16[j+5]=x,this.uint16[j+6]=S,this.uint16[j+7]=k,this.int16[j+8]=M,this.int16[j+9]=E,this.int16[j+10]=B,this.int16[j+11]=F,t}}sa.prototype.bytesPerElement=24,dt("StructArrayLayout4i4ui4i24",sa);class Wc extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,s,l)}emplace(t,s,l,d){const g=3*t;return this.float32[g+0]=s,this.float32[g+1]=l,this.float32[g+2]=d,t}}Wc.prototype.bytesPerElement=12,dt("StructArrayLayout3f12",Wc);class ys extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.uint32[1*t+0]=s,t}}ys.prototype.bytesPerElement=4,dt("StructArrayLayout1ul4",ys);class Bi extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_,x,S,k){const M=this.length;return this.resize(M+1),this.emplace(M,t,s,l,d,g,_,x,S,k)}emplace(t,s,l,d,g,_,x,S,k,M){const E=10*t,B=5*t;return this.int16[E+0]=s,this.int16[E+1]=l,this.int16[E+2]=d,this.int16[E+3]=g,this.int16[E+4]=_,this.int16[E+5]=x,this.uint32[B+3]=S,this.uint16[E+8]=k,this.uint16[E+9]=M,t}}Bi.prototype.bytesPerElement=20,dt("StructArrayLayout6i1ul2ui20",Bi);class Hc extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,t,s,l,d,g,_)}emplace(t,s,l,d,g,_,x){const S=6*t;return this.int16[S+0]=s,this.int16[S+1]=l,this.int16[S+2]=d,this.int16[S+3]=g,this.int16[S+4]=_,this.int16[S+5]=x,t}}Hc.prototype.bytesPerElement=12,dt("StructArrayLayout2i2i2i12",Hc);class fl extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,s,l,d,g)}emplace(t,s,l,d,g,_){const x=4*t,S=8*t;return this.float32[x+0]=s,this.float32[x+1]=l,this.float32[x+2]=d,this.int16[S+6]=g,this.int16[S+7]=_,t}}fl.prototype.bytesPerElement=16,dt("StructArrayLayout2f1f2i16",fl);class $i extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,t,s,l,d,g,_)}emplace(t,s,l,d,g,_,x){const S=16*t,k=4*t,M=8*t;return this.uint8[S+0]=s,this.uint8[S+1]=l,this.float32[k+1]=d,this.float32[k+2]=g,this.int16[M+6]=_,this.int16[M+7]=x,t}}$i.prototype.bytesPerElement=16,dt("StructArrayLayout2ub2f2i16",$i);class pl extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,s,l)}emplace(t,s,l,d){const g=3*t;return this.uint16[g+0]=s,this.uint16[g+1]=l,this.uint16[g+2]=d,t}}pl.prototype.bytesPerElement=6,dt("StructArrayLayout3ui6",pl);class Xc extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_,x,S,k,M,E,B,F,j,Z,X,ee){const de=this.length;return this.resize(de+1),this.emplace(de,t,s,l,d,g,_,x,S,k,M,E,B,F,j,Z,X,ee)}emplace(t,s,l,d,g,_,x,S,k,M,E,B,F,j,Z,X,ee,de){const ne=24*t,O=12*t,H=48*t;return this.int16[ne+0]=s,this.int16[ne+1]=l,this.uint16[ne+2]=d,this.uint16[ne+3]=g,this.uint32[O+2]=_,this.uint32[O+3]=x,this.uint32[O+4]=S,this.uint16[ne+10]=k,this.uint16[ne+11]=M,this.uint16[ne+12]=E,this.float32[O+7]=B,this.float32[O+8]=F,this.uint8[H+36]=j,this.uint8[H+37]=Z,this.uint8[H+38]=X,this.uint32[O+10]=ee,this.int16[ne+22]=de,t}}Xc.prototype.bytesPerElement=48,dt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Xc);class ml extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_,x,S,k,M,E,B,F,j,Z,X,ee,de,ne,O,H,oe,Ce,Ve,ke,Ae,Ye,Ze){const Je=this.length;return this.resize(Je+1),this.emplace(Je,t,s,l,d,g,_,x,S,k,M,E,B,F,j,Z,X,ee,de,ne,O,H,oe,Ce,Ve,ke,Ae,Ye,Ze)}emplace(t,s,l,d,g,_,x,S,k,M,E,B,F,j,Z,X,ee,de,ne,O,H,oe,Ce,Ve,ke,Ae,Ye,Ze,Je){const Be=32*t,pt=16*t;return this.int16[Be+0]=s,this.int16[Be+1]=l,this.int16[Be+2]=d,this.int16[Be+3]=g,this.int16[Be+4]=_,this.int16[Be+5]=x,this.int16[Be+6]=S,this.int16[Be+7]=k,this.uint16[Be+8]=M,this.uint16[Be+9]=E,this.uint16[Be+10]=B,this.uint16[Be+11]=F,this.uint16[Be+12]=j,this.uint16[Be+13]=Z,this.uint16[Be+14]=X,this.uint16[Be+15]=ee,this.uint16[Be+16]=de,this.uint16[Be+17]=ne,this.uint16[Be+18]=O,this.uint16[Be+19]=H,this.uint16[Be+20]=oe,this.uint16[Be+21]=Ce,this.uint16[Be+22]=Ve,this.uint32[pt+12]=ke,this.float32[pt+13]=Ae,this.float32[pt+14]=Ye,this.uint16[Be+30]=Ze,this.uint16[Be+31]=Je,t}}ml.prototype.bytesPerElement=64,dt("StructArrayLayout8i15ui1ul2f2ui64",ml);class gl extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.float32[1*t+0]=s,t}}gl.prototype.bytesPerElement=4,dt("StructArrayLayout1f4",gl);class p extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,s,l)}emplace(t,s,l,d){const g=3*t;return this.uint16[6*t+0]=s,this.float32[g+1]=l,this.float32[g+2]=d,t}}p.prototype.bytesPerElement=12,dt("StructArrayLayout1ui2f12",p);class e extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,s,l)}emplace(t,s,l,d){const g=4*t;return this.uint32[2*t+0]=s,this.uint16[g+2]=l,this.uint16[g+3]=d,t}}e.prototype.bytesPerElement=8,dt("StructArrayLayout1ul2ui8",e);class o extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s){const l=this.length;return this.resize(l+1),this.emplace(l,t,s)}emplace(t,s,l){const d=2*t;return this.uint16[d+0]=s,this.uint16[d+1]=l,t}}o.prototype.bytesPerElement=4,dt("StructArrayLayout2ui4",o);class c extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.uint16[1*t+0]=s,t}}c.prototype.bytesPerElement=2,dt("StructArrayLayout1ui2",c);class h extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,l,d){const g=this.length;return this.resize(g+1),this.emplace(g,t,s,l,d)}emplace(t,s,l,d,g){const _=4*t;return this.float32[_+0]=s,this.float32[_+1]=l,this.float32[_+2]=d,this.float32[_+3]=g,t}}h.prototype.bytesPerElement=16,dt("StructArrayLayout4f16",h);class m extends Lo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ie(this.anchorPointX,this.anchorPointY)}}m.prototype.size=20;class v extends Bi{get(t){return new m(this,t)}}dt("CollisionBoxArray",v);class w extends Lo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}w.prototype.size=48;class T extends Xc{get(t){return new w(this,t)}}dt("PlacedSymbolArray",T);class P extends Lo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}P.prototype.size=64;class A extends ml{get(t){return new P(this,t)}}dt("SymbolInstanceArray",A);class D extends gl{getoffsetX(t){return this.float32[1*t+0]}}dt("GlyphOffsetArray",D);class L extends ul{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}dt("SymbolLineVertexArray",L);class U extends Lo{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}U.prototype.size=12;class G extends p{get(t){return new U(this,t)}}dt("TextAnchorOffsetArray",G);class J extends Lo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}J.prototype.size=8;class K extends e{get(t){return new J(this,t)}}dt("FeatureIndexArray",K);class Q extends _s{}class re extends _s{}class se extends _s{}class le extends Wo{}class ue extends hl{}class fe extends Li{}class he extends dl{}class we extends sa{}class Se extends Wc{}class Re extends ys{}class Le extends Hc{}class ze extends $i{}class rt extends pl{}class et extends o{}const Ue=Zr([{name:"a_pos",components:2,type:"Int16"}],4),{members:yt}=Ue;class Ct{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,s,l,d){const g=this.segments[this.segments.length-1];return t>Ct.MAX_VERTEX_ARRAY_LENGTH&&Jr(`Max vertices per segment is ${Ct.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Ct.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!g||g.vertexLength+t>Ct.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==d?this.createNewSegment(s,l,d):g}createNewSegment(t,s,l){const d={vertexOffset:t.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0,vaos:{}};return l!==void 0&&(d.sortKey=l),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(d),d}getOrCreateLatestSegment(t,s,l){return this.prepareSegment(0,t,s,l)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const s in t.vaos)t.vaos[s].destroy()}static simpleSegment(t,s,l,d){return new Ct([{vertexOffset:t,primitiveOffset:s,vertexLength:l,primitiveLength:d,vaos:{},sortKey:0}])}}function rr(i,t){return 256*(i=Mr(Math.floor(i),0,255))+Mr(Math.floor(t),0,255)}Ct.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dt("SegmentVector",Ct);const gr=Zr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ur,kr,xr,or={exports:{}},hr={exports:{}},dn={exports:{}},fn=function(){if(xr)return or.exports;xr=1;var i=(ur||(ur=1,hr.exports=function(s,l){var d,g,_,x,S,k,M,E;for(g=s.length-(d=3&s.length),_=l,S=3432918353,k=461845907,E=0;E<g;)M=255&s.charCodeAt(E)|(255&s.charCodeAt(++E))<<8|(255&s.charCodeAt(++E))<<16|(255&s.charCodeAt(++E))<<24,++E,_=27492+(65535&(x=5*(65535&(_=(_^=M=(65535&(M=(M=(65535&M)*S+(((M>>>16)*S&65535)<<16)&4294967295)<<15|M>>>17))*k+(((M>>>16)*k&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(M=0,d){case 3:M^=(255&s.charCodeAt(E+2))<<16;case 2:M^=(255&s.charCodeAt(E+1))<<8;case 1:_^=M=(65535&(M=(M=(65535&(M^=255&s.charCodeAt(E)))*S+(((M>>>16)*S&65535)<<16)&4294967295)<<15|M>>>17))*k+(((M>>>16)*k&65535)<<16)&4294967295}return _^=s.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),hr.exports),t=(kr||(kr=1,dn.exports=function(s,l){for(var d,g=s.length,_=l^g,x=0;g>=4;)d=1540483477*(65535&(d=255&s.charCodeAt(x)|(255&s.charCodeAt(++x))<<8|(255&s.charCodeAt(++x))<<16|(255&s.charCodeAt(++x))<<24))+((1540483477*(d>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),g-=4,++x;switch(g){case 3:_^=(255&s.charCodeAt(x+2))<<16;case 2:_^=(255&s.charCodeAt(x+1))<<8;case 1:_=1540483477*(65535&(_^=255&s.charCodeAt(x)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),dn.exports);return or.exports=i,or.exports.murmur3=i,or.exports.murmur2=t,or.exports}(),en=I(fn);class bn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,s,l,d){this.ids.push(di(t)),this.positions.push(s,l,d)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=di(t);let l=0,d=this.ids.length-1;for(;l<d;){const _=l+d>>1;this.ids[_]>=s?d=_:l=_+1}const g=[];for(;this.ids[l]===s;)g.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return g}static serialize(t,s){const l=new Float64Array(t.ids),d=new Uint32Array(t.positions);return Ho(l,d,0,l.length-1),s&&s.push(l.buffer,d.buffer),{ids:l,positions:d}}static deserialize(t){const s=new bn;return s.ids=t.ids,s.positions=t.positions,s.indexed=!0,s}}function di(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:en(String(i))}function Ho(i,t,s,l){for(;s<l;){const d=i[s+l>>1];let g=s-1,_=l+1;for(;;){do g++;while(i[g]<d);do _--;while(i[_]>d);if(g>=_)break;Bo(i,g,_),Bo(t,3*g,3*_),Bo(t,3*g+1,3*_+1),Bo(t,3*g+2,3*_+2)}_-s<l-_?(Ho(i,t,s,_),s=_+1):(Ho(i,t,_+1,l),l=_)}}function Bo(i,t,s){const l=i[t];i[t]=i[s],i[s]=l}dt("FeaturePositionMap",bn);class mo{constructor(t,s){this.gl=t.gl,this.location=s}}class Oi extends mo{constructor(t,s){super(t,s),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class aa extends mo{constructor(t,s){super(t,s),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Fi extends mo{constructor(t,s){super(t,s),this.current=Qt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const go=new Float32Array(16);function $o(i){return[rr(255*i.r,255*i.g),rr(255*i.b,255*i.a)]}class To{constructor(t,s,l){this.value=t,this.uniformNames=s.map(d=>`u_${d}`),this.type=l}setUniform(t,s,l){t.set(l.constantOr(this.value))}getBinding(t,s,l){return this.type==="color"?new Fi(t,s):new Oi(t,s)}}class Oo{constructor(t,s){this.uniformNames=s.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=t.tlbr}setUniform(t,s,l,d){const g=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&t.set(g)}getBinding(t,s,l){return l.substr(0,9)==="u_pattern"?new aa(t,s):new Oi(t,s)}}class _r{constructor(t,s,l,d){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=s.map(g=>({name:`a_${g}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(t,s,l,d,g){const _=this.paintVertexArray.length,x=this.expression.evaluate(new Tr(0),s,{},d,[],g);this.paintVertexArray.resize(t),this._setPaintValue(_,t,x)}updatePaintArray(t,s,l,d){const g=this.expression.evaluate({zoom:0},l,d);this._setPaintValue(t,s,g)}_setPaintValue(t,s,l){if(this.type==="color"){const d=$o(l);for(let g=t;g<s;g++)this.paintVertexArray.emplace(g,d[0],d[1])}else{for(let d=t;d<s;d++)this.paintVertexArray.emplace(d,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class pr{constructor(t,s,l,d,g,_){this.expression=t,this.uniformNames=s.map(x=>`u_${x}_t`),this.type=l,this.useIntegerZoom=d,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=s.map(x=>({name:`a_${x}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,s,l,d,g){const _=this.expression.evaluate(new Tr(this.zoom),s,{},d,[],g),x=this.expression.evaluate(new Tr(this.zoom+1),s,{},d,[],g),S=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(S,t,_,x)}updatePaintArray(t,s,l,d){const g=this.expression.evaluate({zoom:this.zoom},l,d),_=this.expression.evaluate({zoom:this.zoom+1},l,d);this._setPaintValue(t,s,g,_)}_setPaintValue(t,s,l,d){if(this.type==="color"){const g=$o(l),_=$o(d);for(let x=t;x<s;x++)this.paintVertexArray.emplace(x,g[0],g[1],_[0],_[1])}else{for(let g=t;g<s;g++)this.paintVertexArray.emplace(g,l,d);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,s){const l=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,d=Mr(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);t.set(d)}getBinding(t,s,l){return new Oi(t,s)}}class tn{constructor(t,s,l,d,g,_){this.expression=t,this.type=s,this.useIntegerZoom=l,this.zoom=d,this.layerId=_,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(t,s,l){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(d,t,s.patterns&&s.patterns[this.layerId],l)}updatePaintArray(t,s,l,d,g){this._setPaintValues(t,s,l.patterns&&l.patterns[this.layerId],g)}_setPaintValues(t,s,l,d){if(!d||!l)return;const{min:g,mid:_,max:x}=l,S=d[g],k=d[_],M=d[x];if(S&&k&&M)for(let E=t;E<s;E++)this.zoomInPaintVertexArray.emplace(E,k.tl[0],k.tl[1],k.br[0],k.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],k.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(E,k.tl[0],k.tl[1],k.br[0],k.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],k.pixelRatio,M.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,gr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,gr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class rn{constructor(t,s,l){this.binders={},this._buffers=[];const d=[];for(const g in t.paint._values){if(!l(g))continue;const _=t.paint.get(g);if(!(_ instanceof po&&cs(_.property.specification)))continue;const x=Gf(g,t.type),S=_.value,k=_.property.specification.type,M=_.property.useIntegerZoom,E=_.property.specification["property-type"],B=E==="cross-faded"||E==="cross-faded-data-driven";if(S.kind==="constant")this.binders[g]=B?new Oo(S.value,x):new To(S.value,x,k),d.push(`/u_${g}`);else if(S.kind==="source"||B){const F=Kh(g,k,"source");this.binders[g]=B?new tn(S,k,M,s,F,t.id):new _r(S,x,k,F),d.push(`/a_${g}`)}else{const F=Kh(g,k,"composite");this.binders[g]=new pr(S,x,k,M,s,F),d.push(`/z_${g}`)}}this.cacheKey=d.sort().join("")}getMaxValue(t){const s=this.binders[t];return s instanceof _r||s instanceof pr?s.maxValue:0}populatePaintArrays(t,s,l,d,g){for(const _ in this.binders){const x=this.binders[_];(x instanceof _r||x instanceof pr||x instanceof tn)&&x.populatePaintArray(t,s,l,d,g)}}setConstantPatternPositions(t,s){for(const l in this.binders){const d=this.binders[l];d instanceof Oo&&d.setConstantPatternPositions(t,s)}}updatePaintArrays(t,s,l,d,g){let _=!1;for(const x in t){const S=s.getPositions(x);for(const k of S){const M=l.feature(k.index);for(const E in this.binders){const B=this.binders[E];if((B instanceof _r||B instanceof pr||B instanceof tn)&&B.expression.isStateDependent===!0){const F=d.paint.get(E);B.expression=F.value,B.updatePaintArray(k.start,k.end,M,t[x],g),_=!0}}}}return _}defines(){const t=[];for(const s in this.binders){const l=this.binders[s];(l instanceof To||l instanceof Oo)&&t.push(...l.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return t}getBinderAttributes(){const t=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof _r||l instanceof pr)for(let d=0;d<l.paintVertexAttributes.length;d++)t.push(l.paintVertexAttributes[d].name);else if(l instanceof tn)for(let d=0;d<gr.members.length;d++)t.push(gr.members[d].name)}return t}getBinderUniforms(){const t=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof To||l instanceof Oo||l instanceof pr)for(const d of l.uniformNames)t.push(d)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,s){const l=[];for(const d in this.binders){const g=this.binders[d];if(g instanceof To||g instanceof Oo||g instanceof pr){for(const _ of g.uniformNames)if(s[_]){const x=g.getBinding(t,s[_],_);l.push({name:_,property:d,binding:x})}}}return l}setUniforms(t,s,l,d){for(const{name:g,property:_,binding:x}of s)this.binders[_].setUniform(x,d,l.get(_),g)}updatePaintBuffers(t){this._buffers=[];for(const s in this.binders){const l=this.binders[s];if(t&&l instanceof tn){const d=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(l instanceof _r||l instanceof pr)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(const s in this.binders){const l=this.binders[s];(l instanceof _r||l instanceof pr||l instanceof tn)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const s=this.binders[t];(s instanceof _r||s instanceof pr||s instanceof tn)&&s.destroy()}}}class ji{constructor(t,s,l=()=>!0){this.programConfigurations={};for(const d of t)this.programConfigurations[d.id]=new rn(d,s,l);this.needsUpload=!1,this._featureMap=new bn,this._bufferOffset=0}populatePaintArrays(t,s,l,d,g,_){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(t,s,d,g,_);s.id!==void 0&&this._featureMap.add(s.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,s,l,d){for(const g of l)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,s,g,d)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Gf(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function Kh(i,t,s){const l={color:{source:Li,composite:h},number:{source:gl,composite:Li}},d=function(g){return{"line-pattern":{source:he,composite:he},"fill-pattern":{source:he,composite:he},"fill-extrusion-pattern":{source:he,composite:he}}[g]}(i);return d&&d[s]||l[t][s]}dt("ConstantBinder",To),dt("CrossFadedConstantBinder",Oo),dt("SourceExpressionBinder",_r),dt("CrossFadedCompositeBinder",tn),dt("CompositeExpressionBinder",pr),dt("ProgramConfiguration",rn,{omit:["_buffers"]}),dt("ProgramConfigurationSet",ji);const Yc=Math.pow(2,14)-1,Jh=-Yc-1;function Ni(i){const t=ft/i.extent,s=i.loadGeometry();for(let l=0;l<s.length;l++){const d=s[l];for(let g=0;g<d.length;g++){const _=d[g],x=Math.round(_.x*t),S=Math.round(_.y*t);_.x=Mr(x,Jh,Yc),_.y=Mr(S,Jh,Yc),(x<_.x||x>_.x+1||S<_.y||S>_.y+1)&&Jr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function Yn(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?Ni(i):[]}}const Kc=-32768;function Qh(i,t,s,l,d){i.emplaceBack(Kc+8*t+l,Kc+8*s+d)}class _l{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new re,this.indexArray=new rt,this.segments=new Ct,this.programConfigurations=new ji(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,l){const d=this.layers[0],g=[];let _=null,x=!1,S=d.type==="heatmap";if(d.type==="circle"){const M=d;_=M.layout.get("circle-sort-key"),x=!_.isConstant(),S=S||M.paint.get("circle-pitch-alignment")==="map"}const k=S?s.subdivisionGranularity.circle:1;for(const{feature:M,id:E,index:B,sourceLayerIndex:F}of t){const j=this.layers[0]._featureFilter.needGeometry,Z=Yn(M,j);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom),Z,l))continue;const X=x?_.evaluate(Z,{},l):void 0,ee={id:E,properties:M.properties,type:M.type,sourceLayerIndex:F,index:B,geometry:j?Z.geometry:Ni(M),patterns:{},sortKey:X};g.push(ee)}x&&g.sort((M,E)=>M.sortKey-E.sortKey);for(const M of g){const{geometry:E,index:B,sourceLayerIndex:F}=M,j=t[B].feature;this.addFeature(M,E,B,l,k),s.featureIndex.insert(j,E,B,F,this.index)}}update(t,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,yt),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,s,l,d,g=1){let _;switch(g){case 1:_=[0,7];break;case 3:_=[0,2,5,7];break;case 5:_=[0,1,3,4,6,7];break;case 7:_=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${g}; valid values are 1, 3, 5, 7.`)}const x=_.length;for(const S of s)for(const k of S){const M=k.x,E=k.y;if(M<0||M>=ft||E<0||E>=ft)continue;const B=this.segments.prepareSegment(x*x,this.layoutVertexArray,this.indexArray,t.sortKey),F=B.vertexLength;for(let j=0;j<x;j++)for(let Z=0;Z<x;Z++)Qh(this.layoutVertexArray,M,E,_[Z],_[j]);for(let j=0;j<x-1;j++)for(let Z=0;Z<x-1;Z++){const X=F+j*x+Z,ee=F+(j+1)*x+Z;this.indexArray.emplaceBack(X,ee+1,X+1),this.indexArray.emplaceBack(X,ee,ee+1)}B.vertexLength+=x*x,B.primitiveLength+=(x-1)*(x-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},d)}}function yl(i,t){for(let s=0;s<i.length;s++)if(bl(t,i[s]))return!0;for(let s=0;s<t.length;s++)if(bl(i,t[s]))return!0;return!!qf(i,t)}function ed(i,t,s){return!!bl(i,t)||!!Wf(t,i,s)}function vl(i,t){if(i.length===1)return sg(t,i[0]);for(let s=0;s<t.length;s++){const l=t[s];for(let d=0;d<l.length;d++)if(bl(i,l[d]))return!0}for(let s=0;s<i.length;s++)if(sg(t,i[s]))return!0;for(let s=0;s<t.length;s++)if(qf(i,t[s]))return!0;return!1}function tx(i,t,s){if(i.length>1){if(qf(i,t))return!0;for(let l=0;l<t.length;l++)if(Wf(t[l],i,s))return!0}for(let l=0;l<i.length;l++)if(Wf(i[l],t,s))return!0;return!1}function qf(i,t){if(i.length===0||t.length===0)return!1;for(let s=0;s<i.length-1;s++){const l=i[s],d=i[s+1];for(let g=0;g<t.length-1;g++)if(rx(l,d,t[g],t[g+1]))return!0}return!1}function rx(i,t,s,l){return ae(i,s,l)!==ae(t,s,l)&&ae(i,t,s)!==ae(i,t,l)}function Wf(i,t,s){const l=s*s;if(t.length===1)return i.distSqr(t[0])<l;for(let d=1;d<t.length;d++)if(ig(i,t[d-1],t[d])<l)return!0;return!1}function ig(i,t,s){const l=t.distSqr(s);if(l===0)return i.distSqr(t);const d=((i.x-t.x)*(s.x-t.x)+(i.y-t.y)*(s.y-t.y))/l;return i.distSqr(d<0?t:d>1?s:s.sub(t)._mult(d)._add(t))}function sg(i,t){let s,l,d,g=!1;for(let _=0;_<i.length;_++){s=i[_];for(let x=0,S=s.length-1;x<s.length;S=x++)l=s[x],d=s[S],l.y>t.y!=d.y>t.y&&t.x<(d.x-l.x)*(t.y-l.y)/(d.y-l.y)+l.x&&(g=!g)}return g}function bl(i,t){let s=!1;for(let l=0,d=i.length-1;l<i.length;d=l++){const g=i[l],_=i[d];g.y>t.y!=_.y>t.y&&t.x<(_.x-g.x)*(t.y-g.y)/(_.y-g.y)+g.x&&(s=!s)}return s}function nx(i,t,s){const l=s[0],d=s[2];if(i.x<l.x&&t.x<l.x||i.x>d.x&&t.x>d.x||i.y<l.y&&t.y<l.y||i.y>d.y&&t.y>d.y)return!1;const g=ae(i,t,s[0]);return g!==ae(i,t,s[1])||g!==ae(i,t,s[2])||g!==ae(i,t,s[3])}function Jc(i,t,s){const l=t.paint.get(i).value;return l.kind==="constant"?l.value:s.programConfigurations.get(t.id).getMaxValue(i)}function td(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function rd(i,t,s,l,d){if(!t[0]&&!t[1])return i;const g=ie.convert(t)._mult(d);s==="viewport"&&g._rotate(-l);const _=[];for(let x=0;x<i.length;x++)_.push(i[x].sub(g));return _}let ag,lg;dt("CircleBucket",_l,{omit:["layers"]});var ox={get paint(){return lg=lg||new jn({"circle-radius":new Et(z.paint_circle["circle-radius"]),"circle-color":new Et(z.paint_circle["circle-color"]),"circle-blur":new Et(z.paint_circle["circle-blur"]),"circle-opacity":new Et(z.paint_circle["circle-opacity"]),"circle-translate":new wt(z.paint_circle["circle-translate"]),"circle-translate-anchor":new wt(z.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wt(z.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wt(z.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Et(z.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Et(z.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Et(z.paint_circle["circle-stroke-opacity"])})},get layout(){return ag=ag||new jn({"circle-sort-key":new Et(z.layout_circle["circle-sort-key"])})}};class ix extends Do{constructor(t){super(t,ox)}createBucket(t){return new _l(t)}queryRadius(t){const s=t;return Jc("circle-radius",this,s)+Jc("circle-stroke-width",this,s)+td(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:s,featureState:l,geometry:d,transform:g,pixelsToTileUnits:_,pixelPosMatrix:x}){const S=rd(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-g.bearingInRadians,_),k=this.paint.get("circle-radius").evaluate(s,l)+this.paint.get("circle-stroke-width").evaluate(s,l),M=this.paint.get("circle-pitch-alignment")==="map",E=M?S:function(F,j){return F.map(Z=>cg(Z,j))}(S,x),B=M?k*_:k;for(const F of d)for(const j of F){const Z=M?j:cg(j,x);let X=B;const ee=Me([],[j.x,j.y,0,1],x);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?X*=ee[3]/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(X*=g.cameraToCenterDistance/ee[3]),ed(E,Z,X))return!0}return!1}}function cg(i,t){const s=Me([],[i.x,i.y,0,1],t);return new ie(s[0]/s[3],s[1]/s[3])}class ug extends _l{}let hg;dt("HeatmapBucket",ug,{omit:["layers"]});var sx={get paint(){return hg=hg||new jn({"heatmap-radius":new Et(z.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Et(z.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wt(z.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Gc(z.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wt(z.paint_heatmap["heatmap-opacity"])})}};function Hf(i,{width:t,height:s},l,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==t*s*l)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${t*s*l}`)}else d=new Uint8Array(t*s*l);return i.width=t,i.height=s,i.data=d,i}function dg(i,{width:t,height:s},l){if(t===i.width&&s===i.height)return;const d=Hf({},{width:t,height:s},l);Xf(i,d,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,s)},l),i.width=t,i.height=s,i.data=d.data}function Xf(i,t,s,l,d,g){if(d.width===0||d.height===0)return t;if(d.width>i.width||d.height>i.height||s.x>i.width-d.width||s.y>i.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||l.x>t.width-d.width||l.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const _=i.data,x=t.data;if(_===x)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<d.height;S++){const k=((s.y+S)*i.width+s.x)*g,M=((l.y+S)*t.width+l.x)*g;for(let E=0;E<d.width*g;E++)x[M+E]=_[k+E]}return t}class Qc{constructor(t,s){Hf(this,t,1,s)}resize(t){dg(this,t,1)}clone(){return new Qc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,s,l,d,g){Xf(t,s,l,d,g,1)}}class ko{constructor(t,s){Hf(this,t,4,s)}resize(t){dg(this,t,4)}replace(t,s){s?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ko({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,s,l,d,g){Xf(t,s,l,d,g,4)}}function fg(i){const t={},s=i.resolution||256,l=i.clips?i.clips.length:1,d=i.image||new ko({width:s,height:l});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const g=(_,x,S)=>{t[i.evaluationKey]=S;const k=i.expression.evaluate(t);d.data[_+x+0]=Math.floor(255*k.r/k.a),d.data[_+x+1]=Math.floor(255*k.g/k.a),d.data[_+x+2]=Math.floor(255*k.b/k.a),d.data[_+x+3]=Math.floor(255*k.a)};if(i.clips)for(let _=0,x=0;_<l;++_,x+=4*s)for(let S=0,k=0;S<s;S++,k+=4){const M=S/(s-1),{start:E,end:B}=i.clips[_];g(x,k,E*(1-M)+B*M)}else for(let _=0,x=0;_<s;_++,x+=4)g(0,x,_/(s-1));return d}dt("AlphaImage",Qc),dt("RGBAImage",ko);const Yf="big-fb";class ax extends Do{createBucket(t){return new ug(t)}constructor(t){super(t,sx),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=fg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Yf)&&this.heatmapFbos.delete(Yf)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let pg;var lx={get paint(){return pg=pg||new jn({"hillshade-illumination-direction":new wt(z.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wt(z.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wt(z.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wt(z.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wt(z.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wt(z.paint_hillshade["hillshade-accent-color"])})}};class cx extends Do{constructor(t){super(t,lx)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const ux=Zr([{name:"a_pos",components:2,type:"Int16"}],4),{members:hx}=ux;function Kf(i,t,s){const l=s.patternDependencies;let d=!1;for(const g of t){const _=g.paint.get(`${i}-pattern`);_.isConstant()||(d=!0);const x=_.constantOr(null);x&&(d=!0,l[x.to]=!0,l[x.from]=!0)}return d}function Jf(i,t,s,l,d){const g=d.patternDependencies;for(const _ of t){const x=_.paint.get(`${i}-pattern`).value;if(x.kind!=="constant"){let S=x.evaluate({zoom:l-1},s,{},d.availableImages),k=x.evaluate({zoom:l},s,{},d.availableImages),M=x.evaluate({zoom:l+1},s,{},d.availableImages);S=S&&S.name?S.name:S,k=k&&k.name?k.name:k,M=M&&M.name?M.name:M,g[S]=!0,g[k]=!0,g[M]=!0,s.patterns[_.id]={min:S,mid:k,max:M}}}return s}function mg(i,t,s,l,d){let g;if(d===function(_,x,S,k){let M=0;for(let E=x,B=S-k;E<S;E+=k)M+=(_[B]-_[E])*(_[E+1]+_[B+1]),B=E;return M}(i,t,s,l)>0)for(let _=t;_<s;_+=l)g=vg(_/l|0,i[_],i[_+1],g);else for(let _=s-l;_>=t;_-=l)g=vg(_/l|0,i[_],i[_+1],g);return g&&xl(g,g.next)&&(nu(g),g=g.next),g}function la(i,t){if(!i)return i;t||(t=i);let s,l=i;do if(s=!1,l.steiner||!xl(l,l.next)&&Gr(l.prev,l,l.next)!==0)l=l.next;else{if(nu(l),l=t=l.prev,l===l.next)break;s=!0}while(s||l!==t);return t}function eu(i,t,s,l,d,g,_){if(!i)return;!_&&g&&function(S,k,M,E){let B=S;do B.z===0&&(B.z=Qf(B.x,B.y,k,M,E)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==S);B.prevZ.nextZ=null,B.prevZ=null,function(F){let j,Z=1;do{let X,ee=F;F=null;let de=null;for(j=0;ee;){j++;let ne=ee,O=0;for(let oe=0;oe<Z&&(O++,ne=ne.nextZ,ne);oe++);let H=Z;for(;O>0||H>0&&ne;)O!==0&&(H===0||!ne||ee.z<=ne.z)?(X=ee,ee=ee.nextZ,O--):(X=ne,ne=ne.nextZ,H--),de?de.nextZ=X:F=X,X.prevZ=de,de=X;ee=ne}de.nextZ=null,Z*=2}while(j>1)}(B)}(i,l,d,g);let x=i;for(;i.prev!==i.next;){const S=i.prev,k=i.next;if(g?fx(i,l,d,g):dx(i))t.push(S.i,i.i,k.i),nu(i),i=k.next,x=k.next;else if((i=k)===x){_?_===1?eu(i=px(la(i),t),t,s,l,d,g,2):_===2&&mx(i,t,s,l,d,g):eu(la(i),t,s,l,d,g,1);break}}}function dx(i){const t=i.prev,s=i,l=i.next;if(Gr(t,s,l)>=0)return!1;const d=t.x,g=s.x,_=l.x,x=t.y,S=s.y,k=l.y,M=Math.min(d,g,_),E=Math.min(x,S,k),B=Math.max(d,g,_),F=Math.max(x,S,k);let j=l.next;for(;j!==t;){if(j.x>=M&&j.x<=B&&j.y>=E&&j.y<=F&&tu(d,x,g,S,_,k,j.x,j.y)&&Gr(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function fx(i,t,s,l){const d=i.prev,g=i,_=i.next;if(Gr(d,g,_)>=0)return!1;const x=d.x,S=g.x,k=_.x,M=d.y,E=g.y,B=_.y,F=Math.min(x,S,k),j=Math.min(M,E,B),Z=Math.max(x,S,k),X=Math.max(M,E,B),ee=Qf(F,j,t,s,l),de=Qf(Z,X,t,s,l);let ne=i.prevZ,O=i.nextZ;for(;ne&&ne.z>=ee&&O&&O.z<=de;){if(ne.x>=F&&ne.x<=Z&&ne.y>=j&&ne.y<=X&&ne!==d&&ne!==_&&tu(x,M,S,E,k,B,ne.x,ne.y)&&Gr(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,O.x>=F&&O.x<=Z&&O.y>=j&&O.y<=X&&O!==d&&O!==_&&tu(x,M,S,E,k,B,O.x,O.y)&&Gr(O.prev,O,O.next)>=0))return!1;O=O.nextZ}for(;ne&&ne.z>=ee;){if(ne.x>=F&&ne.x<=Z&&ne.y>=j&&ne.y<=X&&ne!==d&&ne!==_&&tu(x,M,S,E,k,B,ne.x,ne.y)&&Gr(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;O&&O.z<=de;){if(O.x>=F&&O.x<=Z&&O.y>=j&&O.y<=X&&O!==d&&O!==_&&tu(x,M,S,E,k,B,O.x,O.y)&&Gr(O.prev,O,O.next)>=0)return!1;O=O.nextZ}return!0}function px(i,t){let s=i;do{const l=s.prev,d=s.next.next;!xl(l,d)&&_g(l,s,s.next,d)&&ru(l,d)&&ru(d,l)&&(t.push(l.i,s.i,d.i),nu(s),nu(s.next),s=i=d),s=s.next}while(s!==i);return la(s)}function mx(i,t,s,l,d,g){let _=i;do{let x=_.next.next;for(;x!==_.prev;){if(_.i!==x.i&&bx(_,x)){let S=yg(_,x);return _=la(_,_.next),S=la(S,S.next),eu(_,t,s,l,d,g,0),void eu(S,t,s,l,d,g,0)}x=x.next}_=_.next}while(_!==i)}function gx(i,t){let s=i.x-t.x;return s===0&&(s=i.y-t.y,s===0)&&(s=(i.next.y-i.y)/(i.next.x-i.x)-(t.next.y-t.y)/(t.next.x-t.x)),s}function _x(i,t){const s=function(d,g){let _=g;const x=d.x,S=d.y;let k,M=-1/0;if(xl(d,_))return _;do{if(xl(d,_.next))return _.next;if(S<=_.y&&S>=_.next.y&&_.next.y!==_.y){const Z=_.x+(S-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(Z<=x&&Z>M&&(M=Z,k=_.x<_.next.x?_:_.next,Z===x))return k}_=_.next}while(_!==g);if(!k)return null;const E=k,B=k.x,F=k.y;let j=1/0;_=k;do{if(x>=_.x&&_.x>=B&&x!==_.x&&gg(S<F?x:M,S,B,F,S<F?M:x,S,_.x,_.y)){const Z=Math.abs(S-_.y)/(x-_.x);ru(_,d)&&(Z<j||Z===j&&(_.x>k.x||_.x===k.x&&yx(k,_)))&&(k=_,j=Z)}_=_.next}while(_!==E);return k}(i,t);if(!s)return t;const l=yg(s,i);return la(l,l.next),la(s,s.next)}function yx(i,t){return Gr(i.prev,i,t.prev)<0&&Gr(t.next,i,i.next)<0}function Qf(i,t,s,l,d){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-s)*d|0)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*d|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function vx(i){let t=i,s=i;do(t.x<s.x||t.x===s.x&&t.y<s.y)&&(s=t),t=t.next;while(t!==i);return s}function gg(i,t,s,l,d,g,_,x){return(d-_)*(t-x)>=(i-_)*(g-x)&&(i-_)*(l-x)>=(s-_)*(t-x)&&(s-_)*(g-x)>=(d-_)*(l-x)}function tu(i,t,s,l,d,g,_,x){return!(i===_&&t===x)&&gg(i,t,s,l,d,g,_,x)}function bx(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(s,l){let d=s;do{if(d.i!==s.i&&d.next.i!==s.i&&d.i!==l.i&&d.next.i!==l.i&&_g(d,d.next,s,l))return!0;d=d.next}while(d!==s);return!1}(i,t)&&(ru(i,t)&&ru(t,i)&&function(s,l){let d=s,g=!1;const _=(s.x+l.x)/2,x=(s.y+l.y)/2;do d.y>x!=d.next.y>x&&d.next.y!==d.y&&_<(d.next.x-d.x)*(x-d.y)/(d.next.y-d.y)+d.x&&(g=!g),d=d.next;while(d!==s);return g}(i,t)&&(Gr(i.prev,i,t.prev)||Gr(i,t.prev,t))||xl(i,t)&&Gr(i.prev,i,i.next)>0&&Gr(t.prev,t,t.next)>0)}function Gr(i,t,s){return(t.y-i.y)*(s.x-t.x)-(t.x-i.x)*(s.y-t.y)}function xl(i,t){return i.x===t.x&&i.y===t.y}function _g(i,t,s,l){const d=od(Gr(i,t,s)),g=od(Gr(i,t,l)),_=od(Gr(s,l,i)),x=od(Gr(s,l,t));return d!==g&&_!==x||!(d!==0||!nd(i,s,t))||!(g!==0||!nd(i,l,t))||!(_!==0||!nd(s,i,l))||!(x!==0||!nd(s,t,l))}function nd(i,t,s){return t.x<=Math.max(i.x,s.x)&&t.x>=Math.min(i.x,s.x)&&t.y<=Math.max(i.y,s.y)&&t.y>=Math.min(i.y,s.y)}function od(i){return i>0?1:i<0?-1:0}function ru(i,t){return Gr(i.prev,i,i.next)<0?Gr(i,t,i.next)>=0&&Gr(i,i.prev,t)>=0:Gr(i,t,i.prev)<0||Gr(i,i.next,t)<0}function yg(i,t){const s=ep(i.i,i.x,i.y),l=ep(t.i,t.x,t.y),d=i.next,g=t.prev;return i.next=t,t.prev=i,s.next=d,d.prev=s,l.next=s,s.prev=l,g.next=l,l.prev=g,l}function vg(i,t,s,l){const d=ep(i,t,s);return l?(d.next=l.next,d.prev=l,l.next.prev=d,l.next=d):(d.prev=d,d.next=d),d}function nu(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function ep(i,t,s){return{i,x:t,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class wl{constructor(t,s){if(s>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=s}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class id{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}id.noSubdivision=new id({fill:new wl(0,0),line:new wl(0,0),tile:new wl(0,0),stencil:new wl(0,0),circle:1}),dt("SubdivisionGranularityExpression",wl),dt("SubdivisionGranularitySetting",id);const Cl=-32768,ou=32767;class xx{constructor(t,s){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=ft/t,this._canonical=s}_getKey(t,s){return(t+=32768)<<16|(s+=32768)<<0}_vertexToIndex(t,s){if(t<-32768||s<-32768||t>32767||s>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const l=0|Math.round(t),d=0|Math.round(s),g=this._getKey(l,d);if(this._vertexDictionary.has(g))return this._vertexDictionary.get(g);const _=this._vertexBuffer.length/2;return this._vertexDictionary.set(g,_),this._vertexBuffer.push(l,d),_}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(d,g){const _=[];for(let x=0;x<g.length;x+=3){const S=g[x],k=g[x+1],M=g[x+2],E=d[2*S],B=d[2*S+1];(d[2*k]-E)*(d[2*M+1]-B)-(d[2*k+1]-B)*(d[2*M]-E)>0?(_.push(S),_.push(M),_.push(k)):(_.push(S),_.push(k),_.push(M))}return _}(this._vertexBuffer,t);const s=[],l=t.length;for(let d=0;d<l;d+=3){const g=[t[d+0],t[d+1],t[d+2]],_=[this._vertexBuffer[2*t[d+0]+0],this._vertexBuffer[2*t[d+0]+1],this._vertexBuffer[2*t[d+1]+0],this._vertexBuffer[2*t[d+1]+1],this._vertexBuffer[2*t[d+2]+0],this._vertexBuffer[2*t[d+2]+1]];let x=1/0,S=1/0,k=-1/0,M=-1/0;for(let Z=0;Z<3;Z++){const X=_[2*Z],ee=_[2*Z+1];x=Math.min(x,X),k=Math.max(k,X),S=Math.min(S,ee),M=Math.max(M,ee)}if(x===k||S===M)continue;const E=Math.floor(x/this._granularityCellSize),B=Math.ceil(k/this._granularityCellSize),F=Math.floor(S/this._granularityCellSize),j=Math.ceil(M/this._granularityCellSize);if(E!==B||F!==j)for(let Z=F;Z<j;Z++){const X=this._scanlineGenerateVertexRingForCellRow(Z,_,g);wx(this._vertexBuffer,X,s)}else s.push(...g)}return s}_scanlineGenerateVertexRingForCellRow(t,s,l){const d=t*this._granularityCellSize,g=d+this._granularityCellSize,_=[];for(let x=0;x<3;x++){const S=s[2*x],k=s[2*x+1],M=s[2*(x+1)%6],E=s[(2*(x+1)+1)%6],B=s[2*(x+2)%6],F=s[(2*(x+2)+1)%6],j=M-S,Z=E-k,X=j===0,ee=Z===0,de=(d-k)/Z,ne=(g-k)/Z,O=Math.min(de,ne),H=Math.max(de,ne);if(!ee&&(O>=1||H<=0)||ee&&(k<d||k>g)){E>=d&&E<=g&&_.push(l[(x+1)%3]);continue}!ee&&O>0&&_.push(this._vertexToIndex(S+j*O,k+Z*O));const oe=S+j*Math.max(O,0),Ce=S+j*Math.min(H,1);X||this._generateIntraEdgeVertices(_,S,k,M,E,oe,Ce),!ee&&H<1&&_.push(this._vertexToIndex(S+j*H,k+Z*H)),(ee||E>=d&&E<=g)&&_.push(l[(x+1)%3]),!ee&&(E<=d||E>=g)&&this._generateInterEdgeVertices(_,S,k,M,E,B,F,Ce,d,g)}return _}_generateIntraEdgeVertices(t,s,l,d,g,_,x){const S=d-s,k=g-l,M=k===0,E=M?Math.min(s,d):Math.min(_,x),B=M?Math.max(s,d):Math.max(_,x),F=Math.floor(E/this._granularityCellSize)+1,j=Math.ceil(B/this._granularityCellSize)-1;if(M?s<d:_<x)for(let Z=F;Z<=j;Z++){const X=Z*this._granularityCellSize;t.push(this._vertexToIndex(X,l+k*(X-s)/S))}else for(let Z=j;Z>=F;Z--){const X=Z*this._granularityCellSize;t.push(this._vertexToIndex(X,l+k*(X-s)/S))}}_generateInterEdgeVertices(t,s,l,d,g,_,x,S,k,M){const E=g-l,B=_-d,F=x-g,j=(k-g)/F,Z=(M-g)/F,X=Math.min(j,Z),ee=Math.max(j,Z),de=d+B*X;let ne=Math.floor(Math.min(de,S)/this._granularityCellSize)+1,O=Math.ceil(Math.max(de,S)/this._granularityCellSize)-1,H=S<de;const oe=F===0;if(oe&&(x===k||x===M))return;if(oe||X>=1||ee<=0){const Ve=l-x,ke=_+(s-_)*Math.min((k-x)/Ve,(M-x)/Ve);ne=Math.floor(Math.min(ke,S)/this._granularityCellSize)+1,O=Math.ceil(Math.max(ke,S)/this._granularityCellSize)-1,H=S<ke}const Ce=E>0?M:k;if(H)for(let Ve=ne;Ve<=O;Ve++)t.push(this._vertexToIndex(Ve*this._granularityCellSize,Ce));else for(let Ve=O;Ve>=ne;Ve--)t.push(this._vertexToIndex(Ve*this._granularityCellSize,Ce))}_generateOutline(t){const s=[];for(const l of t){const d=ca(l,this._granularity,!0),g=this._pointArrayToIndices(d),_=[];for(let x=1;x<g.length;x++)_.push(g[x-1]),_.push(g[x]);s.push(_)}return s}_handlePoles(t){let s=!1,l=!1;this._canonical&&(this._canonical.y===0&&(s=!0),this._canonical.y===(1<<this._canonical.z)-1&&(l=!0)),(s||l)&&this._fillPoles(t,s,l)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let s=0;s<t.length;s+=2){const l=t[s+1];l===Cl&&(t[s+1]=-32767),l===ou&&(t[s+1]=32766)}}_generatePoleQuad(t,s,l,d,g,_){d>g!=(_===Cl)?(t.push(s),t.push(l),t.push(this._vertexToIndex(d,_)),t.push(l),t.push(this._vertexToIndex(g,_)),t.push(this._vertexToIndex(d,_))):(t.push(l),t.push(s),t.push(this._vertexToIndex(d,_)),t.push(this._vertexToIndex(g,_)),t.push(l),t.push(this._vertexToIndex(d,_)))}_fillPoles(t,s,l){const d=this._vertexBuffer,g=ft,_=t.length;for(let x=2;x<_;x+=3){const S=t[x-2],k=t[x-1],M=t[x],E=d[2*S],B=d[2*S+1],F=d[2*k],j=d[2*k+1],Z=d[2*M],X=d[2*M+1];s&&(B===0&&j===0&&this._generatePoleQuad(t,S,k,E,F,Cl),j===0&&X===0&&this._generatePoleQuad(t,k,M,F,Z,Cl),X===0&&B===0&&this._generatePoleQuad(t,M,S,Z,E,Cl)),l&&(B===g&&j===g&&this._generatePoleQuad(t,S,k,E,F,ou),j===g&&X===g&&this._generatePoleQuad(t,k,M,F,Z,ou),X===g&&B===g&&this._generatePoleQuad(t,M,S,Z,E,ou))}}_initializeVertices(t){for(let s=0;s<t.length;s+=2)this._vertexToIndex(t[s],t[s+1])}subdividePolygonInternal(t,s){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:l,holeIndices:d}=function(x){const S=[],k=[];for(const M of x)if(M.length!==0){M!==x[0]&&S.push(k.length/2);for(let E=0;E<M.length;E++)k.push(M[E].x),k.push(M[E].y)}return{flattened:k,holeIndices:S}}(t);let g;this._initializeVertices(l);try{const x=function(k,M,E=2){const B=M&&M.length,F=B?M[0]*E:k.length;let j=mg(k,0,F,E,!0);const Z=[];if(!j||j.next===j.prev)return Z;let X,ee,de;if(B&&(j=function(ne,O,H,oe){const Ce=[];for(let Ve=0,ke=O.length;Ve<ke;Ve++){const Ae=mg(ne,O[Ve]*oe,Ve<ke-1?O[Ve+1]*oe:ne.length,oe,!1);Ae===Ae.next&&(Ae.steiner=!0),Ce.push(vx(Ae))}Ce.sort(gx);for(let Ve=0;Ve<Ce.length;Ve++)H=_x(Ce[Ve],H);return H}(k,M,j,E)),k.length>80*E){X=1/0,ee=1/0;let ne=-1/0,O=-1/0;for(let H=E;H<F;H+=E){const oe=k[H],Ce=k[H+1];oe<X&&(X=oe),Ce<ee&&(ee=Ce),oe>ne&&(ne=oe),Ce>O&&(O=Ce)}de=Math.max(ne-X,O-ee),de=de!==0?32767/de:0}return eu(j,Z,E,X,ee,de,0),Z}(l,d),S=this._convertIndices(l,x);g=this._subdivideTrianglesScanline(S)}catch(x){console.error(x)}let _=[];return s&&(_=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(g),{verticesFlattened:this._vertexBuffer,indicesTriangles:g,indicesLineList:_}}_convertIndices(t,s){const l=[];for(let d=0;d<s.length;d++)l.push(this._vertexToIndex(t[2*s[d]],t[2*s[d]+1]));return l}_pointArrayToIndices(t){const s=[];for(let l=0;l<t.length;l++){const d=t[l];s.push(this._vertexToIndex(d.x,d.y))}return s}}function bg(i,t,s,l=!0){return new xx(s,t).subdividePolygonInternal(i,l)}function ca(i,t,s=!1){if(!i||i.length<1)return[];if(i.length<2)return[];const l=i[0],d=i[i.length-1],g=s&&(l.x!==d.x||l.y!==d.y);if(t<2)return g?[...i,i[0]]:[...i];const _=Math.floor(ft/t),x=[];x.push(new ie(i[0].x,i[0].y));const S=i.length,k=g?S:S-1;for(let M=0;M<k;M++){const E=i[M],B=M<S-1?i[M+1]:i[0],F=E.x,j=E.y,Z=B.x,X=B.y,ee=F!==Z,de=j!==X;if(!ee&&!de)continue;const ne=Z-F,O=X-j,H=Math.abs(ne),oe=Math.abs(O);let Ce=F,Ve=j;for(;;){const Ae=ne>0?(Math.floor(Ce/_)+1)*_:(Math.ceil(Ce/_)-1)*_,Ye=O>0?(Math.floor(Ve/_)+1)*_:(Math.ceil(Ve/_)-1)*_,Ze=Math.abs(Ce-Ae),Je=Math.abs(Ve-Ye),Be=Math.abs(Ce-Z),pt=Math.abs(Ve-X),Mt=ee?Ze/H:Number.POSITIVE_INFINITY,kt=de?Je/oe:Number.POSITIVE_INFINITY;if((Be<=Ze||!ee)&&(pt<=Je||!de))break;if(Mt<kt&&ee||!de){Ce=Ae,Ve+=O*Mt;const vt=new ie(Ce,Math.round(Ve));x[x.length-1].x===vt.x&&x[x.length-1].y===vt.y||x.push(vt)}else{Ce+=ne*kt,Ve=Ye;const vt=new ie(Math.round(Ce),Ve);x[x.length-1].x===vt.x&&x[x.length-1].y===vt.y||x.push(vt)}}const ke=new ie(Z,X);x[x.length-1].x===ke.x&&x[x.length-1].y===ke.y||x.push(ke)}return x}function wx(i,t,s){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let l=0,d=i[2*t[0]];for(let S=1;S<t.length;S++){const k=i[2*t[S]];k<d&&(d=k,l=S)}const g=t.length;let _=l,x=(_+1)%g;for(;;){const S=_-1>=0?_-1:g-1,k=(x+1)%g,M=i[2*t[S]],E=i[2*t[k]],B=i[2*t[_]],F=i[2*t[_]+1],j=i[2*t[x]+1];let Z=!1;if(M<E)Z=!0;else if(M>E)Z=!1;else{const X=j-F,ee=-(i[2*t[x]]-B),de=F<j?1:-1;((M-B)*X+(i[2*t[S]+1]-F)*ee)*de>((E-B)*X+(i[2*t[k]+1]-F)*ee)*de&&(Z=!0)}if(Z){const X=t[S],ee=t[_],de=t[x];X!==ee&&X!==de&&ee!==de&&s.push(de,ee,X),_--,_<0&&(_=g-1)}else{const X=t[k],ee=t[_],de=t[x];X!==ee&&X!==de&&ee!==de&&s.push(de,ee,X),x++,x>=g&&(x=0)}if(S===k)break}}function xg(i,t,s,l,d,g,_,x,S){const k=d.length/2,M=_&&x&&S;if(k<Ct.MAX_VERTEX_ARRAY_LENGTH){const E=t.prepareSegment(k,s,l),B=E.vertexLength;for(let Z=0;Z<g.length;Z+=3)l.emplaceBack(B+g[Z],B+g[Z+1],B+g[Z+2]);let F,j;E.vertexLength+=k,E.primitiveLength+=g.length/3,M&&(j=_.prepareSegment(k,s,x),F=j.vertexLength,j.vertexLength+=k);for(let Z=0;Z<d.length;Z+=2)i(d[Z],d[Z+1]);if(M)for(let Z=0;Z<S.length;Z++){const X=S[Z];for(let ee=1;ee<X.length;ee+=2)x.emplaceBack(F+X[ee-1],F+X[ee]);j.primitiveLength+=X.length/2}}else(function(E,B,F,j,Z,X){const ee=[];for(let oe=0;oe<j.length/2;oe++)ee.push(-1);const de={count:0};let ne=0,O=E.getOrCreateLatestSegment(B,F),H=O.vertexLength;for(let oe=2;oe<Z.length;oe+=3){const Ce=Z[oe-2],Ve=Z[oe-1],ke=Z[oe];let Ae=ee[Ce]<ne,Ye=ee[Ve]<ne,Ze=ee[ke]<ne;O.vertexLength+((Ae?1:0)+(Ye?1:0)+(Ze?1:0))>Ct.MAX_VERTEX_ARRAY_LENGTH&&(O=E.createNewSegment(B,F),ne=de.count,Ae=!0,Ye=!0,Ze=!0,H=0);const Je=iu(ee,j,X,de,Ce,Ae,O),Be=iu(ee,j,X,de,Ve,Ye,O),pt=iu(ee,j,X,de,ke,Ze,O);F.emplaceBack(H+Je-ne,H+Be-ne,H+pt-ne),O.primitiveLength++}})(t,s,l,d,g,i),M&&function(E,B,F,j,Z,X){const ee=[];for(let oe=0;oe<j.length/2;oe++)ee.push(-1);const de={count:0};let ne=0,O=E.getOrCreateLatestSegment(B,F),H=O.vertexLength;for(let oe=0;oe<Z.length;oe++){const Ce=Z[oe];for(let Ve=1;Ve<Z[oe].length;Ve+=2){const ke=Ce[Ve-1],Ae=Ce[Ve];let Ye=ee[ke]<ne,Ze=ee[Ae]<ne;O.vertexLength+((Ye?1:0)+(Ze?1:0))>Ct.MAX_VERTEX_ARRAY_LENGTH&&(O=E.createNewSegment(B,F),ne=de.count,Ye=!0,Ze=!0,H=0);const Je=iu(ee,j,X,de,ke,Ye,O),Be=iu(ee,j,X,de,Ae,Ze,O);F.emplaceBack(H+Je-ne,H+Be-ne),O.primitiveLength++}}}(_,s,x,d,S,i),t.forceNewSegmentOnNextPrepare(),_==null||_.forceNewSegmentOnNextPrepare()}function iu(i,t,s,l,d,g,_){if(g){const x=l.count;return s(t[2*d],t[2*d+1]),i[d]=l.count,l.count++,_.vertexLength++,x}return i[d]}class tp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new se,this.indexArray=new rt,this.indexArray2=new et,this.programConfigurations=new ji(t.layers,t.zoom),this.segments=new Ct,this.segments2=new Ct,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,l){this.hasPattern=Kf("fill",this.layers,s);const d=this.layers[0].layout.get("fill-sort-key"),g=!d.isConstant(),_=[];for(const{feature:x,id:S,index:k,sourceLayerIndex:M}of t){const E=this.layers[0]._featureFilter.needGeometry,B=Yn(x,E);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom),B,l))continue;const F=g?d.evaluate(B,{},l,s.availableImages):void 0,j={id:S,properties:x.properties,type:x.type,sourceLayerIndex:M,index:k,geometry:E?B.geometry:Ni(x),patterns:{},sortKey:F};_.push(j)}g&&_.sort((x,S)=>x.sortKey-S.sortKey);for(const x of _){const{geometry:S,index:k,sourceLayerIndex:M}=x;if(this.hasPattern){const E=Jf("fill",this.layers,x,this.zoom,s);this.patternFeatures.push(E)}else this.addFeature(x,S,k,l,{},s.subdivisionGranularity);s.featureIndex.insert(t[k].feature,S,k,M,this.index)}}update(t,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,l)}addFeatures(t,s,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,s,l,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,hx),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,s,l,d,g,_){for(const x of ja(s,500)){const S=bg(x,d,_.fill.getGranularityForZoomLevel(d.z)),k=this.layoutVertexArray;xg((M,E)=>{k.emplaceBack(M,E)},this.segments,this.layoutVertexArray,this.indexArray,S.verticesFlattened,S.indicesTriangles,this.segments2,this.indexArray2,S.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,g,d)}}let wg,Cg;dt("FillBucket",tp,{omit:["layers","patternFeatures"]});var Cx={get paint(){return Cg=Cg||new jn({"fill-antialias":new wt(z.paint_fill["fill-antialias"]),"fill-opacity":new Et(z.paint_fill["fill-opacity"]),"fill-color":new Et(z.paint_fill["fill-color"]),"fill-outline-color":new Et(z.paint_fill["fill-outline-color"]),"fill-translate":new wt(z.paint_fill["fill-translate"]),"fill-translate-anchor":new wt(z.paint_fill["fill-translate-anchor"]),"fill-pattern":new ia(z.paint_fill["fill-pattern"])})},get layout(){return wg=wg||new jn({"fill-sort-key":new Et(z.layout_fill["fill-sort-key"])})}};class Sx extends Do{constructor(t){super(t,Cx)}recalculate(t,s){super.recalculate(t,s);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new tp(t)}queryRadius(){return td(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:s,transform:l,pixelsToTileUnits:d}){return vl(rd(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-l.bearingInRadians,d),s)}isTileClipped(){return!0}}const Tx=Zr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),kx=Zr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Px}=Tx;var rp,Sg,np,Tg,op,kg,Pg,sd={};function Mg(){if(Sg)return rp;Sg=1;var i=N();function t(d,g,_,x,S){this.properties={},this.extent=_,this.type=0,this._pbf=d,this._geometry=-1,this._keys=x,this._values=S,d.readFields(s,this,g)}function s(d,g,_){d==1?g.id=_.readVarint():d==2?function(x,S){for(var k=x.readVarint()+x.pos;x.pos<k;){var M=S._keys[x.readVarint()],E=S._values[x.readVarint()];S.properties[M]=E}}(_,g):d==3?g.type=_.readVarint():d==4&&(g._geometry=_.pos)}function l(d){for(var g,_,x=0,S=0,k=d.length,M=k-1;S<k;M=S++)x+=((_=d[M]).x-(g=d[S]).x)*(g.y+_.y);return x}return rp=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var d=this._pbf;d.pos=this._geometry;for(var g,_=d.readVarint()+d.pos,x=1,S=0,k=0,M=0,E=[];d.pos<_;){if(S<=0){var B=d.readVarint();x=7&B,S=B>>3}if(S--,x===1||x===2)k+=d.readSVarint(),M+=d.readSVarint(),x===1&&(g&&E.push(g),g=[]),g.push(new i(k,M));else{if(x!==7)throw new Error("unknown command "+x);g&&g.push(g[0].clone())}}return g&&E.push(g),E},t.prototype.bbox=function(){var d=this._pbf;d.pos=this._geometry;for(var g=d.readVarint()+d.pos,_=1,x=0,S=0,k=0,M=1/0,E=-1/0,B=1/0,F=-1/0;d.pos<g;){if(x<=0){var j=d.readVarint();_=7&j,x=j>>3}if(x--,_===1||_===2)(S+=d.readSVarint())<M&&(M=S),S>E&&(E=S),(k+=d.readSVarint())<B&&(B=k),k>F&&(F=k);else if(_!==7)throw new Error("unknown command "+_)}return[M,B,E,F]},t.prototype.toGeoJSON=function(d,g,_){var x,S,k=this.extent*Math.pow(2,_),M=this.extent*d,E=this.extent*g,B=this.loadGeometry(),F=t.types[this.type];function j(ee){for(var de=0;de<ee.length;de++){var ne=ee[de];ee[de]=[360*(ne.x+M)/k-180,360/Math.PI*Math.atan(Math.exp((180-360*(ne.y+E)/k)*Math.PI/180))-90]}}switch(this.type){case 1:var Z=[];for(x=0;x<B.length;x++)Z[x]=B[x][0];j(B=Z);break;case 2:for(x=0;x<B.length;x++)j(B[x]);break;case 3:for(B=function(ee){var de=ee.length;if(de<=1)return[ee];for(var ne,O,H=[],oe=0;oe<de;oe++){var Ce=l(ee[oe]);Ce!==0&&(O===void 0&&(O=Ce<0),O===Ce<0?(ne&&H.push(ne),ne=[ee[oe]]):ne.push(ee[oe]))}return ne&&H.push(ne),H}(B),x=0;x<B.length;x++)for(S=0;S<B[x].length;S++)j(B[x][S])}B.length===1?B=B[0]:F="Multi"+F;var X={type:"Feature",geometry:{type:F,coordinates:B},properties:this.properties};return"id"in this&&(X.id=this.id),X},rp}function Ig(){if(Tg)return np;Tg=1;var i=Mg();function t(l,d){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(s,this,d),this.length=this._features.length}function s(l,d,g){l===15?d.version=g.readVarint():l===1?d.name=g.readString():l===5?d.extent=g.readVarint():l===2?d._features.push(g.pos):l===3?d._keys.push(g.readString()):l===4&&d._values.push(function(_){for(var x=null,S=_.readVarint()+_.pos;_.pos<S;){var k=_.readVarint()>>3;x=k===1?_.readString():k===2?_.readFloat():k===3?_.readDouble():k===4?_.readVarint64():k===5?_.readVarint():k===6?_.readSVarint():k===7?_.readBoolean():null}return x}(g))}return np=t,t.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var d=this._pbf.readVarint()+this._pbf.pos;return new i(this._pbf,d,this.extent,this._keys,this._values)},np}function Eg(){return Pg||(Pg=1,sd.VectorTile=function(){if(kg)return op;kg=1;var i=Ig();function t(s,l,d){if(s===3){var g=new i(d,d.readVarint()+d.pos);g.length&&(l[g.name]=g)}}return op=function(s,l){this.layers=s.readFields(t,{},l)},op}(),sd.VectorTileFeature=Mg(),sd.VectorTileLayer=Ig()),sd}var su=I(Eg());const Mx=su.VectorTileFeature.types,ip=Math.pow(2,13);function au(i,t,s,l,d,g,_,x){i.emplaceBack(t,s,2*Math.floor(l*ip)+_,d*ip*2,g*ip*2,Math.round(x))}class sp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new le,this.centroidVertexArray=new Q,this.indexArray=new rt,this.programConfigurations=new ji(t.layers,t.zoom),this.segments=new Ct,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,l){this.features=[],this.hasPattern=Kf("fill-extrusion",this.layers,s);for(const{feature:d,id:g,index:_,sourceLayerIndex:x}of t){const S=this.layers[0]._featureFilter.needGeometry,k=Yn(d,S);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom),k,l))continue;const M={id:g,sourceLayerIndex:x,index:_,geometry:S?k.geometry:Ni(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(Jf("fill-extrusion",this.layers,M,this.zoom,s)):this.addFeature(M,M.geometry,_,l,{},s.subdivisionGranularity),s.featureIndex.insert(d,M.geometry,_,x,this.index,!0)}}addFeatures(t,s,l){for(const d of this.features){const{geometry:g}=d;this.addFeature(d,g,d.index,s,l,t.subdivisionGranularity)}}update(t,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Px),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,kx.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,s,l,d,g,_){for(const x of ja(s,500)){const S={x:0,y:0,sampleCount:0},k=this.layoutVertexArray.length;this.processPolygon(S,d,t,x,_);const M=this.layoutVertexArray.length-k,E=Math.floor(S.x/S.sampleCount),B=Math.floor(S.y/S.sampleCount);for(let F=0;F<M;F++)this.centroidVertexArray.emplaceBack(E,B)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,g,d)}processPolygon(t,s,l,d,g){if(d.length<1||Ag(d[0]))return;for(const E of d)E.length!==0&&Ix(t,E);const _={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},x=g.fill.getGranularityForZoomLevel(s.z),S=Mx[l.type]==="Polygon";for(const E of d){if(E.length===0||Ag(E))continue;const B=ca(E,x,S);this._generateSideFaces(B,_)}if(!S)return;const k=bg(d,s,x,!1),M=this.layoutVertexArray;xg((E,B)=>{au(M,E,B,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,k.verticesFlattened,k.indicesTriangles)}_generateSideFaces(t,s){let l=0;for(let d=1;d<t.length;d++){const g=t[d],_=t[d-1];if(Ex(g,_))continue;s.segment.vertexLength+4>Ct.MAX_VERTEX_ARRAY_LENGTH&&(s.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const x=g.sub(_)._perp()._unit(),S=_.dist(g);l+S>32768&&(l=0),au(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,0,l),au(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,1,l),l+=S,au(this.layoutVertexArray,_.x,_.y,x.x,x.y,0,0,l),au(this.layoutVertexArray,_.x,_.y,x.x,x.y,0,1,l);const k=s.segment.vertexLength;this.indexArray.emplaceBack(k,k+2,k+1),this.indexArray.emplaceBack(k+1,k+2,k+3),s.segment.vertexLength+=4,s.segment.primitiveLength+=2}}}function Ix(i,t){for(let s=0;s<t.length;s++){const l=t[s];s===t.length-1&&t[0].x===l.x&&t[0].y===l.y||(i.x+=l.x,i.y+=l.y,i.sampleCount++)}}function Ex(i,t){return i.x===t.x&&(i.x<0||i.x>ft)||i.y===t.y&&(i.y<0||i.y>ft)}function Ag(i){return i.every(t=>t.x<0)||i.every(t=>t.x>ft)||i.every(t=>t.y<0)||i.every(t=>t.y>ft)}let zg;dt("FillExtrusionBucket",sp,{omit:["layers","features"]});var Ax={get paint(){return zg=zg||new jn({"fill-extrusion-opacity":new wt(z["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Et(z["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wt(z["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wt(z["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ia(z["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Et(z["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Et(z["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new wt(z["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class zx extends Do{constructor(t){super(t,Ax)}createBucket(t){return new sp(t)}queryRadius(){return td(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:s,featureState:l,geometry:d,transform:g,pixelsToTileUnits:_,pixelPosMatrix:x}){const S=rd(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-g.bearingInRadians,_),k=this.paint.get("fill-extrusion-height").evaluate(s,l),M=this.paint.get("fill-extrusion-base").evaluate(s,l),E=function(F,j,Z){const X=[];for(const ee of F){const de=[ee.x,ee.y,0,1];Me(de,de,j),X.push(new ie(de[0]/de[3],de[1]/de[3]))}return X}(S,x),B=function(F,j,Z,X){const ee=[],de=[],ne=X[8]*j,O=X[9]*j,H=X[10]*j,oe=X[11]*j,Ce=X[8]*Z,Ve=X[9]*Z,ke=X[10]*Z,Ae=X[11]*Z;for(const Ye of F){const Ze=[],Je=[];for(const Be of Ye){const pt=Be.x,Mt=Be.y,kt=X[0]*pt+X[4]*Mt+X[12],vt=X[1]*pt+X[5]*Mt+X[13],Gt=X[2]*pt+X[6]*Mt+X[14],$r=X[3]*pt+X[7]*Mt+X[15],on=Gt+H,En=$r+oe,Mo=kt+Ce,Jn=vt+Ve,xn=Gt+ke,Ir=$r+Ae,pn=new ie((kt+ne)/En,(vt+O)/En);pn.z=on/En,Ze.push(pn);const wn=new ie(Mo/Ir,Jn/Ir);wn.z=xn/Ir,Je.push(wn)}ee.push(Ze),de.push(Je)}return[ee,de]}(d,M,k,x);return function(F,j,Z){let X=1/0;vl(Z,j)&&(X=Rg(Z,j[0]));for(let ee=0;ee<j.length;ee++){const de=j[ee],ne=F[ee];for(let O=0;O<de.length-1;O++){const H=de[O],oe=[H,de[O+1],ne[O+1],ne[O],H];yl(Z,oe)&&(X=Math.min(X,Rg(Z,oe)))}}return X!==1/0&&X}(B[0],B[1],E)}}function lu(i,t){return i.x*t.x+i.y*t.y}function Rg(i,t){if(i.length===1){let s=0;const l=t[s++];let d;for(;!d||l.equals(d);)if(d=t[s++],!d)return 1/0;for(;s<t.length;s++){const g=t[s],_=i[0],x=d.sub(l),S=g.sub(l),k=_.sub(l),M=lu(x,x),E=lu(x,S),B=lu(S,S),F=lu(k,x),j=lu(k,S),Z=M*B-E*E,X=(B*F-E*j)/Z,ee=(M*j-E*F)/Z,de=l.z*(1-X-ee)+d.z*X+g.z*ee;if(isFinite(de))return de}return 1/0}{let s=1/0;for(const l of t)s=Math.min(s,l.z);return s}}const Rx=Zr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Dx}=Rx,Lx=Zr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Bx}=Lx,$x=su.VectorTileFeature.types,Ox=Math.cos(Math.PI/180*37.5),Dg=Math.pow(2,14)/.5;class ap{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new ue,this.layoutVertexArray2=new fe,this.indexArray=new rt,this.programConfigurations=new ji(t.layers,t.zoom),this.segments=new Ct,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,l){this.hasPattern=Kf("line",this.layers,s);const d=this.layers[0].layout.get("line-sort-key"),g=!d.isConstant(),_=[];for(const{feature:x,id:S,index:k,sourceLayerIndex:M}of t){const E=this.layers[0]._featureFilter.needGeometry,B=Yn(x,E);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom),B,l))continue;const F=g?d.evaluate(B,{},l):void 0,j={id:S,properties:x.properties,type:x.type,sourceLayerIndex:M,index:k,geometry:E?B.geometry:Ni(x),patterns:{},sortKey:F};_.push(j)}g&&_.sort((x,S)=>x.sortKey-S.sortKey);for(const x of _){const{geometry:S,index:k,sourceLayerIndex:M}=x;if(this.hasPattern){const E=Jf("line",this.layers,x,this.zoom,s);this.patternFeatures.push(E)}else this.addFeature(x,S,k,l,{},s.subdivisionGranularity);s.featureIndex.insert(t[k].feature,S,k,M,this.index)}}update(t,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,l)}addFeatures(t,s,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,s,l,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Bx)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Dx),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,s,l,d,g,_){const x=this.layers[0].layout,S=x.get("line-join").evaluate(t,{}),k=x.get("line-cap"),M=x.get("line-miter-limit"),E=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const B of s)this.addLine(B,t,S,k,M,E,d,_);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,g,d)}addLine(t,s,l,d,g,_,x,S){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=ca(t,x?S.line.getGranularityForZoomLevel(x.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ne=0;ne<t.length-1;ne++)this.totalDistance+=t[ne].dist(t[ne+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const k=$x[s.type]==="Polygon";let M=t.length;for(;M>=2&&t[M-1].equals(t[M-2]);)M--;let E=0;for(;E<M-1&&t[E].equals(t[E+1]);)E++;if(M<(k?3:2))return;l==="bevel"&&(g=1.05);const B=this.overscaling<=16?15*ft/(512*this.overscaling):0,F=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let j,Z,X,ee,de;this.e1=this.e2=-1,k&&(j=t[M-2],de=t[E].sub(j)._unit()._perp());for(let ne=E;ne<M;ne++){if(X=ne===M-1?k?t[E+1]:void 0:t[ne+1],X&&t[ne].equals(X))continue;de&&(ee=de),j&&(Z=j),j=t[ne],de=X?X.sub(j)._unit()._perp():ee,ee=ee||de;let O=ee.add(de);O.x===0&&O.y===0||O._unit();const H=ee.x*de.x+ee.y*de.y,oe=O.x*de.x+O.y*de.y,Ce=oe!==0?1/oe:1/0,Ve=2*Math.sqrt(2-2*oe),ke=oe<Ox&&Z&&X,Ae=ee.x*de.y-ee.y*de.x>0;if(ke&&ne>E){const Je=j.dist(Z);if(Je>2*B){const Be=j.sub(j.sub(Z)._mult(B/Je)._round());this.updateDistance(Z,Be),this.addCurrentVertex(Be,ee,0,0,F),Z=Be}}const Ye=Z&&X;let Ze=Ye?l:k?"butt":d;if(Ye&&Ze==="round"&&(Ce<_?Ze="miter":Ce<=2&&(Ze="fakeround")),Ze==="miter"&&Ce>g&&(Ze="bevel"),Ze==="bevel"&&(Ce>2&&(Ze="flipbevel"),Ce<g&&(Ze="miter")),Z&&this.updateDistance(Z,j),Ze==="miter")O._mult(Ce),this.addCurrentVertex(j,O,0,0,F);else if(Ze==="flipbevel"){if(Ce>100)O=de.mult(-1);else{const Je=Ce*ee.add(de).mag()/ee.sub(de).mag();O._perp()._mult(Je*(Ae?-1:1))}this.addCurrentVertex(j,O,0,0,F),this.addCurrentVertex(j,O.mult(-1),0,0,F)}else if(Ze==="bevel"||Ze==="fakeround"){const Je=-Math.sqrt(Ce*Ce-1),Be=Ae?Je:0,pt=Ae?0:Je;if(Z&&this.addCurrentVertex(j,ee,Be,pt,F),Ze==="fakeround"){const Mt=Math.round(180*Ve/Math.PI/20);for(let kt=1;kt<Mt;kt++){let vt=kt/Mt;if(vt!==.5){const $r=vt-.5;vt+=vt*$r*(vt-1)*((1.0904+H*(H*(3.55645-1.43519*H)-3.2452))*$r*$r+(.848013+H*(.215638*H-1.06021)))}const Gt=de.sub(ee)._mult(vt)._add(ee)._unit()._mult(Ae?-1:1);this.addHalfVertex(j,Gt.x,Gt.y,!1,Ae,0,F)}}X&&this.addCurrentVertex(j,de,-Be,-pt,F)}else if(Ze==="butt")this.addCurrentVertex(j,O,0,0,F);else if(Ze==="square"){const Je=Z?1:-1;this.addCurrentVertex(j,O,Je,Je,F)}else Ze==="round"&&(Z&&(this.addCurrentVertex(j,ee,0,0,F),this.addCurrentVertex(j,ee,1,1,F,!0)),X&&(this.addCurrentVertex(j,de,-1,-1,F,!0),this.addCurrentVertex(j,de,0,0,F)));if(ke&&ne<M-1){const Je=j.dist(X);if(Je>2*B){const Be=j.add(X.sub(j)._mult(B/Je)._round());this.updateDistance(j,Be),this.addCurrentVertex(Be,de,0,0,F),j=Be}}}}addCurrentVertex(t,s,l,d,g,_=!1){const x=s.y*d-s.x,S=-s.y-s.x*d;this.addHalfVertex(t,s.x+s.y*l,s.y-s.x*l,_,!1,l,g),this.addHalfVertex(t,x,S,_,!0,-d,g),this.distance>Dg/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,s,l,d,g,_))}addHalfVertex({x:t,y:s},l,d,g,_,x,S){const k=.5*(this.lineClips?this.scaledDistance*(Dg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(g?1:0),(s<<1)+(_?1:0),Math.round(63*l)+128,Math.round(63*d)+128,1+(x===0?0:x<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const M=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,M,this.e2),S.primitiveLength++),_?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,s){this.distance+=t.dist(s),this.updateScaledDistance()}}let Lg,Bg;dt("LineBucket",ap,{omit:["layers","patternFeatures"]});var $g={get paint(){return Bg=Bg||new jn({"line-opacity":new Et(z.paint_line["line-opacity"]),"line-color":new Et(z.paint_line["line-color"]),"line-translate":new wt(z.paint_line["line-translate"]),"line-translate-anchor":new wt(z.paint_line["line-translate-anchor"]),"line-width":new Et(z.paint_line["line-width"]),"line-gap-width":new Et(z.paint_line["line-gap-width"]),"line-offset":new Et(z.paint_line["line-offset"]),"line-blur":new Et(z.paint_line["line-blur"]),"line-dasharray":new cl(z.paint_line["line-dasharray"]),"line-pattern":new ia(z.paint_line["line-pattern"]),"line-gradient":new Gc(z.paint_line["line-gradient"])})},get layout(){return Lg=Lg||new jn({"line-cap":new wt(z.layout_line["line-cap"]),"line-join":new Et(z.layout_line["line-join"]),"line-miter-limit":new wt(z.layout_line["line-miter-limit"]),"line-round-limit":new wt(z.layout_line["line-round-limit"]),"line-sort-key":new Et(z.layout_line["line-sort-key"])})}};class Fx extends Et{possiblyEvaluate(t,s){return s=new Tr(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(t,s)}evaluate(t,s,l,d){return s=Cr({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(t,s,l,d)}}let ad;class jx extends Do{constructor(t){super(t,$g),this.gradientVersion=0,ad||(ad=new Fx($g.paint.properties["line-width"].specification),ad.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof is,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,s){super.recalculate(t,s),this.paint._values["line-floorwidth"]=ad.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new ap(t)}queryRadius(t){const s=t,l=Og(Jc("line-width",this,s),Jc("line-gap-width",this,s)),d=Jc("line-offset",this,s);return l/2+Math.abs(d)+td(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:s,featureState:l,geometry:d,transform:g,pixelsToTileUnits:_}){const x=rd(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-g.bearingInRadians,_),S=_/2*Og(this.paint.get("line-width").evaluate(s,l),this.paint.get("line-gap-width").evaluate(s,l)),k=this.paint.get("line-offset").evaluate(s,l);return k&&(d=function(M,E){const B=[];for(let F=0;F<M.length;F++){const j=M[F],Z=[];for(let X=0;X<j.length;X++){const ee=j[X-1],de=j[X],ne=j[X+1],O=X===0?new ie(0,0):de.sub(ee)._unit()._perp(),H=X===j.length-1?new ie(0,0):ne.sub(de)._unit()._perp(),oe=O._add(H)._unit(),Ce=oe.x*H.x+oe.y*H.y;Ce!==0&&oe._mult(1/Ce),Z.push(oe._mult(E)._add(de))}B.push(Z)}return B}(d,k*_)),function(M,E,B){for(let F=0;F<E.length;F++){const j=E[F];if(M.length>=3){for(let Z=0;Z<j.length;Z++)if(bl(M,j[Z]))return!0}if(tx(M,j,B))return!0}return!1}(x,d,S)}isTileClipped(){return!0}}function Og(i,t){return t>0?t+2*i:i}const Nx=Zr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Vx=Zr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Zr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ux=Zr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Zr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Fg=Zr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Zx=Zr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Gx(i,t,s){return i.sections.forEach(l=>{l.text=function(d,g,_){const x=g.layout.get("text-transform").evaluate(_,{});return x==="uppercase"?d=d.toLocaleUpperCase():x==="lowercase"&&(d=d.toLocaleLowerCase()),hi.applyArabicShaping&&(d=hi.applyArabicShaping(d)),d}(l.text,t,s)}),i}Zr([{name:"triangle",components:3,type:"Uint16"}]),Zr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Zr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Zr([{type:"Float32",name:"offsetX"}]),Zr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Zr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const cu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var jg,lp,Ng,nn=24,cp={};function qx(){return jg||(jg=1,cp.read=function(i,t,s,l,d){var g,_,x=8*d-l-1,S=(1<<x)-1,k=S>>1,M=-7,E=s?d-1:0,B=s?-1:1,F=i[t+E];for(E+=B,g=F&(1<<-M)-1,F>>=-M,M+=x;M>0;g=256*g+i[t+E],E+=B,M-=8);for(_=g&(1<<-M)-1,g>>=-M,M+=l;M>0;_=256*_+i[t+E],E+=B,M-=8);if(g===0)g=1-k;else{if(g===S)return _?NaN:1/0*(F?-1:1);_+=Math.pow(2,l),g-=k}return(F?-1:1)*_*Math.pow(2,g-l)},cp.write=function(i,t,s,l,d,g){var _,x,S,k=8*g-d-1,M=(1<<k)-1,E=M>>1,B=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=l?0:g-1,j=l?1:-1,Z=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(x=isNaN(t)?1:0,_=M):(_=Math.floor(Math.log(t)/Math.LN2),t*(S=Math.pow(2,-_))<1&&(_--,S*=2),(t+=_+E>=1?B/S:B*Math.pow(2,1-E))*S>=2&&(_++,S/=2),_+E>=M?(x=0,_=M):_+E>=1?(x=(t*S-1)*Math.pow(2,d),_+=E):(x=t*Math.pow(2,E-1)*Math.pow(2,d),_=0));d>=8;i[s+F]=255&x,F+=j,x/=256,d-=8);for(_=_<<d|x,k+=d;k>0;i[s+F]=255&_,F+=j,_/=256,k-=8);i[s+F-j]|=128*Z}),cp}function Vg(){if(Ng)return lp;Ng=1,lp=t;var i=qx();function t(O){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(O)?O:new Uint8Array(O||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var s=4294967296,l=1/s,d=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function g(O){return O.type===t.Bytes?O.readVarint()+O.pos:O.pos+1}function _(O,H,oe){return oe?4294967296*H+(O>>>0):4294967296*(H>>>0)+(O>>>0)}function x(O,H,oe){var Ce=H<=16383?1:H<=2097151?2:H<=268435455?3:Math.floor(Math.log(H)/(7*Math.LN2));oe.realloc(Ce);for(var Ve=oe.pos-1;Ve>=O;Ve--)oe.buf[Ve+Ce]=oe.buf[Ve]}function S(O,H){for(var oe=0;oe<O.length;oe++)H.writeVarint(O[oe])}function k(O,H){for(var oe=0;oe<O.length;oe++)H.writeSVarint(O[oe])}function M(O,H){for(var oe=0;oe<O.length;oe++)H.writeFloat(O[oe])}function E(O,H){for(var oe=0;oe<O.length;oe++)H.writeDouble(O[oe])}function B(O,H){for(var oe=0;oe<O.length;oe++)H.writeBoolean(O[oe])}function F(O,H){for(var oe=0;oe<O.length;oe++)H.writeFixed32(O[oe])}function j(O,H){for(var oe=0;oe<O.length;oe++)H.writeSFixed32(O[oe])}function Z(O,H){for(var oe=0;oe<O.length;oe++)H.writeFixed64(O[oe])}function X(O,H){for(var oe=0;oe<O.length;oe++)H.writeSFixed64(O[oe])}function ee(O,H){return(O[H]|O[H+1]<<8|O[H+2]<<16)+16777216*O[H+3]}function de(O,H,oe){O[oe]=H,O[oe+1]=H>>>8,O[oe+2]=H>>>16,O[oe+3]=H>>>24}function ne(O,H){return(O[H]|O[H+1]<<8|O[H+2]<<16)+(O[H+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(O,H,oe){for(oe=oe||this.length;this.pos<oe;){var Ce=this.readVarint(),Ve=Ce>>3,ke=this.pos;this.type=7&Ce,O(Ve,H,this),this.pos===ke&&this.skip(Ce)}return H},readMessage:function(O,H){return this.readFields(O,H,this.readVarint()+this.pos)},readFixed32:function(){var O=ee(this.buf,this.pos);return this.pos+=4,O},readSFixed32:function(){var O=ne(this.buf,this.pos);return this.pos+=4,O},readFixed64:function(){var O=ee(this.buf,this.pos)+ee(this.buf,this.pos+4)*s;return this.pos+=8,O},readSFixed64:function(){var O=ee(this.buf,this.pos)+ne(this.buf,this.pos+4)*s;return this.pos+=8,O},readFloat:function(){var O=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,O},readDouble:function(){var O=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,O},readVarint:function(O){var H,oe,Ce=this.buf;return H=127&(oe=Ce[this.pos++]),oe<128?H:(H|=(127&(oe=Ce[this.pos++]))<<7,oe<128?H:(H|=(127&(oe=Ce[this.pos++]))<<14,oe<128?H:(H|=(127&(oe=Ce[this.pos++]))<<21,oe<128?H:function(Ve,ke,Ae){var Ye,Ze,Je=Ae.buf;if(Ye=(112&(Ze=Je[Ae.pos++]))>>4,Ze<128||(Ye|=(127&(Ze=Je[Ae.pos++]))<<3,Ze<128)||(Ye|=(127&(Ze=Je[Ae.pos++]))<<10,Ze<128)||(Ye|=(127&(Ze=Je[Ae.pos++]))<<17,Ze<128)||(Ye|=(127&(Ze=Je[Ae.pos++]))<<24,Ze<128)||(Ye|=(1&(Ze=Je[Ae.pos++]))<<31,Ze<128))return _(Ve,Ye,ke);throw new Error("Expected varint not more than 10 bytes")}(H|=(15&(oe=Ce[this.pos]))<<28,O,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var O=this.readVarint();return O%2==1?(O+1)/-2:O/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var O=this.readVarint()+this.pos,H=this.pos;return this.pos=O,O-H>=12&&d?function(oe,Ce,Ve){return d.decode(oe.subarray(Ce,Ve))}(this.buf,H,O):function(oe,Ce,Ve){for(var ke="",Ae=Ce;Ae<Ve;){var Ye,Ze,Je,Be=oe[Ae],pt=null,Mt=Be>239?4:Be>223?3:Be>191?2:1;if(Ae+Mt>Ve)break;Mt===1?Be<128&&(pt=Be):Mt===2?(192&(Ye=oe[Ae+1]))==128&&(pt=(31&Be)<<6|63&Ye)<=127&&(pt=null):Mt===3?(Ze=oe[Ae+2],(192&(Ye=oe[Ae+1]))==128&&(192&Ze)==128&&((pt=(15&Be)<<12|(63&Ye)<<6|63&Ze)<=2047||pt>=55296&&pt<=57343)&&(pt=null)):Mt===4&&(Ze=oe[Ae+2],Je=oe[Ae+3],(192&(Ye=oe[Ae+1]))==128&&(192&Ze)==128&&(192&Je)==128&&((pt=(15&Be)<<18|(63&Ye)<<12|(63&Ze)<<6|63&Je)<=65535||pt>=1114112)&&(pt=null)),pt===null?(pt=65533,Mt=1):pt>65535&&(pt-=65536,ke+=String.fromCharCode(pt>>>10&1023|55296),pt=56320|1023&pt),ke+=String.fromCharCode(pt),Ae+=Mt}return ke}(this.buf,H,O)},readBytes:function(){var O=this.readVarint()+this.pos,H=this.buf.subarray(this.pos,O);return this.pos=O,H},readPackedVarint:function(O,H){if(this.type!==t.Bytes)return O.push(this.readVarint(H));var oe=g(this);for(O=O||[];this.pos<oe;)O.push(this.readVarint(H));return O},readPackedSVarint:function(O){if(this.type!==t.Bytes)return O.push(this.readSVarint());var H=g(this);for(O=O||[];this.pos<H;)O.push(this.readSVarint());return O},readPackedBoolean:function(O){if(this.type!==t.Bytes)return O.push(this.readBoolean());var H=g(this);for(O=O||[];this.pos<H;)O.push(this.readBoolean());return O},readPackedFloat:function(O){if(this.type!==t.Bytes)return O.push(this.readFloat());var H=g(this);for(O=O||[];this.pos<H;)O.push(this.readFloat());return O},readPackedDouble:function(O){if(this.type!==t.Bytes)return O.push(this.readDouble());var H=g(this);for(O=O||[];this.pos<H;)O.push(this.readDouble());return O},readPackedFixed32:function(O){if(this.type!==t.Bytes)return O.push(this.readFixed32());var H=g(this);for(O=O||[];this.pos<H;)O.push(this.readFixed32());return O},readPackedSFixed32:function(O){if(this.type!==t.Bytes)return O.push(this.readSFixed32());var H=g(this);for(O=O||[];this.pos<H;)O.push(this.readSFixed32());return O},readPackedFixed64:function(O){if(this.type!==t.Bytes)return O.push(this.readFixed64());var H=g(this);for(O=O||[];this.pos<H;)O.push(this.readFixed64());return O},readPackedSFixed64:function(O){if(this.type!==t.Bytes)return O.push(this.readSFixed64());var H=g(this);for(O=O||[];this.pos<H;)O.push(this.readSFixed64());return O},skip:function(O){var H=7&O;if(H===t.Varint)for(;this.buf[this.pos++]>127;);else if(H===t.Bytes)this.pos=this.readVarint()+this.pos;else if(H===t.Fixed32)this.pos+=4;else{if(H!==t.Fixed64)throw new Error("Unimplemented type: "+H);this.pos+=8}},writeTag:function(O,H){this.writeVarint(O<<3|H)},realloc:function(O){for(var H=this.length||16;H<this.pos+O;)H*=2;if(H!==this.length){var oe=new Uint8Array(H);oe.set(this.buf),this.buf=oe,this.length=H}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(O){this.realloc(4),de(this.buf,O,this.pos),this.pos+=4},writeSFixed32:function(O){this.realloc(4),de(this.buf,O,this.pos),this.pos+=4},writeFixed64:function(O){this.realloc(8),de(this.buf,-1&O,this.pos),de(this.buf,Math.floor(O*l),this.pos+4),this.pos+=8},writeSFixed64:function(O){this.realloc(8),de(this.buf,-1&O,this.pos),de(this.buf,Math.floor(O*l),this.pos+4),this.pos+=8},writeVarint:function(O){(O=+O||0)>268435455||O<0?function(H,oe){var Ce,Ve;if(H>=0?(Ce=H%4294967296|0,Ve=H/4294967296|0):(Ve=~(-H/4294967296),4294967295^(Ce=~(-H%4294967296))?Ce=Ce+1|0:(Ce=0,Ve=Ve+1|0)),H>=18446744073709552e3||H<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");oe.realloc(10),function(ke,Ae,Ye){Ye.buf[Ye.pos++]=127&ke|128,ke>>>=7,Ye.buf[Ye.pos++]=127&ke|128,ke>>>=7,Ye.buf[Ye.pos++]=127&ke|128,ke>>>=7,Ye.buf[Ye.pos++]=127&ke|128,Ye.buf[Ye.pos]=127&(ke>>>=7)}(Ce,0,oe),function(ke,Ae){var Ye=(7&ke)<<4;Ae.buf[Ae.pos++]|=Ye|((ke>>>=3)?128:0),ke&&(Ae.buf[Ae.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(Ae.buf[Ae.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(Ae.buf[Ae.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(Ae.buf[Ae.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(Ae.buf[Ae.pos++]=127&ke)))))}(Ve,oe)}(O,this):(this.realloc(4),this.buf[this.pos++]=127&O|(O>127?128:0),O<=127||(this.buf[this.pos++]=127&(O>>>=7)|(O>127?128:0),O<=127||(this.buf[this.pos++]=127&(O>>>=7)|(O>127?128:0),O<=127||(this.buf[this.pos++]=O>>>7&127))))},writeSVarint:function(O){this.writeVarint(O<0?2*-O-1:2*O)},writeBoolean:function(O){this.writeVarint(!!O)},writeString:function(O){O=String(O),this.realloc(4*O.length),this.pos++;var H=this.pos;this.pos=function(Ce,Ve,ke){for(var Ae,Ye,Ze=0;Ze<Ve.length;Ze++){if((Ae=Ve.charCodeAt(Ze))>55295&&Ae<57344){if(!Ye){Ae>56319||Ze+1===Ve.length?(Ce[ke++]=239,Ce[ke++]=191,Ce[ke++]=189):Ye=Ae;continue}if(Ae<56320){Ce[ke++]=239,Ce[ke++]=191,Ce[ke++]=189,Ye=Ae;continue}Ae=Ye-55296<<10|Ae-56320|65536,Ye=null}else Ye&&(Ce[ke++]=239,Ce[ke++]=191,Ce[ke++]=189,Ye=null);Ae<128?Ce[ke++]=Ae:(Ae<2048?Ce[ke++]=Ae>>6|192:(Ae<65536?Ce[ke++]=Ae>>12|224:(Ce[ke++]=Ae>>18|240,Ce[ke++]=Ae>>12&63|128),Ce[ke++]=Ae>>6&63|128),Ce[ke++]=63&Ae|128)}return ke}(this.buf,O,this.pos);var oe=this.pos-H;oe>=128&&x(H,oe,this),this.pos=H-1,this.writeVarint(oe),this.pos+=oe},writeFloat:function(O){this.realloc(4),i.write(this.buf,O,this.pos,!0,23,4),this.pos+=4},writeDouble:function(O){this.realloc(8),i.write(this.buf,O,this.pos,!0,52,8),this.pos+=8},writeBytes:function(O){var H=O.length;this.writeVarint(H),this.realloc(H);for(var oe=0;oe<H;oe++)this.buf[this.pos++]=O[oe]},writeRawMessage:function(O,H){this.pos++;var oe=this.pos;O(H,this);var Ce=this.pos-oe;Ce>=128&&x(oe,Ce,this),this.pos=oe-1,this.writeVarint(Ce),this.pos+=Ce},writeMessage:function(O,H,oe){this.writeTag(O,t.Bytes),this.writeRawMessage(H,oe)},writePackedVarint:function(O,H){H.length&&this.writeMessage(O,S,H)},writePackedSVarint:function(O,H){H.length&&this.writeMessage(O,k,H)},writePackedBoolean:function(O,H){H.length&&this.writeMessage(O,B,H)},writePackedFloat:function(O,H){H.length&&this.writeMessage(O,M,H)},writePackedDouble:function(O,H){H.length&&this.writeMessage(O,E,H)},writePackedFixed32:function(O,H){H.length&&this.writeMessage(O,F,H)},writePackedSFixed32:function(O,H){H.length&&this.writeMessage(O,j,H)},writePackedFixed64:function(O,H){H.length&&this.writeMessage(O,Z,H)},writePackedSFixed64:function(O,H){H.length&&this.writeMessage(O,X,H)},writeBytesField:function(O,H){this.writeTag(O,t.Bytes),this.writeBytes(H)},writeFixed32Field:function(O,H){this.writeTag(O,t.Fixed32),this.writeFixed32(H)},writeSFixed32Field:function(O,H){this.writeTag(O,t.Fixed32),this.writeSFixed32(H)},writeFixed64Field:function(O,H){this.writeTag(O,t.Fixed64),this.writeFixed64(H)},writeSFixed64Field:function(O,H){this.writeTag(O,t.Fixed64),this.writeSFixed64(H)},writeVarintField:function(O,H){this.writeTag(O,t.Varint),this.writeVarint(H)},writeSVarintField:function(O,H){this.writeTag(O,t.Varint),this.writeSVarint(H)},writeStringField:function(O,H){this.writeTag(O,t.Bytes),this.writeString(H)},writeFloatField:function(O,H){this.writeTag(O,t.Fixed32),this.writeFloat(H)},writeDoubleField:function(O,H){this.writeTag(O,t.Fixed64),this.writeDouble(H)},writeBooleanField:function(O,H){this.writeVarintField(O,!!H)}},lp}var up=I(Vg());const hp=3;function Wx(i,t,s){i===1&&s.readMessage(Hx,t)}function Hx(i,t,s){if(i===3){const{id:l,bitmap:d,width:g,height:_,left:x,top:S,advance:k}=s.readMessage(Xx,{});t.push({id:l,bitmap:new Qc({width:g+2*hp,height:_+2*hp},d),metrics:{width:g,height:_,left:x,top:S,advance:k}})}}function Xx(i,t,s){i===1?t.id=s.readVarint():i===2?t.bitmap=s.readBytes():i===3?t.width=s.readVarint():i===4?t.height=s.readVarint():i===5?t.left=s.readSVarint():i===6?t.top=s.readSVarint():i===7&&(t.advance=s.readVarint())}const Yx=hp;function Ug(i){let t=0,s=0;for(const _ of i)t+=_.w*_.h,s=Math.max(s,_.w);i.sort((_,x)=>x.h-_.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),s),h:1/0}];let d=0,g=0;for(const _ of i)for(let x=l.length-1;x>=0;x--){const S=l[x];if(!(_.w>S.w||_.h>S.h)){if(_.x=S.x,_.y=S.y,g=Math.max(g,_.y+_.h),d=Math.max(d,_.x+_.w),_.w===S.w&&_.h===S.h){const k=l.pop();x<l.length&&(l[x]=k)}else _.h===S.h?(S.x+=_.w,S.w-=_.w):_.w===S.w?(S.y+=_.h,S.h-=_.h):(l.push({x:S.x+_.w,y:S.y,w:S.w-_.w,h:_.h}),S.y+=_.h,S.h-=_.h);break}}return{w:d,h:g,fill:t/(d*g)||0}}const Kn=1;class dp{constructor(t,{pixelRatio:s,version:l,stretchX:d,stretchY:g,content:_,textFitWidth:x,textFitHeight:S}){this.paddedRect=t,this.pixelRatio=s,this.stretchX=d,this.stretchY=g,this.content=_,this.version=l,this.textFitWidth=x,this.textFitHeight=S}get tl(){return[this.paddedRect.x+Kn,this.paddedRect.y+Kn]}get br(){return[this.paddedRect.x+this.paddedRect.w-Kn,this.paddedRect.y+this.paddedRect.h-Kn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Kn)/this.pixelRatio,(this.paddedRect.h-2*Kn)/this.pixelRatio]}}class Zg{constructor(t,s){const l={},d={};this.haveRenderCallbacks=[];const g=[];this.addImages(t,l,g),this.addImages(s,d,g);const{w:_,h:x}=Ug(g),S=new ko({width:_||1,height:x||1});for(const k in t){const M=t[k],E=l[k].paddedRect;ko.copy(M.data,S,{x:0,y:0},{x:E.x+Kn,y:E.y+Kn},M.data)}for(const k in s){const M=s[k],E=d[k].paddedRect,B=E.x+Kn,F=E.y+Kn,j=M.data.width,Z=M.data.height;ko.copy(M.data,S,{x:0,y:0},{x:B,y:F},M.data),ko.copy(M.data,S,{x:0,y:Z-1},{x:B,y:F-1},{width:j,height:1}),ko.copy(M.data,S,{x:0,y:0},{x:B,y:F+Z},{width:j,height:1}),ko.copy(M.data,S,{x:j-1,y:0},{x:B-1,y:F},{width:1,height:Z}),ko.copy(M.data,S,{x:0,y:0},{x:B+j,y:F},{width:1,height:Z})}this.image=S,this.iconPositions=l,this.patternPositions=d}addImages(t,s,l){for(const d in t){const g=t[d],_={x:0,y:0,w:g.data.width+2*Kn,h:g.data.height+2*Kn};l.push(_),s[d]=new dp(_,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(t,s){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),s),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),s)}patchUpdatedImage(t,s,l){if(!t||!s||t.version===s.version)return;t.version=s.version;const[d,g]=t.tl;l.update(s.data,void 0,{x:d,y:g})}}var vs;dt("ImagePosition",dp),dt("ImageAtlas",Zg),b.ag=void 0,(vs=b.ag||(b.ag={}))[vs.none=0]="none",vs[vs.horizontal=1]="horizontal",vs[vs.vertical=2]="vertical",vs[vs.horizontalOnly=3]="horizontalOnly";const ld=-17;class uu{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,s,l){const d=new uu;return d.scale=t||1,d.fontStack=s,d.verticalAlign=l||"bottom",d}static forImage(t,s){const l=new uu;return l.imageName=t,l.verticalAlign=s||"bottom",l}}class Sl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,s){const l=new Sl;for(let d=0;d<t.sections.length;d++){const g=t.sections[d];g.image?l.addImageSection(g):l.addTextSection(g,s)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let s="";for(let l=0;l<t.length;l++){const d=t.charCodeAt(l+1)||null,g=t.charCodeAt(l-1)||null;s+=d&&Nc(d)&&!cu[t[l+1]]||g&&Nc(g)&&!cu[t[l-1]]||!cu[t[l]]?t[l]:cu[t[l]]}return s}(this.text)}trim(){let t=0;for(let l=0;l<this.text.length&&ud[this.text.charCodeAt(l)];l++)t++;let s=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&ud[this.text.charCodeAt(l)];l--)s--;this.text=this.text.substring(t,s),this.sectionIndex=this.sectionIndex.slice(t,s)}substring(t,s){const l=new Sl;return l.text=this.text.substring(t,s),l.sectionIndex=this.sectionIndex.slice(t,s),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,s)=>Math.max(t,this.sections[s].scale),0)}getMaxImageSize(t){let s=0,l=0;for(let d=0;d<this.length();d++){const g=this.getSection(d);if(g.imageName){const _=t[g.imageName];if(!_)continue;const x=_.displaySize;s=Math.max(s,x[0]),l=Math.max(l,x[1])}}return{maxImageWidth:s,maxImageHeight:l}}addTextSection(t,s){this.text+=t.text,this.sections.push(uu.forText(t.scale,t.fontStack||s,t.verticalAlign));const l=this.sections.length-1;for(let d=0;d<t.text.length;++d)this.sectionIndex.push(l)}addImageSection(t){const s=t.image?t.image.name:"";if(s.length===0)return void Jr("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(uu.forImage(s,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Jr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function cd(i,t,s,l,d,g,_,x,S,k,M,E,B,F,j){const Z=Sl.fromFeature(i,d);let X;E===b.ag.vertical&&Z.verticalizePunctuation();const{processBidirectionalText:ee,processStyledBidirectionalText:de}=hi;if(ee&&Z.sections.length===1){X=[];const H=ee(Z.toString(),fp(Z,k,g,t,l,F));for(const oe of H){const Ce=new Sl;Ce.text=oe,Ce.sections=Z.sections;for(let Ve=0;Ve<oe.length;Ve++)Ce.sectionIndex.push(0);X.push(Ce)}}else if(de){X=[];const H=de(Z.text,Z.sectionIndex,fp(Z,k,g,t,l,F));for(const oe of H){const Ce=new Sl;Ce.text=oe[0],Ce.sectionIndex=oe[1],Ce.sections=Z.sections,X.push(Ce)}}else X=function(H,oe){const Ce=[],Ve=H.text;let ke=0;for(const Ae of oe)Ce.push(H.substring(ke,Ae)),ke=Ae;return ke<Ve.length&&Ce.push(H.substring(ke,Ve.length)),Ce}(Z,fp(Z,k,g,t,l,F));const ne=[],O={positionedLines:ne,text:Z.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:E,iconsInText:!1,verticalizable:!1};return function(H,oe,Ce,Ve,ke,Ae,Ye,Ze,Je,Be,pt,Mt){let kt=0,vt=0,Gt=0,$r=0;const on=Ze==="right"?1:Ze==="left"?0:.5,En=nn/Mt;let Mo=0;for(const Ir of ke){Ir.trim();const pn=Ir.getMaxScale(),wn={positionedGlyphs:[],lineOffset:0};H.positionedLines[Mo]=wn;const Cn=wn.positionedGlyphs;let Nn=0;if(!Ir.length()){vt+=Ae,++Mo;continue}const Io=e1(Ve,Ir,En);for(let Qn=0;Qn<Ir.length();Qn++){const sn=Ir.getSection(Qn),gn=Ir.getSectionIndex(Qn),_n=Ir.getCharCode(Qn),Xr=t1(Je,pt,_n);let wr;if(sn.imageName){if(H.iconsInText=!0,sn.scale=sn.scale*En,wr=n1(sn,Xr,pn,Io,Ve),!wr)continue;Nn=Math.max(Nn,wr.imageOffset)}else if(wr=r1(sn,_n,Xr,Io,oe,Ce),!wr)continue;const{rect:Xo,metrics:Ml,baselineOffset:Yo}=wr;Cn.push({glyph:_n,imageName:sn.imageName,x:kt,y:vt+Yo+ld,vertical:Xr,scale:sn.scale,fontStack:sn.fontStack,sectionIndex:gn,metrics:Ml,rect:Xo}),Xr?(H.verticalizable=!0,kt+=(sn.imageName?Ml.advance:nn)*sn.scale+Be):kt+=Ml.advance*sn.scale+Be}Cn.length!==0&&(Gt=Math.max(kt-Be,Gt),o1(Cn,0,Cn.length-1,on)),kt=0,wn.lineOffset=Math.max(Nn,(pn-1)*nn);const mn=Ae*pn+Nn;vt+=mn,$r=Math.max(mn,$r),++Mo}const{horizontalAlign:Jn,verticalAlign:xn}=pp(Ye);(function(Ir,pn,wn,Cn,Nn,Io,mn,Qn,sn){const gn=(pn-wn)*Nn;let _n=0;_n=Io!==mn?-Qn*Cn-ld:-Cn*sn*mn+.5*mn;for(const Xr of Ir)for(const wr of Xr.positionedGlyphs)wr.x+=gn,wr.y+=_n})(H.positionedLines,on,Jn,xn,Gt,$r,Ae,vt,ke.length),H.top+=-xn*vt,H.bottom=H.top+vt,H.left+=-Jn*Gt,H.right=H.left+Gt}(O,t,s,l,X,_,x,S,E,k,B,j),!function(H){for(const oe of H)if(oe.positionedGlyphs.length!==0)return!1;return!0}(ne)&&O}const ud={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Kx={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Jx={40:!0};function Gg(i,t,s,l,d,g){if(t.imageName){const _=l[t.imageName];return _?_.displaySize[0]*t.scale*nn/g+d:0}{const _=s[t.fontStack],x=_&&_[i];return x?x.metrics.advance*t.scale+d:0}}function qg(i,t,s,l){const d=Math.pow(i-t,2);return l?i<t?d/2:2*d:d+Math.abs(s)*s}function Qx(i,t,s){let l=0;return i===10&&(l-=1e4),s&&(l+=150),i!==40&&i!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function Wg(i,t,s,l,d,g){let _=null,x=qg(t,s,d,g);for(const S of l){const k=qg(t-S.x,s,d,g)+S.badness;k<=x&&(_=S,x=k)}return{index:i,x:t,priorBreak:_,badness:x}}function Hg(i){return i?Hg(i.priorBreak).concat(i.index):[]}function fp(i,t,s,l,d,g){if(!i)return[];const _=[],x=function(E,B,F,j,Z,X){let ee=0;for(let de=0;de<E.length();de++){const ne=E.getSection(de);ee+=Gg(E.getCharCode(de),ne,j,Z,B,X)}return ee/Math.max(1,Math.ceil(ee/F))}(i,t,s,l,d,g),S=i.text.indexOf("​")>=0;let k=0;for(let E=0;E<i.length();E++){const B=i.getSection(E),F=i.getCharCode(E);if(ud[F]||(k+=Gg(F,B,l,d,t,g)),E<i.length()-1){const j=!((M=F)<11904)&&(!!Nt["CJK Compatibility Forms"](M)||!!Nt["CJK Compatibility"](M)||!!Nt["CJK Strokes"](M)||!!Nt["CJK Symbols and Punctuation"](M)||!!Nt["Enclosed CJK Letters and Months"](M)||!!Nt["Halfwidth and Fullwidth Forms"](M)||!!Nt["Ideographic Description Characters"](M)||!!Nt["Vertical Forms"](M)||Fc.test(String.fromCodePoint(M)));(Kx[F]||j||B.imageName||E!==i.length()-2&&Jx[i.getCharCode(E+1)])&&_.push(Wg(E+1,k,x,_,Qx(F,i.getCharCode(E+1),j&&S),!1))}}var M;return Hg(Wg(i.length(),k,x,_,0,!0))}function pp(i){let t=.5,s=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:t,verticalAlign:s}}function e1(i,t,s){const l=t.getMaxScale()*nn,{maxImageWidth:d,maxImageHeight:g}=t.getMaxImageSize(i),_=Math.max(l,g*s);return{verticalLineContentWidth:Math.max(l,d*s),horizontalLineContentHeight:_}}function Xg(i){switch(i){case"top":return 0;case"center":return .5;default:return 1}}function t1(i,t,s){return!(i===b.ag.horizontal||!t&&!jc(s)||t&&(ud[s]||(l=s,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(l)))));var l}function r1(i,t,s,l,d,g){const _=g[i.fontStack],x=function(k,M,E,B){if(k&&k.rect)return k;const F=M[E.fontStack],j=F&&F[B];return j?{rect:null,metrics:j.metrics}:null}(_&&_[t],d,i,t);if(x===null)return null;let S;if(s)S=l.verticalLineContentWidth-i.scale*nn;else{const k=Xg(i.verticalAlign);S=(l.horizontalLineContentHeight-i.scale*nn)*k}return{rect:x.rect,metrics:x.metrics,baselineOffset:S}}function n1(i,t,s,l,d){const g=d[i.imageName];if(!g)return null;const _=g.paddedRect,x=g.displaySize,S={width:x[0],height:x[1],left:Kn,top:-3,advance:t?x[1]:x[0]};let k;if(t)k=l.verticalLineContentWidth-x[1]*i.scale;else{const M=Xg(i.verticalAlign);k=(l.horizontalLineContentHeight-x[1]*i.scale)*M}return{rect:_,metrics:S,baselineOffset:k,imageOffset:(t?x[0]:x[1])*i.scale-nn*s}}function o1(i,t,s,l){if(l===0)return;const d=i[s],g=(i[s].x+d.metrics.advance*d.scale)*l;for(let _=t;_<=s;_++)i[_].x-=g}function i1(i,t,s){const{horizontalAlign:l,verticalAlign:d}=pp(s),g=t[0]-i.displaySize[0]*l,_=t[1]-i.displaySize[1]*d;return{image:i,top:_,bottom:_+i.displaySize[1],left:g,right:g+i.displaySize[0]}}function Yg(i){var t,s;let l=i.left,d=i.top,g=i.right-l,_=i.bottom-d;const x=(t=i.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",S=(s=i.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",k=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(S==="proportional"){if(x==="stretchOnly"&&g/_<k||x==="proportional"){const M=Math.ceil(_*k);l*=M/g,g=M}}else if(x==="proportional"&&S==="stretchOnly"&&k!==0&&g/_>k){const M=Math.ceil(g/k);d*=M/_,_=M}return{x1:l,y1:d,x2:l+g,y2:d+_}}function Kg(i,t,s,l,d,g){const _=i.image;let x;if(_.content){const X=_.content,ee=_.pixelRatio||1;x=[X[0]/ee,X[1]/ee,_.displaySize[0]-X[2]/ee,_.displaySize[1]-X[3]/ee]}const S=t.left*g,k=t.right*g;let M,E,B,F;s==="width"||s==="both"?(F=d[0]+S-l[3],E=d[0]+k+l[1]):(F=d[0]+(S+k-_.displaySize[0])/2,E=F+_.displaySize[0]);const j=t.top*g,Z=t.bottom*g;return s==="height"||s==="both"?(M=d[1]+j-l[0],B=d[1]+Z+l[2]):(M=d[1]+(j+Z-_.displaySize[1])/2,B=M+_.displaySize[1]),{image:_,top:M,right:E,bottom:B,left:F,collisionPadding:x}}const hu=255,fi=128,bs=hu*fi;function Jg(i,t){const{expression:s}=t;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Tr(i+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:d}=s;let g=0;for(;g<l.length&&l[g]<=i;)g++;g=Math.max(0,g-1);let _=g;for(;_<l.length&&l[_]<i+1;)_++;_=Math.min(l.length-1,_);const x=l[g],S=l[_];return s.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:S,interpolationType:d}:{kind:"camera",minZoom:x,maxZoom:S,minSize:s.evaluate(new Tr(x)),maxSize:s.evaluate(new Tr(S)),interpolationType:d}}}function mp(i,t,s){let l="never";const d=i.get(t);return d?l=d:i.get(s)&&(l="always"),l}const s1=su.VectorTileFeature.types,a1=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function hd(i,t,s,l,d,g,_,x,S,k,M,E,B){const F=x?Math.min(bs,Math.round(x[0])):0,j=x?Math.min(bs,Math.round(x[1])):0;i.emplaceBack(t,s,Math.round(32*l),Math.round(32*d),g,_,(F<<1)+(S?1:0),j,16*k,16*M,256*E,256*B)}function gp(i,t,s){i.emplaceBack(t.x,t.y,s),i.emplaceBack(t.x,t.y,s),i.emplaceBack(t.x,t.y,s),i.emplaceBack(t.x,t.y,s)}function l1(i){for(const t of i.sections)if(Hh(t.text))return!0;return!1}class _p{constructor(t){this.layoutVertexArray=new we,this.indexArray=new rt,this.programConfigurations=t,this.segments=new Ct,this.dynamicLayoutVertexArray=new Se,this.opacityVertexArray=new Re,this.hasVisibleVertices=!1,this.placedSymbolArray=new T}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,s,l,d){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Nx.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Vx.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,a1,!0),this.opacityVertexBuffer.itemSize=1),(l||d)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}dt("SymbolBuffers",_p);class yp{constructor(t,s,l){this.layoutVertexArray=new t,this.layoutAttributes=s,this.indexArray=new l,this.segments=new Ct,this.collisionVertexArray=new ze}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Ux.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}dt("CollisionBuffers",yp);class Tl{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(_=>_.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Jg(this.zoom,s["text-size"]),this.iconSizeData=Jg(this.zoom,s["icon-size"]);const l=this.layers[0].layout,d=l.get("symbol-sort-key"),g=l.get("symbol-z-order");this.canOverlap=mp(l,"text-overlap","text-allow-overlap")!=="never"||mp(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(_=>b.ag[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=t.sourceID}createArrays(){this.text=new _p(new ji(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new _p(new ji(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new D,this.lineVertexArray=new L,this.symbolInstances=new A,this.textAnchorOffsets=new G}calculateGlyphDependencies(t,s,l,d,g){for(let _=0;_<t.length;_++)if(s[t.charCodeAt(_)]=!0,(l||d)&&g){const x=cu[t.charAt(_)];x&&(s[x.charCodeAt(0)]=!0)}}populate(t,s,l){const d=this.layers[0],g=d.layout,_=g.get("text-font"),x=g.get("text-field"),S=g.get("icon-image"),k=(x.value.kind!=="constant"||x.value.value instanceof vn&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),M=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,E=g.get("symbol-sort-key");if(this.features=[],!k&&!M)return;const B=s.iconDependencies,F=s.glyphDependencies,j=s.availableImages,Z=new Tr(this.zoom);for(const{feature:X,id:ee,index:de,sourceLayerIndex:ne}of t){const O=d._featureFilter.needGeometry,H=Yn(X,O);if(!d._featureFilter.filter(Z,H,l))continue;let oe,Ce;if(O||(H.geometry=Ni(X)),k){const ke=d.getValueAndResolveTokens("text-field",H,l,j),Ae=vn.factory(ke),Ye=this.hasRTLText=this.hasRTLText||l1(Ae);(!Ye||hi.getRTLTextPluginStatus()==="unavailable"||Ye&&hi.isParsed())&&(oe=Gx(Ae,d,H))}if(M){const ke=d.getValueAndResolveTokens("icon-image",H,l,j);Ce=ke instanceof zn?ke:zn.fromString(ke)}if(!oe&&!Ce)continue;const Ve=this.sortFeaturesByKey?E.evaluate(H,{},l):void 0;if(this.features.push({id:ee,text:oe,icon:Ce,index:de,sourceLayerIndex:ne,geometry:H.geometry,properties:X.properties,type:s1[X.type],sortKey:Ve}),Ce&&(B[Ce.name]=!0),oe){const ke=_.evaluate(H,{},l).join(","),Ae=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(b.ag.vertical)>=0;for(const Ye of oe.sections)if(Ye.image)B[Ye.image.name]=!0;else{const Ze=il(oe.toString()),Je=Ye.fontStack||ke,Be=F[Je]=F[Je]||{};this.calculateGlyphDependencies(Ye.text,Be,Ae,this.allowVerticalPlacement,Ze)}}}g.get("symbol-placement")==="line"&&(this.features=function(X){const ee={},de={},ne=[];let O=0;function H(ke){ne.push(X[ke]),O++}function oe(ke,Ae,Ye){const Ze=de[ke];return delete de[ke],de[Ae]=Ze,ne[Ze].geometry[0].pop(),ne[Ze].geometry[0]=ne[Ze].geometry[0].concat(Ye[0]),Ze}function Ce(ke,Ae,Ye){const Ze=ee[Ae];return delete ee[Ae],ee[ke]=Ze,ne[Ze].geometry[0].shift(),ne[Ze].geometry[0]=Ye[0].concat(ne[Ze].geometry[0]),Ze}function Ve(ke,Ae,Ye){const Ze=Ye?Ae[0][Ae[0].length-1]:Ae[0][0];return`${ke}:${Ze.x}:${Ze.y}`}for(let ke=0;ke<X.length;ke++){const Ae=X[ke],Ye=Ae.geometry,Ze=Ae.text?Ae.text.toString():null;if(!Ze){H(ke);continue}const Je=Ve(Ze,Ye),Be=Ve(Ze,Ye,!0);if(Je in de&&Be in ee&&de[Je]!==ee[Be]){const pt=Ce(Je,Be,Ye),Mt=oe(Je,Be,ne[pt].geometry);delete ee[Je],delete de[Be],de[Ve(Ze,ne[Mt].geometry,!0)]=Mt,ne[pt].geometry=null}else Je in de?oe(Je,Be,Ye):Be in ee?Ce(Je,Be,Ye):(H(ke),ee[Je]=O-1,de[Be]=O-1)}return ne.filter(ke=>ke.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((X,ee)=>X.sortKey-ee.sortKey)}update(t,s,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,s,this.layers,l),this.icon.programConfigurations.updatePaintArrays(t,s,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,s){const l=this.lineVertexArray.length;if(t.segment!==void 0){let d=t.dist(s[t.segment+1]),g=t.dist(s[t.segment]);const _={};for(let x=t.segment+1;x<s.length;x++)_[x]={x:s[x].x,y:s[x].y,tileUnitDistanceFromAnchor:d},x<s.length-1&&(d+=s[x+1].dist(s[x]));for(let x=t.segment||0;x>=0;x--)_[x]={x:s[x].x,y:s[x].y,tileUnitDistanceFromAnchor:g},x>0&&(g+=s[x-1].dist(s[x]));for(let x=0;x<s.length;x++){const S=_[x];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,s,l,d,g,_,x,S,k,M,E,B){const F=t.indexArray,j=t.layoutVertexArray,Z=t.segments.prepareSegment(4*s.length,j,F,this.canOverlap?_.sortKey:void 0),X=this.glyphOffsetArray.length,ee=Z.vertexLength,de=this.allowVerticalPlacement&&x===b.ag.vertical?Math.PI/2:0,ne=_.text&&_.text.sections;for(let O=0;O<s.length;O++){const{tl:H,tr:oe,bl:Ce,br:Ve,tex:ke,pixelOffsetTL:Ae,pixelOffsetBR:Ye,minFontScaleX:Ze,minFontScaleY:Je,glyphOffset:Be,isSDF:pt,sectionIndex:Mt}=s[O],kt=Z.vertexLength,vt=Be[1];hd(j,S.x,S.y,H.x,vt+H.y,ke.x,ke.y,l,pt,Ae.x,Ae.y,Ze,Je),hd(j,S.x,S.y,oe.x,vt+oe.y,ke.x+ke.w,ke.y,l,pt,Ye.x,Ae.y,Ze,Je),hd(j,S.x,S.y,Ce.x,vt+Ce.y,ke.x,ke.y+ke.h,l,pt,Ae.x,Ye.y,Ze,Je),hd(j,S.x,S.y,Ve.x,vt+Ve.y,ke.x+ke.w,ke.y+ke.h,l,pt,Ye.x,Ye.y,Ze,Je),gp(t.dynamicLayoutVertexArray,S,de),F.emplaceBack(kt,kt+2,kt+1),F.emplaceBack(kt+1,kt+2,kt+3),Z.vertexLength+=4,Z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Be[0]),O!==s.length-1&&Mt===s[O+1].sectionIndex||t.programConfigurations.populatePaintArrays(j.length,_,_.index,{},B,ne&&ne[Mt])}t.placedSymbolArray.emplaceBack(S.x,S.y,X,this.glyphOffsetArray.length-X,ee,k,M,S.segment,l?l[0]:0,l?l[1]:0,d[0],d[1],x,0,!1,0,E)}_addCollisionDebugVertex(t,s,l,d,g,_){return s.emplaceBack(0,0),t.emplaceBack(l.x,l.y,d,g,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(t,s,l,d,g,_,x){const S=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),k=S.vertexLength,M=g.layoutVertexArray,E=g.collisionVertexArray,B=x.anchorX,F=x.anchorY;this._addCollisionDebugVertex(M,E,_,B,F,new ie(t,s)),this._addCollisionDebugVertex(M,E,_,B,F,new ie(l,s)),this._addCollisionDebugVertex(M,E,_,B,F,new ie(l,d)),this._addCollisionDebugVertex(M,E,_,B,F,new ie(t,d)),S.vertexLength+=4;const j=g.indexArray;j.emplaceBack(k,k+1),j.emplaceBack(k+1,k+2),j.emplaceBack(k+2,k+3),j.emplaceBack(k+3,k),S.primitiveLength+=4}addDebugCollisionBoxes(t,s,l,d){for(let g=t;g<s;g++){const _=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,d?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new yp(Le,Fg.members,et),this.iconCollisionBox=new yp(Le,Fg.members,et);for(let t=0;t<this.symbolInstances.length;t++){const s=this.symbolInstances.get(t);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(t,s,l,d,g,_,x,S,k){const M={};for(let E=s;E<l;E++){const B=t.get(E);M.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.textFeatureIndex=B.featureIndex;break}for(let E=d;E<g;E++){const B=t.get(E);M.verticalTextBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.verticalTextFeatureIndex=B.featureIndex;break}for(let E=_;E<x;E++){const B=t.get(E);M.iconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.iconFeatureIndex=B.featureIndex;break}for(let E=S;E<k;E++){const B=t.get(E);M.verticalIconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.verticalIconFeatureIndex=B.featureIndex;break}return M}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const l=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,s){const l=t.placedSymbolArray.get(s),d=l.vertexStartIndex+4*l.numGlyphs;for(let g=l.vertexStartIndex;g<d;g+=4)t.indexArray.emplaceBack(g,g+2,g+1),t.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(t),l=Math.cos(t),d=[],g=[],_=[];for(let x=0;x<this.symbolInstances.length;++x){_.push(x);const S=this.symbolInstances.get(x);d.push(0|Math.round(s*S.anchorX+l*S.anchorY)),g.push(S.featureIndex)}return _.sort((x,S)=>d[x]-d[S]||g[S]-g[x]),_}addToSortKeyRanges(t,s){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===s?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const l=this.symbolInstances.get(s);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((d,g,_)=>{d>=0&&_.indexOf(d)===g&&this.addIndicesForPlacedSymbol(this.text,d)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Qg,e_;dt("SymbolBucket",Tl,{omit:["layers","collisionBoxArray","features","compareText"]}),Tl.MAX_GLYPHS=65535,Tl.addDynamicAttributes=gp;var vp={get paint(){return e_=e_||new jn({"icon-opacity":new Et(z.paint_symbol["icon-opacity"]),"icon-color":new Et(z.paint_symbol["icon-color"]),"icon-halo-color":new Et(z.paint_symbol["icon-halo-color"]),"icon-halo-width":new Et(z.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Et(z.paint_symbol["icon-halo-blur"]),"icon-translate":new wt(z.paint_symbol["icon-translate"]),"icon-translate-anchor":new wt(z.paint_symbol["icon-translate-anchor"]),"text-opacity":new Et(z.paint_symbol["text-opacity"]),"text-color":new Et(z.paint_symbol["text-color"],{runtimeType:Ot,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Et(z.paint_symbol["text-halo-color"]),"text-halo-width":new Et(z.paint_symbol["text-halo-width"]),"text-halo-blur":new Et(z.paint_symbol["text-halo-blur"]),"text-translate":new wt(z.paint_symbol["text-translate"]),"text-translate-anchor":new wt(z.paint_symbol["text-translate-anchor"])})},get layout(){return Qg=Qg||new jn({"symbol-placement":new wt(z.layout_symbol["symbol-placement"]),"symbol-spacing":new wt(z.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wt(z.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Et(z.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wt(z.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new wt(z.layout_symbol["icon-allow-overlap"]),"icon-overlap":new wt(z.layout_symbol["icon-overlap"]),"icon-ignore-placement":new wt(z.layout_symbol["icon-ignore-placement"]),"icon-optional":new wt(z.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wt(z.layout_symbol["icon-rotation-alignment"]),"icon-size":new Et(z.layout_symbol["icon-size"]),"icon-text-fit":new wt(z.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wt(z.layout_symbol["icon-text-fit-padding"]),"icon-image":new Et(z.layout_symbol["icon-image"]),"icon-rotate":new Et(z.layout_symbol["icon-rotate"]),"icon-padding":new Et(z.layout_symbol["icon-padding"]),"icon-keep-upright":new wt(z.layout_symbol["icon-keep-upright"]),"icon-offset":new Et(z.layout_symbol["icon-offset"]),"icon-anchor":new Et(z.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wt(z.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wt(z.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wt(z.layout_symbol["text-rotation-alignment"]),"text-field":new Et(z.layout_symbol["text-field"]),"text-font":new Et(z.layout_symbol["text-font"]),"text-size":new Et(z.layout_symbol["text-size"]),"text-max-width":new Et(z.layout_symbol["text-max-width"]),"text-line-height":new wt(z.layout_symbol["text-line-height"]),"text-letter-spacing":new Et(z.layout_symbol["text-letter-spacing"]),"text-justify":new Et(z.layout_symbol["text-justify"]),"text-radial-offset":new Et(z.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wt(z.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Et(z.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Et(z.layout_symbol["text-anchor"]),"text-max-angle":new wt(z.layout_symbol["text-max-angle"]),"text-writing-mode":new wt(z.layout_symbol["text-writing-mode"]),"text-rotate":new Et(z.layout_symbol["text-rotate"]),"text-padding":new wt(z.layout_symbol["text-padding"]),"text-keep-upright":new wt(z.layout_symbol["text-keep-upright"]),"text-transform":new Et(z.layout_symbol["text-transform"]),"text-offset":new Et(z.layout_symbol["text-offset"]),"text-allow-overlap":new wt(z.layout_symbol["text-allow-overlap"]),"text-overlap":new wt(z.layout_symbol["text-overlap"]),"text-ignore-placement":new wt(z.layout_symbol["text-ignore-placement"]),"text-optional":new wt(z.layout_symbol["text-optional"])})}};class t_{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:zt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(t.formattedSection))return s.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}dt("FormatSectionOverride",t_,{omit:["defaultValue"]});class dd extends Do{constructor(t){super(t,vp)}recalculate(t,s){if(super.recalculate(t,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const d=[];for(const g of l)d.indexOf(g)<0&&d.push(g);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,s,l,d){const g=this.layout.get(t).evaluate(s,{},l,d),_=this._unevaluatedLayout._values[t];return _.isDataDriven()||Ka(_.value)||!g?g:function(x,S){return S.replace(/{([^{}]+)}/g,(k,M)=>x&&M in x?String(x[M]):"")}(s.properties,g)}createBucket(t){return new Tl(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of vp.paint.overridableProperties){if(!dd.hasPaintOverride(this.layout,t))continue;const s=this.paint.get(t),l=new t_(s),d=new Sc(l,s.property.specification);let g=null;g=s.value.kind==="constant"||s.value.kind==="source"?new Ja("source",d):new Tc("composite",d,s.value.zoomStops),this.paint._values[t]=new po(s.property,g,s.parameters)}}_handleOverridablePaintPropertyUpdate(t,s,l){return!(!this.layout||s.isDataDriven()||l.isDataDriven())&&dd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,s){const l=t.get("text-field"),d=vp.paint.properties[s];let g=!1;const _=x=>{for(const S of x)if(d.overrides&&d.overrides.hasOverride(S))return void(g=!0)};if(l.value.kind==="constant"&&l.value.value instanceof vn)_(l.value.value.sections);else if(l.value.kind==="source"){const x=k=>{g||(k instanceof lo&&Hr(k.value)===Wr?_(k.value.sections):k instanceof Ti?_(k.sections):k.eachChild(x))},S=l.value;S._styleExpression&&x(S._styleExpression.expression)}return g}}let r_;var c1={get paint(){return r_=r_||new jn({"background-color":new wt(z.paint_background["background-color"]),"background-pattern":new cl(z.paint_background["background-pattern"]),"background-opacity":new wt(z.paint_background["background-opacity"])})}};class u1 extends Do{constructor(t){super(t,c1)}}let n_;var h1={get paint(){return n_=n_||new jn({"raster-opacity":new wt(z.paint_raster["raster-opacity"]),"raster-hue-rotate":new wt(z.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wt(z.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wt(z.paint_raster["raster-brightness-max"]),"raster-saturation":new wt(z.paint_raster["raster-saturation"]),"raster-contrast":new wt(z.paint_raster["raster-contrast"]),"raster-resampling":new wt(z.paint_raster["raster-resampling"]),"raster-fade-duration":new wt(z.paint_raster["raster-fade-duration"])})}};class d1 extends Do{constructor(t){super(t,h1)}}class f1 extends Do{constructor(t){super(t,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class p1{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const m1={once:!0},bp=63710088e-1;class xs{constructor(t,s){if(isNaN(t)||isNaN(s))throw new Error(`Invalid LngLat object: (${t}, ${s})`);if(this.lng=+t,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new xs(zr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const s=Math.PI/180,l=this.lat*s,d=t.lat*s,g=Math.sin(l)*Math.sin(d)+Math.cos(l)*Math.cos(d)*Math.cos((t.lng-this.lng)*s);return bp*Math.acos(Math.min(g,1))}static convert(t){if(t instanceof xs)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new xs(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new xs(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const o_=2*Math.PI*bp;function i_(i){return o_*Math.cos(i*Math.PI/180)}function s_(i){return(180+i)/360}function a_(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function l_(i,t){return i/i_(t)}function xp(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function c_(i,t){return i*i_(xp(t))}class du{constructor(t,s,l=0){this.x=+t,this.y=+s,this.z=+l}static fromLngLat(t,s=0){const l=xs.convert(t);return new du(s_(l.lng),a_(l.lat),l_(s,l.lat))}toLngLat(){return new xs(360*this.x-180,xp(this.y))}toAltitude(){return c_(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/o_*(t=xp(this.y),1/Math.cos(t*Math.PI/180));var t}}function u_(i,t,s){var l=2*Math.PI*6378137/256/Math.pow(2,s);return[i*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class wp{constructor(t,s,l){if(!function(d,g,_){return!(d<0||d>25||_<0||_>=Math.pow(2,d)||g<0||g>=Math.pow(2,d))}(t,s,l))throw new Error(`x=${s}, y=${l}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=s,this.y=l,this.key=kl(0,t,t,s,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,s,l){const d=(_=this.y,x=this.z,S=u_(256*(g=this.x),256*(_=Math.pow(2,x)-_-1),x),k=u_(256*(g+1),256*(_+1),x),S[0]+","+S[1]+","+k[0]+","+k[1]);var g,_,x,S,k;const M=function(E,B,F){let j,Z="";for(let X=E;X>0;X--)j=1<<X-1,Z+=(B&j?1:0)+(F&j?2:0);return Z}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,d)}isChildOf(t){const s=this.z-t.z;return s>0&&t.x===this.x>>s&&t.y===this.y>>s}getTilePoint(t){const s=Math.pow(2,this.z);return new ie((t.x*s-this.x)*ft,(t.y*s-this.y)*ft)}toString(){return`${this.z}/${this.x}/${this.y}`}}class h_{constructor(t,s){this.wrap=t,this.canonical=s,this.key=kl(t,s.z,s.z,s.x,s.y)}}class Po{constructor(t,s,l,d,g){if(this.terrainRttPosMatrix32f=null,t<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${l}`);this.overscaledZ=t,this.wrap=s,this.canonical=new wp(l,+d,+g),this.key=kl(s,t,l,d,g)}clone(){return new Po(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-t;return t>this.canonical.z?new Po(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Po(t,this.wrap,t,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(t,s){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-t;return t>this.canonical.z?kl(this.wrap*+s,t,this.canonical.z,this.canonical.x,this.canonical.y):kl(this.wrap*+s,t,t,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const s=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>s&&t.canonical.y===this.canonical.y>>s}children(t){if(this.overscaledZ>=t)return[new Po(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,l=2*this.canonical.x,d=2*this.canonical.y;return[new Po(s,this.wrap,s,l,d),new Po(s,this.wrap,s,l+1,d),new Po(s,this.wrap,s,l,d+1),new Po(s,this.wrap,s,l+1,d+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Po(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Po(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new h_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new du(t.x-this.wrap,t.y))}}function kl(i,t,s,l,d){(i*=2)<0&&(i=-1*i-1);const g=1<<s;return(g*g*i+g*d+l).toString(36)+s.toString(36)+t.toString(36)}dt("CanonicalTileID",wp),dt("OverscaledTileID",Po,{omit:["terrainRttPosMatrix32f"]});class d_{constructor(t,s,l,d=1,g=1,_=1,x=0){if(this.uid=t,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void Jr(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const S=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=d,this.greenFactor=g,this.blueFactor=_,this.baseShift=x;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<S;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(S,k)]=this.data[this._idx(S-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,S)]=this.data[this._idx(k,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<S;k++)for(let M=0;M<S;M++){const E=this.get(k,M);E>this.max&&(this.max=E),E<this.min&&(this.min=E)}}get(t,s){const l=new Uint8Array(this.data.buffer),d=4*this._idx(t,s);return this.unpack(l[d],l[d+1],l[d+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,s){if(t<-1||t>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(t+1)}unpack(t,s,l){return t*this.redFactor+s*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new ko({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,s,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let d=s*this.dim,g=s*this.dim+this.dim,_=l*this.dim,x=l*this.dim+this.dim;switch(s){case-1:d=g-1;break;case 1:g=d+1}switch(l){case-1:_=x-1;break;case 1:x=_+1}const S=-s*this.dim,k=-l*this.dim;for(let M=_;M<x;M++)for(let E=d;E<g;E++)this.data[this._idx(E,M)]=t.data[this._idx(E+S,M+k)]}}dt("DEMData",d_);class f_{constructor(t){this._stringToNumber={},this._numberToString=[];for(let s=0;s<t.length;s++){const l=t[s];this._stringToNumber[l]=s,this._numberToString[s]=l}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class p_{constructor(t,s,l,d,g){this.type="Feature",this._vectorTileFeature=t,t._z=s,t._x=l,t._y=d,this.properties=t.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(t[s]=this[s]);return t}}class m_{constructor(t,s){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ta(ft,16,0),this.grid3D=new ta(ft,16,0),this.featureIndexArray=new K,this.promoteId=s}insert(t,s,l,d,g,_){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,d,g);const S=_?this.grid3D:this.grid;for(let k=0;k<s.length;k++){const M=s[k],E=[1/0,1/0,-1/0,-1/0];for(let B=0;B<M.length;B++){const F=M[B];E[0]=Math.min(E[0],F.x),E[1]=Math.min(E[1],F.y),E[2]=Math.max(E[2],F.x),E[3]=Math.max(E[3],F.y)}E[0]<ft&&E[1]<ft&&E[2]>=0&&E[3]>=0&&S.insert(x,E[0],E[1],E[2],E[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new su.VectorTile(new up(this.rawTileData)).layers,this.sourceLayerCoder=new f_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,s,l,d){this.loadVTLayers();const g=t.params,_=ft/t.tileSize/t.scale,x=tl(g.filter),S=t.queryGeometry,k=t.queryPadding*_,M=__(S),E=this.grid.query(M.minX-k,M.minY-k,M.maxX+k,M.maxY+k),B=__(t.cameraQueryGeometry),F=this.grid3D.query(B.minX-k,B.minY-k,B.maxX+k,B.maxY+k,(X,ee,de,ne)=>function(O,H,oe,Ce,Ve){for(const Ae of O)if(H<=Ae.x&&oe<=Ae.y&&Ce>=Ae.x&&Ve>=Ae.y)return!0;const ke=[new ie(H,oe),new ie(H,Ve),new ie(Ce,Ve),new ie(Ce,oe)];if(O.length>2){for(const Ae of ke)if(bl(O,Ae))return!0}for(let Ae=0;Ae<O.length-1;Ae++)if(nx(O[Ae],O[Ae+1],ke))return!0;return!1}(t.cameraQueryGeometry,X-k,ee-k,de+k,ne+k));for(const X of F)E.push(X);E.sort(g1);const j={};let Z;for(let X=0;X<E.length;X++){const ee=E[X];if(ee===Z)continue;Z=ee;const de=this.featureIndexArray.get(ee);let ne=null;this.loadMatchingFeature(j,de.bucketIndex,de.sourceLayerIndex,de.featureIndex,x,g.layers,g.availableImages,s,l,d,(O,H,oe)=>(ne||(ne=Ni(O)),H.queryIntersectsFeature({queryGeometry:S,feature:O,featureState:oe,geometry:ne,zoom:this.z,transform:t.transform,pixelsToTileUnits:_,pixelPosMatrix:t.pixelPosMatrix})))}return j}loadMatchingFeature(t,s,l,d,g,_,x,S,k,M,E){const B=this.bucketLayerIDs[s];if(_&&!B.some(X=>_.has(X)))return;const F=this.sourceLayerCoder.decode(l),j=this.vtLayers[F].feature(d);if(g.needGeometry){const X=Yn(j,!0);if(!g.filter(new Tr(this.tileID.overscaledZ),X,this.tileID.canonical))return}else if(!g.filter(new Tr(this.tileID.overscaledZ),j))return;const Z=this.getId(j,F);for(let X=0;X<B.length;X++){const ee=B[X];if(_&&!_.has(ee))continue;const de=S[ee];if(!de)continue;let ne={};Z&&M&&(ne=M.getState(de.sourceLayer||"_geojsonTileLayer",Z));const O=Cr({},k[ee]);O.paint=g_(O.paint,de.paint,j,ne,x),O.layout=g_(O.layout,de.layout,j,ne,x);const H=!E||E(j,de,ne);if(!H)continue;const oe=new p_(j,this.z,this.x,this.y,Z);oe.layer=O;let Ce=t[ee];Ce===void 0&&(Ce=t[ee]=[]),Ce.push({featureIndex:d,feature:oe,intersectionZ:H})}}lookupSymbolFeatures(t,s,l,d,g,_,x,S){const k={};this.loadVTLayers();const M=tl(g);for(const E of t)this.loadMatchingFeature(k,l,d,E,M,_,x,S,s);return k}hasLayer(t){for(const s of this.bucketLayerIDs)for(const l of s)if(t===l)return!0;return!1}getId(t,s){var l;let d=t.id;return this.promoteId&&(d=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof d=="boolean"&&(d=Number(d)),d===void 0&&(!((l=t.properties)===null||l===void 0)&&l.cluster)&&this.promoteId&&(d=Number(t.properties.cluster_id))),d}}function g_(i,t,s,l,d){return Tn(i,(g,_)=>{const x=t instanceof ll?t.get(_):null;return x&&x.evaluate?x.evaluate(s,l,d):x})}function __(i){let t=1/0,s=1/0,l=-1/0,d=-1/0;for(const g of i)t=Math.min(t,g.x),s=Math.min(s,g.y),l=Math.max(l,g.x),d=Math.max(d,g.y);return{minX:t,minY:s,maxX:l,maxY:d}}function g1(i,t){return t-i}function y_(i,t,s,l,d){const g=[];for(let _=0;_<i.length;_++){const x=i[_];let S;for(let k=0;k<x.length-1;k++){let M=x[k],E=x[k+1];M.x<t&&E.x<t||(M.x<t?M=new ie(t,M.y+(t-M.x)/(E.x-M.x)*(E.y-M.y))._round():E.x<t&&(E=new ie(t,M.y+(t-M.x)/(E.x-M.x)*(E.y-M.y))._round()),M.y<s&&E.y<s||(M.y<s?M=new ie(M.x+(s-M.y)/(E.y-M.y)*(E.x-M.x),s)._round():E.y<s&&(E=new ie(M.x+(s-M.y)/(E.y-M.y)*(E.x-M.x),s)._round()),M.x>=l&&E.x>=l||(M.x>=l?M=new ie(l,M.y+(l-M.x)/(E.x-M.x)*(E.y-M.y))._round():E.x>=l&&(E=new ie(l,M.y+(l-M.x)/(E.x-M.x)*(E.y-M.y))._round()),M.y>=d&&E.y>=d||(M.y>=d?M=new ie(M.x+(d-M.y)/(E.y-M.y)*(E.x-M.x),d)._round():E.y>=d&&(E=new ie(M.x+(d-M.y)/(E.y-M.y)*(E.x-M.x),d)._round()),S&&M.equals(S[S.length-1])||(S=[M],g.push(S)),S.push(E)))))}}return g}dt("FeatureIndex",m_,{omit:["rawTileData","sourceLayerCoder"]});class ws extends ie{constructor(t,s,l,d){super(t,s),this.angle=l,d!==void 0&&(this.segment=d)}clone(){return new ws(this.x,this.y,this.angle,this.segment)}}function v_(i,t,s,l,d){if(t.segment===void 0||s===0)return!0;let g=t,_=t.segment+1,x=0;for(;x>-s/2;){if(_--,_<0)return!1;x-=i[_].dist(g),g=i[_]}x+=i[_].dist(i[_+1]),_++;const S=[];let k=0;for(;x<s/2;){const M=i[_],E=i[_+1];if(!E)return!1;let B=i[_-1].angleTo(M)-M.angleTo(E);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:x,angleDelta:B}),k+=B;x-S[0].distance>l;)k-=S.shift().angleDelta;if(k>d)return!1;_++,x+=M.dist(E)}return!0}function b_(i){let t=0;for(let s=0;s<i.length-1;s++)t+=i[s].dist(i[s+1]);return t}function x_(i,t,s){return i?.6*t*s:0}function w_(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function _1(i,t,s,l,d,g){const _=x_(s,d,g),x=w_(s,l)*g;let S=0;const k=b_(i)/2;for(let M=0;M<i.length-1;M++){const E=i[M],B=i[M+1],F=E.dist(B);if(S+F>k){const j=(k-S)/F,Z=Hn.number(E.x,B.x,j),X=Hn.number(E.y,B.y,j),ee=new ws(Z,X,B.angleTo(E),M);return ee._round(),!_||v_(i,ee,x,_,t)?ee:void 0}S+=F}}function y1(i,t,s,l,d,g,_,x,S){const k=x_(l,g,_),M=w_(l,d),E=M*_,B=i[0].x===0||i[0].x===S||i[0].y===0||i[0].y===S;return t-E<t/4&&(t=E+t/4),C_(i,B?t/2*x%t:(M/2+2*g)*_*x%t,t,k,s,E,B,!1,S)}function C_(i,t,s,l,d,g,_,x,S){const k=g/2,M=b_(i);let E=0,B=t-s,F=[];for(let j=0;j<i.length-1;j++){const Z=i[j],X=i[j+1],ee=Z.dist(X),de=X.angleTo(Z);for(;B+s<E+ee;){B+=s;const ne=(B-E)/ee,O=Hn.number(Z.x,X.x,ne),H=Hn.number(Z.y,X.y,ne);if(O>=0&&O<S&&H>=0&&H<S&&B-k>=0&&B+k<=M){const oe=new ws(O,H,de,j);oe._round(),l&&!v_(i,oe,g,l,d)||F.push(oe)}}E+=ee}return x||F.length||_||(F=C_(i,E/2,s,l,d,g,_,!0,S)),F}dt("Anchor",ws);const fu=Kn;function S_(i,t,s,l){const d=[],g=i.image,_=g.pixelRatio,x=g.paddedRect.w-2*fu,S=g.paddedRect.h-2*fu;let k={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const M=g.stretchX||[[0,x]],E=g.stretchY||[[0,S]],B=(Be,pt)=>Be+pt[1]-pt[0],F=M.reduce(B,0),j=E.reduce(B,0),Z=x-F,X=S-j;let ee=0,de=F,ne=0,O=j,H=0,oe=Z,Ce=0,Ve=X;if(g.content&&l){const Be=g.content,pt=Be[2]-Be[0],Mt=Be[3]-Be[1];(g.textFitWidth||g.textFitHeight)&&(k=Yg(i)),ee=fd(M,0,Be[0]),ne=fd(E,0,Be[1]),de=fd(M,Be[0],Be[2]),O=fd(E,Be[1],Be[3]),H=Be[0]-ee,Ce=Be[1]-ne,oe=pt-de,Ve=Mt-O}const ke=k.x1,Ae=k.y1,Ye=k.x2-ke,Ze=k.y2-Ae,Je=(Be,pt,Mt,kt)=>{const vt=pd(Be.stretch-ee,de,Ye,ke),Gt=md(Be.fixed-H,oe,Be.stretch,F),$r=pd(pt.stretch-ne,O,Ze,Ae),on=md(pt.fixed-Ce,Ve,pt.stretch,j),En=pd(Mt.stretch-ee,de,Ye,ke),Mo=md(Mt.fixed-H,oe,Mt.stretch,F),Jn=pd(kt.stretch-ne,O,Ze,Ae),xn=md(kt.fixed-Ce,Ve,kt.stretch,j),Ir=new ie(vt,$r),pn=new ie(En,$r),wn=new ie(En,Jn),Cn=new ie(vt,Jn),Nn=new ie(Gt/_,on/_),Io=new ie(Mo/_,xn/_),mn=t*Math.PI/180;if(mn){const gn=Math.sin(mn),_n=Math.cos(mn),Xr=[_n,-gn,gn,_n];Ir._matMult(Xr),pn._matMult(Xr),Cn._matMult(Xr),wn._matMult(Xr)}const Qn=Be.stretch+Be.fixed,sn=pt.stretch+pt.fixed;return{tl:Ir,tr:pn,bl:Cn,br:wn,tex:{x:g.paddedRect.x+fu+Qn,y:g.paddedRect.y+fu+sn,w:Mt.stretch+Mt.fixed-Qn,h:kt.stretch+kt.fixed-sn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Nn,pixelOffsetBR:Io,minFontScaleX:oe/_/Ye,minFontScaleY:Ve/_/Ze,isSDF:s}};if(l&&(g.stretchX||g.stretchY)){const Be=T_(M,Z,F),pt=T_(E,X,j);for(let Mt=0;Mt<Be.length-1;Mt++){const kt=Be[Mt],vt=Be[Mt+1];for(let Gt=0;Gt<pt.length-1;Gt++)d.push(Je(kt,pt[Gt],vt,pt[Gt+1]))}}else d.push(Je({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:S+1}));return d}function fd(i,t,s){let l=0;for(const d of i)l+=Math.max(t,Math.min(s,d[1]))-Math.max(t,Math.min(s,d[0]));return l}function T_(i,t,s){const l=[{fixed:-1,stretch:0}];for(const[d,g]of i){const _=l[l.length-1];l.push({fixed:d-_.stretch,stretch:_.stretch}),l.push({fixed:d-_.stretch,stretch:_.stretch+(g-d)})}return l.push({fixed:t+fu,stretch:s}),l}function pd(i,t,s,l){return i/t*s+l}function md(i,t,s,l){return i-t*s/l}class gd{constructor(t,s,l,d,g,_,x,S,k,M){var E;if(this.boxStartIndex=t.length,k){let B=_.top,F=_.bottom;const j=_.collisionPadding;j&&(B-=j[1],F+=j[3]);let Z=F-B;Z>0&&(Z=Math.max(10,Z),this.circleDiameter=Z)}else{const B=!((E=_.image)===null||E===void 0)&&E.content&&(_.image.textFitWidth||_.image.textFitHeight)?Yg(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};B.y1=B.y1*x-S[0],B.y2=B.y2*x+S[2],B.x1=B.x1*x-S[3],B.x2=B.x2*x+S[1];const F=_.collisionPadding;if(F&&(B.x1-=F[0]*x,B.y1-=F[1]*x,B.x2+=F[2]*x,B.y2+=F[3]*x),M){const j=new ie(B.x1,B.y1),Z=new ie(B.x2,B.y1),X=new ie(B.x1,B.y2),ee=new ie(B.x2,B.y2),de=M*Math.PI/180;j._rotate(de),Z._rotate(de),X._rotate(de),ee._rotate(de),B.x1=Math.min(j.x,Z.x,X.x,ee.x),B.x2=Math.max(j.x,Z.x,X.x,ee.x),B.y1=Math.min(j.y,Z.y,X.y,ee.y),B.y2=Math.max(j.y,Z.y,X.y,ee.y)}t.emplaceBack(s.x,s.y,B.x1,B.y1,B.x2,B.y2,l,d,g)}this.boxEndIndex=t.length}}class v1{constructor(t=[],s=(l,d)=>l<d?-1:l>d?1:0){if(this.data=t,this.length=this.data.length,this.compare=s,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:s,compare:l}=this,d=s[t];for(;t>0;){const g=t-1>>1,_=s[g];if(l(d,_)>=0)break;s[t]=_,t=g}s[t]=d}_down(t){const{data:s,compare:l}=this,d=this.length>>1,g=s[t];for(;t<d;){let _=1+(t<<1);const x=_+1;if(x<this.length&&l(s[x],s[_])<0&&(_=x),l(s[_],g)>=0)break;s[t]=s[_],t=_}s[t]=g}}function b1(i,t=1,s=!1){let l=1/0,d=1/0,g=-1/0,_=-1/0;const x=i[0];for(let F=0;F<x.length;F++){const j=x[F];(!F||j.x<l)&&(l=j.x),(!F||j.y<d)&&(d=j.y),(!F||j.x>g)&&(g=j.x),(!F||j.y>_)&&(_=j.y)}const S=Math.min(g-l,_-d);let k=S/2;const M=new v1([],x1);if(S===0)return new ie(l,d);for(let F=l;F<g;F+=S)for(let j=d;j<_;j+=S)M.push(new Pl(F+k,j+k,k,i));let E=function(F){let j=0,Z=0,X=0;const ee=F[0];for(let de=0,ne=ee.length,O=ne-1;de<ne;O=de++){const H=ee[de],oe=ee[O],Ce=H.x*oe.y-oe.x*H.y;Z+=(H.x+oe.x)*Ce,X+=(H.y+oe.y)*Ce,j+=3*Ce}return new Pl(Z/j,X/j,0,F)}(i),B=M.length;for(;M.length;){const F=M.pop();(F.d>E.d||!E.d)&&(E=F,s&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,B)),F.max-E.d<=t||(k=F.h/2,M.push(new Pl(F.p.x-k,F.p.y-k,k,i)),M.push(new Pl(F.p.x+k,F.p.y-k,k,i)),M.push(new Pl(F.p.x-k,F.p.y+k,k,i)),M.push(new Pl(F.p.x+k,F.p.y+k,k,i)),B+=4)}return s&&(console.log(`num probes: ${B}`),console.log(`best distance: ${E.d}`)),E.p}function x1(i,t){return t.max-i.max}function Pl(i,t,s,l){this.p=new ie(i,t),this.h=s,this.d=function(d,g){let _=!1,x=1/0;for(let S=0;S<g.length;S++){const k=g[S];for(let M=0,E=k.length,B=E-1;M<E;B=M++){const F=k[M],j=k[B];F.y>d.y!=j.y>d.y&&d.x<(j.x-F.x)*(d.y-F.y)/(j.y-F.y)+F.x&&(_=!_),x=Math.min(x,ig(d,F,j))}}return(_?1:-1)*Math.sqrt(x)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var In;b.ax=void 0,(In=b.ax||(b.ax={}))[In.center=1]="center",In[In.left=2]="left",In[In.right=3]="right",In[In.top=4]="top",In[In.bottom=5]="bottom",In[In["top-left"]=6]="top-left",In[In["top-right"]=7]="top-right",In[In["bottom-left"]=8]="bottom-left",In[In["bottom-right"]=9]="bottom-right";const Cs=7,Cp=Number.POSITIVE_INFINITY;function k_(i,t){return t[1]!==Cp?function(s,l,d){let g=0,_=0;switch(l=Math.abs(l),d=Math.abs(d),s){case"top-right":case"top-left":case"top":_=d-Cs;break;case"bottom-right":case"bottom-left":case"bottom":_=-d+Cs}switch(s){case"top-right":case"bottom-right":case"right":g=-l;break;case"top-left":case"bottom-left":case"left":g=l}return[g,_]}(i,t[0],t[1]):function(s,l){let d=0,g=0;l<0&&(l=0);const _=l/Math.SQRT2;switch(s){case"top-right":case"top-left":g=_-Cs;break;case"bottom-right":case"bottom-left":g=-_+Cs;break;case"bottom":g=-l+Cs;break;case"top":g=l-Cs}switch(s){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=l;break;case"right":d=-l}return[d,g]}(i,t[0])}function P_(i,t,s){var l;const d=i.layout,g=(l=d.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(t,{},s);if(g){const x=g.values,S=[];for(let k=0;k<x.length;k+=2){const M=S[k]=x[k],E=x[k+1].map(B=>B*nn);M.startsWith("top")?E[1]-=Cs:M.startsWith("bottom")&&(E[1]+=Cs),S[k+1]=E}return new hn(S)}const _=d.get("text-variable-anchor");if(_){let x;x=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[d.get("text-radial-offset").evaluate(t,{},s)*nn,Cp]:d.get("text-offset").evaluate(t,{},s).map(k=>k*nn);const S=[];for(const k of _)S.push(k,k_(k,x));return new hn(S)}return null}function Sp(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function w1(i,t,s,l,d,g,_,x,S,k,M,E){let B=g.textMaxSize.evaluate(t,{});B===void 0&&(B=_);const F=i.layers[0].layout,j=F.get("icon-offset").evaluate(t,{},M),Z=I_(s.horizontal),X=_/24,ee=i.tilePixelRatio*X,de=i.tilePixelRatio*B/24,ne=i.tilePixelRatio*x,O=i.tilePixelRatio*F.get("symbol-spacing"),H=F.get("text-padding")*i.tilePixelRatio,oe=function(Mt,kt,vt,Gt=1){const $r=Mt.get("icon-padding").evaluate(kt,{},vt),on=$r&&$r.values;return[on[0]*Gt,on[1]*Gt,on[2]*Gt,on[3]*Gt]}(F,t,M,i.tilePixelRatio),Ce=F.get("text-max-angle")/180*Math.PI,Ve=F.get("text-rotation-alignment")!=="viewport"&&F.get("symbol-placement")!=="point",ke=F.get("icon-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",Ae=F.get("symbol-placement"),Ye=O/2,Ze=F.get("icon-text-fit");let Je;l&&Ze!=="none"&&(i.allowVerticalPlacement&&s.vertical&&(Je=Kg(l,s.vertical,Ze,F.get("icon-text-fit-padding"),j,X)),Z&&(l=Kg(l,Z,Ze,F.get("icon-text-fit-padding"),j,X)));const Be=M?E.line.getGranularityForZoomLevel(M.z):1,pt=(Mt,kt)=>{kt.x<0||kt.x>=ft||kt.y<0||kt.y>=ft||function(vt,Gt,$r,on,En,Mo,Jn,xn,Ir,pn,wn,Cn,Nn,Io,mn,Qn,sn,gn,_n,Xr,wr,Xo,Ml,Yo,T1){const Il=vt.addToLineVertexArray(Gt,$r);let ua,El,Al,zl,R_=0,D_=0,L_=0,B_=0,zp=-1,Rp=-1;const Vi={};let $_=en("");if(vt.allowVerticalPlacement&&on.vertical){const Rn=xn.layout.get("text-rotate").evaluate(wr,{},Yo)+90;Al=new gd(Ir,Gt,pn,wn,Cn,on.vertical,Nn,Io,mn,Rn),Jn&&(zl=new gd(Ir,Gt,pn,wn,Cn,Jn,sn,gn,mn,Rn))}if(En){const Rn=xn.layout.get("icon-rotate").evaluate(wr,{}),Eo=xn.layout.get("icon-text-fit")!=="none",ha=S_(En,Rn,Ml,Eo),Jo=Jn?S_(Jn,Rn,Ml,Eo):void 0;El=new gd(Ir,Gt,pn,wn,Cn,En,sn,gn,!1,Rn),R_=4*ha.length;const da=vt.iconSizeData;let pi=null;da.kind==="source"?(pi=[fi*xn.layout.get("icon-size").evaluate(wr,{})],pi[0]>bs&&Jr(`${vt.layerIds[0]}: Value for "icon-size" is >= ${hu}. Reduce your "icon-size".`)):da.kind==="composite"&&(pi=[fi*Xo.compositeIconSizes[0].evaluate(wr,{},Yo),fi*Xo.compositeIconSizes[1].evaluate(wr,{},Yo)],(pi[0]>bs||pi[1]>bs)&&Jr(`${vt.layerIds[0]}: Value for "icon-size" is >= ${hu}. Reduce your "icon-size".`)),vt.addSymbols(vt.icon,ha,pi,Xr,_n,wr,b.ag.none,Gt,Il.lineStartIndex,Il.lineLength,-1,Yo),zp=vt.icon.placedSymbolArray.length-1,Jo&&(D_=4*Jo.length,vt.addSymbols(vt.icon,Jo,pi,Xr,_n,wr,b.ag.vertical,Gt,Il.lineStartIndex,Il.lineLength,-1,Yo),Rp=vt.icon.placedSymbolArray.length-1)}const O_=Object.keys(on.horizontal);for(const Rn of O_){const Eo=on.horizontal[Rn];if(!ua){$_=en(Eo.text);const Jo=xn.layout.get("text-rotate").evaluate(wr,{},Yo);ua=new gd(Ir,Gt,pn,wn,Cn,Eo,Nn,Io,mn,Jo)}const ha=Eo.positionedLines.length===1;if(L_+=M_(vt,Gt,Eo,Mo,xn,mn,wr,Qn,Il,on.vertical?b.ag.horizontal:b.ag.horizontalOnly,ha?O_:[Rn],Vi,zp,Xo,Yo),ha)break}on.vertical&&(B_+=M_(vt,Gt,on.vertical,Mo,xn,mn,wr,Qn,Il,b.ag.vertical,["vertical"],Vi,Rp,Xo,Yo));const k1=ua?ua.boxStartIndex:vt.collisionBoxArray.length,P1=ua?ua.boxEndIndex:vt.collisionBoxArray.length,M1=Al?Al.boxStartIndex:vt.collisionBoxArray.length,I1=Al?Al.boxEndIndex:vt.collisionBoxArray.length,E1=El?El.boxStartIndex:vt.collisionBoxArray.length,A1=El?El.boxEndIndex:vt.collisionBoxArray.length,z1=zl?zl.boxStartIndex:vt.collisionBoxArray.length,R1=zl?zl.boxEndIndex:vt.collisionBoxArray.length;let Ko=-1;const yd=(Rn,Eo)=>Rn&&Rn.circleDiameter?Math.max(Rn.circleDiameter,Eo):Eo;Ko=yd(ua,Ko),Ko=yd(Al,Ko),Ko=yd(El,Ko),Ko=yd(zl,Ko);const F_=Ko>-1?1:0;F_&&(Ko*=T1/nn),vt.glyphOffsetArray.length>=Tl.MAX_GLYPHS&&Jr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),wr.sortKey!==void 0&&vt.addToSortKeyRanges(vt.symbolInstances.length,wr.sortKey);const D1=P_(xn,wr,Yo),[L1,B1]=function(Rn,Eo){const ha=Rn.length,Jo=Eo==null?void 0:Eo.values;if((Jo==null?void 0:Jo.length)>0)for(let da=0;da<Jo.length;da+=2){const pi=Jo[da+1];Rn.emplaceBack(b.ax[Jo[da]],pi[0],pi[1])}return[ha,Rn.length]}(vt.textAnchorOffsets,D1);vt.symbolInstances.emplaceBack(Gt.x,Gt.y,Vi.right>=0?Vi.right:-1,Vi.center>=0?Vi.center:-1,Vi.left>=0?Vi.left:-1,Vi.vertical||-1,zp,Rp,$_,k1,P1,M1,I1,E1,A1,z1,R1,pn,L_,B_,R_,D_,F_,0,Nn,Ko,L1,B1)}(i,kt,Mt,s,l,d,Je,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,ee,[H,H,H,H],Ve,S,ne,oe,ke,j,t,g,k,M,_)};if(Ae==="line")for(const Mt of y_(t.geometry,0,0,ft,ft)){const kt=ca(Mt,Be),vt=y1(kt,O,Ce,s.vertical||Z,l,24,de,i.overscaling,ft);for(const Gt of vt)Z&&C1(i,Z.text,Ye,Gt)||pt(kt,Gt)}else if(Ae==="line-center"){for(const Mt of t.geometry)if(Mt.length>1){const kt=ca(Mt,Be),vt=_1(kt,Ce,s.vertical||Z,l,24,de);vt&&pt(kt,vt)}}else if(t.type==="Polygon")for(const Mt of ja(t.geometry,0)){const kt=b1(Mt,16);pt(ca(Mt[0],Be,!0),new ws(kt.x,kt.y,0))}else if(t.type==="LineString")for(const Mt of t.geometry){const kt=ca(Mt,Be);pt(kt,new ws(kt[0].x,kt[0].y,0))}else if(t.type==="Point")for(const Mt of t.geometry)for(const kt of Mt)pt([kt],new ws(kt.x,kt.y,0))}function M_(i,t,s,l,d,g,_,x,S,k,M,E,B,F,j){const Z=function(de,ne,O,H,oe,Ce,Ve,ke){const Ae=H.layout.get("text-rotate").evaluate(Ce,{})*Math.PI/180,Ye=[];for(const Ze of ne.positionedLines)for(const Je of Ze.positionedGlyphs){if(!Je.rect)continue;const Be=Je.rect||{};let pt=Yx+1,Mt=!0,kt=1,vt=0;const Gt=(oe||ke)&&Je.vertical,$r=Je.metrics.advance*Je.scale/2;if(ke&&ne.verticalizable&&(vt=Ze.lineOffset/2-(Je.imageName?-(nn-Je.metrics.width*Je.scale)/2:(Je.scale-1)*nn)),Je.imageName){const gn=Ve[Je.imageName];Mt=gn.sdf,kt=gn.pixelRatio,pt=Kn/kt}const on=oe?[Je.x+$r,Je.y]:[0,0];let En=oe?[0,0]:[Je.x+$r+O[0],Je.y+O[1]-vt],Mo=[0,0];Gt&&(Mo=En,En=[0,0]);const Jn=Je.metrics.isDoubleResolution?2:1,xn=(Je.metrics.left-pt)*Je.scale-$r+En[0],Ir=(-Je.metrics.top-pt)*Je.scale+En[1],pn=xn+Be.w/Jn*Je.scale/kt,wn=Ir+Be.h/Jn*Je.scale/kt,Cn=new ie(xn,Ir),Nn=new ie(pn,Ir),Io=new ie(xn,wn),mn=new ie(pn,wn);if(Gt){const gn=new ie(-$r,$r-ld),_n=-Math.PI/2,Xr=nn/2-$r,wr=new ie(5-ld-Xr,-(Je.imageName?Xr:0)),Xo=new ie(...Mo);Cn._rotateAround(_n,gn)._add(wr)._add(Xo),Nn._rotateAround(_n,gn)._add(wr)._add(Xo),Io._rotateAround(_n,gn)._add(wr)._add(Xo),mn._rotateAround(_n,gn)._add(wr)._add(Xo)}if(Ae){const gn=Math.sin(Ae),_n=Math.cos(Ae),Xr=[_n,-gn,gn,_n];Cn._matMult(Xr),Nn._matMult(Xr),Io._matMult(Xr),mn._matMult(Xr)}const Qn=new ie(0,0),sn=new ie(0,0);Ye.push({tl:Cn,tr:Nn,bl:Io,br:mn,tex:Be,writingMode:ne.writingMode,glyphOffset:on,sectionIndex:Je.sectionIndex,isSDF:Mt,pixelOffsetTL:Qn,pixelOffsetBR:sn,minFontScaleX:0,minFontScaleY:0})}return Ye}(0,s,x,d,g,_,l,i.allowVerticalPlacement),X=i.textSizeData;let ee=null;X.kind==="source"?(ee=[fi*d.layout.get("text-size").evaluate(_,{})],ee[0]>bs&&Jr(`${i.layerIds[0]}: Value for "text-size" is >= ${hu}. Reduce your "text-size".`)):X.kind==="composite"&&(ee=[fi*F.compositeTextSizes[0].evaluate(_,{},j),fi*F.compositeTextSizes[1].evaluate(_,{},j)],(ee[0]>bs||ee[1]>bs)&&Jr(`${i.layerIds[0]}: Value for "text-size" is >= ${hu}. Reduce your "text-size".`)),i.addSymbols(i.text,Z,ee,x,g,_,k,t,S.lineStartIndex,S.lineLength,B,j);for(const de of M)E[de]=i.text.placedSymbolArray.length-1;return 4*Z.length}function I_(i){for(const t in i)return i[t];return null}function C1(i,t,s,l){const d=i.compareText;if(t in d){const g=d[t];for(let _=g.length-1;_>=0;_--)if(l.dist(g[_])<s)return!0}else d[t]=[];return d[t].push(l),!1}const E_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Tp{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,l]=new Uint8Array(t,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=l>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const g=E_[15&l];if(!g)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(t,2,1),[x]=new Uint32Array(t,4,1);return new Tp(x,_,g,t)}constructor(t,s=64,l=Float64Array,d){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const g=E_.indexOf(this.ArrayType),_=2*t*this.ArrayType.BYTES_PER_ELEMENT,x=t*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-x%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${l}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+x+S,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+_+x+S),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+x+S,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=t)}add(t,s){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=s,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return kp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,s,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:x}=this,S=[0,g.length-1,0],k=[];for(;S.length;){const M=S.pop()||0,E=S.pop()||0,B=S.pop()||0;if(E-B<=x){for(let X=B;X<=E;X++){const ee=_[2*X],de=_[2*X+1];ee>=t&&ee<=l&&de>=s&&de<=d&&k.push(g[X])}continue}const F=B+E>>1,j=_[2*F],Z=_[2*F+1];j>=t&&j<=l&&Z>=s&&Z<=d&&k.push(g[F]),(M===0?t<=j:s<=Z)&&(S.push(B),S.push(F-1),S.push(1-M)),(M===0?l>=j:d>=Z)&&(S.push(F+1),S.push(E),S.push(1-M))}return k}within(t,s,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:g,nodeSize:_}=this,x=[0,d.length-1,0],S=[],k=l*l;for(;x.length;){const M=x.pop()||0,E=x.pop()||0,B=x.pop()||0;if(E-B<=_){for(let X=B;X<=E;X++)z_(g[2*X],g[2*X+1],t,s)<=k&&S.push(d[X]);continue}const F=B+E>>1,j=g[2*F],Z=g[2*F+1];z_(j,Z,t,s)<=k&&S.push(d[F]),(M===0?t-l<=j:s-l<=Z)&&(x.push(B),x.push(F-1),x.push(1-M)),(M===0?t+l>=j:s+l>=Z)&&(x.push(F+1),x.push(E),x.push(1-M))}return S}}function kp(i,t,s,l,d,g){if(d-l<=s)return;const _=l+d>>1;A_(i,t,_,l,d,g),kp(i,t,s,l,_-1,1-g),kp(i,t,s,_+1,d,1-g)}function A_(i,t,s,l,d,g){for(;d>l;){if(d-l>600){const k=d-l+1,M=s-l+1,E=Math.log(k),B=.5*Math.exp(2*E/3),F=.5*Math.sqrt(E*B*(k-B)/k)*(M-k/2<0?-1:1);A_(i,t,s,Math.max(l,Math.floor(s-M*B/k+F)),Math.min(d,Math.floor(s+(k-M)*B/k+F)),g)}const _=t[2*s+g];let x=l,S=d;for(pu(i,t,l,s),t[2*d+g]>_&&pu(i,t,l,d);x<S;){for(pu(i,t,x,S),x++,S--;t[2*x+g]<_;)x++;for(;t[2*S+g]>_;)S--}t[2*l+g]===_?pu(i,t,l,S):(S++,pu(i,t,S,d)),S<=s&&(l=S+1),s<=S&&(d=S-1)}}function pu(i,t,s,l){Pp(i,s,l),Pp(t,2*s,2*l),Pp(t,2*s+1,2*l+1)}function Pp(i,t,s){const l=i[t];i[t]=i[s],i[s]=l}function z_(i,t,s,l){const d=i-s,g=t-l;return d*d+g*g}var Mp;b.cg=void 0,(Mp=b.cg||(b.cg={})).create="create",Mp.load="load",Mp.fullLoad="fullLoad";let _d=null,mu=[];const Ip=1e3/60,Ep="loadTime",Ap="fullLoadTime",S1={mark(i){performance.mark(i)},frame(i){const t=i;_d!=null&&mu.push(t-_d),_d=t},clearMetrics(){_d=null,mu=[],performance.clearMeasures(Ep),performance.clearMeasures(Ap);for(const i in b.cg)performance.clearMarks(b.cg[i])},getPerformanceMetrics(){performance.measure(Ep,b.cg.create,b.cg.load),performance.measure(Ap,b.cg.create,b.cg.fullLoad);const i=performance.getEntriesByName(Ep)[0].duration,t=performance.getEntriesByName(Ap)[0].duration,s=mu.length,l=1/(mu.reduce((g,_)=>g+_,0)/s/1e3),d=mu.filter(g=>g>Ip).reduce((g,_)=>g+(_-Ip)/Ip,0);return{loadTime:i,fullLoadTime:t,fps:l,percentDroppedFrames:d/(s+d)*100,totalFrames:s}}};b.$=du,b.A=ut,b.B=Hn,b.C=Tr,b.D=wt,b.E=ge,b.F=Uh,b.G=function(i){if(Ie==null){const t=i.navigator?i.navigator.userAgent:null;Ie=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Ie},b.H=class{constructor(i,t){this.target=i,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new p1(()=>this.process()),this.subscription=nt(this.target,"message",s=>this.receive(s),!1),this.globalScope=pe(self)?i:window}registerMessageHandler(i,t){this.messageHandlers[i]=t}sendAsync(i,t){return new Promise((s,l)=>{const d=Math.round(1e18*Math.random()).toString(36).substring(0,10),g=t?nt(t.signal,"abort",()=>{g==null||g.unsubscribe(),delete this.resolveRejects[d];const S={id:d,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(S)},m1):null;this.resolveRejects[d]={resolve:S=>{g==null||g.unsubscribe(),s(S)},reject:S=>{g==null||g.unsubscribe(),l(S)}};const _=[],x=Object.assign(Object.assign({},i),{id:d,sourceMapId:this.mapId,origin:location.origin,data:ui(i.data,_)});this.target.postMessage(x,{transfer:_})})}receive(i){const t=i.data,s=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[s];const l=this.abortControllers[s];return delete this.abortControllers[s],void(l&&l.abort())}if(pe(self)||t.mustQueue)return this.tasks[s]=t,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,t)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),t=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(i,t)}processTask(i,t){return a(this,void 0,void 0,function*(){if(t.type==="<response>"){const d=this.resolveRejects[i];return delete this.resolveRejects[i],d?void(t.error?d.reject(ra(t.error)):d.resolve(ra(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=ra(t.data),l=new AbortController;this.abortControllers[i]=l;try{const d=yield this.messageHandlers[t.type](t.sourceMapId,s,l);this.completeTask(i,null,d)}catch(d){this.completeTask(i,d)}})}completeTask(i,t,s){const l=[];delete this.abortControllers[i];const d={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?ui(t):null,data:ui(s,l)};this.target.postMessage(d,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},b.I=dp,b.J=Ft,b.K=function(){var i=new ut(16);return ut!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},b.L=function(i,t,s){var l,d,g,_,x,S,k,M,E,B,F,j,Z=s[0],X=s[1],ee=s[2];return t===i?(i[12]=t[0]*Z+t[4]*X+t[8]*ee+t[12],i[13]=t[1]*Z+t[5]*X+t[9]*ee+t[13],i[14]=t[2]*Z+t[6]*X+t[10]*ee+t[14],i[15]=t[3]*Z+t[7]*X+t[11]*ee+t[15]):(d=t[1],g=t[2],_=t[3],x=t[4],S=t[5],k=t[6],M=t[7],E=t[8],B=t[9],F=t[10],j=t[11],i[0]=l=t[0],i[1]=d,i[2]=g,i[3]=_,i[4]=x,i[5]=S,i[6]=k,i[7]=M,i[8]=E,i[9]=B,i[10]=F,i[11]=j,i[12]=l*Z+x*X+E*ee+t[12],i[13]=d*Z+S*X+B*ee+t[13],i[14]=g*Z+k*X+F*ee+t[14],i[15]=_*Z+M*X+j*ee+t[15]),i},b.M=function(i,t,s){var l=s[0],d=s[1],g=s[2];return i[0]=t[0]*l,i[1]=t[1]*l,i[2]=t[2]*l,i[3]=t[3]*l,i[4]=t[4]*d,i[5]=t[5]*d,i[6]=t[6]*d,i[7]=t[7]*d,i[8]=t[8]*g,i[9]=t[9]*g,i[10]=t[10]*g,i[11]=t[11]*g,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},b.N=function(i,t,s){var l=t[0],d=t[1],g=t[2],_=t[3],x=t[4],S=t[5],k=t[6],M=t[7],E=t[8],B=t[9],F=t[10],j=t[11],Z=t[12],X=t[13],ee=t[14],de=t[15],ne=s[0],O=s[1],H=s[2],oe=s[3];return i[0]=ne*l+O*x+H*E+oe*Z,i[1]=ne*d+O*S+H*B+oe*X,i[2]=ne*g+O*k+H*F+oe*ee,i[3]=ne*_+O*M+H*j+oe*de,i[4]=(ne=s[4])*l+(O=s[5])*x+(H=s[6])*E+(oe=s[7])*Z,i[5]=ne*d+O*S+H*B+oe*X,i[6]=ne*g+O*k+H*F+oe*ee,i[7]=ne*_+O*M+H*j+oe*de,i[8]=(ne=s[8])*l+(O=s[9])*x+(H=s[10])*E+(oe=s[11])*Z,i[9]=ne*d+O*S+H*B+oe*X,i[10]=ne*g+O*k+H*F+oe*ee,i[11]=ne*_+O*M+H*j+oe*de,i[12]=(ne=s[12])*l+(O=s[13])*x+(H=s[14])*E+(oe=s[15])*Z,i[13]=ne*d+O*S+H*B+oe*X,i[14]=ne*g+O*k+H*F+oe*ee,i[15]=ne*_+O*M+H*j+oe*de,i},b.O=function(i,t){const s={};for(let l=0;l<t.length;l++){const d=t[l];d in i&&(s[d]=i[d])}return s},b.P=ie,b.Q=xs,b.R=ko,b.S=a_,b.T=Uc,b.U=s_,b.V=qe,b.W=be,b.X=He,b.Y=Po,b.Z=ft,b._=a,b.a=St,b.a$=function(){const i=new Float32Array(16);return Qe(i),i},b.a0=wp,b.a1=i=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(s=>{t.onloadstart=()=>{s(t)};for(const l of i){const d=window.document.createElement("source");Rr(l)||(t.crossOrigin="Anonymous"),d.src=l,t.appendChild(d)}})},b.a2=ve,b.a3=function(){return Kr++},b.a4=v,b.a5=Tl,b.a6=tl,b.a7=Yn,b.a8=p_,b.a9=function(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,l,d,g)=>{const _=d||g;return t[l]=!_||_.toLowerCase(),""}),t["max-age"]){const s=parseInt(t["max-age"],10);isNaN(s)?delete t["max-age"]:t["max-age"]=s}return t},b.aA=pp,b.aB=Tp,b.aC=Zr,b.aD=id,b.aE=Q,b.aF=Ct,b.aG=rt,b.aH=function(i){return Math.pow(2,i)},b.aI=85.051129,b.aJ=l_,b.aK=zr,b.aL=Xe,b.aM=c_,b.aN=function(i,t,s){return i[0]=t[0]*s,i[1]=t[1]*s,i[2]=t[2]*s,i},b.aO=function(i,t,s){return i[0]=t[0]+s[0],i[1]=t[1]+s[1],i[2]=t[2]+s[2],i},b.aP=function(i){var t=new ut(3);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t},b.aQ=function(i,t,s){return i[0]=t[0]*s[0],i[1]=t[1]*s[1],i[2]=t[2]*s[2],i[3]=t[3]*s[3],i},b.aR=function(i,t,s){return i[0]=t[0]-s[0],i[1]=t[1]-s[1],i[2]=t[2]-s[2],i},b.aS=function(i,t){var s=t[0],l=t[1],d=t[2],g=s*s+l*l+d*d;return g>0&&(g=1/Math.sqrt(g)),i[0]=t[0]*g,i[1]=t[1]*g,i[2]=t[2]*g,i},b.aT=function(i,t,s){var l=t[0],d=t[1],g=t[2],_=s[0],x=s[1],S=s[2];return i[0]=d*S-g*x,i[1]=g*_-l*S,i[2]=l*x-d*_,i},b.aU=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]},b.aV=h_,b.aW=kl,b.aX=function(i,t,s,l,d){var g,_=1/Math.tan(t/2);return i[0]=_/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=_,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,d!=null&&d!==1/0?(i[10]=(d+l)*(g=1/(l-d)),i[14]=2*d*l*g):(i[10]=-1,i[14]=-2*l),i},b.aY=function(i){var t=new ut(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},b.aZ=function(i,t,s){var l=Math.sin(s),d=Math.cos(s),g=t[0],_=t[1],x=t[2],S=t[3],k=t[4],M=t[5],E=t[6],B=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=g*d+k*l,i[1]=_*d+M*l,i[2]=x*d+E*l,i[3]=S*d+B*l,i[4]=k*d-g*l,i[5]=M*d-_*l,i[6]=E*d-x*l,i[7]=B*d-S*l,i},b.a_=function(i,t,s){var l=Math.sin(s),d=Math.cos(s),g=t[4],_=t[5],x=t[6],S=t[7],k=t[8],M=t[9],E=t[10],B=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=g*d+k*l,i[5]=_*d+M*l,i[6]=x*d+E*l,i[7]=S*d+B*l,i[8]=k*d-g*l,i[9]=M*d-_*l,i[10]=E*d-x*l,i[11]=B*d-S*l,i},b.aa=function(i){return Math.log(i)/Math.LN2},b.ab=function(i){var t=i[0],s=i[1];return t*t+s*s},b.ac=function(i){return i*Math.PI/180},b.ad=Mr,b.ae=function(i,t){const s=[];for(const l in i)l in t||s.push(l);return s},b.af=function(i,t){let s=0,l=0;if(i.kind==="constant")l=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:d,minZoom:g,maxZoom:_}=i,x=d?Mr(Mn.interpolationFactor(d,t,g,_),0,1):0;i.kind==="camera"?l=Hn.number(i.minSize,i.maxSize,x):s=x}return{uSizeT:s,uSize:l}},b.ah=function(i,{uSize:t,uSizeT:s},{lowerSize:l,upperSize:d}){return i.kind==="source"?l/fi:i.kind==="composite"?Hn.number(l/fi,d/fi,s):t},b.ai=function(i,t){var s=t[0],l=t[1],d=t[2],g=t[3],_=t[4],x=t[5],S=t[6],k=t[7],M=t[8],E=t[9],B=t[10],F=t[11],j=t[12],Z=t[13],X=t[14],ee=t[15],de=s*x-l*_,ne=s*S-d*_,O=s*k-g*_,H=l*S-d*x,oe=l*k-g*x,Ce=d*k-g*S,Ve=M*Z-E*j,ke=M*X-B*j,Ae=M*ee-F*j,Ye=E*X-B*Z,Ze=E*ee-F*Z,Je=B*ee-F*X,Be=de*Je-ne*Ze+O*Ye+H*Ae-oe*ke+Ce*Ve;return Be?(i[0]=(x*Je-S*Ze+k*Ye)*(Be=1/Be),i[1]=(d*Ze-l*Je-g*Ye)*Be,i[2]=(Z*Ce-X*oe+ee*H)*Be,i[3]=(B*oe-E*Ce-F*H)*Be,i[4]=(S*Ae-_*Je-k*ke)*Be,i[5]=(s*Je-d*Ae+g*ke)*Be,i[6]=(X*O-j*Ce-ee*ne)*Be,i[7]=(M*Ce-B*O+F*ne)*Be,i[8]=(_*Ze-x*Ae+k*Ve)*Be,i[9]=(l*Ae-s*Ze-g*Ve)*Be,i[10]=(j*oe-Z*O+ee*de)*Be,i[11]=(E*O-M*oe-F*de)*Be,i[12]=(x*ke-_*Ye-S*Ve)*Be,i[13]=(s*Ye-l*ke+d*Ve)*Be,i[14]=(Z*ne-j*H-X*de)*Be,i[15]=(M*H-E*ne+B*de)*Be,i):null},b.aj=tt,b.ak=function(i){return Math.hypot(i[0],i[1])},b.al=function(i){return i[0]=0,i[1]=0,i},b.am=function(i,t,s){return i[0]=t[0]*s,i[1]=t[1]*s,i},b.an=gp,b.ao=Me,b.ap=function(i,t,s,l){const d=t.y-i.y,g=t.x-i.x,_=l.y-s.y,x=l.x-s.x,S=_*g-x*d;if(S===0)return null;const k=(x*(i.y-s.y)-_*(i.x-s.x))/S;return new ie(i.x+k*g,i.y+k*d)},b.aq=y_,b.ar=yl,b.as=Qe,b.at=function(i){let t=1/0,s=1/0,l=-1/0,d=-1/0;for(const g of i)t=Math.min(t,g.x),s=Math.min(s,g.y),l=Math.max(l,g.x),d=Math.max(d,g.y);return[t,s,l,d]},b.au=nn,b.av=bt,b.aw=function(i,t,s,l,d=!1){if(!s[0]&&!s[1])return[0,0];const g=d?l==="map"?-i.bearingInRadians:0:l==="viewport"?i.bearingInRadians:0;if(g){const _=Math.sin(g),x=Math.cos(g);s=[s[0]*x-s[1]*_,s[0]*_+s[1]*x]}return[d?s[0]:bt(t,s[0],i.zoom),d?s[1]:bt(t,s[1],i.zoom)]},b.ay=mp,b.az=Sp,b.b=Ke,b.b$=i=>i.type==="circle",b.b0=function(){const i=new Float64Array(16);return Qe(i),i},b.b1=function(){return new Float64Array(16)},b.b2=function(i,t,s){const l=new Float64Array(4);return function(d,g,_,x){var S=.5*Math.PI/180;g*=S,_*=S,x*=S;var k=Math.sin(g),M=Math.cos(g),E=Math.sin(_),B=Math.cos(_),F=Math.sin(x),j=Math.cos(x);d[0]=k*B*j-M*E*F,d[1]=M*E*j+k*B*F,d[2]=M*B*F-k*E*j,d[3]=M*B*j+k*E*F}(l,i,t-90,s),l},b.b3=function(i,t,s,l){var d,g,_,x,S,k=t[0],M=t[1],E=t[2],B=t[3],F=s[0],j=s[1],Z=s[2],X=s[3];return(g=k*F+M*j+E*Z+B*X)<0&&(g=-g,F=-F,j=-j,Z=-Z,X=-X),1-g>ct?(d=Math.acos(g),_=Math.sin(d),x=Math.sin((1-l)*d)/_,S=Math.sin(l*d)/_):(x=1-l,S=l),i[0]=x*k+S*F,i[1]=x*M+S*j,i[2]=x*E+S*Z,i[3]=x*B+S*X,i},b.b4=function(i){const t=new Float64Array(9);var s,l,d,g,_,x,S,k,M,E,B,F,j,Z,X,ee,de,ne;E=(d=(l=i)[0])*(S=d+d),B=(g=l[1])*S,j=(_=l[2])*S,Z=_*(k=g+g),ee=(x=l[3])*S,de=x*k,ne=x*(M=_+_),(s=t)[0]=1-(F=g*k)-(X=_*M),s[3]=B-ne,s[6]=j+de,s[1]=B+ne,s[4]=1-E-X,s[7]=Z-ee,s[2]=j-de,s[5]=Z+ee,s[8]=1-E-F;const O=Xe(-Math.asin(Mr(t[2],-1,1)));let H,oe;return Math.hypot(t[5],t[8])<.001?(H=0,oe=-Xe(Math.atan2(t[3],t[4]))):(H=Xe(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),oe=Xe(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:H,pitch:O+90,bearing:oe}},b.b5=function(i,t){return i.roll==t.roll&&i.pitch==t.pitch&&i.bearing==t.bearing},b.b6=Qt,b.b7=Oi,b.b8=Cl,b.b9=ou,b.bA=function(i){const t=[],s=i.id;return s===void 0&&t.push({message:`layers.${s}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${s}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),t},b.bB=function i(t,s){if(Array.isArray(t)){if(!Array.isArray(s)||t.length!==s.length)return!1;for(let l=0;l<t.length;l++)if(!i(t[l],s[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&s!==null){if(typeof s!="object"||Object.keys(t).length!==Object.keys(s).length)return!1;for(const l in t)if(!i(t[l],s[l]))return!1;return!0}return t===s},b.bC=Tn,b.bD=Gn,b.bE=class extends mo{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},b.bF=Fi,b.bG=class extends mo{constructor(i,t){super(i,t),this.current=go}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},b.bH=aa,b.bI=class extends mo{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},b.bJ=class extends mo{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},b.bK=st,b.bL=function(i,t){var s=Math.sin(t),l=Math.cos(t);return i[0]=l,i[1]=s,i[2]=0,i[3]=-s,i[4]=l,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},b.bM=function(i,t,s){var l=t[0],d=t[1],g=t[2];return i[0]=l*s[0]+d*s[3]+g*s[6],i[1]=l*s[1]+d*s[4]+g*s[7],i[2]=l*s[2]+d*s[5]+g*s[8],i},b.bN=function(i,t,s,l,d,g,_){var x=1/(t-s),S=1/(l-d),k=1/(g-_);return i[0]=-2*x,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*S,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*k,i[11]=0,i[12]=(t+s)*x,i[13]=(d+l)*S,i[14]=(_+g)*k,i[15]=1,i},b.bO=class extends fl{},b.bP=Zx,b.bQ=class extends pl{},b.bR=Yf,b.bS=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},b.bT=fg,b.bU=function(i,t,s){var l=t[0],d=t[1],g=t[2],_=s[3]*l+s[7]*d+s[11]*g+s[15];return i[0]=(s[0]*l+s[4]*d+s[8]*g+s[12])/(_=_||1),i[1]=(s[1]*l+s[5]*d+s[9]*g+s[13])/_,i[2]=(s[2]*l+s[6]*d+s[10]*g+s[14])/_,i},b.bV=class extends qc{},b.bW=class extends c{},b.bX=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]&&i[8]===t[8]&&i[9]===t[9]&&i[10]===t[10]&&i[11]===t[11]&&i[12]===t[12]&&i[13]===t[13]&&i[14]===t[14]&&i[15]===t[15]},b.bY=function(i,t){var s=i[0],l=i[1],d=i[2],g=i[3],_=i[4],x=i[5],S=i[6],k=i[7],M=i[8],E=i[9],B=i[10],F=i[11],j=i[12],Z=i[13],X=i[14],ee=i[15],de=t[0],ne=t[1],O=t[2],H=t[3],oe=t[4],Ce=t[5],Ve=t[6],ke=t[7],Ae=t[8],Ye=t[9],Ze=t[10],Je=t[11],Be=t[12],pt=t[13],Mt=t[14],kt=t[15];return Math.abs(s-de)<=ct*Math.max(1,Math.abs(s),Math.abs(de))&&Math.abs(l-ne)<=ct*Math.max(1,Math.abs(l),Math.abs(ne))&&Math.abs(d-O)<=ct*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(g-H)<=ct*Math.max(1,Math.abs(g),Math.abs(H))&&Math.abs(_-oe)<=ct*Math.max(1,Math.abs(_),Math.abs(oe))&&Math.abs(x-Ce)<=ct*Math.max(1,Math.abs(x),Math.abs(Ce))&&Math.abs(S-Ve)<=ct*Math.max(1,Math.abs(S),Math.abs(Ve))&&Math.abs(k-ke)<=ct*Math.max(1,Math.abs(k),Math.abs(ke))&&Math.abs(M-Ae)<=ct*Math.max(1,Math.abs(M),Math.abs(Ae))&&Math.abs(E-Ye)<=ct*Math.max(1,Math.abs(E),Math.abs(Ye))&&Math.abs(B-Ze)<=ct*Math.max(1,Math.abs(B),Math.abs(Ze))&&Math.abs(F-Je)<=ct*Math.max(1,Math.abs(F),Math.abs(Je))&&Math.abs(j-Be)<=ct*Math.max(1,Math.abs(j),Math.abs(Be))&&Math.abs(Z-pt)<=ct*Math.max(1,Math.abs(Z),Math.abs(pt))&&Math.abs(X-Mt)<=ct*Math.max(1,Math.abs(X),Math.abs(Mt))&&Math.abs(ee-kt)<=ct*Math.max(1,Math.abs(ee),Math.abs(kt))},b.bZ=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},b.b_=i=>i.type==="symbol",b.ba=wl,b.bb=Ut,b.bc=dr,b.bd=$n,b.be=function(i,t,s,l,d){return Ut(l,d,Mr((i-t)/(s-t),0,1))},b.bf=Pt,b.bg=function(){return new Float64Array(4)},b.bh=function(){return new Float64Array(3)},b.bi=function(i,t,s,l){var d=[],g=[];return d[0]=t[0]-s[0],d[1]=t[1]-s[1],d[2]=t[2]-s[2],g[0]=d[0]*Math.cos(l)-d[1]*Math.sin(l),g[1]=d[0]*Math.sin(l)+d[1]*Math.cos(l),g[2]=d[2],i[0]=g[0]+s[0],i[1]=g[1]+s[1],i[2]=g[2]+s[2],i},b.bj=function(i,t,s,l){var d=[],g=[];return d[0]=t[0]-s[0],d[1]=t[1]-s[1],d[2]=t[2]-s[2],g[0]=d[0],g[1]=d[1]*Math.cos(l)-d[2]*Math.sin(l),g[2]=d[1]*Math.sin(l)+d[2]*Math.cos(l),i[0]=g[0]+s[0],i[1]=g[1]+s[1],i[2]=g[2]+s[2],i},b.bk=function(i,t,s,l){var d=[],g=[];return d[0]=t[0]-s[0],d[1]=t[1]-s[1],d[2]=t[2]-s[2],g[0]=d[2]*Math.sin(l)+d[0]*Math.cos(l),g[1]=d[1],g[2]=d[2]*Math.cos(l)-d[0]*Math.sin(l),i[0]=g[0]+s[0],i[1]=g[1]+s[1],i[2]=g[2]+s[2],i},b.bl=function(i,t,s){var l=Math.sin(s),d=Math.cos(s),g=t[0],_=t[1],x=t[2],S=t[3],k=t[8],M=t[9],E=t[10],B=t[11];return t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=g*d-k*l,i[1]=_*d-M*l,i[2]=x*d-E*l,i[3]=S*d-B*l,i[8]=g*l+k*d,i[9]=_*l+M*d,i[10]=x*l+E*d,i[11]=S*l+B*d,i},b.bm=function(i,t){const s=Pt(i,360),l=Pt(t,360),d=l-s,g=l>s?d-360:d+360;return Math.abs(d)<Math.abs(g)?d:g},b.bn=function(i){return i[0]=0,i[1]=0,i[2]=0,i},b.bo=function(i,t,s,l){const d=Math.sqrt(i*i+t*t),g=Math.sqrt(s*s+l*l);i/=d,t/=d,s/=g,l/=g;const _=Math.acos(i*s+t*l);return-t*s+i*l>0?_:-_},b.bp=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]},b.bq=bp,b.br=function(i,t){const s=Pt(i,2*Math.PI),l=Pt(t,2*Math.PI);return Math.min(Math.abs(s-l),Math.abs(s-l+2*Math.PI),Math.abs(s-l-2*Math.PI))},b.bs=function(i){return Math.hypot(i[0],i[1],i[2])},b.bt=function(){const i={},t=z.$version;for(const s in z.$root){const l=z.$root[s];if(l.required){let d=null;d=s==="version"?t:l.type==="array"?[]:{},d!=null&&(i[s]=d)}}return i},b.bu=ol,b.bv=Zt,b.bw=function(i){i=i.slice();const t=Object.create(null);for(let s=0;s<i.length;s++)t[i[s].id]=i[s];for(let s=0;s<i.length;s++)"ref"in i[s]&&(i[s]=Y(i[s],t[i[s].ref]));return i},b.bx=function(i){if(i.type==="custom")return new f1(i);switch(i.type){case"background":return new u1(i);case"circle":return new ix(i);case"fill":return new Sx(i);case"fill-extrusion":return new zx(i);case"heatmap":return new ax(i);case"hillshade":return new cx(i);case"line":return new jx(i);case"raster":return new d1(i);case"symbol":return new dd(i)}},b.by=cn,b.bz=function(i,t){if(!i)return[{command:"setStyle",args:[t]}];let s=[];try{if(!te(i.version,t.version))return[{command:"setStyle",args:[t]}];te(i.center,t.center)||s.push({command:"setCenter",args:[t.center]}),te(i.centerAltitude,t.centerAltitude)||s.push({command:"setCenterAltitude",args:[t.centerAltitude]}),te(i.zoom,t.zoom)||s.push({command:"setZoom",args:[t.zoom]}),te(i.bearing,t.bearing)||s.push({command:"setBearing",args:[t.bearing]}),te(i.pitch,t.pitch)||s.push({command:"setPitch",args:[t.pitch]}),te(i.roll,t.roll)||s.push({command:"setRoll",args:[t.roll]}),te(i.sprite,t.sprite)||s.push({command:"setSprite",args:[t.sprite]}),te(i.glyphs,t.glyphs)||s.push({command:"setGlyphs",args:[t.glyphs]}),te(i.transition,t.transition)||s.push({command:"setTransition",args:[t.transition]}),te(i.light,t.light)||s.push({command:"setLight",args:[t.light]}),te(i.terrain,t.terrain)||s.push({command:"setTerrain",args:[t.terrain]}),te(i.sky,t.sky)||s.push({command:"setSky",args:[t.sky]}),te(i.projection,t.projection)||s.push({command:"setProjection",args:[t.projection]});const l={},d=[];(function(_,x,S,k){let M;for(M in x=x||{},_=_||{})Object.prototype.hasOwnProperty.call(_,M)&&(Object.prototype.hasOwnProperty.call(x,M)||Te(M,S,k));for(M in x)Object.prototype.hasOwnProperty.call(x,M)&&(Object.prototype.hasOwnProperty.call(_,M)?te(_[M],x[M])||(_[M].type==="geojson"&&x[M].type==="geojson"&&De(_,x,M)?ce(S,{command:"setGeoJSONSourceData",args:[M,x[M].data]}):me(M,x,S,k)):_e(M,x,S))})(i.sources,t.sources,d,l);const g=[];i.layers&&i.layers.forEach(_=>{"source"in _&&l[_.source]?s.push({command:"removeLayer",args:[_.id]}):g.push(_)}),s=s.concat(d),function(_,x,S){x=x||[];const k=(_=_||[]).map(ye),M=x.map(ye),E=_.reduce(je,{}),B=x.reduce(je,{}),F=k.slice(),j=Object.create(null);let Z,X,ee,de,ne;for(let O=0,H=0;O<k.length;O++)Z=k[O],Object.prototype.hasOwnProperty.call(B,Z)?H++:(ce(S,{command:"removeLayer",args:[Z]}),F.splice(F.indexOf(Z,H),1));for(let O=0,H=0;O<M.length;O++)Z=M[M.length-1-O],F[F.length-1-O]!==Z&&(Object.prototype.hasOwnProperty.call(E,Z)?(ce(S,{command:"removeLayer",args:[Z]}),F.splice(F.lastIndexOf(Z,F.length-H),1)):H++,de=F[F.length-O],ce(S,{command:"addLayer",args:[B[Z],de]}),F.splice(F.length-O,0,Z),j[Z]=!0);for(let O=0;O<M.length;O++)if(Z=M[O],X=E[Z],ee=B[Z],!j[Z]&&!te(X,ee))if(te(X.source,ee.source)&&te(X["source-layer"],ee["source-layer"])&&te(X.type,ee.type)){for(ne in Ee(X.layout,ee.layout,S,Z,null,"setLayoutProperty"),Ee(X.paint,ee.paint,S,Z,null,"setPaintProperty"),te(X.filter,ee.filter)||ce(S,{command:"setFilter",args:[Z,ee.filter]}),te(X.minzoom,ee.minzoom)&&te(X.maxzoom,ee.maxzoom)||ce(S,{command:"setLayerZoomRange",args:[Z,ee.minzoom,ee.maxzoom]}),X)Object.prototype.hasOwnProperty.call(X,ne)&&ne!=="layout"&&ne!=="paint"&&ne!=="filter"&&ne!=="metadata"&&ne!=="minzoom"&&ne!=="maxzoom"&&(ne.indexOf("paint.")===0?Ee(X[ne],ee[ne],S,Z,ne.slice(6),"setPaintProperty"):te(X[ne],ee[ne])||ce(S,{command:"setLayerProperty",args:[Z,ne,ee[ne]]}));for(ne in ee)Object.prototype.hasOwnProperty.call(ee,ne)&&!Object.prototype.hasOwnProperty.call(X,ne)&&ne!=="layout"&&ne!=="paint"&&ne!=="filter"&&ne!=="metadata"&&ne!=="minzoom"&&ne!=="maxzoom"&&(ne.indexOf("paint.")===0?Ee(X[ne],ee[ne],S,Z,ne.slice(6),"setPaintProperty"):te(X[ne],ee[ne])||ce(S,{command:"setLayerProperty",args:[Z,ne,ee[ne]]}))}else ce(S,{command:"removeLayer",args:[Z]}),de=F[F.lastIndexOf(Z)+1],ce(S,{command:"addLayer",args:[ee,de]})}(g,t.layers,s)}catch(l){console.warn("Unable to compute style diff:",l),s=[{command:"setStyle",args:[t]}]}return s},b.c=ht,b.c0=i=>i.type==="heatmap",b.c1=i=>i.type==="line",b.c2=i=>i.type==="fill",b.c3=i=>i.type==="fill-extrusion",b.c4=i=>i.type==="hillshade",b.c5=i=>i.type==="raster",b.c6=i=>i.type==="background",b.c7=i=>i.type==="custom",b.c8=ir,b.c9=function(i,t,s){const l=At(t.x-s.x,t.y-s.y),d=At(i.x-s.x,i.y-s.y);var g,_;return Xe(Math.atan2(l[0]*d[1]-l[1]*d[0],(g=l)[0]*(_=d)[0]+g[1]*_[1]))},b.cA=N,b.cB=Eg,b.cC=Vg,b.cD=zi,b.cE=hi,b.ca=Ht,b.cb=function(i,t,s){var l=t[0],d=t[1];return i[0]=s[0]*l+s[4]*d+s[12],i[1]=s[1]*l+s[5]*d+s[13],i},b.cc=function(i,t){const{x:s,y:l}=du.fromLngLat(t);return!(i<0||i>25||l<0||l>=1||s<0||s>=1)},b.cd=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},b.ce=class extends ul{},b.cf=S1,b.ch=function(i){return i.message===It},b.ci=Yt,b.cj=function(i,t){St.REGISTERED_PROTOCOLS[i]=t},b.ck=function(i){delete St.REGISTERED_PROTOCOLS[i]},b.cl=function(i,t){const s={};for(let d=0;d<i.length;d++){const g=t&&t[i[d].id]||Ic(i[d]);t&&(t[i[d].id]=g);let _=s[g];_||(_=s[g]=[]),_.push(i[d])}const l=[];for(const d in s)l.push(s[d]);return l},b.cm=dt,b.cn=f_,b.co=m_,b.cp=Zg,b.cq=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=ft/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const t=i.bucket.layers[0],s=t.layout,l=t._unevaluatedLayout._values,d={layoutIconSize:l["icon-size"].possiblyEvaluate(new Tr(i.bucket.zoom+1),i.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new Tr(i.bucket.zoom+1),i.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new Tr(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:M}=i.bucket.textSizeData;d.compositeTextSizes=[l["text-size"].possiblyEvaluate(new Tr(k),i.canonical),l["text-size"].possiblyEvaluate(new Tr(M),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:M}=i.bucket.iconSizeData;d.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new Tr(k),i.canonical),l["icon-size"].possiblyEvaluate(new Tr(M),i.canonical)]}const g=s.get("text-line-height")*nn,_=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",x=s.get("text-keep-upright"),S=s.get("text-size");for(const k of i.bucket.features){const M=s.get("text-font").evaluate(k,{},i.canonical).join(","),E=S.evaluate(k,{},i.canonical),B=d.layoutTextSize.evaluate(k,{},i.canonical),F=d.layoutIconSize.evaluate(k,{},i.canonical),j={horizontal:{},vertical:void 0},Z=k.text;let X,ee=[0,0];if(Z){const O=Z.toString(),H=s.get("text-letter-spacing").evaluate(k,{},i.canonical)*nn,oe=Gh(O)?H:0,Ce=s.get("text-anchor").evaluate(k,{},i.canonical),Ve=P_(t,k,i.canonical);if(!Ve){const Ze=s.get("text-radial-offset").evaluate(k,{},i.canonical);ee=Ze?k_(Ce,[Ze*nn,Cp]):s.get("text-offset").evaluate(k,{},i.canonical).map(Je=>Je*nn)}let ke=_?"center":s.get("text-justify").evaluate(k,{},i.canonical);const Ae=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(k,{},i.canonical)*nn:1/0,Ye=()=>{i.bucket.allowVerticalPlacement&&il(O)&&(j.vertical=cd(Z,i.glyphMap,i.glyphPositions,i.imagePositions,M,Ae,g,Ce,"left",oe,ee,b.ag.vertical,!0,B,E))};if(!_&&Ve){const Ze=new Set;if(ke==="auto")for(let Be=0;Be<Ve.values.length;Be+=2)Ze.add(Sp(Ve.values[Be]));else Ze.add(ke);let Je=!1;for(const Be of Ze)if(!j.horizontal[Be])if(Je)j.horizontal[Be]=j.horizontal[0];else{const pt=cd(Z,i.glyphMap,i.glyphPositions,i.imagePositions,M,Ae,g,"center",Be,oe,ee,b.ag.horizontal,!1,B,E);pt&&(j.horizontal[Be]=pt,Je=pt.positionedLines.length===1)}Ye()}else{ke==="auto"&&(ke=Sp(Ce));const Ze=cd(Z,i.glyphMap,i.glyphPositions,i.imagePositions,M,Ae,g,Ce,ke,oe,ee,b.ag.horizontal,!1,B,E);Ze&&(j.horizontal[ke]=Ze),Ye(),il(O)&&_&&x&&(j.vertical=cd(Z,i.glyphMap,i.glyphPositions,i.imagePositions,M,Ae,g,Ce,ke,oe,ee,b.ag.vertical,!1,B,E))}}let de=!1;if(k.icon&&k.icon.name){const O=i.imageMap[k.icon.name];O&&(X=i1(i.imagePositions[k.icon.name],s.get("icon-offset").evaluate(k,{},i.canonical),s.get("icon-anchor").evaluate(k,{},i.canonical)),de=!!O.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=de:i.bucket.sdfIcons!==de&&Jr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(O.pixelRatio!==i.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const ne=I_(j.horizontal)||j.vertical;i.bucket.iconsInText=!!ne&&ne.iconsInText,(ne||X)&&w1(i.bucket,k,j,X,i.imageMap,d,B,F,ee,de,i.canonical,i.subdivisionGranularity)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},b.cr=ap,b.cs=tp,b.ct=sp,b.cu=su,b.cv=up,b.cw=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},b.cx=function(i,t,s,l,d){return a(this,void 0,void 0,function*(){if(be())try{return yield He(i,t,s,l,d)}catch{}return function(g,_,x,S,k){const M=g.width,E=g.height;lt&&at||(lt=new OffscreenCanvas(M,E),at=lt.getContext("2d",{willReadFrequently:!0})),lt.width=M,lt.height=E,at.drawImage(g,0,0,M,E);const B=at.getImageData(_,x,S,k);return at.clearRect(0,0,M,E),B.data}(i,t,s,l,d)})},b.cy=d_,b.cz=I,b.d=Rr,b.e=Cr,b.f=i=>a(void 0,void 0,void 0,function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(t)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),b.g=Dt,b.h=i=>new Promise((t,s)=>{const l=new Image;l.onload=()=>{t(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=We})},l.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const d=new Blob([new Uint8Array(i)],{type:"image/png"});l.src=i.byteLength?URL.createObjectURL(d):We}),b.i=pe,b.j=(i,t)=>jr(Cr(i,{type:"json"}),t),b.k=io,b.l=xo,b.m=jr,b.n=(i,t)=>jr(Cr(i,{type:"arrayBuffer"}),t),b.o=function(i){return new up(i).readFields(Wx,[])},b.p=Ug,b.q=Qc,b.r=jn,b.s=nt,b.t=ea,b.u=Nt,b.v=z,b.w=Jr,b.x=nl,b.y=ms,b.z=function([i,t,s]){return t+=90,t*=Math.PI/180,s*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(s),y:i*Math.sin(t)*Math.sin(s),z:i*Math.cos(s)}}}),y("worker",["./shared"],function(b){class a{constructor(z){this.keyCache={},z&&this.replace(z)}replace(z){this._layerConfigs={},this._layers={},this.update(z,[])}update(z,W){for(const te of z){this._layerConfigs[te.id]=te;const ce=this._layers[te.id]=b.bx(te);ce._featureFilter=b.a6(ce.filter),this.keyCache[te.id]&&delete this.keyCache[te.id]}for(const te of W)delete this.keyCache[te],delete this._layerConfigs[te],delete this._layers[te];this.familiesBySource={};const Y=b.cl(Object.values(this._layerConfigs),this.keyCache);for(const te of Y){const ce=te.map(ye=>this._layers[ye.id]),_e=ce[0];if(_e.visibility==="none")continue;const Te=_e.source||"";let me=this.familiesBySource[Te];me||(me=this.familiesBySource[Te]={});const De=_e.sourceLayer||"_geojsonTileLayer";let Ee=me[De];Ee||(Ee=me[De]=[]),Ee.push(ce)}}}class I{constructor(z){const W={},Y=[];for(const Te in z){const me=z[Te],De=W[Te]={};for(const Ee in me){const ye=me[+Ee];if(!ye||ye.bitmap.width===0||ye.bitmap.height===0)continue;const je={x:0,y:0,w:ye.bitmap.width+2,h:ye.bitmap.height+2};Y.push(je),De[Ee]={rect:je,metrics:ye.metrics}}}const{w:te,h:ce}=b.p(Y),_e=new b.q({width:te||1,height:ce||1});for(const Te in z){const me=z[Te];for(const De in me){const Ee=me[+De];if(!Ee||Ee.bitmap.width===0||Ee.bitmap.height===0)continue;const ye=W[Te][De].rect;b.q.copy(Ee.bitmap,_e,{x:0,y:0},{x:ye.x+1,y:ye.y+1},Ee.bitmap)}}this.image=_e,this.positions=W}}b.cm("GlyphAtlas",I);class R{constructor(z){this.tileID=new b.Y(z.tileID.overscaledZ,z.tileID.wrap,z.tileID.canonical.z,z.tileID.canonical.x,z.tileID.canonical.y),this.uid=z.uid,this.zoom=z.zoom,this.pixelRatio=z.pixelRatio,this.tileSize=z.tileSize,this.source=z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=z.showCollisionBoxes,this.collectResourceTiming=!!z.collectResourceTiming,this.returnDependencies=!!z.returnDependencies,this.promoteId=z.promoteId,this.inFlightDependencies=[]}parse(z,W,Y,te,ce){return b._(this,void 0,void 0,function*(){this.status="parsing",this.data=z,this.collisionBoxArray=new b.a4;const _e=new b.cn(Object.keys(z.layers).sort()),Te=new b.co(this.tileID,this.promoteId);Te.bucketLayerIDs=[];const me={},De={featureIndex:Te,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Y,subdivisionGranularity:ce},Ee=W.familiesBySource[this.source];for(const Rt in Ee){const jt=z.layers[Rt];if(!jt)continue;jt.version===1&&b.w(`Vector tile source "${this.source}" layer "${Rt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Tt=_e.encode(Rt),wi=[];for(let Wr=0;Wr<jt.length;Wr++){const Qr=jt.feature(Wr),br=Te.getId(Qr,Rt);wi.push({feature:Qr,id:br,index:Wr,sourceLayerIndex:Tt})}for(const Wr of Ee[Rt]){const Qr=Wr[0];Qr.source!==this.source&&b.w(`layer.source = ${Qr.source} does not equal this.source = ${this.source}`),Qr.minzoom&&this.zoom<Math.floor(Qr.minzoom)||Qr.maxzoom&&this.zoom>=Qr.maxzoom||Qr.visibility!=="none"&&($(Wr,this.zoom,Y),(me[Qr.id]=Qr.createBucket({index:Te.bucketLayerIDs.length,layers:Wr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Tt,sourceID:this.source})).populate(wi,De,this.tileID.canonical),Te.bucketLayerIDs.push(Wr.map(br=>br.id)))}}const ye=b.bC(De.glyphDependencies,Rt=>Object.keys(Rt).map(Number));this.inFlightDependencies.forEach(Rt=>Rt==null?void 0:Rt.abort()),this.inFlightDependencies=[];let je=Promise.resolve({});if(Object.keys(ye).length){const Rt=new AbortController;this.inFlightDependencies.push(Rt),je=te.sendAsync({type:"GG",data:{stacks:ye,source:this.source,tileID:this.tileID,type:"glyphs"}},Rt)}const ve=Object.keys(De.iconDependencies);let it=Promise.resolve({});if(ve.length){const Rt=new AbortController;this.inFlightDependencies.push(Rt),it=te.sendAsync({type:"GI",data:{icons:ve,source:this.source,tileID:this.tileID,type:"icons"}},Rt)}const xt=Object.keys(De.patternDependencies);let Lt=Promise.resolve({});if(xt.length){const Rt=new AbortController;this.inFlightDependencies.push(Rt),Lt=te.sendAsync({type:"GI",data:{icons:xt,source:this.source,tileID:this.tileID,type:"patterns"}},Rt)}const[zt,$e,_t]=yield Promise.all([je,it,Lt]),mt=new I(zt),Ot=new b.cp($e,_t);for(const Rt in me){const jt=me[Rt];jt instanceof b.a5?($(jt.layers,this.zoom,Y),b.cq({bucket:jt,glyphMap:zt,glyphPositions:mt.positions,imageMap:$e,imagePositions:Ot.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:De.subdivisionGranularity})):jt.hasPattern&&(jt instanceof b.cr||jt instanceof b.cs||jt instanceof b.ct)&&($(jt.layers,this.zoom,Y),jt.addFeatures(De,this.tileID.canonical,Ot.patternPositions))}return this.status="done",{buckets:Object.values(me).filter(Rt=>!Rt.isEmpty()),featureIndex:Te,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:mt.image,imageAtlas:Ot,glyphMap:this.returnDependencies?zt:null,iconMap:this.returnDependencies?$e:null,glyphPositions:this.returnDependencies?mt.positions:null}})}}function $(ge,z,W){const Y=new b.C(z);for(const te of ge)te.recalculate(Y,W)}class N{constructor(z,W,Y){this.actor=z,this.layerIndex=W,this.availableImages=Y,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(z,W){return b._(this,void 0,void 0,function*(){const Y=yield b.n(z.request,W);try{return{vectorTile:new b.cu.VectorTile(new b.cv(Y.data)),rawData:Y.data,cacheControl:Y.cacheControl,expires:Y.expires}}catch(te){const ce=new Uint8Array(Y.data);let _e=`Unable to parse the tile at ${z.request.url}, `;throw _e+=ce[0]===31&&ce[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${te.message}`,new Error(_e)}})}loadTile(z){return b._(this,void 0,void 0,function*(){const W=z.uid,Y=!!(z&&z.request&&z.request.collectResourceTiming)&&new b.cw(z.request),te=new R(z);this.loading[W]=te;const ce=new AbortController;te.abort=ce;try{const _e=yield this.loadVectorTile(z,ce);if(delete this.loading[W],!_e)return null;const Te=_e.rawData,me={};_e.expires&&(me.expires=_e.expires),_e.cacheControl&&(me.cacheControl=_e.cacheControl);const De={};if(Y){const ye=Y.finish();ye&&(De.resourceTiming=JSON.parse(JSON.stringify(ye)))}te.vectorTile=_e.vectorTile;const Ee=te.parse(_e.vectorTile,this.layerIndex,this.availableImages,this.actor,z.subdivisionGranularity);this.loaded[W]=te,this.fetching[W]={rawTileData:Te,cacheControl:me,resourceTiming:De};try{const ye=yield Ee;return b.e({rawTileData:Te.slice(0)},ye,me,De)}finally{delete this.fetching[W]}}catch(_e){throw delete this.loading[W],te.status="done",this.loaded[W]=te,_e}})}reloadTile(z){return b._(this,void 0,void 0,function*(){const W=z.uid;if(!this.loaded||!this.loaded[W])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Y=this.loaded[W];if(Y.showCollisionBoxes=z.showCollisionBoxes,Y.status==="parsing"){const te=yield Y.parse(Y.vectorTile,this.layerIndex,this.availableImages,this.actor,z.subdivisionGranularity);let ce;if(this.fetching[W]){const{rawTileData:_e,cacheControl:Te,resourceTiming:me}=this.fetching[W];delete this.fetching[W],ce=b.e({rawTileData:_e.slice(0)},te,Te,me)}else ce=te;return ce}if(Y.status==="done"&&Y.vectorTile)return Y.parse(Y.vectorTile,this.layerIndex,this.availableImages,this.actor,z.subdivisionGranularity)})}abortTile(z){return b._(this,void 0,void 0,function*(){const W=this.loading,Y=z.uid;W&&W[Y]&&W[Y].abort&&(W[Y].abort.abort(),delete W[Y])})}removeTile(z){return b._(this,void 0,void 0,function*(){this.loaded&&this.loaded[z.uid]&&delete this.loaded[z.uid]})}}class q{constructor(){this.loaded={}}loadTile(z){return b._(this,void 0,void 0,function*(){const{uid:W,encoding:Y,rawImageData:te,redFactor:ce,greenFactor:_e,blueFactor:Te,baseShift:me}=z,De=te.width+2,Ee=te.height+2,ye=b.b(te)?new b.R({width:De,height:Ee},yield b.cx(te,-1,-1,De,Ee)):te,je=new b.cy(W,ye,Y,ce,_e,Te,me);return this.loaded=this.loaded||{},this.loaded[W]=je,je})}removeTile(z){const W=this.loaded,Y=z.uid;W&&W[Y]&&delete W[Y]}}var V,ie,Pe=function(){if(ie)return V;function ge(W,Y){if(W.length!==0){z(W[0],Y);for(var te=1;te<W.length;te++)z(W[te],!Y)}}function z(W,Y){for(var te=0,ce=0,_e=0,Te=W.length,me=Te-1;_e<Te;me=_e++){var De=(W[_e][0]-W[me][0])*(W[me][1]+W[_e][1]),Ee=te+De;ce+=Math.abs(te)>=Math.abs(De)?te-Ee+De:De-Ee+te,te=Ee}te+ce>=0!=!!Y&&W.reverse()}return ie=1,V=function W(Y,te){var ce,_e=Y&&Y.type;if(_e==="FeatureCollection")for(ce=0;ce<Y.features.length;ce++)W(Y.features[ce],te);else if(_e==="GeometryCollection")for(ce=0;ce<Y.geometries.length;ce++)W(Y.geometries[ce],te);else if(_e==="Feature")W(Y.geometry,te);else if(_e==="Polygon")ge(Y.coordinates,te);else if(_e==="MultiPolygon")for(ce=0;ce<Y.coordinates.length;ce++)ge(Y.coordinates[ce],te);return Y}}(),Ne=b.cz(Pe);const xe=b.cu.VectorTileFeature.prototype.toGeoJSON;class Ge{constructor(z){this._feature=z,this.extent=b.Z,this.type=z.type,this.properties=z.tags,"id"in z&&!isNaN(z.id)&&(this.id=parseInt(z.id,10))}loadGeometry(){if(this._feature.type===1){const z=[];for(const W of this._feature.geometry)z.push([new b.P(W[0],W[1])]);return z}{const z=[];for(const W of this._feature.geometry){const Y=[];for(const te of W)Y.push(new b.P(te[0],te[1]));z.push(Y)}return z}}toGeoJSON(z,W,Y){return xe.call(this,z,W,Y)}}class qe{constructor(z){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=b.Z,this.length=z.length,this._features=z}feature(z){return new Ge(this._features[z])}}var be,Oe,ct,ut={exports:{}},st=function(){if(ct)return ut.exports;ct=1;var ge=b.cC(),z=function(){if(Oe)return be;Oe=1;var Ee=b.cA(),ye=b.cB().VectorTileFeature;function je(it,xt){this.options=xt||{},this.features=it,this.length=it.length}function ve(it,xt){this.id=typeof it.id=="number"?it.id:void 0,this.type=it.type,this.rawGeometry=it.type===1?[it.geometry]:it.geometry,this.properties=it.tags,this.extent=xt||4096}return be=je,je.prototype.feature=function(it){return new ve(this.features[it],this.options.extent)},ve.prototype.loadGeometry=function(){var it=this.rawGeometry;this.geometry=[];for(var xt=0;xt<it.length;xt++){for(var Lt=it[xt],zt=[],$e=0;$e<Lt.length;$e++)zt.push(new Ee(Lt[$e][0],Lt[$e][1]));this.geometry.push(zt)}return this.geometry},ve.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var it=this.geometry,xt=1/0,Lt=-1/0,zt=1/0,$e=-1/0,_t=0;_t<it.length;_t++)for(var mt=it[_t],Ot=0;Ot<mt.length;Ot++){var Rt=mt[Ot];xt=Math.min(xt,Rt.x),Lt=Math.max(Lt,Rt.x),zt=Math.min(zt,Rt.y),$e=Math.max($e,Rt.y)}return[xt,zt,Lt,$e]},ve.prototype.toGeoJSON=ye.prototype.toGeoJSON,be}();function W(Ee){var ye=new ge;return function(je,ve){for(var it in je.layers)ve.writeMessage(3,Y,je.layers[it])}(Ee,ye),ye.finish()}function Y(Ee,ye){var je;ye.writeVarintField(15,Ee.version||1),ye.writeStringField(1,Ee.name||""),ye.writeVarintField(5,Ee.extent||4096);var ve={keys:[],values:[],keycache:{},valuecache:{}};for(je=0;je<Ee.length;je++)ve.feature=Ee.feature(je),ye.writeMessage(2,te,ve);var it=ve.keys;for(je=0;je<it.length;je++)ye.writeStringField(3,it[je]);var xt=ve.values;for(je=0;je<xt.length;je++)ye.writeMessage(4,De,xt[je])}function te(Ee,ye){var je=Ee.feature;je.id!==void 0&&ye.writeVarintField(1,je.id),ye.writeMessage(2,ce,Ee),ye.writeVarintField(3,je.type),ye.writeMessage(4,me,je)}function ce(Ee,ye){var je=Ee.feature,ve=Ee.keys,it=Ee.values,xt=Ee.keycache,Lt=Ee.valuecache;for(var zt in je.properties){var $e=je.properties[zt],_t=xt[zt];if($e!==null){_t===void 0&&(ve.push(zt),xt[zt]=_t=ve.length-1),ye.writeVarint(_t);var mt=typeof $e;mt!=="string"&&mt!=="boolean"&&mt!=="number"&&($e=JSON.stringify($e));var Ot=mt+":"+$e,Rt=Lt[Ot];Rt===void 0&&(it.push($e),Lt[Ot]=Rt=it.length-1),ye.writeVarint(Rt)}}}function _e(Ee,ye){return(ye<<3)+(7&Ee)}function Te(Ee){return Ee<<1^Ee>>31}function me(Ee,ye){for(var je=Ee.loadGeometry(),ve=Ee.type,it=0,xt=0,Lt=je.length,zt=0;zt<Lt;zt++){var $e=je[zt],_t=1;ve===1&&(_t=$e.length),ye.writeVarint(_e(1,_t));for(var mt=ve===3?$e.length-1:$e.length,Ot=0;Ot<mt;Ot++){Ot===1&&ve!==1&&ye.writeVarint(_e(2,mt-1));var Rt=$e[Ot].x-it,jt=$e[Ot].y-xt;ye.writeVarint(Te(Rt)),ye.writeVarint(Te(jt)),it+=Rt,xt+=jt}ve===3&&ye.writeVarint(_e(7,1))}}function De(Ee,ye){var je=typeof Ee;je==="string"?ye.writeStringField(1,Ee):je==="boolean"?ye.writeBooleanField(7,Ee):je==="number"&&(Ee%1!=0?ye.writeDoubleField(3,Ee):Ee<0?ye.writeSVarintField(6,Ee):ye.writeVarintField(5,Ee))}return ut.exports=W,ut.exports.fromVectorTileJs=W,ut.exports.fromGeojsonVt=function(Ee,ye){ye=ye||{};var je={};for(var ve in Ee)je[ve]=new z(Ee[ve].features,ye),je[ve].name=ve,je[ve].version=ye.version,je[ve].extent=ye.extent;return W({layers:je})},ut.exports.GeoJSONWrapper=z,ut.exports}(),Qe=b.cz(st);const gt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ge=>ge},ot=Math.fround||(Me=new Float32Array(1),ge=>(Me[0]=+ge,Me[0]));var Me;const Fe=3,tt=5,At=6;class ft{constructor(z){this.options=Object.assign(Object.create(gt),z),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(z){const{log:W,minZoom:Y,maxZoom:te}=this.options;W&&console.time("total time");const ce=`prepare ${z.length} points`;W&&console.time(ce),this.points=z;const _e=[];for(let me=0;me<z.length;me++){const De=z[me];if(!De.geometry)continue;const[Ee,ye]=De.geometry.coordinates,je=ot(Ut(Ee)),ve=ot(dr(ye));_e.push(je,ve,1/0,me,-1,1),this.options.reduce&&_e.push(0)}let Te=this.trees[te+1]=this._createTree(_e);W&&console.timeEnd(ce);for(let me=te;me>=Y;me--){const De=+Date.now();Te=this.trees[me]=this._createTree(this._cluster(Te,me)),W&&console.log("z%d: %d clusters in %dms",me,Te.numItems,+Date.now()-De)}return W&&console.timeEnd("total time"),this}getClusters(z,W){let Y=((z[0]+180)%360+360)%360-180;const te=Math.max(-90,Math.min(90,z[1]));let ce=z[2]===180?180:((z[2]+180)%360+360)%360-180;const _e=Math.max(-90,Math.min(90,z[3]));if(z[2]-z[0]>=360)Y=-180,ce=180;else if(Y>ce){const ye=this.getClusters([Y,te,180,_e],W),je=this.getClusters([-180,te,ce,_e],W);return ye.concat(je)}const Te=this.trees[this._limitZoom(W)],me=Te.range(Ut(Y),dr(_e),Ut(ce),dr(te)),De=Te.data,Ee=[];for(const ye of me){const je=this.stride*ye;Ee.push(De[je+tt]>1?bt(De,je,this.clusterProps):this.points[De[je+Fe]])}return Ee}getChildren(z){const W=this._getOriginId(z),Y=this._getOriginZoom(z),te="No cluster with the specified id.",ce=this.trees[Y];if(!ce)throw new Error(te);const _e=ce.data;if(W*this.stride>=_e.length)throw new Error(te);const Te=this.options.radius/(this.options.extent*Math.pow(2,Y-1)),me=ce.within(_e[W*this.stride],_e[W*this.stride+1],Te),De=[];for(const Ee of me){const ye=Ee*this.stride;_e[ye+4]===z&&De.push(_e[ye+tt]>1?bt(_e,ye,this.clusterProps):this.points[_e[ye+Fe]])}if(De.length===0)throw new Error(te);return De}getLeaves(z,W,Y){const te=[];return this._appendLeaves(te,z,W=W||10,Y=Y||0,0),te}getTile(z,W,Y){const te=this.trees[this._limitZoom(z)],ce=Math.pow(2,z),{extent:_e,radius:Te}=this.options,me=Te/_e,De=(Y-me)/ce,Ee=(Y+1+me)/ce,ye={features:[]};return this._addTileFeatures(te.range((W-me)/ce,De,(W+1+me)/ce,Ee),te.data,W,Y,ce,ye),W===0&&this._addTileFeatures(te.range(1-me/ce,De,1,Ee),te.data,ce,Y,ce,ye),W===ce-1&&this._addTileFeatures(te.range(0,De,me/ce,Ee),te.data,-1,Y,ce,ye),ye.features.length?ye:null}getClusterExpansionZoom(z){let W=this._getOriginZoom(z)-1;for(;W<=this.options.maxZoom;){const Y=this.getChildren(z);if(W++,Y.length!==1)break;z=Y[0].properties.cluster_id}return W}_appendLeaves(z,W,Y,te,ce){const _e=this.getChildren(W);for(const Te of _e){const me=Te.properties;if(me&&me.cluster?ce+me.point_count<=te?ce+=me.point_count:ce=this._appendLeaves(z,me.cluster_id,Y,te,ce):ce<te?ce++:z.push(Te),z.length===Y)break}return ce}_createTree(z){const W=new b.aB(z.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Y=0;Y<z.length;Y+=this.stride)W.add(z[Y],z[Y+1]);return W.finish(),W.data=z,W}_addTileFeatures(z,W,Y,te,ce,_e){for(const Te of z){const me=Te*this.stride,De=W[me+tt]>1;let Ee,ye,je;if(De)Ee=Pt(W,me,this.clusterProps),ye=W[me],je=W[me+1];else{const xt=this.points[W[me+Fe]];Ee=xt.properties;const[Lt,zt]=xt.geometry.coordinates;ye=Ut(Lt),je=dr(zt)}const ve={type:1,geometry:[[Math.round(this.options.extent*(ye*ce-Y)),Math.round(this.options.extent*(je*ce-te))]],tags:Ee};let it;it=De||this.options.generateId?W[me+Fe]:this.points[W[me+Fe]].id,it!==void 0&&(ve.id=it),_e.features.push(ve)}}_limitZoom(z){return Math.max(this.options.minZoom,Math.min(Math.floor(+z),this.options.maxZoom+1))}_cluster(z,W){const{radius:Y,extent:te,reduce:ce,minPoints:_e}=this.options,Te=Y/(te*Math.pow(2,W)),me=z.data,De=[],Ee=this.stride;for(let ye=0;ye<me.length;ye+=Ee){if(me[ye+2]<=W)continue;me[ye+2]=W;const je=me[ye],ve=me[ye+1],it=z.within(me[ye],me[ye+1],Te),xt=me[ye+tt];let Lt=xt;for(const zt of it){const $e=zt*Ee;me[$e+2]>W&&(Lt+=me[$e+tt])}if(Lt>xt&&Lt>=_e){let zt,$e=je*xt,_t=ve*xt,mt=-1;const Ot=((ye/Ee|0)<<5)+(W+1)+this.points.length;for(const Rt of it){const jt=Rt*Ee;if(me[jt+2]<=W)continue;me[jt+2]=W;const Tt=me[jt+tt];$e+=me[jt]*Tt,_t+=me[jt+1]*Tt,me[jt+4]=Ot,ce&&(zt||(zt=this._map(me,ye,!0),mt=this.clusterProps.length,this.clusterProps.push(zt)),ce(zt,this._map(me,jt)))}me[ye+4]=Ot,De.push($e/Lt,_t/Lt,1/0,Ot,-1,Lt),ce&&De.push(mt)}else{for(let zt=0;zt<Ee;zt++)De.push(me[ye+zt]);if(Lt>1)for(const zt of it){const $e=zt*Ee;if(!(me[$e+2]<=W)){me[$e+2]=W;for(let _t=0;_t<Ee;_t++)De.push(me[$e+_t])}}}}return De}_getOriginId(z){return z-this.points.length>>5}_getOriginZoom(z){return(z-this.points.length)%32}_map(z,W,Y){if(z[W+tt]>1){const _e=this.clusterProps[z[W+At]];return Y?Object.assign({},_e):_e}const te=this.points[z[W+Fe]].properties,ce=this.options.map(te);return Y&&ce===te?Object.assign({},ce):ce}}function bt(ge,z,W){return{type:"Feature",id:ge[z+Fe],properties:Pt(ge,z,W),geometry:{type:"Point",coordinates:[(Y=ge[z],360*(Y-.5)),ir(ge[z+1])]}};var Y}function Pt(ge,z,W){const Y=ge[z+tt],te=Y>=1e4?`${Math.round(Y/1e3)}k`:Y>=1e3?Math.round(Y/100)/10+"k":Y,ce=ge[z+At],_e=ce===-1?{}:Object.assign({},W[ce]);return Object.assign(_e,{cluster:!0,cluster_id:ge[z+Fe],point_count:Y,point_count_abbreviated:te})}function Ut(ge){return ge/360+.5}function dr(ge){const z=Math.sin(ge*Math.PI/180),W=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return W<0?0:W>1?1:W}function ir(ge){const z=(180-360*ge)*Math.PI/180;return 360*Math.atan(Math.exp(z))/Math.PI-90}function Ht(ge,z,W,Y){let te=Y;const ce=z+(W-z>>1);let _e,Te=W-z;const me=ge[z],De=ge[z+1],Ee=ge[W],ye=ge[W+1];for(let je=z+3;je<W;je+=3){const ve=Mr(ge[je],ge[je+1],me,De,Ee,ye);if(ve>te)_e=je,te=ve;else if(ve===te){const it=Math.abs(je-ce);it<Te&&(_e=je,Te=it)}}te>Y&&(_e-z>3&&Ht(ge,z,_e,Y),ge[_e+2]=te,W-_e>3&&Ht(ge,_e,W,Y))}function Mr(ge,z,W,Y,te,ce){let _e=te-W,Te=ce-Y;if(_e!==0||Te!==0){const me=((ge-W)*_e+(z-Y)*Te)/(_e*_e+Te*Te);me>1?(W=te,Y=ce):me>0&&(W+=_e*me,Y+=Te*me)}return _e=ge-W,Te=z-Y,_e*_e+Te*Te}function zr(ge,z,W,Y){const te={id:ge??null,type:z,geometry:W,tags:Y,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(z==="Point"||z==="MultiPoint"||z==="LineString")Cr(te,W);else if(z==="Polygon")Cr(te,W[0]);else if(z==="MultiLineString")for(const ce of W)Cr(te,ce);else if(z==="MultiPolygon")for(const ce of W)Cr(te,ce[0]);return te}function Cr(ge,z){for(let W=0;W<z.length;W+=3)ge.minX=Math.min(ge.minX,z[W]),ge.minY=Math.min(ge.minY,z[W+1]),ge.maxX=Math.max(ge.maxX,z[W]),ge.maxY=Math.max(ge.maxY,z[W+1])}function Kr(ge,z,W,Y){if(!z.geometry)return;const te=z.geometry.coordinates;if(te&&te.length===0)return;const ce=z.geometry.type,_e=Math.pow(W.tolerance/((1<<W.maxZoom)*W.extent),2);let Te=[],me=z.id;if(W.promoteId?me=z.properties[W.promoteId]:W.generateId&&(me=Y||0),ce==="Point")Tn(te,Te);else if(ce==="MultiPoint")for(const De of te)Tn(De,Te);else if(ce==="LineString")Gn(te,Te,_e,!1);else if(ce==="MultiLineString"){if(W.lineMetrics){for(const De of te)Te=[],Gn(De,Te,_e,!1),ge.push(zr(me,"LineString",Te,z.properties));return}cn(te,Te,_e,!1)}else if(ce==="Polygon")cn(te,Te,_e,!0);else{if(ce!=="MultiPolygon"){if(ce==="GeometryCollection"){for(const De of z.geometry.geometries)Kr(ge,{id:me,geometry:De,properties:z.properties},W,Y);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const De of te){const Ee=[];cn(De,Ee,_e,!0),Te.push(Ee)}}ge.push(zr(me,ce,Te,z.properties))}function Tn(ge,z){z.push(qn(ge[0]),Jr(ge[1]),0)}function Gn(ge,z,W,Y){let te,ce,_e=0;for(let me=0;me<ge.length;me++){const De=qn(ge[me][0]),Ee=Jr(ge[me][1]);z.push(De,Ee,0),me>0&&(_e+=Y?(te*Ee-De*ce)/2:Math.sqrt(Math.pow(De-te,2)+Math.pow(Ee-ce,2))),te=De,ce=Ee}const Te=z.length-3;z[2]=1,Ht(z,0,Te,W),z[Te+2]=1,z.size=Math.abs(_e),z.start=0,z.end=z.size}function cn(ge,z,W,Y){for(let te=0;te<ge.length;te++){const ce=[];Gn(ge[te],ce,W,Y),z.push(ce)}}function qn(ge){return ge/360+.5}function Jr(ge){const z=Math.sin(ge*Math.PI/180),W=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return W<0?0:W>1?1:W}function ae(ge,z,W,Y,te,ce,_e,Te){if(Y/=z,ce>=(W/=z)&&_e<Y)return ge;if(_e<W||ce>=Y)return null;const me=[];for(const De of ge){const Ee=De.geometry;let ye=De.type;const je=te===0?De.minX:De.minY,ve=te===0?De.maxX:De.maxY;if(je>=W&&ve<Y){me.push(De);continue}if(ve<W||je>=Y)continue;let it=[];if(ye==="Point"||ye==="MultiPoint")pe(Ee,it,W,Y,te);else if(ye==="LineString")Ie(Ee,it,W,Y,te,!1,Te.lineMetrics);else if(ye==="MultiLineString")We(Ee,it,W,Y,te,!1);else if(ye==="Polygon")We(Ee,it,W,Y,te,!0);else if(ye==="MultiPolygon")for(const xt of Ee){const Lt=[];We(xt,Lt,W,Y,te,!0),Lt.length&&it.push(Lt)}if(it.length){if(Te.lineMetrics&&ye==="LineString"){for(const xt of it)me.push(zr(De.id,ye,xt,De.tags));continue}ye!=="LineString"&&ye!=="MultiLineString"||(it.length===1?(ye="LineString",it=it[0]):ye="MultiLineString"),ye!=="Point"&&ye!=="MultiPoint"||(ye=it.length===3?"Point":"MultiPoint"),me.push(zr(De.id,ye,it,De.tags))}}return me.length?me:null}function pe(ge,z,W,Y,te){for(let ce=0;ce<ge.length;ce+=3){const _e=ge[ce+te];_e>=W&&_e<=Y&&He(z,ge[ce],ge[ce+1],ge[ce+2])}}function Ie(ge,z,W,Y,te,ce,_e){let Te=Ke(ge);const me=te===0?lt:at;let De,Ee,ye=ge.start;for(let Lt=0;Lt<ge.length-3;Lt+=3){const zt=ge[Lt],$e=ge[Lt+1],_t=ge[Lt+2],mt=ge[Lt+3],Ot=ge[Lt+4],Rt=te===0?zt:$e,jt=te===0?mt:Ot;let Tt=!1;_e&&(De=Math.sqrt(Math.pow(zt-mt,2)+Math.pow($e-Ot,2))),Rt<W?jt>W&&(Ee=me(Te,zt,$e,mt,Ot,W),_e&&(Te.start=ye+De*Ee)):Rt>Y?jt<Y&&(Ee=me(Te,zt,$e,mt,Ot,Y),_e&&(Te.start=ye+De*Ee)):He(Te,zt,$e,_t),jt<W&&Rt>=W&&(Ee=me(Te,zt,$e,mt,Ot,W),Tt=!0),jt>Y&&Rt<=Y&&(Ee=me(Te,zt,$e,mt,Ot,Y),Tt=!0),!ce&&Tt&&(_e&&(Te.end=ye+De*Ee),z.push(Te),Te=Ke(ge)),_e&&(ye+=De)}let je=ge.length-3;const ve=ge[je],it=ge[je+1],xt=te===0?ve:it;xt>=W&&xt<=Y&&He(Te,ve,it,ge[je+2]),je=Te.length-3,ce&&je>=3&&(Te[je]!==Te[0]||Te[je+1]!==Te[1])&&He(Te,Te[0],Te[1],Te[2]),Te.length&&z.push(Te)}function Ke(ge){const z=[];return z.size=ge.size,z.start=ge.start,z.end=ge.end,z}function We(ge,z,W,Y,te,ce){for(const _e of ge)Ie(_e,z,W,Y,te,ce,!1)}function He(ge,z,W,Y){ge.push(z,W,Y)}function lt(ge,z,W,Y,te,ce){const _e=(ce-z)/(Y-z);return He(ge,ce,W+(te-W)*_e,1),_e}function at(ge,z,W,Y,te,ce){const _e=(ce-W)/(te-W);return He(ge,z+(Y-z)*_e,ce,1),_e}function nt(ge,z){const W=[];for(let Y=0;Y<ge.length;Y++){const te=ge[Y],ce=te.type;let _e;if(ce==="Point"||ce==="MultiPoint"||ce==="LineString")_e=Xe(te.geometry,z);else if(ce==="MultiLineString"||ce==="Polygon"){_e=[];for(const Te of te.geometry)_e.push(Xe(Te,z))}else if(ce==="MultiPolygon"){_e=[];for(const Te of te.geometry){const me=[];for(const De of Te)me.push(Xe(De,z));_e.push(me)}}W.push(zr(te.id,ce,_e,te.tags))}return W}function Xe(ge,z){const W=[];W.size=ge.size,ge.start!==void 0&&(W.start=ge.start,W.end=ge.end);for(let Y=0;Y<ge.length;Y+=3)W.push(ge[Y]+z,ge[Y+1],ge[Y+2]);return W}function It(ge,z){if(ge.transformed)return ge;const W=1<<ge.z,Y=ge.x,te=ge.y;for(const ce of ge.features){const _e=ce.geometry,Te=ce.type;if(ce.geometry=[],Te===1)for(let me=0;me<_e.length;me+=2)ce.geometry.push(ht(_e[me],_e[me+1],z,W,Y,te));else for(let me=0;me<_e.length;me++){const De=[];for(let Ee=0;Ee<_e[me].length;Ee+=2)De.push(ht(_e[me][Ee],_e[me][Ee+1],z,W,Y,te));ce.geometry.push(De)}}return ge.transformed=!0,ge}function ht(ge,z,W,Y,te,ce){return[Math.round(W*(ge*Y-te)),Math.round(W*(z*Y-ce))]}function St(ge,z,W,Y,te){const ce=z===te.maxZoom?0:te.tolerance/((1<<z)*te.extent),_e={features:[],numPoints:0,numSimplified:0,numFeatures:ge.length,source:null,x:W,y:Y,z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Te of ge)Dt(_e,Te,ce,te);return _e}function Dt(ge,z,W,Y){const te=z.geometry,ce=z.type,_e=[];if(ge.minX=Math.min(ge.minX,z.minX),ge.minY=Math.min(ge.minY,z.minY),ge.maxX=Math.max(ge.maxX,z.maxX),ge.maxY=Math.max(ge.maxY,z.maxY),ce==="Point"||ce==="MultiPoint")for(let Te=0;Te<te.length;Te+=3)_e.push(te[Te],te[Te+1]),ge.numPoints++,ge.numSimplified++;else if(ce==="LineString")Ft(_e,te,ge,W,!1,!1);else if(ce==="MultiLineString"||ce==="Polygon")for(let Te=0;Te<te.length;Te++)Ft(_e,te[Te],ge,W,ce==="Polygon",Te===0);else if(ce==="MultiPolygon")for(let Te=0;Te<te.length;Te++){const me=te[Te];for(let De=0;De<me.length;De++)Ft(_e,me[De],ge,W,!0,De===0)}if(_e.length){let Te=z.tags||null;if(ce==="LineString"&&Y.lineMetrics){Te={};for(const De in z.tags)Te[De]=z.tags[De];Te.mapbox_clip_start=te.start/te.size,Te.mapbox_clip_end=te.end/te.size}const me={geometry:_e,type:ce==="Polygon"||ce==="MultiPolygon"?3:ce==="LineString"||ce==="MultiLineString"?2:1,tags:Te};z.id!==null&&(me.id=z.id),ge.features.push(me)}}function Ft(ge,z,W,Y,te,ce){const _e=Y*Y;if(Y>0&&z.size<(te?_e:Y))return void(W.numPoints+=z.length/3);const Te=[];for(let me=0;me<z.length;me+=3)(Y===0||z[me+2]>_e)&&(W.numSimplified++,Te.push(z[me],z[me+1])),W.numPoints++;te&&function(me,De){let Ee=0;for(let ye=0,je=me.length,ve=je-2;ye<je;ve=ye,ye+=2)Ee+=(me[ye]-me[ve])*(me[ye+1]+me[ve+1]);if(Ee>0===De)for(let ye=0,je=me.length;ye<je/2;ye+=2){const ve=me[ye],it=me[ye+1];me[ye]=me[je-2-ye],me[ye+1]=me[je-1-ye],me[je-2-ye]=ve,me[je-1-ye]=it}}(Te,ce),ge.push(Te)}const Yt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Zt{constructor(z,W){const Y=(W=this.options=function(ce,_e){for(const Te in _e)ce[Te]=_e[Te];return ce}(Object.create(Yt),W)).debug;if(Y&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");let te=function(ce,_e){const Te=[];if(ce.type==="FeatureCollection")for(let me=0;me<ce.features.length;me++)Kr(Te,ce.features[me],_e,me);else Kr(Te,ce.type==="Feature"?ce:{geometry:ce},_e);return Te}(z,W);this.tiles={},this.tileCoords=[],Y&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),te=function(ce,_e){const Te=_e.buffer/_e.extent;let me=ce;const De=ae(ce,1,-1-Te,Te,0,-1,2,_e),Ee=ae(ce,1,1-Te,2+Te,0,-1,2,_e);return(De||Ee)&&(me=ae(ce,1,-Te,1+Te,0,-1,2,_e)||[],De&&(me=nt(De,1).concat(me)),Ee&&(me=me.concat(nt(Ee,-1)))),me}(te,W),te.length&&this.splitTile(te,0,0,0),Y&&(te.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(z,W,Y,te,ce,_e,Te){const me=[z,W,Y,te],De=this.options,Ee=De.debug;for(;me.length;){te=me.pop(),Y=me.pop(),W=me.pop(),z=me.pop();const ye=1<<W,je=jr(W,Y,te);let ve=this.tiles[je];if(!ve&&(Ee>1&&console.time("creation"),ve=this.tiles[je]=St(z,W,Y,te,De),this.tileCoords.push({z:W,x:Y,y:te}),Ee)){Ee>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,Y,te,ve.numFeatures,ve.numPoints,ve.numSimplified),console.timeEnd("creation"));const Tt=`z${W}`;this.stats[Tt]=(this.stats[Tt]||0)+1,this.total++}if(ve.source=z,ce==null){if(W===De.indexMaxZoom||ve.numPoints<=De.indexMaxPoints)continue}else{if(W===De.maxZoom||W===ce)continue;if(ce!=null){const Tt=ce-W;if(Y!==_e>>Tt||te!==Te>>Tt)continue}}if(ve.source=null,z.length===0)continue;Ee>1&&console.time("clipping");const it=.5*De.buffer/De.extent,xt=.5-it,Lt=.5+it,zt=1+it;let $e=null,_t=null,mt=null,Ot=null,Rt=ae(z,ye,Y-it,Y+Lt,0,ve.minX,ve.maxX,De),jt=ae(z,ye,Y+xt,Y+zt,0,ve.minX,ve.maxX,De);z=null,Rt&&($e=ae(Rt,ye,te-it,te+Lt,1,ve.minY,ve.maxY,De),_t=ae(Rt,ye,te+xt,te+zt,1,ve.minY,ve.maxY,De),Rt=null),jt&&(mt=ae(jt,ye,te-it,te+Lt,1,ve.minY,ve.maxY,De),Ot=ae(jt,ye,te+xt,te+zt,1,ve.minY,ve.maxY,De),jt=null),Ee>1&&console.timeEnd("clipping"),me.push($e||[],W+1,2*Y,2*te),me.push(_t||[],W+1,2*Y,2*te+1),me.push(mt||[],W+1,2*Y+1,2*te),me.push(Ot||[],W+1,2*Y+1,2*te+1)}}getTile(z,W,Y){z=+z,W=+W,Y=+Y;const te=this.options,{extent:ce,debug:_e}=te;if(z<0||z>24)return null;const Te=1<<z,me=jr(z,W=W+Te&Te-1,Y);if(this.tiles[me])return It(this.tiles[me],ce);_e>1&&console.log("drilling down to z%d-%d-%d",z,W,Y);let De,Ee=z,ye=W,je=Y;for(;!De&&Ee>0;)Ee--,ye>>=1,je>>=1,De=this.tiles[jr(Ee,ye,je)];return De&&De.source?(_e>1&&(console.log("found parent tile z%d-%d-%d",Ee,ye,je),console.time("drilling down")),this.splitTile(De.source,Ee,ye,je,z,W,Y),_e>1&&console.timeEnd("drilling down"),this.tiles[me]?It(this.tiles[me],ce):null):null}}function jr(ge,z,W){return 32*((1<<ge)*W+z)+ge}function Rr(ge,z){return z?ge.properties[z]:ge.id}function kn(ge,z){if(ge==null)return!0;if(ge.type==="Feature")return Rr(ge,z)!=null;if(ge.type==="FeatureCollection"){const W=new Set;for(const Y of ge.features){const te=Rr(Y,z);if(te==null||W.has(te))return!1;W.add(te)}return!0}return!1}function yn(ge,z){const W=new Map;if(ge!=null)if(ge.type==="Feature")W.set(Rr(ge,z),ge);else for(const Y of ge.features)W.set(Rr(Y,z),Y);return W}class xo extends N{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(z,W){return b._(this,void 0,void 0,function*(){const Y=z.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const te=this._geoJSONIndex.getTile(Y.z,Y.x,Y.y);if(!te)return null;const ce=new qe(te.features);let _e=Qe(ce);return _e.byteOffset===0&&_e.byteLength===_e.buffer.byteLength||(_e=new Uint8Array(_e)),{vectorTile:ce,rawData:_e.buffer}})}loadData(z){return b._(this,void 0,void 0,function*(){var W;(W=this._pendingRequest)===null||W===void 0||W.abort();const Y=!!(z&&z.request&&z.request.collectResourceTiming)&&new b.cw(z.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(z,this._pendingRequest),this._geoJSONIndex=z.cluster?new ft(function({superclusterOptions:_e,clusterProperties:Te}){if(!Te||!_e)return _e;const me={},De={},Ee={accumulated:null,zoom:0},ye={properties:null},je=Object.keys(Te);for(const ve of je){const[it,xt]=Te[ve],Lt=b.cD(xt),zt=b.cD(typeof it=="string"?[it,["accumulated"],["get",ve]]:it);me[ve]=Lt.value,De[ve]=zt.value}return _e.map=ve=>{ye.properties=ve;const it={};for(const xt of je)it[xt]=me[xt].evaluate(Ee,ye);return it},_e.reduce=(ve,it)=>{ye.properties=it;for(const xt of je)Ee.accumulated=ve[xt],ve[xt]=De[xt].evaluate(Ee,ye)},_e}(z)).load((yield this._pendingData).features):(te=yield this._pendingData,new Zt(te,z.geojsonVtOptions)),this.loaded={};const ce={};if(Y){const _e=Y.finish();_e&&(ce.resourceTiming={},ce.resourceTiming[z.source]=JSON.parse(JSON.stringify(_e)))}return ce}catch(ce){if(delete this._pendingRequest,b.ch(ce))return{abandoned:!0};throw ce}var te})}getData(){return b._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(z){const W=this.loaded;return W&&W[z.uid]?super.reloadTile(z):this.loadTile(z)}loadAndProcessGeoJSON(z,W){return b._(this,void 0,void 0,function*(){let Y=yield this.loadGeoJSON(z,W);if(delete this._pendingRequest,typeof Y!="object")throw new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`);if(Ne(Y,!0),z.filter){const te=b.cD(z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(te.result==="error")throw new Error(te.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));Y={type:"FeatureCollection",features:Y.features.filter(_e=>te.value.evaluate({zoom:0},_e))}}return Y})}loadGeoJSON(z,W){return b._(this,void 0,void 0,function*(){const{promoteId:Y}=z;if(z.request){const te=yield b.j(z.request,W);return this._dataUpdateable=kn(te.data,Y)?yn(te.data,Y):void 0,te.data}if(typeof z.data=="string")try{const te=JSON.parse(z.data);return this._dataUpdateable=kn(te,Y)?yn(te,Y):void 0,te}catch{throw new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`)}if(!z.dataDiff)throw new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${z.source}`);return function(te,ce,_e){var Te,me,De,Ee;if(ce.removeAll&&te.clear(),ce.remove)for(const ye of ce.remove)te.delete(ye);if(ce.add)for(const ye of ce.add){const je=Rr(ye,_e);je!=null&&te.set(je,ye)}if(ce.update)for(const ye of ce.update){let je=te.get(ye.id);if(je==null)continue;const ve=!ye.removeAllProperties&&(((Te=ye.removeProperties)===null||Te===void 0?void 0:Te.length)>0||((me=ye.addOrUpdateProperties)===null||me===void 0?void 0:me.length)>0);if((ye.newGeometry||ye.removeAllProperties||ve)&&(je=Object.assign({},je),te.set(ye.id,je),ve&&(je.properties=Object.assign({},je.properties))),ye.newGeometry&&(je.geometry=ye.newGeometry),ye.removeAllProperties)je.properties={};else if(((De=ye.removeProperties)===null||De===void 0?void 0:De.length)>0)for(const it of ye.removeProperties)Object.prototype.hasOwnProperty.call(je.properties,it)&&delete je.properties[it];if(((Ee=ye.addOrUpdateProperties)===null||Ee===void 0?void 0:Ee.length)>0)for(const{key:it,value:xt}of ye.addOrUpdateProperties)je.properties[it]=xt}}(this._dataUpdateable,z.dataDiff,Y),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(z){return b._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(z){return this._geoJSONIndex.getClusterExpansionZoom(z.clusterId)}getClusterChildren(z){return this._geoJSONIndex.getChildren(z.clusterId)}getClusterLeaves(z){return this._geoJSONIndex.getLeaves(z.clusterId,z.limit,z.offset)}}class io{constructor(z){this.self=z,this.actor=new b.H(z),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(W,Y)=>{if(this.externalWorkerSourceTypes[W])throw new Error(`Worker source with name "${W}" already registered.`);this.externalWorkerSourceTypes[W]=Y},this.self.addProtocol=b.cj,this.self.removeProtocol=b.ck,this.self.registerRTLTextPlugin=W=>{b.cE.setMethods(W)},this.actor.registerMessageHandler("LDT",(W,Y)=>this._getDEMWorkerSource(W,Y.source).loadTile(Y)),this.actor.registerMessageHandler("RDT",(W,Y)=>b._(this,void 0,void 0,function*(){this._getDEMWorkerSource(W,Y.source).removeTile(Y)})),this.actor.registerMessageHandler("GCEZ",(W,Y)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(W,Y.type,Y.source).getClusterExpansionZoom(Y)})),this.actor.registerMessageHandler("GCC",(W,Y)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(W,Y.type,Y.source).getClusterChildren(Y)})),this.actor.registerMessageHandler("GCL",(W,Y)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(W,Y.type,Y.source).getClusterLeaves(Y)})),this.actor.registerMessageHandler("LD",(W,Y)=>this._getWorkerSource(W,Y.type,Y.source).loadData(Y)),this.actor.registerMessageHandler("GD",(W,Y)=>this._getWorkerSource(W,Y.type,Y.source).getData()),this.actor.registerMessageHandler("LT",(W,Y)=>this._getWorkerSource(W,Y.type,Y.source).loadTile(Y)),this.actor.registerMessageHandler("RT",(W,Y)=>this._getWorkerSource(W,Y.type,Y.source).reloadTile(Y)),this.actor.registerMessageHandler("AT",(W,Y)=>this._getWorkerSource(W,Y.type,Y.source).abortTile(Y)),this.actor.registerMessageHandler("RMT",(W,Y)=>this._getWorkerSource(W,Y.type,Y.source).removeTile(Y)),this.actor.registerMessageHandler("RS",(W,Y)=>b._(this,void 0,void 0,function*(){if(!this.workerSources[W]||!this.workerSources[W][Y.type]||!this.workerSources[W][Y.type][Y.source])return;const te=this.workerSources[W][Y.type][Y.source];delete this.workerSources[W][Y.type][Y.source],te.removeSource!==void 0&&te.removeSource(Y)})),this.actor.registerMessageHandler("RM",W=>b._(this,void 0,void 0,function*(){delete this.layerIndexes[W],delete this.availableImages[W],delete this.workerSources[W],delete this.demWorkerSources[W]})),this.actor.registerMessageHandler("SR",(W,Y)=>b._(this,void 0,void 0,function*(){this.referrer=Y})),this.actor.registerMessageHandler("SRPS",(W,Y)=>this._syncRTLPluginState(W,Y)),this.actor.registerMessageHandler("IS",(W,Y)=>b._(this,void 0,void 0,function*(){this.self.importScripts(Y)})),this.actor.registerMessageHandler("SI",(W,Y)=>this._setImages(W,Y)),this.actor.registerMessageHandler("UL",(W,Y)=>b._(this,void 0,void 0,function*(){this._getLayerIndex(W).update(Y.layers,Y.removedIds)})),this.actor.registerMessageHandler("SL",(W,Y)=>b._(this,void 0,void 0,function*(){this._getLayerIndex(W).replace(Y)}))}_setImages(z,W){return b._(this,void 0,void 0,function*(){this.availableImages[z]=W;for(const Y in this.workerSources[z]){const te=this.workerSources[z][Y];for(const ce in te)te[ce].availableImages=W}})}_syncRTLPluginState(z,W){return b._(this,void 0,void 0,function*(){return yield b.cE.syncState(W,this.self.importScripts)})}_getAvailableImages(z){let W=this.availableImages[z];return W||(W=[]),W}_getLayerIndex(z){let W=this.layerIndexes[z];return W||(W=this.layerIndexes[z]=new a),W}_getWorkerSource(z,W,Y){if(this.workerSources[z]||(this.workerSources[z]={}),this.workerSources[z][W]||(this.workerSources[z][W]={}),!this.workerSources[z][W][Y]){const te={sendAsync:(ce,_e)=>(ce.targetMapId=z,this.actor.sendAsync(ce,_e))};switch(W){case"vector":this.workerSources[z][W][Y]=new N(te,this._getLayerIndex(z),this._getAvailableImages(z));break;case"geojson":this.workerSources[z][W][Y]=new xo(te,this._getLayerIndex(z),this._getAvailableImages(z));break;default:this.workerSources[z][W][Y]=new this.externalWorkerSourceTypes[W](te,this._getLayerIndex(z),this._getAvailableImages(z))}}return this.workerSources[z][W][Y]}_getDEMWorkerSource(z,W){return this.demWorkerSources[z]||(this.demWorkerSources[z]={}),this.demWorkerSources[z][W]||(this.demWorkerSources[z][W]=new q),this.demWorkerSources[z][W]}}return b.i(self)&&(self.worker=new io(self)),io}),y("index",["exports","./shared"],function(b,a){var I="5.2.0";function R(){var p=new a.A(4);return a.A!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}let $,N;const q={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(p,e,o){const c=requestAnimationFrame(m=>{h(),e(m)}),{unsubscribe:h}=a.s(p.signal,"abort",()=>{h(),cancelAnimationFrame(c),o(a.c())},!1)},frameAsync(p){return new Promise((e,o)=>{this.frame(p,e,o)})},getImageData(p,e=0){return this.getImageCanvasContext(p).getImageData(-e,-e,p.width+2*e,p.height+2*e)},getImageCanvasContext(p){const e=window.document.createElement("canvas"),o=e.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return e.width=p.width,e.height=p.height,o.drawImage(p,0,0,p.width,p.height),o},resolveURL:p=>($||($=document.createElement("a")),$.href=p,$.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(N==null&&(N=matchMedia("(prefers-reduced-motion: reduce)")),N.matches)}};class V{static testProp(e){if(!V.docStyle)return e[0];for(let o=0;o<e.length;o++)if(e[o]in V.docStyle)return e[o];return e[0]}static create(e,o,c){const h=window.document.createElement(e);return o!==void 0&&(h.className=o),c&&c.appendChild(h),h}static createNS(e,o){return window.document.createElementNS(e,o)}static disableDrag(){V.docStyle&&V.selectProp&&(V.userSelect=V.docStyle[V.selectProp],V.docStyle[V.selectProp]="none")}static enableDrag(){V.docStyle&&V.selectProp&&(V.docStyle[V.selectProp]=V.userSelect)}static setTransform(e,o){e.style[V.transformProp]=o}static addEventListener(e,o,c,h={}){e.addEventListener(o,c,"passive"in h?h:h.capture)}static removeEventListener(e,o,c,h={}){e.removeEventListener(o,c,"passive"in h?h:h.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",V.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",V.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",V.suppressClickInternal,!0)},0)}static getScale(e){const o=e.getBoundingClientRect();return{x:o.width/e.offsetWidth||1,y:o.height/e.offsetHeight||1,boundingClientRect:o}}static getPoint(e,o,c){const h=o.boundingClientRect;return new a.P((c.clientX-h.left)/o.x-e.clientLeft,(c.clientY-h.top)/o.y-e.clientTop)}static mousePos(e,o){const c=V.getScale(e);return V.getPoint(e,c,o)}static touchPos(e,o){const c=[],h=V.getScale(e);for(let m=0;m<o.length;m++)c.push(V.getPoint(e,h,o[m]));return c}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const o=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),c=o.querySelectorAll("script");for(const h of c)h.remove();return V.clean(o),o.innerHTML}static isPossiblyDangerous(e,o){const c=o.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!c.includes("javascript:")&&!c.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const o=e.children;for(const c of o)V.removeAttributes(c),V.clean(c)}static removeAttributes(e){for(const{name:o,value:c}of e.attributes)V.isPossiblyDangerous(o,c)&&e.removeAttribute(o)}}V.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,V.selectProp=V.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),V.transformProp=V.testProp(["transform","WebkitTransform"]);const ie={supported:!1,testSupport:function(p){!xe&&Ne&&(Ge?qe(p):Pe=p)}};let Pe,Ne,xe=!1,Ge=!1;function qe(p){const e=p.createTexture();p.bindTexture(p.TEXTURE_2D,e);try{if(p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,Ne),p.isContextLost())return;ie.supported=!0}catch{}p.deleteTexture(e),xe=!0}var be;typeof document<"u"&&(Ne=document.createElement("img"),Ne.onload=()=>{Pe&&qe(Pe),Pe=null,Ge=!0},Ne.onerror=()=>{xe=!0,Pe=null},Ne.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(p){let e,o,c,h;p.resetRequestQueue=()=>{e=[],o=0,c=0,h={}},p.addThrottleControl=T=>{const P=c++;return h[P]=T,P},p.removeThrottleControl=T=>{delete h[T],v()},p.getImage=(T,P,A=!0)=>new Promise((D,L)=>{ie.supported&&(T.headers||(T.headers={}),T.headers.accept="image/webp,*/*"),a.e(T,{type:"image"}),e.push({abortController:P,requestParameters:T,supportImageRefresh:A,state:"queued",onError:U=>{L(U)},onSuccess:U=>{D(U)}}),v()});const m=T=>a._(this,void 0,void 0,function*(){T.state="running";const{requestParameters:P,supportImageRefresh:A,onError:D,onSuccess:L,abortController:U}=T,G=A===!1&&!a.i(self)&&!a.g(P.url)&&(!P.headers||Object.keys(P.headers).reduce((Q,re)=>Q&&re==="accept",!0));o++;const J=G?w(P,U):a.m(P,U);try{const Q=yield J;delete T.abortController,T.state="completed",Q.data instanceof HTMLImageElement||a.b(Q.data)?L(Q):Q.data&&L({data:yield(K=Q.data,typeof createImageBitmap=="function"?a.f(K):a.h(K)),cacheControl:Q.cacheControl,expires:Q.expires})}catch(Q){delete T.abortController,D(Q)}finally{o--,v()}var K}),v=()=>{const T=(()=>{for(const P of Object.keys(h))if(h[P]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let P=o;P<T&&e.length>0;P++){const A=e.shift();A.abortController.signal.aborted?P--:m(A)}},w=(T,P)=>new Promise((A,D)=>{const L=new Image,U=T.url,G=T.credentials;G&&G==="include"?L.crossOrigin="use-credentials":(G&&G==="same-origin"||!a.d(U))&&(L.crossOrigin="anonymous"),P.signal.addEventListener("abort",()=>{L.src="",D(a.c())}),L.fetchPriority="high",L.onload=()=>{L.onerror=L.onload=null,A({data:L})},L.onerror=()=>{L.onerror=L.onload=null,P.signal.aborted||D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},L.src=U})}(be||(be={})),be.resetRequestQueue();class Oe{constructor(e){this._transformRequestFn=e}transformRequest(e,o){return this._transformRequestFn&&this._transformRequestFn(e,o)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function ct(p){const e=[];if(typeof p=="string")e.push({id:"default",url:p});else if(p&&p.length>0){const o=[];for(const{id:c,url:h}of p){const m=`${c}${h}`;o.indexOf(m)===-1&&(o.push(m),e.push({id:c,url:h}))}}return e}function ut(p,e,o){try{const c=new URL(p);return c.pathname+=`${e}${o}`,c.toString()}catch{throw new Error(`Invalid sprite URL "${p}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class st{constructor(e,o,c,h){this.context=e,this.format=c,this.texture=e.gl.createTexture(),this.update(o,h)}update(e,o,c){const{width:h,height:m}=e,v=!(this.size&&this.size[0]===h&&this.size[1]===m||c),{context:w}=this,{gl:T}=w;if(this.useMipmap=!!(o&&o.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!o||o.premultiply!==!1)),v)this.size=[h,m],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||a.b(e)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,e):T.texImage2D(T.TEXTURE_2D,0,this.format,h,m,0,this.format,T.UNSIGNED_BYTE,e.data);else{const{x:P,y:A}=c||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||a.b(e)?T.texSubImage2D(T.TEXTURE_2D,0,P,A,T.RGBA,T.UNSIGNED_BYTE,e):T.texSubImage2D(T.TEXTURE_2D,0,P,A,h,m,T.RGBA,T.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(e,o,c){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),c!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=m.LINEAR),e!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,e),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,c||e),this.filter=e),o!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Qe(p){const{userImage:e}=p;return!!(e&&e.render&&e.render())&&(p.data.replace(new Uint8Array(e.data.buffer)),!0)}class gt extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:o,promiseResolve:c}of this.requestors)c(this._getImagesForIds(o));this.requestors=[]}}getImage(e){const o=this.images[e];if(o&&!o.data&&o.spriteData){const c=o.spriteData;o.data=new a.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),o.spriteData=null}return o}addImage(e,o){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,o)&&(this.images[e]=o)}_validate(e,o){let c=!0;const h=o.data||o.spriteData;return this._validateStretch(o.stretchX,h&&h.width)||(this.fire(new a.k(new Error(`Image "${e}" has invalid "stretchX" value`))),c=!1),this._validateStretch(o.stretchY,h&&h.height)||(this.fire(new a.k(new Error(`Image "${e}" has invalid "stretchY" value`))),c=!1),this._validateContent(o.content,o)||(this.fire(new a.k(new Error(`Image "${e}" has invalid "content" value`))),c=!1),c}_validateStretch(e,o){if(!e)return!0;let c=0;for(const h of e){if(h[0]<c||h[1]<h[0]||o<h[1])return!1;c=h[1]}return!0}_validateContent(e,o){if(!e)return!0;if(e.length!==4)return!1;const c=o.spriteData,h=c&&c.width||o.data.width,m=c&&c.height||o.data.height;return!(e[0]<0||h<e[0]||e[1]<0||m<e[1]||e[2]<0||h<e[2]||e[3]<0||m<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,o,c=!0){const h=this.getImage(e);if(c&&(h.data.width!==o.data.width||h.data.height!==o.data.height))throw new Error(`size mismatch between old image (${h.data.width}x${h.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=h.version+1,this.images[e]=o,this.updatedImages[e]=!0}removeImage(e){const o=this.images[e];delete this.images[e],delete this.patterns[e],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((o,c)=>{let h=!0;if(!this.isLoaded())for(const m of e)this.images[m]||(h=!1);this.isLoaded()||h?o(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:o})})}_getImagesForIds(e){const o={};for(const c of e){let h=this.getImage(c);h||(this.fire(new a.l("styleimagemissing",{id:c})),h=this.getImage(c)),h?o[c]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,stretchX:h.stretchX,stretchY:h.stretchY,content:h.content,textFitWidth:h.textFitWidth,textFitHeight:h.textFitHeight,hasRenderCallback:!!(h.userImage&&h.userImage.render)}:a.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:e,height:o}=this.atlasImage;return{width:e,height:o}}getPattern(e){const o=this.patterns[e],c=this.getImage(e);if(!c)return null;if(o&&o.position.version===c.version)return o.position;if(o)o.position.version=c.version;else{const h={w:c.data.width+2,h:c.data.height+2,x:0,y:0},m=new a.I(h,c);this.patterns[e]={bin:h,position:m}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const o=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new st(e,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const m in this.patterns)e.push(this.patterns[m].bin);const{w:o,h:c}=a.p(e),h=this.atlasImage;h.resize({width:o||1,height:c||1});for(const m in this.patterns){const{bin:v}=this.patterns[m],w=v.x+1,T=v.y+1,P=this.getImage(m).data,A=P.width,D=P.height;a.R.copy(P,h,{x:0,y:0},{x:w,y:T},{width:A,height:D}),a.R.copy(P,h,{x:0,y:D-1},{x:w,y:T-1},{width:A,height:1}),a.R.copy(P,h,{x:0,y:0},{x:w,y:T+D},{width:A,height:1}),a.R.copy(P,h,{x:A-1,y:0},{x:w-1,y:T},{width:1,height:D}),a.R.copy(P,h,{x:0,y:0},{x:w+A,y:T},{width:1,height:D})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const o of e){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const c=this.getImage(o);c||a.w(`Image with ID: "${o}" was not found`),Qe(c)&&this.updateImage(o,c)}}}const ot=1e20;function Me(p,e,o,c,h,m,v,w,T){for(let P=e;P<e+c;P++)Fe(p,o*m+P,m,h,v,w,T);for(let P=o;P<o+h;P++)Fe(p,P*m+e,1,c,v,w,T)}function Fe(p,e,o,c,h,m,v){m[0]=0,v[0]=-1e20,v[1]=ot,h[0]=p[e];for(let w=1,T=0,P=0;w<c;w++){h[w]=p[e+w*o];const A=w*w;do{const D=m[T];P=(h[w]-h[D]+A-D*D)/(w-D)/2}while(P<=v[T]&&--T>-1);T++,m[T]=w,v[T]=P,v[T+1]=ot}for(let w=0,T=0;w<c;w++){for(;v[T+1]<w;)T++;const P=m[T],A=w-P;p[e+w*o]=h[P]+A*A}}class tt{constructor(e,o){this.requestManager=e,this.localIdeographFontFamily=o,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return a._(this,void 0,void 0,function*(){const o=[];for(const m in e)for(const v of e[m])o.push(this._getAndCacheGlyphsPromise(m,v));const c=yield Promise.all(o),h={};for(const{stack:m,id:v,glyph:w}of c)h[m]||(h[m]={}),h[m][v]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics};return h})}_getAndCacheGlyphsPromise(e,o){return a._(this,void 0,void 0,function*(){let c=this.entries[e];c||(c=this.entries[e]={glyphs:{},requests:{},ranges:{}});let h=c.glyphs[o];if(h!==void 0)return{stack:e,id:o,glyph:h};if(h=this._tinySDF(c,e,o),h)return c.glyphs[o]=h,{stack:e,id:o,glyph:h};const m=Math.floor(o/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[m])return{stack:e,id:o,glyph:h};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[m]){const w=tt.loadGlyphRange(e,m,this.url,this.requestManager);c.requests[m]=w}const v=yield c.requests[m];for(const w in v)this._doesCharSupportLocalGlyph(+w)||(c.glyphs[+w]=v[+w]);return c.ranges[m]=!0,{stack:e,id:o,glyph:v[o]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||a.u["CJK Unified Ideographs"](e)||a.u["Hangul Syllables"](e)||a.u.Hiragana(e)||a.u.Katakana(e)||a.u["CJK Symbols and Punctuation"](e)||a.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,o,c){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(c))return;let m=e.tinySDF;if(!m){let w="400";/bold/i.test(o)?w="900":/medium/i.test(o)?w="500":/light/i.test(o)&&(w="200"),m=e.tinySDF=new tt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:h,fontWeight:w})}const v=m.draw(String.fromCharCode(c));return{id:c,bitmap:new a.q({width:v.width||60,height:v.height||60},v.data),metrics:{width:v.glyphWidth/2||24,height:v.glyphHeight/2||24,left:v.glyphLeft/2+.5||0,top:v.glyphTop/2-27.5||-8,advance:v.glyphAdvance/2||24,isDoubleResolution:!0}}}}tt.loadGlyphRange=function(p,e,o,c){return a._(this,void 0,void 0,function*(){const h=256*e,m=h+255,v=c.transformRequest(o.replace("{fontstack}",p).replace("{range}",`${h}-${m}`),"Glyphs"),w=yield a.n(v,new AbortController);if(!w||!w.data)throw new Error(`Could not load glyph range. range: ${e}, ${h}-${m}`);const T={};for(const P of a.o(w.data))T[P.id]=P;return T})},tt.TinySDF=class{constructor({fontSize:p=24,buffer:e=3,radius:o=8,cutoff:c=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:v="normal"}={}){this.buffer=e,this.cutoff=c,this.radius=o;const w=this.size=p+4*e,T=this._createCanvas(w),P=this.ctx=T.getContext("2d",{willReadFrequently:!0});P.font=`${v} ${m} ${p}px ${h}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(p){const e=document.createElement("canvas");return e.width=e.height=p,e}draw(p){const{width:e,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(p),v=Math.ceil(o),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-h))),T=Math.min(this.size-this.buffer,v+Math.ceil(c)),P=w+2*this.buffer,A=T+2*this.buffer,D=Math.max(P*A,0),L=new Uint8ClampedArray(D),U={data:L,width:P,height:A,glyphWidth:w,glyphHeight:T,glyphTop:v,glyphLeft:0,glyphAdvance:e};if(w===0||T===0)return U;const{ctx:G,buffer:J,gridInner:K,gridOuter:Q}=this;G.clearRect(J,J,w,T),G.fillText(p,J,J+v);const re=G.getImageData(J,J,w,T);Q.fill(ot,0,D),K.fill(0,0,D);for(let se=0;se<T;se++)for(let le=0;le<w;le++){const ue=re.data[4*(se*w+le)+3]/255;if(ue===0)continue;const fe=(se+J)*P+le+J;if(ue===1)Q[fe]=0,K[fe]=ot;else{const he=.5-ue;Q[fe]=he>0?he*he:0,K[fe]=he<0?he*he:0}}Me(Q,0,0,P,A,P,this.f,this.v,this.z),Me(K,J,J,w,T,P,this.f,this.v,this.z);for(let se=0;se<D;se++){const le=Math.sqrt(Q[se])-Math.sqrt(K[se]);L[se]=Math.round(255-255*(le/this.radius+this.cutoff))}return U}};class At{constructor(){this.specification=a.v.light.position}possiblyEvaluate(e,o){return a.z(e.expression.evaluate(o))}interpolate(e,o,c){return{x:a.B.number(e.x,o.x,c),y:a.B.number(e.y,o.y,c),z:a.B.number(e.z,o.z,c)}}}let ft;class bt extends a.E{constructor(e){super(),ft=ft||new a.r({anchor:new a.D(a.v.light.anchor),position:new At,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(ft),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,o={}){if(!this._validate(a.t,e,o))for(const c in e){const h=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),h):this._transitionable.setValue(c,h)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,o,c){return(!c||c.validate!==!1)&&a.x(this,e.call(a.y,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}const Pt=new a.r({"sky-color":new a.D(a.v.sky["sky-color"]),"horizon-color":new a.D(a.v.sky["horizon-color"]),"fog-color":new a.D(a.v.sky["fog-color"]),"fog-ground-blend":new a.D(a.v.sky["fog-ground-blend"]),"horizon-fog-blend":new a.D(a.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new a.D(a.v.sky["sky-horizon-blend"]),"atmosphere-blend":new a.D(a.v.sky["atmosphere-blend"])});class Ut extends a.E{constructor(e){super(),this._transitionable=new a.T(Pt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.C(0))}setSky(e,o={}){if(!this._validate(a.F,e,o)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in e){const h=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),h):this._transitionable.setValue(c,h)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,o,c={}){return(c==null?void 0:c.validate)!==!1&&a.x(this,e.call(a.y,a.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class dr{constructor(e,o){this.width=e,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,o){const c=e.join(",")+String(o);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(e,o)),this.dashEntry[c]}getDashRanges(e,o,c){const h=[];let m=e.length%2==1?-e[e.length-1]*c:0,v=e[0]*c,w=!0;h.push({left:m,right:v,isDash:w,zeroLength:e[0]===0});let T=e[0];for(let P=1;P<e.length;P++){w=!w;const A=e[P];m=T*c,T+=A,v=T*c,h.push({left:m,right:v,isDash:w,zeroLength:A===0})}return h}addRoundDash(e,o,c){const h=o/2;for(let m=-c;m<=c;m++){const v=this.width*(this.nextRow+c+m);let w=0,T=e[w];for(let P=0;P<this.width;P++){P/T.right>1&&(T=e[++w]);const A=Math.abs(P-T.left),D=Math.abs(P-T.right),L=Math.min(A,D);let U;const G=m/c*(h+1);if(T.isDash){const J=h-Math.abs(G);U=Math.sqrt(L*L+J*J)}else U=h-Math.sqrt(L*L+G*G);this.data[v+P]=Math.max(0,Math.min(255,U+128))}}}addRegularDash(e){for(let w=e.length-1;w>=0;--w){const T=e[w],P=e[w+1];T.zeroLength?e.splice(w,1):P&&P.isDash===T.isDash&&(P.left=T.left,e.splice(w,1))}const o=e[0],c=e[e.length-1];o.isDash===c.isDash&&(o.left=c.left-this.width,c.right=o.right+this.width);const h=this.width*this.nextRow;let m=0,v=e[m];for(let w=0;w<this.width;w++){w/v.right>1&&(v=e[++m]);const T=Math.abs(w-v.left),P=Math.abs(w-v.right),A=Math.min(T,P);this.data[h+w]=Math.max(0,Math.min(255,(v.isDash?A:-A)+128))}}addDash(e,o){const c=o?7:0,h=2*c+1;if(this.nextRow+h>this.height)return a.w("LineAtlas out of space"),null;let m=0;for(let w=0;w<e.length;w++)m+=e[w];if(m!==0){const w=this.width/m,T=this.getDashRanges(e,this.width,w);o?this.addRoundDash(T,w,c):this.addRegularDash(T)}const v={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:m};return this.nextRow+=h,this.dirty=!0,v}bind(e){const o=e.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const ir="maplibre_preloaded_worker_pool";class Ht{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Ht.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ir]}numActive(){return Object.keys(this.active).length}}const Mr=Math.floor(q.hardwareConcurrency/2);let zr,Cr;function Kr(){return zr||(zr=new Ht),zr}Ht.workerCount=a.G(globalThis)?Math.max(Math.min(Mr,3),1):1;class Tn{constructor(e,o){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=o;const c=this.workerPool.acquire(o);for(let h=0;h<c.length;h++){const m=new a.H(c[h],o);m.name=`Worker ${h}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,o){const c=[];for(const h of this.actors)c.push(h.sendAsync({type:e,data:o}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(o=>{o.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,o){for(const c of this.actors)c.registerMessageHandler(e,o)}}function Gn(){return Cr||(Cr=new Tn(Kr(),a.J),Cr.registerMessageHandler("GR",(p,e,o)=>a.m(e,o))),Cr}function cn(p,e){const o=a.K();return a.L(o,o,[1,1,0]),a.M(o,o,[.5*p.width,.5*p.height,1]),p.calculatePosMatrix?a.N(o,o,p.calculatePosMatrix(e.toUnwrapped())):o}function qn(p,e,o,c,h,m){var v;const w=function(D,L,U){if(D)for(const G of D){const J=L[G];if(J&&J.source===U&&J.type==="fill-extrusion")return!0}else for(const G in L){const J=L[G];if(J.source===U&&J.type==="fill-extrusion")return!0}return!1}((v=h==null?void 0:h.layers)!==null&&v!==void 0?v:null,e,p.id),T=m.maxPitchScaleFactor(),P=p.tilesIn(c,T,w);P.sort(Jr);const A=[];for(const D of P)A.push({wrappedTileID:D.tileID.wrapped().key,queryResults:D.tile.queryRenderedFeatures(e,o,p._state,D.queryGeometry,D.cameraQueryGeometry,D.scale,h,m,T,cn(p.transform,D.tileID))});return function(D,L){for(const U in D)for(const G of D[U])ae(G,L);return D}(function(D){const L={},U={};for(const G of D){const J=G.queryResults,K=G.wrappedTileID,Q=U[K]=U[K]||{};for(const re in J){const se=J[re],le=Q[re]=Q[re]||{},ue=L[re]=L[re]||[];for(const fe of se)le[fe.featureIndex]||(le[fe.featureIndex]=!0,ue.push(fe))}}return L}(A),p)}function Jr(p,e){const o=p.tileID,c=e.tileID;return o.overscaledZ-c.overscaledZ||o.canonical.y-c.canonical.y||o.wrap-c.wrap||o.canonical.x-c.canonical.x}function ae(p,e){const o=p.feature,c=e.getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=c}function pe(p,e,o){return a._(this,void 0,void 0,function*(){let c=p;if(p.url?c=(yield a.j(e.transformRequest(p.url,"Source"),o)).data:yield q.frameAsync(o),!c)return null;const h=a.O(a.e(c,p),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(h.vectorLayerIds=c.vector_layers.map(m=>m.id)),h})}class Ie{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof a.Q?new a.Q(e.lng,e.lat):a.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof a.Q?new a.Q(e.lng,e.lat):a.Q.convert(e),this}extend(e){const o=this._sw,c=this._ne;let h,m;if(e instanceof a.Q)h=e,m=e;else{if(!(e instanceof Ie))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ie.convert(e)):this.extend(a.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(a.Q.convert(e)):this;if(h=e._sw,m=e._ne,!h||!m)return this}return o||c?(o.lng=Math.min(h.lng,o.lng),o.lat=Math.min(h.lat,o.lat),c.lng=Math.max(m.lng,c.lng),c.lat=Math.max(m.lat,c.lat)):(this._sw=new a.Q(h.lng,h.lat),this._ne=new a.Q(m.lng,m.lat)),this}getCenter(){return new a.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.Q(this.getWest(),this.getNorth())}getSouthEast(){return new a.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:c}=a.Q.convert(e);let h=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&h}static convert(e){return e instanceof Ie?e:e&&new Ie(e)}static fromLngLat(e,o=0){const c=360*o/40075017,h=c/Math.cos(Math.PI/180*e.lat);return new Ie(new a.Q(e.lng-h,e.lat-c),new a.Q(e.lng+h,e.lat+c))}adjustAntiMeridian(){const e=new a.Q(this._sw.lng,this._sw.lat),o=new a.Q(this._ne.lng,this._ne.lat);return new Ie(e,e.lng>o.lng?new a.Q(o.lng+360,o.lat):o)}}class Ke{constructor(e,o,c){this.bounds=Ie.convert(this.validateBounds(e)),this.minzoom=o||0,this.maxzoom=c||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const o=Math.pow(2,e.z),c=Math.floor(a.U(this.bounds.getWest())*o),h=Math.floor(a.S(this.bounds.getNorth())*o),m=Math.ceil(a.U(this.bounds.getEast())*o),v=Math.ceil(a.S(this.bounds.getSouth())*o);return e.x>=c&&e.x<m&&e.y>=h&&e.y<v}}class We extends a.E{constructor(e,o,c,h){if(super(),this.id=e,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.O(o,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield pe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(a.e(this,e),e.bounds&&(this.tileBounds=new Ke(e.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new a.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(e){return a._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(o,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};c.request.collectResourceTiming=this._collectResourceTiming;let h="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((m,v)=>{e.reloadPromise={resolve:m,reject:v}})}else e.actor=this.dispatcher.getActor(),h="LT";e.abortController=new AbortController;try{const m=yield e.actor.sendAsync({type:h,data:c},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,m)}catch(m){if(delete e.abortController,e.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,o){if(o&&o.resourceTiming&&(e.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&e.setExpiryData(o),e.loadVectorData(o,this.map.painter),e.reloadPromise){const c=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(c.resolve).catch(c.reject)}}abortTile(e){return a._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return a._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class He extends a.E{constructor(e,o,c,h){super(),this.id=e,this.dispatcher=c,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},o),a.e(this,a.O(o,["url","scheme","tileSize"]))}load(){return a._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield pe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,o&&(a.e(this,o),o.bounds&&(this.tileBounds=new Ke(o.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(o){this._tileJSONRequest=null,this.fire(new a.k(o))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return a.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return a._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const c=yield be.getImage(this.map._requestManager.transformRequest(o,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&c.cacheControl&&c.expires&&e.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const h=this.map.painter.context,m=h.gl,v=c.data;e.texture=this.map.painter.getTileTexture(v.width),e.texture?e.texture.update(v,{useMipmap:!0}):(e.texture=new st(h,v,m.RGBA,{useMipmap:!0}),e.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(c){if(delete e.abortController,e.aborted)e.state="unloaded";else if(c)throw e.state="errored",c}})}abortTile(e){return a._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return a._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class lt extends He{constructor(e,o,c,h){super(e,o,c,h),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(e){return a._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(o,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const h=yield be.getImage(c,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(h&&h.data){const m=h.data;this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&e.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const v=a.b(m)&&a.V()?m:yield this.readImageNow(m),w={type:this.type,uid:e.uid,source:this.id,rawImageData:v,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const T=yield e.actor.sendAsync({type:"LDT",data:w});e.dem=T,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(h){if(delete e.abortController,e.aborted)e.state="unloaded";else if(h)throw e.state="errored",h}})}readImageNow(e){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.W()){const o=e.width+2,c=e.height+2;try{return new a.R({width:o,height:c},yield a.X(e,-1,-1,o,c))}catch{}}return q.getImageData(e,1)})}_getNeighboringTiles(e){const o=e.canonical,c=Math.pow(2,o.z),h=(o.x-1+c)%c,m=o.x===0?e.wrap-1:e.wrap,v=(o.x+1+c)%c,w=o.x+1===c?e.wrap+1:e.wrap,T={};return T[new a.Y(e.overscaledZ,m,o.z,h,o.y).key]={backfilled:!1},T[new a.Y(e.overscaledZ,w,o.z,v,o.y).key]={backfilled:!1},o.y>0&&(T[new a.Y(e.overscaledZ,m,o.z,h,o.y-1).key]={backfilled:!1},T[new a.Y(e.overscaledZ,e.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},T[new a.Y(e.overscaledZ,w,o.z,v,o.y-1).key]={backfilled:!1}),o.y+1<c&&(T[new a.Y(e.overscaledZ,m,o.z,h,o.y+1).key]={backfilled:!1},T[new a.Y(e.overscaledZ,e.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},T[new a.Y(e.overscaledZ,w,o.z,v,o.y+1).key]={backfilled:!1}),T}unloadTile(e){return a._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class at extends a.E{constructor(e,o,c,h){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(h),this._data=o.data,this._options=a.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId,o.clusterMaxZoom!==void 0&&this.maxzoom<=o.clusterMaxZoom&&a.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${o.clusterMaxZoom}".`),this.workerOptions=a.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(o.buffer!==void 0?o.buffer:128),tolerance:this._pixelsToTileUnits(o.tolerance!==void 0?o.tolerance:.375),extent:a.Z,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:a.Z,radius:this._pixelsToTileUnits(o.clusterRadius||50),log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(a.Z/this.tileSize)}load(){return a._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return a._(this,void 0,void 0,function*(){const e=a.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,o,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:o,offset:c}})}_updateWorkerData(e){return a._(this,void 0,void 0,function*(){const o=a.e({type:this.type},this.workerOptions);e?o.dataDiff=e:typeof this._data=="string"?(o.request=this.map._requestManager.transformRequest(q.resolveURL(this._data),"Source"),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.l("dataloading",{dataType:"source"}));try{const c=yield this.actor.sendAsync({type:"LD",data:o});if(this._pendingLoads--,this._removed||c.abandoned)return void this.fire(new a.l("dataabort",{dataType:"source"}));let h=null;c.resourceTiming&&c.resourceTiming[this.id]&&(h=c.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&h&&h.length>0&&a.e(m,{resourceTiming:h}),this.fire(new a.l("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new a.l("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(c){if(this._pendingLoads--,this._removed)return void this.fire(new a.l("dataabort",{dataType:"source"}));this.fire(new a.k(c))}})}loaded(){return this._pendingLoads===0}loadTile(e){return a._(this,void 0,void 0,function*(){const o=e.actor?"RT":"LT";e.actor=this.actor;const c={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const h=yield this.actor.sendAsync({type:o,data:c},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(h,this.map.painter,o==="RT")})}abortTile(e){return a._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return a._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class nt extends a.E{constructor(e,o,c,h){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=c,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=o}load(e){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield be.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,e&&(this.coordinates=e),this._finishLoading())}catch(o){this._request=null,this._loaded=!0,this.fire(new a.k(o))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const o=e.map(a.$.fromLngLat);var c;return this.tileID=function(h){let m=1/0,v=1/0,w=-1/0,T=-1/0;for(const L of h)m=Math.min(m,L.x),v=Math.min(v,L.y),w=Math.max(w,L.x),T=Math.max(T,L.y);const P=Math.max(w-m,T-v),A=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),D=Math.pow(2,A);return new a.a0(A,Math.floor((m+w)/2*D),Math.floor((v+T)/2*D))}(o),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=o.map(h=>this.tileID.getTilePoint(h)._round()),this.flippedWindingOrder=((c=this.tileCoords)[1].x-c[0].x)*(c[2].y-c[0].y)-(c[1].y-c[0].y)*(c[2].x-c[0].x)<0,this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,o=e.gl;this.texture||(this.texture=new st(e,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let c=!1;for(const h in this.tiles){const m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,c=!0)}c&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return a._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Xe extends nt{constructor(e,o,c,h){super(e,o,c,h),this.roundZoom=!0,this.type="video",this.options=o}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const o of e.urls)this.urls.push(this.map._requestManager.transformRequest(o,"Source").url);try{const o=yield a.a1(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new a.k(o))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const o=this.video.seekable;e<o.start(0)||e>o.end(0)?this.fire(new a.k(new a.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,o=e.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new st(e,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let c=!1;for(const h in this.tiles){const m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,c=!0)}c&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class It extends nt{constructor(e,o,c,h){super(e,o,c,h),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(v=>typeof v!="number"))||this.fire(new a.k(new a.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.k(new a.a2(`sources.${e}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new a.k(new a.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new a.k(new a.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.k(new a.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return a._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,c=o.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new st(o,this.canvas,c.RGBA,{premultiply:!0});let h=!1;for(const m in this.tiles){const v=this.tiles[m];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,h=!0)}h&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const ht={},St=p=>{switch(p){case"geojson":return at;case"image":return nt;case"raster":return He;case"raster-dem":return lt;case"vector":return We;case"video":return Xe;case"canvas":return It}return ht[p]},Dt="RTLPluginLoaded";class Ft extends a.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Gn()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(o=>{throw this.status="error",o})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return a._(this,arguments,void 0,function*(o,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=q.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return a._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new a.l(Dt))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Yt=null;function Zt(){return Yt||(Yt=new Ft),Yt}class jr{constructor(e,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=a.a3(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const o=e+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,o,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,m){const v={};if(!m)return v;for(const w of h){const T=w.layerIds.map(P=>m.getLayer(P)).filter(Boolean);if(T.length!==0){w.layers=T,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(P=>T.filter(A=>A.id===P)[0]));for(const P of T)v[P.id]=w}}return v}(e.buckets,o==null?void 0:o.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const m=this.buckets[h];if(m instanceof a.a5){if(this.hasSymbolBuckets=!0,!c)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const m=this.buckets[h];if(m instanceof a.a5&&m.hasRTLText){this.hasRTLText=!0,Zt().lazyLoad();break}}this.queryPadding=0;for(const h in this.buckets){const m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(h).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a.a4}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const c in this.buckets){const h=this.buckets[c];h.uploadPending()&&h.upload(e)}const o=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new st(e,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new st(e,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,o,c,h,m,v,w,T,P,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:m,scale:v,tileSize:this.tileSize,pixelPosMatrix:A,transform:T,params:w,queryPadding:this.queryPadding*P},e,o,c):{}}querySourceFeatures(e,o){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const h=c.loadVTLayers(),m=o&&o.sourceLayer?o.sourceLayer:"",v=h._geojsonTileLayer||h[m];if(!v)return;const w=a.a6(o&&o.filter),{z:T,x:P,y:A}=this.tileID.canonical,D={z:T,x:P,y:A};for(let L=0;L<v.length;L++){const U=v.feature(L);if(w.needGeometry){const K=a.a7(U,!0);if(!w.filter(new a.C(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!w.filter(new a.C(this.tileID.overscaledZ),U))continue;const G=c.getId(U,m),J=new a.a8(U,T,P,A,G);J.tile=D,e.push(J)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const o=this.expirationTime;if(e.cacheControl){const c=a.a9(e.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const c=Date.now();let h=!1;if(this.expirationTime>c)h=!1;else if(o)if(this.expirationTime<o)h=!0;else{const m=this.expirationTime-o;m?this.expirationTime=c+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!o.style.hasLayer(h))continue;const m=this.buckets[h],v=m.layers[0].sourceLayer||"_geojsonTileLayer",w=c[v],T=e[v];if(!w||!T||Object.keys(T).length===0)continue;m.update(T,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const P=o&&o.style&&o.style.getLayer(h);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=q.now()+e}setDependencies(e,o){const c={};for(const h of o)c[h]=!0;this.dependencies[e]=c}hasDependency(e,o){for(const c of e){const h=this.dependencies[c];if(h){for(const m of o)if(h[m])return!0}}return!1}}class Rr{constructor(e,o){this.max=e,this.onRemove=o,this.reset()}reset(){for(const e in this.data)for(const o of this.data[e])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(e,o,c){const h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const m={value:o,timeout:void 0};if(c!==void 0&&(m.timeout=setTimeout(()=>{this.remove(e,m)},c)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const o=this.data[e].shift();return o.timeout&&clearTimeout(o.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),o.value}getByKey(e){const o=this.data[e];return o?o[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,o){if(!this.has(e))return this;const c=e.wrapped().key,h=o===void 0?0:this.data[c].indexOf(o),m=this.data[c][h];return this.data[c].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(m.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(e){const o=[];for(const c in this.data)for(const h of this.data[c])e(h.value)||o.push(h);for(const c of o)this.remove(c.value.tileID,c)}}class kn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,o,c){const h=String(o);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},a.e(this.stateChanges[e][h],c),this.deletedStates[e]===null){this.deletedStates[e]={};for(const m in this.state[e])m!==h&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(const m in this.state[e][h])c[m]||(this.deletedStates[e][h][m]=null)}else for(const m in c)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][m]===null&&delete this.deletedStates[e][h][m]}removeFeatureState(e,o,c){if(this.deletedStates[e]===null)return;const h=String(o);if(this.deletedStates[e]=this.deletedStates[e]||{},c&&o!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][c]=null);else if(o!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(c in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][c]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,o){const c=String(o),h=a.e({},(this.state[e]||{})[c],(this.stateChanges[e]||{})[c]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const m=this.deletedStates[e][o];if(m===null)return{};for(const v in m)delete h[v]}return h}initializeTileState(e,o){e.setFeatureState(this.state,o)}coalesceChanges(e,o){const c={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const m={};for(const v in this.stateChanges[h])this.state[h][v]||(this.state[h][v]={}),a.e(this.state[h][v],this.stateChanges[h][v]),m[v]=this.state[h][v];c[h]=m}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const m={};if(this.deletedStates[h]===null)for(const v in this.state[h])m[v]={},this.state[h][v]={};else for(const v in this.deletedStates[h]){if(this.deletedStates[h][v]===null)this.state[h][v]={};else for(const w of Object.keys(this.deletedStates[h][v]))delete this.state[h][v][w];m[v]=this.state[h][v]}c[h]=c[h]||{},a.e(c[h],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const h in e)e[h].setFeatureState(c,o)}}function yn(p,e,o){const c=e.intersectsFrustum(p);if(!o)return c;const h=e.intersectsPlane(o);return c===0||h===0?0:c===2&&h===2?2:1}function xo(p,e,o,c,h){let m=p;const v=Math.atan(e/o),w=Math.hypot(e,o);return m=p+a.aa(c/w/Math.max(.5,Math.cos(a.ac(h/2)))),m+=1*a.aa(Math.cos(v))/2,m+=a.ad(p-m,-0,0),m}function io(p,e){const o=(e.roundZoom?Math.round:Math.floor)(p.zoom+a.aa(p.tileSize/e.tileSize));return Math.max(0,o)}function ge(p,e){const o=p.getCameraFrustum(),c=p.getClippingPlane(),h=p.screenPointToMercatorCoordinate(p.getCameraPoint()),m=a.$.fromLngLat(p.center,p.elevation);h.z=m.z+Math.cos(p.pitchInRadians)*p.cameraToCenterDistance/p.worldSize;const v=p.getCoveringTilesDetailsProvider(),w=v.allowVariableZoom(p,e),T=io(p,e),P=e.minzoom||0,A=e.maxzoom!==void 0?e.maxzoom:p.maxZoom,D=Math.min(Math.max(0,T),A),L=Math.pow(2,D),U=[L*h.x,L*h.y,0],G=[L*m.x,L*m.y,0],J=Math.hypot(m.x-h.x,m.y-h.y),K=Math.abs(m.z-h.z),Q=Math.hypot(J,K),re=ue=>({zoom:0,x:0,y:0,wrap:ue,fullyVisible:!1}),se=[],le=[];if(p.renderWorldCopies&&v.allowWorldCopies())for(let ue=1;ue<=3;ue++)se.push(re(-ue)),se.push(re(ue));for(se.push(re(0));se.length>0;){const ue=se.pop(),fe=ue.x,he=ue.y;let we=ue.fullyVisible;const Se={x:fe,y:he,z:ue.zoom},Re=v.getTileAABB(Se,ue.wrap,p.elevation,e);if(!we){const et=yn(o,Re,c);if(et===0)continue;we=et===2}const Le=v.distanceToTile2d(h.x,h.y,Se,Re);let ze=T;w&&(ze=(e.calculateTileZoom||xo)(p.zoom+a.aa(p.tileSize/e.tileSize),Le,K,Q,p.fov)),ze=(e.roundZoom?Math.round:Math.floor)(ze),ze=Math.max(0,ze);const rt=Math.min(ze,A);if(ue.wrap=v.getWrap(m,Se,ue.wrap),ue.zoom>=rt){if(ue.zoom<P)continue;const et=D-ue.zoom,Ue=U[0]-.5-(fe<<et),yt=U[1]-.5-(he<<et),Ct=e.reparseOverscaled?Math.max(ue.zoom,ze):ue.zoom;le.push({tileID:new a.Y(ue.zoom===A?Ct:ue.zoom,ue.wrap,ue.zoom,fe,he),distanceSq:a.ab([G[0]-.5-fe,G[1]-.5-he]),tileDistanceToCamera:Math.sqrt(Ue*Ue+yt*yt)})}else for(let et=0;et<4;et++)se.push({zoom:ue.zoom+1,x:(fe<<1)+et%2,y:(he<<1)+(et>>1),wrap:ue.wrap,fullyVisible:we})}return le.sort((ue,fe)=>ue.distanceSq-fe.distanceSq).map(ue=>ue.tileID)}class z extends a.E{constructor(e,o,c){super(),this.id=e,this.dispatcher=c,this.on("data",h=>this._dataHandler(h)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((h,m,v,w)=>{const T=new(St(m.type))(h,m,v,w);if(T.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${T.id}`);return T})(e,o,c,this),this._tiles={},this._cache=new Rr(0,h=>this._unloadTile(h)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new kn,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const o=this._tiles[e];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,o,c){return a._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,o,c)}catch(h){e.state="errored",h.status!==404?this._source.fire(new a.k(h,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new a.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const c=this._tiles[o];c.upload(e),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(W).map(e=>e.key)}getRenderableIds(e){const o=[];for(const c in this._tiles)this._isIdRenderable(c,e)&&o.push(this._tiles[c]);return e?o.sort((c,h)=>{const m=c.tileID,v=h.tileID,w=new a.P(m.canonical.x,m.canonical.y)._rotate(-this.transform.bearingInRadians),T=new a.P(v.canonical.x,v.canonical.y)._rotate(-this.transform.bearingInRadians);return m.overscaledZ-v.overscaledZ||T.y-w.y||T.x-w.x}).map(c=>c.tileID.key):o.map(c=>c.tileID).sort(W).map(c=>c.key)}hasRenderableParent(e){const o=this.findLoadedParent(e,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(e,o){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(o||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)(e||this._tiles[o].state!=="errored")&&this._reloadTile(o,"reloading")}}_reloadTile(e,o){return a._(this,void 0,void 0,function*(){const c=this._tiles[e];c&&(c.state!=="loading"&&(c.state=o),yield this._loadTile(c,e,o))})}_tileLoaded(e,o,c){e.timeAdded=q.now(),c==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(o,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new a.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const o=this.getRenderableIds();for(let h=0;h<o.length;h++){const m=o[h];if(e.neighboringTiles&&e.neighboringTiles[m]){const v=this.getTileByID(m);c(e,v),c(v,e)}}function c(h,m){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let v=m.tileID.canonical.x-h.tileID.canonical.x;const w=m.tileID.canonical.y-h.tileID.canonical.y,T=Math.pow(2,h.tileID.canonical.z),P=m.tileID.key;v===0&&w===0||Math.abs(w)>1||(Math.abs(v)>1&&(Math.abs(v+T)===1?v+=T:Math.abs(v-T)===1&&(v-=T)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,v,w),h.neighboringTiles&&h.neighboringTiles[P]&&(h.neighboringTiles[P].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,o,c,h){for(const m in this._tiles){let v=this._tiles[m];if(h[m]||!v.hasData()||v.tileID.overscaledZ<=o||v.tileID.overscaledZ>c)continue;let w=v.tileID;for(;v&&v.tileID.overscaledZ>o+1;){const P=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[P.key],v&&v.hasData()&&(w=P)}let T=w;for(;T.overscaledZ>o;)if(T=T.scaledTo(T.overscaledZ-1),e[T.key]||e[T.canonical.key]){h[w.key]=w;break}}}findLoadedParent(e,o){if(e.key in this._loadedParentTiles){const c=this._loadedParentTiles[e.key];return c&&c.tileID.overscaledZ>=o?c:null}for(let c=e.overscaledZ-1;c>=o;c--){const h=e.scaledTo(c),m=this._getLoadedTile(h);if(m)return m}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const o=this._tiles[e.key];return o&&o.hasData()?o:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const o=Math.ceil(e.width/this._source.tileSize)+1,c=Math.ceil(e.height/this._source.tileSize)+1,h=Math.floor(o*c*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(m)}handleWrapJump(e){const o=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,o){const c={};for(const h in this._tiles){const m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+o),c[m.tileID.key]=m}this._tiles=c;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}_updateCoveredAndRetainedTiles(e,o,c,h,m,v){const w={},T={},P=Object.keys(e),A=q.now();for(const D of P){const L=e[D],U=this._tiles[D];if(!U||U.fadeEndTime!==0&&U.fadeEndTime<=A)continue;const G=this.findLoadedParent(L,o),J=this.findLoadedSibling(L),K=G||J||null;K&&(this._addTile(K.tileID),w[K.tileID.key]=K.tileID),T[D]=L}this._retainLoadedChildren(T,h,c,e);for(const D in w)e[D]||(this._coveredTiles[D]=!0,e[D]=w[D]);if(v){const D={},L={};for(const U of m)this._tiles[U.key].hasData()?D[U.key]=U:L[U.key]=U;for(const U in L){const G=L[U].children(this._source.maxzoom);this._tiles[G[0].key]&&this._tiles[G[1].key]&&this._tiles[G[2].key]&&this._tiles[G[3].key]&&(D[G[0].key]=e[G[0].key]=G[0],D[G[1].key]=e[G[1].key]=G[1],D[G[2].key]=e[G[2].key]=G[2],D[G[3].key]=e[G[3].key]=G[3],delete L[U])}for(const U in L){const G=L[U],J=this.findLoadedParent(G,this._source.minzoom),K=this.findLoadedSibling(G),Q=J||K||null;if(Q){D[Q.tileID.key]=e[Q.tileID.key]=Q.tileID;for(const re in D)D[re].isChildOf(Q.tileID)&&delete D[re]}}for(const U in this._tiles)D[U]||(this._coveredTiles[U]=!0)}}update(e,o){if(!this._sourceLoaded||this._paused)return;let c;this.transform=e,this.terrain=o,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(A=>new a.Y(A.canonical.z,A.wrap,A.canonical.z,A.canonical.x,A.canonical.y)):(c=ge(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(c=c.filter(A=>this._source.hasTile(A)))):c=[];const h=io(e,this._source),m=Math.max(h-z.maxOverzooming,this._source.minzoom),v=Math.max(h+z.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const A={};for(const D of c)if(D.canonical.z>this._source.minzoom){const L=D.scaledTo(D.canonical.z-1);A[L.key]=L;const U=D.scaledTo(Math.max(this._source.minzoom,Math.min(D.canonical.z,5)));A[U.key]=U}c=c.concat(Object.values(A))}const w=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new a.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(c,h);Y(this._source.type)&&this._updateCoveredAndRetainedTiles(T,m,v,h,c,o);for(const A in T)this._tiles[A].clearFadeHold();const P=a.ae(this._tiles,T);for(const A of P){const D=this._tiles[A];D.hasSymbolBuckets&&!D.holdingForFade()?D.setHoldDuration(this.map._fadeDuration):D.hasSymbolBuckets&&!D.symbolFadeFinished()||this._removeTile(A)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,o){var c;const h={},m={},v=Math.max(o-z.maxOverzooming,this._source.minzoom),w=Math.max(o+z.maxUnderzooming,this._source.minzoom),T={};for(const P of e){const A=this._addTile(P);h[P.key]=P,A.hasData()||o<this._source.maxzoom&&(T[P.key]=P)}this._retainLoadedChildren(T,o,w,h);for(const P of e){let A=this._tiles[P.key];if(A.hasData())continue;if(o+1>this._source.maxzoom){const L=P.children(this._source.maxzoom)[0],U=this.getTile(L);if(U&&U.hasData()){h[L.key]=L;continue}}else{const L=P.children(this._source.maxzoom);if(h[L[0].key]&&h[L[1].key]&&h[L[2].key]&&h[L[3].key])continue}let D=A.wasRequested();for(let L=P.overscaledZ-1;L>=v;--L){const U=P.scaledTo(L);if(m[U.key])break;if(m[U.key]=!0,A=this.getTile(U),!A&&D&&(A=this._addTile(U)),A){const G=A.hasData();if((G||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||D)&&(h[U.key]=U),D=A.wasRequested(),G)break}}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const o=[];let c,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){c=this._loadedParentTiles[h.key];break}o.push(h.key);const m=h.scaledTo(h.overscaledZ-1);if(c=this._getLoadedTile(m),c)break;h=m}for(const m of o)this._loadedParentTiles[m]=c}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const o=this._tiles[e].tileID,c=this._getLoadedTile(o);this._loadedSiblingTiles[o.key]=c}}_addTile(e){let o=this._tiles[e.key];if(o)return o;o=this._cache.getAndRemove(e),o&&(this._setTileReloadTimer(e.key,o),o.tileID=e,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,o)));const c=o;return o||(o=new jr(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(o,e.key,o.state)),o.uses++,this._tiles[e.key]=o,c||this._source.fire(new a.l("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(e,o){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const c=o.getExpiryTimeout();c&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},c))}_removeTile(e){const o=this._tiles[e];o&&(o.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}_dataHandler(e){const o=e.sourceDataType;e.dataType==="source"&&o==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&o==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,o,c){const h=[],m=this.transform;if(!m)return h;const v=c?m.getCameraQueryGeometry(e):e,w=e.map(G=>m.screenPointToMercatorCoordinate(G,this.terrain)),T=v.map(G=>m.screenPointToMercatorCoordinate(G,this.terrain)),P=this.getIds();let A=1/0,D=1/0,L=-1/0,U=-1/0;for(const G of T)A=Math.min(A,G.x),D=Math.min(D,G.y),L=Math.max(L,G.x),U=Math.max(U,G.y);for(let G=0;G<P.length;G++){const J=this._tiles[P[G]];if(J.holdingForFade())continue;const K=J.tileID,Q=Math.pow(2,m.zoom-J.tileID.overscaledZ),re=o*J.queryPadding*a.Z/J.tileSize/Q,se=[K.getTilePoint(new a.$(A,D)),K.getTilePoint(new a.$(L,U))];if(se[0].x-re<a.Z&&se[0].y-re<a.Z&&se[1].x+re>=0&&se[1].y+re>=0){const le=w.map(fe=>K.getTilePoint(fe)),ue=T.map(fe=>K.getTilePoint(fe));h.push({tile:J,tileID:K,queryGeometry:le,cameraQueryGeometry:ue,scale:Q})}}return h}getVisibleCoordinates(e){const o=this.getRenderableIds(e).map(c=>this._tiles[c].tileID);return this.transform&&this.transform.populateCache(o),o}hasTransition(){if(this._source.hasTransition())return!0;if(Y(this._source.type)){const e=q.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=e)return!0}return!1}setFeatureState(e,o,c){this._state.updateState(e=e||"_geojsonTileLayer",o,c)}removeFeatureState(e,o,c){this._state.removeFeatureState(e=e||"_geojsonTileLayer",o,c)}getFeatureState(e,o){return this._state.getState(e=e||"_geojsonTileLayer",o)}setDependencies(e,o,c){const h=this._tiles[e];h&&h.setDependencies(o,c)}reloadTilesForDependencies(e,o){for(const c in this._tiles)this._tiles[c].hasDependency(e,o)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(e,o))}}function W(p,e){const o=Math.abs(2*p.wrap)-+(p.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return p.overscaledZ-e.overscaledZ||c-o||e.canonical.y-p.canonical.y||e.canonical.x-p.canonical.x}function Y(p){return p==="raster"||p==="image"||p==="video"}z.maxOverzooming=10,z.maxUnderzooming=3;class te{constructor(e,o){this.reset(e,o)}reset(e,o){this.points=e||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=a.ad(e,0,1);let o=1,c=this._distances[o];const h=e*this.paddedLength+this.padding;for(;c<h&&o<this._distances.length;)c=this._distances[++o];const m=o-1,v=this._distances[m],w=c-v,T=w>0?(h-v)/w:0;return this.points[m].mult(1-T).add(this.points[o].mult(T))}}function ce(p,e){let o=!0;return p==="always"||p!=="never"&&e!=="never"||(o=!1),o}class _e{constructor(e,o,c){const h=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(e/c),this.yCellCount=Math.ceil(o/c);for(let v=0;v<this.xCellCount*this.yCellCount;v++)h.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=o,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,o,c,h,m){this._forEachCell(o,c,h,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(h),this.bboxes.push(m)}insertCircle(e,o,c,h){this._forEachCell(o-h,c-h,o+h,c+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(o),this.circles.push(c),this.circles.push(h)}_insertBoxCell(e,o,c,h,m,v){this.boxCells[m].push(v)}_insertCircleCell(e,o,c,h,m,v){this.circleCells[m].push(v)}_query(e,o,c,h,m,v,w){if(c<0||e>this.width||h<0||o>this.height)return[];const T=[];if(e<=0&&o<=0&&this.width<=c&&this.height<=h){if(m)return[{key:null,x1:e,y1:o,x2:c,y2:h}];for(let P=0;P<this.boxKeys.length;P++)T.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const A=this.circles[3*P],D=this.circles[3*P+1],L=this.circles[3*P+2];T.push({key:this.circleKeys[P],x1:A-L,y1:D-L,x2:A+L,y2:D+L})}}else this._forEachCell(e,o,c,h,this._queryCell,T,{hitTest:m,overlapMode:v,seenUids:{box:{},circle:{}}},w);return T}query(e,o,c,h){return this._query(e,o,c,h,!1,null)}hitTest(e,o,c,h,m,v){return this._query(e,o,c,h,!0,m,v).length>0}hitTestCircle(e,o,c,h,m){const v=e-c,w=e+c,T=o-c,P=o+c;if(w<0||v>this.width||P<0||T>this.height)return!1;const A=[];return this._forEachCell(v,T,w,P,this._queryCellCircle,A,{hitTest:!0,overlapMode:h,circle:{x:e,y:o,radius:c},seenUids:{box:{},circle:{}}},m),A.length>0}_queryCell(e,o,c,h,m,v,w,T){const{seenUids:P,hitTest:A,overlapMode:D}=w,L=this.boxCells[m];if(L!==null){const G=this.bboxes;for(const J of L)if(!P.box[J]){P.box[J]=!0;const K=4*J,Q=this.boxKeys[J];if(e<=G[K+2]&&o<=G[K+3]&&c>=G[K+0]&&h>=G[K+1]&&(!T||T(Q))&&(!A||!ce(D,Q.overlapMode))&&(v.push({key:Q,x1:G[K],y1:G[K+1],x2:G[K+2],y2:G[K+3]}),A))return!0}}const U=this.circleCells[m];if(U!==null){const G=this.circles;for(const J of U)if(!P.circle[J]){P.circle[J]=!0;const K=3*J,Q=this.circleKeys[J];if(this._circleAndRectCollide(G[K],G[K+1],G[K+2],e,o,c,h)&&(!T||T(Q))&&(!A||!ce(D,Q.overlapMode))){const re=G[K],se=G[K+1],le=G[K+2];if(v.push({key:Q,x1:re-le,y1:se-le,x2:re+le,y2:se+le}),A)return!0}}}return!1}_queryCellCircle(e,o,c,h,m,v,w,T){const{circle:P,seenUids:A,overlapMode:D}=w,L=this.boxCells[m];if(L!==null){const G=this.bboxes;for(const J of L)if(!A.box[J]){A.box[J]=!0;const K=4*J,Q=this.boxKeys[J];if(this._circleAndRectCollide(P.x,P.y,P.radius,G[K+0],G[K+1],G[K+2],G[K+3])&&(!T||T(Q))&&!ce(D,Q.overlapMode))return v.push(!0),!0}}const U=this.circleCells[m];if(U!==null){const G=this.circles;for(const J of U)if(!A.circle[J]){A.circle[J]=!0;const K=3*J,Q=this.circleKeys[J];if(this._circlesCollide(G[K],G[K+1],G[K+2],P.x,P.y,P.radius)&&(!T||T(Q))&&!ce(D,Q.overlapMode))return v.push(!0),!0}}}_forEachCell(e,o,c,h,m,v,w,T){const P=this._convertToXCellCoord(e),A=this._convertToYCellCoord(o),D=this._convertToXCellCoord(c),L=this._convertToYCellCoord(h);for(let U=P;U<=D;U++)for(let G=A;G<=L;G++)if(m.call(this,e,o,c,h,this.xCellCount*G+U,v,w,T))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,o,c,h,m,v){const w=h-e,T=m-o,P=c+v;return P*P>w*w+T*T}_circleAndRectCollide(e,o,c,h,m,v,w){const T=(v-h)/2,P=Math.abs(e-(h+T));if(P>T+c)return!1;const A=(w-m)/2,D=Math.abs(o-(m+A));if(D>A+c)return!1;if(P<=T||D<=A)return!0;const L=P-T,U=D-A;return L*L+U*U<=c*c}}function Te(p,e,o){const c=a.K();if(!p){const{vecSouth:D,vecEast:L}=De(e),U=R();U[0]=L[0],U[1]=L[1],U[2]=D[0],U[3]=D[1],h=U,(A=(v=(m=U)[0])*(P=m[3])-(T=m[2])*(w=m[1]))&&(h[0]=P*(A=1/A),h[1]=-w*A,h[2]=-T*A,h[3]=v*A),c[0]=U[0],c[1]=U[1],c[4]=U[2],c[5]=U[3]}var h,m,v,w,T,P,A;return a.M(c,c,[1/o,1/o,1]),c}function me(p,e,o,c){if(p){const h=a.K();if(!e){const{vecSouth:m,vecEast:v}=De(o);h[0]=v[0],h[1]=v[1],h[4]=m[0],h[5]=m[1]}return a.M(h,h,[c,c,1]),h}return o.pixelsToClipSpaceMatrix}function De(p){const e=Math.cos(p.rollInRadians),o=Math.sin(p.rollInRadians),c=Math.cos(p.pitchInRadians),h=Math.cos(p.bearingInRadians),m=Math.sin(p.bearingInRadians),v=a.aj();v[0]=-h*c*o-m*e,v[1]=-m*c*o+h*e;const w=a.ak(v);w<1e-9?a.al(v):a.am(v,v,1/w);const T=a.aj();T[0]=h*c*e-m*o,T[1]=m*c*e+h*o;const P=a.ak(T);return P<1e-9?a.al(T):a.am(T,T,1/P),{vecEast:T,vecSouth:v}}function Ee(p,e,o,c){let h;c?(h=[p,e,c(p,e),1],a.ao(h,h,o)):(h=[p,e,0,1],Qr(h,h,o));const m=h[3];return{point:new a.P(h[0]/m,h[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function ye(p,e){return .5+p/e*.5}function je(p,e){return p.x>=-e[0]&&p.x<=e[0]&&p.y>=-e[1]&&p.y<=e[1]}function ve(p,e,o,c,h,m,v,w,T,P,A,D,L){const U=o?p.textSizeData:p.iconSizeData,G=a.af(U,e.transform.zoom),J=[256/e.width*2+1,256/e.height*2+1],K=o?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;K.clear();const Q=p.lineVertexArray,re=o?p.text.placedSymbolArray:p.icon.placedSymbolArray,se=e.transform.width/e.transform.height;let le=!1;for(let ue=0;ue<re.length;ue++){const fe=re.get(ue);if(fe.hidden||fe.writingMode===a.ag.vertical&&!le){Wr(fe.numGlyphs,K);continue}le=!1;const he=new a.P(fe.anchorX,fe.anchorY),we={getElevation:L,pitchedLabelPlaneMatrix:c,lineVertexArray:Q,pitchWithMap:m,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:he,unwrappedTileID:T,width:P,height:A,translation:D},Se=Ot(fe.anchorX,fe.anchorY,we);if(!je(Se.point,J)){Wr(fe.numGlyphs,K);continue}const Re=ye(e.transform.cameraToCenterDistance,Se.signedDistanceFromCamera),Le=a.ah(U,G,fe),ze=m?Le*e.transform.getPitchedTextCorrection(fe.anchorX,fe.anchorY,T)/Re:Le*Re,rt=Lt({projectionContext:we,pitchedLabelPlaneMatrixInverse:h,symbol:fe,fontSize:ze,flip:!1,keepUpright:v,glyphOffsetArray:p.glyphOffsetArray,dynamicLayoutVertexArray:K,aspectRatio:se,rotateToLine:w});le=rt.useVertical,(rt.notEnoughRoom||le||rt.needsFlipping&&Lt({projectionContext:we,pitchedLabelPlaneMatrixInverse:h,symbol:fe,fontSize:ze,flip:!0,keepUpright:v,glyphOffsetArray:p.glyphOffsetArray,dynamicLayoutVertexArray:K,aspectRatio:se,rotateToLine:w}).notEnoughRoom)&&Wr(fe.numGlyphs,K)}o?p.text.dynamicLayoutVertexBuffer.updateData(K):p.icon.dynamicLayoutVertexBuffer.updateData(K)}function it(p,e,o,c,h,m,v,w){const T=m.glyphStartIndex+m.numGlyphs,P=m.lineStartIndex,A=m.lineStartIndex+m.lineLength,D=e.getoffsetX(m.glyphStartIndex),L=e.getoffsetX(T-1),U=Tt(p*D,o,c,h,m.segment,P,A,w,v);if(!U)return null;const G=Tt(p*L,o,c,h,m.segment,P,A,w,v);return G?w.projectionCache.anyProjectionOccluded?null:{first:U,last:G}:null}function xt(p,e,o,c){return p===a.ag.horizontal&&Math.abs(o.y-e.y)>Math.abs(o.x-e.x)*c?{useVertical:!0}:(p===a.ag.vertical?e.y<o.y:e.x>o.x)?{needsFlipping:!0}:null}function Lt(p){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:o,symbol:c,fontSize:h,flip:m,keepUpright:v,glyphOffsetArray:w,dynamicLayoutVertexArray:T,aspectRatio:P,rotateToLine:A}=p,D=h/24,L=c.lineOffsetX*D,U=c.lineOffsetY*D;let G;if(c.numGlyphs>1){const J=c.glyphStartIndex+c.numGlyphs,K=c.lineStartIndex,Q=c.lineStartIndex+c.lineLength,re=it(D,w,L,U,m,c,A,e);if(!re)return{notEnoughRoom:!0};const se=mt(re.first.point.x,re.first.point.y,e,o),le=mt(re.last.point.x,re.last.point.y,e,o);if(v&&!m){const ue=xt(c.writingMode,se,le,P);if(ue)return ue}G=[re.first];for(let ue=c.glyphStartIndex+1;ue<J-1;ue++)G.push(Tt(D*w.getoffsetX(ue),L,U,m,c.segment,K,Q,e,A));G.push(re.last)}else{if(v&&!m){const K=_t(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,Q=c.lineStartIndex+c.segment+1,re=new a.P(e.lineVertexArray.getx(Q),e.lineVertexArray.gety(Q)),se=_t(re.x,re.y,e),le=se.signedDistanceFromCamera>0?se.point:zt(e.tileAnchorPoint,re,K,1,e),ue=mt(K.x,K.y,e,o),fe=mt(le.x,le.y,e,o),he=xt(c.writingMode,ue,fe,P);if(he)return he}const J=Tt(D*w.getoffsetX(c.glyphStartIndex),L,U,m,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,e,A);if(!J||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};G=[J]}for(const J of G)a.an(T,J.point,J.angle);return{}}function zt(p,e,o,c,h){const m=p.add(p.sub(e)._unit()),v=_t(m.x,m.y,h).point,w=o.sub(v);return o.add(w._mult(c/w.mag()))}function $e(p,e,o){const c=e.projectionCache;if(c.projections[p])return c.projections[p];const h=new a.P(e.lineVertexArray.getx(p),e.lineVertexArray.gety(p)),m=_t(h.x,h.y,e);if(m.signedDistanceFromCamera>0)return c.projections[p]=m.point,c.anyProjectionOccluded=c.anyProjectionOccluded||m.isOccluded,m.point;const v=p-o.direction;return zt(o.distanceFromAnchor===0?e.tileAnchorPoint:new a.P(e.lineVertexArray.getx(v),e.lineVertexArray.gety(v)),h,o.previousVertex,o.absOffsetX-o.distanceFromAnchor+1,e)}function _t(p,e,o){const c=p+o.translation[0],h=e+o.translation[1];let m;return o.pitchWithMap?(m=Ee(c,h,o.pitchedLabelPlaneMatrix,o.getElevation),m.isOccluded=!1):(m=o.transform.projectTileCoordinates(c,h,o.unwrappedTileID,o.getElevation),m.point.x=(.5*m.point.x+.5)*o.width,m.point.y=(.5*-m.point.y+.5)*o.height),m}function mt(p,e,o,c){if(o.pitchWithMap){const h=[p,e,0,1];return a.ao(h,h,c),o.transform.projectTileCoordinates(h[0]/h[3],h[1]/h[3],o.unwrappedTileID,o.getElevation).point}return{x:p/o.width*2-1,y:e/o.height*2-1}}function Ot(p,e,o){return o.transform.projectTileCoordinates(p,e,o.unwrappedTileID,o.getElevation)}function Rt(p,e,o){return p._unit()._perp()._mult(e*o)}function jt(p,e,o,c,h,m,v,w,T){if(w.projectionCache.offsets[p])return w.projectionCache.offsets[p];const P=o.add(e);if(p+T.direction<c||p+T.direction>=h)return w.projectionCache.offsets[p]=P,P;const A=$e(p+T.direction,w,T),D=Rt(A.sub(o),v,T.direction),L=o.add(D),U=A.add(D);return w.projectionCache.offsets[p]=a.ap(m,P,L,U)||P,w.projectionCache.offsets[p]}function Tt(p,e,o,c,h,m,v,w,T){const P=c?p-e:p+e;let A=P>0?1:-1,D=0;c&&(A*=-1,D=Math.PI),A<0&&(D+=Math.PI);let L,U=A>0?m+h:m+h+1;w.projectionCache.cachedAnchorPoint?L=w.projectionCache.cachedAnchorPoint:(L=_t(w.tileAnchorPoint.x,w.tileAnchorPoint.y,w).point,w.projectionCache.cachedAnchorPoint=L);let G,J,K=L,Q=L,re=0,se=0;const le=Math.abs(P),ue=[];let fe;for(;re+se<=le;){if(U+=A,U<m||U>=v)return null;re+=se,Q=K,J=G;const Se={absOffsetX:le,direction:A,distanceFromAnchor:re,previousVertex:Q};if(K=$e(U,w,Se),o===0)ue.push(Q),fe=K.sub(Q);else{let Re;const Le=K.sub(Q);Re=Le.mag()===0?Rt($e(U+A,w,Se).sub(K),o,A):Rt(Le,o,A),J||(J=Q.add(Re)),G=jt(U,Re,K,m,v,J,o,w,Se),ue.push(J),fe=G.sub(J)}se=fe.mag()}const he=fe._mult((le-re)/se)._add(J||Q),we=D+Math.atan2(K.y-Q.y,K.x-Q.x);return ue.push(he),{point:he,angle:T?we:0,path:ue}}const wi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Wr(p,e){for(let o=0;o<p;o++){const c=e.length;e.resize(c+4),e.float32.set(wi,3*c)}}function Qr(p,e,o){const c=e[0],h=e[1];return p[0]=o[0]*c+o[4]*h+o[12],p[1]=o[1]*c+o[5]*h+o[13],p[3]=o[3]*c+o[7]*h+o[15],p}const br=100;class Pa{constructor(e,o=new _e(e.width+200,e.height+200,25),c=new _e(e.width+200,e.height+200,25)){this.transform=e,this.grid=o,this.ignoredGrid=c,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+br,this.screenBottomBoundary=e.height+br,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,o,c,h,m,v,w,T,P,A,D,L){const U=this.projectAndGetPerspectiveRatio(e.anchorPointX+T[0],e.anchorPointY+T[1],m,A,L),G=c*U.perspectiveRatio;let J;if(v||w)J=this._projectCollisionBox(e,G,h,m,v,w,T,U,A,D,L);else{const fe=U.x+(D?D.x*G:0),he=U.y+(D?D.y*G:0);J={allPointsOccluded:!1,box:[fe+e.x1*G,he+e.y1*G,fe+e.x2*G,he+e.y2*G]}}const[K,Q,re,se]=J.box,le=v?J.allPointsOccluded:U.isOccluded;let ue=le;return ue||(ue=U.perspectiveRatio<this.perspectiveRatioCutoff),ue||(ue=!this.isInsideGrid(K,Q,re,se)),ue||o!=="always"&&this.grid.hitTest(K,Q,re,se,o,P)?{box:[K,Q,re,se],placeable:!1,offscreen:!1,occluded:le}:{box:[K,Q,re,se],placeable:!0,offscreen:this.isOffscreen(K,Q,re,se),occluded:le}}placeCollisionCircles(e,o,c,h,m,v,w,T,P,A,D,L,U,G){const J=[],K=new a.P(o.anchorX,o.anchorY),Q=this.getPerspectiveRatio(K.x,K.y,v,G),re=(P?m*this.transform.getPitchedTextCorrection(o.anchorX,o.anchorY,v)/Q:m*Q)/a.au,se={getElevation:G,pitchedLabelPlaneMatrix:w,lineVertexArray:c,pitchWithMap:P,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:K,unwrappedTileID:v,width:this.transform.width,height:this.transform.height,translation:U},le=it(re,h,o.lineOffsetX*re,o.lineOffsetY*re,!1,o,!1,se);let ue=!1,fe=!1,he=!0;if(le){const we=.5*D*Q+L,Se=new a.P(-100,-100),Re=new a.P(this.screenRightBoundary,this.screenBottomBoundary),Le=new te,ze=le.first,rt=le.last;let et=[];for(let Ct=ze.path.length-1;Ct>=1;Ct--)et.push(ze.path[Ct]);for(let Ct=1;Ct<rt.path.length;Ct++)et.push(rt.path[Ct]);const Ue=2.5*we;if(P){const Ct=this.projectPathToScreenSpace(et,se);et=Ct.some(rr=>rr.signedDistanceFromCamera<=0)?[]:Ct.map(rr=>rr.point)}let yt=[];if(et.length>0){const Ct=et[0].clone(),rr=et[0].clone();for(let gr=1;gr<et.length;gr++)Ct.x=Math.min(Ct.x,et[gr].x),Ct.y=Math.min(Ct.y,et[gr].y),rr.x=Math.max(rr.x,et[gr].x),rr.y=Math.max(rr.y,et[gr].y);yt=Ct.x>=Se.x&&rr.x<=Re.x&&Ct.y>=Se.y&&rr.y<=Re.y?[et]:rr.x<Se.x||Ct.x>Re.x||rr.y<Se.y||Ct.y>Re.y?[]:a.aq([et],Se.x,Se.y,Re.x,Re.y)}for(const Ct of yt){Le.reset(Ct,.25*we);let rr=0;rr=Le.length<=.5*we?1:Math.ceil(Le.paddedLength/Ue)+1;for(let gr=0;gr<rr;gr++){const ur=gr/Math.max(rr-1,1),kr=Le.lerp(ur),xr=kr.x+br,or=kr.y+br;J.push(xr,or,we,0);const hr=xr-we,dn=or-we,fn=xr+we,en=or+we;if(he=he&&this.isOffscreen(hr,dn,fn,en),fe=fe||this.isInsideGrid(hr,dn,fn,en),e!=="always"&&this.grid.hitTestCircle(xr,or,we,e,A)&&(ue=!0,!T))return{circles:[],offscreen:!1,collisionDetected:ue}}}}return{circles:!T&&ue||!fe||Q<this.perspectiveRatioCutoff?[]:J,offscreen:he,collisionDetected:ue}}projectPathToScreenSpace(e,o){const c=function(h,m){const v=a.K();return a.ai(v,m.pitchedLabelPlaneMatrix),h.map(w=>{const T=Ee(w.x,w.y,v,m.getElevation),P=m.transform.projectTileCoordinates(T.point.x,T.point.y,m.unwrappedTileID,m.getElevation);return P.point.x=(.5*P.point.x+.5)*m.width,P.point.y=(.5*-P.point.y+.5)*m.height,P})}(e,o);return function(h){let m=0,v=0,w=0,T=0;for(let P=0;P<h.length;P++)h[P].isOccluded?(w=P+1,T=0):(T++,T>v&&(v=T,m=w));return h.slice(m,m+v)}(c)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let c=1/0,h=1/0,m=-1/0,v=-1/0;for(const A of e){const D=new a.P(A.x+br,A.y+br);c=Math.min(c,D.x),h=Math.min(h,D.y),m=Math.max(m,D.x),v=Math.max(v,D.y),o.push(D)}const w=this.grid.query(c,h,m,v).concat(this.ignoredGrid.query(c,h,m,v)),T={},P={};for(const A of w){const D=A.key;if(T[D.bucketInstanceId]===void 0&&(T[D.bucketInstanceId]={}),T[D.bucketInstanceId][D.featureIndex])continue;const L=[new a.P(A.x1,A.y1),new a.P(A.x2,A.y1),new a.P(A.x2,A.y2),new a.P(A.x1,A.y2)];a.ar(o,L)&&(T[D.bucketInstanceId][D.featureIndex]=!0,P[D.bucketInstanceId]===void 0&&(P[D.bucketInstanceId]=[]),P[D.bucketInstanceId].push(D.featureIndex))}return P}insertCollisionBox(e,o,c,h,m,v){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:m,collisionGroupID:v,overlapMode:o},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,o,c,h,m,v){const w=c?this.ignoredGrid:this.grid,T={bucketInstanceId:h,featureIndex:m,collisionGroupID:v,overlapMode:o};for(let P=0;P<e.length;P+=4)w.insertCircle(T,e[P],e[P+1],e[P+2])}projectAndGetPerspectiveRatio(e,o,c,h,m){if(m){let v;h?(v=[e,o,h(e,o),1],a.ao(v,v,m)):(v=[e,o,0,1],Qr(v,v,m));const w=v[3];return{x:(v[0]/w+1)/2*this.transform.width+br,y:(-v[1]/w+1)/2*this.transform.height+br,perspectiveRatio:.5+this.transform.cameraToCenterDistance/w*.5,isOccluded:!1,signedDistanceFromCamera:w}}{const v=this.transform.projectTileCoordinates(e,o,c,h);return{x:(v.point.x+1)/2*this.transform.width+br,y:(1-v.point.y)/2*this.transform.height+br,perspectiveRatio:.5+this.transform.cameraToCenterDistance/v.signedDistanceFromCamera*.5,isOccluded:v.isOccluded,signedDistanceFromCamera:v.signedDistanceFromCamera}}}getPerspectiveRatio(e,o,c,h){const m=this.transform.projectTileCoordinates(e,o,c,h);return .5+this.transform.cameraToCenterDistance/m.signedDistanceFromCamera*.5}isOffscreen(e,o,c,h){return c<br||e>=this.screenRightBoundary||h<br||o>this.screenBottomBoundary}isInsideGrid(e,o,c,h){return c>=0&&e<this.gridRightBoundary&&h>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const e=a.as([]);return a.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,o,c,h,m,v,w,T,P,A,D){let L=1,U=0,G=0,J=1;const K=e.anchorPointX+w[0],Q=e.anchorPointY+w[1];if(v&&!m){const et=this.projectAndGetPerspectiveRatio(K+1,Q,h,P,D),Ue=et.x-T.x,yt=Math.atan((et.y-T.y)/Ue)+(Ue<0?Math.PI:0),Ct=Math.sin(yt),rr=Math.cos(yt);L=rr,U=Ct,G=-Ct,J=rr}else if(!v&&m){const et=De(this.transform);L=et.vecEast[0],U=et.vecEast[1],G=et.vecSouth[0],J=et.vecSouth[1]}let re=T.x,se=T.y,le=o;m&&(re=K,se=Q,le=Math.pow(2,-(this.transform.zoom-c.overscaledZ)),le*=this.transform.getPitchedTextCorrection(K,Q,h),A||(le*=a.ad(.5+T.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),A&&(re+=L*A.x*le+G*A.y*le,se+=U*A.x*le+J*A.y*le);const ue=e.x1*le,fe=e.x2*le,he=(ue+fe)/2,we=e.y1*le,Se=e.y2*le,Re=(we+Se)/2,Le=[{offsetX:ue,offsetY:we},{offsetX:he,offsetY:we},{offsetX:fe,offsetY:we},{offsetX:fe,offsetY:Re},{offsetX:fe,offsetY:Se},{offsetX:he,offsetY:Se},{offsetX:ue,offsetY:Se},{offsetX:ue,offsetY:Re}];let ze=[];for(const{offsetX:et,offsetY:Ue}of Le)ze.push(new a.P(re+L*et+G*Ue,se+U*et+J*Ue));let rt=!1;if(m){const et=ze.map(Ue=>this.projectAndGetPerspectiveRatio(Ue.x,Ue.y,h,P,D));rt=et.some(Ue=>!Ue.isOccluded),ze=et.map(Ue=>new a.P(Ue.x,Ue.y))}else rt=!0;return{box:a.at(ze),allPointsOccluded:!rt}}}class Bn{constructor(e,o,c,h){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?o:-o))):h&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class fr{constructor(e,o,c,h,m){this.text=new Bn(e?e.text:null,o,c,m),this.icon=new Bn(e?e.icon:null,o,h,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ah{constructor(e,o,c){this.text=e,this.icon=o,this.skipFade=c}}class Ns{constructor(e,o,c,h,m){this.bucketInstanceId=e,this.featureIndex=o,this.sourceLayerIndex=c,this.bucketIndex=h,this.tileID=m}}class Yl{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const o=++this.maxGroupID;this.collisionGroups[e]={ID:o,predicate:c=>c.collisionGroupID===o}}return this.collisionGroups[e]}}function ii(p,e,o,c,h){const{horizontalAlign:m,verticalAlign:v}=a.aA(p);return new a.P(-(m-.5)*e+c[0]*h,-(v-.5)*o+c[1]*h)}class Qi{constructor(e,o,c,h,m){this.transform=e.clone(),this.terrain=o,this.collisionIndex=new Pa(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Yl(h),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const o=this.terrain;return o?(c,h)=>o.getElevation(e,c,h):null}getBucketParts(e,o,c,h){const m=c.getBucket(o),v=c.latestFeatureIndex;if(!m||!v||o.id!==m.layerIds[0])return;const w=c.collisionBoxArray,T=m.layers[0].layout,P=m.layers[0].paint,A=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),D=c.tileSize/a.Z,L=c.tileID.toUnwrapped(),U=T.get("text-rotation-alignment")==="map",G=a.av(c,1,this.transform.zoom),J=a.aw(this.collisionIndex.transform,c,P.get("text-translate"),P.get("text-translate-anchor")),K=a.aw(this.collisionIndex.transform,c,P.get("icon-translate"),P.get("icon-translate-anchor")),Q=Te(U,this.transform,G);this.retainedQueryData[m.bucketInstanceId]=new Ns(m.bucketInstanceId,v,m.sourceLayerIndex,m.index,c.tileID);const re={bucket:m,layout:T,translationText:J,translationIcon:K,unwrappedTileID:L,pitchedLabelPlaneMatrix:Q,scale:A,textPixelRatio:D,holdingForFade:c.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:a.af(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(h)for(const se of m.sortKeyRanges){const{sortKey:le,symbolInstanceStart:ue,symbolInstanceEnd:fe}=se;e.push({sortKey:le,symbolInstanceStart:ue,symbolInstanceEnd:fe,parameters:re})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:re})}attemptAnchorPlacement(e,o,c,h,m,v,w,T,P,A,D,L,U,G,J,K,Q,re,se,le){const ue=a.ax[e.textAnchor],fe=[e.textOffset0,e.textOffset1],he=ii(ue,c,h,fe,m),we=this.collisionIndex.placeCollisionBox(o,L,T,P,A,w,v,K,D.predicate,se,he,le);if((!re||this.collisionIndex.placeCollisionBox(re,L,T,P,A,w,v,Q,D.predicate,se,he,le).placeable)&&we.placeable){let Se;if(this.prevPlacement&&this.prevPlacement.variableOffsets[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID].text&&(Se=this.prevPlacement.variableOffsets[U.crossTileID].anchor),U.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[U.crossTileID]={textOffset:fe,width:c,height:h,anchor:ue,textBoxScale:m,prevAnchor:Se},this.markUsedJustification(G,ue,U,J),G.allowVerticalPlacement&&(this.markUsedOrientation(G,J,U),this.placedOrientations[U.crossTileID]=J),{shift:he,placedGlyphBoxes:we}}}placeLayerBucketPart(e,o,c){const{bucket:h,layout:m,translationText:v,translationIcon:w,unwrappedTileID:T,pitchedLabelPlaneMatrix:P,textPixelRatio:A,holdingForFade:D,collisionBoxArray:L,partiallyEvaluatedTextSize:U,collisionGroup:G}=e.parameters,J=m.get("text-optional"),K=m.get("icon-optional"),Q=a.ay(m,"text-overlap","text-allow-overlap"),re=Q==="always",se=a.ay(m,"icon-overlap","icon-allow-overlap"),le=se==="always",ue=m.get("text-rotation-alignment")==="map",fe=m.get("text-pitch-alignment")==="map",he=m.get("icon-text-fit")!=="none",we=m.get("symbol-z-order")==="viewport-y",Se=re&&(le||!h.hasIconData()||K),Re=le&&(re||!h.hasTextData()||J);!h.collisionArrays&&L&&h.deserializeCollisionBoxes(L);const Le=this.retainedQueryData[h.bucketInstanceId].tileID,ze=this._getTerrainElevationFunc(Le),rt=this.transform.getFastPathSimpleProjectionMatrix(Le),et=(Ue,yt,Ct)=>{var rr,gr;if(o[Ue.crossTileID])return;if(D)return void(this.placements[Ue.crossTileID]=new ah(!1,!1,!1));let ur=!1,kr=!1,xr=!0,or=null,hr={box:null,placeable:!1,offscreen:null,occluded:!1},dn={placeable:!1},fn=null,en=null,bn=null,di=0,Ho=0,Bo=0;yt.textFeatureIndex?di=yt.textFeatureIndex:Ue.useRuntimeCollisionCircles&&(di=Ue.featureIndex),yt.verticalTextFeatureIndex&&(Ho=yt.verticalTextFeatureIndex);const mo=yt.textBox;if(mo){const go=_r=>{let pr=a.ag.horizontal;if(h.allowVerticalPlacement&&!_r&&this.prevPlacement){const tn=this.prevPlacement.placedOrientations[Ue.crossTileID];tn&&(this.placedOrientations[Ue.crossTileID]=tn,pr=tn,this.markUsedOrientation(h,pr,Ue))}return pr},$o=(_r,pr)=>{if(h.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&yt.verticalTextBox){for(const tn of h.writingModes)if(tn===a.ag.vertical?(hr=pr(),dn=hr):hr=_r(),hr&&hr.placeable)break}else hr=_r()},To=Ue.textAnchorOffsetStartIndex,Oo=Ue.textAnchorOffsetEndIndex;if(Oo===To){const _r=(pr,tn)=>{const rn=this.collisionIndex.placeCollisionBox(pr,Q,A,Le,T,fe,ue,v,G.predicate,ze,void 0,rt);return rn&&rn.placeable&&(this.markUsedOrientation(h,tn,Ue),this.placedOrientations[Ue.crossTileID]=tn),rn};$o(()=>_r(mo,a.ag.horizontal),()=>{const pr=yt.verticalTextBox;return h.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&pr?_r(pr,a.ag.vertical):{box:null,offscreen:null}}),go(hr&&hr.placeable)}else{let _r=a.ax[(gr=(rr=this.prevPlacement)===null||rr===void 0?void 0:rr.variableOffsets[Ue.crossTileID])===null||gr===void 0?void 0:gr.anchor];const pr=(rn,ji,Gf)=>{const Kh=rn.x2-rn.x1,Yc=rn.y2-rn.y1,Jh=Ue.textBoxScale,Ni=he&&se==="never"?ji:null;let Yn=null,Kc=Q==="never"?1:2,Qh="never";_r&&Kc++;for(let _l=0;_l<Kc;_l++){for(let yl=To;yl<Oo;yl++){const ed=h.textAnchorOffsets.get(yl);if(_r&&ed.textAnchor!==_r)continue;const vl=this.attemptAnchorPlacement(ed,rn,Kh,Yc,Jh,ue,fe,A,Le,T,G,Qh,Ue,h,Gf,v,w,Ni,ze);if(vl&&(Yn=vl.placedGlyphBoxes,Yn&&Yn.placeable))return ur=!0,or=vl.shift,Yn}_r?_r=null:Qh=Q}return c&&!Yn&&(Yn={box:this.collisionIndex.placeCollisionBox(mo,"always",A,Le,T,fe,ue,v,G.predicate,ze,void 0,rt).box,offscreen:!1,placeable:!1,occluded:!1}),Yn};$o(()=>pr(mo,yt.iconBox,a.ag.horizontal),()=>{const rn=yt.verticalTextBox;return h.allowVerticalPlacement&&(!hr||!hr.placeable)&&Ue.numVerticalGlyphVertices>0&&rn?pr(rn,yt.verticalIconBox,a.ag.vertical):{box:null,occluded:!0,offscreen:null}}),hr&&(ur=hr.placeable,xr=hr.offscreen);const tn=go(hr&&hr.placeable);if(!ur&&this.prevPlacement){const rn=this.prevPlacement.variableOffsets[Ue.crossTileID];rn&&(this.variableOffsets[Ue.crossTileID]=rn,this.markUsedJustification(h,rn.anchor,Ue,tn))}}}if(fn=hr,ur=fn&&fn.placeable,xr=fn&&fn.offscreen,Ue.useRuntimeCollisionCircles){const go=h.text.placedSymbolArray.get(Ue.centerJustifiedTextSymbolIndex),$o=a.ah(h.textSizeData,U,go),To=m.get("text-padding");en=this.collisionIndex.placeCollisionCircles(Q,go,h.lineVertexArray,h.glyphOffsetArray,$o,T,P,c,fe,G.predicate,Ue.collisionCircleDiameter,To,v,ze),en.circles.length&&en.collisionDetected&&!c&&a.w("Collisions detected, but collision boxes are not shown"),ur=re||en.circles.length>0&&!en.collisionDetected,xr=xr&&en.offscreen}if(yt.iconFeatureIndex&&(Bo=yt.iconFeatureIndex),yt.iconBox){const go=$o=>this.collisionIndex.placeCollisionBox($o,se,A,Le,T,fe,ue,w,G.predicate,ze,he&&or?or:void 0,rt);dn&&dn.placeable&&yt.verticalIconBox?(bn=go(yt.verticalIconBox),kr=bn.placeable):(bn=go(yt.iconBox),kr=bn.placeable),xr=xr&&bn.offscreen}const Oi=J||Ue.numHorizontalGlyphVertices===0&&Ue.numVerticalGlyphVertices===0,aa=K||Ue.numIconVertices===0;Oi||aa?aa?Oi||(kr=kr&&ur):ur=kr&&ur:kr=ur=kr&&ur;const Fi=kr&&bn.placeable;if(ur&&fn.placeable&&this.collisionIndex.insertCollisionBox(fn.box,Q,m.get("text-ignore-placement"),h.bucketInstanceId,dn&&dn.placeable&&Ho?Ho:di,G.ID),Fi&&this.collisionIndex.insertCollisionBox(bn.box,se,m.get("icon-ignore-placement"),h.bucketInstanceId,Bo,G.ID),en&&ur&&this.collisionIndex.insertCollisionCircles(en.circles,Q,m.get("text-ignore-placement"),h.bucketInstanceId,di,G.ID),c&&this.storeCollisionData(h.bucketInstanceId,Ct,yt,fn,bn,en),Ue.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ue.crossTileID]=new ah((ur||Se)&&!(fn!=null&&fn.occluded),(kr||Re)&&!(bn!=null&&bn.occluded),xr||h.justReloaded),o[Ue.crossTileID]=!0};if(we){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ue=h.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let yt=Ue.length-1;yt>=0;--yt){const Ct=Ue[yt];et(h.symbolInstances.get(Ct),h.collisionArrays[Ct],Ct)}}else for(let Ue=e.symbolInstanceStart;Ue<e.symbolInstanceEnd;Ue++)et(h.symbolInstances.get(Ue),h.collisionArrays[Ue],Ue);h.justReloaded=!1}storeCollisionData(e,o,c,h,m,v){if(c.textBox||c.iconBox){let w,T;this.collisionBoxArrays.has(e)?w=this.collisionBoxArrays.get(e):(w=new Map,this.collisionBoxArrays.set(e,w)),w.has(o)?T=w.get(o):(T={text:null,icon:null},w.set(o,T)),c.textBox&&(T.text=h.box),c.iconBox&&(T.icon=m.box)}if(v){let w=this.collisionCircleArrays[e];w===void 0&&(w=this.collisionCircleArrays[e]=[]);for(let T=0;T<v.circles.length;T+=4)w.push(v.circles[T+0]-br),w.push(v.circles[T+1]-br),w.push(v.circles[T+2]),w.push(v.collisionDetected?1:0)}}markUsedJustification(e,o,c,h){let m;m=h===a.ag.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[a.az(o)];const v=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const w of v)w>=0&&(e.text.placedSymbolArray.get(w).crossTileID=m>=0&&w!==m?0:c.crossTileID)}markUsedOrientation(e,o,c){const h=o===a.ag.horizontal||o===a.ag.horizontalOnly?o:0,m=o===a.ag.vertical?o:0,v=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const w of v)e.text.placedSymbolArray.get(w).placedOrientation=h;c.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let c=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const h=o?o.symbolFadeChange(e):1,m=o?o.opacities:{},v=o?o.variableOffsets:{},w=o?o.placedOrientations:{};for(const T in this.placements){const P=this.placements[T],A=m[T];A?(this.opacities[T]=new fr(A,h,P.text,P.icon),c=c||P.text!==A.text.placed||P.icon!==A.icon.placed):(this.opacities[T]=new fr(null,h,P.text,P.icon,P.skipFade),c=c||P.text||P.icon)}for(const T in m){const P=m[T];if(!this.opacities[T]){const A=new fr(P,h,!1,!1);A.isHidden()||(this.opacities[T]=A,c=c||P.text.placed||P.icon.placed)}}for(const T in v)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=v[T]);for(const T in w)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=w[T]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:e)}updateLayerOpacities(e,o){const c={};for(const h of o){const m=h.getBucket(e);m&&h.latestFeatureIndex&&e.id===m.layerIds[0]&&this.updateBucketOpacities(m,h.tileID,c,h.collisionBoxArray)}}updateBucketOpacities(e,o,c,h){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const m=e.layers[0],v=m.layout,w=new fr(null,0,!1,!1,!0),T=v.get("text-allow-overlap"),P=v.get("icon-allow-overlap"),A=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),D=v.get("text-rotation-alignment")==="map",L=v.get("text-pitch-alignment")==="map",U=v.get("icon-text-fit")!=="none",G=new fr(null,0,T&&(P||!e.hasIconData()||v.get("icon-optional")),P&&(T||!e.hasTextData()||v.get("text-optional")),!0);!e.collisionArrays&&h&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(h);const J=(Q,re,se)=>{for(let le=0;le<re/4;le++)Q.opacityVertexArray.emplaceBack(se);Q.hasVisibleVertices=Q.hasVisibleVertices||se!==ts},K=this.collisionBoxArrays.get(e.bucketInstanceId);for(let Q=0;Q<e.symbolInstances.length;Q++){const re=e.symbolInstances.get(Q),{numHorizontalGlyphVertices:se,numVerticalGlyphVertices:le,crossTileID:ue}=re;let fe=this.opacities[ue];c[ue]?fe=w:fe||(fe=G,this.opacities[ue]=fe),c[ue]=!0;const he=re.numIconVertices>0,we=this.placedOrientations[re.crossTileID],Se=we===a.ag.vertical,Re=we===a.ag.horizontal||we===a.ag.horizontalOnly;if(se>0||le>0){const ze=Jl(fe.text);J(e.text,se,Se?ts:ze),J(e.text,le,Re?ts:ze);const rt=fe.text.isHidden();[re.rightJustifiedTextSymbolIndex,re.centerJustifiedTextSymbolIndex,re.leftJustifiedTextSymbolIndex].forEach(yt=>{yt>=0&&(e.text.placedSymbolArray.get(yt).hidden=rt||Se?1:0)}),re.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(re.verticalPlacedTextSymbolIndex).hidden=rt||Re?1:0);const et=this.variableOffsets[re.crossTileID];et&&this.markUsedJustification(e,et.anchor,re,we);const Ue=this.placedOrientations[re.crossTileID];Ue&&(this.markUsedJustification(e,"left",re,Ue),this.markUsedOrientation(e,Ue,re))}if(he){const ze=Jl(fe.icon),rt=!(U&&re.verticalPlacedIconSymbolIndex&&Se);re.placedIconSymbolIndex>=0&&(J(e.icon,re.numIconVertices,rt?ze:ts),e.icon.placedSymbolArray.get(re.placedIconSymbolIndex).hidden=fe.icon.isHidden()),re.verticalPlacedIconSymbolIndex>=0&&(J(e.icon,re.numVerticalIconVertices,rt?ts:ze),e.icon.placedSymbolArray.get(re.verticalPlacedIconSymbolIndex).hidden=fe.icon.isHidden())}const Le=K&&K.has(Q)?K.get(Q):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const ze=e.collisionArrays[Q];if(ze){let rt=new a.P(0,0);if(ze.textBox||ze.verticalTextBox){let et=!0;if(A){const Ue=this.variableOffsets[ue];Ue?(rt=ii(Ue.anchor,Ue.width,Ue.height,Ue.textOffset,Ue.textBoxScale),D&&rt._rotate(L?-this.transform.bearingInRadians:this.transform.bearingInRadians)):et=!1}if(ze.textBox||ze.verticalTextBox){let Ue;ze.textBox&&(Ue=Se),ze.verticalTextBox&&(Ue=Re),Kl(e.textCollisionBox.collisionVertexArray,fe.text.placed,!et||Ue,Le.text,rt.x,rt.y)}}if(ze.iconBox||ze.verticalIconBox){const et=!!(!Re&&ze.verticalIconBox);let Ue;ze.iconBox&&(Ue=et),ze.verticalIconBox&&(Ue=!et),Kl(e.iconCollisionBox.collisionVertexArray,fe.icon.placed,Ue,Le.icon,U?rt.x:0,U?rt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,o){const c=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*c>e}setStale(){this.stale=!0}}function Kl(p,e,o,c,h,m){c&&c.length!==0||(c=[0,0,0,0]);const v=c[0]-br,w=c[1]-br,T=c[2]-br,P=c[3]-br;p.emplaceBack(e?1:0,o?1:0,h||0,m||0,v,w),p.emplaceBack(e?1:0,o?1:0,h||0,m||0,T,w),p.emplaceBack(e?1:0,o?1:0,h||0,m||0,T,P),p.emplaceBack(e?1:0,o?1:0,h||0,m||0,v,P)}const lh=Math.pow(2,25),ch=Math.pow(2,24),es=Math.pow(2,17),uh=Math.pow(2,16),xf=Math.pow(2,9),wf=Math.pow(2,8),Cf=Math.pow(2,1);function Jl(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const e=p.placed?1:0,o=Math.floor(127*p.opacity);return o*lh+e*ch+o*es+e*uh+o*xf+e*wf+o*Cf+e}const ts=0;class Ql{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,o,c,h,m){const v=this._bucketParts;for(;this._currentTileIndex<e.length;)if(o.getBucketParts(v,h,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,v.sort((w,T)=>w.sortKey-T.sortKey));this._currentPartIndex<v.length;)if(o.placeLayerBucketPart(v[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,m())return!0;return!1}}class ec{constructor(e,o,c,h,m,v,w,T){this.placement=new Qi(e,o,v,w,T),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(e,o,c){const h=q.now(),m=()=>!this._forceFullPlacement&&q.now()-h>2;for(;this._currentPlacementIndex>=0;){const v=o[e[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(v.type==="symbol"&&(!v.minzoom||v.minzoom<=w)&&(!v.maxzoom||v.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Ql(v)),this._inProgressLayer.continuePlacement(c[v.source],this.placement,this._showCollisionBoxes,v,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const rs=512/a.Z/2;class tc{constructor(e,o,c){this.tileID=e,this.bucketInstanceId=c,this._symbolsByKey={};const h=new Map;for(let m=0;m<o.length;m++){const v=o.get(m),w=v.key,T=h.get(w);T?T.push(v):h.set(w,[v])}for(const[m,v]of h){const w={positions:v.map(T=>({x:Math.floor(T.anchorX*rs),y:Math.floor(T.anchorY*rs)})),crossTileIDs:v.map(T=>T.crossTileID)};if(w.positions.length>128){const T=new a.aB(w.positions.length,16,Uint16Array);for(const{x:P,y:A}of w.positions)T.add(P,A);T.finish(),delete w.positions,w.index=T}this._symbolsByKey[m]=w}}getScaledCoordinates(e,o){const{x:c,y:h,z:m}=this.tileID.canonical,{x:v,y:w,z:T}=o.canonical,P=rs/Math.pow(2,T-m),A=(w*a.Z+e.anchorY)*P,D=h*a.Z*rs;return{x:Math.floor((v*a.Z+e.anchorX)*P-c*a.Z*rs),y:Math.floor(A-D)}}findMatches(e,o,c){const h=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let m=0;m<e.length;m++){const v=e.get(m);if(v.crossTileID)continue;const w=this._symbolsByKey[v.key];if(!w)continue;const T=this.getScaledCoordinates(v,o);if(w.index){const P=w.index.range(T.x-h,T.y-h,T.x+h,T.y+h).sort();for(const A of P){const D=w.crossTileIDs[A];if(!c[D]){c[D]=!0,v.crossTileID=D;break}}}else if(w.positions)for(let P=0;P<w.positions.length;P++){const A=w.positions[P],D=w.crossTileIDs[P];if(Math.abs(A.x-T.x)<=h&&Math.abs(A.y-T.y)<=h&&!c[D]){c[D]=!0,v.crossTileID=D;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class rc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ma{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const o=Math.round((e-this.lng)/360);if(o!==0)for(const c in this.indexes){const h=this.indexes[c],m={};for(const v in h){const w=h[v];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+o),m[w.tileID.key]=w}this.indexes[c]=m}this.lng=e}addBucket(e,o,c){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let m=0;m<o.symbolInstances.length;m++)o.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const h=this.usedCrossTileIDs[e.overscaledZ];for(const m in this.indexes){const v=this.indexes[m];if(Number(m)>e.overscaledZ)for(const w in v){const T=v[w];T.tileID.isChildOf(e)&&T.findMatches(o.symbolInstances,e,h)}else{const w=v[e.scaledTo(Number(m)).key];w&&w.findMatches(o.symbolInstances,e,h)}}for(let m=0;m<o.symbolInstances.length;m++){const v=o.symbolInstances.get(m);v.crossTileID||(v.crossTileID=c.generate(),h[v.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new tc(e,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(e,o){for(const c of o.getCrossTileIDsLists())for(const h of c)delete this.usedCrossTileIDs[e][h]}removeStaleBuckets(e){let o=!1;for(const c in this.indexes){const h=this.indexes[c];for(const m in h)e[h[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,h[m]),delete h[m],o=!0)}return o}}class nc{constructor(){this.layerIndexes={},this.crossTileIDs=new rc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,o,c){let h=this.layerIndexes[e.id];h===void 0&&(h=this.layerIndexes[e.id]=new Ma);let m=!1;const v={};h.handleWrapJump(c);for(const w of o){const T=w.getBucket(e);T&&e.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(w.tileID,T,this.crossTileIDs)&&(m=!0),v[T.bucketInstanceId]=!0)}return h.removeStaleBuckets(v)&&(m=!0),m}pruneUnusedLayers(e){const o={};e.forEach(c=>{o[c]=!0});for(const c in this.layerIndexes)o[c]||delete this.layerIndexes[c]}}var Ci="void main() {fragColor=vec4(1.0);}";const wo={prelude:Jt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Jt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Jt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Jt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Jt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Jt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Jt(Ci,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Jt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Jt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Jt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Jt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Jt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Jt(Ci,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Jt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Jt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Jt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Jt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Jt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Jt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Jt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Jt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Jt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Jt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Jt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Jt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Jt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Jt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Jt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Jt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Jt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Jt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Jt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Jt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Jt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Jt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Jt(p,e){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=e.match(/in ([\w]+) ([\w]+)/g),h=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=m?m.concat(h):h,w={};return{fragmentSource:p=p.replace(o,(T,P,A,D,L)=>(w[L]=!0,P==="define"?`
#ifndef HAS_UNIFORM_u_${L}
in ${A} ${D} ${L};
#else
uniform ${A} ${D} u_${L};
#endif
`:`
#ifdef HAS_UNIFORM_u_${L}
    ${A} ${D} ${L} = u_${L};
#endif
`)),vertexSource:e=e.replace(o,(T,P,A,D,L)=>{const U=D==="float"?"vec2":"vec4",G=L.match(/color/)?"color":U;return w[L]?P==="define"?`
#ifndef HAS_UNIFORM_u_${L}
uniform lowp float u_${L}_t;
in ${A} ${U} a_${L};
out ${A} ${D} ${L};
#else
uniform ${A} ${D} u_${L};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${L}
    ${L} = a_${L};
#else
    ${A} ${D} ${L} = u_${L};
#endif
`:`
#ifndef HAS_UNIFORM_u_${L}
    ${L} = unpack_mix_${G}(a_${L}, u_${L}_t);
#else
    ${A} ${D} ${L} = u_${L};
#endif
`:P==="define"?`
#ifndef HAS_UNIFORM_u_${L}
uniform lowp float u_${L}_t;
in ${A} ${U} a_${L};
#else
uniform ${A} ${D} u_${L};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${L}
    ${A} ${D} ${L} = a_${L};
#else
    ${A} ${D} ${L} = u_${L};
#endif
`:`
#ifndef HAS_UNIFORM_u_${L}
    ${A} ${D} ${L} = unpack_mix_${G}(a_${L}, u_${L}_t);
#else
    ${A} ${D} ${L} = u_${L};
#endif
`}),staticAttributes:c,staticUniforms:v}}class Wn{constructor(e,o,c){this.vertexBuffer=e,this.indexBuffer=o,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var so=a.aC([{name:"a_pos",type:"Int16",components:2}]);const Qt="#define PROJECTION_MERCATOR",Ia="mercator";class oc{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Ia}get shaderDefine(){return Qt}get shaderPreludeCode(){return wo.projectionMercator}get vertexShaderPreludeCode(){return wo.projectionMercator.vertexSource}get subdivisionGranularity(){return a.aD.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,o,c,h,m){if(this._cachedMesh)return this._cachedMesh;const v=new a.aE;v.emplaceBack(0,0),v.emplaceBack(a.Z,0),v.emplaceBack(0,a.Z),v.emplaceBack(a.Z,a.Z);const w=e.createVertexBuffer(v,so.members),T=a.aF.simpleSegment(0,0,4,2),P=new a.aG;P.emplaceBack(1,0,2),P.emplaceBack(1,2,3);const A=e.createIndexBuffer(P);return this._cachedMesh=new Wn(w,A,T),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function ao(p,e){const o=a.ad(e.lat,-85.051129,a.aI);return new a.P(a.U(e.lng)*p,a.S(o)*p)}function vn(p,e){return new a.$(e.x/p,e.y/p).toLngLat()}function un(p){return p.cameraToCenterDistance*Math.min(.85*Math.tan(a.ac(90-p.pitch)),Math.tan(a.ac(89.25-p.pitch)))}function Dr(p,e){const o=p.canonical,c=e/a.aH(o.z),h=o.x+Math.pow(2,o.z)*p.wrap,m=a.as(new Float64Array(16));return a.L(m,m,[h*c,o.y*c,0]),a.M(m,m,[c/a.Z,c/a.Z,1]),m}function ic(p,e,o,c,h){const m=a.$.fromLngLat(p,e),v=h*a.aJ(1,p.lat),w=v*Math.cos(a.ac(o)),T=Math.sqrt(v*v-w*w),P=T*Math.sin(a.ac(-c)),A=T*Math.cos(a.ac(-c));return new a.$(m.x+P,m.y+A,m.z+w)}class hn{constructor(e=0,o=0,c=0,h=0){if(isNaN(e)||e<0||isNaN(o)||o<0||isNaN(c)||c<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=o,this.left=c,this.right=h}interpolate(e,o,c){return o.top!=null&&e.top!=null&&(this.top=a.B.number(e.top,o.top,c)),o.bottom!=null&&e.bottom!=null&&(this.bottom=a.B.number(e.bottom,o.bottom,c)),o.left!=null&&e.left!=null&&(this.left=a.B.number(e.left,o.left,c)),o.right!=null&&e.right!=null&&(this.right=a.B.number(e.right,o.right,c)),this}getCenter(e,o){const c=a.ad((this.left+e-this.right)/2,0,e),h=a.ad((this.top+o-this.bottom)/2,0,o);return new a.P(c,h)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new hn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function zn(p,e){if(!p.renderWorldCopies||p.lngRange)return;const o=e.lng-p.center.lng;e.lng+=o>180?-360:o<-180?360:0}function $n(p){return Math.max(0,Math.floor(p))}class Ea{constructor(e,o,c,h,m,v){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=v===void 0||!!v,this._minZoom=o||0,this._maxZoom=c||22,this._minPitch=h??0,this._maxPitch=m??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new a.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=$n(this._zoom),this._scale=a.aH(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new hn,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,o,c){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=$n(this._zoom),this._scale=a.aH(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new hn(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!c&&e.autoCalculateNearFarZ,o&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const o=a.aK(e,-180,180)*Math.PI/180;var c,h,m,v,w,T,P,A,D;this._bearingInRadians!==o&&(this._unmodified=!1,this._bearingInRadians=o,this._calcMatrices(),this._rotationMatrix=R(),c=this._rotationMatrix,m=-this._bearingInRadians,v=(h=this._rotationMatrix)[0],w=h[1],T=h[2],P=h[3],A=Math.sin(m),D=Math.cos(m),c[0]=v*D+T*A,c[1]=w*D+P*A,c[2]=v*-A+T*D,c[3]=w*-A+P*D)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const o=a.ad(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==o&&(this._unmodified=!1,this._pitchInRadians=o,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const o=e/180*Math.PI;this._rollInRadians!==o&&(this._unmodified=!1,this._rollInRadians=o,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return a.aL(this._fovInRadians)}setFov(e){e=a.ad(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=a.ac(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const o=this.getConstrained(this._center,e).zoom;this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this._tileZoom=Math.max(0,Math.floor(o)),this._scale=a.aH(o),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,o){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=o,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,o,c){this._unmodified=!1,this._edgeInsets.interpolate(e,o,c),this._constrain(),this._calcMatrices()}resize(e,o,c=!0){this._width=e,this._height=o,c&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Ie([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,a.aI])}getConstrained(e,o){return this._callbacks.getConstrained(e,o)}getCameraQueryGeometry(e,o){if(o.length===1)return[o[0],e];{let c=e.x,h=e.y,m=e.x,v=e.y;for(const w of o)c=Math.min(c,w.x),h=Math.min(h,w.y),m=Math.max(m,w.x),v=Math.max(v,w.y);return[new a.P(c,h),new a.P(m,h),new a.P(m,v),new a.P(c,v),new a.P(c,h)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:o,zoom:c}=this.getConstrained(this.center,this.zoom);this.setCenter(o),this.setZoom(c),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=a.as(new Float64Array(16));a.M(e,e,[this._width/2,-this._height/2,1]),a.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=a.as(new Float64Array(16)),a.M(e,e,[1,-1,1]),a.L(e,e,[-1,-1,0]),a.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,o,c,h){const m=c!==void 0?c:this.bearing,v=h=h!==void 0?h:this.pitch,w=a.$.fromLngLat(e,o),T=-Math.cos(a.ac(v)),P=Math.sin(a.ac(v)),A=P*Math.sin(a.ac(m)),D=-P*Math.cos(a.ac(m));let L=this.elevation;const U=o-L;let G;T*U>=0||Math.abs(T)<.1?(G=1e4,L=o+G*T):G=-U/T;let J,K,Q=a.aM(1,w.y),re=0;do{if(re+=1,re>10)break;K=G/Q,J=new a.$(w.x+A*K,w.y+D*K),Q=1/J.meterInMercatorCoordinateUnits()}while(Math.abs(G-K*Q)>1e-12);return{center:J.toLngLat(),elevation:L,zoom:a.aa(this.height/2/Math.tan(this.fovInRadians/2)/K/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const o=a.aJ(1,this.center.lat)*this.worldSize,c=this.cameraToCenterDistance/o,h=a.$.fromLngLat(this.center,this.elevation),m=ic(this.center,this.elevation,this.pitch,this.bearing,c);this._elevation=e;const v=this.calculateCenterFromCameraLngLatAlt(m.toLngLat(),a.aM(m.z,h.y),this.bearing,this.pitch);this._elevation=v.elevation,this._center=v.center,this.setZoom(v.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=a.aJ(1,this.center.lat)*this.worldSize;return ic(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const o=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/o,e.canonical.y/o,1/o/a.Z,1/o/a.Z]}}class Co{constructor(e,o){this.min=e,this.max=o,this.center=a.aN([],a.aO([],this.min,this.max),.5)}quadrant(e){const o=[e%2==0,e<2],c=a.aP(this.min),h=a.aP(this.max);for(let m=0;m<o.length;m++)c[m]=o[m]?this.min[m]:this.center[m],h[m]=o[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new Co(c,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let o=!0;for(let c=0;c<e.planes.length;c++){const h=this.intersectsPlane(e.planes[c]);if(h===0)return 0;h===1&&(o=!1)}return o?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let o=e[3],c=e[3];for(let h=0;h<3;h++)e[h]>0?(o+=e[h]*this.min[h],c+=e[h]*this.max[h]):(c+=e[h]*this.min[h],o+=e[h]*this.max[h]);return o>=0?2:c<0?0:1}}class Hr{distanceToTile2d(e,o,c,h){const m=h.distanceX([e,o]),v=h.distanceY([e,o]);return Math.hypot(m,v)}getWrap(e,o,c){return c}getTileAABB(e,o,c,h){var m,v;let w=c,T=c;if(h.terrain){const A=new a.Y(e.z,o,e.z,e.x,e.y),D=h.terrain.getMinMaxElevation(A);w=(m=D.minElevation)!==null&&m!==void 0?m:c,T=(v=D.maxElevation)!==null&&v!==void 0?v:c}const P=1<<e.z;return new Co([o+e.x/P,e.y/P,w],[o+(e.x+1)/P,(e.y+1)/P,T])}allowVariableZoom(e,o){const c=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,h=a.ad(78.5-c/2,0,60);return!!o.terrain||e.pitch>h}allowWorldCopies(){return!0}recalculateCache(){}}class si{constructor(e,o,c){this.points=e,this.planes=o,this.aabb=c}static fromInvProjectionMatrix(e,o=1,c=0){const h=Math.pow(2,c),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(P=>{const A=1/(P=a.ao([],P,e))[3]/o*h;return a.aQ(P,P,[A,A,1/P[3],A])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(P=>{const A=a.aR([],m[P[0]],m[P[1]]),D=a.aR([],m[P[2]],m[P[1]]),L=a.aS([],a.aT([],A,D)),U=-a.aU(L,m[P[1]]);return L.concat(U)}),w=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],T=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const P of m)for(let A=0;A<3;A++)w[A]=Math.min(w[A],P[A]),T[A]=Math.max(T[A],P[A]);return new si(m,v,new Co(w,T))}}class lo{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,o,c){return this._helper.interpolatePadding(e,o,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,o,c=!0){this._helper.resize(e,o,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,o){this._helper.overrideNearFarZ(e,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,o){}constructor(e,o,c,h,m){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Ea({calcMatrices:()=>{this._calcMatrices()},getConstrained:(v,w)=>this.getConstrained(v,w)},e,o,c,h,m),this._coveringTilesDetailsProvider=new Hr}clone(){const e=new lo;return e.apply(this),e}apply(e,o,c){this._helper.apply(e,o,c)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const o=[new a.aV(0,e)];if(this._helper._renderWorldCopies){const c=this.screenPointToMercatorCoordinate(new a.P(0,0)),h=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,0)),m=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,this._helper._height)),v=this.screenPointToMercatorCoordinate(new a.P(0,this._helper._height)),w=Math.floor(Math.min(c.x,h.x,m.x,v.x)),T=Math.floor(Math.max(c.x,h.x,m.x,v.x)),P=1;for(let A=w-P;A<=T+P;A++)A!==0&&o.push(new a.aV(A,e))}return o}getCameraFrustum(){return si.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const o=this.screenPointToLocation(this.centerPoint,e),c=e?e.getElevationForLngLatZoom(o,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(c)}setLocationAtPoint(e,o){const c=a.aJ(this.elevation,this.center.lat),h=this.screenPointToMercatorCoordinateAtZ(o,c),m=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,c),v=a.$.fromLngLat(e),w=new a.$(v.x-(h.x-m.x),v.y-(h.y-m.y));this.setCenter(w==null?void 0:w.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,o){return o?this.coordinatePoint(a.$.fromLngLat(e),o.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(a.$.fromLngLat(e))}screenPointToLocation(e,o){var c;return(c=this.screenPointToMercatorCoordinate(e,o))===null||c===void 0?void 0:c.toLngLat()}screenPointToMercatorCoordinate(e,o){if(o){const c=o.pointCoordinate(e);if(c!=null)return c}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,o){const c=o||0,h=[e.x,e.y,0,1],m=[e.x,e.y,1,1];a.ao(h,h,this._pixelMatrixInverse),a.ao(m,m,this._pixelMatrixInverse);const v=h[3],w=m[3],T=h[1]/v,P=m[1]/w,A=h[2]/v,D=m[2]/w,L=A===D?0:(c-A)/(D-A);return new a.$(a.B.number(h[0]/v,m[0]/w,L)/this.worldSize,a.B.number(T,P,L)/this.worldSize,c)}coordinatePoint(e,o=0,c=this._pixelMatrix){const h=[e.x*this.worldSize,e.y*this.worldSize,o,1];return a.ao(h,h,c),new a.P(h[0]/h[3],h[1]/h[3])}getBounds(){const e=Math.max(0,this._helper._height/2-un(this));return new Ie().extend(this.screenPointToLocation(new a.P(0,e))).extend(this.screenPointToLocation(new a.P(this._helper._width,e))).extend(this.screenPointToLocation(new a.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new a.P(0,this._helper._height)))}isPointOnMapSurface(e,o){return o?o.pointCoordinate(e)!=null:e.y>this.height/2-un(this)}calculatePosMatrix(e,o=!1,c){var h;const m=(h=e.key)!==null&&h!==void 0?h:a.aW(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),v=o?this._alignedPosMatrixCache:this._posMatrixCache;if(v.has(m)){const P=v.get(m);return c?P.f32:P.f64}const w=Dr(e,this.worldSize);a.N(w,o?this._alignedProjMatrix:this._viewProjMatrix,w);const T={f64:w,f32:new Float32Array(w)};return v.set(m,T),c?T.f32:T.f64}calculateFogMatrix(e){const o=e.key,c=this._fogMatrixCacheF32;if(c.has(o))return c.get(o);const h=Dr(e,this.worldSize);return a.N(h,this._fogMatrix,h),c.set(o,new Float32Array(h)),c.get(o)}getConstrained(e,o){o=a.ad(+o,this.minZoom,this.maxZoom);const c={center:new a.Q(e.lng,e.lat),zoom:o};let h=this._helper._lngRange;this._helper._renderWorldCopies||h!==null||(h=[-179.9999999999,180-1e-10]);const m=this.tileSize*a.aH(c.zoom);let v=0,w=m,T=0,P=m,A=0,D=0;const{x:L,y:U}=this.size;if(this._helper._latRange){const se=this._helper._latRange;v=a.S(se[1])*m,w=a.S(se[0])*m,w-v<U&&(A=U/(w-v))}h&&(T=a.aK(a.U(h[0])*m,0,m),P=a.aK(a.U(h[1])*m,0,m),P<T&&(P+=m),P-T<L&&(D=L/(P-T)));const{x:G,y:J}=ao(m,e);let K,Q;const re=Math.max(D||0,A||0);if(re){const se=new a.P(D?(P+T)/2:G,A?(w+v)/2:J);return c.center=vn(m,se).wrap(),c.zoom+=a.aa(re),c}if(this._helper._latRange){const se=U/2;J-se<v&&(Q=v+se),J+se>w&&(Q=w-se)}if(h){const se=(T+P)/2;let le=G;this._helper._renderWorldCopies&&(le=a.aK(G,se-m/2,se+m/2));const ue=L/2;le-ue<T&&(K=T+ue),le+ue>P&&(K=P-ue)}if(K!==void 0||Q!==void 0){const se=new a.P(K??G,Q??J);c.center=vn(m,se).wrap()}return c}calculateCenterFromCameraLngLatAlt(e,o,c,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,o,c,h)}_calculateNearFarZIfNeeded(e,o,c){if(!this._helper.autoCalculateNearFarZ)return;const h=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),m=e-h*this._helper._pixelPerMeter/Math.cos(o),v=h<0?m:e,w=Math.PI/2+this.pitchInRadians,T=a.ac(this.fov)*(Math.abs(Math.cos(a.ac(this.roll)))*this.height+Math.abs(Math.sin(a.ac(this.roll)))*this.width)/this.height*(.5+c.y/this.height),P=Math.sin(T)*v/Math.sin(a.ad(Math.PI-w-T,.01,Math.PI-.01)),A=un(this),D=Math.atan(A/this._helper.cameraToCenterDistance),L=a.ac(.75),U=D>L?2*D*(.5+c.y/(2*A)):L,G=Math.sin(U)*v/Math.sin(a.ad(Math.PI-w-U,.01,Math.PI-.01)),J=Math.min(P,G);this._helper._farZ=1.01*(Math.cos(Math.PI/2-o)*J+v),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,o=ao(this.worldSize,this.center),c=o.x,h=o.y;this._helper._pixelPerMeter=a.aJ(1,this.center.lat)*this.worldSize;const m=a.ac(Math.min(this.pitch,89.25)),v=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(m));let w;this._calculateNearFarZIfNeeded(v,m,e),w=new Float64Array(16),a.aX(w,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),a.ai(this._invProjMatrix,w),w[8]=2*-e.x/this._helper._width,w[9]=2*e.y/this._helper._height,this._projectionMatrix=a.aY(w),a.M(w,w,[1,-1,1]),a.L(w,w,[0,0,-this._helper.cameraToCenterDistance]),a.aZ(w,w,-this.rollInRadians),a.a_(w,w,this.pitchInRadians),a.aZ(w,w,-this.bearingInRadians),a.L(w,w,[-c,-h,0]),this._mercatorMatrix=a.M([],w,[this.worldSize,this.worldSize,this.worldSize]),a.M(w,w,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=a.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,w),a.L(w,w,[0,0,-this.elevation]),this._viewProjMatrix=w,this._invViewProjMatrix=a.ai([],w);const T=[0,0,-1,1];a.ao(T,T,this._invViewProjMatrix),this._cameraPosition=[T[0]/T[3],T[1]/T[3],T[2]/T[3]],this._fogMatrix=new Float64Array(16),a.aX(this._fogMatrix,this.fovInRadians,this.width/this.height,v,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,a.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),a.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),a.aZ(this._fogMatrix,this._fogMatrix,-this.rollInRadians),a.a_(this._fogMatrix,this._fogMatrix,this.pitchInRadians),a.aZ(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),a.L(this._fogMatrix,this._fogMatrix,[-c,-h,0]),a.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),a.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=a.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,w);const P=this._helper._width%2/2,A=this._helper._height%2/2,D=Math.cos(this.bearingInRadians),L=Math.sin(-this.bearingInRadians),U=c-Math.round(c)+D*P+L*A,G=h-Math.round(h)+D*A+L*P,J=new Float64Array(w);if(a.L(J,J,[U>.5?U-1:U,G>.5?G-1:G,0]),this._alignedProjMatrix=J,w=a.ai(new Float64Array(16),this._pixelMatrix),!w)throw new Error("failed to invert matrix");this._pixelMatrixInverse=w,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new a.P(0,0)),o=[e.x*this.worldSize,e.y*this.worldSize,0,1];return a.ao(o,o,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=a.aJ(1,this.center.lat)*this.worldSize;return ic(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,o){const c=a.$.fromLngLat(e),h=[c.x*this.worldSize,c.y*this.worldSize,o,1];return a.ao(h,h,this._viewProjMatrix),h[2]/h[3]}getProjectionData(e){const{overscaledTileID:o,aligned:c,applyTerrainMatrix:h}=e,m=this._helper.getMercatorTileCoordinates(o),v=o?this.calculatePosMatrix(o,c,!0):null;let w;return w=o&&o.terrainRttPosMatrix32f&&h?o.terrainRttPosMatrix32f:v||a.a$(),{mainMatrix:w,tileMercatorCoords:m,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:w}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,o,c){return 1}transformLightDirection(e){return a.aP(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,o,c,h){const m=this.calculatePosMatrix(c);let v;h?(v=[e,o,h(e,o),1],a.ao(v,v,m)):(v=[e,o,0,1],Qr(v,v,m));const w=v[3];return{point:new a.P(v[0]/w,v[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}populateCache(e){for(const o of e)this.calculatePosMatrix(o)}getMatrixForModel(e,o){const c=a.$.fromLngLat(e,o),h=c.meterInMercatorCoordinateUnits(),m=a.b0();return a.L(m,m,[c.x,c.y,c.z]),a.aZ(m,m,Math.PI),a.a_(m,m,Math.PI/2),a.M(m,m,[-h,h,h]),m}getProjectionDataForCustomLayer(e=!0){const o=new a.Y(0,0,0,0,0),c=this.getProjectionData({overscaledTileID:o,applyGlobeMatrix:e}),h=Dr(o,this.worldSize);a.N(h,this._viewProjMatrix,h),c.tileMercatorCoords=[0,0,1,1];const m=[a.Z,a.Z,this.worldSize/this._helper.pixelsPerMeter],v=a.b1();return a.M(v,h,m),c.fallbackMatrix=v,c.mainMatrix=v,c}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Vs(){a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function co(p){if(p.useSlerp)if(p.k<1){const e=a.b2(p.startEulerAngles.roll,p.startEulerAngles.pitch,p.startEulerAngles.bearing),o=a.b2(p.endEulerAngles.roll,p.endEulerAngles.pitch,p.endEulerAngles.bearing),c=new Float64Array(4);a.b3(c,e,o,p.k);const h=a.b4(c);p.tr.setRoll(h.roll),p.tr.setPitch(h.pitch),p.tr.setBearing(h.bearing)}else p.tr.setRoll(p.endEulerAngles.roll),p.tr.setPitch(p.endEulerAngles.pitch),p.tr.setBearing(p.endEulerAngles.bearing);else p.tr.setRoll(a.B.number(p.startEulerAngles.roll,p.endEulerAngles.roll,p.k)),p.tr.setPitch(a.B.number(p.startEulerAngles.pitch,p.endEulerAngles.pitch,p.k)),p.tr.setBearing(a.B.number(p.startEulerAngles.bearing,p.endEulerAngles.bearing,p.k))}function sc(p,e,o,c,h){const m=h.padding,v=ao(h.worldSize,o.getNorthWest()),w=ao(h.worldSize,o.getNorthEast()),T=ao(h.worldSize,o.getSouthEast()),P=ao(h.worldSize,o.getSouthWest()),A=a.ac(-c),D=v.rotate(A),L=w.rotate(A),U=T.rotate(A),G=P.rotate(A),J=new a.P(Math.max(D.x,L.x,G.x,U.x),Math.max(D.y,L.y,G.y,U.y)),K=new a.P(Math.min(D.x,L.x,G.x,U.x),Math.min(D.y,L.y,G.y,U.y)),Q=J.sub(K),re=(h.width-(m.left+m.right+e.left+e.right))/Q.x,se=(h.height-(m.top+m.bottom+e.top+e.bottom))/Q.y;if(se<0||re<0)return void Vs();const le=Math.min(a.aa(h.scale*Math.min(re,se)),p.maxZoom),ue=a.P.convert(p.offset),fe=new a.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(a.ac(c)),he=ue.add(fe).mult(h.scale/a.aH(le));return{center:vn(h.worldSize,v.add(T).div(2).sub(he)),zoom:le,bearing:c}}class So{get useGlobeControls(){return!1}handlePanInertia(e,o){return{easingOffset:e,easingCenter:o.center}}handleMapControlsRollPitchBearingZoom(e,o){e.bearingDelta&&o.setBearing(o.bearing+e.bearingDelta),e.pitchDelta&&o.setPitch(o.pitch+e.pitchDelta),e.rollDelta&&o.setRoll(o.roll+e.rollDelta),e.zoomDelta&&o.setZoom(o.zoom+e.zoomDelta)}handleMapControlsPan(e,o,c){e.around.distSqr(o.centerPoint)<.01||o.setLocationAtPoint(c,e.around)}cameraForBoxAndBearing(e,o,c,h,m){return sc(e,o,c,h,m)}handleJumpToCenterZoom(e,o){e.zoom!==(o.zoom!==void 0?+o.zoom:e.zoom)&&e.setZoom(+o.zoom),o.center!==void 0&&e.setCenter(a.Q.convert(o.center))}handleEaseTo(e,o){const c=e.zoom,h=e.padding,m={roll:e.roll,pitch:e.pitch,bearing:e.bearing},v={roll:o.roll===void 0?e.roll:o.roll,pitch:o.pitch===void 0?e.pitch:o.pitch,bearing:o.bearing===void 0?e.bearing:o.bearing},w=o.zoom!==void 0,T=!e.isPaddingEqual(o.padding);let P=!1;const A=w?+o.zoom:e.zoom;let D=e.centerPoint.add(o.offsetAsPoint);const L=e.screenPointToLocation(D),{center:U,zoom:G}=e.getConstrained(a.Q.convert(o.center||L),A??c);zn(e,U);const J=ao(e.worldSize,L),K=ao(e.worldSize,U).sub(J),Q=a.aH(G-c);return P=G!==c,{easeFunc:re=>{if(P&&e.setZoom(a.B.number(c,G,re)),a.b5(m,v)||co({startEulerAngles:m,endEulerAngles:v,tr:e,k:re,useSlerp:m.roll!=v.roll}),T&&(e.interpolatePadding(h,o.padding,re),D=e.centerPoint.add(o.offsetAsPoint)),o.around)e.setLocationAtPoint(o.around,o.aroundPoint);else{const se=a.aH(e.zoom-c),le=G>c?Math.min(2,Q):Math.max(.5,Q),ue=Math.pow(le,1-re),fe=vn(e.worldSize,J.add(K.mult(re*ue)).mult(se));e.setLocationAtPoint(e.renderWorldCopies?fe.wrap():fe,D)}},isZooming:P,elevationCenter:U}}handleFlyTo(e,o){const c=o.zoom!==void 0,h=e.zoom,m=e.getConstrained(a.Q.convert(o.center||o.locationAtOffset),c?+o.zoom:h),v=m.center,w=m.zoom;zn(e,v);const T=ao(e.worldSize,o.locationAtOffset),P=ao(e.worldSize,v).sub(T),A=P.mag(),D=a.aH(w-h);let L;if(o.minZoom!==void 0){const U=Math.min(+o.minZoom,h,w),G=e.getConstrained(v,U).zoom;L=a.aH(G-h)}return{easeFunc:(U,G,J,K)=>{e.setZoom(U===1?w:h+a.aa(G));const Q=U===1?v:vn(e.worldSize,T.add(P.mult(J)).mult(G));e.setLocationAtPoint(e.renderWorldCopies?Q.wrap():Q,K)},scaleOfZoom:D,targetCenter:v,scaleOfMinZoom:L,pixelPathLength:A}}}class Sr{constructor(e,o,c){this.blendFunction=e,this.blendColor=o,this.mask=c}}Sr.Replace=[1,0],Sr.disabled=new Sr(Sr.Replace,a.b6.transparent,[!1,!1,!1,!1]),Sr.unblended=new Sr(Sr.Replace,a.b6.transparent,[!0,!0,!0,!0]),Sr.alphaBlended=new Sr([1,771],a.b6.transparent,[!0,!0,!0,!0]);const Aa=2305;class Xt{constructor(e,o,c){this.enable=e,this.mode=o,this.frontFace=c}}Xt.disabled=new Xt(!1,1029,Aa),Xt.backCCW=new Xt(!0,1029,Aa),Xt.frontCCW=new Xt(!0,1028,Aa);class $t{constructor(e,o,c){this.func=e,this.mask=o,this.range=c}}$t.ReadOnly=!1,$t.ReadWrite=!0,$t.disabled=new $t(519,$t.ReadOnly,[0,1]);const ns=7680;class Kt{constructor(e,o,c,h,m,v){this.test=e,this.ref=o,this.mask=c,this.fail=h,this.depthFail=m,this.pass=v}}Kt.disabled=new Kt({func:519,mask:0},0,0,ns,ns,ns);const Us=new WeakMap;function uo(p){var e;if(Us.has(p))return Us.get(p);{const o=(e=p.getParameter(p.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Us.set(p,o),o}}class Zs{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const o=e.context,c=o.gl;this._texFormat=c.RGBA,this._texType=c.UNSIGNED_BYTE;const h=new a.aE;h.emplaceBack(-1,-1),h.emplaceBack(2,-1),h.emplaceBack(-1,2);const m=new a.aG;m.emplaceBack(0,1,2),this._fullscreenTriangle=new Wn(o.createVertexBuffer(h,so.members),o.createIndexBuffer(m),a.aF.simpleSegment(0,0,h.length,m.length)),this._resultBuffer=new Uint8Array(4),o.activeTexture.set(c.TEXTURE1);const v=c.createTexture();c.bindTexture(c.TEXTURE_2D,v),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texImage2D(c.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=o.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(v),uo(c)&&(this._pbo=c.createBuffer(),c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.bufferData(c.PIXEL_PACK_BUFFER,4,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,o){const c=this._updateCount;return this._readbackQueue?c>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():c>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,o),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,o=e.gl;e.activeTexture.set(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,o){const c=this._cachedRenderContext.context,h=c.gl;if(this._bindFramebuffer(),c.viewport.set([0,0,this._texWidth,this._texHeight]),c.clear({color:a.b6.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(c,h.TRIANGLES,$t.disabled,Kt.disabled,Sr.unblended,Xt.disabled,((m,v)=>({u_input:m,u_output_expected:v}))(e,o),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&uo(h)){h.bindBuffer(h.PIXEL_PACK_BUFFER,this._pbo),h.readBuffer(h.COLOR_ATTACHMENT0),h.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),h.bindBuffer(h.PIXEL_PACK_BUFFER,null);const m=h.fenceSync(h.SYNC_GPU_COMMANDS_COMPLETE,0);h.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:m}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&uo(e)){const o=e.clientWaitSync(this._readbackQueue.sync,0,0);if(o===e.WAIT_FAILED)return a.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(o===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Zs._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let o=0;return o+=e[0]/256,o+=e[1]/65536,o+=e[2]/16777216,e[3]<127&&(o=-o),o/128}}const za=a.Z/128;function Gs(p,e){const o=p.granularity!==void 0?Math.max(p.granularity,1):1,c=o+(p.generateBorders?2:0),h=o+(p.extendToNorthPole||p.generateBorders?1:0)+(p.extendToSouthPole||p.generateBorders?1:0),m=c+1,v=h+1,w=p.generateBorders?-1:0,T=p.generateBorders||p.extendToNorthPole?-1:0,P=o+(p.generateBorders?1:0),A=o+(p.generateBorders||p.extendToSouthPole?1:0),D=m*v,L=c*h*6,U=m*v>65536;if(U&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const G=U||e==="32bit",J=new Int16Array(2*D);let K=0;for(let se=T;se<=A;se++)for(let le=w;le<=P;le++){let ue=le/o*a.Z;le===-1&&(ue=-64),le===o+1&&(ue=a.Z+za);let fe=se/o*a.Z;se===-1&&(fe=p.extendToNorthPole?a.b8:-64),se===o+1&&(fe=p.extendToSouthPole?a.b9:a.Z+za),J[K++]=ue,J[K++]=fe}const Q=G?new Uint32Array(L):new Uint16Array(L);let re=0;for(let se=0;se<h;se++)for(let le=0;le<c;le++){const ue=le+1+se*m,fe=le+(se+1)*m,he=le+1+(se+1)*m;Q[re++]=le+se*m,Q[re++]=fe,Q[re++]=ue,Q[re++]=ue,Q[re++]=fe,Q[re++]=he}return{vertices:J.buffer.slice(0),indices:Q.buffer.slice(0),uses32bitIndices:G}}const os=new a.aD({fill:new a.ba(128,2),line:new a.ba(512,0),tile:new a.ba(128,32),stencil:new a.ba(128,1),circle:3});class is{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return wo.projectionGlobe}get vertexShaderPreludeCode(){return wo.projectionMercator.vertexSource}get subdivisionGranularity(){return os}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Zs(e));const o=a.S(this._errorQueryLatitudeDegrees),c=2*Math.atan(Math.exp(Math.PI-o*Math.PI*2))-.5*Math.PI,h=this._errorMeasurement.updateErrorLoop(o,c),m=q.now();h!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=h,this._errorMeasurementLastChangeTime=m);const v=Math.min(Math.max((m-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=a.bb(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,a.bc(v))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,o,c,h,m){const v=(m==="stencil"?os.stencil:os.tile).getGranularityForZoomLevel(o.z);return this._getMesh(e,{granularity:v,generateBorders:c,extendToNorthPole:o.y===0&&h,extendToSouthPole:o.y===(1<<o.z)-1&&h})}_getMesh(e,o){const c=this._getMeshKey(o);if(c in this._tileMeshCache)return this._tileMeshCache[c];const h=function(m,v){const w=Gs(v,"16bit"),T=a.aE.deserialize({arrayBuffer:w.vertices,length:w.vertices.byteLength/2/2}),P=a.aG.deserialize({arrayBuffer:w.indices,length:w.indices.byteLength/2/3});return new Wn(m.createVertexBuffer(T,so.members),m.createIndexBuffer(P),a.aF.simpleSegment(0,0,T.length,P.length))}(e,o);return this._tileMeshCache[c]=h,h}recalculate(e){}hasTransition(){const e=q.now();let o=!1;return o=o||(e-this._errorMeasurementLastChangeTime)/1e3<.7,o=o||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,o}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Sf=new a.r({type:new a.D(a.v.projection.type)});class Ra extends a.E{constructor(e){super(),this._transitionable=new a.T(Sf),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.C(0)),this._mercatorProjection=new oc,this._verticalPerspectiveProjection=new is}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof a.bd){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,o,c,h,m){return this.currentProjection.getMeshFromTileID(e,o,c,h,m)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function ac(p){const e=Mn(p.worldSize,p.center.lat);return 2*Math.PI*e}function qs(p,e,o,c,h){const m=1/(1<<h),v=e/a.Z*m+c*m,w=a.bf((p/a.Z*m+o*m)*Math.PI*2+Math.PI,2*Math.PI),T=2*Math.atan(Math.exp(Math.PI-v*Math.PI*2))-.5*Math.PI,P=Math.cos(T),A=new Float64Array(3);return A[0]=Math.sin(w)*P,A[1]=Math.sin(T),A[2]=Math.cos(w)*P,A}function Pn(p){return function(e,o){const c=Math.cos(o),h=new Float64Array(3);return h[0]=Math.sin(e)*c,h[1]=Math.sin(o),h[2]=Math.cos(e)*c,h}(p.lng*Math.PI/180,p.lat*Math.PI/180)}function Mn(p,e){return p/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Da(p){const e=Math.asin(p[1])/Math.PI*180,o=Math.sqrt(p[0]*p[0]+p[2]*p[2]);if(o>1e-6){const c=p[0]/o,h=Math.acos(p[2]/o),m=(c>0?h:-h)/Math.PI*180;return new a.Q(a.aK(m,-180,180),e)}return new a.Q(0,e)}function Hn(p){return Math.cos(p*Math.PI/180)}function Ur(p,e){const o=Hn(p),c=Hn(e);return a.aa(c/o)}function lc(p,e){const o=p.rotate(e.bearingInRadians),c=e.zoom+Ur(e.center.lat,0),h=a.bb(1/Hn(e.center.lat),1/Hn(Math.min(Math.abs(e.center.lat),60)),a.be(c,7,3,0,1)),m=360/ac({worldSize:e.worldSize,center:{lat:e.center.lat}});return new a.Q(e.center.lng-o.x*m*h,a.ad(e.center.lat+o.y*m,-85.051129,a.aI))}function La(p){const e=.5*p,o=Math.sin(e),c=Math.cos(e);return Math.log(o+c)-Math.log(c-o)}function Si(p,e,o,c){const h=p.lat+o*c;if(Math.abs(o)>1){const m=(Math.sign(p.lat+o)!==Math.sign(p.lat)?-Math.abs(p.lat):Math.abs(p.lat))*Math.PI/180,v=Math.abs(p.lat+o)*Math.PI/180,w=La(m+c*(v-m)),T=La(m),P=La(v);return new a.Q(p.lng+e*((w-T)/(P-T)),h)}return new a.Q(p.lng+e*c,h)}class Tf{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,o,c,h){const m=`${e.z}_${e.x}_${e.y}`,v=this._cache.get(m);if(v)return v;const w=this._cachePrevious.get(m);if(w)return this._cache.set(m,w),w;const T=this._aabbFactory(e,o,c,h);return this._cache.set(m,T),this._hadAnyChanges=!0,T}}function Ba(p,e,o){const c=p-e;return c<0?-c:Math.max(0,c-o)}function cc(p,e,o,c,h){const m=p-o;let v;return v=m<0?Math.min(-m,1+m-h):m>1?Math.min(Math.max(m-h,0),1-m):0,Math.max(v,Ba(e,c,h))}class kf{constructor(){this._aabbCache=new Tf(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,o,c,h){const m=1<<c.z,v=1/m,w=c.x/m,T=c.y/m;let P=2;return P=Math.min(P,cc(e,o,w,T,v)),P=Math.min(P,cc(e,o,w+.5,-T-v,v)),P=Math.min(P,cc(e,o,w+.5,2-T-v,v)),P}getWrap(e,o,c){const h=1<<o.z,m=1/h,v=o.x/h,w=Ba(e.x,v,m),T=Ba(e.x,v-1,m),P=Ba(e.x,v+1,m),A=Math.min(w,T,P);return A===P?1:A===T?-1:0}allowVariableZoom(e,o){return io(e,o)>4}allowWorldCopies(){return!1}getTileAABB(e,o,c,h){return this._aabbCache.getTileAABB(e,o,c,h)}_computeTileAABB(e,o,c,h){if(e.z<=0)return new Co([-1,-1,-1],[1,1,1]);if(e.z===1)return new Co([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const m=[qs(0,0,e.x,e.y,e.z),qs(a.Z,0,e.x,e.y,e.z),qs(a.Z,a.Z,e.x,e.y,e.z),qs(0,a.Z,e.x,e.y,e.z)],v=[1,1,1],w=[-1,-1,-1];for(const T of m)for(let P=0;P<3;P++)v[P]=Math.min(v[P],T[P]),w[P]=Math.max(w[P],T[P]);if(e.y===0||e.y===(1<<e.z)-1){const T=[0,e.y===0?1:-1,0];for(let P=0;P<3;P++)v[P]=Math.min(v[P],T[P]),w[P]=Math.max(w[P],T[P])}return new Co(v,w)}}}class $a{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,o,c){return this._helper.interpolatePadding(e,o,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,o){this._helper.resize(e,o)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,o){this._helper.overrideNearFarZ(e,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=a.bg(),this._projectionMatrix=a.b0(),this._globeViewProjMatrix32f=a.a$(),this._globeViewProjMatrixNoCorrection=a.b0(),this._globeViewProjMatrixNoCorrectionInverted=a.b0(),this._globeProjMatrixInverted=a.b0(),this._cameraPosition=a.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Ea({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,o)=>this.getConstrained(e,o)}),this._coveringTilesDetailsProvider=new kf}clone(){const e=new $a;return e.apply(this),e}apply(e,o){this._globeLatitudeErrorCorrectionRadians=o||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=a.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:o,applyGlobeMatrix:c}=e,h=this._helper.getMercatorTileCoordinates(o);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:h,clippingPlane:this._cachedClippingPlane,projectionTransition:c?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const o=this.pitchInRadians,c=this.cameraToCenterDistance/e,h=Math.sin(o)*c,m=Math.cos(o)*c+1,v=1/Math.sqrt(h*h+m*m)*1;let w=-h,T=m;const P=Math.sqrt(w*w+T*T);w/=P,T/=P;const A=[0,w,T];return a.bi(A,A,[0,0,0],-this.bearingInRadians),a.bj(A,A,[0,0,0],-1*this.center.lat*Math.PI/180),a.bk(A,A,[0,0,0],this.center.lng*Math.PI/180),a.aN(A,A,.25),[...A,.25*-v]}isLocationOccluded(e){return!this.isSurfacePointVisible(Pn(e))}transformLightDirection(e){const o=this._helper._center.lng*Math.PI/180,c=this._helper._center.lat*Math.PI/180,h=Math.cos(c),m=[Math.sin(o)*h,Math.sin(c),Math.cos(o)*h],v=[m[2],0,-m[0]],w=[0,0,0];a.aT(w,v,m),a.aS(v,v),a.aS(w,w);const T=[0,0,0];return a.aS(T,[v[0]*e[0]+w[0]*e[1]+m[0]*e[2],v[1]*e[0]+w[1]*e[1]+m[1]*e[2],v[2]*e[0]+w[2]*e[1]+m[2]*e[2]]),T}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,o,c){const h=function(w,T,P){const A=1/(1<<P.z);return new a.$(w/a.Z*A+P.x*A,T/a.Z*A+P.y*A)}(e,o,c.canonical),m=(v=h.y,[a.bf(h.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-v*Math.PI*2))-.5*Math.PI]);var v;return this.getCircleRadiusCorrection()/Math.cos(m[1])}projectTileCoordinates(e,o,c,h){const m=c.canonical,v=qs(e,o,m.x,m.y,m.z),w=1+(h?h(e,o):0)/a.bq,T=[v[0]*w,v[1]*w,v[2]*w,1];a.ao(T,T,this._globeViewProjMatrixNoCorrection);const P=this._cachedClippingPlane,A=P[0]*v[0]+P[1]*v[1]+P[2]*v[2]+P[3]<0;return{point:new a.P(T[0]/T[3],T[1]/T[3]),signedDistanceFromCamera:T[3],isOccluded:A}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Mn(this.worldSize,this.center.lat),o=a.b1(),c=a.b1();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),a.aX(o,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const h=this.centerOffset;o[8]=2*-h.x/this._helper._width,o[9]=2*h.y/this._helper._height,this._projectionMatrix=a.aY(o),this._globeProjMatrixInverted=a.b1(),a.ai(this._globeProjMatrixInverted,o),a.L(o,o,[0,0,-this.cameraToCenterDistance]),a.aZ(o,o,this.rollInRadians),a.a_(o,o,-this.pitchInRadians),a.aZ(o,o,this.bearingInRadians),a.L(o,o,[0,0,-e]);const m=a.bh();m[0]=e,m[1]=e,m[2]=e,a.a_(c,o,this.center.lat*Math.PI/180),a.bl(c,c,-this.center.lng*Math.PI/180),a.M(c,c,m),this._globeViewProjMatrixNoCorrection=c,a.a_(o,o,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),a.bl(o,o,-this.center.lng*Math.PI/180),a.M(o,o,m),this._globeViewProjMatrix32f=new Float32Array(o),this._globeViewProjMatrixNoCorrectionInverted=a.b1(),a.ai(this._globeViewProjMatrixNoCorrectionInverted,c);const v=a.bh();this._cameraPosition=a.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,a.bi(this._cameraPosition,this._cameraPosition,v,-this.rollInRadians),a.bj(this._cameraPosition,this._cameraPosition,v,this.pitchInRadians),a.bi(this._cameraPosition,this._cameraPosition,v,-this.bearingInRadians),a.aO(this._cameraPosition,this._cameraPosition,[0,0,1]),a.bj(this._cameraPosition,this._cameraPosition,v,-this.center.lat*Math.PI/180),a.bk(this._cameraPosition,this._cameraPosition,v,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const w=a.aY(this._globeViewProjMatrixNoCorrectionInverted);a.M(w,w,[1,1,-1]),this._cachedFrustum=si.fromInvProjectionMatrix(w)}calculateFogMatrix(e){a.w("calculateFogMatrix is not supported on globe projection.");const o=a.b1();return a.as(o),o}getVisibleUnwrappedCoordinates(e){return[new a.aV(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&a.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,o){if(!this._globeViewProjMatrixNoCorrection)return 1;const c=Pn(e);a.aN(c,c,1+o/a.bq);const h=a.bg();return a.ao(h,[c[0],c[1],c[2],1],this._globeViewProjMatrixNoCorrection),h[2]/h[3]}populateCache(e){}getBounds(){const e=.5*this.width,o=.5*this.height,c=[new a.P(0,0),new a.P(e,0),new a.P(this.width,0),new a.P(this.width,o),new a.P(this.width,this.height),new a.P(e,this.height),new a.P(0,this.height),new a.P(0,o)],h=[];for(const D of c)h.push(this.unprojectScreenPoint(D));let m=0,v=0,w=0,T=0;const P=this.center;for(const D of h){const L=a.bm(P.lng,D.lng),U=a.bm(P.lat,D.lat);L<v&&(v=L),L>m&&(m=L),U<T&&(T=U),U>w&&(w=U)}const A=[P.lng+v,P.lat+T,P.lng+m,P.lat+w];return this.isSurfacePointOnScreen([0,1,0])&&(A[3]=90,A[0]=-180,A[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(A[1]=-90,A[0]=-180,A[2]=180),new Ie(A)}getConstrained(e,o){const c=a.ad(e.lat,-85.051129,a.aI),h=a.ad(+o,this.minZoom+Ur(0,c),this.maxZoom);return{center:new a.Q(e.lng,c),zoom:h}}calculateCenterFromCameraLngLatAlt(e,o,c,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,o,c,h)}setLocationAtPoint(e,o){const c=Pn(this.unprojectScreenPoint(o)),h=Pn(e),m=a.bh();a.bn(m);const v=a.bh();a.bk(v,c,m,-this.center.lng*Math.PI/180),a.bj(v,v,m,this.center.lat*Math.PI/180);const w=h[0]*h[0]+h[2]*h[2],T=v[0]*v[0];if(w<T)return;const P=Math.sqrt(w-T),A=-P,D=a.bo(h[0],h[2],v[0],P),L=a.bo(h[0],h[2],v[0],A),U=a.bh();a.bk(U,h,m,-D);const G=a.bo(U[1],U[2],v[1],v[2]),J=a.bh();a.bk(J,h,m,-L);const K=a.bo(J[1],J[2],v[1],v[2]),Q=.5*Math.PI,re=G>=-Q&&G<=Q,se=K>=-Q&&K<=Q;let le,ue;if(re&&se){const Se=this.center.lng*Math.PI/180,Re=this.center.lat*Math.PI/180;a.br(D,Se)+a.br(G,Re)<a.br(L,Se)+a.br(K,Re)?(le=D,ue=G):(le=L,ue=K)}else if(re)le=D,ue=G;else{if(!se)return;le=L,ue=K}const fe=le/Math.PI*180,he=ue/Math.PI*180,we=this.center.lat;this.setCenter(new a.Q(fe,a.ad(he,-90,90))),this.setZoom(this.zoom+Ur(we,this.center.lat))}locationToScreenPoint(e,o){const c=Pn(e);if(o){const h=o.getElevationForLngLatZoom(e,this._helper._tileZoom);a.aN(c,c,1+h/a.bq)}return this._projectSurfacePointToScreen(c)}_projectSurfacePointToScreen(e){const o=a.bg();return a.ao(o,[...e,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],new a.P((.5*o[0]+.5)*this.width,(.5*-o[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,o){if(o){const c=o.pointCoordinate(e);if(c)return c}return a.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,o){var c;return(c=this.screenPointToMercatorCoordinate(e,o))===null||c===void 0?void 0:c.toLngLat()}isPointOnMapSurface(e,o){const c=this._cameraPosition,h=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(c,h)}getRayDirectionFromPixel(e){const o=a.bg();o[0]=e.x/this.width*2-1,o[1]=-1*(e.y/this.height*2-1),o[2]=1,o[3]=1,a.ao(o,o,this._globeViewProjMatrixNoCorrectionInverted),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3];const c=a.bh();c[0]=o[0]-this._cameraPosition[0],c[1]=o[1]-this._cameraPosition[1],c[2]=o[2]-this._cameraPosition[2];const h=a.bh();return a.aS(h,c),h}isSurfacePointVisible(e){const o=this._cachedClippingPlane;return o[0]*e[0]+o[1]*e[1]+o[2]*e[2]+o[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const o=a.bg();return a.ao(o,[...e,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3],o[0]>-1&&o[0]<1&&o[1]>-1&&o[1]<1&&o[2]>-1&&o[2]<1}rayPlanetIntersection(e,o){const c=a.aU(e,o),h=a.bh(),m=a.bh();a.aN(m,o,c),a.aR(h,e,m);const v=1-a.aU(h,h);if(v<0)return null;const w=a.aU(e,e)-1,T=-c+(c<0?1:-1)*Math.sqrt(v),P=w/T,A=T;return{tMin:Math.min(P,A),tMax:Math.max(P,A)}}unprojectScreenPoint(e){const o=this._cameraPosition,c=this.getRayDirectionFromPixel(e),h=this.rayPlanetIntersection(o,c);if(h){const P=a.bh();a.aO(P,o,[c[0]*h.tMin,c[1]*h.tMin,c[2]*h.tMin]);const A=a.bh();return a.aS(A,P),Da(A)}const m=this._cachedClippingPlane[0]*c[0]+this._cachedClippingPlane[1]*c[1]+this._cachedClippingPlane[2]*c[2],v=-a.bp(this._cachedClippingPlane,o)/m,w=a.bh();if(v>0)a.aO(w,o,[c[0]*v,c[1]*v,c[2]*v]);else{const P=a.bh();a.aO(P,o,[2*c[0],2*c[1],2*c[2]]);const A=a.bp(this._cachedClippingPlane,P);a.aR(w,P,[this._cachedClippingPlane[0]*A,this._cachedClippingPlane[1]*A,this._cachedClippingPlane[2]*A])}const T=a.bh();return a.aS(T,w),Da(T)}getMatrixForModel(e,o){const c=a.Q.convert(e),h=1/a.bq,m=a.b0();return a.bl(m,m,c.lng/180*Math.PI),a.a_(m,m,-c.lat/180*Math.PI),a.L(m,m,[0,0,1+o/a.bq]),a.a_(m,m,.5*Math.PI),a.M(m,m,[h,h,h]),m}getProjectionDataForCustomLayer(e=!0){const o=this.getProjectionData({overscaledTileID:new a.Y(0,0,0,0,0),applyGlobeMatrix:e});return o.tileMercatorCoords=[0,0,1,1],o}getFastPathSimpleProjectionMatrix(e){}}class Oa{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,o,c){return this._helper.interpolatePadding(e,o,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,o,c=!0){this._helper.resize(e,o,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,o){this._helper.overrideNearFarZ(e,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,o){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=o,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Ea({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,o)=>this.getConstrained(e,o)}),this._globeness=1,this._mercatorTransform=new lo,this._verticalPerspectiveTransform=new $a}clone(){const e=new Oa;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const o=this._mercatorTransform.getProjectionData(e),c=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?c.mainMatrix:o.mainMatrix,clippingPlane:c.clippingPlane,tileMercatorCoords:c.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:o.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return a.bb(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return a.bb(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,o,c){const h=this._mercatorTransform.getPitchedTextCorrection(e,o,c),m=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,o,c);return a.bb(h,m,this._globeness)}projectTileCoordinates(e,o,c,h){return this.currentTransform.projectTileCoordinates(e,o,c,h)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,o){return this.currentTransform.lngLatToCameraDepth(e,o)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,o){return this.currentTransform.getConstrained(e,o)}calculateCenterFromCameraLngLatAlt(e,o,c,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,o,c,h)}setLocationAtPoint(e,o){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,o),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,o),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,o){return this.currentTransform.locationToScreenPoint(e,o)}screenPointToMercatorCoordinate(e,o){return this.currentTransform.screenPointToMercatorCoordinate(e,o)}screenPointToLocation(e,o){return this.currentTransform.screenPointToLocation(e,o)}isPointOnMapSurface(e,o){return this.currentTransform.isPointOnMapSurface(e,o)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,o){return this.currentTransform.getMatrixForModel(e,o)}getProjectionDataForCustomLayer(e=!0){const o=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return o;const c=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return c.fallbackMatrix=o.mainMatrix,c}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class On{get useGlobeControls(){return!0}handlePanInertia(e,o){const c=lc(e,o);return Math.abs(c.lng-o.center.lng)>180&&(c.lng=o.center.lng+179.5*Math.sign(c.lng-o.center.lng)),{easingCenter:c,easingOffset:new a.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,o){const c=e.around,h=o.screenPointToLocation(c);e.bearingDelta&&o.setBearing(o.bearing+e.bearingDelta),e.pitchDelta&&o.setPitch(o.pitch+e.pitchDelta),e.rollDelta&&o.setRoll(o.roll+e.rollDelta);const m=o.zoom;e.zoomDelta&&o.setZoom(o.zoom+e.zoomDelta);const v=o.zoom-m;if(v===0)return;const w=a.bm(o.center.lng,h.lng),T=w/(Math.abs(w/180)+1),P=a.bm(o.center.lat,h.lat),A=o.getRayDirectionFromPixel(c),D=o.cameraPosition,L=-1*a.aU(D,A),U=a.bh();a.aO(U,D,[A[0]*L,A[1]*L,A[2]*L]);const G=a.bs(U)-1,J=Math.exp(.5*-Math.max(G-.3,0)),K=Mn(o.worldSize,o.center.lat)/Math.min(o.width,o.height),Q=a.be(K,.9,.5,1,.25),re=(1-a.aH(-v))*Math.min(J,Q),se=o.center.lat,le=o.zoom,ue=new a.Q(o.center.lng+T*re,a.ad(o.center.lat+P*re,-85.051129,a.aI));o.setLocationAtPoint(h,c);const fe=o.center,he=a.be(Math.abs(w),45,85,0,1),we=a.be(K,.75,.35,0,1),Se=Math.pow(Math.max(he,we),.25),Re=a.bm(fe.lng,ue.lng),Le=a.bm(fe.lat,ue.lat);o.setCenter(new a.Q(fe.lng+Re*Se,fe.lat+Le*Se).wrap()),o.setZoom(le+Ur(se,o.center.lat))}handleMapControlsPan(e,o,c){if(!e.panDelta)return;const h=o.center.lat,m=o.zoom;o.setCenter(lc(e.panDelta,o).wrap()),o.setZoom(m+Ur(h,o.center.lat))}cameraForBoxAndBearing(e,o,c,h,m){const v=sc(e,o,c,h,m),w=o.left/m.width*2-1,T=(m.width-o.right)/m.width*2-1,P=o.top/m.height*-2+1,A=(m.height-o.bottom)/m.height*-2+1,D=a.bm(c.getWest(),c.getEast())<0,L=D?c.getEast():c.getWest(),U=D?c.getWest():c.getEast(),G=Math.max(c.getNorth(),c.getSouth()),J=Math.min(c.getNorth(),c.getSouth()),K=L+.5*a.bm(L,U),Q=G+.5*a.bm(G,J),re=m.clone();re.setCenter(v.center),re.setBearing(v.bearing),re.setPitch(0),re.setRoll(0),re.setZoom(v.zoom);const se=re.modelViewProjectionMatrix,le=[Pn(c.getNorthWest()),Pn(c.getNorthEast()),Pn(c.getSouthWest()),Pn(c.getSouthEast()),Pn(new a.Q(U,Q)),Pn(new a.Q(L,Q)),Pn(new a.Q(K,G)),Pn(new a.Q(K,J))],ue=Pn(v.center);let fe=Number.POSITIVE_INFINITY;for(const he of le)w<0&&(fe=On.getLesserNonNegativeNonNull(fe,On.solveVectorScale(he,ue,se,"x",w))),T>0&&(fe=On.getLesserNonNegativeNonNull(fe,On.solveVectorScale(he,ue,se,"x",T))),P>0&&(fe=On.getLesserNonNegativeNonNull(fe,On.solveVectorScale(he,ue,se,"y",P))),A<0&&(fe=On.getLesserNonNegativeNonNull(fe,On.solveVectorScale(he,ue,se,"y",A)));if(Number.isFinite(fe)&&fe!==0)return v.zoom=re.zoom+a.aa(fe),v;Vs()}handleJumpToCenterZoom(e,o){const c=e.center.lat,h=e.getConstrained(o.center?a.Q.convert(o.center):e.center,e.zoom).center;e.setCenter(h.wrap());const m=o.zoom!==void 0?+o.zoom:e.zoom+Ur(c,h.lat);e.zoom!==m&&e.setZoom(m)}handleEaseTo(e,o){const c=e.zoom,h=e.center,m=e.padding,v={roll:e.roll,pitch:e.pitch,bearing:e.bearing},w={roll:o.roll===void 0?e.roll:o.roll,pitch:o.pitch===void 0?e.pitch:o.pitch,bearing:o.bearing===void 0?e.bearing:o.bearing},T=o.zoom!==void 0,P=!e.isPaddingEqual(o.padding);let A=!1;const D=o.center?a.Q.convert(o.center):h,L=e.getConstrained(D,c).center;zn(e,L);const U=e.clone();U.setCenter(L),U.setZoom(T?+o.zoom:c+Ur(h.lat,D.lat)),U.setBearing(o.bearing);const G=new a.P(a.ad(e.centerPoint.x+o.offsetAsPoint.x,0,e.width),a.ad(e.centerPoint.y+o.offsetAsPoint.y,0,e.height));U.setLocationAtPoint(L,G);const J=(o.offset&&o.offsetAsPoint.mag())>0?U.center:L,K=T?+o.zoom:c+Ur(h.lat,J.lat),Q=c+Ur(h.lat,0),re=K+Ur(J.lat,0),se=a.bm(h.lng,J.lng),le=a.bm(h.lat,J.lat),ue=a.aH(re-Q);return A=K!==c,{easeFunc:fe=>{if(a.b5(v,w)||co({startEulerAngles:v,endEulerAngles:w,tr:e,k:fe,useSlerp:v.roll!=w.roll}),P&&e.interpolatePadding(m,o.padding,fe),o.around)a.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(o.around,o.aroundPoint);else{const he=re>Q?Math.min(2,ue):Math.max(.5,ue),we=Math.pow(he,1-fe),Se=Si(h,se,le,fe*we);e.setCenter(Se.wrap())}if(A){const he=a.B.number(Q,re,fe)+Ur(0,e.center.lat);e.setZoom(he)}},isZooming:A,elevationCenter:J}}handleFlyTo(e,o){const c=o.zoom!==void 0,h=e.center,m=e.zoom,v=e.padding,w=!e.isPaddingEqual(o.padding),T=e.getConstrained(a.Q.convert(o.center||o.locationAtOffset),m).center,P=c?+o.zoom:e.zoom+Ur(e.center.lat,T.lat),A=e.clone();A.setCenter(T),A.setZoom(P),A.setBearing(o.bearing);const D=new a.P(a.ad(e.centerPoint.x+o.offsetAsPoint.x,0,e.width),a.ad(e.centerPoint.y+o.offsetAsPoint.y,0,e.height));A.setLocationAtPoint(T,D);const L=A.center;zn(e,L);const U=function(le,ue,fe){const he=Pn(ue),we=Pn(fe),Se=a.aU(he,we),Re=Math.acos(Se),Le=ac(le);return Re/(2*Math.PI)*Le}(e,h,L),G=m+Ur(h.lat,0),J=P+Ur(L.lat,0),K=a.aH(J-G);let Q;if(typeof o.minZoom=="number"){const le=+o.minZoom+Ur(L.lat,0),ue=Math.min(le,G,J)+Ur(0,L.lat),fe=e.getConstrained(L,ue).zoom+Ur(L.lat,0);Q=a.aH(fe-G)}const re=a.bm(h.lng,L.lng),se=a.bm(h.lat,L.lat);return{easeFunc:(le,ue,fe,he)=>{const we=Si(h,re,se,fe);w&&e.interpolatePadding(v,o.padding,le);const Se=le===1?L:we;e.setCenter(Se.wrap());const Re=G+a.aa(ue);e.setZoom(le===1?P:Re+Ur(0,Se.lat))},scaleOfZoom:K,targetCenter:L,scaleOfMinZoom:Q,pixelPathLength:U}}static solveVectorScale(e,o,c,h,m){const v=h==="x"?[c[0],c[4],c[8],c[12]]:[c[1],c[5],c[9],c[13]],w=[c[3],c[7],c[11],c[15]],T=e[0]*v[0]+e[1]*v[1]+e[2]*v[2],P=e[0]*w[0]+e[1]*w[1]+e[2]*w[2],A=o[0]*v[0]+o[1]*v[1]+o[2]*v[2],D=o[0]*w[0]+o[1]*w[1]+o[2]*w[2];return A+m*P===T+m*D||w[3]*(T-A)+v[3]*(D-P)+T*D==A*P?null:(A+v[3]-m*D-m*w[3])/(A-T-m*D+m*P)}static getLesserNonNegativeNonNull(e,o){return o!==null&&o>=0&&o<e?o:e}}class Fa{constructor(e){this._globe=e,this._mercatorCameraHelper=new So,this._verticalPerspectiveCameraHelper=new On}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,o){return this.currentHelper.handlePanInertia(e,o)}handleMapControlsRollPitchBearingZoom(e,o){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,o)}handleMapControlsPan(e,o,c){this.currentHelper.handleMapControlsPan(e,o,c)}cameraForBoxAndBearing(e,o,c,h,m){return this.currentHelper.cameraForBoxAndBearing(e,o,c,h,m)}handleJumpToCenterZoom(e,o){this.currentHelper.handleJumpToCenterZoom(e,o)}handleEaseTo(e,o){return this.currentHelper.handleEaseTo(e,o)}handleFlyTo(e,o){return this.currentHelper.handleFlyTo(e,o)}}const Ti=(p,e)=>a.x(p,e&&e.filter(o=>o.identifier!=="source.canvas")),uc=a.bt();class Ws extends a.E{constructor(e,o={}){super(),this._rtlPluginLoaded=()=>{for(const c in this.sourceCaches){const h=this.sourceCaches[c].getSource().type;h!=="vector"&&h!=="geojson"||this.sourceCaches[c].reload()}},this.map=e,this.dispatcher=new Tn(Kr(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(c,h)=>this.getGlyphs(c,h)),this.dispatcher.registerMessageHandler("GI",(c,h)=>this.getImages(c,h)),this.imageManager=new gt,this.imageManager.setEventedParent(this),this.glyphManager=new tt(e._requestManager,o.localIdeographFontFamily),this.lineAtlas=new dr(256,512),this.crossTileSymbolIndex=new nc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.bu,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",a.bv()),Zt().on(Dt,this._rtlPluginLoaded),this.on("data",c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const h=this.sourceCaches[c.sourceId];if(!h)return;const m=h.getSource();if(m&&m.vectorLayerIds)for(const v in this._layers){const w=this._layers[v];w.source===m.id&&this._validateLayer(w)}})}loadURL(e,o={},c){this.fire(new a.l("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const h=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;a.j(h,this._loadStyleRequest).then(v=>{this._loadStyleRequest=null,this._load(v.data,o,c)}).catch(v=>{this._loadStyleRequest=null,v&&!m.signal.aborted&&this.fire(new a.k(v))})}loadJSON(e,o={},c){this.fire(new a.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,q.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(e,o,c)}).catch(()=>{})}loadEmpty(){this.fire(new a.l("dataloading",{dataType:"style"})),this._load(uc,{validate:!1})}_load(e,o,c){var h,m;const v=o.transformStyle?o.transformStyle(c,e):e;if(!o.validate||!Ti(this,a.y(v))){this._loaded=!0,this.stylesheet=v;for(const w in v.sources)this.addSource(w,v.sources[w],{validate:!1});v.sprite?this._loadSprite(v.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(v.glyphs),this._createLayers(),this.light=new bt(this.stylesheet.light),this._setProjectionInternal(((h=this.stylesheet.projection)===null||h===void 0?void 0:h.type)||"mercator"),this.sky=new Ut(this.stylesheet.sky),this.map.setTerrain((m=this.stylesheet.terrain)!==null&&m!==void 0?m:null),this.fire(new a.l("data",{dataType:"style"})),this.fire(new a.l("style.load"))}}_createLayers(){const e=a.bw(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(o=>o.id),this._layers={},this._serializedLayers=null;for(const o of e){const c=a.bx(o);c.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=c}}_loadSprite(e,o=!1,c=void 0){let h;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,v,w,T){return a._(this,void 0,void 0,function*(){const P=ct(m),A=w>1?"@2x":"",D={},L={};for(const{id:U,url:G}of P){const J=v.transformRequest(ut(G,A,".json"),"SpriteJSON");D[U]=a.j(J,T);const K=v.transformRequest(ut(G,A,".png"),"SpriteImage");L[U]=be.getImage(K,T)}return yield Promise.all([...Object.values(D),...Object.values(L)]),function(U,G){return a._(this,void 0,void 0,function*(){const J={};for(const K in U){J[K]={};const Q=q.getImageCanvasContext((yield G[K]).data),re=(yield U[K]).data;for(const se in re){const{width:le,height:ue,x:fe,y:he,sdf:we,pixelRatio:Se,stretchX:Re,stretchY:Le,content:ze,textFitWidth:rt,textFitHeight:et}=re[se];J[K][se]={data:null,pixelRatio:Se,sdf:we,stretchX:Re,stretchY:Le,content:ze,textFitWidth:rt,textFitHeight:et,spriteData:{width:le,height:ue,x:fe,y:he,context:Q}}}}return J})}(D,L)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const v in m){this._spritesImagesIds[v]=[];const w=this._spritesImagesIds[v]?this._spritesImagesIds[v].filter(T=>!(T in m)):[];for(const T of w)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in m[v]){const P=v==="default"?T:`${v}:${T}`;this._spritesImagesIds[v].push(P),P in this.imageManager.images?this.imageManager.updateImage(P,m[v][T],!1):this.imageManager.addImage(P,m[v][T]),o&&(this._changedImages[P]=!0)}}}).catch(m=>{this._spriteRequest=null,h=m,this.fire(new a.k(h))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"})),c&&c(h)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}_validateLayer(e){const o=this.sourceCaches[e.source];if(!o)return;const c=e.sourceLayer;if(!c)return;const h=o.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(c)===-1)&&this.fire(new a.k(new Error(`Source layer "${c}" does not exist on source "${h.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,o=!1){const c=this._serializedAllLayers();if(!e||e.length===0)return Object.values(o?a.by(c):c);const h=[];for(const m of e)if(c[m]){const v=o?a.by(c[m]):c[m];h.push(v)}return h}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const o=Object.keys(this._layers);for(const c of o){const h=this._layers[c];h.type!=="custom"&&(e[c]=h.serialize())}return e}hasTransitions(){var e,o,c;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((o=this.sky)===null||o===void 0)&&o.hasTransition()||!((c=this.projection)===null||c===void 0)&&c.hasTransition())return!0;for(const h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const o=this._changed;if(o){const h=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(h.length||m.length)&&this._updateWorkerLayers(h,m);for(const v in this._updatedSources){const w=this._updatedSources[v];if(w==="reload")this._reloadSource(v);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(v)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const v in this._updatedPaintProps)this._layers[v].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const c={};for(const h in this.sourceCaches){const m=this.sourceCaches[h];c[h]=m.used,m.used=!1}for(const h of this._order){const m=this._layers[h];m.recalculate(e,this._availableImages),!m.isHidden(e.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const h in c){const m=this.sourceCaches[h];!!c[h]!=!!m.used&&m.fire(new a.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,o&&this.fire(new a.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,o){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,o={}){var c;this._checkLoaded();const h=this.serialize();if(e=o.transformStyle?o.transformStyle(h,e):e,((c=o.validate)===null||c===void 0||c)&&Ti(this,a.y(e)))return!1;(e=a.by(e)).layers=a.bw(e.layers);const m=a.bz(h,e),v=this._getOperationsToPerform(m);if(v.unimplemented.length>0)throw new Error(`Unimplemented: ${v.unimplemented.join(", ")}.`);if(v.operations.length===0)return!1;for(const w of v.operations)w();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const o=[],c=[];for(const h of e)switch(h.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":o.push(()=>this.addLayer.apply(this,h.args));break;case"removeLayer":o.push(()=>this.removeLayer.apply(this,h.args));break;case"setPaintProperty":o.push(()=>this.setPaintProperty.apply(this,h.args));break;case"setLayoutProperty":o.push(()=>this.setLayoutProperty.apply(this,h.args));break;case"setFilter":o.push(()=>this.setFilter.apply(this,h.args));break;case"addSource":o.push(()=>this.addSource.apply(this,h.args));break;case"removeSource":o.push(()=>this.removeSource.apply(this,h.args));break;case"setLayerZoomRange":o.push(()=>this.setLayerZoomRange.apply(this,h.args));break;case"setLight":o.push(()=>this.setLight.apply(this,h.args));break;case"setGeoJSONSourceData":o.push(()=>this.setGeoJSONSourceData.apply(this,h.args));break;case"setGlyphs":o.push(()=>this.setGlyphs.apply(this,h.args));break;case"setSprite":o.push(()=>this.setSprite.apply(this,h.args));break;case"setTerrain":o.push(()=>this.map.setTerrain.apply(this,h.args));break;case"setSky":o.push(()=>this.setSky.apply(this,h.args));break;case"setProjection":this.setProjection.apply(this,h.args);break;case"setTransition":o.push(()=>{});break;default:c.push(h.command)}return{operations:o,unimplemented:c}}addImage(e,o){if(this.getImage(e))return this.fire(new a.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,o),this._afterImageUpdated(e)}updateImage(e,o){this.imageManager.updateImage(e,o)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new a.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,o,c={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(a.y.source,`sources.${e}`,o,null,c))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const h=this.sourceCaches[e]=new z(e,o,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:h.loaded(),source:h.serialize(),sourceId:e})),h.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===e)return this.fire(new a.k(new Error(`Source "${e}" cannot be removed while layer "${c}" is using it.`)));const o=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],o.fire(new a.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,o){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const c=this.sourceCaches[e].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(o),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,o,c={}){this._checkLoaded();const h=e.id;if(this.getLayer(h))return void this.fire(new a.k(new Error(`Layer "${h}" already exists on this map.`)));let m;if(e.type==="custom"){if(Ti(this,a.bA(e)))return;m=a.bx(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(h,e.source),e=a.by(e),e=a.e(e,{source:h})),this._validate(a.y.layer,`layers.${h}`,e,{arrayIndex:-1},c))return;m=a.bx(e),this._validateLayer(m),m.setEventedParent(this,{layer:{id:h}})}const v=o?this._order.indexOf(o):this._order.length;if(o&&v===-1)this.fire(new a.k(new Error(`Cannot add layer "${h}" before non-existing layer "${o}".`)));else{if(this._order.splice(v,0,h),this._layerOrderChanged=!0,this._layers[h]=m,this._removedLayers[h]&&m.source&&m.type!=="custom"){const w=this._removedLayers[h];delete this._removedLayers[h],w.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(e,o){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new a.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===o)return;const c=this._order.indexOf(e);this._order.splice(c,1);const h=o?this._order.indexOf(o):this._order.length;o&&h===-1?this.fire(new a.k(new Error(`Cannot move layer "${e}" before non-existing layer "${o}".`))):(this._order.splice(h,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const o=this._layers[e];if(!o)return void this.fire(new a.k(new Error(`Cannot remove non-existing layer "${e}".`)));o.setEventedParent(null);const c=this._order.indexOf(e);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=o,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],o.onRemove&&o.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,o,c){this._checkLoaded();const h=this.getLayer(e);h?h.minzoom===o&&h.maxzoom===c||(o!=null&&(h.minzoom=o),c!=null&&(h.maxzoom=c),this._updateLayer(h)):this.fire(new a.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,o,c={}){this._checkLoaded();const h=this.getLayer(e);if(h){if(!a.bB(h.filter,o))return o==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(a.y.filter,`layers.${h.id}.filter`,o,null,c)||(h.filter=a.by(o),this._updateLayer(h)))}else this.fire(new a.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return a.by(this.getLayer(e).filter)}setLayoutProperty(e,o,c,h={}){this._checkLoaded();const m=this.getLayer(e);m?a.bB(m.getLayoutProperty(o),c)||(m.setLayoutProperty(o,c,h),this._updateLayer(m)):this.fire(new a.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,o){const c=this.getLayer(e);if(c)return c.getLayoutProperty(o);this.fire(new a.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,o,c,h={}){this._checkLoaded();const m=this.getLayer(e);m?a.bB(m.getPaintProperty(o),c)||(m.setPaintProperty(o,c,h)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new a.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,o){return this.getLayer(e).getPaintProperty(o)}setFeatureState(e,o){this._checkLoaded();const c=e.source,h=e.sourceLayer,m=this.sourceCaches[c];if(m===void 0)return void this.fire(new a.k(new Error(`The source '${c}' does not exist in the map's style.`)));const v=m.getSource().type;v==="geojson"&&h?this.fire(new a.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):v!=="vector"||h?(e.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),m.setFeatureState(h,e.id,o)):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,o){this._checkLoaded();const c=e.source,h=this.sourceCaches[c];if(h===void 0)return void this.fire(new a.k(new Error(`The source '${c}' does not exist in the map's style.`)));const m=h.getSource().type,v=m==="vector"?e.sourceLayer:void 0;m!=="vector"||v?o&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new a.k(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(v,e.id,o):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const o=e.source,c=e.sourceLayer,h=this.sourceCaches[o];if(h!==void 0)return h.getSource().type!=="vector"||c?(e.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),h.getFeatureState(c,e.id)):void this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.k(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=a.bC(this.sourceCaches,m=>m.serialize()),o=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,h=this.stylesheet;return a.bD({version:h.version,name:h.name,metadata:h.metadata,light:h.light,sky:h.sky,center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,sprite:h.sprite,glyphs:h.glyphs,transition:h.transition,projection:h.projection,sources:e,layers:o,terrain:c},m=>m!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const o=v=>this._layers[v].type==="fill-extrusion",c={},h=[];for(let v=this._order.length-1;v>=0;v--){const w=this._order[v];if(o(w)){c[w]=v;for(const T of e){const P=T[w];if(P)for(const A of P)h.push(A)}}}h.sort((v,w)=>w.intersectionZ-v.intersectionZ);const m=[];for(let v=this._order.length-1;v>=0;v--){const w=this._order[v];if(o(w))for(let T=h.length-1;T>=0;T--){const P=h[T].feature;if(c[P.layer.id]<v)break;m.push(P),h.pop()}else for(const T of e){const P=T[w];if(P)for(const A of P)m.push(A.feature)}}return m}queryRenderedFeatures(e,o,c){o&&o.filter&&this._validate(a.y.filter,"queryRenderedFeatures.filter",o.filter,null,o);const h={};if(o&&o.layers){if(!(Array.isArray(o.layers)||o.layers instanceof Set))return this.fire(new a.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const P of o.layers){const A=this._layers[P];if(!A)return this.fire(new a.k(new Error(`The layer '${P}' does not exist in the map's style and cannot be queried for features.`))),[];h[A.source]=!0}}const m=[];o.availableImages=this._availableImages;const v=this._serializedAllLayers(),w=o.layers instanceof Set?o.layers:Array.isArray(o.layers)?new Set(o.layers):null,T=Object.assign(Object.assign({},o),{layers:w});for(const P in this.sourceCaches)o.layers&&!h[P]||m.push(qn(this.sourceCaches[P],this._layers,v,e,T,c));return this.placement&&m.push(function(P,A,D,L,U,G,J){const K={},Q=G.queryRenderedSymbols(L),re=[];for(const se of Object.keys(Q).map(Number))re.push(J[se]);re.sort(Jr);for(const se of re){const le=se.featureIndex.lookupSymbolFeatures(Q[se.bucketInstanceId],A,se.bucketIndex,se.sourceLayerIndex,U.filter,U.layers,U.availableImages,P);for(const ue in le){const fe=K[ue]=K[ue]||[],he=le[ue];he.sort((we,Se)=>{const Re=se.featureSortOrder;if(Re){const Le=Re.indexOf(we.featureIndex);return Re.indexOf(Se.featureIndex)-Le}return Se.featureIndex-we.featureIndex});for(const we of he)fe.push(we)}}return function(se,le,ue){for(const fe in se)for(const he of se[fe])ae(he,ue[le[fe].source]);return se}(K,P,D)}(this._layers,v,this.sourceCaches,e,T,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(e,o){o&&o.filter&&this._validate(a.y.filter,"querySourceFeatures.filter",o.filter,null,o);const c=this.sourceCaches[e];return c?function(h,m){const v=h.getRenderableIds().map(P=>h.getTileByID(P)),w=[],T={};for(let P=0;P<v.length;P++){const A=v[P],D=A.tileID.canonical.key;T[D]||(T[D]=!0,A.querySourceFeatures(w,m))}return w}(c,o):[]}getLight(){return this.light.getLight()}setLight(e,o={}){this._checkLoaded();const c=this.light.getLight();let h=!1;for(const v in e)if(!a.bB(e[v],c[v])){h=!0;break}if(!h)return;const m={now:q.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,o),this.light.updateTransitions(m)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,o={}){this._checkLoaded();const c=this.getSky();let h=!1;if(!e&&!c)return;if(e&&!c)h=!0;else if(!e&&c)h=!0;else for(const v in e)if(!a.bB(e[v],c[v])){h=!0;break}if(!h)return;const m={now:q.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,o),this.sky.updateTransitions(m)}_setProjectionInternal(e){const o=function(c){if(Array.isArray(c)){const h=new Ra({type:c});return{projection:h,transform:new Oa,cameraHelper:new Fa(h)}}switch(c){case"mercator":return{projection:new oc,transform:new lo,cameraHelper:new So};case"globe":{const h=new Ra({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:h,transform:new Oa,cameraHelper:new Fa(h)}}case"vertical-perspective":return{projection:new is,transform:new $a,cameraHelper:new On};default:return a.w(`Unknown projection name: ${c}. Falling back to mercator projection.`),{projection:new oc,transform:new lo,cameraHelper:new So}}}(e);this.projection=o.projection,this.map.migrateProjection(o.transform,o.cameraHelper);for(const c in this.sourceCaches)this.sourceCaches[c].reload()}_validate(e,o,c,h,m={}){return(!m||m.validate!==!1)&&Ti(this,e.call(a.y,a.e({key:o,style:this.serialize(),value:c,styleSpec:a.v},h)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Zt().off(Dt,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const c=this.sourceCaches[o];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const o in this.sourceCaches)this.sourceCaches[o].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,o,c,h,m=!1){let v=!1,w=!1;const T={};for(const P of this._order){const A=this._layers[P];if(A.type!=="symbol")continue;if(!T[A.source]){const L=this.sourceCaches[A.source];T[A.source]=L.getRenderableIds(!0).map(U=>L.getTileByID(U)).sort((U,G)=>G.tileID.overscaledZ-U.tileID.overscaledZ||(U.tileID.isLessThan(G.tileID)?-1:1))}const D=this.crossTileSymbolIndex.addLayer(A,T[A.source],e.center.lng);v=v||D}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(q.now(),e.zoom))&&(this.pauseablePlacement=new ec(e,this.map.terrain,this._order,m,o,c,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(q.now()),w=!0),v&&this.pauseablePlacement.placement.setStale()),w||v)for(const P of this._order){const A=this._layers[P];A.type==="symbol"&&this.placement.updateLayerOpacities(A,T[A.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(q.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,o){return a._(this,void 0,void 0,function*(){const c=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const h=this.sourceCaches[o.source];return h&&h.setDependencies(o.tileID.key,o.type,o.icons),c})}getGlyphs(e,o){return a._(this,void 0,void 0,function*(){const c=yield this.glyphManager.getGlyphs(o.stacks),h=this.sourceCaches[o.source];return h&&h.setDependencies(o.tileID.key,o.type,[""]),c})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,o={}){this._checkLoaded(),e&&this._validate(a.y.glyphs,"glyphs",e,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,o,c={},h){this._checkLoaded();const m=[{id:e,url:o}],v=[...ct(this.stylesheet.sprite),...m];this._validate(a.y.sprite,"sprite",v,null,c)||(this.stylesheet.sprite=v,this._loadSprite(m,!0,h))}removeSprite(e){this._checkLoaded();const o=ct(this.stylesheet.sprite);if(o.find(c=>c.id===e)){if(this._spritesImagesIds[e])for(const c of this._spritesImagesIds[e])this.imageManager.removeImage(c),this._changedImages[c]=!0;o.splice(o.findIndex(c=>c.id===e),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}else this.fire(new a.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return ct(this.stylesheet.sprite)}setSprite(e,o={},c){this._checkLoaded(),e&&this._validate(a.y.sprite,"sprite",e,null,o)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,c):(this._unloadSprite(),c&&c(null)))}}var zo=a.aC([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Pf{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,o,c,h,m,v,w,T,P){this.context=e;let A=this.boundPaintVertexBuffers.length!==h.length;for(let D=0;!A&&D<h.length;D++)this.boundPaintVertexBuffers[D]!==h[D]&&(A=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==c||A||this.boundIndexBuffer!==m||this.boundVertexOffset!==v||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==P?this.freshBind(o,c,h,m,v,w,T,P):(e.bindVertexArray.set(this.vao),w&&w.bind(),m&&m.dynamicDraw&&m.bind(),T&&T.bind(),P&&P.bind())}freshBind(e,o,c,h,m,v,w,T){const P=e.numAttributes,A=this.context,D=A.gl;this.vao&&this.destroy(),this.vao=A.createVertexArray(),A.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=h,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=v,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=T,o.enableAttributes(D,e);for(const L of c)L.enableAttributes(D,e);v&&v.enableAttributes(D,e),w&&w.enableAttributes(D,e),T&&T.enableAttributes(D,e),o.bind(),o.setVertexAttribPointers(D,e,m);for(const L of c)L.bind(),L.setVertexAttribPointers(D,e,m);v&&(v.bind(),v.setVertexAttribPointers(D,e,m)),h&&h.bind(),w&&(w.bind(),w.setVertexAttribPointers(D,e,m)),T&&(T.bind(),T.setVertexAttribPointers(D,e,m)),A.currentNumAttributes=P}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const hc=(p,e,o,c,h)=>({u_texture:0,u_ele_delta:p,u_fog_matrix:e,u_fog_color:o?o.properties.get("fog-color"):a.b6.white,u_fog_ground_blend:o?o.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:h?0:o?o.calculateFogBlendOpacity(c):0,u_horizon_color:o?o.properties.get("horizon-color"):a.b6.white,u_horizon_fog_blend:o?o.properties.get("horizon-fog-blend"):1,u_is_globe_mode:h?1:0}),Hs={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ai(p){const e=[];for(let o=0;o<p.length;o++){if(p[o]===null)continue;const c=p[o].split(" ");e.push(c.pop())}return e}class Mf{constructor(e,o,c,h,m,v,w,T){const P=e.gl;this.program=P.createProgram();const A=ai(o.staticAttributes),D=c?c.getBinderAttributes():[],L=A.concat(D),U=wo.prelude.staticUniforms?ai(wo.prelude.staticUniforms):[],G=w.staticUniforms?ai(w.staticUniforms):[],J=o.staticUniforms?ai(o.staticUniforms):[],K=c?c.getBinderUniforms():[],Q=U.concat(G).concat(J).concat(K),re=[];for(const Se of Q)re.indexOf(Se)<0&&re.push(Se);const se=c?c.defines():[];uo(P)&&se.unshift("#version 300 es"),m&&se.push("#define OVERDRAW_INSPECTOR;"),v&&se.push("#define TERRAIN3D;"),T&&se.push(T);let le=se.concat(wo.prelude.fragmentSource,w.fragmentSource,o.fragmentSource).join(`
`),ue=se.concat(wo.prelude.vertexSource,w.vertexSource,o.vertexSource).join(`
`);uo(P)||(le=function(Se){return Se.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(le),ue=function(Se){return Se.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(ue));const fe=P.createShader(P.FRAGMENT_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);if(P.shaderSource(fe,le),P.compileShader(fe),!P.getShaderParameter(fe,P.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${P.getShaderInfoLog(fe)}`);P.attachShader(this.program,fe);const he=P.createShader(P.VERTEX_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);if(P.shaderSource(he,ue),P.compileShader(he),!P.getShaderParameter(he,P.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${P.getShaderInfoLog(he)}`);P.attachShader(this.program,he),this.attributes={};const we={};this.numAttributes=L.length;for(let Se=0;Se<this.numAttributes;Se++)L[Se]&&(P.bindAttribLocation(this.program,Se,L[Se]),this.attributes[L[Se]]=Se);if(P.linkProgram(this.program),!P.getProgramParameter(this.program,P.LINK_STATUS))throw new Error(`Program failed to link: ${P.getProgramInfoLog(this.program)}`);P.deleteShader(he),P.deleteShader(fe);for(let Se=0;Se<re.length;Se++){const Re=re[Se];if(Re&&!we[Re]){const Le=P.getUniformLocation(this.program,Re);Le&&(we[Re]=Le)}}this.fixedUniforms=h(e,we),this.terrainUniforms=((Se,Re)=>({u_depth:new a.bE(Se,Re.u_depth),u_terrain:new a.bE(Se,Re.u_terrain),u_terrain_dim:new a.b7(Se,Re.u_terrain_dim),u_terrain_matrix:new a.bG(Se,Re.u_terrain_matrix),u_terrain_unpack:new a.bH(Se,Re.u_terrain_unpack),u_terrain_exaggeration:new a.b7(Se,Re.u_terrain_exaggeration)}))(e,we),this.projectionUniforms=((Se,Re)=>({u_projection_matrix:new a.bG(Se,Re.u_projection_matrix),u_projection_tile_mercator_coords:new a.bH(Se,Re.u_projection_tile_mercator_coords),u_projection_clipping_plane:new a.bH(Se,Re.u_projection_clipping_plane),u_projection_transition:new a.b7(Se,Re.u_projection_transition),u_projection_fallback_matrix:new a.bG(Se,Re.u_projection_fallback_matrix)}))(e,we),this.binderUniforms=c?c.getUniforms(e,we):[]}draw(e,o,c,h,m,v,w,T,P,A,D,L,U,G,J,K,Q,re,se){const le=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(c),e.setStencilMode(h),e.setColorMode(m),e.setCullFace(v),T){e.activeTexture.set(le.TEXTURE2),le.bindTexture(le.TEXTURE_2D,T.depthTexture),e.activeTexture.set(le.TEXTURE3),le.bindTexture(le.TEXTURE_2D,T.texture);for(const fe in this.terrainUniforms)this.terrainUniforms[fe].set(T[fe])}if(P)for(const fe in P)this.projectionUniforms[Hs[fe]].set(P[fe]);if(w)for(const fe in this.fixedUniforms)this.fixedUniforms[fe].set(w[fe]);K&&K.setUniforms(e,this.binderUniforms,G,{zoom:J});let ue=0;switch(o){case le.LINES:ue=2;break;case le.TRIANGLES:ue=3;break;case le.LINE_STRIP:ue=1}for(const fe of U.get()){const he=fe.vaos||(fe.vaos={});(he[A]||(he[A]=new Pf)).bind(e,this,D,K?K.getPaintVertexBuffers():[],L,fe.vertexOffset,Q,re,se),le.drawElements(o,fe.primitiveLength*ue,le.UNSIGNED_SHORT,fe.primitiveOffset*ue*2)}}}function Xs(p,e,o){const c=1/a.av(o,1,e.transform.tileZoom),h=Math.pow(2,o.tileID.overscaledZ),m=o.tileSize*Math.pow(2,e.transform.tileZoom)/h,v=m*(o.tileID.canonical.x+o.tileID.wrap*h),w=m*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[c,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[v>>16,w>>16],u_pixel_coord_lower:[65535&v,65535&w]}}const hh=(p,e,o,c)=>{const h=p.style.light,m=h.properties.get("position"),v=[m.x,m.y,m.z],w=a.bK();h.properties.get("anchor")==="viewport"&&a.bL(w,p.transform.bearingInRadians),a.bM(v,v,w);const T=p.transform.transformLightDirection(v),P=h.properties.get("color");return{u_lightpos:v,u_lightpos_globe:T,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+e,u_opacity:o,u_fill_translate:c}},ss=(p,e,o,c,h,m,v)=>a.e(hh(p,e,o,c),Xs(m,p,v),{u_height_factor:-Math.pow(2,h.overscaledZ)/v.tileSize/8}),dh=(p,e,o,c)=>a.e(Xs(e,p,o),{u_fill_translate:c}),fh=(p,e)=>({u_world:p,u_fill_translate:e}),If=(p,e,o,c,h)=>a.e(dh(p,e,o,h),{u_world:c}),ph=(p,e,o,c,h)=>{const m=p.transform;let v,w,T=0;if(o.paint.get("circle-pitch-alignment")==="map"){const P=a.av(e,1,m.zoom);v=!0,w=[P,P],T=P/(a.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*h}else v=!1,w=m.pixelsToGLUnits;return{u_camera_to_center_distance:m.cameraToCenterDistance,u_scale_with_map:+(o.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+v,u_device_pixel_ratio:p.pixelRatio,u_extrude_scale:w,u_globe_extrude_scale:T,u_translate:c}},dc=p=>({u_pixel_extrude_scale:[1/p.width,1/p.height]}),mh=p=>({u_viewport_size:[p.width,p.height]}),fc=(p,e=1)=>({u_color:p,u_overlay:0,u_overlay_scale:e}),pc=(p,e,o,c)=>{const h=a.av(p,1,e)/(a.Z*Math.pow(2,p.tileID.overscaledZ))*2*Math.PI*c;return{u_extrude_scale:a.av(p,1,e),u_intensity:o,u_globe_extrude_scale:h}},mc=(p,e,o,c)=>{const h=a.K();a.bN(h,0,p.width,p.height,0,0,1);const m=p.context.gl;return{u_matrix:h,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:o,u_color_ramp:c,u_opacity:e.paint.get("heatmap-opacity")}},ki=(p,e,o)=>{const c=o.paint.get("hillshade-shadow-color"),h=o.paint.get("hillshade-highlight-color"),m=o.paint.get("hillshade-accent-color");let v=o.paint.get("hillshade-illumination-direction")*(Math.PI/180);return o.paint.get("hillshade-illumination-anchor")==="viewport"&&(v+=p.transform.bearingInRadians),{u_image:0,u_latrange:_h(0,e.tileID),u_light:[o.paint.get("hillshade-exaggeration"),v],u_shadow:c,u_highlight:h,u_accent:m}},gh=(p,e)=>{const o=e.stride,c=a.K();return a.bN(c,0,a.Z,-8192,0,0,1),a.L(c,c,[0,-8192,0]),{u_matrix:c,u_image:1,u_dimension:[o,o],u_zoom:p.overscaledZ,u_unpack:e.getUnpackVector()}};function _h(p,e){const o=Math.pow(2,e.canonical.z),c=e.canonical.y;return[new a.$(0,c/o).toLngLat().lat,new a.$(0,(c+1)/o).toLngLat().lat]}const Pi=(p,e,o,c)=>{const h=p.transform;return{u_translation:gc(p,e,o),u_ratio:c/a.av(e,1,h.zoom),u_device_pixel_ratio:p.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Ef=(p,e,o,c,h)=>a.e(Pi(p,e,o,c),{u_image:0,u_image_height:h}),ja=(p,e,o,c,h)=>{const m=p.transform,v=yh(e,m);return{u_translation:gc(p,e,o),u_texsize:e.imageAtlasTexture.size,u_ratio:c/a.av(e,1,m.zoom),u_device_pixel_ratio:p.pixelRatio,u_image:0,u_scale:[v,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Af=(p,e,o,c,h,m)=>{const v=p.lineAtlas,w=yh(e,p.transform),T=o.layout.get("line-cap")==="round",P=v.getDash(h.from,T),A=v.getDash(h.to,T),D=P.width*m.fromScale,L=A.width*m.toScale;return a.e(Pi(p,e,o,c),{u_patternscale_a:[w/D,-P.height/2],u_patternscale_b:[w/L,-A.height/2],u_sdfgamma:v.width/(256*Math.min(D,L)*p.pixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:A.y,u_mix:m.t})};function yh(p,e){return 1/a.av(p,1,e.tileZoom)}function gc(p,e,o){return a.aw(p.transform,e,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const vh=(p,e,o,c,h)=>{return{u_tl_parent:p,u_scale_parent:e,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(v=c.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(m=c.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:bh(c.paint.get("raster-hue-rotate")),u_coords_top:[h[0].x,h[0].y,h[1].x,h[1].y],u_coords_bottom:[h[3].x,h[3].y,h[2].x,h[2].y]};var m,v};function bh(p){p*=Math.PI/180;const e=Math.sin(p),o=Math.cos(p);return[(2*o+1)/3,(-Math.sqrt(3)*e-o+1)/3,(Math.sqrt(3)*e-o+1)/3]}const Na=(p,e,o,c,h,m,v,w,T,P,A,D,L)=>{const U=v.transform;return{u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:U.cameraToCenterDistance,u_pitch:U.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:U.width/U.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_label_plane_matrix:w,u_coord_matrix:T,u_is_text:+A,u_pitch_with_map:+c,u_is_along_line:h,u_is_variable_anchor:m,u_texsize:D,u_texture:0,u_translation:P,u_pitched_scale:L}},_c=(p,e,o,c,h,m,v,w,T,P,A,D,L,U)=>{const G=v.transform;return a.e(Na(p,e,o,c,h,m,v,w,T,P,A,D,U),{u_gamma_scale:c?Math.cos(G.pitch*Math.PI/180)*G.cameraToCenterDistance:1,u_device_pixel_ratio:v.pixelRatio,u_is_halo:1})},Va=(p,e,o,c,h,m,v,w,T,P,A,D,L)=>a.e(_c(p,e,o,c,h,m,v,w,T,P,!0,A,0,L),{u_texsize_icon:D,u_texture_icon:1}),qo=(p,e)=>({u_opacity:p,u_color:e}),yc=(p,e,o,c,h)=>a.e(function(m,v,w,T){const P=w.imageManager.getPattern(m.from.toString()),A=w.imageManager.getPattern(m.to.toString()),{width:D,height:L}=w.imageManager.getPixelSize(),U=Math.pow(2,T.tileID.overscaledZ),G=T.tileSize*Math.pow(2,w.transform.tileZoom)/U,J=G*(T.tileID.canonical.x+T.tileID.wrap*U),K=G*T.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:P.tl,u_pattern_br_a:P.br,u_pattern_tl_b:A.tl,u_pattern_br_b:A.br,u_texsize:[D,L],u_mix:v.t,u_pattern_size_a:P.displaySize,u_pattern_size_b:A.displaySize,u_scale_a:v.fromScale,u_scale_b:v.toScale,u_tile_units_to_pixels:1/a.av(T,1,w.transform.tileZoom),u_pixel_coord_upper:[J>>16,K>>16],u_pixel_coord_lower:[65535&J,65535&K]}}(o,h,e,c),{u_opacity:p}),Ua=(p,e)=>{},vc={fillExtrusion:(p,e)=>({u_lightpos:new a.bI(p,e.u_lightpos),u_lightpos_globe:new a.bI(p,e.u_lightpos_globe),u_lightintensity:new a.b7(p,e.u_lightintensity),u_lightcolor:new a.bI(p,e.u_lightcolor),u_vertical_gradient:new a.b7(p,e.u_vertical_gradient),u_opacity:new a.b7(p,e.u_opacity),u_fill_translate:new a.bJ(p,e.u_fill_translate)}),fillExtrusionPattern:(p,e)=>({u_lightpos:new a.bI(p,e.u_lightpos),u_lightpos_globe:new a.bI(p,e.u_lightpos_globe),u_lightintensity:new a.b7(p,e.u_lightintensity),u_lightcolor:new a.bI(p,e.u_lightcolor),u_vertical_gradient:new a.b7(p,e.u_vertical_gradient),u_height_factor:new a.b7(p,e.u_height_factor),u_opacity:new a.b7(p,e.u_opacity),u_fill_translate:new a.bJ(p,e.u_fill_translate),u_image:new a.bE(p,e.u_image),u_texsize:new a.bJ(p,e.u_texsize),u_pixel_coord_upper:new a.bJ(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new a.bJ(p,e.u_pixel_coord_lower),u_scale:new a.bI(p,e.u_scale),u_fade:new a.b7(p,e.u_fade)}),fill:(p,e)=>({u_fill_translate:new a.bJ(p,e.u_fill_translate)}),fillPattern:(p,e)=>({u_image:new a.bE(p,e.u_image),u_texsize:new a.bJ(p,e.u_texsize),u_pixel_coord_upper:new a.bJ(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new a.bJ(p,e.u_pixel_coord_lower),u_scale:new a.bI(p,e.u_scale),u_fade:new a.b7(p,e.u_fade),u_fill_translate:new a.bJ(p,e.u_fill_translate)}),fillOutline:(p,e)=>({u_world:new a.bJ(p,e.u_world),u_fill_translate:new a.bJ(p,e.u_fill_translate)}),fillOutlinePattern:(p,e)=>({u_world:new a.bJ(p,e.u_world),u_image:new a.bE(p,e.u_image),u_texsize:new a.bJ(p,e.u_texsize),u_pixel_coord_upper:new a.bJ(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new a.bJ(p,e.u_pixel_coord_lower),u_scale:new a.bI(p,e.u_scale),u_fade:new a.b7(p,e.u_fade),u_fill_translate:new a.bJ(p,e.u_fill_translate)}),circle:(p,e)=>({u_camera_to_center_distance:new a.b7(p,e.u_camera_to_center_distance),u_scale_with_map:new a.bE(p,e.u_scale_with_map),u_pitch_with_map:new a.bE(p,e.u_pitch_with_map),u_extrude_scale:new a.bJ(p,e.u_extrude_scale),u_device_pixel_ratio:new a.b7(p,e.u_device_pixel_ratio),u_globe_extrude_scale:new a.b7(p,e.u_globe_extrude_scale),u_translate:new a.bJ(p,e.u_translate)}),collisionBox:(p,e)=>({u_pixel_extrude_scale:new a.bJ(p,e.u_pixel_extrude_scale)}),collisionCircle:(p,e)=>({u_viewport_size:new a.bJ(p,e.u_viewport_size)}),debug:(p,e)=>({u_color:new a.bF(p,e.u_color),u_overlay:new a.bE(p,e.u_overlay),u_overlay_scale:new a.b7(p,e.u_overlay_scale)}),depth:Ua,clippingMask:Ua,heatmap:(p,e)=>({u_extrude_scale:new a.b7(p,e.u_extrude_scale),u_intensity:new a.b7(p,e.u_intensity),u_globe_extrude_scale:new a.b7(p,e.u_globe_extrude_scale)}),heatmapTexture:(p,e)=>({u_matrix:new a.bG(p,e.u_matrix),u_world:new a.bJ(p,e.u_world),u_image:new a.bE(p,e.u_image),u_color_ramp:new a.bE(p,e.u_color_ramp),u_opacity:new a.b7(p,e.u_opacity)}),hillshade:(p,e)=>({u_image:new a.bE(p,e.u_image),u_latrange:new a.bJ(p,e.u_latrange),u_light:new a.bJ(p,e.u_light),u_shadow:new a.bF(p,e.u_shadow),u_highlight:new a.bF(p,e.u_highlight),u_accent:new a.bF(p,e.u_accent)}),hillshadePrepare:(p,e)=>({u_matrix:new a.bG(p,e.u_matrix),u_image:new a.bE(p,e.u_image),u_dimension:new a.bJ(p,e.u_dimension),u_zoom:new a.b7(p,e.u_zoom),u_unpack:new a.bH(p,e.u_unpack)}),line:(p,e)=>({u_translation:new a.bJ(p,e.u_translation),u_ratio:new a.b7(p,e.u_ratio),u_device_pixel_ratio:new a.b7(p,e.u_device_pixel_ratio),u_units_to_pixels:new a.bJ(p,e.u_units_to_pixels)}),lineGradient:(p,e)=>({u_translation:new a.bJ(p,e.u_translation),u_ratio:new a.b7(p,e.u_ratio),u_device_pixel_ratio:new a.b7(p,e.u_device_pixel_ratio),u_units_to_pixels:new a.bJ(p,e.u_units_to_pixels),u_image:new a.bE(p,e.u_image),u_image_height:new a.b7(p,e.u_image_height)}),linePattern:(p,e)=>({u_translation:new a.bJ(p,e.u_translation),u_texsize:new a.bJ(p,e.u_texsize),u_ratio:new a.b7(p,e.u_ratio),u_device_pixel_ratio:new a.b7(p,e.u_device_pixel_ratio),u_image:new a.bE(p,e.u_image),u_units_to_pixels:new a.bJ(p,e.u_units_to_pixels),u_scale:new a.bI(p,e.u_scale),u_fade:new a.b7(p,e.u_fade)}),lineSDF:(p,e)=>({u_translation:new a.bJ(p,e.u_translation),u_ratio:new a.b7(p,e.u_ratio),u_device_pixel_ratio:new a.b7(p,e.u_device_pixel_ratio),u_units_to_pixels:new a.bJ(p,e.u_units_to_pixels),u_patternscale_a:new a.bJ(p,e.u_patternscale_a),u_patternscale_b:new a.bJ(p,e.u_patternscale_b),u_sdfgamma:new a.b7(p,e.u_sdfgamma),u_image:new a.bE(p,e.u_image),u_tex_y_a:new a.b7(p,e.u_tex_y_a),u_tex_y_b:new a.b7(p,e.u_tex_y_b),u_mix:new a.b7(p,e.u_mix)}),raster:(p,e)=>({u_tl_parent:new a.bJ(p,e.u_tl_parent),u_scale_parent:new a.b7(p,e.u_scale_parent),u_buffer_scale:new a.b7(p,e.u_buffer_scale),u_fade_t:new a.b7(p,e.u_fade_t),u_opacity:new a.b7(p,e.u_opacity),u_image0:new a.bE(p,e.u_image0),u_image1:new a.bE(p,e.u_image1),u_brightness_low:new a.b7(p,e.u_brightness_low),u_brightness_high:new a.b7(p,e.u_brightness_high),u_saturation_factor:new a.b7(p,e.u_saturation_factor),u_contrast_factor:new a.b7(p,e.u_contrast_factor),u_spin_weights:new a.bI(p,e.u_spin_weights),u_coords_top:new a.bH(p,e.u_coords_top),u_coords_bottom:new a.bH(p,e.u_coords_bottom)}),symbolIcon:(p,e)=>({u_is_size_zoom_constant:new a.bE(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bE(p,e.u_is_size_feature_constant),u_size_t:new a.b7(p,e.u_size_t),u_size:new a.b7(p,e.u_size),u_camera_to_center_distance:new a.b7(p,e.u_camera_to_center_distance),u_pitch:new a.b7(p,e.u_pitch),u_rotate_symbol:new a.bE(p,e.u_rotate_symbol),u_aspect_ratio:new a.b7(p,e.u_aspect_ratio),u_fade_change:new a.b7(p,e.u_fade_change),u_label_plane_matrix:new a.bG(p,e.u_label_plane_matrix),u_coord_matrix:new a.bG(p,e.u_coord_matrix),u_is_text:new a.bE(p,e.u_is_text),u_pitch_with_map:new a.bE(p,e.u_pitch_with_map),u_is_along_line:new a.bE(p,e.u_is_along_line),u_is_variable_anchor:new a.bE(p,e.u_is_variable_anchor),u_texsize:new a.bJ(p,e.u_texsize),u_texture:new a.bE(p,e.u_texture),u_translation:new a.bJ(p,e.u_translation),u_pitched_scale:new a.b7(p,e.u_pitched_scale)}),symbolSDF:(p,e)=>({u_is_size_zoom_constant:new a.bE(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bE(p,e.u_is_size_feature_constant),u_size_t:new a.b7(p,e.u_size_t),u_size:new a.b7(p,e.u_size),u_camera_to_center_distance:new a.b7(p,e.u_camera_to_center_distance),u_pitch:new a.b7(p,e.u_pitch),u_rotate_symbol:new a.bE(p,e.u_rotate_symbol),u_aspect_ratio:new a.b7(p,e.u_aspect_ratio),u_fade_change:new a.b7(p,e.u_fade_change),u_label_plane_matrix:new a.bG(p,e.u_label_plane_matrix),u_coord_matrix:new a.bG(p,e.u_coord_matrix),u_is_text:new a.bE(p,e.u_is_text),u_pitch_with_map:new a.bE(p,e.u_pitch_with_map),u_is_along_line:new a.bE(p,e.u_is_along_line),u_is_variable_anchor:new a.bE(p,e.u_is_variable_anchor),u_texsize:new a.bJ(p,e.u_texsize),u_texture:new a.bE(p,e.u_texture),u_gamma_scale:new a.b7(p,e.u_gamma_scale),u_device_pixel_ratio:new a.b7(p,e.u_device_pixel_ratio),u_is_halo:new a.bE(p,e.u_is_halo),u_translation:new a.bJ(p,e.u_translation),u_pitched_scale:new a.b7(p,e.u_pitched_scale)}),symbolTextAndIcon:(p,e)=>({u_is_size_zoom_constant:new a.bE(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bE(p,e.u_is_size_feature_constant),u_size_t:new a.b7(p,e.u_size_t),u_size:new a.b7(p,e.u_size),u_camera_to_center_distance:new a.b7(p,e.u_camera_to_center_distance),u_pitch:new a.b7(p,e.u_pitch),u_rotate_symbol:new a.bE(p,e.u_rotate_symbol),u_aspect_ratio:new a.b7(p,e.u_aspect_ratio),u_fade_change:new a.b7(p,e.u_fade_change),u_label_plane_matrix:new a.bG(p,e.u_label_plane_matrix),u_coord_matrix:new a.bG(p,e.u_coord_matrix),u_is_text:new a.bE(p,e.u_is_text),u_pitch_with_map:new a.bE(p,e.u_pitch_with_map),u_is_along_line:new a.bE(p,e.u_is_along_line),u_is_variable_anchor:new a.bE(p,e.u_is_variable_anchor),u_texsize:new a.bJ(p,e.u_texsize),u_texsize_icon:new a.bJ(p,e.u_texsize_icon),u_texture:new a.bE(p,e.u_texture),u_texture_icon:new a.bE(p,e.u_texture_icon),u_gamma_scale:new a.b7(p,e.u_gamma_scale),u_device_pixel_ratio:new a.b7(p,e.u_device_pixel_ratio),u_is_halo:new a.bE(p,e.u_is_halo),u_translation:new a.bJ(p,e.u_translation),u_pitched_scale:new a.b7(p,e.u_pitched_scale)}),background:(p,e)=>({u_opacity:new a.b7(p,e.u_opacity),u_color:new a.bF(p,e.u_color)}),backgroundPattern:(p,e)=>({u_opacity:new a.b7(p,e.u_opacity),u_image:new a.bE(p,e.u_image),u_pattern_tl_a:new a.bJ(p,e.u_pattern_tl_a),u_pattern_br_a:new a.bJ(p,e.u_pattern_br_a),u_pattern_tl_b:new a.bJ(p,e.u_pattern_tl_b),u_pattern_br_b:new a.bJ(p,e.u_pattern_br_b),u_texsize:new a.bJ(p,e.u_texsize),u_mix:new a.b7(p,e.u_mix),u_pattern_size_a:new a.bJ(p,e.u_pattern_size_a),u_pattern_size_b:new a.bJ(p,e.u_pattern_size_b),u_scale_a:new a.b7(p,e.u_scale_a),u_scale_b:new a.b7(p,e.u_scale_b),u_pixel_coord_upper:new a.bJ(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new a.bJ(p,e.u_pixel_coord_lower),u_tile_units_to_pixels:new a.b7(p,e.u_tile_units_to_pixels)}),terrain:(p,e)=>({u_texture:new a.bE(p,e.u_texture),u_ele_delta:new a.b7(p,e.u_ele_delta),u_fog_matrix:new a.bG(p,e.u_fog_matrix),u_fog_color:new a.bF(p,e.u_fog_color),u_fog_ground_blend:new a.b7(p,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new a.b7(p,e.u_fog_ground_blend_opacity),u_horizon_color:new a.bF(p,e.u_horizon_color),u_horizon_fog_blend:new a.b7(p,e.u_horizon_fog_blend),u_is_globe_mode:new a.b7(p,e.u_is_globe_mode)}),terrainDepth:(p,e)=>({u_ele_delta:new a.b7(p,e.u_ele_delta)}),terrainCoords:(p,e)=>({u_texture:new a.bE(p,e.u_texture),u_terrain_coords_id:new a.b7(p,e.u_terrain_coords_id),u_ele_delta:new a.b7(p,e.u_ele_delta)}),projectionErrorMeasurement:(p,e)=>({u_input:new a.b7(p,e.u_input),u_output_expected:new a.b7(p,e.u_output_expected)}),atmosphere:(p,e)=>({u_sun_pos:new a.bI(p,e.u_sun_pos),u_atmosphere_blend:new a.b7(p,e.u_atmosphere_blend),u_globe_position:new a.bI(p,e.u_globe_position),u_globe_radius:new a.b7(p,e.u_globe_radius),u_inv_proj_matrix:new a.bG(p,e.u_inv_proj_matrix)}),sky:(p,e)=>({u_sky_color:new a.bF(p,e.u_sky_color),u_horizon_color:new a.bF(p,e.u_horizon_color),u_horizon:new a.bJ(p,e.u_horizon),u_horizon_normal:new a.bJ(p,e.u_horizon_normal),u_sky_horizon_blend:new a.b7(p,e.u_sky_horizon_blend),u_sky_blend:new a.b7(p,e.u_sky_blend)})};class xh{constructor(e,o,c){this.context=e;const h=e.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const bc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Mi{constructor(e,o,c,h){this.length=o.length,this.attributes=c,this.itemSize=o.bytesPerElement,this.dynamicDraw=h,this.context=e;const m=e.gl;this.buffer=m.createBuffer(),e.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,o){for(let c=0;c<this.attributes.length;c++){const h=o.attributes[this.attributes[c].name];h!==void 0&&e.enableVertexAttribArray(h)}}setVertexAttribPointers(e,o,c){for(let h=0;h<this.attributes.length;h++){const m=this.attributes[h],v=o.attributes[m.name];v!==void 0&&e.vertexAttribPointer(v,m.components,e[bc[m.type]],!1,this.itemSize,m.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class tr{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class zf extends tr{getDefault(){return a.b6.transparent}set(e){const o=this.current;(e.r!==o.r||e.g!==o.g||e.b!==o.b||e.a!==o.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Rf extends tr{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Df extends tr{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Lf extends tr{getDefault(){return[!0,!0,!0,!0]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||e[3]!==o[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class wh extends tr{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Bf extends tr{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Ch extends tr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const o=this.current;(e.func!==o.func||e.ref!==o.ref||e.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Za extends tr{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Ga extends tr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=e,this.dirty=!1}}class qa extends tr{getDefault(){return[0,1]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class xc extends tr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=e,this.dirty=!1}}class Ii extends tr{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class as extends tr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.BLEND):o.disable(o.BLEND),this.current=e,this.dirty=!1}}class ho extends tr{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Sh extends tr{getDefault(){return a.b6.transparent}set(e){const o=this.current;(e.r!==o.r||e.g!==o.g||e.b!==o.b||e.a!==o.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Th extends tr{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class wc extends tr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=e,this.dirty=!1}}class Ei extends tr{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Wa extends tr{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Ha extends tr{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Ys extends tr{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Xa extends tr{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||e[3]!==o[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class kh extends tr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class ls extends tr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class cs extends tr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Ph extends tr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Cc extends tr{getDefault(){return null}set(e){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class er extends tr{getDefault(){return null}set(e){var o;if(e===this.current&&!this.dirty)return;const c=this.gl;uo(c)?c.bindVertexArray(e):(o=c.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Ya extends tr{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class $f extends tr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Mh extends tr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Ai extends tr{constructor(e,o){super(e),this.context=e,this.parent=o}getDefault(){return null}}class Of extends Ai{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Ff extends Ai{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Ih extends Ai{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const Eh="Framebuffer is not complete";class Sc{constructor(e,o,c,h,m){this.context=e,this.width=o,this.height=c;const v=e.gl,w=this.framebuffer=v.createFramebuffer();if(this.colorAttachment=new Of(e,w),h)this.depthAttachment=m?new Ih(e,w):new Ff(e,w);else if(m)throw new Error("Stencil cannot be set without depth");if(v.checkFramebufferStatus(v.FRAMEBUFFER)!==v.FRAMEBUFFER_COMPLETE)throw new Error(Eh)}destroy(){const e=this.context.gl,o=this.colorAttachment.get();if(o&&e.deleteTexture(o),this.depthAttachment){const c=this.depthAttachment.get();c&&e.deleteRenderbuffer(c)}e.deleteFramebuffer(this.framebuffer)}}class Ka{constructor(e){var o,c;if(this.gl=e,this.clearColor=new zf(this),this.clearDepth=new Rf(this),this.clearStencil=new Df(this),this.colorMask=new Lf(this),this.depthMask=new wh(this),this.stencilMask=new Bf(this),this.stencilFunc=new Ch(this),this.stencilOp=new Za(this),this.stencilTest=new Ga(this),this.depthRange=new qa(this),this.depthTest=new xc(this),this.depthFunc=new Ii(this),this.blend=new as(this),this.blendFunc=new ho(this),this.blendColor=new Sh(this),this.blendEquation=new Th(this),this.cullFace=new wc(this),this.cullFaceSide=new Ei(this),this.frontFace=new Wa(this),this.program=new Ha(this),this.activeTexture=new Ys(this),this.viewport=new Xa(this),this.bindFramebuffer=new kh(this),this.bindRenderbuffer=new ls(this),this.bindTexture=new cs(this),this.bindVertexBuffer=new Ph(this),this.bindElementBuffer=new Cc(this),this.bindVertexArray=new er(this),this.pixelStoreUnpack=new Ya(this),this.pixelStoreUnpackPremultiplyAlpha=new $f(this),this.pixelStoreUnpackFlipY=new Mh(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),uo(e)){this.HALF_FLOAT=e.HALF_FLOAT;const h=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=e.RGBA16F)!==null&&o!==void 0?o:h==null?void 0:h.RGBA16F_EXT,this.RGB16F=(c=e.RGB16F)!==null&&c!==void 0?c:h==null?void 0:h.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const h=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=h==null?void 0:h.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,o){return new xh(this,e,o)}createVertexBuffer(e,o,c){return new Mi(this,e,o,c)}createRenderbuffer(e,o,c){const h=this.gl,m=h.createRenderbuffer();return this.bindRenderbuffer.set(m),h.renderbufferStorage(h.RENDERBUFFER,e,o,c),this.bindRenderbuffer.set(null),m}createFramebuffer(e,o,c,h){return new Sc(this,e,o,c,h)}clear({color:e,depth:o,stencil:c}){const h=this.gl;let m=0;e&&(m|=h.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(m|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),c!==void 0&&(m|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),h.clear(m)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){a.bB(e.blendFunction,Sr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return uo(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var o;return uo(this.gl)?this.gl.deleteVertexArray(e):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let zi;function Ja(p,e,o,c,h){const m=p.context,v=p.transform,w=m.gl,T=p.useProgram("collisionBox"),P=[];let A=0,D=0;for(let Q=0;Q<c.length;Q++){const re=c[Q],se=e.getTile(re).getBucket(o);if(!se)continue;const le=h?se.textCollisionBox:se.iconCollisionBox,ue=se.collisionCircleArray;ue.length>0&&(P.push({circleArray:ue,circleOffset:D,coord:re}),A+=ue.length/4,D=A),le&&T.draw(m,w.LINES,$t.disabled,Kt.disabled,p.colorModeForRenderPass(),Xt.disabled,dc(p.transform),p.style.map.terrain&&p.style.map.terrain.getTerrainData(re),v.getProjectionData({overscaledTileID:re,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),o.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,null,p.transform.zoom,null,null,le.collisionVertexBuffer)}if(!h||!P.length)return;const L=p.useProgram("collisionCircle"),U=new a.bO;U.resize(4*A),U._trim();let G=0;for(const Q of P)for(let re=0;re<Q.circleArray.length/4;re++){const se=4*re,le=Q.circleArray[se+0],ue=Q.circleArray[se+1],fe=Q.circleArray[se+2],he=Q.circleArray[se+3];U.emplace(G++,le,ue,fe,he,0),U.emplace(G++,le,ue,fe,he,1),U.emplace(G++,le,ue,fe,he,2),U.emplace(G++,le,ue,fe,he,3)}(!zi||zi.length<2*A)&&(zi=function(Q){const re=2*Q,se=new a.bQ;se.resize(re),se._trim();for(let le=0;le<re;le++){const ue=6*le;se.uint16[ue+0]=4*le+0,se.uint16[ue+1]=4*le+1,se.uint16[ue+2]=4*le+2,se.uint16[ue+3]=4*le+2,se.uint16[ue+4]=4*le+3,se.uint16[ue+5]=4*le+0}return se}(A));const J=m.createIndexBuffer(zi,!0),K=m.createVertexBuffer(U,a.bP.members,!0);for(const Q of P){const re=mh(p.transform);L.draw(m,w.TRIANGLES,$t.disabled,Kt.disabled,p.colorModeForRenderPass(),Xt.disabled,re,p.style.map.terrain&&p.style.map.terrain.getTerrainData(Q.coord),null,o.id,K,J,a.aF.simpleSegment(0,2*Q.circleOffset,Q.circleArray.length,Q.circleArray.length/2),null,p.transform.zoom,null,null,null)}K.destroy(),J.destroy()}const Tc=a.as(new Float32Array(16));function Ah(p,e,o,c,h,m){const{horizontalAlign:v,verticalAlign:w}=a.aA(p);return new a.P((-(v-.5)*e/h+c[0])*m,(-(w-.5)*o/h+c[1])*m)}function Qa(p,e,o,c,h,m){const v=e.tileAnchorPoint.add(new a.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let w=c.mult(m);o||(w=w.rotate(-h));const T=v.add(w);return Ee(T.x,T.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(o){const w=_t(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(p),T=Math.atan(w.y/w.x)+(w.x<0?Math.PI:0);return p.add(c.rotate(T))}return p.add(c)}function el(p,e,o,c,h,m,v,w,T,P,A,D){const L=p.text.placedSymbolArray,U=p.text.dynamicLayoutVertexArray,G=p.icon.dynamicLayoutVertexArray,J={};U.clear();for(let K=0;K<L.length;K++){const Q=L.get(K),re=Q.hidden||!Q.crossTileID||p.allowVerticalPlacement&&!Q.placedOrientation?null:c[Q.crossTileID];if(re){const se=new a.P(Q.anchorX,Q.anchorY),le={getElevation:D,width:h.width,height:h.height,pitchedLabelPlaneMatrix:m,pitchWithMap:o,transform:h,tileAnchorPoint:se,translation:P,unwrappedTileID:A},ue=o?Ot(se.x,se.y,le):_t(se.x,se.y,le),fe=ye(h.cameraToCenterDistance,ue.signedDistanceFromCamera);let he=a.ah(p.textSizeData,w,Q)*fe/a.au;o&&(he*=p.tilePixelRatio/v);const{width:we,height:Se,anchor:Re,textOffset:Le,textBoxScale:ze}=re,rt=Ah(Re,we,Se,Le,ze,he),et=h.getPitchedTextCorrection(se.x+P[0],se.y+P[1],A),Ue=Qa(ue.point,le,e,rt,-h.bearingInRadians,et),yt=p.allowVerticalPlacement&&Q.placedOrientation===a.ag.vertical?Math.PI/2:0;for(let Ct=0;Ct<Q.numGlyphs;Ct++)a.an(U,Ue,yt);T&&Q.associatedIconIndex>=0&&(J[Q.associatedIconIndex]={shiftedAnchor:Ue,angle:yt})}else Wr(Q.numGlyphs,U)}if(T){G.clear();const K=p.icon.placedSymbolArray;for(let Q=0;Q<K.length;Q++){const re=K.get(Q);if(re.hidden)Wr(re.numGlyphs,G);else{const se=J[Q];if(se)for(let le=0;le<re.numGlyphs;le++)a.an(G,se.shiftedAnchor,se.angle);else Wr(re.numGlyphs,G)}}p.icon.dynamicLayoutVertexBuffer.updateData(G)}p.text.dynamicLayoutVertexBuffer.updateData(U)}function kc(p,e,o){return o.iconsInText&&e?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function zh(p,e,o,c,h,m,v,w,T,P,A,D,L){const U=p.context,G=U.gl,J=p.transform,K=w==="map",Q=T==="map",re=w!=="viewport"&&o.layout.get("symbol-placement")!=="point",se=K&&!Q&&!re,le=!o.layout.get("symbol-sort-key").isConstant();let ue=!1;const fe=p.getDepthModeForSublayer(0,$t.ReadOnly),he=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),we=[],Se=J.getCircleRadiusCorrection();for(const Re of c){const Le=e.getTile(Re),ze=Le.getBucket(o);if(!ze)continue;const rt=h?ze.text:ze.icon;if(!rt||!rt.segments.get().length||!rt.hasVisibleVertices)continue;const et=rt.programConfigurations.get(o.id),Ue=h||ze.sdfIcons,yt=h?ze.textSizeData:ze.iconSizeData,Ct=Q||J.pitch!==0,rr=p.useProgram(kc(Ue,h,ze),et),gr=a.af(yt,J.zoom),ur=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Re);let kr,xr,or,hr,dn=[0,0],fn=null;if(h)xr=Le.glyphAtlasTexture,or=G.LINEAR,kr=Le.glyphAtlasTexture.size,ze.iconsInText&&(dn=Le.imageAtlasTexture.size,fn=Le.imageAtlasTexture,hr=Ct||p.options.rotating||p.options.zooming||yt.kind==="composite"||yt.kind==="camera"?G.LINEAR:G.NEAREST);else{const _r=o.layout.get("icon-size").constantOr(0)!==1||ze.iconsNeedLinear;xr=Le.imageAtlasTexture,or=Ue||p.options.rotating||p.options.zooming||_r||Ct?G.LINEAR:G.NEAREST,kr=Le.imageAtlasTexture.size}const en=a.av(Le,1,p.transform.zoom),bn=Te(K,p.transform,en),di=a.K();a.ai(di,bn);const Ho=me(Q,K,p.transform,en),Bo=a.aw(J,Le,m,v),mo=J.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!L,applyTerrainMatrix:!0}),Oi=he&&ze.hasTextData(),aa=o.layout.get("icon-text-fit")!=="none"&&Oi&&ze.hasIconData();if(re){const _r=p.style.map.terrain?(tn,rn)=>p.style.map.terrain.getElevation(Re,tn,rn):null,pr=o.layout.get("text-rotation-alignment")==="map";ve(ze,p,h,bn,di,Q,P,pr,Re.toUnwrapped(),J.width,J.height,Bo,_r)}const Fi=h&&he||aa,go=re||Fi?Tc:Q?bn:p.transform.clipSpaceToPixelsMatrix,$o=Ue&&o.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let To;To=Ue?ze.iconsInText?Va(yt.kind,gr,se,Q,re,Fi,p,go,Ho,Bo,kr,dn,Se):_c(yt.kind,gr,se,Q,re,Fi,p,go,Ho,Bo,h,kr,0,Se):Na(yt.kind,gr,se,Q,re,Fi,p,go,Ho,Bo,h,kr,Se);const Oo={program:rr,buffers:rt,uniformValues:To,projectionData:mo,atlasTexture:xr,atlasTextureIcon:fn,atlasInterpolation:or,atlasInterpolationIcon:hr,isSDF:Ue,hasHalo:$o};if(le&&ze.canOverlap){ue=!0;const _r=rt.segments.get();for(const pr of _r)we.push({segments:new a.aF([pr]),sortKey:pr.sortKey,state:Oo,terrainData:ur})}else we.push({segments:rt.segments,sortKey:0,state:Oo,terrainData:ur})}ue&&we.sort((Re,Le)=>Re.sortKey-Le.sortKey);for(const Re of we){const Le=Re.state;if(U.activeTexture.set(G.TEXTURE0),Le.atlasTexture.bind(Le.atlasInterpolation,G.CLAMP_TO_EDGE),Le.atlasTextureIcon&&(U.activeTexture.set(G.TEXTURE1),Le.atlasTextureIcon&&Le.atlasTextureIcon.bind(Le.atlasInterpolationIcon,G.CLAMP_TO_EDGE)),Le.isSDF){const ze=Le.uniformValues;Le.hasHalo&&(ze.u_is_halo=1,tl(Le.buffers,Re.segments,o,p,Le.program,fe,A,D,ze,Le.projectionData,Re.terrainData)),ze.u_is_halo=0}tl(Le.buffers,Re.segments,o,p,Le.program,fe,A,D,Le.uniformValues,Le.projectionData,Re.terrainData)}}function tl(p,e,o,c,h,m,v,w,T,P,A){const D=c.context;h.draw(D,D.gl.TRIANGLES,m,v,w,Xt.backCCW,T,A,P,o.id,p.layoutVertexBuffer,p.indexBuffer,e,o.paint,c.transform.zoom,p.programConfigurations.get(o.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function jf(p,e,o,c,h){const m=p.context,v=m.gl,w=Kt.disabled,T=new Sr([v.ONE,v.ONE],a.b6.transparent,[!0,!0,!0,!0]),P=e.getBucket(o);if(!P)return;const A=c.key;let D=o.heatmapFbos.get(A);D||(D=Ks(m,e.tileSize,e.tileSize),o.heatmapFbos.set(A,D)),m.bindFramebuffer.set(D.framebuffer),m.viewport.set([0,0,e.tileSize,e.tileSize]),m.clear({color:a.b6.transparent});const L=P.programConfigurations.get(o.id),U=p.useProgram("heatmap",L,!h),G=p.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),J=p.style.map.terrain.getTerrainData(c);U.draw(m,v.TRIANGLES,$t.disabled,w,T,Xt.disabled,pc(e,p.transform.zoom,o.paint.get("heatmap-intensity"),1),J,G,o.id,P.layoutVertexBuffer,P.indexBuffer,P.segments,o.paint,p.transform.zoom,L)}function Rh(p,e,o,c,h){const m=p.context,v=m.gl,w=p.transform;m.setColorMode(p.colorModeForRenderPass());const T=rl(m,e),P=o.key,A=e.heatmapFbos.get(P);if(!A)return;m.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,A.colorAttachment.get()),m.activeTexture.set(v.TEXTURE1),T.bind(v.LINEAR,v.CLAMP_TO_EDGE);const D=w.getProjectionData({overscaledTileID:o,applyTerrainMatrix:h,applyGlobeMatrix:!c});p.useProgram("heatmapTexture").draw(m,v.TRIANGLES,$t.disabled,Kt.disabled,p.colorModeForRenderPass(),Xt.disabled,mc(p,e,0,1),null,D,e.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments,e.paint,w.zoom),A.destroy(),e.heatmapFbos.delete(P)}function Ks(p,e,o){var c,h;const m=p.gl,v=m.createTexture();m.bindTexture(m.TEXTURE_2D,v),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const w=(c=p.HALF_FLOAT)!==null&&c!==void 0?c:m.UNSIGNED_BYTE,T=(h=p.RGBA16F)!==null&&h!==void 0?h:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,T,e,o,0,m.RGBA,w,null);const P=p.createFramebuffer(e,o,!1,!1);return P.colorAttachment.set(v),P}function rl(p,e){return e.colorRampTexture||(e.colorRampTexture=new st(p,e.colorRamp,p.gl.RGBA)),e.colorRampTexture}function Pc(p,e,o,c,h){if(!o||!c||!c.imageAtlas)return;const m=c.imageAtlas.patternPositions;let v=m[o.to.toString()],w=m[o.from.toString()];if(!v&&w&&(v=w),!w&&v&&(w=v),!v||!w){const T=h.getPaintProperty(e);v=m[T],w=m[T]}v&&w&&p.setConstantPatternPositions(v,w)}function Mc(p,e,o,c,h,m,v,w){const T=p.context.gl,P="fill-pattern",A=o.paint.get(P),D=A&&A.constantOr(1),L=o.getCrossfadeParameters();let U,G,J,K,Q;const re=p.transform,se=o.paint.get("fill-translate"),le=o.paint.get("fill-translate-anchor");v?(G=D&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",U=T.LINES):(G=D?"fillPattern":"fill",U=T.TRIANGLES);const ue=A.constantOr(null);for(const fe of c){const he=e.getTile(fe);if(D&&!he.patternsLoaded())continue;const we=he.getBucket(o);if(!we)continue;const Se=we.programConfigurations.get(o.id),Re=p.useProgram(G,Se),Le=p.style.map.terrain&&p.style.map.terrain.getTerrainData(fe);D&&(p.context.activeTexture.set(T.TEXTURE0),he.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),Se.updatePaintBuffers(L)),Pc(Se,P,ue,he,o);const ze=re.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!w,applyTerrainMatrix:!0}),rt=a.aw(re,he,se,le);if(v){K=we.indexBuffer2,Q=we.segments2;const Ue=[T.drawingBufferWidth,T.drawingBufferHeight];J=G==="fillOutlinePattern"&&D?If(p,L,he,Ue,rt):fh(Ue,rt)}else K=we.indexBuffer,Q=we.segments,J=D?dh(p,L,he,rt):{u_fill_translate:rt};let et;if(p.renderPass==="translucent"&&w){const[Ue]=p.getStencilConfigForOverlapAndUpdateStencilID(c);et=Ue[fe.overscaledZ]}else et=p.stencilModeForClipping(fe);Re.draw(p.context,U,h,et,m,Xt.backCCW,J,Le,ze,o.id,we.layoutVertexBuffer,K,Q,o.paint,p.transform.zoom,Se)}}function us(p,e,o,c,h,m,v,w){const T=p.context,P=T.gl,A="fill-extrusion-pattern",D=o.paint.get(A),L=D.constantOr(1),U=o.getCrossfadeParameters(),G=o.paint.get("fill-extrusion-opacity"),J=D.constantOr(null),K=p.transform;for(const Q of c){const re=e.getTile(Q),se=re.getBucket(o);if(!se)continue;const le=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Q),ue=se.programConfigurations.get(o.id),fe=p.useProgram(L?"fillExtrusionPattern":"fillExtrusion",ue);L&&(p.context.activeTexture.set(P.TEXTURE0),re.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),ue.updatePaintBuffers(U));const he=K.getProjectionData({overscaledTileID:Q,applyGlobeMatrix:!w,applyTerrainMatrix:!0});Pc(ue,A,J,re,o);const we=a.aw(K,re,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Se=o.paint.get("fill-extrusion-vertical-gradient"),Re=L?ss(p,Se,G,we,Q,U,re):hh(p,Se,G,we);fe.draw(T,T.gl.TRIANGLES,h,m,v,Xt.backCCW,Re,le,he,o.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,o.paint,p.transform.zoom,ue,p.style.map.terrain&&se.centroidVertexBuffer)}}function Js(p,e,o,c,h,m,v,w,T){var P;const A=p.style.projection,D=p.context,L=p.transform,U=D.gl,G=p.useProgram("hillshade"),J=!p.options.moving;for(const K of c){const Q=e.getTile(K),re=Q.fbo;if(!re)continue;const se=A.getMeshFromTileID(D,K.canonical,w,!0,"raster"),le=(P=p.style.map.terrain)===null||P===void 0?void 0:P.getTerrainData(K);D.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,re.colorAttachment.get());const ue=L.getProjectionData({overscaledTileID:K,aligned:J,applyGlobeMatrix:!T,applyTerrainMatrix:!0});G.draw(D,U.TRIANGLES,m,h[K.overscaledZ],v,Xt.backCCW,ki(p,Q,o),le,ue,o.id,se.vertexBuffer,se.indexBuffer,se.segments)}}const Ic=[new a.P(0,0),new a.P(a.Z,0),new a.P(a.Z,a.Z),new a.P(0,a.Z)];function Qs(p,e,o,c,h,m,v,w,T=!1,P=!1){const A=c[c.length-1].overscaledZ,D=p.context,L=D.gl,U=p.useProgram("raster"),G=p.transform,J=p.style.projection,K=p.colorModeForRenderPass(),Q=!p.options.moving;for(const re of c){const se=p.getDepthModeForSublayer(re.overscaledZ-A,o.paint.get("raster-opacity")===1?$t.ReadWrite:$t.ReadOnly,L.LESS),le=e.getTile(re);le.registerFadeDuration(o.paint.get("raster-fade-duration"));const ue=e.findLoadedParent(re,0),fe=e.findLoadedSibling(re),he=Nr(le,ue||fe||null,e,o,p.transform,p.style.map.terrain);let we,Se;const Re=o.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;D.activeTexture.set(L.TEXTURE0),le.texture.bind(Re,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),D.activeTexture.set(L.TEXTURE1),ue?(ue.texture.bind(Re,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),we=Math.pow(2,ue.tileID.overscaledZ-le.tileID.overscaledZ),Se=[le.tileID.canonical.x*we%1,le.tileID.canonical.y*we%1]):le.texture.bind(Re,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),le.texture.useMipmap&&D.extTextureFilterAnisotropic&&p.transform.pitch>20&&L.texParameterf(L.TEXTURE_2D,D.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,D.extTextureFilterAnisotropicMax);const Le=p.style.map.terrain&&p.style.map.terrain.getTerrainData(re),ze=G.getProjectionData({overscaledTileID:re,aligned:Q,applyGlobeMatrix:!P,applyTerrainMatrix:!0}),rt=vh(Se||[0,0],we||1,he,o,w),et=J.getMeshFromTileID(D,re.canonical,m,v,"raster");U.draw(D,L.TRIANGLES,se,h?h[re.overscaledZ]:Kt.disabled,K,T?Xt.frontCCW:Xt.backCCW,rt,Le,ze,o.id,et.vertexBuffer,et.indexBuffer,et.segments)}}function Nr(p,e,o,c,h,m){const v=c.paint.get("raster-fade-duration");if(!m&&v>0){const w=q.now(),T=(w-p.timeAdded)/v,P=e?(w-e.timeAdded)/v:-1,A=o.getSource(),D=io(h,{tileSize:A.tileSize,roundZoom:A.roundZoom}),L=!e||Math.abs(e.tileID.overscaledZ-D)>Math.abs(p.tileID.overscaledZ-D),U=L&&p.refreshedUponExpiration?1:a.ad(L?T:1-P,0,1);return p.refreshedUponExpiration&&T>=1&&(p.refreshedUponExpiration=!1),e?{opacity:1,mix:1-U}:{opacity:U,mix:0}}return{opacity:1,mix:0}}const Ri=new a.b6(1,0,0,1),fo=new a.b6(0,1,0,1),Ec=new a.b6(0,0,1,1),Ac=new a.b6(1,0,1,1),Dh=new a.b6(0,1,1,1);function Di(p,e,o,c){ds(p,0,e+o/2,p.transform.width,o,c)}function hs(p,e,o,c){ds(p,e-o/2,0,o,p.transform.height,c)}function ds(p,e,o,c,h,m){const v=p.context,w=v.gl;w.enable(w.SCISSOR_TEST),w.scissor(e*p.pixelRatio,o*p.pixelRatio,c*p.pixelRatio,h*p.pixelRatio),v.clear({color:m}),w.disable(w.SCISSOR_TEST)}function Lh(p,e,o){const c=p.context,h=c.gl,m=p.useProgram("debug"),v=$t.disabled,w=Kt.disabled,T=p.colorModeForRenderPass(),P="$debug",A=p.style.map.terrain&&p.style.map.terrain.getTerrainData(o);c.activeTexture.set(h.TEXTURE0);const D=e.getTileByID(o.key).latestRawTileData,L=Math.floor((D&&D.byteLength||0)/1024),U=e.getTile(o).tileSize,G=512/Math.min(U,512)*(o.overscaledZ/p.transform.zoom)*.5;let J=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(J+=` => ${o.overscaledZ}`),function(Q,re){Q.initDebugOverlayCanvas();const se=Q.debugOverlayCanvas,le=Q.context.gl,ue=Q.debugOverlayCanvas.getContext("2d");ue.clearRect(0,0,se.width,se.height),ue.shadowColor="white",ue.shadowBlur=2,ue.lineWidth=1.5,ue.strokeStyle="white",ue.textBaseline="top",ue.font="bold 36px Open Sans, sans-serif",ue.fillText(re,5,5),ue.strokeText(re,5,5),Q.debugOverlayTexture.update(se),Q.debugOverlayTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE)}(p,`${J} ${L}kB`);const K=p.transform.getProjectionData({overscaledTileID:o,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(c,h.TRIANGLES,v,w,Sr.alphaBlended,Xt.disabled,fc(a.b6.transparent,G),null,K,P,p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments),m.draw(c,h.LINE_STRIP,v,w,T,Xt.disabled,fc(a.b6.red),A,K,P,p.debugBuffer,p.tileBorderIndexBuffer,p.debugSegments)}function zc(p,e,o,c){const{isRenderingGlobe:h}=c,m=p.context,v=m.gl,w=p.transform,T=p.colorModeForRenderPass(),P=p.getDepthModeFor3D(),A=p.useProgram("terrain");m.bindFramebuffer.set(null),m.viewport.set([0,0,p.width,p.height]);for(const D of o){const L=e.getTerrainMesh(D.tileID),U=p.renderToTexture.getTexture(D),G=e.getTerrainData(D.tileID);m.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,U.texture);const J=e.getMeshFrameDelta(w.zoom),K=w.calculateFogMatrix(D.tileID.toUnwrapped()),Q=hc(J,K,p.style.sky,w.pitch,h),re=w.getProjectionData({overscaledTileID:D.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});A.draw(m,v.TRIANGLES,P,Kt.disabled,T,Xt.backCCW,Q,G,re,"terrain",L.vertexBuffer,L.indexBuffer,L.segments)}}function Rc(p,e){if(!e.mesh){const o=new a.aE;o.emplaceBack(-1,-1),o.emplaceBack(1,-1),o.emplaceBack(1,1),o.emplaceBack(-1,1);const c=new a.aG;c.emplaceBack(0,1,2),c.emplaceBack(0,2,3),e.mesh=new Wn(p.createVertexBuffer(o,so.members),p.createIndexBuffer(c),a.aF.simpleSegment(0,0,o.length,c.length))}return e.mesh}class Bh{constructor(e,o){this.context=new Ka(e),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.as(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=z.maxUnderzooming+z.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new nc}resize(e,o,c){if(this.width=Math.floor(e*c),this.height=Math.floor(o*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const e=this.context,o=new a.aE;o.emplaceBack(0,0),o.emplaceBack(a.Z,0),o.emplaceBack(0,a.Z),o.emplaceBack(a.Z,a.Z),this.tileExtentBuffer=e.createVertexBuffer(o,so.members),this.tileExtentSegments=a.aF.simpleSegment(0,0,4,2);const c=new a.aE;c.emplaceBack(0,0),c.emplaceBack(a.Z,0),c.emplaceBack(0,a.Z),c.emplaceBack(a.Z,a.Z),this.debugBuffer=e.createVertexBuffer(c,so.members),this.debugSegments=a.aF.simpleSegment(0,0,4,5);const h=new a.bV;h.emplaceBack(0,0,0,0),h.emplaceBack(a.Z,0,a.Z,0),h.emplaceBack(0,a.Z,0,a.Z),h.emplaceBack(a.Z,a.Z,a.Z,a.Z),this.rasterBoundsBuffer=e.createVertexBuffer(h,zo.members),this.rasterBoundsSegments=a.aF.simpleSegment(0,0,4,2);const m=new a.aE;m.emplaceBack(0,0),m.emplaceBack(a.Z,0),m.emplaceBack(0,a.Z),m.emplaceBack(a.Z,a.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(m,so.members),this.rasterBoundsSegmentsPosOnly=a.aF.simpleSegment(0,0,4,5);const v=new a.aE;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(v,so.members),this.viewportSegments=a.aF.simpleSegment(0,0,4,2);const w=new a.bW;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(w);const T=new a.aG;T.emplaceBack(1,0,2),T.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(T);const P=this.context.gl;this.stencilClearMode=new Kt({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO),this.tileExtentMesh=new Wn(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,o=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=a.K();a.bN(c,0,this.width,this.height,0,0,1),a.M(c,c,[o.drawingBufferWidth,o.drawingBufferHeight,0]);const h={mainMatrix:c,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:c};this.useProgram("clippingMask",null,!0).draw(e,o.TRIANGLES,$t.disabled,this.stencilClearMode,Sr.disabled,Xt.disabled,null,null,h,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,o,c){if(this.currentStencilSource===e.source||!e.isTileClipped()||!o||!o.length)return;this.currentStencilSource=e.source,this.nextStencilID+o.length>256&&this.clearStencil();const h=this.context;h.setColorMode(Sr.disabled),h.setDepthMode($t.disabled);const m={};for(const v of o)m[v.key]=this.nextStencilID++;this._renderTileMasks(m,o,c,!0),this._renderTileMasks(m,o,c,!1),this._tileClippingMaskIDs=m}_renderTileMasks(e,o,c,h){const m=this.context,v=m.gl,w=this.style.projection,T=this.transform,P=this.useProgram("clippingMask");for(const A of o){const D=e[A.key],L=this.style.map.terrain&&this.style.map.terrain.getTerrainData(A),U=w.getMeshFromTileID(this.context,A.canonical,h,!0,"stencil"),G=T.getProjectionData({overscaledTileID:A,applyGlobeMatrix:!0,applyTerrainMatrix:!0});P.draw(m,v.TRIANGLES,$t.disabled,new Kt({func:v.ALWAYS,mask:0},D,255,v.KEEP,v.KEEP,v.REPLACE),Sr.disabled,c?Xt.disabled:Xt.backCCW,null,L,G,"$clipping",U.vertexBuffer,U.indexBuffer,U.segments)}}_renderTilesDepthBuffer(){const e=this.context,o=e.gl,c=this.style.projection,h=this.transform,m=this.useProgram("depth"),v=this.getDepthModeFor3D(),w=ge(h,{tileSize:h.tileSize});for(const T of w){const P=this.style.map.terrain&&this.style.map.terrain.getTerrainData(T),A=c.getMeshFromTileID(this.context,T.canonical,!0,!0,"raster"),D=h.getProjectionData({overscaledTileID:T,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(e,o.TRIANGLES,v,Kt.disabled,Sr.disabled,Xt.backCCW,null,P,D,"$clipping",A.vertexBuffer,A.indexBuffer,A.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,o=this.context.gl;return new Kt({func:o.NOTEQUAL,mask:255},e,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(e){const o=this.context.gl;return new Kt({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,o.KEEP,o.KEEP,o.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const o=this.context.gl,c=e.sort((v,w)=>w.overscaledZ-v.overscaledZ),h=c[c.length-1].overscaledZ,m=c[0].overscaledZ-h+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const v={};for(let w=0;w<m;w++)v[w+h]=new Kt({func:o.GEQUAL,mask:255},w+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=m,[v,c]}return[{[h]:Kt.disabled},c]}stencilConfigForOverlapTwoPass(e){const o=this.context.gl,c=e.sort((v,w)=>w.overscaledZ-v.overscaledZ),h=c[c.length-1].overscaledZ,m=c[0].overscaledZ-h+1;if(this.clearStencil(),m>1){const v={},w={};for(let T=0;T<m;T++)v[T+h]=new Kt({func:o.GREATER,mask:255},m+1+T,255,o.KEEP,o.KEEP,o.REPLACE),w[T+h]=new Kt({func:o.GREATER,mask:255},1+T,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID=2*m+1,[v,w,c]}return this.nextStencilID=3,[{[h]:new Kt({func:o.GREATER,mask:255},2,255,o.KEEP,o.KEEP,o.REPLACE)},{[h]:new Kt({func:o.GREATER,mask:255},1,255,o.KEEP,o.KEEP,o.REPLACE)},c]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Sr([e.CONSTANT_COLOR,e.ONE],new a.b6(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Sr.unblended:Sr.alphaBlended}getDepthModeForSublayer(e,o,c){if(!this.opaquePassEnabledForLayer())return $t.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new $t(c||this.context.gl.LEQUAL,o,[h,h])}getDepthModeFor3D(){return new $t(this.context.gl.LEQUAL,$t.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,o){var c,h;this.style=e,this.options=o,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(q.now()),this.imageManager.beginFrame();const m=this.style._order,v=this.style.sourceCaches,w={},T={},P={},A={isRenderingToTexture:!1,isRenderingGlobe:((c=e.projection)===null||c===void 0?void 0:c.transitionState)>0};for(const L in v){const U=v[L];U.used&&U.prepare(this.context),w[L]=U.getVisibleCoordinates(!1),T[L]=w[L].slice().reverse(),P[L]=U.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let L=0;L<m.length;L++)if(this.style._layers[m[L]].is3D()){this.opaquePassCutoff=L;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const L of m){const U=this.style._layers[L];if(!U.hasOffscreenPass()||U.isHidden(this.transform.zoom))continue;const G=T[U.source];(U.type==="custom"||G.length)&&this.renderLayer(this,v[U.source],U,G,A)}if((h=this.style.projection)===null||h===void 0||h.updateGPUdependent({context:this.context,useProgram:L=>this.useProgram(L)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?a.b6.black:a.b6.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(L,U){const G=L.context,J=G.gl,K=((fe,he,we)=>{const Se=Math.cos(he.rollInRadians),Re=Math.sin(he.rollInRadians),Le=un(he),ze=he.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:fe.properties.get("sky-color"),u_horizon_color:fe.properties.get("horizon-color"),u_horizon:[(he.width/2-Le*Re)*we,(he.height/2+Le*Se)*we],u_horizon_normal:[-Re,Se],u_sky_horizon_blend:fe.properties.get("sky-horizon-blend")*he.height/2*we,u_sky_blend:ze}})(U,L.style.map.transform,L.pixelRatio),Q=new $t(J.LEQUAL,$t.ReadWrite,[0,1]),re=Kt.disabled,se=L.colorModeForRenderPass(),le=L.useProgram("sky"),ue=Rc(G,U);le.draw(G,J.TRIANGLES,Q,re,se,Xt.disabled,K,null,void 0,"sky",ue.vertexBuffer,ue.indexBuffer,ue.segments)}(this,this.style.sky),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const L=this.style._layers[m[this.currentLayer]],U=v[L.source],G=w[L.source];this._renderTileClippingMasks(L,G,!1),this.renderLayer(this,U,L,G,A)}this.renderPass="translucent";let D=!1;for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const L=this.style._layers[m[this.currentLayer]],U=v[L.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(L,A))continue;this.opaquePassEnabledForLayer()||D||(D=!0,A.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const G=(L.type==="symbol"?P:T)[L.source];this._renderTileClippingMasks(L,w[L.source],!1),this.renderLayer(this,U,L,G,A)}if(A.isRenderingGlobe&&function(L,U,G){const J=L.context,K=J.gl,Q=L.useProgram("atmosphere"),re=new $t(K.LEQUAL,$t.ReadOnly,[0,1]),se=L.transform,le=function(ze,rt){const et=ze.properties.get("position"),Ue=[-et.x,-et.y,-et.z],yt=a.as(new Float64Array(16));return ze.properties.get("anchor")==="map"&&(a.aZ(yt,yt,rt.rollInRadians),a.a_(yt,yt,-rt.pitchInRadians),a.aZ(yt,yt,rt.bearingInRadians),a.a_(yt,yt,rt.center.lat*Math.PI/180),a.bl(yt,yt,-rt.center.lng*Math.PI/180)),a.bU(Ue,Ue,yt),Ue}(G,L.transform),ue=se.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),fe=U.properties.get("atmosphere-blend")*ue.projectionTransition;if(fe===0)return;const he=Mn(se.worldSize,se.center.lat),we=se.inverseProjectionMatrix,Se=new Float64Array(4);Se[3]=1,a.ao(Se,Se,se.modelViewProjectionMatrix),Se[0]/=Se[3],Se[1]/=Se[3],Se[2]/=Se[3],Se[3]=1,a.ao(Se,Se,we),Se[0]/=Se[3],Se[1]/=Se[3],Se[2]/=Se[3],Se[3]=1;const Re=((ze,rt,et,Ue,yt)=>({u_sun_pos:ze,u_atmosphere_blend:rt,u_globe_position:et,u_globe_radius:Ue,u_inv_proj_matrix:yt}))(le,fe,[Se[0],Se[1],Se[2]],he,we),Le=Rc(J,U);Q.draw(J,K.TRIANGLES,re,Kt.disabled,Sr.alphaBlended,Xt.disabled,Re,null,null,"atmosphere",Le.vertexBuffer,Le.indexBuffer,Le.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const L=function(U,G){let J=null;const K=Object.values(U._layers).flatMap(le=>le.source&&!le.isHidden(G)?[U.sourceCaches[le.source]]:[]),Q=K.filter(le=>le.getSource().type==="vector"),re=K.filter(le=>le.getSource().type!=="vector"),se=le=>{(!J||J.getSource().maxzoom<le.getSource().maxzoom)&&(J=le)};return Q.forEach(le=>se(le)),J||re.forEach(le=>se(le)),J}(this.style,this.transform.zoom);L&&function(U,G,J){for(let K=0;K<J.length;K++)Lh(U,G,J[K])}(this,L,L.getVisibleCoordinates())}this.options.showPadding&&function(L){const U=L.transform.padding;Di(L,L.transform.height-(U.top||0),3,Ri),Di(L,U.bottom||0,3,fo),hs(L,U.left||0,3,Ec),hs(L,L.transform.width-(U.right||0),3,Ac);const G=L.transform.centerPoint;(function(J,K,Q,re){ds(J,K-1,Q-10,2,20,re),ds(J,K-10,Q-1,20,2,re)})(L,G.x,L.transform.height-G.y,Dh)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let h=this.terrainFacilitator.dirty;h||(h=e?!a.bX(o,c):!a.bY(o,c)),h||(h=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),h&&(a.bZ(o,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,v){const w=m.context,T=w.gl,P=m.transform,A=Sr.unblended,D=new $t(T.LEQUAL,$t.ReadWrite,[0,1]),L=v.sourceCache.getRenderableTiles(),U=m.useProgram("terrainDepth");w.bindFramebuffer.set(v.getFramebuffer("depth").framebuffer),w.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),w.clear({color:a.b6.transparent,depth:1});for(const G of L){const J=v.getTerrainMesh(G.tileID),K=v.getTerrainData(G.tileID),Q=P.getProjectionData({overscaledTileID:G.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),re={u_ele_delta:v.getMeshFrameDelta(P.zoom)};U.draw(w,T.TRIANGLES,D,Kt.disabled,A,Xt.backCCW,re,K,Q,"terrain",J.vertexBuffer,J.indexBuffer,J.segments)}w.bindFramebuffer.set(null),w.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,v){const w=m.context,T=w.gl,P=m.transform,A=Sr.unblended,D=new $t(T.LEQUAL,$t.ReadWrite,[0,1]),L=v.getCoordsTexture(),U=v.sourceCache.getRenderableTiles(),G=m.useProgram("terrainCoords");w.bindFramebuffer.set(v.getFramebuffer("coords").framebuffer),w.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),w.clear({color:a.b6.transparent,depth:1}),v.coordsIndex=[];for(const J of U){const K=v.getTerrainMesh(J.tileID),Q=v.getTerrainData(J.tileID);w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,L.texture);const re={u_terrain_coords_id:(255-v.coordsIndex.length)/255,u_texture:0,u_ele_delta:v.getMeshFrameDelta(P.zoom)},se=P.getProjectionData({overscaledTileID:J.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});G.draw(w,T.TRIANGLES,D,Kt.disabled,A,Xt.backCCW,re,Q,se,"terrain",K.vertexBuffer,K.indexBuffer,K.segments),v.coordsIndex.push(J.tileID.key)}w.bindFramebuffer.set(null),w.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(e,o,c,h,m){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(h||[]).length)&&(this.id=c.id,a.b_(c)?function(v,w,T,P,A,D){if(v.renderPass!=="translucent")return;const{isRenderingToTexture:L}=D,U=Kt.disabled,G=v.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(J,K,Q,re,se,le,ue,fe,he){const we=K.transform,Se=K.style.map.terrain,Re=se==="map",Le=le==="map";for(const ze of J){const rt=re.getTile(ze),et=rt.getBucket(Q);if(!et||!et.text||!et.text.segments.get().length)continue;const Ue=a.af(et.textSizeData,we.zoom),yt=a.av(rt,1,K.transform.zoom),Ct=Te(Re,K.transform,yt),rr=Q.layout.get("icon-text-fit")!=="none"&&et.hasIconData();if(Ue){const gr=Math.pow(2,we.zoom-rt.tileID.overscaledZ),ur=Se?(kr,xr)=>Se.getElevation(ze,kr,xr):null;el(et,Re,Le,he,we,Ct,gr,Ue,rr,a.aw(we,rt,ue,fe),ze.toUnwrapped(),ur)}}}(P,v,T,w,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),A),T.paint.get("icon-opacity").constantOr(1)!==0&&zh(v,w,T,P,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),U,G,L),T.paint.get("text-opacity").constantOr(1)!==0&&zh(v,w,T,P,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),U,G,L),w.map.showCollisionBoxes&&(Ja(v,w,T,P,!0),Ja(v,w,T,P,!1))}(e,o,c,h,this.style.placement.variableOffsets,m):a.b$(c)?function(v,w,T,P,A){if(v.renderPass!=="translucent")return;const{isRenderingToTexture:D}=A,L=T.paint.get("circle-opacity"),U=T.paint.get("circle-stroke-width"),G=T.paint.get("circle-stroke-opacity"),J=!T.layout.get("circle-sort-key").isConstant();if(L.constantOr(1)===0&&(U.constantOr(1)===0||G.constantOr(1)===0))return;const K=v.context,Q=K.gl,re=v.transform,se=v.getDepthModeForSublayer(0,$t.ReadOnly),le=Kt.disabled,ue=v.colorModeForRenderPass(),fe=[],he=re.getCircleRadiusCorrection();for(let we=0;we<P.length;we++){const Se=P[we],Re=w.getTile(Se),Le=Re.getBucket(T);if(!Le)continue;const ze=T.paint.get("circle-translate"),rt=T.paint.get("circle-translate-anchor"),et=a.aw(re,Re,ze,rt),Ue=Le.programConfigurations.get(T.id),yt=v.useProgram("circle",Ue),Ct=Le.layoutVertexBuffer,rr=Le.indexBuffer,gr=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Se),ur={programConfiguration:Ue,program:yt,layoutVertexBuffer:Ct,indexBuffer:rr,uniformValues:ph(v,Re,T,et,he),terrainData:gr,projectionData:re.getProjectionData({overscaledTileID:Se,applyGlobeMatrix:!D,applyTerrainMatrix:!0})};if(J){const kr=Le.segments.get();for(const xr of kr)fe.push({segments:new a.aF([xr]),sortKey:xr.sortKey,state:ur})}else fe.push({segments:Le.segments,sortKey:0,state:ur})}J&&fe.sort((we,Se)=>we.sortKey-Se.sortKey);for(const we of fe){const{programConfiguration:Se,program:Re,layoutVertexBuffer:Le,indexBuffer:ze,uniformValues:rt,terrainData:et,projectionData:Ue}=we.state;Re.draw(K,Q.TRIANGLES,se,le,ue,Xt.backCCW,rt,et,Ue,T.id,Le,ze,we.segments,T.paint,v.transform.zoom,Se)}}(e,o,c,h,m):a.c0(c)?function(v,w,T,P,A){if(T.paint.get("heatmap-opacity")===0)return;const D=v.context,{isRenderingToTexture:L,isRenderingGlobe:U}=A;if(v.style.map.terrain){for(const G of P){const J=w.getTile(G);w.hasRenderableParent(G)||(v.renderPass==="offscreen"?jf(v,J,T,G,U):v.renderPass==="translucent"&&Rh(v,T,G,L,U))}D.viewport.set([0,0,v.width,v.height])}else v.renderPass==="offscreen"?function(G,J,K,Q){const re=G.context,se=re.gl,le=G.transform,ue=Kt.disabled,fe=new Sr([se.ONE,se.ONE],a.b6.transparent,[!0,!0,!0,!0]);(function(he,we,Se){const Re=he.gl;he.activeTexture.set(Re.TEXTURE1),he.viewport.set([0,0,we.width/4,we.height/4]);let Le=Se.heatmapFbos.get(a.bR);Le?(Re.bindTexture(Re.TEXTURE_2D,Le.colorAttachment.get()),he.bindFramebuffer.set(Le.framebuffer)):(Le=Ks(he,we.width/4,we.height/4),Se.heatmapFbos.set(a.bR,Le))})(re,G,K),re.clear({color:a.b6.transparent});for(let he=0;he<Q.length;he++){const we=Q[he];if(J.hasRenderableParent(we))continue;const Se=J.getTile(we),Re=Se.getBucket(K);if(!Re)continue;const Le=Re.programConfigurations.get(K.id),ze=G.useProgram("heatmap",Le),rt=le.getProjectionData({overscaledTileID:we,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),et=le.getCircleRadiusCorrection();ze.draw(re,se.TRIANGLES,$t.disabled,ue,fe,Xt.backCCW,pc(Se,le.zoom,K.paint.get("heatmap-intensity"),et),null,rt,K.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,K.paint,le.zoom,Le)}re.viewport.set([0,0,G.width,G.height])}(v,w,T,P):v.renderPass==="translucent"&&function(G,J){const K=G.context,Q=K.gl;K.setColorMode(G.colorModeForRenderPass());const re=J.heatmapFbos.get(a.bR);re&&(K.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_2D,re.colorAttachment.get()),K.activeTexture.set(Q.TEXTURE1),rl(K,J).bind(Q.LINEAR,Q.CLAMP_TO_EDGE),G.useProgram("heatmapTexture").draw(K,Q.TRIANGLES,$t.disabled,Kt.disabled,G.colorModeForRenderPass(),Xt.disabled,mc(G,J,0,1),null,null,J.id,G.viewportBuffer,G.quadTriangleIndexBuffer,G.viewportSegments,J.paint,G.transform.zoom))}(v,T)}(e,o,c,h,m):a.c1(c)?function(v,w,T,P,A){if(v.renderPass!=="translucent")return;const{isRenderingToTexture:D}=A,L=T.paint.get("line-opacity"),U=T.paint.get("line-width");if(L.constantOr(1)===0||U.constantOr(1)===0)return;const G=v.getDepthModeForSublayer(0,$t.ReadOnly),J=v.colorModeForRenderPass(),K=T.paint.get("line-dasharray"),Q=T.paint.get("line-pattern"),re=Q.constantOr(1),se=T.paint.get("line-gradient"),le=T.getCrossfadeParameters(),ue=re?"linePattern":K?"lineSDF":se?"lineGradient":"line",fe=v.context,he=fe.gl,we=v.transform;let Se=!0;for(const Re of P){const Le=w.getTile(Re);if(re&&!Le.patternsLoaded())continue;const ze=Le.getBucket(T);if(!ze)continue;const rt=ze.programConfigurations.get(T.id),et=v.context.program.get(),Ue=v.useProgram(ue,rt),yt=Se||Ue.program!==et,Ct=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Re),rr=Q.constantOr(null);if(rr&&Le.imageAtlas){const or=Le.imageAtlas,hr=or.patternPositions[rr.to.toString()],dn=or.patternPositions[rr.from.toString()];hr&&dn&&rt.setConstantPatternPositions(hr,dn)}const gr=we.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!D,applyTerrainMatrix:!0}),ur=we.getPixelScale(),kr=re?ja(v,Le,T,ur,le):K?Af(v,Le,T,ur,K,le):se?Ef(v,Le,T,ur,ze.lineClipsArray.length):Pi(v,Le,T,ur);if(re)fe.activeTexture.set(he.TEXTURE0),Le.imageAtlasTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE),rt.updatePaintBuffers(le);else if(K&&(yt||v.lineAtlas.dirty))fe.activeTexture.set(he.TEXTURE0),v.lineAtlas.bind(fe);else if(se){const or=ze.gradients[T.id];let hr=or.texture;if(T.gradientVersion!==or.version){let dn=256;if(T.stepInterpolant){const fn=w.getSource().maxzoom,en=Re.canonical.z===fn?Math.ceil(1<<v.transform.maxZoom-Re.canonical.z):1;dn=a.ad(a.bS(ze.maxLineLength/a.Z*1024*en),256,fe.maxTextureSize)}or.gradient=a.bT({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:dn,image:or.gradient||void 0,clips:ze.lineClipsArray}),or.texture?or.texture.update(or.gradient):or.texture=new st(fe,or.gradient,he.RGBA),or.version=T.gradientVersion,hr=or.texture}fe.activeTexture.set(he.TEXTURE0),hr.bind(T.stepInterpolant?he.NEAREST:he.LINEAR,he.CLAMP_TO_EDGE)}let xr;if(D){const[or]=v.getStencilConfigForOverlapAndUpdateStencilID(P);xr=or[Re.overscaledZ]}else xr=v.stencilModeForClipping(Re);Ue.draw(fe,he.TRIANGLES,G,xr,J,Xt.disabled,kr,Ct,gr,T.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,T.paint,v.transform.zoom,rt,ze.layoutVertexBuffer2),Se=!1}}(e,o,c,h,m):a.c2(c)?function(v,w,T,P,A){const D=T.paint.get("fill-color"),L=T.paint.get("fill-opacity");if(L.constantOr(1)===0)return;const{isRenderingToTexture:U}=A,G=v.colorModeForRenderPass(),J=T.paint.get("fill-pattern"),K=v.opaquePassEnabledForLayer()&&!J.constantOr(1)&&D.constantOr(a.b6.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===K){const Q=v.getDepthModeForSublayer(1,v.renderPass==="opaque"?$t.ReadWrite:$t.ReadOnly);Mc(v,w,T,P,Q,G,!1,U)}if(v.renderPass==="translucent"&&T.paint.get("fill-antialias")){const Q=v.getDepthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,$t.ReadOnly);Mc(v,w,T,P,Q,G,!0,U)}}(e,o,c,h,m):a.c3(c)?function(v,w,T,P,A){const D=T.paint.get("fill-extrusion-opacity");if(D===0)return;const{isRenderingToTexture:L}=A;if(v.renderPass==="translucent"){const U=new $t(v.context.gl.LEQUAL,$t.ReadWrite,v.depthRangeFor3D);if(D!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))us(v,w,T,P,U,Kt.disabled,Sr.disabled,L),us(v,w,T,P,U,v.stencilModeFor3D(),v.colorModeForRenderPass(),L);else{const G=v.colorModeForRenderPass();us(v,w,T,P,U,Kt.disabled,G,L)}}}(e,o,c,h,m):a.c4(c)?function(v,w,T,P,A){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const{isRenderingToTexture:D}=A,L=v.context,U=v.style.projection.useSubdivision,G=v.getDepthModeForSublayer(0,$t.ReadOnly),J=v.colorModeForRenderPass();if(v.renderPass==="offscreen")(function(K,Q,re,se,le,ue,fe){const he=K.context,we=he.gl;for(const Se of re){const Re=Q.getTile(Se),Le=Re.dem;if(!Le||!Le.data||!Re.needsHillshadePrepare)continue;const ze=Le.dim,rt=Le.stride,et=Le.getPixels();if(he.activeTexture.set(we.TEXTURE1),he.pixelStoreUnpackPremultiplyAlpha.set(!1),Re.demTexture=Re.demTexture||K.getTileTexture(rt),Re.demTexture){const yt=Re.demTexture;yt.update(et,{premultiply:!1}),yt.bind(we.NEAREST,we.CLAMP_TO_EDGE)}else Re.demTexture=new st(he,et,we.RGBA,{premultiply:!1}),Re.demTexture.bind(we.NEAREST,we.CLAMP_TO_EDGE);he.activeTexture.set(we.TEXTURE0);let Ue=Re.fbo;if(!Ue){const yt=new st(he,{width:ze,height:ze,data:null},we.RGBA);yt.bind(we.LINEAR,we.CLAMP_TO_EDGE),Ue=Re.fbo=he.createFramebuffer(ze,ze,!0,!1),Ue.colorAttachment.set(yt.texture)}he.bindFramebuffer.set(Ue.framebuffer),he.viewport.set([0,0,ze,ze]),K.useProgram("hillshadePrepare").draw(he,we.TRIANGLES,le,ue,fe,Xt.disabled,gh(Re.tileID,Le),null,null,se.id,K.rasterBoundsBuffer,K.quadTriangleIndexBuffer,K.rasterBoundsSegments),Re.needsHillshadePrepare=!1}})(v,w,P,T,G,Kt.disabled,J),L.viewport.set([0,0,v.width,v.height]);else if(v.renderPass==="translucent")if(U){const[K,Q,re]=v.stencilConfigForOverlapTwoPass(P);Js(v,w,T,re,K,G,J,!1,D),Js(v,w,T,re,Q,G,J,!0,D)}else{const[K,Q]=v.getStencilConfigForOverlapAndUpdateStencilID(P);Js(v,w,T,Q,K,G,J,!1,D)}}(e,o,c,h,m):a.c5(c)?function(v,w,T,P,A){if(v.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!P.length)return;const{isRenderingToTexture:D}=A,L=w.getSource(),U=v.style.projection.useSubdivision;if(L instanceof nt)Qs(v,w,T,P,null,!1,!1,L.tileCoords,L.flippedWindingOrder,D);else if(U){const[G,J,K]=v.stencilConfigForOverlapTwoPass(P);Qs(v,w,T,K,G,!1,!0,Ic,!1,D),Qs(v,w,T,K,J,!0,!0,Ic,!1,D)}else{const[G,J]=v.getStencilConfigForOverlapAndUpdateStencilID(P);Qs(v,w,T,J,G,!1,!0,Ic,!1,D)}}(e,o,c,h,m):a.c6(c)?function(v,w,T,P,A){const D=T.paint.get("background-color"),L=T.paint.get("background-opacity");if(L===0)return;const{isRenderingToTexture:U}=A,G=v.context,J=G.gl,K=v.style.projection,Q=v.transform,re=Q.tileSize,se=T.paint.get("background-pattern");if(v.isPatternMissing(se))return;const le=!se&&D.a===1&&L===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==le)return;const ue=Kt.disabled,fe=v.getDepthModeForSublayer(0,le==="opaque"?$t.ReadWrite:$t.ReadOnly),he=v.colorModeForRenderPass(),we=v.useProgram(se?"backgroundPattern":"background"),Se=P||ge(Q,{tileSize:re,terrain:v.style.map.terrain});se&&(G.activeTexture.set(J.TEXTURE0),v.imageManager.bind(v.context));const Re=T.getCrossfadeParameters();for(const Le of Se){const ze=Q.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!U,applyTerrainMatrix:!0}),rt=se?yc(L,v,se,{tileID:Le,tileSize:re},Re):qo(L,D),et=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Le),Ue=K.getMeshFromTileID(G,Le.canonical,!1,!0,"raster");we.draw(G,J.TRIANGLES,fe,ue,he,Xt.backCCW,rt,et,ze,T.id,Ue.vertexBuffer,Ue.indexBuffer,Ue.segments)}}(e,0,c,h,m):a.c7(c)&&function(v,w,T,P){const{isRenderingGlobe:A}=P,D=v.context,L=T.implementation,U=v.style.projection,G=v.transform,J=G.getProjectionDataForCustomLayer(A),K={farZ:G.farZ,nearZ:G.nearZ,fov:G.fov*Math.PI/180,modelViewProjectionMatrix:G.modelViewProjectionMatrix,projectionMatrix:G.projectionMatrix,shaderData:{variantName:U.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${U.shaderPreludeCode.vertexSource}`,define:U.shaderDefine},defaultProjectionData:J},Q=L.renderingMode?L.renderingMode:"2d";if(v.renderPass==="offscreen"){const re=L.prerender;re&&(v.setCustomLayerDefaults(),D.setColorMode(v.colorModeForRenderPass()),re.call(L,D.gl,K),D.setDirty(),v.setBaseState())}else if(v.renderPass==="translucent"){v.setCustomLayerDefaults(),D.setColorMode(v.colorModeForRenderPass()),D.setStencilMode(Kt.disabled);const re=Q==="3d"?v.getDepthModeFor3D():v.getDepthModeForSublayer(0,$t.ReadOnly);D.setDepthMode(re),L.render(D.gl,K),D.setDirty(),v.setBaseState(),D.bindFramebuffer.set(null)}}(e,0,c,m))}saveTileTexture(e){const o=this._tileTextures[e.size[0]];o?o.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const o=this._tileTextures[e];return o&&o.length>0?o.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const o=this.imageManager.getPattern(e.from.toString()),c=this.imageManager.getPattern(e.to.toString());return!o||!c}useProgram(e,o,c=!1){this.cache=this.cache||{};const h=!!this.style.map.terrain,m=this.style.projection,v=e+(o?o.cacheKey:"")+`/${c?Ia:m.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(h?"/terrain":"");return this.cache[v]||(this.cache[v]=new Mf(this.context,wo[e],o,vc[e],this._showOverdrawInspector,h,c?wo.projectionMercator:m.shaderPreludeCode,c?Qt:m.shaderDefine)),this.cache[v]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new st(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:o}=this.context.gl;return this.width!==e||this.height!==o}}function Dc(p,e){let o,c=!1,h=null,m=null;const v=()=>{h=null,c&&(p.apply(m,o),h=setTimeout(v,e),c=!1)};return(...w)=>(c=!0,m=this,o=w,h||v(),h)}class li{constructor(e){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let c;return o.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(c=h)}),(c&&c[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(!this._isValidHash(o))return!1;const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:c,pitch:+(o[4]||0)}),!0},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,o)},this._removeHash=()=>{const o=this._getCurrentHash();if(o.length===0)return;const c=o.join("/");let h=c;h.split("&").length>0&&(h=h.split("&")[0]),this._hashName&&(h=`${this._hashName}=${c}`);let m=window.location.hash.replace(h,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let v=window.location.href.replace(/(#.+)?$/,m);v=v.replace("&&","&"),window.history.replaceState(window.history.state,null,v)},this._updateHash=Dc(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const o=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,h=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,h),v=Math.round(o.lng*m)/m,w=Math.round(o.lat*m)/m,T=this._map.getBearing(),P=this._map.getPitch();let A="";if(A+=e?`/${v}/${w}/${c}`:`${c}/${w}/${v}`,(T||P)&&(A+="/"+Math.round(10*T)/10),P&&(A+=`/${Math.round(P)}`),this._hashName){const D=this._hashName;let L=!1;const U=window.location.hash.slice(1).split("&").map(G=>{const J=G.split("=")[0];return J===D?(L=!0,`${J}=${A}`):G}).filter(G=>G);return L||U.push(`${D}=${A}`),`#${U.join("&")}`}return`#${A}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new a.Q(+e[2],+e[1])}catch{return!1}const o=+e[0],c=+(e[3]||0),h=+(e[4]||0);return o>=this._map.getMinZoom()&&o<=this._map.getMaxZoom()&&c>=-180&&c<=180&&h>=this._map.getMinPitch()&&h<=this._map.getMaxPitch()}}const fs={linearity:.3,easing:a.c8(0,0,.3,1)},$h=a.e({deceleration:2500,maxSpeed:1400},fs),Oh=a.e({deceleration:20,maxSpeed:1400},fs),Fh=a.e({deceleration:1e3,maxSpeed:360},fs),jh=a.e({deceleration:1e3,maxSpeed:90},fs),Nh=a.e({deceleration:1e3,maxSpeed:360},fs);class Vh{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:q.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,o=q.now();for(;e.length>0&&o-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,roll:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)o.zoom+=m.zoomDelta||0,o.bearing+=m.bearingDelta||0,o.pitch+=m.pitchDelta||0,o.roll+=m.rollDelta||0,m.panDelta&&o.pan._add(m.panDelta),m.around&&(o.around=m.around),m.pinchAround&&(o.pinchAround=m.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(o.pan.mag()){const m=ps(o.pan.mag(),c,a.e({},$h,e||{})),v=o.pan.mult(m.amount/o.pan.mag()),w=this._map.cameraHelper.handlePanInertia(v,this._map.transform);h.center=w.easingCenter,h.offset=w.easingOffset,ci(h,m)}if(o.zoom){const m=ps(o.zoom,c,Oh);h.zoom=this._map.transform.zoom+m.amount,ci(h,m)}if(o.bearing){const m=ps(o.bearing,c,Fh);h.bearing=this._map.transform.bearing+a.ad(m.amount,-179,179),ci(h,m)}if(o.pitch){const m=ps(o.pitch,c,jh);h.pitch=this._map.transform.pitch+m.amount,ci(h,m)}if(o.roll){const m=ps(o.roll,c,Nh);h.roll=this._map.transform.roll+a.ad(m.amount,-179,179),ci(h,m)}if(h.zoom||h.bearing){const m=o.pinchAround===void 0?o.around:o.pinchAround;h.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),a.e(h,{noMoveStart:!0})}}function ci(p,e){(!p.duration||p.duration<e.duration)&&(p.duration=e.duration,p.easing=e.easing)}function ps(p,e,o){const{maxSpeed:c,linearity:h,deceleration:m}=o,v=a.ad(p*h/(e/1e3),-c,c),w=Math.abs(v)/(m*h);return{easing:o.easing,duration:1e3*w,amount:v*(w/2)}}class Lr extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,c,h={}){const m=V.mousePos(o.getCanvas(),c),v=o.unproject(m);super(e,a.e({point:m,lngLat:v,originalEvent:c},h)),this._defaultPrevented=!1,this.target=o}}class Fn extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,c){const h=e==="touchend"?c.changedTouches:c.touches,m=V.touchPos(o.getCanvasContainer(),h),v=m.map(T=>o.unproject(T)),w=m.reduce((T,P,A,D)=>T.add(P.div(D.length)),new a.P(0,0));super(e,{points:m,point:w,lngLats:v,lngLat:o.unproject(w),originalEvent:c}),this._defaultPrevented=!1}}class Lc extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,c){super(e,{originalEvent:c}),this._defaultPrevented=!1}}class Ro{constructor(e,o){this._map=e,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Lc(e.type,this._map,e))}mousedown(e,o){return this._mousedownPos=o,this._firePreventable(new Lr(e.type,this._map,e))}mouseup(e){this._map.fire(new Lr(e.type,this._map,e))}click(e,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new Lr(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Lr(e.type,this._map,e))}mouseover(e){this._map.fire(new Lr(e.type,this._map,e))}mouseout(e){this._map.fire(new Lr(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Fn(e.type,this._map,e))}touchmove(e){this._map.fire(new Fn(e.type,this._map,e))}touchend(e){this._map.fire(new Fn(e.type,this._map,e))}touchcancel(e){this._map.fire(new Fn(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ms{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Lr(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Lr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Lr(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ea{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(a.P.convert(e),this._map.terrain)}}class Uh{constructor(e,o){this._map=e,this._tr=new ea(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,o){this.isEnabled()&&e.shiftKey&&e.button===0&&(V.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(e,o){if(!this._active)return;const c=o;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=c,this._box||(this._box=V.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const m=Math.min(h.x,c.x),v=Math.max(h.x,c.x),w=Math.min(h.y,c.y),T=Math.max(h.y,c.y);V.setTransform(this._box,`translate(${m}px,${w}px)`),this._box.style.width=v-m+"px",this._box.style.height=T-w+"px"}mouseupWindow(e,o){if(!this._active||e.button!==0)return;const c=this._startPos,h=o;if(this.reset(),V.suppressClick(),c.x!==h.x||c.y!==h.y)return this._map.fire(new a.l("boxzoomend",{originalEvent:e})),{cameraAnimation:m=>m.fitScreenCoordinates(c,h,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(V.remove(this._box),this._box=null),V.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,o){return this._map.fire(new a.l(e,{originalEvent:o}))}}function Bc(p,e){if(p.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${p.length}, points ${e.length}`);const o={};for(let c=0;c<p.length;c++)o[p[c].identifier]=e[c];return o}class Nf{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,o,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),c.length===this.numTouches&&(this.centroid=function(h){const m=new a.P(0,0);for(const v of h)m._add(v);return m.div(h.length)}(o),this.touches=Bc(c,o)))}touchmove(e,o,c){if(this.aborted||!this.centroid)return;const h=Bc(c,o);for(const m in this.touches){const v=h[m];(!v||v.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(e,o,c){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class nl{constructor(e){this.singleTap=new Nf(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,o,c){this.singleTap.touchstart(e,o,c)}touchmove(e,o,c){this.singleTap.touchmove(e,o,c)}touchend(e,o,c){const h=this.singleTap.touchend(e,o,c);if(h){const m=e.timeStamp-this.lastTime<500,v=!this.lastTap||this.lastTap.dist(h)<30;if(m&&v||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class ta{constructor(e){this._tr=new ea(e),this._zoomIn=new nl({numTouches:1,numTaps:2}),this._zoomOut=new nl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,o,c){this._zoomIn.touchstart(e,o,c),this._zoomOut.touchstart(e,o,c)}touchmove(e,o,c){this._zoomIn.touchmove(e,o,c),this._zoomOut.touchmove(e,o,c)}touchend(e,o,c){const h=this._zoomIn.touchend(e,o,c),m=this._zoomOut.touchend(e,o,c),v=this._tr;return h?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:v.zoom+1,around:v.unproject(h)},{originalEvent:e})}):m?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:v.zoom-1,around:v.unproject(m)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xn{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const o=this._moveFunction(...e);if(o.bearingDelta||o.pitchDelta||o.rollDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(e,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(o)?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,o){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const h=Array.isArray(o)?o[0]:o;return!this._moved&&h.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=h,this._move(c,h))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&V.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const dt={0:1,2:2};class gs{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const o=V.mouseButton(e);this._eventButton=o}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(o,c){const h=dt[c];return o.buttons===void 0||(o.buttons&h)!==h}(e,this._eventButton)}isValidEndEvent(e){return V.mouseButton(e)===this._eventButton}}class $c{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Zh{constructor(e=new gs({checkCorrectEvent:()=>!0}),o=new $c){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=o}_executeRelevantHandler(e,o,c){return e instanceof MouseEvent?o(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?c(e):void 0}startMove(e){this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.startMove(o),o=>this.oneFingerTouchMoveStateManager.startMove(o))}endMove(e){this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.endMove(o),o=>this.oneFingerTouchMoveStateManager.endMove(o))}isValidStartEvent(e){return this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.isValidStartEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidStartEvent(o))}isValidMoveEvent(e){return this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.isValidMoveEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(o))}isValidEndEvent(e){return this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.isValidEndEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidEndEvent(o))}}const ui=p=>{p.mousedown=p.dragStart,p.mousemoveWindow=p.dragMove,p.mouseup=p.dragEnd,p.contextmenu=e=>{e.preventDefault()}};class ra{constructor(e,o){this._clickTolerance=e.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,o,c){return this._calculateTransform(e,o,c)}touchmove(e,o,c){if(this._active){if(!this._shouldBePrevented(c.length))return e.preventDefault(),this._calculateTransform(e,o,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,o,c){this._calculateTransform(e,o,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,o,c){c.length>0&&(this._active=!0);const h=Bc(c,o),m=new a.P(0,0),v=new a.P(0,0);let w=0;for(const P in h){const A=h[P],D=this._touches[P];D&&(m._add(A),v._add(A.sub(D)),w++,h[P]=A)}if(this._touches=h,this._shouldBePrevented(w)||!v.mag())return;const T=v.div(w);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(w),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ol{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,o,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([o[0],o[1]]))}touchmove(e,o,c){if(!this._firstTwoTouches)return;e.preventDefault();const[h,m]=this._firstTwoTouches,v=Nt(c,o,h),w=Nt(c,o,m);if(!v||!w)return;const T=this._aroundCenter?null:v.add(w).div(2);return this._move([v,w],T,e)}touchend(e,o,c){if(!this._firstTwoTouches)return;const[h,m]=this._firstTwoTouches,v=Nt(c,o,h),w=Nt(c,o,m);v&&w||(this._active&&V.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Nt(p,e,o){for(let c=0;c<p.length;c++)if(p[c].identifier===o)return e[c]}function il(p,e){return Math.log(p/e)/Math.LN2}class Gh extends ol{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,o){const c=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(il(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:il(this._distance,c),pinchAround:o}}}function sl(p,e){return 180*p.angleWith(e)/Math.PI}class qh extends ol{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,o,c){const h=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:sl(this._vector,h),pinchAround:o}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const o=25/(Math.PI*this._minDiameter)*360,c=sl(e,this._startVector);return Math.abs(c)<o}}function Oc(p){return Math.abs(p.y)>Math.abs(p.x)}class Fc extends ol{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,o,c){super.touchstart(e,o,c),this._currentTouchCount=c.length}_start(e){this._lastPoints=e,Oc(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,o,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const h=e[0].sub(this._lastPoints[0]),m=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,m,c.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(h.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(e,o,c){if(this._valid!==void 0)return this._valid;const h=e.mag()>=2,m=o.mag()>=2;if(!h&&!m)return;if(!h||!m)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const v=e.y>0==o.y>0;return Oc(e)&&Oc(o)&&v}}const jc={panStep:100,bearingStep:15,pitchStep:10};class Nc{constructor(e){this._tr=new ea(e);const o=jc;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let o=0,c=0,h=0,m=0,v=0;switch(e.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:e.shiftKey?c=-1:(e.preventDefault(),m=-1);break;case 39:e.shiftKey?c=1:(e.preventDefault(),m=1);break;case 38:e.shiftKey?h=1:(e.preventDefault(),v=-1);break;case 40:e.shiftKey?h=-1:(e.preventDefault(),v=1);break;default:return}return this._rotationDisabled&&(c=0,h=0),{cameraAnimation:w=>{const T=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:Vf,zoom:o?Math.round(T.zoom)+o*(e.shiftKey?2:1):T.zoom,bearing:T.bearing+c*this._bearingStep,pitch:T.pitch+h*this._pitchStep,offset:[-m*this._panStep,-v*this._panStep],center:T.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Vf(p){return p*(2-p)}const Vc=4.000244140625;class Wh{constructor(e,o){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=e,this._tr=new ea(e),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let o=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const c=q.now(),h=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,o!==0&&o%Vc==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(h*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),e.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=e,this._delta-=o,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=V.mousePos(this._map.getCanvas(),e),c=this._tr;this._aroundPoint=this._aroundCenter?c.transform.locationToScreenPoint(a.Q.convert(c.center)):o,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const w=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=w),typeof this._targetZoom=="number"&&(this._targetZoom+=w)}if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>Vc?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&T!==0&&(T=1/T);const P=typeof this._targetZoom!="number"?e.scale:a.aH(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,a.aa(P*T))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,c=this._startZoom,h=this._easing;let m,v=!1;if(this._type==="wheel"&&c&&h){const w=q.now()-this._lastWheelEventTime,T=Math.min((w+5)/200,1),P=h(T);m=a.B.number(c,o,P),T<1?this._frameId||(this._frameId=!0):v=!0}else m=o,v=!0;return this._active=!0,v&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=m,{noInertia:!0,needsRenderFrame:!v,zoomDelta:m-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let o=a.ca;if(this._prevEase){const c=this._prevEase,h=(q.now()-c.start)/c.duration,m=c.easing(h+.01)-c.easing(h),v=.27/Math.sqrt(m*m+1e-4)*.01,w=Math.sqrt(.0729-v*v);o=a.c8(v,w,.25,1)}return this._prevEase={start:q.now(),duration:e,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Hh{constructor(e,o){this._clickZoom=e,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class hi{constructor(e){this._tr=new ea(e),this.reset()}reset(){this._active=!1}dblclick(e,o){return e.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Tr{constructor(){this._tap=new nl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,o,c){if(!this._swipePoint)if(this._tapTime){const h=o[0],m=e.timeStamp-this._tapTime<500,v=this._tapPoint.dist(h)<30;m&&v?c.length>0&&(this._swipePoint=h,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(e,o,c)}touchmove(e,o,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const h=o[0],m=h.y-this._swipePoint.y;return this._swipePoint=h,e.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(e,o,c)}touchend(e,o,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const h=this._tap.touchend(e,o,c);h&&(this._tapTime=e.timeStamp,this._tapPoint=h)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class na{constructor(e,o,c){this._el=e,this._mousePan=o,this._touchPan=c}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class al{constructor(e,o,c,h){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=o,this._mousePitch=c,this._mouseRoll=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Uc{constructor(e,o,c,h){this._el=e,this._touchZoom=o,this._touchRotate=c,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Zc{constructor(e,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=V.create("div","maplibregl-cooperative-gesture-screen",e);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),h=document.createElement("div");h.className="maplibregl-desktop-message",h.textContent=o,this._container.appendChild(h);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=c,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(V.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,o){this._enabled&&(this._map.fire(new a.l("cooperativegestureprevented",{gestureType:e,originalEvent:o})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const oa=p=>p.zoom||p.drag||p.roll||p.pitch||p.rotate;class Uf extends a.l{}function po(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta||p.rollDelta}class ll{constructor(e,o){this.handleWindowEvent=h=>{this.handleEvent(h,`${h.type}Window`)},this.handleEvent=(h,m)=>{if(h.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const v=h.type==="renderFrame"?void 0:h,w={needsRenderFrame:!1},T={},P={},A=h.touches,D=A?this._getMapTouches(A):void 0,L=D?V.touchPos(this._map.getCanvas(),D):V.mousePos(this._map.getCanvas(),h);for(const{handlerName:J,handler:K,allowed:Q}of this._handlers){if(!K.isEnabled())continue;let re;this._blockedByActive(P,Q,J)?K.reset():K[m||h.type]&&(re=K[m||h.type](h,L,D),this.mergeHandlerResult(w,T,re,J,v),re&&re.needsRenderFrame&&this._triggerRenderFrame()),(re||K.isActive())&&(P[J]=K)}const U={};for(const J in this._previousActiveHandlers)P[J]||(U[J]=v);this._previousActiveHandlers=P,(Object.keys(U).length||po(w))&&(this._changes.push([w,T,U]),this._triggerRenderFrame()),(Object.keys(P).length||po(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:G}=w;G&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],G(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Vh(e),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,m,v]of this._listeners)V.addEventListener(h,m,h===document?this.handleWindowEvent:this.handleEvent,v)}destroy(){for(const[e,o,c]of this._listeners)V.removeEventListener(e,o,e===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(e){const o=this._map,c=o.getCanvasContainer();this._add("mapEvent",new Ro(o,e));const h=o.boxZoom=new Uh(o,e);this._add("boxZoom",h),e.interactive&&e.boxZoom&&h.enable();const m=o.cooperativeGestures=new Zc(o,e.cooperativeGestures);this._add("cooperativeGestures",m),e.cooperativeGestures&&m.enable();const v=new ta(o),w=new hi(o);o.doubleClickZoom=new Hh(w,v),this._add("tapZoom",v),this._add("clickZoom",w),e.interactive&&e.doubleClickZoom&&o.doubleClickZoom.enable();const T=new Tr;this._add("tapDragZoom",T);const P=o.touchPitch=new Fc(o);this._add("touchPitch",P),e.interactive&&e.touchPitch&&o.touchPitch.enable(e.touchPitch);const A=()=>o.project(o.getCenter()),D=function({enable:le,clickTolerance:ue,aroundCenter:fe=!0,minPixelCenterThreshold:he=100,rotateDegreesPerPixelMoved:we=.8},Se){const Re=new gs({checkCorrectEvent:Le=>V.mouseButton(Le)===0&&Le.ctrlKey||V.mouseButton(Le)===2&&!Le.ctrlKey});return new Xn({clickTolerance:ue,move:(Le,ze)=>{const rt=Se();if(fe&&Math.abs(rt.y-Le.y)>he)return{bearingDelta:a.c9(new a.P(Le.x,ze.y),ze,rt)};let et=(ze.x-Le.x)*we;return fe&&ze.y<rt.y&&(et=-et),{bearingDelta:et}},moveStateManager:Re,enable:le,assignEvents:ui})}(e,A),L=function({enable:le,clickTolerance:ue,pitchDegreesPerPixelMoved:fe=-.5}){const he=new gs({checkCorrectEvent:we=>V.mouseButton(we)===0&&we.ctrlKey||V.mouseButton(we)===2});return new Xn({clickTolerance:ue,move:(we,Se)=>({pitchDelta:(Se.y-we.y)*fe}),moveStateManager:he,enable:le,assignEvents:ui})}(e),U=function({enable:le,clickTolerance:ue,rollDegreesPerPixelMoved:fe=.3},he){const we=new gs({checkCorrectEvent:Se=>V.mouseButton(Se)===2&&Se.ctrlKey});return new Xn({clickTolerance:ue,move:(Se,Re)=>{const Le=he();let ze=(Re.x-Se.x)*fe;return Re.y<Le.y&&(ze=-ze),{rollDelta:ze}},moveStateManager:we,enable:le,assignEvents:ui})}(e,A);o.dragRotate=new al(e,D,L,U),this._add("mouseRotate",D,["mousePitch"]),this._add("mousePitch",L,["mouseRotate","mouseRoll"]),this._add("mouseRoll",U,["mousePitch"]),e.interactive&&e.dragRotate&&o.dragRotate.enable();const G=function({enable:le,clickTolerance:ue}){const fe=new gs({checkCorrectEvent:he=>V.mouseButton(he)===0&&!he.ctrlKey});return new Xn({clickTolerance:ue,move:(he,we)=>({around:we,panDelta:we.sub(he)}),activateOnStart:!0,moveStateManager:fe,enable:le,assignEvents:ui})}(e),J=new ra(e,o);o.dragPan=new na(c,G,J),this._add("mousePan",G),this._add("touchPan",J,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&o.dragPan.enable(e.dragPan);const K=new qh,Q=new Gh;o.touchZoomRotate=new Uc(c,Q,K,T),this._add("touchRotate",K,["touchPan","touchZoom"]),this._add("touchZoom",Q,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&o.touchZoomRotate.enable(e.touchZoomRotate);const re=o.scrollZoom=new Wh(o,()=>this._triggerRenderFrame());this._add("scrollZoom",re,["mousePan"]),e.interactive&&e.scrollZoom&&o.scrollZoom.enable(e.scrollZoom);const se=o.keyboard=new Nc(o);this._add("keyboard",se),e.interactive&&e.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new ms(o))}_add(e,o,c){this._handlers.push({handlerName:e,handler:o,allowed:c}),this._handlersById[e]=o}stop(e){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!oa(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,o,c){for(const h in e)if(h!==c&&(!o||o.indexOf(h)<0))return!0;return!1}_getMapTouches(e){const o=[];for(const c of e)this._el.contains(c.target)&&o.push(c);return o}mergeHandlerResult(e,o,c,h,m){if(!c)return;a.e(e,c);const v={handlerName:h,originalEvent:c.originalEvent||m};c.zoomDelta!==void 0&&(o.zoom=v),c.panDelta!==void 0&&(o.drag=v),c.rollDelta!==void 0&&(o.roll=v),c.pitchDelta!==void 0&&(o.pitch=v),c.bearingDelta!==void 0&&(o.rotate=v)}_applyChanges(){const e={},o={},c={};for(const[h,m,v]of this._changes)h.panDelta&&(e.panDelta=(e.panDelta||new a.P(0,0))._add(h.panDelta)),h.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+h.pitchDelta),h.rollDelta&&(e.rollDelta=(e.rollDelta||0)+h.rollDelta),h.around!==void 0&&(e.around=h.around),h.pinchAround!==void 0&&(e.pinchAround=h.pinchAround),h.noInertia&&(e.noInertia=h.noInertia),a.e(o,m),a.e(c,v);this._updateMapTransform(e,o,c),this._changes=[]}_updateMapTransform(e,o,c){const h=this._map,m=h._getTransformForUpdate(),v=h.terrain;if(!(po(e)||v&&this._terrainMovement))return this._fireEvents(o,c,!0);h._stop(!0);let{panDelta:w,zoomDelta:T,bearingDelta:P,pitchDelta:A,rollDelta:D,around:L,pinchAround:U}=e;U!==void 0&&(L=U),L=L||h.transform.centerPoint,v&&!m.isPointOnMapSurface(L)&&(L=m.centerPoint);const G={panDelta:w,zoomDelta:T,rollDelta:D,pitchDelta:A,bearingDelta:P,around:L};this._map.cameraHelper.useGlobeControls&&!m.isPointOnMapSurface(L)&&(L=m.centerPoint);const J=L.distSqr(m.centerPoint)<.01?m.center:m.screenPointToLocation(w?L.sub(w):L);v?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(G,m),this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?m.setCenter(m.screenPointToLocation(m.centerPoint.sub(w))):this._map.cameraHelper.handleMapControlsPan(G,m,J):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(G,m,J))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(G,m),this._map.cameraHelper.handleMapControlsPan(G,m,J)),h._applyUpdatedTransform(m),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(o,c,!0)}_fireEvents(e,o,c){const h=oa(this._eventsInProgress),m=oa(e),v={};for(const D in e){const{originalEvent:L}=e[D];this._eventsInProgress[D]||(v[`${D}start`]=L),this._eventsInProgress[D]=e[D]}!h&&m&&this._fireEvent("movestart",m.originalEvent);for(const D in v)this._fireEvent(D,v[D]);m&&this._fireEvent("move",m.originalEvent);for(const D in e){const{originalEvent:L}=e[D];this._fireEvent(D,L)}const w={};let T;for(const D in this._eventsInProgress){const{handlerName:L,originalEvent:U}=this._eventsInProgress[D];this._handlersById[L].isActive()||(delete this._eventsInProgress[D],T=o[L]||U,w[`${D}end`]=T)}for(const D in w)this._fireEvent(D,w[D]);const P=oa(this._eventsInProgress),A=(h||m)&&!P;if(A&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const D=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&D.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(D)}if(c&&A){this._updatingCamera=!0;const D=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),L=U=>U!==0&&-this._bearingSnap<U&&U<this._bearingSnap;!D||!D.essential&&q.prefersReducedMotion?(this._map.fire(new a.l("moveend",{originalEvent:T})),L(this._map.getBearing())&&this._map.resetNorth()):(L(D.bearing||this._map.getBearing())&&(D.bearing=0),D.freezeElevation=!0,this._map.easeTo(D,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(e,o){this._map.fire(new a.l(e,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Uf("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class wt extends a.E{constructor(e,o,c){super(),this._renderFrameCallback=()=>{const h=Math.min((q.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=c.bearingSnap,this.cameraHelper=o,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,o){e.apply(this.transform),this.transform=e,this.cameraHelper=o}getCenter(){return new a.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,o){return this.jumpTo({center:e},o)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,o){return this.jumpTo({elevation:e},o),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,o,c){return e=a.P.convert(e).mult(-1),this.panTo(this.transform.center,a.e({offset:e},o),c)}panTo(e,o,c){return this.easeTo(a.e({center:e},o),c)}getZoom(){return this.transform.zoom}setZoom(e,o){return this.jumpTo({zoom:e},o),this}zoomTo(e,o,c){return this.easeTo(a.e({zoom:e},o),c)}zoomIn(e,o){return this.zoomTo(this.getZoom()+1,e,o),this}zoomOut(e,o){return this.zoomTo(this.getZoom()-1,e,o),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,o){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new a.l("movestart",o)).fire(new a.l("move",o)).fire(new a.l("moveend",o))),this}getBearing(){return this.transform.bearing}setBearing(e,o){return this.jumpTo({bearing:e},o),this}getPadding(){return this.transform.padding}setPadding(e,o){return this.jumpTo({padding:e},o),this}rotateTo(e,o,c){return this.easeTo(a.e({bearing:e},o),c)}resetNorth(e,o){return this.rotateTo(0,a.e({duration:1e3},e),o),this}resetNorthPitch(e,o){return this.easeTo(a.e({bearing:0,pitch:0,roll:0,duration:1e3},e),o),this}snapToNorth(e,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,o):this}getPitch(){return this.transform.pitch}setPitch(e,o){return this.jumpTo({pitch:e},o),this}getRoll(){return this.transform.roll}setRoll(e,o){return this.jumpTo({roll:e},o),this}cameraForBounds(e,o){e=Ie.convert(e).adjustAntiMeridian();const c=o&&o.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),c,o)}_cameraForBoxAndBearing(e,o,c,h){const m={top:0,bottom:0,right:0,left:0};if(typeof(h=a.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const P=h.padding;h.padding={top:P,bottom:P,right:P,left:P}}const v=a.e(m,h.padding);h.padding=v;const w=this.transform,T=new Ie(e,o);return this.cameraHelper.cameraForBoxAndBearing(h,v,T,c,w)}fitBounds(e,o,c){return this._fitInternal(this.cameraForBounds(e,o),o,c)}fitScreenCoordinates(e,o,c,h,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(a.P.convert(e)),this.transform.screenPointToLocation(a.P.convert(o)),c,h),h,m)}_fitInternal(e,o,c){return e?(delete(o=a.e(e,o)).padding,o.linear?this.easeTo(o,c):this.flyTo(o,c)):this}jumpTo(e,o){this.stop();const c=this._getTransformForUpdate();let h=!1,m=!1,v=!1;const w=c.zoom;this.cameraHelper.handleJumpToCenterZoom(c,e);const T=c.zoom!==w;return"elevation"in e&&c.elevation!==+e.elevation&&c.setElevation(+e.elevation),"bearing"in e&&c.bearing!==+e.bearing&&(h=!0,c.setBearing(+e.bearing)),"pitch"in e&&c.pitch!==+e.pitch&&(m=!0,c.setPitch(+e.pitch)),"roll"in e&&c.roll!==+e.roll&&(v=!0,c.setRoll(+e.roll)),e.padding==null||c.isPaddingEqual(e.padding)||c.setPadding(e.padding),this._applyUpdatedTransform(c),this.fire(new a.l("movestart",o)).fire(new a.l("move",o)),T&&this.fire(new a.l("zoomstart",o)).fire(new a.l("zoom",o)).fire(new a.l("zoomend",o)),h&&this.fire(new a.l("rotatestart",o)).fire(new a.l("rotate",o)).fire(new a.l("rotateend",o)),m&&this.fire(new a.l("pitchstart",o)).fire(new a.l("pitch",o)).fire(new a.l("pitchend",o)),v&&this.fire(new a.l("rollstart",o)).fire(new a.l("roll",o)).fire(new a.l("rollend",o)),this.fire(new a.l("moveend",o))}calculateCameraOptionsFromTo(e,o,c,h=0){const m=a.$.fromLngLat(e,o),v=a.$.fromLngLat(c,h),w=v.x-m.x,T=v.y-m.y,P=v.z-m.z,A=Math.hypot(w,T,P);if(A===0)throw new Error("Can't calculate camera options with same From and To");const D=Math.hypot(w,T),L=a.aa(this.transform.cameraToCenterDistance/A/this.transform.tileSize),U=180*Math.atan2(w,-T)/Math.PI;let G=180*Math.acos(D/A)/Math.PI;return G=P<0?90-G:90+G,{center:v.toLngLat(),elevation:h,zoom:L,pitch:G,bearing:U}}calculateCameraOptionsFromCameraLngLatAltRotation(e,o,c,h,m){const v=this.transform.calculateCenterFromCameraLngLatAlt(e,o,c,h);return{center:v.center,elevation:v.elevation,zoom:v.zoom,bearing:c,pitch:h,roll:m}}easeTo(e,o){this._stop(!1,e.easeId),((e=a.e({offset:[0,0],duration:500,easing:a.ca},e)).animate===!1||!e.essential&&q.prefersReducedMotion)&&(e.duration=0);const c=this._getTransformForUpdate(),h=this.getBearing(),m=c.pitch,v=c.roll,w="bearing"in e?this._normalizeBearing(e.bearing,h):h,T="pitch"in e?+e.pitch:m,P="roll"in e?this._normalizeBearing(e.roll,v):v,A="padding"in e?e.padding:c.padding,D=a.P.convert(e.offset);let L,U;e.around&&(L=a.Q.convert(e.around),U=c.locationToScreenPoint(L));const G={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},J=this.cameraHelper.handleEaseTo(c,{bearing:w,pitch:T,roll:P,padding:A,around:L,aroundPoint:U,offsetAsPoint:D,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||h!==w,this._pitching=this._pitching||T!==m,this._rolling=this._rolling||P!==v,this._padding=!c.isPaddingEqual(A),this._zooming=this._zooming||J.isZooming,this._easeId=e.easeId,this._prepareEase(o,e.noMoveStart,G),this.terrain&&this._prepareElevation(J.elevationCenter),this._ease(K=>{J.easeFunc(K),this.terrain&&!e.freezeElevation&&this._updateElevation(K),this._applyUpdatedTransform(c),this._fireMoveEvents(o)},K=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(o,K)},e),this}_prepareEase(e,o,c={}){this._moving=!0,o||c.moving||this.fire(new a.l("movestart",e)),this._zooming&&!c.zooming&&this.fire(new a.l("zoomstart",e)),this._rotating&&!c.rotating&&this.fire(new a.l("rotatestart",e)),this._pitching&&!c.pitching&&this.fire(new a.l("pitchstart",e)),this._rolling&&!c.rolling&&this.fire(new a.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&o!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(c-(o-(c*e+this._elevationStart))/(1-e)),this._elevationTarget=o}this.transform.setElevation(a.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const o=e.getCameraLngLat(),c=e.getCameraAltitude(),h=this.terrain?this.terrain.getElevationForLngLatZoom(o,e.zoom):0;if(c<h){const m=this.calculateCameraOptionsFromTo(o,h,e.center,e.elevation);return{pitch:m.pitch,zoom:m.zoom}}return{}}_applyUpdatedTransform(e){const o=[];if(o.push(h=>this._elevateCameraIfInsideTerrain(h)),this.transformCameraUpdate&&o.push(h=>this.transformCameraUpdate(h)),!o.length)return;const c=e.clone();for(const h of o){const m=c.clone(),{center:v,zoom:w,roll:T,pitch:P,bearing:A,elevation:D}=h(m);v&&m.setCenter(v),D!==void 0&&m.setElevation(D),w!==void 0&&m.setZoom(w),T!==void 0&&m.setRoll(T),P!==void 0&&m.setPitch(P),A!==void 0&&m.setBearing(A),c.apply(m)}this.transform.apply(c)}_fireMoveEvents(e){this.fire(new a.l("move",e)),this._zooming&&this.fire(new a.l("zoom",e)),this._rotating&&this.fire(new a.l("rotate",e)),this._pitching&&this.fire(new a.l("pitch",e)),this._rolling&&this.fire(new a.l("roll",e))}_afterEase(e,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const c=this._zooming,h=this._rotating,m=this._pitching,v=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,c&&this.fire(new a.l("zoomend",e)),h&&this.fire(new a.l("rotateend",e)),m&&this.fire(new a.l("pitchend",e)),v&&this.fire(new a.l("rollend",e)),this.fire(new a.l("moveend",e))}flyTo(e,o){if(!e.essential&&q.prefersReducedMotion){const ze=a.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(ze,o)}this.stop(),e=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.ca},e);const c=this._getTransformForUpdate(),h=c.bearing,m=c.pitch,v=c.roll,w=c.padding,T="bearing"in e?this._normalizeBearing(e.bearing,h):h,P="pitch"in e?+e.pitch:m,A="roll"in e?this._normalizeBearing(e.roll,v):v,D="padding"in e?e.padding:c.padding,L=a.P.convert(e.offset);let U=c.centerPoint.add(L);const G=c.screenPointToLocation(U),J=this.cameraHelper.handleFlyTo(c,{bearing:T,pitch:P,roll:A,padding:D,locationAtOffset:G,offsetAsPoint:L,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let K=e.curve;const Q=Math.max(c.width,c.height),re=Q/J.scaleOfZoom,se=J.pixelPathLength;typeof J.scaleOfMinZoom=="number"&&(K=Math.sqrt(Q/J.scaleOfMinZoom/se*2));const le=K*K;function ue(ze){const rt=(re*re-Q*Q+(ze?-1:1)*le*le*se*se)/(2*(ze?re:Q)*le*se);return Math.log(Math.sqrt(rt*rt+1)-rt)}function fe(ze){return(Math.exp(ze)-Math.exp(-ze))/2}function he(ze){return(Math.exp(ze)+Math.exp(-ze))/2}const we=ue(!1);let Se=function(ze){return he(we)/he(we+K*ze)},Re=function(ze){return Q*((he(we)*(fe(rt=we+K*ze)/he(rt))-fe(we))/le)/se;var rt},Le=(ue(!0)-we)/K;if(Math.abs(se)<2e-6||!isFinite(Le)){if(Math.abs(Q-re)<1e-6)return this.easeTo(e,o);const ze=re<Q?-1:1;Le=Math.abs(Math.log(re/Q))/K,Re=()=>0,Se=rt=>Math.exp(ze*K*rt)}return e.duration="duration"in e?+e.duration:1e3*Le/("screenSpeed"in e?+e.screenSpeed/K:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=h!==T,this._pitching=P!==m,this._rolling=A!==v,this._padding=!c.isPaddingEqual(D),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(J.targetCenter),this._ease(ze=>{const rt=ze*Le,et=1/Se(rt),Ue=Re(rt);this._rotating&&c.setBearing(a.B.number(h,T,ze)),this._pitching&&c.setPitch(a.B.number(m,P,ze)),this._rolling&&c.setRoll(a.B.number(v,A,ze)),this._padding&&(c.interpolatePadding(w,D,ze),U=c.centerPoint.add(L)),J.easeFunc(ze,et,Ue,U),this.terrain&&!e.freezeElevation&&this._updateElevation(ze),this._applyUpdatedTransform(c),this._fireMoveEvents(o)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(o)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,o){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,o)}return e||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(e,o,c){c.animate===!1||c.duration===0?(e(1),o()):(this._easeStart=q.now(),this._easeOptions=c,this._onEaseFrame=e,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,o){e=a.aK(e,-180,180);const c=Math.abs(e-o);return Math.abs(e-360-o)<c&&(e-=360),Math.abs(e+360-o)<c&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(a.Q.convert(e),this.transform.tileZoom):null}}const Et={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ia{constructor(e=Et){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=V.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=V.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=V.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){V.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(e,o){const c=this._map._getUIString(`AttributionControl.${o}`);e.title=c,e.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const o=this._map.style.sourceCaches;for(const h in o){const m=o[h];if(m.used||m.usedForTerrain){const v=m.getSource();v.attribution&&e.indexOf(v.attribution)<0&&e.push(v.attribution)}}e=e.filter(h=>String(h).trim()),e.sort((h,m)=>h.length-m.length),e=e.filter((h,m)=>{for(let v=m+1;v<e.length;v++)if(e[v].indexOf(h)>=0)return!1;return!0});const c=e.join(" | ");c!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=V.sanitize(c),e.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class cl{constructor(e={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const c=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=V.create("div","maplibregl-ctrl");const o=V.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){V.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Gc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const o=++this._id;return this._queue.push({callback:e,id:o,cancelled:!1}),o}remove(e){const o=this._currentlyRunning,c=o?this._queue.concat(o):this._queue;for(const h of c)if(h.id===e)return void(h.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const c of o)if(!c.cancelled&&(c.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var jn=a.aC([{name:"a_pos3d",type:"Int16",components:3}]);class Xh extends a.E{constructor(e){super(),this._lastTilesetChange=q.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,o){this.sourceCache.update(e,o),this._renderableTilesKeys=[];const c={};for(const h of ge(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))c[h.key]=!0,this._renderableTilesKeys.push(h.key),this._tiles[h.key]||(h.terrainRttPosMatrix32f=new Float64Array(16),a.bN(h.terrainRttPosMatrix32f,0,a.Z,a.Z,0,0,1),this._tiles[h.key]=new jr(h,this.tileSize),this._lastTilesetChange=q.now());for(const h in this._tiles)c[h]||delete this._tiles[h]}freeRtt(e){for(const o in this._tiles){const c=this._tiles[o];(!e||c.tileID.equals(e)||c.tileID.isChildOf(e)||e.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const o={};for(const c of this._renderableTilesKeys){const h=this._tiles[c].tileID,m=e.clone(),v=a.b1();if(h.canonical.equals(e.canonical))a.bN(v,0,a.Z,a.Z,0,0,1);else if(h.canonical.isChildOf(e.canonical)){const w=h.canonical.z-e.canonical.z,T=h.canonical.x-(h.canonical.x>>w<<w),P=h.canonical.y-(h.canonical.y>>w<<w),A=a.Z>>w;a.bN(v,0,A,A,0,0,1),a.L(v,v,[-T*A,-P*A,0])}else{if(!e.canonical.isChildOf(h.canonical))continue;{const w=e.canonical.z-h.canonical.z,T=e.canonical.x-(e.canonical.x>>w<<w),P=e.canonical.y-(e.canonical.y>>w<<w),A=a.Z>>w;a.bN(v,0,a.Z,a.Z,0,0,1),a.L(v,v,[T*A,P*A,0]),a.M(v,v,[1/2**w,1/2**w,0])}}m.terrainRttPosMatrix32f=new Float32Array(v),o[c]=m}return o}getSourceTile(e,o){const c=this.sourceCache._source;let h=e.overscaledZ-this.deltaZoom;if(h>c.maxzoom&&(h=c.maxzoom),h<c.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(h).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!m||!m.dem)&&o)for(;h>=c.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(e.scaledTo(h--).key);return m}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}}class Do{constructor(e,o,c){this._meshCache={},this.painter=e,this.sourceCache=new Xh(o),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,o,c,h=a.Z){var m;if(!(o>=0&&o<h&&c>=0&&c<h))return 0;const v=this.getTerrainData(e),w=(m=v.tile)===null||m===void 0?void 0:m.dem;if(!w)return 0;const T=a.cb([],[o/h*a.Z,c/h*a.Z],v.u_terrain_matrix),P=[T[0]*w.dim,T[1]*w.dim],A=Math.floor(P[0]),D=Math.floor(P[1]),L=P[0]-A,U=P[1]-D;return w.get(A,D)*(1-L)*(1-U)+w.get(A+1,D)*L*(1-U)+w.get(A,D+1)*(1-L)*U+w.get(A+1,D+1)*L*U}getElevationForLngLatZoom(e,o){if(!a.cc(o,e.wrap()))return 0;const{tileID:c,mercatorX:h,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(e,o);return this.getElevation(c,h%a.Z,m%a.Z,a.Z)}getElevation(e,o,c,h=a.Z){return this.getDEMElevation(e,o,c,h)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const h=this.painter.context,m=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new st(h,m,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new st(h,new a.R({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.as([])}const o=this.sourceCache.getSourceTile(e,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const h=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new st(h,o.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),o.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const c=o&&o+o.tileID.key+e.key;if(c&&!this._demMatrixCache[c]){const h=this.sourceCache.sourceCache._source.maxzoom;let m=e.canonical.z-o.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=h?m=e.canonical.z-h:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const v=e.canonical.x-(e.canonical.x>>m<<m),w=e.canonical.y-(e.canonical.y>>m<<m),T=a.cd(new Float64Array(16),[1/(a.Z<<m),1/(a.Z<<m),0]);a.L(T,T,[v*a.Z,w*a.Z,0]),this._demMatrixCache[e.key]={matrix:T,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(e){const o=this.painter,c=o.width/devicePixelRatio,h=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new st(o.context,{width:c,height:h,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new st(o.context,{width:c,height:h,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(c,h,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,c,h))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,v=0;m<this._coordsTextureSize;m++)for(let w=0;w<this._coordsTextureSize;w++,v+=4)o[v+0]=255&w,o[v+1]=255&m,o[v+2]=w>>8<<4|m>>8,o[v+3]=0;const c=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),h=new st(e,c,e.gl.RGBA,{premultiply:!1});return h.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),c=this.painter.context,h=c.gl,m=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),v=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),w=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),h.readPixels(m,w-v-1,1,1,h.RGBA,h.UNSIGNED_BYTE,o),c.bindFramebuffer.set(null);const T=o[0]+(o[2]>>4<<8),P=o[1]+((15&o[2])<<8),A=this.coordsIndex[255-o[3]],D=A&&this.sourceCache.getTileByID(A);if(!D)return null;const L=this._coordsTextureSize,U=(1<<D.tileID.canonical.z)*L;return new a.$((D.tileID.canonical.x*L+T)/U+D.tileID.wrap,(D.tileID.canonical.y*L+P)/U,this.getElevation(D.tileID,T,P,L))}depthAtPoint(e){const o=new Uint8Array(4),c=this.painter.context,h=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),h.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,h.RGBA,h.UNSIGNED_BYTE,o),c.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(e){var o;const c=((o=this.painter.style.projection)===null||o===void 0?void 0:o.transitionState)>0,h=c&&e.canonical.y===0,m=c&&e.canonical.y===(1<<e.canonical.z)-1,v=`m_${h?"n":""}_${m?"s":""}`;if(this._meshCache[v])return this._meshCache[v];const w=this.painter.context,T=new a.ce,P=new a.aG,A=this.meshSize,D=a.Z/A,L=A*A;for(let he=0;he<=A;he++)for(let we=0;we<=A;we++)T.emplaceBack(we*D,he*D,0);for(let he=0;he<L;he+=A+1)for(let we=0;we<A;we++)P.emplaceBack(we+he,A+we+he+1,A+we+he+2),P.emplaceBack(we+he,A+we+he+2,we+he+1);const U=T.length,G=U+(A+1),J=(A+1)*A,K=h?a.b8:0,Q=h?0:1,re=m?a.b9:a.Z,se=m?0:1;for(let he=0;he<=A;he++)T.emplaceBack(he*D,K,Q);for(let he=0;he<=A;he++)T.emplaceBack(he*D,re,se);for(let he=0;he<A;he++)P.emplaceBack(J+he,G+he,G+he+1),P.emplaceBack(J+he,G+he+1,J+he+1),P.emplaceBack(0+he,U+he+1,U+he),P.emplaceBack(0+he,0+he+1,U+he+1);const le=T.length,ue=le+2*(A+1);for(const he of[0,1])for(let we=0;we<=A;we++)for(const Se of[0,1])T.emplaceBack(he*a.Z,we*D,Se);for(let he=0;he<2*A;he+=2)P.emplaceBack(le+he,le+he+1,le+he+3),P.emplaceBack(le+he,le+he+3,le+he+2),P.emplaceBack(ue+he,ue+he+3,ue+he+1),P.emplaceBack(ue+he,ue+he+2,ue+he+3);const fe=new Wn(w.createVertexBuffer(T,jn.members),w.createIndexBuffer(P),a.aF.simpleSegment(0,0,T.length,P.length));return this._meshCache[v]=fe,fe}getMeshFrameDelta(e){return 2*Math.PI*a.bq/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,o){var c;const{tileID:h}=this._getOverscaledTileIDFromLngLatZoom(e,o);return(c=this.getMinMaxElevation(h).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(e){const o=this.getTerrainData(e).tile,c={minElevation:null,maxElevation:null};return o&&o.dem&&(c.minElevation=o.dem.min*this.exaggeration,c.maxElevation=o.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(e,o){const c=a.$.fromLngLat(e.wrap()),h=(1<<o)*a.Z,m=c.x*h,v=c.y*h,w=Math.floor(m/a.Z),T=Math.floor(v/a.Z);return{tileID:new a.Y(o,0,o,w,T),mercatorX:m,mercatorY:v}}}class Zf{constructor(e,o,c){this._context=e,this._size=o,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new st(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(c.texture),{id:e,fbo:o,texture:c,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(o=>e.id!==o),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const Lo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Br{constructor(e,o){this.painter=e,this.terrain=o,this.pool=new Zf(e.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(c=>!e._layers[c].isHidden(o)),this._coordsAscending={};for(const c in e.sourceCaches){this._coordsAscending[c]={};const h=e.sourceCaches[c].getVisibleCoordinates();for(const m of h){const v=this.terrain.sourceCache.getTerrainCoords(m);for(const w in v)this._coordsAscending[c][w]||(this._coordsAscending[c][w]=[]),this._coordsAscending[c][w].push(v[w])}}this._coordsAscendingStr={};for(const c of e._order){const h=e._layers[c],m=h.source;if(Lo[h.type]&&!this._coordsAscendingStr[m]){this._coordsAscendingStr[m]={};for(const v in this._coordsAscending[m])this._coordsAscendingStr[m][v]=this._coordsAscending[m][v].map(w=>w.key).sort().join()}}for(const c of this._renderableTiles)for(const h in this._coordsAscendingStr){const m=this._coordsAscendingStr[h][c.tileID.key];m&&m!==c.rttCoords[h]&&(c.rtt=[])}}renderLayer(e,o){if(e.isHidden(this.painter.transform.zoom))return!1;const c=Object.assign(Object.assign({},o),{isRenderingToTexture:!0}),h=e.type,m=this.painter,v=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Lo[h]&&(this._prevType&&Lo[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(e.id),!v))return!0;if(Lo[this._prevType]||Lo[h]&&v){this._prevType=h;const w=this._stacks.length-1,T=this._stacks[w]||[];for(const P of this._renderableTiles){if(this.pool.isFull()&&(zc(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(P),P.rtt[w]){const D=this.pool.getObjectForId(P.rtt[w].id);if(D.stamp===P.rtt[w].stamp){this.pool.useObject(D);continue}}const A=this.pool.getOrCreateFreeObject();this.pool.useObject(A),this.pool.stampObject(A),P.rtt[w]={id:A.id,stamp:A.stamp},m.context.bindFramebuffer.set(A.fbo.framebuffer),m.context.clear({color:a.b6.transparent,stencil:0}),m.currentStencilSource=void 0;for(let D=0;D<T.length;D++){const L=m.style._layers[T[D]],U=L.source?this._coordsAscending[L.source][P.tileID.key]:[P.tileID];m.context.viewport.set([0,0,A.fbo.width,A.fbo.height]),m._renderTileClippingMasks(L,U,!0),m.renderLayer(m,m.style.sourceCaches[L.source],L,U,c),L.source&&(P.rttCoords[L.source]=this._coordsAscendingStr[L.source][P.tileID.key])}}return zc(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects(),Lo[h]}return!1}}const Zr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Yh=I,_s={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Et,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},ul={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class qc{constructor(e,o,c=!1){this.mousedown=m=>{this.startMove(m,V.mousePos(this.element,m)),V.addEventListener(window,"mousemove",this.mousemove),V.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=m=>{this.move(m,V.mousePos(this.element,m))},this.mouseup=m=>{this._rotatePitchHanlder.dragEnd(m),this.offTemp()},this.touchstart=m=>{m.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=V.touchPos(this.element,m.targetTouches)[0],this.startMove(m,this._startPos),V.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.addEventListener(window,"touchend",this.touchend))},this.touchmove=m=>{m.targetTouches.length!==1?this.reset():(this._lastPos=V.touchPos(this.element,m.targetTouches)[0],this.move(m,this._lastPos))},this.touchend=m=>{m.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=o;const h=new Zh;this._rotatePitchHanlder=new Xn({clickTolerance:3,move:(m,v)=>{const w=o.getBoundingClientRect(),T=new a.P((w.bottom-w.top)/2,(w.right-w.left)/2);return{bearingDelta:a.c9(new a.P(m.x,v.y),v,T),pitchDelta:c?-.5*(v.y-m.y):void 0}},moveStateManager:h,enable:!0,assignEvents:()=>{}}),this.map=e,V.addEventListener(o,"mousedown",this.mousedown),V.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),V.addEventListener(o,"touchcancel",this.reset)}startMove(e,o){this._rotatePitchHanlder.dragStart(e,o),V.disableDrag()}move(e,o){const c=this.map,{bearingDelta:h,pitchDelta:m}=this._rotatePitchHanlder.dragMove(e,o)||{};h&&c.setBearing(c.getBearing()+h),m&&c.setPitch(c.getPitch()+m)}off(){const e=this.element;V.removeEventListener(e,"mousedown",this.mousedown),V.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend),V.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){V.enableDrag(),V.removeEventListener(window,"mousemove",this.mousemove),V.removeEventListener(window,"mouseup",this.mouseup),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend)}}let Wo;function hl(p,e,o){const c=new a.Q(p.lng,p.lat);if(p=new a.Q(p.lng,p.lat),e){const h=new a.Q(p.lng-360,p.lat),m=new a.Q(p.lng+360,p.lat),v=o.locationToScreenPoint(p).distSqr(e);o.locationToScreenPoint(h).distSqr(e)<v?p=h:o.locationToScreenPoint(m).distSqr(e)<v&&(p=m)}for(;Math.abs(p.lng-o.center.lng)>180;){const h=o.locationToScreenPoint(p);if(h.x>=0&&h.y>=0&&h.x<=o.width&&h.y<=o.height)break;p.lng>o.center.lng?p.lng-=360:p.lng+=360}return p.lng!==c.lng&&o.isPointOnMapSurface(o.locationToScreenPoint(p))?p:c}const Li={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function dl(p,e,o){const c=p.classList;for(const h in Li)c.remove(`maplibregl-${o}-anchor-${h}`);c.add(`maplibregl-${o}-anchor-${e}`)}class sa extends a.E{constructor(e){if(super(),this._onKeyPress=o=>{const c=o.code,h=o.charCode||o.keyCode;c!=="Space"&&c!=="Enter"&&h!==32&&h!==13||this.togglePopup()},this._onMapClick=o=>{const c=o.originalEvent.target,h=this._element;this._popup&&(c===h||h.contains(c))&&this.togglePopup()},this._update=o=>{var c;if(!this._map)return;const h=this._map.loaded()&&!this._map.isMoving();((o==null?void 0:o.type)==="terrain"||(o==null?void 0:o.type)==="render"&&!h)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?hl(this._lngLat,this._flatPos,this._map.transform):(c=this._lngLat)===null||c===void 0?void 0:c.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||o&&o.type!=="moveend"||(this._pos=this._pos.round()),V.setTransform(this._element,`${Li[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${m}`),q.frameAsync(new AbortController).then(()=>{this._updateOpacity(o&&o.type==="moveend")}).catch(()=>{})},this._onMove=o=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.l("dragstart"))),this.fire(new a.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.l("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=a.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=V.create("div");const o=V.createNS("http://www.w3.org/2000/svg","svg"),c=41,h=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${c}px`),o.setAttributeNS(null,"width",`${h}px`),o.setAttributeNS(null,"viewBox",`0 0 ${h} ${c}`);const m=V.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const v=V.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"fill-rule","nonzero");const w=V.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Q of T){const re=V.createNS("http://www.w3.org/2000/svg","ellipse");re.setAttributeNS(null,"opacity","0.04"),re.setAttributeNS(null,"cx","10.5"),re.setAttributeNS(null,"cy","5.80029008"),re.setAttributeNS(null,"rx",Q.rx),re.setAttributeNS(null,"ry",Q.ry),w.appendChild(re)}const P=V.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill",this._color);const A=V.createNS("http://www.w3.org/2000/svg","path");A.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),P.appendChild(A);const D=V.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"opacity","0.25"),D.setAttributeNS(null,"fill","#000000");const L=V.createNS("http://www.w3.org/2000/svg","path");L.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),D.appendChild(L);const U=V.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"transform","translate(6.0, 7.0)"),U.setAttributeNS(null,"fill","#FFFFFF");const G=V.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(8.0, 8.0)");const J=V.createNS("http://www.w3.org/2000/svg","circle");J.setAttributeNS(null,"fill","#000000"),J.setAttributeNS(null,"opacity","0.25"),J.setAttributeNS(null,"cx","5.5"),J.setAttributeNS(null,"cy","5.5"),J.setAttributeNS(null,"r","5.4999962");const K=V.createNS("http://www.w3.org/2000/svg","circle");K.setAttributeNS(null,"fill","#FFFFFF"),K.setAttributeNS(null,"cx","5.5"),K.setAttributeNS(null,"cy","5.5"),K.setAttributeNS(null,"r","5.4999962"),G.appendChild(J),G.appendChild(K),v.appendChild(w),v.appendChild(P),v.appendChild(D),v.appendChild(U),v.appendChild(G),o.appendChild(v),o.setAttributeNS(null,"height",c*this._scale+"px"),o.setAttributeNS(null,"width",h*this._scale+"px"),this._element.appendChild(o),this._offset=a.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",o=>{o.preventDefault()}),this._element.addEventListener("mousedown",o=>{o.preventDefault()}),dl(this._element,this._anchor,"marker"),e&&e.className)for(const o of e.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),V.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=a.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const h=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var o,c;if(!(!((o=this._map)===null||o===void 0)&&o.terrain)){const D=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==D&&(this._element.style.opacity=D))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const h=this._map,m=h.terrain.depthAtPoint(this._pos),v=h.terrain.getElevationForLngLatZoom(this._lngLat,h.transform.tileZoom);if(h.transform.lngLatToCameraDepth(this._lngLat,v)-m<.006)return void(this._element.style.opacity=this._opacity);const w=-this._offset.y/h.transform.pixelsPerMeter,T=Math.sin(h.getPitch()*Math.PI/180)*w,P=h.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),A=h.transform.lngLatToCameraDepth(this._lngLat,v+T)-P>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&A&&this._popup.remove(),this._element.style.opacity=A?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=a.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,o){return(this._opacity===void 0||e===void 0&&o===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const Wc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ys=0,Bi=!1;const Hc={maxWidth:100,unit:"metric"};function fl(p,e,o){const c=o&&o.maxWidth||100,h=p._container.clientHeight/2,m=p._container.clientWidth/2,v=p.unproject([m-c/2,h]),w=p.unproject([m+c/2,h]),T=Math.round(p.project(w).x-p.project(v).x),P=Math.min(c,T,p._container.clientWidth),A=v.distanceTo(w);if(o&&o.unit==="imperial"){const D=3.2808*A;D>5280?$i(e,P,D/5280,p._getUIString("ScaleControl.Miles")):$i(e,P,D,p._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?$i(e,P,A/1852,p._getUIString("ScaleControl.NauticalMiles")):A>=1e3?$i(e,P,A/1e3,p._getUIString("ScaleControl.Kilometers")):$i(e,P,A,p._getUIString("ScaleControl.Meters"))}function $i(p,e,o,c){const h=function(m){const v=Math.pow(10,`${Math.floor(m)}`.length-1);let w=m/v;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(T){const P=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*P)/P}(w),v*w}(o);p.style.width=e*(h/o)+"px",p.innerHTML=`${h}&nbsp;${c}`}const pl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Xc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ml(p){if(p){if(typeof p=="number"){const e=Math.round(Math.abs(p)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,p),"top-left":new a.P(e,e),"top-right":new a.P(-e,e),bottom:new a.P(0,-p),"bottom-left":new a.P(e,-e),"bottom-right":new a.P(-e,-e),left:new a.P(p,0),right:new a.P(-p,0)}}if(p instanceof a.P||Array.isArray(p)){const e=a.P.convert(p);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:a.P.convert(p.center||[0,0]),top:a.P.convert(p.top||[0,0]),"top-left":a.P.convert(p["top-left"]||[0,0]),"top-right":a.P.convert(p["top-right"]||[0,0]),bottom:a.P.convert(p.bottom||[0,0]),"bottom-left":a.P.convert(p["bottom-left"]||[0,0]),"bottom-right":a.P.convert(p["bottom-right"]||[0,0]),left:a.P.convert(p.left||[0,0]),right:a.P.convert(p.right||[0,0])}}return ml(new a.P(0,0))}const gl=I;b.AJAXError=a.ci,b.Event=a.l,b.Evented=a.E,b.LngLat=a.Q,b.MercatorCoordinate=a.$,b.Point=a.P,b.addProtocol=a.cj,b.config=a.a,b.removeProtocol=a.ck,b.AttributionControl=ia,b.BoxZoomHandler=Uh,b.CanvasSource=It,b.CooperativeGesturesHandler=Zc,b.DoubleClickZoomHandler=Hh,b.DragPanHandler=na,b.DragRotateHandler=al,b.EdgeInsets=hn,b.FullscreenControl=class extends a.E{constructor(p={}){super(),this._onFullscreenChange=()=>{var e;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=o==null?void 0:o.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){V.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const p=this._fullscreenButton=V.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);V.create("span","maplibregl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.title=p}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},b.GeoJSONSource=at,b.GeolocateControl=class extends a.E{constructor(p){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new a.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const o=new a.Q(e.coords.longitude,e.coords.latitude),c=e.coords.accuracy,h=this._map.getBearing(),m=a.e({bearing:h},this.options.fitBoundsOptions),v=Ie.fromLngLat(o,c);this._map.fitBounds(v,m,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const o=new a.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Bi)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=V.create("button","maplibregl-ctrl-geolocate",this._container),V.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=V.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new sa({element:this._dotElement}),this._circleElement=V.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new sa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.l("trackuserlocationend")),this.fire(new a.l("userlocationlostfocus")))})}},this.options=a.e({},Wc,p)}onAdd(p){return this._map=p,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return a._(this,arguments,void 0,function*(e=!1){if(Wo!==void 0&&!e)return Wo;if(window.navigator.permissions===void 0)return Wo=!!window.navigator.geolocation,Wo;try{Wo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Wo=!!window.navigator.geolocation}return Wo})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),V.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ys=0,Bi=!1}_isOutOfMapMaxBounds(p){const e=this._map.getMaxBounds(),o=p.coords;return e&&(o.longitude<e.getWest()||o.longitude>e.getEast()||o.latitude<e.getSouth()||o.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const p=this._map.getBounds(),e=p.getSouthEast(),o=p.getNorthEast(),c=e.distanceTo(o),h=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ys--,Bi=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.l("trackuserlocationstart")),this.fire(new a.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ys++,ys>1?(p={maximumAge:6e5,timeout:0},Bi=!0):(p=this.options.positionOptions,Bi=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},b.GlobeControl=class{constructor(){this._toggleProjection=()=>{var p;const e=(p=this._map.getProjection())===null||p===void 0?void 0:p.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var p;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((p=this._map.getProjection())===null||p===void 0?void 0:p.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(p){return this._map=p,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=V.create("button","maplibregl-ctrl-globe",this._container),V.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){V.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},b.Hash=li,b.ImageSource=nt,b.KeyboardHandler=Nc,b.LngLatBounds=Ie,b.LogoControl=cl,b.Map=class extends wt{constructor(p){var e,o;a.cf.mark(a.cg.create);const c=Object.assign(Object.assign(Object.assign({},_s),p),{canvasContextAttributes:Object.assign(Object.assign({},_s.canvasContextAttributes),p.canvasContextAttributes)});if(c.minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const h=new lo,m=new So;if(c.minZoom!==void 0&&h.setMinZoom(c.minZoom),c.maxZoom!==void 0&&h.setMaxZoom(c.maxZoom),c.minPitch!==void 0&&h.setMinPitch(c.minPitch),c.maxPitch!==void 0&&h.setMaxPitch(c.maxPitch),c.renderWorldCopies!==void 0&&h.setRenderWorldCopies(c.renderWorldCopies),super(h,m,{bearingSnap:c.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Gc,this._controls=[],this._mapId=a.a3(),this._contextLost=w=>{w.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.l("webglcontextlost",{originalEvent:w}))},this._contextRestored=w=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.l("webglcontextrestored",{originalEvent:w}))},this._onMapScroll=w=>{if(w.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._maxTileCacheZoomLevels=c.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},c.canvasContextAttributes),this._trackResize=c.trackResize===!0,this._bearingSnap=c.bearingSnap,this._centerClampedToGround=c.centerClampedToGround,this._refreshExpiredTiles=c.refreshExpiredTiles===!0,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions===!0,this._collectResourceTiming=c.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Zr),c.locale),this._clickTolerance=c.clickTolerance,this._overridePixelRatio=c.pixelRatio,this._maxCanvasSize=c.maxCanvasSize,this.transformCameraUpdate=c.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=c.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=be.addThrottleControl(()=>this.isMoving()),this._requestManager=new Oe(c.transformRequest),typeof c.container=="string"){if(this._container=document.getElementById(c.container),!this._container)throw new Error(`Container '${c.container}' not found.`)}else{if(!(c.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let w=!1;const T=Dc(P=>{this._trackResize&&!this._removed&&(this.resize(P),this.redraw())},50);this._resizeObserver=new ResizeObserver(P=>{w?T(P):w=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ll(this,c),this._hash=c.hash&&new li(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,elevation:c.elevation,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,roll:c.roll}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,a.e({},c.fitBoundsOptions,{duration:0}))));const v=typeof c.style=="string"||((o=(e=c.style)===null||e===void 0?void 0:e.projection)===null||o===void 0?void 0:o.type)!=="globe";this.resize(null,v),this._localIdeographFontFamily=c.localIdeographFontFamily,this._validateStyle=c.validateStyle,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new ia(typeof c.attributionControl=="boolean"?void 0:c.attributionControl)),c.maplibreLogo&&this.addControl(new cl,c.logoPosition),this.on("style.load",()=>{if(v||this._resizeTransform(),this.transform.unmodified){const w=a.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(w)}}),this.on("data",w=>{this._update(w.dataType==="style"),this.fire(new a.l(`${w.dataType}data`,w))}),this.on("dataloading",w=>{this.fire(new a.l(`${w.dataType}dataloading`,w))}),this.on("dataabort",w=>{this.fire(new a.l("sourcedataabort",w))})}_getMapId(){return this._mapId}addControl(p,e){if(e===void 0&&(e=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new a.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=p.onAdd(this);this._controls.push(p);const c=this._controlPositions[e];return e.indexOf("bottom")!==-1?c.insertBefore(o,c.firstChild):c.appendChild(o),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new a.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(p);return e>-1&&this._controls.splice(e,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}calculateCameraOptionsFromTo(p,e,o,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(p,e,o,c)}resize(p,e=!0){const[o,c]=this._containerDimensions(),h=this._getClampedPixelRatio(o,c);if(this._resizeCanvas(o,c,h),this.painter.resize(o,c,h),this.painter.overLimit()){const v=this.painter.context.gl;this._maxCanvasSize=[v.drawingBufferWidth,v.drawingBufferHeight];const w=this._getClampedPixelRatio(o,c);this._resizeCanvas(o,c,w),this.painter.resize(o,c,w)}this._resizeTransform(e);const m=!this._moving;return m&&(this.stop(),this.fire(new a.l("movestart",p)).fire(new a.l("move",p))),this.fire(new a.l("resize",p)),m&&this.fire(new a.l("moveend",p)),this}_resizeTransform(p=!0){var e;const[o,c]=this._containerDimensions();this.transform.resize(o,c,p),(e=this._requestedCameraState)===null||e===void 0||e.resize(o,c,p)}_getClampedPixelRatio(p,e){const{0:o,1:c}=this._maxCanvasSize,h=this.getPixelRatio(),m=p*h,v=e*h;return Math.min(m>o?o/m:1,v>c?c/v:1)*h}getPixelRatio(){var p;return(p=this._overridePixelRatio)!==null&&p!==void 0?p:devicePixelRatio}setPixelRatio(p){this._overridePixelRatio=p,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(p){return this.transform.setMaxBounds(Ie.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.setMinZoom(p),this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.setMaxZoom(p),this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.setMinPitch(p),this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(p>=this.transform.minPitch)return this.transform.setMaxPitch(p),this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.setRenderWorldCopies(p),this._update()}project(p){return this.transform.locationToScreenPoint(a.Q.convert(p),this.style&&this.terrain)}unproject(p){return this.transform.screenPointToLocation(a.P.convert(p),this.terrain)}isMoving(){var p;return this._moving||((p=this.handlers)===null||p===void 0?void 0:p.isMoving())}isZooming(){var p;return this._zooming||((p=this.handlers)===null||p===void 0?void 0:p.isZooming())}isRotating(){var p;return this._rotating||((p=this.handlers)===null||p===void 0?void 0:p.isRotating())}_createDelegatedListener(p,e,o){if(p==="mouseenter"||p==="mouseover"){let c=!1;return{layers:e,listener:o,delegates:{mousemove:m=>{const v=e.filter(T=>this.getLayer(T)),w=v.length!==0?this.queryRenderedFeatures(m.point,{layers:v}):[];w.length?c||(c=!0,o.call(this,new Lr(p,this,m.originalEvent,{features:w}))):c=!1},mouseout:()=>{c=!1}}}}if(p==="mouseleave"||p==="mouseout"){let c=!1;return{layers:e,listener:o,delegates:{mousemove:v=>{const w=e.filter(T=>this.getLayer(T));(w.length!==0?this.queryRenderedFeatures(v.point,{layers:w}):[]).length?c=!0:c&&(c=!1,o.call(this,new Lr(p,this,v.originalEvent)))},mouseout:v=>{c&&(c=!1,o.call(this,new Lr(p,this,v.originalEvent)))}}}}{const c=h=>{const m=e.filter(w=>this.getLayer(w)),v=m.length!==0?this.queryRenderedFeatures(h.point,{layers:m}):[];v.length&&(h.features=v,o.call(this,h),delete h.features)};return{layers:e,listener:o,delegates:{[p]:c}}}}_saveDelegatedListener(p,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(e)}_removeDelegatedListener(p,e,o){if(!this._delegatedListeners||!this._delegatedListeners[p])return;const c=this._delegatedListeners[p];for(let h=0;h<c.length;h++){const m=c[h];if(m.listener===o&&m.layers.length===e.length&&m.layers.every(v=>e.includes(v))){for(const v in m.delegates)this.off(v,m.delegates[v]);return void c.splice(h,1)}}}on(p,e,o){if(o===void 0)return super.on(p,e);const c=typeof e=="string"?[e]:e,h=this._createDelegatedListener(p,c,o);this._saveDelegatedListener(p,h);for(const m in h.delegates)this.on(m,h.delegates[m]);return{unsubscribe:()=>{this._removeDelegatedListener(p,c,o)}}}once(p,e,o){if(o===void 0)return super.once(p,e);const c=typeof e=="string"?[e]:e,h=this._createDelegatedListener(p,c,o);for(const m in h.delegates){const v=h.delegates[m];h.delegates[m]=(...w)=>{this._removeDelegatedListener(p,c,o),v(...w)}}this._saveDelegatedListener(p,h);for(const m in h.delegates)this.once(m,h.delegates[m]);return this}off(p,e,o){return o===void 0?super.off(p,e):(this._removeDelegatedListener(p,typeof e=="string"?[e]:e,o),this)}queryRenderedFeatures(p,e){if(!this.style)return[];let o;const c=p instanceof a.P||Array.isArray(p),h=c?p:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(c?{}:p)||{},h instanceof a.P||typeof h[0]=="number")o=[a.P.convert(h)];else{const m=a.P.convert(h[0]),v=a.P.convert(h[1]);o=[m,new a.P(v.x,m.y),v,new a.P(m.x,v.y),m]}return this.style.queryRenderedFeatures(o,e,this.transform)}querySourceFeatures(p,e){return this.style.querySourceFeatures(p,e)}setStyle(p,e){return(e=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(p,e))}setTransformRequest(p){return this._requestManager.setTransformRequest(p),this}_getUIString(p){const e=this._locale[p];if(e==null)throw new Error(`Missing UI string '${p}'`);return e}_updateStyle(p,e){var o,c;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(p,e));const h=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!p)),p?(this.style=new Ws(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p,e,h):this.style.loadJSON(p,e,h),this):((c=(o=this.style)===null||o===void 0?void 0:o.projection)===null||c===void 0||c.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ws(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,e){if(typeof p=="string"){const o=this._requestManager.transformRequest(p,"Style");a.j(o,new AbortController).then(c=>{this._updateDiff(c.data,e)}).catch(c=>{c&&this.fire(new a.k(c))})}else typeof p=="object"&&this._updateDiff(p,e)}_updateDiff(p,e){try{this.style.setState(p,e)&&this._update(!0)}catch(o){a.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(p,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(p,e){return this._lazyInitEmptyStyle(),this.style.addSource(p,e),this._update(!0)}isSourceLoaded(p){const e=this.style&&this.style.sourceCaches[p];if(e!==void 0)return e.loaded();this.fire(new a.k(new Error(`There is no source with ID '${p}'`)))}setTerrain(p){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),p){const e=this.style.sourceCaches[p.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${p.source}`);this.terrain===null&&e.reload();for(const o in this.style._layers){const c=this.style._layers[o];c.type==="hillshade"&&c.source===p.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Do(this.painter,e,p),this.painter.renderToTexture=new Br(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=o=>{o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==p.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new a.l("terrain",{terrain:p})),this}getTerrain(){var p,e;return(e=(p=this.terrain)===null||p===void 0?void 0:p.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const p=this.style&&this.style.sourceCaches;for(const e in p){const o=p[e]._tiles;for(const c in o){const h=o[c];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}removeSource(p){return this.style.removeSource(p),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,e,o={}){const{pixelRatio:c=1,sdf:h=!1,stretchX:m,stretchY:v,content:w,textFitWidth:T,textFitHeight:P}=o;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||a.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:A,height:D,data:L}=e,U=e;return this.style.addImage(p,{data:new a.R({width:A,height:D},new Uint8Array(L)),pixelRatio:c,stretchX:m,stretchY:v,content:w,textFitWidth:T,textFitHeight:P,sdf:h,version:0,userImage:U}),U.onAdd&&U.onAdd(this,p),this}}{const{width:A,height:D,data:L}=q.getImageData(e);this.style.addImage(p,{data:new a.R({width:A,height:D},L),pixelRatio:c,stretchX:m,stretchY:v,content:w,textFitWidth:T,textFitHeight:P,sdf:h,version:0})}}updateImage(p,e){const o=this.style.getImage(p);if(!o)return this.fire(new a.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=e instanceof HTMLImageElement||a.b(e)?q.getImageData(e):e,{width:h,height:m,data:v}=c;if(h===void 0||m===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==o.data.width||m!==o.data.height)return this.fire(new a.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(e instanceof HTMLImageElement||a.b(e));return o.data.replace(v,w),this.style.updateImage(p,o),this}getImage(p){return this.style.getImage(p)}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new a.k(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p){return be.getImage(this._requestManager.transformRequest(p,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(p,e){return this._lazyInitEmptyStyle(),this.style.addLayer(p,e),this._update(!0)}moveLayer(p,e){return this.style.moveLayer(p,e),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(p,e,o){return this.style.setLayerZoomRange(p,e,o),this._update(!0)}setFilter(p,e,o={}){return this.style.setFilter(p,e,o),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,e,o,c={}){return this.style.setPaintProperty(p,e,o,c),this._update(!0)}getPaintProperty(p,e){return this.style.getPaintProperty(p,e)}setLayoutProperty(p,e,o,c={}){return this.style.setLayoutProperty(p,e,o,c),this._update(!0)}getLayoutProperty(p,e){return this.style.getLayoutProperty(p,e)}setGlyphs(p,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(p,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(p,e,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(p,e,o,c=>{c||this._update(!0)}),this}removeSprite(p){return this._lazyInitEmptyStyle(),this.style.removeSprite(p),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(p,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(p,e,o=>{o||this._update(!0)}),this}setLight(p,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(p,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(p,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(p,e){return this.style.setFeatureState(p,e),this._update()}removeFeatureState(p,e){return this.style.removeFeatureState(p,e),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let p=0,e=0;return this._container&&(p=this._container.clientWidth||400,e=this._container.clientHeight||300),[p,e]}_setupContainer(){const p=this._container;p.classList.add("maplibregl-map");const e=this._canvasContainer=V.create("div","maplibregl-canvas-container",p);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=V.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),c=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],c);const h=this._controlContainer=V.create("div","maplibregl-control-container",p),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{m[v]=V.create("div",`maplibregl-ctrl-${v} `,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,e,o){this._canvas.width=Math.floor(o*p),this._canvas.height=Math.floor(o*e),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const p=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{e={requestedAttributes:p},c&&(e.statusMessage=c.statusMessage,e.type=c.type)},{once:!0});let o=null;if(o=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,p):this._canvas.getContext("webgl2",p)||this._canvas.getContext("webgl",p),!o){const c="Failed to initialize WebGL";throw e?(e.message=c,new Error(JSON.stringify(e))):new Error(c)}this.painter=new Bh(o,this.transform),ie.testSupport(o)}migrateProjection(p,e){super.migrateProjection(p,e),this.painter.transform=p,this.fire(new a.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_render(p){var e,o,c,h,m;const v=this._idleTriggered?this._fadeDuration:0,w=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._removed)return;let T=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const D=this.transform.zoom,L=q.now();this.style.zoomHistory.update(D,L);const U=new a.C(D,{now:L,fadeDuration:v,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),G=U.crossFadingFactor();G===1&&G===this._crossFadingFactor||(T=!0,this._crossFadingFactor=G),this.style.update(U)}const P=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0!==w;(c=this.style.projection)===null||c===void 0||c.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((h=this.style.projection)===null||h===void 0?void 0:h.transitionState,(m=this.style.projection)===null||m===void 0?void 0:m.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||P)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,v,this._crossSourceCollisions,P),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,showPadding:this.showPadding}),this.fire(new a.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.cf.mark(a.cg.load),this.fire(new a.l("load"))),this.style&&(this.style.hasTransitions()||T)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const A=this._sourcesDirty||this._styleDirty||this._placementDirty;return A||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.l("idle")),!this._loaded||this._fullyLoaded||A||(this._fullyLoaded=!0,a.cf.mark(a.cg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var p;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),be.removeThrottleControl(this._imageQueueHandle),(p=this._resizeObserver)===null||p===void 0||p.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),V.remove(this._canvasContainer),V.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),a.cf.clearMetrics(),this._removed=!0,this.fire(new a.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,q.frame(this._frameRequest,p=>{a.cf.frame(p),this._frameRequest=null;try{this._render(p)}catch(e){if(!a.ch(e)&&!function(o){return o.message===Eh}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get version(){return Yh}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(p){return this._lazyInitEmptyStyle(),this.style.setProjection(p),this._update(!0)}},b.MapMouseEvent=Lr,b.MapTouchEvent=Fn,b.MapWheelEvent=Lc,b.Marker=sa,b.NavigationControl=class{constructor(p){this._updateZoomButtons=()=>{const e=this._map.getZoom(),o=e===this._map.getMaxZoom(),c=e===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,o)=>{const c=this._map._getUIString(`NavigationControl.${o}`);e.title=c,e.setAttribute("aria-label",c)},this.options=a.e({},ul,p),this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),V.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),V.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=V.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){V.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(p,e){const o=V.create("button",p,this._container);return o.type="button",o.addEventListener("click",e),o}},b.Popup=class extends a.E{constructor(p){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&V.remove(this._content),this._container&&(V.remove(this._container),delete this._container),this._closeButton&&this._closeButton.removeEventListener("click",this._onClose),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new a.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var o;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=V.create("div","maplibregl-popup",this._map.getContainer()),this._tip=V.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const w of this.options.className.split(" "))this._container.classList.add(w);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?hl(this._lngLat,this._flatPos,this._map.transform):(o=this._lngLat)===null||o===void 0?void 0:o.wrap(),this._trackPointer&&!e)return;const c=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let h=this.options.anchor;const m=ml(this.options.offset);if(!h){const w=this._container.offsetWidth,T=this._container.offsetHeight;let P;P=c.y+m.bottom.y<T?["top"]:c.y>this._map.transform.height-T?["bottom"]:[],c.x<w/2?P.push("left"):c.x>this._map.transform.width-w/2&&P.push("right"),h=P.length===0?"bottom":P.join("-")}let v=c.add(m[h]);this.options.subpixelPositioning||(v=v.round()),V.setTransform(this._container,`${Li[h]} translate(${v.x}px,${v.y}px)`),dl(this._container,h,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(pl),p)}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(p){return this._lngLat=a.Q.convert(p),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const e=document.createDocumentFragment(),o=document.createElement("body");let c;for(o.innerHTML=p;c=o.firstChild,c;)e.appendChild(c);return this.setDOMContent(e)}getMaxWidth(){var p;return(p=this._container)===null||p===void 0?void 0:p.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=V.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(p){return this._container&&this._container.classList.add(p),this}removeClassName(p){return this._container&&this._container.classList.remove(p),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){if(this._container)return this._container.classList.toggle(p)}setSubpixelPositioning(p){this.options.subpixelPositioning=p}_createCloseButton(){this.options.closeButton&&(this._closeButton=V.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Xc);p&&p.focus()}},b.RasterDEMTileSource=lt,b.RasterTileSource=He,b.ScaleControl=class{constructor(p){this._onMove=()=>{fl(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,fl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Hc),p)}getDefaultPosition(){return"bottom-left"}onAdd(p){return this._map=p,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){V.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},b.ScrollZoomHandler=Wh,b.Style=Ws,b.TerrainControl=class{constructor(p){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=p}onAdd(p){return this._map=p,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=V.create("button","maplibregl-ctrl-terrain",this._container),V.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){V.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},b.TwoFingersTouchPitchHandler=Fc,b.TwoFingersTouchRotateHandler=qh,b.TwoFingersTouchZoomHandler=Gh,b.TwoFingersTouchZoomRotateHandler=Uc,b.VectorTileSource=We,b.VideoSource=Xe,b.addSourceType=(p,e)=>a._(void 0,void 0,void 0,function*(){if(St(p))throw new Error(`A source type called "${p}" already exists.`);((o,c)=>{ht[o]=c})(p,e)}),b.clearPrewarmedResources=function(){const p=zr;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(ir),zr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},b.createTileMesh=Gs,b.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},b.getRTLTextPluginStatus=function(){return Zt().getRTLTextPluginStatus()},b.getVersion=function(){return gl},b.getWorkerCount=function(){return Ht.workerCount},b.getWorkerUrl=function(){return a.a.WORKER_URL},b.importScriptInWorkers=function(p){return Gn().broadcast("IS",p)},b.prewarm=function(){Kr().acquire(ir)},b.setMaxParallelImageRequests=function(p){a.a.MAX_PARALLEL_IMAGE_REQUESTS=p},b.setRTLTextPlugin=function(p,e){return Zt().setRTLTextPlugin(p,e)},b.setWorkerCount=function(p){Ht.workerCount=p},b.setWorkerUrl=function(p){a.a.WORKER_URL=p}});var C=u;return C})}(Ld)),Ld.exports}var rR=tR();const nR=Qz(rR);function pb(r,n,u){if(r!==null)for(var f,y,C,b,a,I,R,$=0,N=0,q,V=r.type,ie=V==="FeatureCollection",Pe=V==="Feature",Ne=ie?r.features.length:1,xe=0;xe<Ne;xe++){R=ie?r.features[xe].geometry:Pe?r.geometry:r,q=R?R.type==="GeometryCollection":!1,a=q?R.geometries.length:1;for(var Ge=0;Ge<a;Ge++){var qe=0,be=0;if(b=q?R.geometries[Ge]:R,b!==null){I=b.coordinates;var Oe=b.type;switch($=0,Oe){case null:break;case"Point":if(n(I,N,xe,qe,be)===!1)return!1;N++,qe++;break;case"LineString":case"MultiPoint":for(f=0;f<I.length;f++){if(n(I[f],N,xe,qe,be)===!1)return!1;N++,Oe==="MultiPoint"&&qe++}Oe==="LineString"&&qe++;break;case"Polygon":case"MultiLineString":for(f=0;f<I.length;f++){for(y=0;y<I[f].length-$;y++){if(n(I[f][y],N,xe,qe,be)===!1)return!1;N++}Oe==="MultiLineString"&&qe++,Oe==="Polygon"&&be++}Oe==="Polygon"&&qe++;break;case"MultiPolygon":for(f=0;f<I.length;f++){for(be=0,y=0;y<I[f].length;y++){for(C=0;C<I[f][y].length-$;C++){if(n(I[f][y][C],N,xe,qe,be)===!1)return!1;N++}be++}qe++}break;case"GeometryCollection":for(f=0;f<b.geometries.length;f++)if(pb(b.geometries[f],n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function oR(r,n={}){if(r.bbox!=null&&n.recompute!==!0)return r.bbox;const u=[1/0,1/0,-1/0,-1/0];return pb(r,f=>{u[0]>f[0]&&(u[0]=f[0]),u[1]>f[1]&&(u[1]=f[1]),u[2]<f[0]&&(u[2]=f[0]),u[3]<f[1]&&(u[3]=f[1])}),u}const Jm=SC("map",()=>{const r=Xl({"weather-warnings":{id:"weather-warnings",homeMapLayerType:"fixed",title:"Weather Warnings",position:1,visible:!1,enabled:!1,icon:"icon-warning",multiTemporal:!1,legendConfig:{type:"basic",title:"Weather Warnings",items:[{name:"Extreme",color:"#d72f2a"},{name:"Severe",color:"#fe9900"},{name:"Moderate",color:"#ff0"},{name:"Minor",color:"#03ffff"}]}},"weather-forecast":{id:"weather-forecast",homeMapLayerType:"fixed",title:"Weather Forecast",position:2,visible:!1,enabled:!1,dateFormat:{currentTime:"yyyy-MM-dd HH:mm"},icon:"icon-heavy-rain",multiTemporal:!0}}),n=_o(!1),u=cr(()=>Object.values(r).filter(xe=>xe.enabled&&xe.homeMapLayerType==="fixed").sort((xe,Ge)=>xe.position-Ge.position)),f=cr(()=>Object.values(r).filter(xe=>xe.enabled&&xe.homeMapLayerType==="dynamic").sort((xe,Ge)=>xe.position-Ge.position)),y=_o({}),C=_o({}),b=_o(null),a=xe=>{n.value=xe},I=(xe,Ge)=>{r[xe]?r[xe].enabled=Ge:console.warn(`Layer with ID '${xe}' not found`)},R=(xe,Ge)=>{r[xe]?r[xe].visible=Ge:console.warn(`Layer with ID '${xe}' not found`)},$=xe=>{r["weather-forecast"]&&(r["weather-forecast"].dateFormat=xe)},N=(xe,Ge)=>{y.value={...y.value,[xe]:Ge}},q=(xe,Ge)=>{C.value={...C.value,[xe]:Ge}},V=xe=>{b.value=xe},ie=xe=>r[xe]||null,Pe=xe=>{if(!xe.id||r[xe.id]){console.error("Invalid or duplicate layer ID");return}r[xe.id]=xe},Ne=cr(()=>Object.values(r).filter(xe=>xe.visible));return{loading:n,layers:r,sortedFixedLayers:u,sortedDynamicLayers:f,visibleLayers:Ne,timeLayerDates:y,selectedTimeLayerDateIndex:C,activeTimeLayer:b,setLoading:a,setTimeLayerDates:N,setSelectedTimeLayerDateIndex:q,updateLayerState:I,updateLayerVisibility:R,setActiveTimeLayer:V,setWeatherForecastLayerDateFormat:$,getLayerById:ie,addLayer:Pe}}),iR=r=>{const{layerConfig:n,id:u}=r,f=n.source.tiles[0].replace("{geostore_id}","");return{source:{id:u,type:"raster",tiles:[f]},layer:{id:u,type:"raster"}}},mb=(r,n)=>{const u=new URL(r),f=new URLSearchParams(u.search);return Object.keys(n).forEach(y=>{f.set(y,n[y])}),u.search=decodeURIComponent(f),decodeURIComponent(u.href)},sR=(r,n,u)=>{const f=r.getSource(n);if(f&&f.tiles){const y=f.tiles[0],C=mb(y,u);r.getSource(n).tiles=[C],r.style.sourceCaches[n].clearTiles(),r.style.sourceCaches[n].update(r.transform),r.triggerRepaint()}},gb=6048e5,aR=864e5,_b=6e4,yb=36e5,qy=Symbol.for("constructDateFrom");function Yi(r,n){return typeof r=="function"?r(n):r&&typeof r=="object"&&qy in r?r[qy](n):r instanceof Date?new r.constructor(n):new Date(n)}function bo(r,n){return Yi(n||r,r)}let lR={};function vf(){return lR}function Hu(r,n){var a,I,R,$;const u=vf(),f=(n==null?void 0:n.weekStartsOn)??((I=(a=n==null?void 0:n.locale)==null?void 0:a.options)==null?void 0:I.weekStartsOn)??u.weekStartsOn??(($=(R=u.locale)==null?void 0:R.options)==null?void 0:$.weekStartsOn)??0,y=bo(r,n==null?void 0:n.in),C=y.getDay(),b=(C<f?7:0)+C-f;return y.setDate(y.getDate()-b),y.setHours(0,0,0,0),y}function Wd(r,n){return Hu(r,{...n,weekStartsOn:1})}function vb(r,n){const u=bo(r,n==null?void 0:n.in),f=u.getFullYear(),y=Yi(u,0);y.setFullYear(f+1,0,4),y.setHours(0,0,0,0);const C=Wd(y),b=Yi(u,0);b.setFullYear(f,0,4),b.setHours(0,0,0,0);const a=Wd(b);return u.getTime()>=C.getTime()?f+1:u.getTime()>=a.getTime()?f:f-1}function Wy(r){const n=bo(r),u=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return u.setUTCFullYear(n.getFullYear()),+r-+u}function cR(r,...n){const u=Yi.bind(null,n.find(f=>typeof f=="object"));return n.map(u)}function Hy(r,n){const u=bo(r,n==null?void 0:n.in);return u.setHours(0,0,0,0),u}function uR(r,n,u){const[f,y]=cR(u==null?void 0:u.in,r,n),C=Hy(f),b=Hy(y),a=+C-Wy(C),I=+b-Wy(b);return Math.round((a-I)/aR)}function hR(r,n){const u=vb(r,n),f=Yi(r,0);return f.setFullYear(u,0,4),f.setHours(0,0,0,0),Wd(f)}function dR(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}function fR(r){return!(!dR(r)&&typeof r!="number"||isNaN(+bo(r)))}function bb(r,n){const u=bo(r,n==null?void 0:n.in),f=u.getMonth();return u.setFullYear(u.getFullYear(),f+1,0),u.setHours(23,59,59,999),u}function pR(r,n){const u=bo(r,n==null?void 0:n.in);return u.setFullYear(u.getFullYear(),0,1),u.setHours(0,0,0,0),u}const mR={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},gR=(r,n,u)=>{let f;const y=mR[r];return typeof y=="string"?f=y:n===1?f=y.one:f=y.other.replace("{{count}}",n.toString()),u!=null&&u.addSuffix?u.comparison&&u.comparison>0?"in "+f:f+" ago":f};function Jp(r){return(n={})=>{const u=n.width?String(n.width):r.defaultWidth;return r.formats[u]||r.formats[r.defaultWidth]}}const _R={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},yR={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},vR={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bR={date:Jp({formats:_R,defaultWidth:"full"}),time:Jp({formats:yR,defaultWidth:"full"}),dateTime:Jp({formats:vR,defaultWidth:"full"})},xR={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},wR=(r,n,u,f)=>xR[r];function vu(r){return(n,u)=>{const f=u!=null&&u.context?String(u.context):"standalone";let y;if(f==="formatting"&&r.formattingValues){const b=r.defaultFormattingWidth||r.defaultWidth,a=u!=null&&u.width?String(u.width):b;y=r.formattingValues[a]||r.formattingValues[b]}else{const b=r.defaultWidth,a=u!=null&&u.width?String(u.width):r.defaultWidth;y=r.values[a]||r.values[b]}const C=r.argumentCallback?r.argumentCallback(n):n;return y[C]}}const CR={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},SR={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},TR={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},kR={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},PR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},MR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},IR=(r,n)=>{const u=Number(r),f=u%100;if(f>20||f<10)switch(f%10){case 1:return u+"st";case 2:return u+"nd";case 3:return u+"rd"}return u+"th"},ER={ordinalNumber:IR,era:vu({values:CR,defaultWidth:"wide"}),quarter:vu({values:SR,defaultWidth:"wide",argumentCallback:r=>r-1}),month:vu({values:TR,defaultWidth:"wide"}),day:vu({values:kR,defaultWidth:"wide"}),dayPeriod:vu({values:PR,defaultWidth:"wide",formattingValues:MR,defaultFormattingWidth:"wide"})};function bu(r){return(n,u={})=>{const f=u.width,y=f&&r.matchPatterns[f]||r.matchPatterns[r.defaultMatchWidth],C=n.match(y);if(!C)return null;const b=C[0],a=f&&r.parsePatterns[f]||r.parsePatterns[r.defaultParseWidth],I=Array.isArray(a)?zR(a,N=>N.test(b)):AR(a,N=>N.test(b));let R;R=r.valueCallback?r.valueCallback(I):I,R=u.valueCallback?u.valueCallback(R):R;const $=n.slice(b.length);return{value:R,rest:$}}}function AR(r,n){for(const u in r)if(Object.prototype.hasOwnProperty.call(r,u)&&n(r[u]))return u}function zR(r,n){for(let u=0;u<r.length;u++)if(n(r[u]))return u}function RR(r){return(n,u={})=>{const f=n.match(r.matchPattern);if(!f)return null;const y=f[0],C=n.match(r.parsePattern);if(!C)return null;let b=r.valueCallback?r.valueCallback(C[0]):C[0];b=u.valueCallback?u.valueCallback(b):b;const a=n.slice(y.length);return{value:b,rest:a}}}const DR=/^(\d+)(th|st|nd|rd)?/i,LR=/\d+/i,BR={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},$R={any:[/^b/i,/^(a|c)/i]},OR={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},FR={any:[/1/i,/2/i,/3/i,/4/i]},jR={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},NR={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},VR={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},UR={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},ZR={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},GR={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},qR={ordinalNumber:RR({matchPattern:DR,parsePattern:LR,valueCallback:r=>parseInt(r,10)}),era:bu({matchPatterns:BR,defaultMatchWidth:"wide",parsePatterns:$R,defaultParseWidth:"any"}),quarter:bu({matchPatterns:OR,defaultMatchWidth:"wide",parsePatterns:FR,defaultParseWidth:"any",valueCallback:r=>r+1}),month:bu({matchPatterns:jR,defaultMatchWidth:"wide",parsePatterns:NR,defaultParseWidth:"any"}),day:bu({matchPatterns:VR,defaultMatchWidth:"wide",parsePatterns:UR,defaultParseWidth:"any"}),dayPeriod:bu({matchPatterns:ZR,defaultMatchWidth:"any",parsePatterns:GR,defaultParseWidth:"any"})},WR={code:"en-US",formatDistance:gR,formatLong:bR,formatRelative:wR,localize:ER,match:qR,options:{weekStartsOn:0,firstWeekContainsDate:1}};function HR(r,n){const u=bo(r,n==null?void 0:n.in);return uR(u,pR(u))+1}function XR(r,n){const u=bo(r,n==null?void 0:n.in),f=+Wd(u)-+hR(u);return Math.round(f/gb)+1}function xb(r,n){var $,N,q,V;const u=bo(r,n==null?void 0:n.in),f=u.getFullYear(),y=vf(),C=(n==null?void 0:n.firstWeekContainsDate)??((N=($=n==null?void 0:n.locale)==null?void 0:$.options)==null?void 0:N.firstWeekContainsDate)??y.firstWeekContainsDate??((V=(q=y.locale)==null?void 0:q.options)==null?void 0:V.firstWeekContainsDate)??1,b=Yi((n==null?void 0:n.in)||r,0);b.setFullYear(f+1,0,C),b.setHours(0,0,0,0);const a=Hu(b,n),I=Yi((n==null?void 0:n.in)||r,0);I.setFullYear(f,0,C),I.setHours(0,0,0,0);const R=Hu(I,n);return+u>=+a?f+1:+u>=+R?f:f-1}function YR(r,n){var a,I,R,$;const u=vf(),f=(n==null?void 0:n.firstWeekContainsDate)??((I=(a=n==null?void 0:n.locale)==null?void 0:a.options)==null?void 0:I.firstWeekContainsDate)??u.firstWeekContainsDate??(($=(R=u.locale)==null?void 0:R.options)==null?void 0:$.firstWeekContainsDate)??1,y=xb(r,n),C=Yi((n==null?void 0:n.in)||r,0);return C.setFullYear(y,0,f),C.setHours(0,0,0,0),Hu(C,n)}function KR(r,n){const u=bo(r,n==null?void 0:n.in),f=+Hu(u,n)-+YR(u,n);return Math.round(f/gb)+1}function yr(r,n){const u=r<0?"-":"",f=Math.abs(r).toString().padStart(n,"0");return u+f}const Ts={y(r,n){const u=r.getFullYear(),f=u>0?u:1-u;return yr(n==="yy"?f%100:f,n.length)},M(r,n){const u=r.getMonth();return n==="M"?String(u+1):yr(u+1,2)},d(r,n){return yr(r.getDate(),n.length)},a(r,n){const u=r.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return u.toUpperCase();case"aaa":return u;case"aaaaa":return u[0];case"aaaa":default:return u==="am"?"a.m.":"p.m."}},h(r,n){return yr(r.getHours()%12||12,n.length)},H(r,n){return yr(r.getHours(),n.length)},m(r,n){return yr(r.getMinutes(),n.length)},s(r,n){return yr(r.getSeconds(),n.length)},S(r,n){const u=n.length,f=r.getMilliseconds(),y=Math.trunc(f*Math.pow(10,u-3));return yr(y,n.length)}},Ll={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Xy={G:function(r,n,u){const f=r.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return u.era(f,{width:"abbreviated"});case"GGGGG":return u.era(f,{width:"narrow"});case"GGGG":default:return u.era(f,{width:"wide"})}},y:function(r,n,u){if(n==="yo"){const f=r.getFullYear(),y=f>0?f:1-f;return u.ordinalNumber(y,{unit:"year"})}return Ts.y(r,n)},Y:function(r,n,u,f){const y=xb(r,f),C=y>0?y:1-y;if(n==="YY"){const b=C%100;return yr(b,2)}return n==="Yo"?u.ordinalNumber(C,{unit:"year"}):yr(C,n.length)},R:function(r,n){const u=vb(r);return yr(u,n.length)},u:function(r,n){const u=r.getFullYear();return yr(u,n.length)},Q:function(r,n,u){const f=Math.ceil((r.getMonth()+1)/3);switch(n){case"Q":return String(f);case"QQ":return yr(f,2);case"Qo":return u.ordinalNumber(f,{unit:"quarter"});case"QQQ":return u.quarter(f,{width:"abbreviated",context:"formatting"});case"QQQQQ":return u.quarter(f,{width:"narrow",context:"formatting"});case"QQQQ":default:return u.quarter(f,{width:"wide",context:"formatting"})}},q:function(r,n,u){const f=Math.ceil((r.getMonth()+1)/3);switch(n){case"q":return String(f);case"qq":return yr(f,2);case"qo":return u.ordinalNumber(f,{unit:"quarter"});case"qqq":return u.quarter(f,{width:"abbreviated",context:"standalone"});case"qqqqq":return u.quarter(f,{width:"narrow",context:"standalone"});case"qqqq":default:return u.quarter(f,{width:"wide",context:"standalone"})}},M:function(r,n,u){const f=r.getMonth();switch(n){case"M":case"MM":return Ts.M(r,n);case"Mo":return u.ordinalNumber(f+1,{unit:"month"});case"MMM":return u.month(f,{width:"abbreviated",context:"formatting"});case"MMMMM":return u.month(f,{width:"narrow",context:"formatting"});case"MMMM":default:return u.month(f,{width:"wide",context:"formatting"})}},L:function(r,n,u){const f=r.getMonth();switch(n){case"L":return String(f+1);case"LL":return yr(f+1,2);case"Lo":return u.ordinalNumber(f+1,{unit:"month"});case"LLL":return u.month(f,{width:"abbreviated",context:"standalone"});case"LLLLL":return u.month(f,{width:"narrow",context:"standalone"});case"LLLL":default:return u.month(f,{width:"wide",context:"standalone"})}},w:function(r,n,u,f){const y=KR(r,f);return n==="wo"?u.ordinalNumber(y,{unit:"week"}):yr(y,n.length)},I:function(r,n,u){const f=XR(r);return n==="Io"?u.ordinalNumber(f,{unit:"week"}):yr(f,n.length)},d:function(r,n,u){return n==="do"?u.ordinalNumber(r.getDate(),{unit:"date"}):Ts.d(r,n)},D:function(r,n,u){const f=HR(r);return n==="Do"?u.ordinalNumber(f,{unit:"dayOfYear"}):yr(f,n.length)},E:function(r,n,u){const f=r.getDay();switch(n){case"E":case"EE":case"EEE":return u.day(f,{width:"abbreviated",context:"formatting"});case"EEEEE":return u.day(f,{width:"narrow",context:"formatting"});case"EEEEEE":return u.day(f,{width:"short",context:"formatting"});case"EEEE":default:return u.day(f,{width:"wide",context:"formatting"})}},e:function(r,n,u,f){const y=r.getDay(),C=(y-f.weekStartsOn+8)%7||7;switch(n){case"e":return String(C);case"ee":return yr(C,2);case"eo":return u.ordinalNumber(C,{unit:"day"});case"eee":return u.day(y,{width:"abbreviated",context:"formatting"});case"eeeee":return u.day(y,{width:"narrow",context:"formatting"});case"eeeeee":return u.day(y,{width:"short",context:"formatting"});case"eeee":default:return u.day(y,{width:"wide",context:"formatting"})}},c:function(r,n,u,f){const y=r.getDay(),C=(y-f.weekStartsOn+8)%7||7;switch(n){case"c":return String(C);case"cc":return yr(C,n.length);case"co":return u.ordinalNumber(C,{unit:"day"});case"ccc":return u.day(y,{width:"abbreviated",context:"standalone"});case"ccccc":return u.day(y,{width:"narrow",context:"standalone"});case"cccccc":return u.day(y,{width:"short",context:"standalone"});case"cccc":default:return u.day(y,{width:"wide",context:"standalone"})}},i:function(r,n,u){const f=r.getDay(),y=f===0?7:f;switch(n){case"i":return String(y);case"ii":return yr(y,n.length);case"io":return u.ordinalNumber(y,{unit:"day"});case"iii":return u.day(f,{width:"abbreviated",context:"formatting"});case"iiiii":return u.day(f,{width:"narrow",context:"formatting"});case"iiiiii":return u.day(f,{width:"short",context:"formatting"});case"iiii":default:return u.day(f,{width:"wide",context:"formatting"})}},a:function(r,n,u){const y=r.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return u.dayPeriod(y,{width:"abbreviated",context:"formatting"});case"aaa":return u.dayPeriod(y,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return u.dayPeriod(y,{width:"narrow",context:"formatting"});case"aaaa":default:return u.dayPeriod(y,{width:"wide",context:"formatting"})}},b:function(r,n,u){const f=r.getHours();let y;switch(f===12?y=Ll.noon:f===0?y=Ll.midnight:y=f/12>=1?"pm":"am",n){case"b":case"bb":return u.dayPeriod(y,{width:"abbreviated",context:"formatting"});case"bbb":return u.dayPeriod(y,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return u.dayPeriod(y,{width:"narrow",context:"formatting"});case"bbbb":default:return u.dayPeriod(y,{width:"wide",context:"formatting"})}},B:function(r,n,u){const f=r.getHours();let y;switch(f>=17?y=Ll.evening:f>=12?y=Ll.afternoon:f>=4?y=Ll.morning:y=Ll.night,n){case"B":case"BB":case"BBB":return u.dayPeriod(y,{width:"abbreviated",context:"formatting"});case"BBBBB":return u.dayPeriod(y,{width:"narrow",context:"formatting"});case"BBBB":default:return u.dayPeriod(y,{width:"wide",context:"formatting"})}},h:function(r,n,u){if(n==="ho"){let f=r.getHours()%12;return f===0&&(f=12),u.ordinalNumber(f,{unit:"hour"})}return Ts.h(r,n)},H:function(r,n,u){return n==="Ho"?u.ordinalNumber(r.getHours(),{unit:"hour"}):Ts.H(r,n)},K:function(r,n,u){const f=r.getHours()%12;return n==="Ko"?u.ordinalNumber(f,{unit:"hour"}):yr(f,n.length)},k:function(r,n,u){let f=r.getHours();return f===0&&(f=24),n==="ko"?u.ordinalNumber(f,{unit:"hour"}):yr(f,n.length)},m:function(r,n,u){return n==="mo"?u.ordinalNumber(r.getMinutes(),{unit:"minute"}):Ts.m(r,n)},s:function(r,n,u){return n==="so"?u.ordinalNumber(r.getSeconds(),{unit:"second"}):Ts.s(r,n)},S:function(r,n){return Ts.S(r,n)},X:function(r,n,u){const f=r.getTimezoneOffset();if(f===0)return"Z";switch(n){case"X":return Ky(f);case"XXXX":case"XX":return ya(f);case"XXXXX":case"XXX":default:return ya(f,":")}},x:function(r,n,u){const f=r.getTimezoneOffset();switch(n){case"x":return Ky(f);case"xxxx":case"xx":return ya(f);case"xxxxx":case"xxx":default:return ya(f,":")}},O:function(r,n,u){const f=r.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Yy(f,":");case"OOOO":default:return"GMT"+ya(f,":")}},z:function(r,n,u){const f=r.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Yy(f,":");case"zzzz":default:return"GMT"+ya(f,":")}},t:function(r,n,u){const f=Math.trunc(+r/1e3);return yr(f,n.length)},T:function(r,n,u){return yr(+r,n.length)}};function Yy(r,n=""){const u=r>0?"-":"+",f=Math.abs(r),y=Math.trunc(f/60),C=f%60;return C===0?u+String(y):u+String(y)+n+yr(C,2)}function Ky(r,n){return r%60===0?(r>0?"-":"+")+yr(Math.abs(r)/60,2):ya(r,n)}function ya(r,n=""){const u=r>0?"-":"+",f=Math.abs(r),y=yr(Math.trunc(f/60),2),C=yr(f%60,2);return u+y+n+C}const Jy=(r,n)=>{switch(r){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},wb=(r,n)=>{switch(r){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},JR=(r,n)=>{const u=r.match(/(P+)(p+)?/)||[],f=u[1],y=u[2];if(!y)return Jy(r,n);let C;switch(f){case"P":C=n.dateTime({width:"short"});break;case"PP":C=n.dateTime({width:"medium"});break;case"PPP":C=n.dateTime({width:"long"});break;case"PPPP":default:C=n.dateTime({width:"full"});break}return C.replace("{{date}}",Jy(f,n)).replace("{{time}}",wb(y,n))},QR={p:wb,P:JR},eD=/^D+$/,tD=/^Y+$/,rD=["D","DD","YY","YYYY"];function nD(r){return eD.test(r)}function oD(r){return tD.test(r)}function iD(r,n,u){const f=sD(r,n,u);if(console.warn(f),rD.includes(r))throw new RangeError(f)}function sD(r,n,u){const f=r[0]==="Y"?"years":"days of the month";return`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${n}\`) for formatting ${f} to the input \`${u}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const aD=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,lD=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,cD=/^'([^]*?)'?$/,uD=/''/g,hD=/[a-zA-Z]/;function dD(r,n,u){var $,N,q,V;const f=vf(),y=f.locale??WR,C=f.firstWeekContainsDate??((N=($=f.locale)==null?void 0:$.options)==null?void 0:N.firstWeekContainsDate)??1,b=f.weekStartsOn??((V=(q=f.locale)==null?void 0:q.options)==null?void 0:V.weekStartsOn)??0,a=bo(r,u==null?void 0:u.in);if(!fR(a))throw new RangeError("Invalid time value");let I=n.match(lD).map(ie=>{const Pe=ie[0];if(Pe==="p"||Pe==="P"){const Ne=QR[Pe];return Ne(ie,y.formatLong)}return ie}).join("").match(aD).map(ie=>{if(ie==="''")return{isToken:!1,value:"'"};const Pe=ie[0];if(Pe==="'")return{isToken:!1,value:fD(ie)};if(Xy[Pe])return{isToken:!0,value:ie};if(Pe.match(hD))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Pe+"`");return{isToken:!1,value:ie}});y.localize.preprocessor&&(I=y.localize.preprocessor(a,I));const R={firstWeekContainsDate:C,weekStartsOn:b,locale:y};return I.map(ie=>{if(!ie.isToken)return ie.value;const Pe=ie.value;(oD(Pe)||nD(Pe))&&iD(Pe,n,String(r));const Ne=Xy[Pe[0]];return Ne(a,Pe,y.localize,R)}).join("")}function fD(r){const n=r.match(cD);return n?n[1].replace(uD,"'"):r}function Qm(r,n){const u=()=>Yi(n==null?void 0:n.in,NaN),y=_D(r);let C;if(y.date){const R=yD(y.date,2);C=vD(R.restDateString,R.year)}if(!C||isNaN(+C))return u();const b=+C;let a=0,I;if(y.time&&(a=bD(y.time),isNaN(a)))return u();if(y.timezone){if(I=xD(y.timezone),isNaN(I))return u()}else{const R=new Date(b+a),$=bo(0,n==null?void 0:n.in);return $.setFullYear(R.getUTCFullYear(),R.getUTCMonth(),R.getUTCDate()),$.setHours(R.getUTCHours(),R.getUTCMinutes(),R.getUTCSeconds(),R.getUTCMilliseconds()),$}return bo(b+a+I,n==null?void 0:n.in)}const kd={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},pD=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,mD=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,gD=/^([+-])(\d{2})(?::?(\d{2}))?$/;function _D(r){const n={},u=r.split(kd.dateTimeDelimiter);let f;if(u.length>2)return n;if(/:/.test(u[0])?f=u[0]:(n.date=u[0],f=u[1],kd.timeZoneDelimiter.test(n.date)&&(n.date=r.split(kd.timeZoneDelimiter)[0],f=r.substr(n.date.length,r.length))),f){const y=kd.timezone.exec(f);y?(n.time=f.replace(y[1],""),n.timezone=y[1]):n.time=f}return n}function yD(r,n){const u=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),f=r.match(u);if(!f)return{year:NaN,restDateString:""};const y=f[1]?parseInt(f[1]):null,C=f[2]?parseInt(f[2]):null;return{year:C===null?y:C*100,restDateString:r.slice((f[1]||f[2]).length)}}function vD(r,n){if(n===null)return new Date(NaN);const u=r.match(pD);if(!u)return new Date(NaN);const f=!!u[4],y=xu(u[1]),C=xu(u[2])-1,b=xu(u[3]),a=xu(u[4]),I=xu(u[5])-1;if(f)return kD(n,a,I)?wD(n,a,I):new Date(NaN);{const R=new Date(0);return!SD(n,C,b)||!TD(n,y)?new Date(NaN):(R.setUTCFullYear(n,C,Math.max(y,b)),R)}}function xu(r){return r?parseInt(r):1}function bD(r){const n=r.match(mD);if(!n)return NaN;const u=Qp(n[1]),f=Qp(n[2]),y=Qp(n[3]);return PD(u,f,y)?u*yb+f*_b+y*1e3:NaN}function Qp(r){return r&&parseFloat(r.replace(",","."))||0}function xD(r){if(r==="Z")return 0;const n=r.match(gD);if(!n)return 0;const u=n[1]==="+"?-1:1,f=parseInt(n[2]),y=n[3]&&parseInt(n[3])||0;return MD(f,y)?u*(f*yb+y*_b):NaN}function wD(r,n,u){const f=new Date(0);f.setUTCFullYear(r,0,4);const y=f.getUTCDay()||7,C=(n-1)*7+u+1-y;return f.setUTCDate(f.getUTCDate()+C),f}const CD=[31,null,31,30,31,30,31,31,30,31,30,31];function Cb(r){return r%400===0||r%4===0&&r%100!==0}function SD(r,n,u){return n>=0&&n<=11&&u>=1&&u<=(CD[n]||(Cb(r)?29:28))}function TD(r,n){return n>=1&&n<=(Cb(r)?366:365)}function kD(r,n,u){return n>=1&&n<=53&&u>=0&&u<=6}function PD(r,n,u){return r===24?n===0&&u===0:u>=0&&u<60&&n>=0&&n<60&&r>=0&&r<25}function MD(r,n){return n>=0&&n<=59}const ID=r=>{const n=new Date;return r.find(f=>new Date(f)>n)||null},ED=r=>{const n=new Date;return r.reverse().find(f=>new Date(f)<n)||null},AD=(r,n)=>{let u=r[r.length-1];switch(n){case"next_to_now":const f=ID(r);f&&(u=f);break;case"previous_to_now":const y=ED(r);y&&(u=y);break;case"latest_from_source":u=r[r.length-1];break;case"earliest_from_source":u=r[0];break}return u},Sb=r=>{let n;return r<=0?n=4:r>3&&r<21||r%10>3?n=0:n=r%10,r+["th","st","nd","rd",""][n]};function zD(r){let n;typeof r=="string"?n=Qm(r):n=r;const u=bb(n).getDate(),f=n.getDate();return f<=5?[1,"1-5th",1]:f<=10?[2,"6-10th",6]:f<=15?[3,"11-15th",11]:f<=20?[4,"16-20th",16]:f<=25?[4,"21-25th",21]:[6,`26-${Sb(u)}`,26]}function RD(r){let n;typeof r=="string"?n=Qm(r):n=r;const u=bb(n).getDate(),f=n.getDate();return f<=10?[1,"1-10th",1]:f<=20?[2,"11-20th",11]:[3,`21-${Sb(u)}`,21]}function DD(r,n,u){let f;typeof r=="string"?f=Qm(r):f=r;let y=dD(f,n);if(u){if(u==="pentadal"){const[C,b]=zD(r);y=`${y} - P${C} ${b}`}else if(u==="dekadal"){const[C,b]=RD(r);y=`${y} - D${C} ${b}`}}return y}function Xu(r){"@babel/helpers - typeof";return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Xu(r)}function LD(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function BD(r,n){for(var u=0;u<n.length;u++){var f=n[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(r,OD(f.key),f)}}function $D(r,n,u){return n&&BD(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function OD(r){var n=FD(r,"string");return Xu(n)=="symbol"?n:n+""}function FD(r,n){if(Xu(r)!="object"||!r)return r;var u=r[Symbol.toPrimitive];if(u!==void 0){var f=u.call(r,n);if(Xu(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var jD=function(){function r(n){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};LD(this,r),this.element=n,this.listener=u}return $D(r,[{key:"bindScrollListener",value:function(){this.scrollableParents=XC(this.element);for(var u=0;u<this.scrollableParents.length;u++)this.scrollableParents[u].addEventListener("scroll",this.listener)}},{key:"unbindScrollListener",value:function(){if(this.scrollableParents)for(var u=0;u<this.scrollableParents.length;u++)this.scrollableParents[u].removeEventListener("scroll",this.listener)}},{key:"destroy",value:function(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}])}(),Es={_loadedStyleNames:new Set,getLoadedStyleNames:function(){return this._loadedStyleNames},isStyleNameLoaded:function(n){return this._loadedStyleNames.has(n)},setLoadedStyleName:function(n){this._loadedStyleNames.add(n)},deleteLoadedStyleName:function(n){this._loadedStyleNames.delete(n)},clearLoadedStyleNames:function(){this._loadedStyleNames.clear()}};function Yu(r){"@babel/helpers - typeof";return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Yu(r)}function Qy(r,n){return ZD(r)||UD(r,n)||VD(r,n)||ND()}function ND(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VD(r,n){if(r){if(typeof r=="string")return e0(r,n);var u={}.toString.call(r).slice(8,-1);return u==="Object"&&r.constructor&&(u=r.constructor.name),u==="Map"||u==="Set"?Array.from(r):u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?e0(r,n):void 0}}function e0(r,n){(n==null||n>r.length)&&(n=r.length);for(var u=0,f=Array(n);u<n;u++)f[u]=r[u];return f}function UD(r,n){var u=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(u!=null){var f,y,C,b,a=[],I=!0,R=!1;try{if(C=(u=u.call(r)).next,n!==0)for(;!(I=(f=C.call(u)).done)&&(a.push(f.value),a.length!==n);I=!0);}catch($){R=!0,y=$}finally{try{if(!I&&u.return!=null&&(b=u.return(),Object(b)!==b))return}finally{if(R)throw y}}return a}}function ZD(r){if(Array.isArray(r))return r}function t0(r,n){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(r);n&&(f=f.filter(function(y){return Object.getOwnPropertyDescriptor(r,y).enumerable})),u.push.apply(u,f)}return u}function ar(r){for(var n=1;n<arguments.length;n++){var u=arguments[n]!=null?arguments[n]:{};n%2?t0(Object(u),!0).forEach(function(f){bm(r,f,u[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):t0(Object(u)).forEach(function(f){Object.defineProperty(r,f,Object.getOwnPropertyDescriptor(u,f))})}return r}function bm(r,n,u){return(n=GD(n))in r?Object.defineProperty(r,n,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[n]=u,r}function GD(r){var n=qD(r,"string");return Yu(n)=="symbol"?n:n+""}function qD(r,n){if(Yu(r)!="object"||!r)return r;var u=r[Symbol.toPrimitive];if(u!==void 0){var f=u.call(r,n);if(Yu(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}var qt={_getMeta:function(){return[xi(arguments.length<=0?void 0:arguments[0])||arguments.length<=0?void 0:arguments[0],No(xi(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:arguments.length<=1?void 0:arguments[1])]},_getConfig:function(n,u){var f,y,C;return(f=(n==null||(y=n.instance)===null||y===void 0?void 0:y.$primevue)||(u==null||(C=u.ctx)===null||C===void 0||(C=C.appContext)===null||C===void 0||(C=C.config)===null||C===void 0||(C=C.globalProperties)===null||C===void 0?void 0:C.$primevue))===null||f===void 0?void 0:f.config},_getOptionValue:Xm,_getPTValue:function(){var n,u,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,I=function(){var Ge=qt._getOptionValue.apply(qt,arguments);return vo(Ge)||yf(Ge)?{class:Ge}:Ge},R=((n=f.binding)===null||n===void 0||(n=n.value)===null||n===void 0?void 0:n.ptOptions)||((u=f.$primevueConfig)===null||u===void 0?void 0:u.ptOptions)||{},$=R.mergeSections,N=$===void 0?!0:$,q=R.mergeProps,V=q===void 0?!1:q,ie=a?qt._useDefaultPT(f,f.defaultPT(),I,C,b):void 0,Pe=qt._usePT(f,qt._getPT(y,f.$name),I,C,ar(ar({},b),{},{global:ie||{}})),Ne=qt._getPTDatasets(f,C);return N||!N&&Pe?V?qt._mergeProps(f,V,ie,Pe,Ne):ar(ar(ar({},ie),Pe),Ne):ar(ar({},Pe),Ne)},_getPTDatasets:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",f="data-pc-";return ar(ar({},u==="root"&&bm({},"".concat(f,"name"),yi(n.$name))),{},bm({},"".concat(f,"section"),yi(u)))},_getPT:function(n){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",f=arguments.length>2?arguments[2]:void 0,y=function(b){var a,I=f?f(b):b,R=yi(u);return(a=I==null?void 0:I[R])!==null&&a!==void 0?a:I};return n&&Object.hasOwn(n,"_usept")?{_usept:n._usept,originalValue:y(n.originalValue),value:y(n.value)}:y(n)},_usePT:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=arguments.length>1?arguments[1]:void 0,f=arguments.length>2?arguments[2]:void 0,y=arguments.length>3?arguments[3]:void 0,C=arguments.length>4?arguments[4]:void 0,b=function(Ne){return f(Ne,y,C)};if(u&&Object.hasOwn(u,"_usept")){var a,I=u._usept||((a=n.$primevueConfig)===null||a===void 0?void 0:a.ptOptions)||{},R=I.mergeSections,$=R===void 0?!0:R,N=I.mergeProps,q=N===void 0?!1:N,V=b(u.originalValue),ie=b(u.value);return V===void 0&&ie===void 0?void 0:vo(ie)?ie:vo(V)?V:$||!$&&ie?q?qt._mergeProps(n,q,V,ie):ar(ar({},V),ie):ie}return b(u)},_useDefaultPT:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=arguments.length>2?arguments[2]:void 0,y=arguments.length>3?arguments[3]:void 0,C=arguments.length>4?arguments[4]:void 0;return qt._usePT(n,u,f,y,C)},_loadStyles:function(){var n,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=arguments.length>1?arguments[1]:void 0,y=arguments.length>2?arguments[2]:void 0,C=qt._getConfig(f,y),b={nonce:C==null||(n=C.csp)===null||n===void 0?void 0:n.nonce};qt._loadCoreStyles(u,b),qt._loadThemeStyles(u,b),qt._loadScopedThemeStyles(u,b),qt._removeThemeListeners(u),u.$loadStyles=function(){return qt._loadThemeStyles(u,b)},qt._themeChangeListener(u.$loadStyles)},_loadCoreStyles:function(){var n,u,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=arguments.length>1?arguments[1]:void 0;if(!Es.isStyleNameLoaded((n=f.$style)===null||n===void 0?void 0:n.name)&&(u=f.$style)!==null&&u!==void 0&&u.name){var C;qr.loadCSS(y),(C=f.$style)===null||C===void 0||C.loadCSS(y),Es.setLoadedStyleName(f.$style.name)}},_loadThemeStyles:function(){var n,u,f,y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},C=arguments.length>1?arguments[1]:void 0;if(!(y!=null&&y.isUnstyled()||(y==null||(n=y.theme)===null||n===void 0?void 0:n.call(y))==="none")){if(!vr.isStyleNameLoaded("common")){var b,a,I=((b=y.$style)===null||b===void 0||(a=b.getCommonTheme)===null||a===void 0?void 0:a.call(b))||{},R=I.primitive,$=I.semantic,N=I.global,q=I.style;qr.load(R==null?void 0:R.css,ar({name:"primitive-variables"},C)),qr.load($==null?void 0:$.css,ar({name:"semantic-variables"},C)),qr.load(N==null?void 0:N.css,ar({name:"global-variables"},C)),qr.loadStyle(ar({name:"global-style"},C),q),vr.setLoadedStyleName("common")}if(!vr.isStyleNameLoaded((u=y.$style)===null||u===void 0?void 0:u.name)&&(f=y.$style)!==null&&f!==void 0&&f.name){var V,ie,Pe,Ne,xe=((V=y.$style)===null||V===void 0||(ie=V.getDirectiveTheme)===null||ie===void 0?void 0:ie.call(V))||{},Ge=xe.css,qe=xe.style;(Pe=y.$style)===null||Pe===void 0||Pe.load(Ge,ar({name:"".concat(y.$style.name,"-variables")},C)),(Ne=y.$style)===null||Ne===void 0||Ne.loadStyle(ar({name:"".concat(y.$style.name,"-style")},C),qe),vr.setLoadedStyleName(y.$style.name)}if(!vr.isStyleNameLoaded("layer-order")){var be,Oe,ct=(be=y.$style)===null||be===void 0||(Oe=be.getLayerOrderThemeCSS)===null||Oe===void 0?void 0:Oe.call(be);qr.load(ct,ar({name:"layer-order",first:!0},C)),vr.setLoadedStyleName("layer-order")}}},_loadScopedThemeStyles:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=arguments.length>1?arguments[1]:void 0,f=n.preset();if(f&&n.$attrSelector){var y,C,b,a=((y=n.$style)===null||y===void 0||(C=y.getPresetTheme)===null||C===void 0?void 0:C.call(y,f,"[".concat(n.$attrSelector,"]")))||{},I=a.css,R=(b=n.$style)===null||b===void 0?void 0:b.load(I,ar({name:"".concat(n.$attrSelector,"-").concat(n.$style.name)},u));n.scopedStyleEl=R.el}},_themeChangeListener:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};Es.clearLoadedStyleNames(),Dn.on("theme:change",n)},_removeThemeListeners:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Dn.off("theme:change",n.$loadStyles)},_hook:function(n,u,f,y,C,b){var a,I,R="on".concat(LC(u)),$=qt._getConfig(y,C),N=f==null?void 0:f.$instance,q=qt._usePT(N,qt._getPT(y==null||(a=y.value)===null||a===void 0?void 0:a.pt,n),qt._getOptionValue,"hooks.".concat(R)),V=qt._useDefaultPT(N,$==null||(I=$.pt)===null||I===void 0||(I=I.directives)===null||I===void 0?void 0:I[n],qt._getOptionValue,"hooks.".concat(R)),ie={el:f,binding:y,vnode:C,prevVnode:b};q==null||q(N,ie),V==null||V(N,ie)},_mergeProps:function(){for(var n=arguments.length>1?arguments[1]:void 0,u=arguments.length,f=new Array(u>2?u-2:0),y=2;y<u;y++)f[y-2]=arguments[y];return Hm(n)?n.apply(void 0,f):Ds.apply(void 0,f)},_extend:function(n){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=function(a,I,R,$,N){var q,V,ie,Pe;I._$instances=I._$instances||{};var Ne=qt._getConfig(R,$),xe=I._$instances[n]||{},Ge=_f(xe)?ar(ar({},u),u==null?void 0:u.methods):{};I._$instances[n]=ar(ar({},xe),{},{$name:n,$host:I,$binding:R,$modifiers:R==null?void 0:R.modifiers,$value:R==null?void 0:R.value,$el:xe.$el||I||void 0,$style:ar({classes:void 0,inlineStyles:void 0,load:function(){},loadCSS:function(){},loadStyle:function(){}},u==null?void 0:u.style),$primevueConfig:Ne,$attrSelector:(q=I.$pd)===null||q===void 0||(q=q[n])===null||q===void 0?void 0:q.attrSelector,defaultPT:function(){return qt._getPT(Ne==null?void 0:Ne.pt,void 0,function(be){var Oe;return be==null||(Oe=be.directives)===null||Oe===void 0?void 0:Oe[n]})},isUnstyled:function(){var be,Oe;return((be=I._$instances[n])===null||be===void 0||(be=be.$binding)===null||be===void 0||(be=be.value)===null||be===void 0?void 0:be.unstyled)!==void 0?(Oe=I._$instances[n])===null||Oe===void 0||(Oe=Oe.$binding)===null||Oe===void 0||(Oe=Oe.value)===null||Oe===void 0?void 0:Oe.unstyled:Ne==null?void 0:Ne.unstyled},theme:function(){var be;return(be=I._$instances[n])===null||be===void 0||(be=be.$primevueConfig)===null||be===void 0?void 0:be.theme},preset:function(){var be;return(be=I._$instances[n])===null||be===void 0||(be=be.$binding)===null||be===void 0||(be=be.value)===null||be===void 0?void 0:be.dt},ptm:function(){var be,Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return qt._getPTValue(I._$instances[n],(be=I._$instances[n])===null||be===void 0||(be=be.$binding)===null||be===void 0||(be=be.value)===null||be===void 0?void 0:be.pt,Oe,ar({},ct))},ptmo:function(){var be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",ct=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return qt._getPTValue(I._$instances[n],be,Oe,ct,!1)},cx:function(){var be,Oe,ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(be=I._$instances[n])!==null&&be!==void 0&&be.isUnstyled()?void 0:qt._getOptionValue((Oe=I._$instances[n])===null||Oe===void 0||(Oe=Oe.$style)===null||Oe===void 0?void 0:Oe.classes,ct,ar({},ut))},sx:function(){var be,Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,ut=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ct?qt._getOptionValue((be=I._$instances[n])===null||be===void 0||(be=be.$style)===null||be===void 0?void 0:be.inlineStyles,Oe,ar({},ut)):void 0}},Ge),I.$instance=I._$instances[n],(V=(ie=I.$instance)[a])===null||V===void 0||V.call(ie,I,R,$,N),I["$".concat(n)]=I.$instance,qt._hook(n,a,I,R,$,N),I.$pd||(I.$pd={}),I.$pd[n]=ar(ar({},(Pe=I.$pd)===null||Pe===void 0?void 0:Pe[n]),{},{name:n,instance:I._$instances[n]})},y=function(a){var I,R,$,N=a._$instances[n],q=N==null?void 0:N.watch,V=function(Ne){var xe,Ge=Ne.newValue,qe=Ne.oldValue;return q==null||(xe=q.config)===null||xe===void 0?void 0:xe.call(N,Ge,qe)},ie=function(Ne){var xe,Ge=Ne.newValue,qe=Ne.oldValue;return q==null||(xe=q["config.ripple"])===null||xe===void 0?void 0:xe.call(N,Ge,qe)};N.$watchersCallback={config:V,"config.ripple":ie},q==null||(I=q.config)===null||I===void 0||I.call(N,N==null?void 0:N.$primevueConfig),As.on("config:change",V),q==null||(R=q["config.ripple"])===null||R===void 0||R.call(N,N==null||($=N.$primevueConfig)===null||$===void 0?void 0:$.ripple),As.on("config:ripple:change",ie)},C=function(a){var I=a._$instances[n].$watchersCallback;I&&(As.off("config:change",I.config),As.off("config:ripple:change",I["config.ripple"]))};return{created:function(a,I,R,$){a.$pd||(a.$pd={}),a.$pd[n]={name:n,attrSelector:KC("pd")},f("created",a,I,R,$)},beforeMount:function(a,I,R,$){var N;qt._loadStyles((N=a.$pd[n])===null||N===void 0?void 0:N.instance,I,R),f("beforeMount",a,I,R,$),y(a)},mounted:function(a,I,R,$){var N;qt._loadStyles((N=a.$pd[n])===null||N===void 0?void 0:N.instance,I,R),f("mounted",a,I,R,$)},beforeUpdate:function(a,I,R,$){f("beforeUpdate",a,I,R,$)},updated:function(a,I,R,$){var N;qt._loadStyles((N=a.$pd[n])===null||N===void 0?void 0:N.instance,I,R),f("updated",a,I,R,$)},beforeUnmount:function(a,I,R,$){var N;C(a),qt._removeThemeListeners((N=a.$pd[n])===null||N===void 0?void 0:N.instance),f("beforeUnmount",a,I,R,$)},unmounted:function(a,I,R,$){var N;(N=a.$pd[n])===null||N===void 0||(N=N.instance)===null||N===void 0||(N=N.scopedStyleEl)===null||N===void 0||(N=N.value)===null||N===void 0||N.remove(),f("unmounted",a,I,R,$)}}},extend:function(){var n=qt._getMeta.apply(qt,arguments),u=Qy(n,2),f=u[0],y=u[1];return ar({extend:function(){var b=qt._getMeta.apply(qt,arguments),a=Qy(b,2),I=a[0],R=a[1];return qt.extend(I,ar(ar(ar({},y),y==null?void 0:y.methods),R))}},qt._extend(f,y))}},WD=qr.extend({name:"focustrap-directive"}),HD=qt.extend({style:WD});function Ku(r){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ku(r)}function r0(r,n){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(r);n&&(f=f.filter(function(y){return Object.getOwnPropertyDescriptor(r,y).enumerable})),u.push.apply(u,f)}return u}function n0(r){for(var n=1;n<arguments.length;n++){var u=arguments[n]!=null?arguments[n]:{};n%2?r0(Object(u),!0).forEach(function(f){XD(r,f,u[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):r0(Object(u)).forEach(function(f){Object.defineProperty(r,f,Object.getOwnPropertyDescriptor(u,f))})}return r}function XD(r,n,u){return(n=YD(n))in r?Object.defineProperty(r,n,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[n]=u,r}function YD(r){var n=KD(r,"string");return Ku(n)=="symbol"?n:n+""}function KD(r,n){if(Ku(r)!="object"||!r)return r;var u=r[Symbol.toPrimitive];if(u!==void 0){var f=u.call(r,n);if(Ku(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}var JD=HD.extend("focustrap",{mounted:function(n,u){var f=u.value||{},y=f.disabled;y||(this.createHiddenFocusableElements(n,u),this.bind(n,u),this.autoElementFocus(n,u)),n.setAttribute("data-pd-focustrap",!0),this.$el=n},updated:function(n,u){var f=u.value||{},y=f.disabled;y&&this.unbind(n)},unmounted:function(n){this.unbind(n)},methods:{getComputedSelector:function(n){return':not(.p-hidden-focusable):not([data-p-hidden-focusable="true"])'.concat(n??"")},bind:function(n,u){var f=this,y=u.value||{},C=y.onFocusIn,b=y.onFocusOut;n.$_pfocustrap_mutationobserver=new MutationObserver(function(a){a.forEach(function(I){if(I.type==="childList"&&!n.contains(document.activeElement)){var R=function(N){var q=Ry(N)?Ry(N,f.getComputedSelector(n.$_pfocustrap_focusableselector))?N:yu(n,f.getComputedSelector(n.$_pfocustrap_focusableselector)):yu(N);return Or(q)?q:N.nextSibling&&R(N.nextSibling)};Tu(R(I.nextSibling))}})}),n.$_pfocustrap_mutationobserver.disconnect(),n.$_pfocustrap_mutationobserver.observe(n,{childList:!0}),n.$_pfocustrap_focusinlistener=function(a){return C&&C(a)},n.$_pfocustrap_focusoutlistener=function(a){return b&&b(a)},n.addEventListener("focusin",n.$_pfocustrap_focusinlistener),n.addEventListener("focusout",n.$_pfocustrap_focusoutlistener)},unbind:function(n){n.$_pfocustrap_mutationobserver&&n.$_pfocustrap_mutationobserver.disconnect(),n.$_pfocustrap_focusinlistener&&n.removeEventListener("focusin",n.$_pfocustrap_focusinlistener)&&(n.$_pfocustrap_focusinlistener=null),n.$_pfocustrap_focusoutlistener&&n.removeEventListener("focusout",n.$_pfocustrap_focusoutlistener)&&(n.$_pfocustrap_focusoutlistener=null)},autoFocus:function(n){this.autoElementFocus(this.$el,{value:n0(n0({},n),{},{autoFocus:!0})})},autoElementFocus:function(n,u){var f=u.value||{},y=f.autoFocusSelector,C=y===void 0?"":y,b=f.firstFocusableSelector,a=b===void 0?"":b,I=f.autoFocus,R=I===void 0?!1:I,$=yu(n,"[autofocus]".concat(this.getComputedSelector(C)));R&&!$&&($=yu(n,this.getComputedSelector(a))),Tu($)},onFirstHiddenElementFocus:function(n){var u,f=n.currentTarget,y=n.relatedTarget,C=y===f.$_pfocustrap_lasthiddenfocusableelement||!((u=this.$el)!==null&&u!==void 0&&u.contains(y))?yu(f.parentElement,this.getComputedSelector(f.$_pfocustrap_focusableselector)):f.$_pfocustrap_lasthiddenfocusableelement;Tu(C)},onLastHiddenElementFocus:function(n){var u,f=n.currentTarget,y=n.relatedTarget,C=y===f.$_pfocustrap_firsthiddenfocusableelement||!((u=this.$el)!==null&&u!==void 0&&u.contains(y))?WC(f.parentElement,this.getComputedSelector(f.$_pfocustrap_focusableselector)):f.$_pfocustrap_firsthiddenfocusableelement;Tu(C)},createHiddenFocusableElements:function(n,u){var f=this,y=u.value||{},C=y.tabIndex,b=C===void 0?0:C,a=y.firstFocusableSelector,I=a===void 0?"":a,R=y.lastFocusableSelector,$=R===void 0?"":R,N=function(Pe){return ob("span",{class:"p-hidden-accessible p-hidden-focusable",tabIndex:b,role:"presentation","aria-hidden":!0,"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0,onFocus:Pe==null?void 0:Pe.bind(f)})},q=N(this.onFirstHiddenElementFocus),V=N(this.onLastHiddenElementFocus);q.$_pfocustrap_lasthiddenfocusableelement=V,q.$_pfocustrap_focusableselector=I,q.setAttribute("data-pc-section","firstfocusableelement"),V.$_pfocustrap_firsthiddenfocusableelement=q,V.$_pfocustrap_focusableselector=$,V.setAttribute("data-pc-section","lastfocusableelement"),n.prepend(q),n.append(V)}}}),Pd=Ym(),Tb={name:"Portal",props:{appendTo:{type:[String,Object],default:"body"},disabled:{type:Boolean,default:!1}},data:function(){return{mounted:!1}},mounted:function(){this.mounted=Km()},computed:{inline:function(){return this.disabled||this.appendTo==="self"}}};function QD(r,n,u,f,y,C){return C.inline?Vd(r.$slots,"default",{key:0}):y.mounted?(sr(),Bs(zw,{key:1,to:u.appendTo},[Vd(r.$slots,"default")],8,["to"])):Zo("",!0)}Tb.render=QD;var eL=({dt:r})=>`
.p-ink {
    display: block;
    position: absolute;
    background: ${r("ripple.background")};
    border-radius: 100%;
    transform: scale(0);
    pointer-events: none;
}

.p-ink-active {
    animation: ripple 0.4s linear;
}

@keyframes ripple {
    100% {
        opacity: 0;
        transform: scale(2.5);
    }
}
`,tL={root:"p-ink"},rL=qr.extend({name:"ripple-directive",style:eL,classes:tL}),nL=qt.extend({style:rL});function Ju(r){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ju(r)}function oL(r){return lL(r)||aL(r)||sL(r)||iL()}function iL(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sL(r,n){if(r){if(typeof r=="string")return xm(r,n);var u={}.toString.call(r).slice(8,-1);return u==="Object"&&r.constructor&&(u=r.constructor.name),u==="Map"||u==="Set"?Array.from(r):u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?xm(r,n):void 0}}function aL(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function lL(r){if(Array.isArray(r))return xm(r)}function xm(r,n){(n==null||n>r.length)&&(n=r.length);for(var u=0,f=Array(n);u<n;u++)f[u]=r[u];return f}function o0(r,n,u){return(n=cL(n))in r?Object.defineProperty(r,n,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[n]=u,r}function cL(r){var n=uL(r,"string");return Ju(n)=="symbol"?n:n+""}function uL(r,n){if(Ju(r)!="object"||!r)return r;var u=r[Symbol.toPrimitive];if(u!==void 0){var f=u.call(r,n);if(Ju(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}var hL=nL.extend("ripple",{watch:{"config.ripple":function(n){n?(this.createRipple(this.$host),this.bindEvents(this.$host),this.$host.setAttribute("data-pd-ripple",!0),this.$host.style.overflow="hidden",this.$host.style.position="relative"):(this.remove(this.$host),this.$host.removeAttribute("data-pd-ripple"))}},unmounted:function(n){this.remove(n)},timeout:void 0,methods:{bindEvents:function(n){n.addEventListener("mousedown",this.onMouseDown.bind(this))},unbindEvents:function(n){n.removeEventListener("mousedown",this.onMouseDown.bind(this))},createRipple:function(n){var u=this.getInk(n);u||(u=ob("span",o0(o0({role:"presentation","aria-hidden":!0,"data-p-ink":!0,"data-p-ink-active":!1,class:!this.isUnstyled()&&this.cx("root"),onAnimationEnd:this.onAnimationEnd.bind(this)},this.$attrSelector,""),"p-bind",this.ptm("root"))),n.appendChild(u),this.$el=u)},remove:function(n){var u=this.getInk(n);u&&(this.$host.style.overflow="",this.$host.style.position="",this.unbindEvents(n),u.removeEventListener("animationend",this.onAnimationEnd),u.remove())},onMouseDown:function(n){var u=this,f=n.currentTarget,y=this.getInk(f);if(!(!y||getComputedStyle(y,null).display==="none")){if(!this.isUnstyled()&&Hp(y,"p-ink-active"),y.setAttribute("data-p-ink-active","false"),!Ay(y)&&!zy(y)){var C=Math.max(UC(f),HC(f));y.style.height=C+"px",y.style.width=C+"px"}var b=_m(f),a=n.pageX-b.left+document.body.scrollTop-zy(y)/2,I=n.pageY-b.top+document.body.scrollLeft-Ay(y)/2;y.style.top=I+"px",y.style.left=a+"px",!this.isUnstyled()&&rb(y,"p-ink-active"),y.setAttribute("data-p-ink-active","true"),this.timeout=setTimeout(function(){y&&(!u.isUnstyled()&&Hp(y,"p-ink-active"),y.setAttribute("data-p-ink-active","false"))},401)}},onAnimationEnd:function(n){this.timeout&&clearTimeout(this.timeout),!this.isUnstyled()&&Hp(n.currentTarget,"p-ink-active"),n.currentTarget.setAttribute("data-p-ink-active","false")},getInk:function(n){return n&&n.children?oL(n.children).find(function(u){return qC(u,"data-pc-name")==="ripple"}):void 0}}});function dL(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"pc",n=Bw();return"".concat(r).concat(n.replace("v-","").replaceAll("-","_"))}var i0=qr.extend({name:"common"});function Qu(r){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Qu(r)}function fL(r){return Mb(r)||pL(r)||Pb(r)||kb()}function pL(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function wu(r,n){return Mb(r)||mL(r,n)||Pb(r,n)||kb()}function kb(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pb(r,n){if(r){if(typeof r=="string")return s0(r,n);var u={}.toString.call(r).slice(8,-1);return u==="Object"&&r.constructor&&(u=r.constructor.name),u==="Map"||u==="Set"?Array.from(r):u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?s0(r,n):void 0}}function s0(r,n){(n==null||n>r.length)&&(n=r.length);for(var u=0,f=Array(n);u<n;u++)f[u]=r[u];return f}function mL(r,n){var u=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(u!=null){var f,y,C,b,a=[],I=!0,R=!1;try{if(C=(u=u.call(r)).next,n===0){if(Object(u)!==u)return;I=!1}else for(;!(I=(f=C.call(u)).done)&&(a.push(f.value),a.length!==n);I=!0);}catch($){R=!0,y=$}finally{try{if(!I&&u.return!=null&&(b=u.return(),Object(b)!==b))return}finally{if(R)throw y}}return a}}function Mb(r){if(Array.isArray(r))return r}function a0(r,n){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(r);n&&(f=f.filter(function(y){return Object.getOwnPropertyDescriptor(r,y).enumerable})),u.push.apply(u,f)}return u}function nr(r){for(var n=1;n<arguments.length;n++){var u=arguments[n]!=null?arguments[n]:{};n%2?a0(Object(u),!0).forEach(function(f){ku(r,f,u[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):a0(Object(u)).forEach(function(f){Object.defineProperty(r,f,Object.getOwnPropertyDescriptor(u,f))})}return r}function ku(r,n,u){return(n=gL(n))in r?Object.defineProperty(r,n,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[n]=u,r}function gL(r){var n=_L(r,"string");return Qu(n)=="symbol"?n:n+""}function _L(r,n){if(Qu(r)!="object"||!r)return r;var u=r[Symbol.toPrimitive];if(u!==void 0){var f=u.call(r,n);if(Qu(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}var yL={name:"BaseComponent",props:{pt:{type:Object,default:void 0},ptOptions:{type:Object,default:void 0},unstyled:{type:Boolean,default:void 0},dt:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0}},watch:{isUnstyled:{immediate:!0,handler:function(n){Dn.off("theme:change",this._loadCoreStyles),n||(this._loadCoreStyles(),this._themeChangeListener(this._loadCoreStyles))}},dt:{immediate:!0,handler:function(n,u){var f=this;Dn.off("theme:change",this._themeScopedListener),n?(this._loadScopedThemeStyles(n),this._themeScopedListener=function(){return f._loadScopedThemeStyles(n)},this._themeChangeListener(this._themeScopedListener)):this._unloadScopedThemeStyles()}}},scopedStyleEl:void 0,rootEl:void 0,uid:void 0,$attrSelector:void 0,beforeCreate:function(){var n,u,f,y,C,b,a,I,R,$,N,q=(n=this.pt)===null||n===void 0?void 0:n._usept,V=q?(u=this.pt)===null||u===void 0||(u=u.originalValue)===null||u===void 0?void 0:u[this.$.type.name]:void 0,ie=q?(f=this.pt)===null||f===void 0||(f=f.value)===null||f===void 0?void 0:f[this.$.type.name]:this.pt;(y=ie||V)===null||y===void 0||(y=y.hooks)===null||y===void 0||(C=y.onBeforeCreate)===null||C===void 0||C.call(y);var Pe=(b=this.$primevueConfig)===null||b===void 0||(b=b.pt)===null||b===void 0?void 0:b._usept,Ne=Pe?(a=this.$primevue)===null||a===void 0||(a=a.config)===null||a===void 0||(a=a.pt)===null||a===void 0?void 0:a.originalValue:void 0,xe=Pe?(I=this.$primevue)===null||I===void 0||(I=I.config)===null||I===void 0||(I=I.pt)===null||I===void 0?void 0:I.value:(R=this.$primevue)===null||R===void 0||(R=R.config)===null||R===void 0?void 0:R.pt;($=xe||Ne)===null||$===void 0||($=$[this.$.type.name])===null||$===void 0||($=$.hooks)===null||$===void 0||(N=$.onBeforeCreate)===null||N===void 0||N.call($),this.$attrSelector=dL(),this.uid=this.$attrs.id||this.$attrSelector.replace("pc","pv_id_")},created:function(){this._hook("onCreated")},beforeMount:function(){var n;this.rootEl=ib(ka(this.$el)?this.$el:(n=this.$el)===null||n===void 0?void 0:n.parentElement,"[".concat(this.$attrSelector,"]")),this.rootEl&&(this.rootEl.$pc=nr({name:this.$.type.name,attrSelector:this.$attrSelector},this.$params)),this._loadStyles(),this._hook("onBeforeMount")},mounted:function(){this._hook("onMounted")},beforeUpdate:function(){this._hook("onBeforeUpdate")},updated:function(){this._hook("onUpdated")},beforeUnmount:function(){this._hook("onBeforeUnmount")},unmounted:function(){this._removeThemeListeners(),this._unloadScopedThemeStyles(),this._hook("onUnmounted")},methods:{_hook:function(n){if(!this.$options.hostName){var u=this._usePT(this._getPT(this.pt,this.$.type.name),this._getOptionValue,"hooks.".concat(n)),f=this._useDefaultPT(this._getOptionValue,"hooks.".concat(n));u==null||u(),f==null||f()}},_mergeProps:function(n){for(var u=arguments.length,f=new Array(u>1?u-1:0),y=1;y<u;y++)f[y-1]=arguments[y];return Hm(n)?n.apply(void 0,f):Ds.apply(void 0,f)},_load:function(){Es.isStyleNameLoaded("base")||(qr.loadCSS(this.$styleOptions),this._loadGlobalStyles(),Es.setLoadedStyleName("base")),this._loadThemeStyles()},_loadStyles:function(){this._load(),this._themeChangeListener(this._load)},_loadCoreStyles:function(){var n,u;!Es.isStyleNameLoaded((n=this.$style)===null||n===void 0?void 0:n.name)&&(u=this.$style)!==null&&u!==void 0&&u.name&&(i0.loadCSS(this.$styleOptions),this.$options.style&&this.$style.loadCSS(this.$styleOptions),Es.setLoadedStyleName(this.$style.name))},_loadGlobalStyles:function(){var n=this._useGlobalPT(this._getOptionValue,"global.css",this.$params);Or(n)&&qr.load(n,nr({name:"global"},this.$styleOptions))},_loadThemeStyles:function(){var n,u;if(!(this.isUnstyled||this.$theme==="none")){if(!vr.isStyleNameLoaded("common")){var f,y,C=((f=this.$style)===null||f===void 0||(y=f.getCommonTheme)===null||y===void 0?void 0:y.call(f))||{},b=C.primitive,a=C.semantic,I=C.global,R=C.style;qr.load(b==null?void 0:b.css,nr({name:"primitive-variables"},this.$styleOptions)),qr.load(a==null?void 0:a.css,nr({name:"semantic-variables"},this.$styleOptions)),qr.load(I==null?void 0:I.css,nr({name:"global-variables"},this.$styleOptions)),qr.loadStyle(nr({name:"global-style"},this.$styleOptions),R),vr.setLoadedStyleName("common")}if(!vr.isStyleNameLoaded((n=this.$style)===null||n===void 0?void 0:n.name)&&(u=this.$style)!==null&&u!==void 0&&u.name){var $,N,q,V,ie=(($=this.$style)===null||$===void 0||(N=$.getComponentTheme)===null||N===void 0?void 0:N.call($))||{},Pe=ie.css,Ne=ie.style;(q=this.$style)===null||q===void 0||q.load(Pe,nr({name:"".concat(this.$style.name,"-variables")},this.$styleOptions)),(V=this.$style)===null||V===void 0||V.loadStyle(nr({name:"".concat(this.$style.name,"-style")},this.$styleOptions),Ne),vr.setLoadedStyleName(this.$style.name)}if(!vr.isStyleNameLoaded("layer-order")){var xe,Ge,qe=(xe=this.$style)===null||xe===void 0||(Ge=xe.getLayerOrderThemeCSS)===null||Ge===void 0?void 0:Ge.call(xe);qr.load(qe,nr({name:"layer-order",first:!0},this.$styleOptions)),vr.setLoadedStyleName("layer-order")}}},_loadScopedThemeStyles:function(n){var u,f,y,C=((u=this.$style)===null||u===void 0||(f=u.getPresetTheme)===null||f===void 0?void 0:f.call(u,n,"[".concat(this.$attrSelector,"]")))||{},b=C.css,a=(y=this.$style)===null||y===void 0?void 0:y.load(b,nr({name:"".concat(this.$attrSelector,"-").concat(this.$style.name)},this.$styleOptions));this.scopedStyleEl=a.el},_unloadScopedThemeStyles:function(){var n;(n=this.scopedStyleEl)===null||n===void 0||(n=n.value)===null||n===void 0||n.remove()},_themeChangeListener:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};Es.clearLoadedStyleNames(),Dn.on("theme:change",n)},_removeThemeListeners:function(){Dn.off("theme:change",this._loadCoreStyles),Dn.off("theme:change",this._load),Dn.off("theme:change",this._themeScopedListener)},_getHostInstance:function(n){return n?this.$options.hostName?n.$.type.name===this.$options.hostName?n:this._getHostInstance(n.$parentInstance):n.$parentInstance:void 0},_getPropValue:function(n){var u;return this[n]||((u=this._getHostInstance(this))===null||u===void 0?void 0:u[n])},_getOptionValue:function(n){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Xm(n,u,f)},_getPTValue:function(){var n,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},C=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,b=/./g.test(f)&&!!y[f.split(".")[0]],a=this._getPropValue("ptOptions")||((n=this.$primevueConfig)===null||n===void 0?void 0:n.ptOptions)||{},I=a.mergeSections,R=I===void 0?!0:I,$=a.mergeProps,N=$===void 0?!1:$,q=C?b?this._useGlobalPT(this._getPTClassValue,f,y):this._useDefaultPT(this._getPTClassValue,f,y):void 0,V=b?void 0:this._getPTSelf(u,this._getPTClassValue,f,nr(nr({},y),{},{global:q||{}})),ie=this._getPTDatasets(f);return R||!R&&V?N?this._mergeProps(N,q,V,ie):nr(nr(nr({},q),V),ie):nr(nr({},V),ie)},_getPTSelf:function(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=arguments.length,f=new Array(u>1?u-1:0),y=1;y<u;y++)f[y-1]=arguments[y];return Ds(this._usePT.apply(this,[this._getPT(n,this.$name)].concat(f)),this._usePT.apply(this,[this.$_attrsPT].concat(f)))},_getPTDatasets:function(){var n,u,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",y="data-pc-",C=f==="root"&&Or((n=this.pt)===null||n===void 0?void 0:n["data-pc-section"]);return f!=="transition"&&nr(nr({},f==="root"&&nr(nr(ku({},"".concat(y,"name"),yi(C?(u=this.pt)===null||u===void 0?void 0:u["data-pc-section"]:this.$.type.name)),C&&ku({},"".concat(y,"extend"),yi(this.$.type.name))),{},ku({},"".concat(this.$attrSelector),""))),{},ku({},"".concat(y,"section"),yi(f)))},_getPTClassValue:function(){var n=this._getOptionValue.apply(this,arguments);return vo(n)||yf(n)?{class:n}:n},_getPT:function(n){var u=this,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",y=arguments.length>2?arguments[2]:void 0,C=function(a){var I,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,$=y?y(a):a,N=yi(f),q=yi(u.$name);return(I=R?N!==q?$==null?void 0:$[N]:void 0:$==null?void 0:$[N])!==null&&I!==void 0?I:$};return n!=null&&n.hasOwnProperty("_usept")?{_usept:n._usept,originalValue:C(n.originalValue),value:C(n.value)}:C(n,!0)},_usePT:function(n,u,f,y){var C=function(Pe){return u(Pe,f,y)};if(n!=null&&n.hasOwnProperty("_usept")){var b,a=n._usept||((b=this.$primevueConfig)===null||b===void 0?void 0:b.ptOptions)||{},I=a.mergeSections,R=I===void 0?!0:I,$=a.mergeProps,N=$===void 0?!1:$,q=C(n.originalValue),V=C(n.value);return q===void 0&&V===void 0?void 0:vo(V)?V:vo(q)?q:R||!R&&V?N?this._mergeProps(N,q,V):nr(nr({},q),V):V}return C(n)},_useGlobalPT:function(n,u,f){return this._usePT(this.globalPT,n,u,f)},_useDefaultPT:function(n,u,f){return this._usePT(this.defaultPT,n,u,f)},ptm:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._getPTValue(this.pt,n,nr(nr({},this.$params),u))},ptmi:function(){var n,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=Ds(this.$_attrsWithoutPT,this.ptm(u,f));return y!=null&&y.hasOwnProperty("id")&&((n=y.id)!==null&&n!==void 0||(y.id=this.$id)),y},ptmo:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._getPTValue(n,u,nr({instance:this},f),!1)},cx:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isUnstyled?void 0:this._getOptionValue(this.$style.classes,n,nr(nr({},this.$params),u))},sx:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(u){var y=this._getOptionValue(this.$style.inlineStyles,n,nr(nr({},this.$params),f)),C=this._getOptionValue(i0.inlineStyles,n,nr(nr({},this.$params),f));return[C,y]}}},computed:{globalPT:function(){var n,u=this;return this._getPT((n=this.$primevueConfig)===null||n===void 0?void 0:n.pt,void 0,function(f){return No(f,{instance:u})})},defaultPT:function(){var n,u=this;return this._getPT((n=this.$primevueConfig)===null||n===void 0?void 0:n.pt,void 0,function(f){return u._getOptionValue(f,u.$name,nr({},u.$params))||No(f,nr({},u.$params))})},isUnstyled:function(){var n;return this.unstyled!==void 0?this.unstyled:(n=this.$primevueConfig)===null||n===void 0?void 0:n.unstyled},$id:function(){return this.$attrs.id||this.uid},$inProps:function(){var n,u=Object.keys(((n=this.$.vnode)===null||n===void 0?void 0:n.props)||{});return Object.fromEntries(Object.entries(this.$props).filter(function(f){var y=wu(f,1),C=y[0];return u==null?void 0:u.includes(C)}))},$theme:function(){var n;return(n=this.$primevueConfig)===null||n===void 0?void 0:n.theme},$style:function(){return nr(nr({classes:void 0,inlineStyles:void 0,load:function(){},loadCSS:function(){},loadStyle:function(){}},(this._getHostInstance(this)||{}).$style),this.$options.style)},$styleOptions:function(){var n;return{nonce:(n=this.$primevueConfig)===null||n===void 0||(n=n.csp)===null||n===void 0?void 0:n.nonce}},$primevueConfig:function(){var n;return(n=this.$primevue)===null||n===void 0?void 0:n.config},$name:function(){return this.$options.hostName||this.$.type.name},$params:function(){var n=this._getHostInstance(this)||this.$parent;return{instance:this,props:this.$props,state:this.$data,attrs:this.$attrs,parent:{instance:n,props:n==null?void 0:n.$props,state:n==null?void 0:n.$data,attrs:n==null?void 0:n.$attrs}}},$_attrsPT:function(){return Object.entries(this.$attrs||{}).filter(function(n){var u=wu(n,1),f=u[0];return f==null?void 0:f.startsWith("pt:")}).reduce(function(n,u){var f=wu(u,2),y=f[0],C=f[1],b=y.split(":"),a=fL(b),I=a.slice(1);return I==null||I.reduce(function(R,$,N,q){return!R[$]&&(R[$]=N===q.length-1?C:{}),R[$]},n),n},{})},$_attrsWithoutPT:function(){return Object.entries(this.$attrs||{}).filter(function(n){var u=wu(n,1),f=u[0];return!(f!=null&&f.startsWith("pt:"))}).reduce(function(n,u){var f=wu(u,2),y=f[0],C=f[1];return n[y]=C,n},{})}}},vL=({dt:r})=>`
.p-popover {
    margin-block-start: ${r("popover.gutter")};
    background: ${r("popover.background")};
    color: ${r("popover.color")};
    border: 1px solid ${r("popover.border.color")};
    border-radius: ${r("popover.border.radius")};
    box-shadow: ${r("popover.shadow")};
}

.p-popover-content {
    padding: ${r("popover.content.padding")};
}

.p-popover-flipped {
    margin-block-start: calc(${r("popover.gutter")} * -1);
    margin-block-end: ${r("popover.gutter")};
}

.p-popover-enter-from {
    opacity: 0;
    transform: scaleY(0.8);
}

.p-popover-leave-to {
    opacity: 0;
}

.p-popover-enter-active {
    transition: transform 0.12s cubic-bezier(0, 0, 0.2, 1), opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
}

.p-popover-leave-active {
    transition: opacity 0.1s linear;
}

.p-popover:after,
.p-popover:before {
    bottom: 100%;
    left: calc(${r("popover.arrow.offset")} + ${r("popover.arrow.left")});
    content: " ";
    height: 0;
    width: 0;
    position: absolute;
    pointer-events: none;
}

.p-popover:after {
    border-width: calc(${r("popover.gutter")} - 2px);
    margin-left: calc(-1 * (${r("popover.gutter")} - 2px));
    border-style: solid;
    border-color: transparent;
    border-bottom-color: ${r("popover.background")};
}

.p-popover:before {
    border-width: ${r("popover.gutter")};
    margin-left: calc(-1 * ${r("popover.gutter")});
    border-style: solid;
    border-color: transparent;
    border-bottom-color: ${r("popover.border.color")};
}

.p-popover-flipped:after,
.p-popover-flipped:before {
    bottom: auto;
    top: 100%;
}

.p-popover.p-popover-flipped:after {
    border-bottom-color: transparent;
    border-top-color: ${r("popover.background")};
}

.p-popover.p-popover-flipped:before {
    border-bottom-color: transparent;
    border-top-color: ${r("popover.border.color")};
}
`,bL={root:"p-popover p-component",content:"p-popover-content"},xL=qr.extend({name:"popover",style:vL,classes:bL}),wL={name:"BasePopover",extends:yL,props:{dismissable:{type:Boolean,default:!0},appendTo:{type:[String,Object],default:"body"},baseZIndex:{type:Number,default:0},autoZIndex:{type:Boolean,default:!0},breakpoints:{type:Object,default:null},closeOnEscape:{type:Boolean,default:!0}},style:xL,provide:function(){return{$pcPopover:this,$parentInstance:this}}},Ib={name:"Popover",extends:wL,inheritAttrs:!1,emits:["show","hide"],data:function(){return{visible:!1}},watch:{dismissable:{immediate:!0,handler:function(n){n?this.bindOutsideClickListener():this.unbindOutsideClickListener()}}},selfClick:!1,target:null,eventTarget:null,outsideClickListener:null,scrollHandler:null,resizeListener:null,container:null,styleElement:null,overlayEventListener:null,documentKeydownListener:null,beforeUnmount:function(){this.dismissable&&this.unbindOutsideClickListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.destroyStyle(),this.unbindResizeListener(),this.target=null,this.container&&this.autoZIndex&&Xp.clear(this.container),this.overlayEventListener&&(Pd.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null),this.container=null},mounted:function(){this.breakpoints&&this.createStyle()},methods:{toggle:function(n,u){this.visible?this.hide():this.show(n,u)},show:function(n,u){this.visible=!0,this.eventTarget=n.currentTarget,this.target=u||n.currentTarget},hide:function(){this.visible=!1},onContentClick:function(){this.selfClick=!0},onEnter:function(n){var u=this;VC(n,{position:"absolute",top:"0",left:"0"}),this.alignOverlay(),this.dismissable&&this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.autoZIndex&&Xp.set("overlay",n,this.baseZIndex+this.$primevue.config.zIndex.overlay),this.overlayEventListener=function(f){u.container.contains(f.target)&&(u.selfClick=!0)},this.focus(),Pd.on("overlay-click",this.overlayEventListener),this.$emit("show"),this.closeOnEscape&&this.bindDocumentKeyDownListener()},onLeave:function(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.unbindDocumentKeyDownListener(),Pd.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null,this.$emit("hide")},onAfterLeave:function(n){this.autoZIndex&&Xp.clear(n)},alignOverlay:function(){NC(this.container,this.target,!1);var n=_m(this.container),u=_m(this.target),f=0;n.left<u.left&&(f=u.left-n.left),this.container.style.setProperty(aS("popover.arrow.left").name,"".concat(f,"px")),n.top<u.top&&(this.container.setAttribute("data-p-popover-flipped","true"),!this.isUnstyled&&rb(this.container,"p-popover-flipped"))},onContentKeydown:function(n){n.code==="Escape"&&this.closeOnEscape&&(this.hide(),Tu(this.target))},onButtonKeydown:function(n){switch(n.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":n.preventDefault()}},focus:function(){var n=this.container.querySelector("[autofocus]");n&&n.focus()},onKeyDown:function(n){n.code==="Escape"&&this.closeOnEscape&&(this.visible=!1)},bindDocumentKeyDownListener:function(){this.documentKeydownListener||(this.documentKeydownListener=this.onKeyDown.bind(this),window.document.addEventListener("keydown",this.documentKeydownListener))},unbindDocumentKeyDownListener:function(){this.documentKeydownListener&&(window.document.removeEventListener("keydown",this.documentKeydownListener),this.documentKeydownListener=null)},bindOutsideClickListener:function(){var n=this;!this.outsideClickListener&&Km()&&(this.outsideClickListener=function(u){n.visible&&!n.selfClick&&!n.isTargetClicked(u)&&(n.visible=!1),n.selfClick=!1},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener:function(){var n=this;this.scrollHandler||(this.scrollHandler=new jD(this.target,function(){n.visible&&(n.visible=!1)})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var n=this;this.resizeListener||(this.resizeListener=function(){n.visible&&!YC()&&(n.visible=!1)},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isTargetClicked:function(n){return this.eventTarget&&(this.eventTarget===n.target||this.eventTarget.contains(n.target))},containerRef:function(n){this.container=n},createStyle:function(){if(!this.styleElement&&!this.isUnstyled){var n;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",lb(this.styleElement,"nonce",(n=this.$primevue)===null||n===void 0||(n=n.config)===null||n===void 0||(n=n.csp)===null||n===void 0?void 0:n.nonce),document.head.appendChild(this.styleElement);var u="";for(var f in this.breakpoints)u+=`
                        @media screen and (max-width: `.concat(f,`) {
                            .p-popover[`).concat(this.$attrSelector,`] {
                                width: `).concat(this.breakpoints[f],` !important;
                            }
                        }
                    `);this.styleElement.innerHTML=u}},destroyStyle:function(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)},onOverlayClick:function(n){Pd.emit("overlay-click",{originalEvent:n,target:this.target})}},directives:{focustrap:JD,ripple:hL},components:{Portal:Tb}},CL=["aria-modal"];function SL(r,n,u,f,y,C){var b=Hw("Portal"),a=Yw("focustrap");return sr(),Bs(b,{appendTo:r.appendTo},{default:jd(function(){return[Vr(q2,Ds({name:"p-popover",onEnter:C.onEnter,onLeave:C.onLeave,onAfterLeave:C.onAfterLeave},r.ptm("transition")),{default:jd(function(){return[y.visible?Ew((sr(),Ar("div",Ds({key:0,ref:C.containerRef,role:"dialog","aria-modal":y.visible,onClick:n[3]||(n[3]=function(){return C.onOverlayClick&&C.onOverlayClick.apply(C,arguments)}),class:r.cx("root")},r.ptmi("root")),[r.$slots.container?Vd(r.$slots,"container",{key:0,closeCallback:C.hide,keydownCallback:function(R){return C.onButtonKeydown(R)}}):(sr(),Ar("div",Ds({key:1,class:r.cx("content"),onClick:n[0]||(n[0]=function(){return C.onContentClick&&C.onContentClick.apply(C,arguments)}),onMousedown:n[1]||(n[1]=function(){return C.onContentClick&&C.onContentClick.apply(C,arguments)}),onKeydown:n[2]||(n[2]=function(){return C.onContentKeydown&&C.onContentKeydown.apply(C,arguments)})},r.ptm("content")),[Vd(r.$slots,"default")],16))],16,CL)),[[a]]):Zo("",!0)]}),_:3},16,["onEnter","onLeave","onAfterLeave"])]}),_:3},8,["appendTo"])}Ib.render=SL;const js=(r,n)=>{const u=r.__vccOpts||r;for(const[f,y]of n)u[f]=y;return u},TL={class:"layer-icon"},kL=["xlink:href"],PL={class:"layer-title"},ML={__name:"LayerItem",props:{id:{type:String,required:!0},homeMapLayerType:{type:String,required:!0},position:{type:Number,required:!0},title:{type:String,required:!0},icon:{type:String,required:!1},enabled:{type:Boolean,required:!1,default:!1},visible:{type:Boolean,required:!1,default:!1},multiTemporal:{type:Boolean,required:!1,default:!1}},emits:["update:toggleLayer"],setup(r,{emit:n}){const u=r,f=n,y=_o(u.visible),C=_o(u.enabled);jo(()=>u.visible,a=>{y.value=a}),jo(()=>u.enabled,a=>{C.value=a});const b=()=>{y.value=!y.value,f("update:toggleLayer",{layerId:u.id,visible:y.value})};return(a,I)=>C.value?(sr(),Ar("div",{key:0,class:af(["layer-control",{active:r.visible}]),onClick:b},[Wt("div",TL,[(sr(),Ar("svg",null,[Wt("use",{"xlink:href":r.icon?`#${r.icon}`:"#icon-layers"},null,8,kL)]))]),Wt("div",PL,ni(r.title),1)],2)):Zo("",!0)}},l0=js(ML,[["__scopeId","data-v-2724ce8e"]]),IL={key:0,class:"time-picker"},EL=["disabled"],AL={class:"date-display"},zL=["disabled"],RL={__name:"DateNavigator",setup(r){const n=Jm(),u=cr(()=>{const N=n.activeTimeLayer;return N?n.timeLayerDates[N]||[]:[]}),f=cr(()=>{const N=n.activeTimeLayer,q=N&&n.getLayerById(N);return q&&q.dateFormat?q.dateFormat:{currentTime:"yyyy-MM-dd HH:mm"}}),y=cr(()=>{const N=n.activeTimeLayer;return N&&n.selectedTimeLayerDateIndex[N]||0}),C=cr(()=>u.value[y.value]),b=cr(()=>{if(C.value&&f.value){const{currentTime:N,asPeriod:q}=f.value;return DD(new Date(C.value),N,q)}return""}),a=cr(()=>y.value>=u.value.length-1),I=cr(()=>y.value<=0),R=()=>{if(!a.value){const N=y.value+1;n.setSelectedTimeLayerDateIndex(n.activeTimeLayer,N)}},$=()=>{if(!I.value){const N=y.value-1;n.setSelectedTimeLayerDateIndex(n.activeTimeLayer,N)}};return(N,q)=>u.value.length?(sr(),Ar("div",IL,[Wt("button",{onClick:$,disabled:I.value,class:"nav-button"},"◄",8,EL),Wt("span",AL,ni(b.value),1),Wt("button",{onClick:R,disabled:a.value,class:"nav-button"},"►",8,zL)])):Zo("",!0)}},DL=js(RL,[["__scopeId","data-v-7f2452fc"]]),LL={key:0,class:"m-legend-item"},BL={class:"legend-title"},$L={class:"item-wrapper"},OL={class:"item-label"},FL={__name:"LegendItemTypeBasic",props:{legendConfig:{type:Object,required:!1},title:{type:String,required:!1}},setup(r){const n=r,u=cr(()=>n.legendConfig&&n.legendConfig.type==="basic"&&n.legendConfig.items&&n.legendConfig.items.length>0);return(f,y)=>u.value?(sr(),Ar("div",LL,[Wt("div",BL,ni(n.title),1),Wt("ul",null,[(sr(!0),Ar(an,null,Wl(n.legendConfig.items,C=>(sr(),Ar("li",$L,[Wt("div",{class:"item-color",style:Ls({backgroundColor:C.color})},null,4),Wt("div",OL,ni(C.name),1)]))),256))])])):Zo("",!0)}},jL=js(FL,[["__scopeId","data-v-e6813172"]]);var wm="http://www.w3.org/1999/xhtml";const c0={svg:"http://www.w3.org/2000/svg",xhtml:wm,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Eb(r){var n=r+="",u=n.indexOf(":");return u>=0&&(n=r.slice(0,u))!=="xmlns"&&(r=r.slice(u+1)),c0.hasOwnProperty(n)?{space:c0[n],local:r}:r}function NL(r){return function(){var n=this.ownerDocument,u=this.namespaceURI;return u===wm&&n.documentElement.namespaceURI===wm?n.createElement(r):n.createElementNS(u,r)}}function VL(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function eg(r){var n=Eb(r);return(n.local?VL:NL)(n)}function UL(){}function Ab(r){return r==null?UL:function(){return this.querySelector(r)}}function ZL(r){typeof r!="function"&&(r=Ab(r));for(var n=this._groups,u=n.length,f=new Array(u),y=0;y<u;++y)for(var C=n[y],b=C.length,a=f[y]=new Array(b),I,R,$=0;$<b;++$)(I=C[$])&&(R=r.call(I,I.__data__,$,C))&&("__data__"in I&&(R.__data__=I.__data__),a[$]=R);return new Go(f,this._parents)}function GL(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function qL(){return[]}function WL(r){return r==null?qL:function(){return this.querySelectorAll(r)}}function HL(r){return function(){return GL(r.apply(this,arguments))}}function XL(r){typeof r=="function"?r=HL(r):r=WL(r);for(var n=this._groups,u=n.length,f=[],y=[],C=0;C<u;++C)for(var b=n[C],a=b.length,I,R=0;R<a;++R)(I=b[R])&&(f.push(r.call(I,I.__data__,R,b)),y.push(I));return new Go(f,y)}function YL(r){return function(){return this.matches(r)}}function zb(r){return function(n){return n.matches(r)}}var KL=Array.prototype.find;function JL(r){return function(){return KL.call(this.children,r)}}function QL(){return this.firstElementChild}function eB(r){return this.select(r==null?QL:JL(typeof r=="function"?r:zb(r)))}var tB=Array.prototype.filter;function rB(){return Array.from(this.children)}function nB(r){return function(){return tB.call(this.children,r)}}function oB(r){return this.selectAll(r==null?rB:nB(typeof r=="function"?r:zb(r)))}function iB(r){typeof r!="function"&&(r=YL(r));for(var n=this._groups,u=n.length,f=new Array(u),y=0;y<u;++y)for(var C=n[y],b=C.length,a=f[y]=[],I,R=0;R<b;++R)(I=C[R])&&r.call(I,I.__data__,R,C)&&a.push(I);return new Go(f,this._parents)}function Rb(r){return new Array(r.length)}function sB(){return new Go(this._enter||this._groups.map(Rb),this._parents)}function Hd(r,n){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=n}Hd.prototype={constructor:Hd,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,n){return this._parent.insertBefore(r,n)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function aB(r){return function(){return r}}function lB(r,n,u,f,y,C){for(var b=0,a,I=n.length,R=C.length;b<R;++b)(a=n[b])?(a.__data__=C[b],f[b]=a):u[b]=new Hd(r,C[b]);for(;b<I;++b)(a=n[b])&&(y[b]=a)}function cB(r,n,u,f,y,C,b){var a,I,R=new Map,$=n.length,N=C.length,q=new Array($),V;for(a=0;a<$;++a)(I=n[a])&&(q[a]=V=b.call(I,I.__data__,a,n)+"",R.has(V)?y[a]=I:R.set(V,I));for(a=0;a<N;++a)V=b.call(r,C[a],a,C)+"",(I=R.get(V))?(f[a]=I,I.__data__=C[a],R.delete(V)):u[a]=new Hd(r,C[a]);for(a=0;a<$;++a)(I=n[a])&&R.get(q[a])===I&&(y[a]=I)}function uB(r){return r.__data__}function hB(r,n){if(!arguments.length)return Array.from(this,uB);var u=n?cB:lB,f=this._parents,y=this._groups;typeof r!="function"&&(r=aB(r));for(var C=y.length,b=new Array(C),a=new Array(C),I=new Array(C),R=0;R<C;++R){var $=f[R],N=y[R],q=N.length,V=dB(r.call($,$&&$.__data__,R,f)),ie=V.length,Pe=a[R]=new Array(ie),Ne=b[R]=new Array(ie),xe=I[R]=new Array(q);u($,N,Pe,Ne,xe,V,n);for(var Ge=0,qe=0,be,Oe;Ge<ie;++Ge)if(be=Pe[Ge]){for(Ge>=qe&&(qe=Ge+1);!(Oe=Ne[qe])&&++qe<ie;);be._next=Oe||null}}return b=new Go(b,f),b._enter=a,b._exit=I,b}function dB(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function fB(){return new Go(this._exit||this._groups.map(Rb),this._parents)}function pB(r,n,u){var f=this.enter(),y=this,C=this.exit();return typeof r=="function"?(f=r(f),f&&(f=f.selection())):f=f.append(r+""),n!=null&&(y=n(y),y&&(y=y.selection())),u==null?C.remove():u(C),f&&y?f.merge(y).order():y}function mB(r){for(var n=r.selection?r.selection():r,u=this._groups,f=n._groups,y=u.length,C=f.length,b=Math.min(y,C),a=new Array(y),I=0;I<b;++I)for(var R=u[I],$=f[I],N=R.length,q=a[I]=new Array(N),V,ie=0;ie<N;++ie)(V=R[ie]||$[ie])&&(q[ie]=V);for(;I<y;++I)a[I]=u[I];return new Go(a,this._parents)}function gB(){for(var r=this._groups,n=-1,u=r.length;++n<u;)for(var f=r[n],y=f.length-1,C=f[y],b;--y>=0;)(b=f[y])&&(C&&b.compareDocumentPosition(C)^4&&C.parentNode.insertBefore(b,C),C=b);return this}function _B(r){r||(r=yB);function n(N,q){return N&&q?r(N.__data__,q.__data__):!N-!q}for(var u=this._groups,f=u.length,y=new Array(f),C=0;C<f;++C){for(var b=u[C],a=b.length,I=y[C]=new Array(a),R,$=0;$<a;++$)(R=b[$])&&(I[$]=R);I.sort(n)}return new Go(y,this._parents).order()}function yB(r,n){return r<n?-1:r>n?1:r>=n?0:NaN}function vB(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function bB(){return Array.from(this)}function xB(){for(var r=this._groups,n=0,u=r.length;n<u;++n)for(var f=r[n],y=0,C=f.length;y<C;++y){var b=f[y];if(b)return b}return null}function wB(){let r=0;for(const n of this)++r;return r}function CB(){return!this.node()}function SB(r){for(var n=this._groups,u=0,f=n.length;u<f;++u)for(var y=n[u],C=0,b=y.length,a;C<b;++C)(a=y[C])&&r.call(a,a.__data__,C,y);return this}function TB(r){return function(){this.removeAttribute(r)}}function kB(r){return function(){this.removeAttributeNS(r.space,r.local)}}function PB(r,n){return function(){this.setAttribute(r,n)}}function MB(r,n){return function(){this.setAttributeNS(r.space,r.local,n)}}function IB(r,n){return function(){var u=n.apply(this,arguments);u==null?this.removeAttribute(r):this.setAttribute(r,u)}}function EB(r,n){return function(){var u=n.apply(this,arguments);u==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,u)}}function AB(r,n){var u=Eb(r);if(arguments.length<2){var f=this.node();return u.local?f.getAttributeNS(u.space,u.local):f.getAttribute(u)}return this.each((n==null?u.local?kB:TB:typeof n=="function"?u.local?EB:IB:u.local?MB:PB)(u,n))}function Db(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function zB(r){return function(){this.style.removeProperty(r)}}function RB(r,n,u){return function(){this.style.setProperty(r,n,u)}}function DB(r,n,u){return function(){var f=n.apply(this,arguments);f==null?this.style.removeProperty(r):this.style.setProperty(r,f,u)}}function LB(r,n,u){return arguments.length>1?this.each((n==null?zB:typeof n=="function"?DB:RB)(r,n,u??"")):BB(this.node(),r)}function BB(r,n){return r.style.getPropertyValue(n)||Db(r).getComputedStyle(r,null).getPropertyValue(n)}function $B(r){return function(){delete this[r]}}function OB(r,n){return function(){this[r]=n}}function FB(r,n){return function(){var u=n.apply(this,arguments);u==null?delete this[r]:this[r]=u}}function jB(r,n){return arguments.length>1?this.each((n==null?$B:typeof n=="function"?FB:OB)(r,n)):this.node()[r]}function Lb(r){return r.trim().split(/^|\s+/)}function tg(r){return r.classList||new Bb(r)}function Bb(r){this._node=r,this._names=Lb(r.getAttribute("class")||"")}Bb.prototype={add:function(r){var n=this._names.indexOf(r);n<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var n=this._names.indexOf(r);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function $b(r,n){for(var u=tg(r),f=-1,y=n.length;++f<y;)u.add(n[f])}function Ob(r,n){for(var u=tg(r),f=-1,y=n.length;++f<y;)u.remove(n[f])}function NB(r){return function(){$b(this,r)}}function VB(r){return function(){Ob(this,r)}}function UB(r,n){return function(){(n.apply(this,arguments)?$b:Ob)(this,r)}}function ZB(r,n){var u=Lb(r+"");if(arguments.length<2){for(var f=tg(this.node()),y=-1,C=u.length;++y<C;)if(!f.contains(u[y]))return!1;return!0}return this.each((typeof n=="function"?UB:n?NB:VB)(u,n))}function GB(){this.textContent=""}function qB(r){return function(){this.textContent=r}}function WB(r){return function(){var n=r.apply(this,arguments);this.textContent=n??""}}function HB(r){return arguments.length?this.each(r==null?GB:(typeof r=="function"?WB:qB)(r)):this.node().textContent}function XB(){this.innerHTML=""}function YB(r){return function(){this.innerHTML=r}}function KB(r){return function(){var n=r.apply(this,arguments);this.innerHTML=n??""}}function JB(r){return arguments.length?this.each(r==null?XB:(typeof r=="function"?KB:YB)(r)):this.node().innerHTML}function QB(){this.nextSibling&&this.parentNode.appendChild(this)}function e$(){return this.each(QB)}function t$(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function r$(){return this.each(t$)}function n$(r){var n=typeof r=="function"?r:eg(r);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function o$(){return null}function i$(r,n){var u=typeof r=="function"?r:eg(r),f=n==null?o$:typeof n=="function"?n:Ab(n);return this.select(function(){return this.insertBefore(u.apply(this,arguments),f.apply(this,arguments)||null)})}function s$(){var r=this.parentNode;r&&r.removeChild(this)}function a$(){return this.each(s$)}function l$(){var r=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(r,this.nextSibling):r}function c$(){var r=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(r,this.nextSibling):r}function u$(r){return this.select(r?c$:l$)}function h$(r){return arguments.length?this.property("__data__",r):this.node().__data__}function d$(r){return function(n){r.call(this,n,this.__data__)}}function f$(r){return r.trim().split(/^|\s+/).map(function(n){var u="",f=n.indexOf(".");return f>=0&&(u=n.slice(f+1),n=n.slice(0,f)),{type:n,name:u}})}function p$(r){return function(){var n=this.__on;if(n){for(var u=0,f=-1,y=n.length,C;u<y;++u)C=n[u],(!r.type||C.type===r.type)&&C.name===r.name?this.removeEventListener(C.type,C.listener,C.options):n[++f]=C;++f?n.length=f:delete this.__on}}}function m$(r,n,u){return function(){var f=this.__on,y,C=d$(n);if(f){for(var b=0,a=f.length;b<a;++b)if((y=f[b]).type===r.type&&y.name===r.name){this.removeEventListener(y.type,y.listener,y.options),this.addEventListener(y.type,y.listener=C,y.options=u),y.value=n;return}}this.addEventListener(r.type,C,u),y={type:r.type,name:r.name,value:n,listener:C,options:u},f?f.push(y):this.__on=[y]}}function g$(r,n,u){var f=f$(r+""),y,C=f.length,b;if(arguments.length<2){var a=this.node().__on;if(a){for(var I=0,R=a.length,$;I<R;++I)for(y=0,$=a[I];y<C;++y)if((b=f[y]).type===$.type&&b.name===$.name)return $.value}return}for(a=n?m$:p$,y=0;y<C;++y)this.each(a(f[y],n,u));return this}function Fb(r,n,u){var f=Db(r),y=f.CustomEvent;typeof y=="function"?y=new y(n,u):(y=f.document.createEvent("Event"),u?(y.initEvent(n,u.bubbles,u.cancelable),y.detail=u.detail):y.initEvent(n,!1,!1)),r.dispatchEvent(y)}function _$(r,n){return function(){return Fb(this,r,n)}}function y$(r,n){return function(){return Fb(this,r,n.apply(this,arguments))}}function v$(r,n){return this.each((typeof n=="function"?y$:_$)(r,n))}function*b$(){for(var r=this._groups,n=0,u=r.length;n<u;++n)for(var f=r[n],y=0,C=f.length,b;y<C;++y)(b=f[y])&&(yield b)}var x$=[null];function Go(r,n){this._groups=r,this._parents=n}function w$(){return this}Go.prototype={constructor:Go,select:ZL,selectAll:XL,selectChild:eB,selectChildren:oB,filter:iB,data:hB,enter:sB,exit:fB,join:pB,merge:mB,selection:w$,order:gB,sort:_B,call:vB,nodes:bB,node:xB,size:wB,empty:CB,each:SB,attr:AB,style:LB,property:jB,classed:ZB,text:HB,html:JB,raise:e$,lower:r$,append:n$,insert:i$,remove:a$,clone:u$,datum:h$,on:g$,dispatch:v$,[Symbol.iterator]:b$};function C$(r){return typeof r=="string"?new Go([[document.querySelector(r)]],[document.documentElement]):new Go([[r]],x$)}function S$(r){return C$(eg(r).call(document.documentElement))}function Gl(r,n){return r==null||n==null?NaN:r<n?-1:r>n?1:r>=n?0:NaN}function T$(r,n){return r==null||n==null?NaN:n<r?-1:n>r?1:n>=r?0:NaN}function jb(r){let n,u,f;r.length!==2?(n=Gl,u=(a,I)=>Gl(r(a),I),f=(a,I)=>r(a)-I):(n=r===Gl||r===T$?r:k$,u=r,f=r);function y(a,I,R=0,$=a.length){if(R<$){if(n(I,I)!==0)return $;do{const N=R+$>>>1;u(a[N],I)<0?R=N+1:$=N}while(R<$)}return R}function C(a,I,R=0,$=a.length){if(R<$){if(n(I,I)!==0)return $;do{const N=R+$>>>1;u(a[N],I)<=0?R=N+1:$=N}while(R<$)}return R}function b(a,I,R=0,$=a.length){const N=y(a,I,R,$-1);return N>R&&f(a[N-1],I)>-f(a[N],I)?N-1:N}return{left:y,center:b,right:C}}function k$(){return 0}function P$(r){return r===null?NaN:+r}function*M$(r,n){for(let u of r)u!=null&&(u=+u)>=u&&(yield u)}const I$=jb(Gl),Nb=I$.right;jb(P$).center;class u0 extends Map{constructor(n,u=z$){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:u}}),n!=null)for(const[f,y]of n)this.set(f,y)}get(n){return super.get(h0(this,n))}has(n){return super.has(h0(this,n))}set(n,u){return super.set(E$(this,n),u)}delete(n){return super.delete(A$(this,n))}}function h0({_intern:r,_key:n},u){const f=n(u);return r.has(f)?r.get(f):u}function E$({_intern:r,_key:n},u){const f=n(u);return r.has(f)?r.get(f):(r.set(f,u),u)}function A$({_intern:r,_key:n},u){const f=n(u);return r.has(f)&&(u=r.get(f),r.delete(f)),u}function z$(r){return r!==null&&typeof r=="object"?r.valueOf():r}function R$(r=Gl){if(r===Gl)return Vb;if(typeof r!="function")throw new TypeError("compare is not a function");return(n,u)=>{const f=r(n,u);return f||f===0?f:(r(u,u)===0)-(r(n,n)===0)}}function Vb(r,n){return(r==null||!(r>=r))-(n==null||!(n>=n))||(r<n?-1:r>n?1:0)}const D$=Math.sqrt(50),L$=Math.sqrt(10),B$=Math.sqrt(2);function Xd(r,n,u){const f=(n-r)/Math.max(0,u),y=Math.floor(Math.log10(f)),C=f/Math.pow(10,y),b=C>=D$?10:C>=L$?5:C>=B$?2:1;let a,I,R;return y<0?(R=Math.pow(10,-y)/b,a=Math.round(r*R),I=Math.round(n*R),a/R<r&&++a,I/R>n&&--I,R=-R):(R=Math.pow(10,y)*b,a=Math.round(r/R),I=Math.round(n/R),a*R<r&&++a,I*R>n&&--I),I<a&&.5<=u&&u<2?Xd(r,n,u*2):[a,I,R]}function $$(r,n,u){if(n=+n,r=+r,u=+u,!(u>0))return[];if(r===n)return[r];const f=n<r,[y,C,b]=f?Xd(n,r,u):Xd(r,n,u);if(!(C>=y))return[];const a=C-y+1,I=new Array(a);if(f)if(b<0)for(let R=0;R<a;++R)I[R]=(C-R)/-b;else for(let R=0;R<a;++R)I[R]=(C-R)*b;else if(b<0)for(let R=0;R<a;++R)I[R]=(y+R)/-b;else for(let R=0;R<a;++R)I[R]=(y+R)*b;return I}function Cm(r,n,u){return n=+n,r=+r,u=+u,Xd(r,n,u)[2]}function O$(r,n,u){n=+n,r=+r,u=+u;const f=n<r,y=f?Cm(n,r,u):Cm(r,n,u);return(f?-1:1)*(y<0?1/-y:y)}function d0(r,n){let u;for(const f of r)f!=null&&(u<f||u===void 0&&f>=f)&&(u=f);return u}function f0(r,n){let u;for(const f of r)f!=null&&(u>f||u===void 0&&f>=f)&&(u=f);return u}function Ub(r,n,u=0,f=1/0,y){if(n=Math.floor(n),u=Math.floor(Math.max(0,u)),f=Math.floor(Math.min(r.length-1,f)),!(u<=n&&n<=f))return r;for(y=y===void 0?Vb:R$(y);f>u;){if(f-u>600){const I=f-u+1,R=n-u+1,$=Math.log(I),N=.5*Math.exp(2*$/3),q=.5*Math.sqrt($*N*(I-N)/I)*(R-I/2<0?-1:1),V=Math.max(u,Math.floor(n-R*N/I+q)),ie=Math.min(f,Math.floor(n+(I-R)*N/I+q));Ub(r,n,V,ie,y)}const C=r[n];let b=u,a=f;for(Cu(r,u,n),y(r[f],C)>0&&Cu(r,u,f);b<a;){for(Cu(r,b,a),++b,--a;y(r[b],C)<0;)++b;for(;y(r[a],C)>0;)--a}y(r[u],C)===0?Cu(r,u,a):(++a,Cu(r,a,f)),a<=n&&(u=a+1),n<=a&&(f=a-1)}return r}function Cu(r,n,u){const f=r[n];r[n]=r[u],r[u]=f}function F$(r,n,u){if(r=Float64Array.from(M$(r)),!(!(f=r.length)||isNaN(n=+n))){if(n<=0||f<2)return f0(r);if(n>=1)return d0(r);var f,y=(f-1)*n,C=Math.floor(y),b=d0(Ub(r,C).subarray(0,C+1)),a=f0(r.subarray(C+1));return b+(a-b)*(y-C)}}function Sm(r,n,u){r=+r,n=+n,u=(y=arguments.length)<2?(n=r,r=0,1):y<3?1:+u;for(var f=-1,y=Math.max(0,Math.ceil((n-r)/u))|0,C=new Array(y);++f<y;)C[f]=r+f*u;return C}function rg(r,n,u){r.prototype=n.prototype=u,u.constructor=r}function Zb(r,n){var u=Object.create(r.prototype);for(var f in n)u[f]=n[f];return u}function sh(){}var eh=.7,Yd=1/eh,ql="\\s*([+-]?\\d+)\\s*",th="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",bi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",j$=/^#([0-9a-f]{3,8})$/,N$=new RegExp(`^rgb\\(${ql},${ql},${ql}\\)$`),V$=new RegExp(`^rgb\\(${bi},${bi},${bi}\\)$`),U$=new RegExp(`^rgba\\(${ql},${ql},${ql},${th}\\)$`),Z$=new RegExp(`^rgba\\(${bi},${bi},${bi},${th}\\)$`),G$=new RegExp(`^hsl\\(${th},${bi},${bi}\\)$`),q$=new RegExp(`^hsla\\(${th},${bi},${bi},${th}\\)$`),p0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};rg(sh,rh,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:m0,formatHex:m0,formatHex8:W$,formatHsl:H$,formatRgb:g0,toString:g0});function m0(){return this.rgb().formatHex()}function W$(){return this.rgb().formatHex8()}function H$(){return Gb(this).formatHsl()}function g0(){return this.rgb().formatRgb()}function rh(r){var n,u;return r=(r+"").trim().toLowerCase(),(n=j$.exec(r))?(u=n[1].length,n=parseInt(n[1],16),u===6?_0(n):u===3?new yo(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):u===8?Md(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):u===4?Md(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=N$.exec(r))?new yo(n[1],n[2],n[3],1):(n=V$.exec(r))?new yo(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=U$.exec(r))?Md(n[1],n[2],n[3],n[4]):(n=Z$.exec(r))?Md(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=G$.exec(r))?b0(n[1],n[2]/100,n[3]/100,1):(n=q$.exec(r))?b0(n[1],n[2]/100,n[3]/100,n[4]):p0.hasOwnProperty(r)?_0(p0[r]):r==="transparent"?new yo(NaN,NaN,NaN,0):null}function _0(r){return new yo(r>>16&255,r>>8&255,r&255,1)}function Md(r,n,u,f){return f<=0&&(r=n=u=NaN),new yo(r,n,u,f)}function X$(r){return r instanceof sh||(r=rh(r)),r?(r=r.rgb(),new yo(r.r,r.g,r.b,r.opacity)):new yo}function Tm(r,n,u,f){return arguments.length===1?X$(r):new yo(r,n,u,f??1)}function yo(r,n,u,f){this.r=+r,this.g=+n,this.b=+u,this.opacity=+f}rg(yo,Tm,Zb(sh,{brighter(r){return r=r==null?Yd:Math.pow(Yd,r),new yo(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?eh:Math.pow(eh,r),new yo(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new yo(Ca(this.r),Ca(this.g),Ca(this.b),Kd(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:y0,formatHex:y0,formatHex8:Y$,formatRgb:v0,toString:v0}));function y0(){return`#${ba(this.r)}${ba(this.g)}${ba(this.b)}`}function Y$(){return`#${ba(this.r)}${ba(this.g)}${ba(this.b)}${ba((isNaN(this.opacity)?1:this.opacity)*255)}`}function v0(){const r=Kd(this.opacity);return`${r===1?"rgb(":"rgba("}${Ca(this.r)}, ${Ca(this.g)}, ${Ca(this.b)}${r===1?")":`, ${r})`}`}function Kd(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function Ca(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function ba(r){return r=Ca(r),(r<16?"0":"")+r.toString(16)}function b0(r,n,u,f){return f<=0?r=n=u=NaN:u<=0||u>=1?r=n=NaN:n<=0&&(r=NaN),new ti(r,n,u,f)}function Gb(r){if(r instanceof ti)return new ti(r.h,r.s,r.l,r.opacity);if(r instanceof sh||(r=rh(r)),!r)return new ti;if(r instanceof ti)return r;r=r.rgb();var n=r.r/255,u=r.g/255,f=r.b/255,y=Math.min(n,u,f),C=Math.max(n,u,f),b=NaN,a=C-y,I=(C+y)/2;return a?(n===C?b=(u-f)/a+(u<f)*6:u===C?b=(f-n)/a+2:b=(n-u)/a+4,a/=I<.5?C+y:2-C-y,b*=60):a=I>0&&I<1?0:b,new ti(b,a,I,r.opacity)}function K$(r,n,u,f){return arguments.length===1?Gb(r):new ti(r,n,u,f??1)}function ti(r,n,u,f){this.h=+r,this.s=+n,this.l=+u,this.opacity=+f}rg(ti,K$,Zb(sh,{brighter(r){return r=r==null?Yd:Math.pow(Yd,r),new ti(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?eh:Math.pow(eh,r),new ti(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,n=isNaN(r)||isNaN(this.s)?0:this.s,u=this.l,f=u+(u<.5?u:1-u)*n,y=2*u-f;return new yo(em(r>=240?r-240:r+120,y,f),em(r,y,f),em(r<120?r+240:r-120,y,f),this.opacity)},clamp(){return new ti(x0(this.h),Id(this.s),Id(this.l),Kd(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=Kd(this.opacity);return`${r===1?"hsl(":"hsla("}${x0(this.h)}, ${Id(this.s)*100}%, ${Id(this.l)*100}%${r===1?")":`, ${r})`}`}}));function x0(r){return r=(r||0)%360,r<0?r+360:r}function Id(r){return Math.max(0,Math.min(1,r||0))}function em(r,n,u){return(r<60?n+(u-n)*r/60:r<180?u:r<240?n+(u-n)*(240-r)/60:n)*255}const ng=r=>()=>r;function J$(r,n){return function(u){return r+u*n}}function Q$(r,n,u){return r=Math.pow(r,u),n=Math.pow(n,u)-r,u=1/u,function(f){return Math.pow(r+f*n,u)}}function e3(r){return(r=+r)==1?qb:function(n,u){return u-n?Q$(n,u,r):ng(isNaN(n)?u:n)}}function qb(r,n){var u=n-r;return u?J$(r,u):ng(isNaN(r)?n:r)}const w0=function r(n){var u=e3(n);function f(y,C){var b=u((y=Tm(y)).r,(C=Tm(C)).r),a=u(y.g,C.g),I=u(y.b,C.b),R=qb(y.opacity,C.opacity);return function($){return y.r=b($),y.g=a($),y.b=I($),y.opacity=R($),y+""}}return f.gamma=r,f}(1);function t3(r,n){n||(n=[]);var u=r?Math.min(n.length,r.length):0,f=n.slice(),y;return function(C){for(y=0;y<u;++y)f[y]=r[y]*(1-C)+n[y]*C;return f}}function r3(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function n3(r,n){var u=n?n.length:0,f=r?Math.min(u,r.length):0,y=new Array(f),C=new Array(u),b;for(b=0;b<f;++b)y[b]=nh(r[b],n[b]);for(;b<u;++b)C[b]=n[b];return function(a){for(b=0;b<f;++b)C[b]=y[b](a);return C}}function o3(r,n){var u=new Date;return r=+r,n=+n,function(f){return u.setTime(r*(1-f)+n*f),u}}function Jd(r,n){return r=+r,n=+n,function(u){return r*(1-u)+n*u}}function i3(r,n){var u={},f={},y;(r===null||typeof r!="object")&&(r={}),(n===null||typeof n!="object")&&(n={});for(y in n)y in r?u[y]=nh(r[y],n[y]):f[y]=n[y];return function(C){for(y in u)f[y]=u[y](C);return f}}var km=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,tm=new RegExp(km.source,"g");function s3(r){return function(){return r}}function a3(r){return function(n){return r(n)+""}}function l3(r,n){var u=km.lastIndex=tm.lastIndex=0,f,y,C,b=-1,a=[],I=[];for(r=r+"",n=n+"";(f=km.exec(r))&&(y=tm.exec(n));)(C=y.index)>u&&(C=n.slice(u,C),a[b]?a[b]+=C:a[++b]=C),(f=f[0])===(y=y[0])?a[b]?a[b]+=y:a[++b]=y:(a[++b]=null,I.push({i:b,x:Jd(f,y)})),u=tm.lastIndex;return u<n.length&&(C=n.slice(u),a[b]?a[b]+=C:a[++b]=C),a.length<2?I[0]?a3(I[0].x):s3(n):(n=I.length,function(R){for(var $=0,N;$<n;++$)a[(N=I[$]).i]=N.x(R);return a.join("")})}function nh(r,n){var u=typeof n,f;return n==null||u==="boolean"?ng(n):(u==="number"?Jd:u==="string"?(f=rh(n))?(n=f,w0):l3:n instanceof rh?w0:n instanceof Date?o3:r3(n)?t3:Array.isArray(n)?n3:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?i3:Jd)(r,n)}function Wb(r,n){return r=+r,n=+n,function(u){return Math.round(r*(1-u)+n*u)}}function C0(r,n){for(var u=new Array(n),f=0;f<n;++f)u[f]=r(f/(n-1));return u}function bf(r,n){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(n).domain(r);break}return this}const S0=Symbol("implicit");function Hb(){var r=new u0,n=[],u=[],f=S0;function y(C){let b=r.get(C);if(b===void 0){if(f!==S0)return f;r.set(C,b=n.push(C)-1)}return u[b%u.length]}return y.domain=function(C){if(!arguments.length)return n.slice();n=[],r=new u0;for(const b of C)r.has(b)||r.set(b,n.push(b)-1);return y},y.range=function(C){return arguments.length?(u=Array.from(C),y):u.slice()},y.unknown=function(C){return arguments.length?(f=C,y):f},y.copy=function(){return Hb(n,u).unknown(f)},bf.apply(y,arguments),y}function Xb(){var r=Hb().unknown(void 0),n=r.domain,u=r.range,f=0,y=1,C,b,a=!1,I=0,R=0,$=.5;delete r.unknown;function N(){var q=n().length,V=y<f,ie=V?y:f,Pe=V?f:y;C=(Pe-ie)/Math.max(1,q-I+R*2),a&&(C=Math.floor(C)),ie+=(Pe-ie-C*(q-I))*$,b=C*(1-I),a&&(ie=Math.round(ie),b=Math.round(b));var Ne=Sm(q).map(function(xe){return ie+C*xe});return u(V?Ne.reverse():Ne)}return r.domain=function(q){return arguments.length?(n(q),N()):n()},r.range=function(q){return arguments.length?([f,y]=q,f=+f,y=+y,N()):[f,y]},r.rangeRound=function(q){return[f,y]=q,f=+f,y=+y,a=!0,N()},r.bandwidth=function(){return b},r.step=function(){return C},r.round=function(q){return arguments.length?(a=!!q,N()):a},r.padding=function(q){return arguments.length?(I=Math.min(1,R=+q),N()):I},r.paddingInner=function(q){return arguments.length?(I=Math.min(1,q),N()):I},r.paddingOuter=function(q){return arguments.length?(R=+q,N()):R},r.align=function(q){return arguments.length?($=Math.max(0,Math.min(1,q)),N()):$},r.copy=function(){return Xb(n(),[f,y]).round(a).paddingInner(I).paddingOuter(R).align($)},bf.apply(N(),arguments)}function c3(r){return function(){return r}}function u3(r){return+r}var T0=[0,1];function jl(r){return r}function Pm(r,n){return(n-=r=+r)?function(u){return(u-r)/n}:c3(isNaN(n)?NaN:.5)}function h3(r,n){var u;return r>n&&(u=r,r=n,n=u),function(f){return Math.max(r,Math.min(n,f))}}function d3(r,n,u){var f=r[0],y=r[1],C=n[0],b=n[1];return y<f?(f=Pm(y,f),C=u(b,C)):(f=Pm(f,y),C=u(C,b)),function(a){return C(f(a))}}function f3(r,n,u){var f=Math.min(r.length,n.length)-1,y=new Array(f),C=new Array(f),b=-1;for(r[f]<r[0]&&(r=r.slice().reverse(),n=n.slice().reverse());++b<f;)y[b]=Pm(r[b],r[b+1]),C[b]=u(n[b],n[b+1]);return function(a){var I=Nb(r,a,1,f)-1;return C[I](y[I](a))}}function p3(r,n){return n.domain(r.domain()).range(r.range()).interpolate(r.interpolate()).clamp(r.clamp()).unknown(r.unknown())}function m3(){var r=T0,n=T0,u=nh,f,y,C,b=jl,a,I,R;function $(){var q=Math.min(r.length,n.length);return b!==jl&&(b=h3(r[0],r[q-1])),a=q>2?f3:d3,I=R=null,N}function N(q){return q==null||isNaN(q=+q)?C:(I||(I=a(r.map(f),n,u)))(f(b(q)))}return N.invert=function(q){return b(y((R||(R=a(n,r.map(f),Jd)))(q)))},N.domain=function(q){return arguments.length?(r=Array.from(q,u3),$()):r.slice()},N.range=function(q){return arguments.length?(n=Array.from(q),$()):n.slice()},N.rangeRound=function(q){return n=Array.from(q),u=Wb,$()},N.clamp=function(q){return arguments.length?(b=q?!0:jl,$()):b!==jl},N.interpolate=function(q){return arguments.length?(u=q,$()):u},N.unknown=function(q){return arguments.length?(C=q,N):C},function(q,V){return f=q,y=V,$()}}function g3(){return m3()(jl,jl)}function _3(r){return Math.abs(r=Math.round(r))>=1e21?r.toLocaleString("en").replace(/,/g,""):r.toString(10)}function Qd(r,n){if((u=(r=n?r.toExponential(n-1):r.toExponential()).indexOf("e"))<0)return null;var u,f=r.slice(0,u);return[f.length>1?f[0]+f.slice(2):f,+r.slice(u+1)]}function Hl(r){return r=Qd(Math.abs(r)),r?r[1]:NaN}function y3(r,n){return function(u,f){for(var y=u.length,C=[],b=0,a=r[0],I=0;y>0&&a>0&&(I+a+1>f&&(a=Math.max(1,f-I)),C.push(u.substring(y-=a,y+a)),!((I+=a+1)>f));)a=r[b=(b+1)%r.length];return C.reverse().join(n)}}function v3(r){return function(n){return n.replace(/[0-9]/g,function(u){return r[+u]})}}var b3=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ef(r){if(!(n=b3.exec(r)))throw new Error("invalid format: "+r);var n;return new og({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}ef.prototype=og.prototype;function og(r){this.fill=r.fill===void 0?" ":r.fill+"",this.align=r.align===void 0?">":r.align+"",this.sign=r.sign===void 0?"-":r.sign+"",this.symbol=r.symbol===void 0?"":r.symbol+"",this.zero=!!r.zero,this.width=r.width===void 0?void 0:+r.width,this.comma=!!r.comma,this.precision=r.precision===void 0?void 0:+r.precision,this.trim=!!r.trim,this.type=r.type===void 0?"":r.type+""}og.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function x3(r){e:for(var n=r.length,u=1,f=-1,y;u<n;++u)switch(r[u]){case".":f=y=u;break;case"0":f===0&&(f=u),y=u;break;default:if(!+r[u])break e;f>0&&(f=0);break}return f>0?r.slice(0,f)+r.slice(y+1):r}var Yb;function w3(r,n){var u=Qd(r,n);if(!u)return r+"";var f=u[0],y=u[1],C=y-(Yb=Math.max(-8,Math.min(8,Math.floor(y/3)))*3)+1,b=f.length;return C===b?f:C>b?f+new Array(C-b+1).join("0"):C>0?f.slice(0,C)+"."+f.slice(C):"0."+new Array(1-C).join("0")+Qd(r,Math.max(0,n+C-1))[0]}function k0(r,n){var u=Qd(r,n);if(!u)return r+"";var f=u[0],y=u[1];return y<0?"0."+new Array(-y).join("0")+f:f.length>y+1?f.slice(0,y+1)+"."+f.slice(y+1):f+new Array(y-f.length+2).join("0")}const P0={"%":(r,n)=>(r*100).toFixed(n),b:r=>Math.round(r).toString(2),c:r=>r+"",d:_3,e:(r,n)=>r.toExponential(n),f:(r,n)=>r.toFixed(n),g:(r,n)=>r.toPrecision(n),o:r=>Math.round(r).toString(8),p:(r,n)=>k0(r*100,n),r:k0,s:w3,X:r=>Math.round(r).toString(16).toUpperCase(),x:r=>Math.round(r).toString(16)};function M0(r){return r}var I0=Array.prototype.map,E0=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function C3(r){var n=r.grouping===void 0||r.thousands===void 0?M0:y3(I0.call(r.grouping,Number),r.thousands+""),u=r.currency===void 0?"":r.currency[0]+"",f=r.currency===void 0?"":r.currency[1]+"",y=r.decimal===void 0?".":r.decimal+"",C=r.numerals===void 0?M0:v3(I0.call(r.numerals,String)),b=r.percent===void 0?"%":r.percent+"",a=r.minus===void 0?"−":r.minus+"",I=r.nan===void 0?"NaN":r.nan+"";function R(N){N=ef(N);var q=N.fill,V=N.align,ie=N.sign,Pe=N.symbol,Ne=N.zero,xe=N.width,Ge=N.comma,qe=N.precision,be=N.trim,Oe=N.type;Oe==="n"?(Ge=!0,Oe="g"):P0[Oe]||(qe===void 0&&(qe=12),be=!0,Oe="g"),(Ne||q==="0"&&V==="=")&&(Ne=!0,q="0",V="=");var ct=Pe==="$"?u:Pe==="#"&&/[boxX]/.test(Oe)?"0"+Oe.toLowerCase():"",ut=Pe==="$"?f:/[%p]/.test(Oe)?b:"",st=P0[Oe],Qe=/[defgprs%]/.test(Oe);qe=qe===void 0?6:/[gprs]/.test(Oe)?Math.max(1,Math.min(21,qe)):Math.max(0,Math.min(20,qe));function gt(ot){var Me=ct,Fe=ut,tt,At,ft;if(Oe==="c")Fe=st(ot)+Fe,ot="";else{ot=+ot;var bt=ot<0||1/ot<0;if(ot=isNaN(ot)?I:st(Math.abs(ot),qe),be&&(ot=x3(ot)),bt&&+ot==0&&ie!=="+"&&(bt=!1),Me=(bt?ie==="("?ie:a:ie==="-"||ie==="("?"":ie)+Me,Fe=(Oe==="s"?E0[8+Yb/3]:"")+Fe+(bt&&ie==="("?")":""),Qe){for(tt=-1,At=ot.length;++tt<At;)if(ft=ot.charCodeAt(tt),48>ft||ft>57){Fe=(ft===46?y+ot.slice(tt+1):ot.slice(tt))+Fe,ot=ot.slice(0,tt);break}}}Ge&&!Ne&&(ot=n(ot,1/0));var Pt=Me.length+ot.length+Fe.length,Ut=Pt<xe?new Array(xe-Pt+1).join(q):"";switch(Ge&&Ne&&(ot=n(Ut+ot,Ut.length?xe-Fe.length:1/0),Ut=""),V){case"<":ot=Me+ot+Fe+Ut;break;case"=":ot=Me+Ut+ot+Fe;break;case"^":ot=Ut.slice(0,Pt=Ut.length>>1)+Me+ot+Fe+Ut.slice(Pt);break;default:ot=Ut+Me+ot+Fe;break}return C(ot)}return gt.toString=function(){return N+""},gt}function $(N,q){var V=R((N=ef(N),N.type="f",N)),ie=Math.max(-8,Math.min(8,Math.floor(Hl(q)/3)))*3,Pe=Math.pow(10,-ie),Ne=E0[8+ie/3];return function(xe){return V(Pe*xe)+Ne}}return{format:R,formatPrefix:$}}var Ed,Kb,Jb;S3({thousands:",",grouping:[3],currency:["$",""]});function S3(r){return Ed=C3(r),Kb=Ed.format,Jb=Ed.formatPrefix,Ed}function T3(r){return Math.max(0,-Hl(Math.abs(r)))}function k3(r,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Hl(n)/3)))*3-Hl(Math.abs(r)))}function P3(r,n){return r=Math.abs(r),n=Math.abs(n)-r,Math.max(0,Hl(n)-Hl(r))+1}function M3(r,n,u,f){var y=O$(r,n,u),C;switch(f=ef(f??",f"),f.type){case"s":{var b=Math.max(Math.abs(r),Math.abs(n));return f.precision==null&&!isNaN(C=k3(y,b))&&(f.precision=C),Jb(f,b)}case"":case"e":case"g":case"p":case"r":{f.precision==null&&!isNaN(C=P3(y,Math.max(Math.abs(r),Math.abs(n))))&&(f.precision=C-(f.type==="e"));break}case"f":case"%":{f.precision==null&&!isNaN(C=T3(y))&&(f.precision=C-(f.type==="%")*2);break}}return Kb(f)}function I3(r){var n=r.domain;return r.ticks=function(u){var f=n();return $$(f[0],f[f.length-1],u??10)},r.tickFormat=function(u,f){var y=n();return M3(y[0],y[y.length-1],u??10,f)},r.nice=function(u){u==null&&(u=10);var f=n(),y=0,C=f.length-1,b=f[y],a=f[C],I,R,$=10;for(a<b&&(R=b,b=a,a=R,R=y,y=C,C=R);$-- >0;){if(R=Cm(b,a,u),R===I)return f[y]=b,f[C]=a,n(f);if(R>0)b=Math.floor(b/R)*R,a=Math.ceil(a/R)*R;else if(R<0)b=Math.ceil(b*R)/R,a=Math.floor(a*R)/R;else break;I=R}return r},r}function Qb(){var r=g3();return r.copy=function(){return p3(r,Qb())},bf.apply(r,arguments),I3(r)}function ex(){var r=[.5],n=[0,1],u,f=1;function y(C){return C!=null&&C<=C?n[Nb(r,C,0,f)]:u}return y.domain=function(C){return arguments.length?(r=Array.from(C),f=Math.min(r.length,n.length-1),y):r.slice()},y.range=function(C){return arguments.length?(n=Array.from(C),f=Math.min(r.length,n.length-1),y):n.slice()},y.invertExtent=function(C){var b=n.indexOf(C);return[r[b-1],r[b]]},y.unknown=function(C){return arguments.length?(u=C,y):u},y.copy=function(){return ex().domain(r).range(n).unknown(u)},bf.apply(y,arguments)}function E3(r){return r}var A3=3,A0=1e-6;function z3(r){return"translate("+r+",0)"}function R3(r){return n=>+r(n)}function D3(r,n){return n=Math.max(0,r.bandwidth()-n*2)/2,r.round()&&(n=Math.round(n)),u=>+r(u)+n}function L3(){return!this.__axis}function B3(r,n){var u=[],f=null,y=null,C=6,b=6,a=3,I=typeof window<"u"&&window.devicePixelRatio>1?0:.5,R=1,$="y",N=z3;function q(V){var ie=f??(n.ticks?n.ticks.apply(n,u):n.domain()),Pe=y??(n.tickFormat?n.tickFormat.apply(n,u):E3),Ne=Math.max(C,0)+a,xe=n.range(),Ge=+xe[0]+I,qe=+xe[xe.length-1]+I,be=(n.bandwidth?D3:R3)(n.copy(),I),Oe=V.selection?V.selection():V,ct=Oe.selectAll(".domain").data([null]),ut=Oe.selectAll(".tick").data(ie,n).order(),st=ut.exit(),Qe=ut.enter().append("g").attr("class","tick"),gt=ut.select("line"),ot=ut.select("text");ct=ct.merge(ct.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),ut=ut.merge(Qe),gt=gt.merge(Qe.append("line").attr("stroke","currentColor").attr($+"2",R*C)),ot=ot.merge(Qe.append("text").attr("fill","currentColor").attr($,R*Ne).attr("dy","0.71em")),V!==Oe&&(ct=ct.transition(V),ut=ut.transition(V),gt=gt.transition(V),ot=ot.transition(V),st=st.transition(V).attr("opacity",A0).attr("transform",function(Me){return isFinite(Me=be(Me))?N(Me+I):this.getAttribute("transform")}),Qe.attr("opacity",A0).attr("transform",function(Me){var Fe=this.parentNode.__axis;return N((Fe&&isFinite(Fe=Fe(Me))?Fe:be(Me))+I)})),st.remove(),ct.attr("d",b?"M"+Ge+","+R*b+"V"+I+"H"+qe+"V"+R*b:"M"+Ge+","+I+"H"+qe),ut.attr("opacity",1).attr("transform",function(Me){return N(be(Me)+I)}),gt.attr($+"2",R*C),ot.attr($,R*Ne).text(Pe),Oe.filter(L3).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),Oe.each(function(){this.__axis=be})}return q.scale=function(V){return arguments.length?(n=V,q):n},q.ticks=function(){return u=Array.from(arguments),q},q.tickArguments=function(V){return arguments.length?(u=V==null?[]:Array.from(V),q):u.slice()},q.tickValues=function(V){return arguments.length?(f=V==null?null:Array.from(V),q):f&&f.slice()},q.tickFormat=function(V){return arguments.length?(y=V,q):y},q.tickSize=function(V){return arguments.length?(C=b=+V,q):C},q.tickSizeInner=function(V){return arguments.length?(C=+V,q):C},q.tickSizeOuter=function(V){return arguments.length?(b=+V,q):b},q.tickPadding=function(V){return arguments.length?(a=+V,q):a},q.offset=function(V){return arguments.length?(I=+V,q):I},q}function $3(r){return B3(A3,r)}function O3(r,{title:n,tickSize:u=6,width:f=240,height:y=44+u,marginTop:C=18,marginRight:b=0,marginBottom:a=16+u,marginLeft:I=0,ticks:R=f/64,tickFormat:$,tickValues:N,strokeColor:q="rgba(0,0,0,.15)"}={}){function V(xe,Ge=256){const qe=document.createElement("canvas");qe.width=Ge,qe.height=1;const be=qe.getContext("2d");for(let Oe=0;Oe<Ge;++Oe)be.fillStyle=xe(Oe/(Ge-1)),be.fillRect(Oe,0,1,1);return qe}const ie=S$("svg").attr("width",f).attr("height",y).attr("viewBox",[0,0,f,y]).style("overflow","visible").style("display","block");let Pe=xe=>xe.selectAll(".tick line").attr("y1",C+a-y),Ne;if(r.interpolate){const xe=Math.min(r.domain().length,r.range().length);Ne=r.copy().rangeRound(C0(nh(I,f-b),xe)),ie.append("image").attr("x",I).attr("y",C).attr("width",f-I-b).attr("height",y-C-a).attr("preserveAspectRatio","none").attr("xlink:href",V(r.copy().domain(C0(nh(0,1),xe))).toDataURL())}else if(r.interpolator){if(Ne=Object.assign(r.copy().interpolator(Wb(I,f-b)),{range(){return[I,f-b]}}),ie.append("image").attr("x",I).attr("y",C).attr("width",f-I-b).attr("height",y-C-a).attr("preserveAspectRatio","none").attr("xlink:href",V(r.interpolator()).toDataURL()),!Ne.ticks){if(N===void 0){const xe=Math.round(R+1);N=Sm(xe).map(Ge=>F$(r.domain(),Ge/(xe-1)))}typeof $!="function"&&($=format($===void 0?",f":$))}}else if(r.invertExtent){const xe=r.thresholds?r.thresholds():r.quantiles?r.quantiles():r.domain(),Ge=$===void 0?qe=>qe:typeof $=="string"?format($):$;Ne=Qb().domain([-1,r.range().length-1]).rangeRound([I,f-b]),ie.append("g").selectAll("rect").data(r.range()).join("rect").attr("x",(qe,be)=>Ne(be-1)).attr("y",C).attr("width",(qe,be)=>Ne(be)-Ne(be-1)).attr("height",y-C-a).attr("fill",qe=>qe).attr("stroke",q),N=Sm(xe.length),$=qe=>Ge(xe[qe],qe)}else Ne=Xb().domain(r.domain()).rangeRound([I,f-b]),ie.append("g").selectAll("rect").data(r.domain()).join("rect").attr("x",Ne).attr("y",C).attr("width",Math.max(0,Ne.bandwidth()-1)).attr("height",y-C-a).attr("fill",r).attr("stroke",q),Pe=()=>{};return ie.append("g").attr("transform",`translate(0,${y-a})`).call($3(Ne).ticks(R,typeof $=="string"?$:void 0).tickFormat(typeof $=="function"?$:void 0).tickSize(u).tickValues(N)).call(Pe).call(xe=>xe.select(".domain").remove()).call(xe=>xe.append("text").attr("x",I).attr("y",C+a-y-6).attr("fill","currentColor").attr("text-anchor","start").attr("font-weight","bold").attr("class","title").text(n)),ie.node()}const F3=r=>{const{type:n,items:u,...f}=r;if(n==="choropleth"&&u&&u.length){const y=u.map(b=>b.value||b.name),C=u.map(b=>b.color);return O3(ex(y,C),{tickSize:0,...f})}return null},j3={key:0,class:"m-legend-item"},N3={class:"legend-title"},V3=["innerHTML"],U3={__name:"LegendItemTypeChoroplethHorizontal",props:{legendConfig:{type:Object,required:!1},title:{type:String,required:!1}},setup(r){const n=r,u=cr(()=>n.legendConfig&&n.legendConfig.type==="choropleth"&&n.legendConfig.items&&n.legendConfig.items.length>0),f=cr(()=>u?F3(n.legendConfig):null);return(y,C)=>u.value?(sr(),Ar("div",j3,[Wt("div",N3,ni(n.title),1),Wt("div",{innerHTML:f.value.outerHTML},null,8,V3)])):Zo("",!0)}},Z3=js(U3,[["__scopeId","data-v-853a7ec5"]]),G3={key:0,class:"m-legend-item"},q3={class:"legend-title"},W3={__name:"LegendItemTypeChoroplethVertical",props:{legendConfig:{type:Object,required:!1},title:{type:String,required:!1}},setup(r){const n=r,u=cr(()=>n.legendConfig&&n.legendConfig.type==="choropleth_vertical"&&n.legendConfig.items&&n.legendConfig.items.length>0);return(f,y)=>u.value?(sr(),Ar("div",G3,[Wt("div",q3,ni(n.title),1),Wt("table",null,[Wt("tbody",null,[(sr(!0),Ar(an,null,Wl(n.legendConfig.items,C=>(sr(),Ar("tr",null,[Wt("th",null,[Wt("span",{style:Ls({backgroundColor:C.color})},null,4)]),Wt("td",null,ni(C.name),1)]))),256))])])])):Zo("",!0)}},H3=js(W3,[["__scopeId","data-v-9735ecfd"]]),X3={key:0,class:"m-legend-item"},Y3={class:"legend-title"},K3={class:"legend-gradient-icon"},J3={__name:"LegendItemTypeGradientHorizontal",props:{legendConfig:{type:Object,required:!1},title:{type:String,required:!1}},setup(r){const n=r,u=cr(()=>n.legendConfig&&n.legendConfig.type==="gradient"&&n.legendConfig.items&&n.legendConfig.items.length>0),f=cr(()=>u.value?n.legendConfig.items.filter(R=>R.color!=="transparent"):[]),y=cr(()=>u.value?n.legendConfig.items.find(R=>R.color==="transparent"):null),C=cr(()=>u.value?n.legendConfig.items.map(R=>R.color).join(","):""),b=cr(()=>y.value?1/n.legendConfig.items.length*100:0),a=cr(()=>f.value.length?f.value.length/n.legendConfig.items.length*100:0),I=cr(()=>u?`linear-gradient(to right, ${C.value})`:"");return(R,$)=>u.value?(sr(),Ar("div",X3,[Wt("div",Y3,ni(n.title),1),Wt("div",K3,[y.value?(sr(),Ar("div",{key:0,class:"icon-gradient-transparent",style:Ls({width:b.value})},null,4)):Zo("",!0),Wt("div",{class:"icon-gradient",style:Ls({width:a.value,backgroundImage:I.value})},null,4)])])):Zo("",!0)}},Q3=js(J3,[["__scopeId","data-v-f4a168ad"]]),eO={key:0,class:"m-legend-item"},tO={class:"legend-title"},rO={class:"legend-gradient-icon"},nO={key:0,class:"icon-gradient-transparent",style:{width:12,height:24}},oO={class:"name"},iO={__name:"LegendItemTypeGradientVertical",props:{legendConfig:{type:Object,required:!1},title:{type:String,required:!1}},setup(r){const n=r,u=cr(()=>n.legendConfig&&n.legendConfig.type==="gradient_vertical"&&n.legendConfig.items&&n.legendConfig.items.length>0),f=cr(()=>u.value?n.legendConfig.items.filter(I=>I.color!=="transparent"):[]),y=cr(()=>u.value?n.legendConfig.items.find(I=>I.color==="transparent"):null),C=cr(()=>u.value?n.legendConfig.items.map(I=>I.color).join(","):"");cr(()=>y.value?1/n.legendConfig.items.length*100:0);const b=cr(()=>f.value.length?`${f.value.length*24}px`:0),a=cr(()=>u?`linear-gradient(to bottom, ${C.value})`:"");return(I,R)=>u.value?(sr(),Ar("div",eO,[Wt("div",tO,ni(n.title),1),Wt("div",rO,[y.value?(sr(),Ar("div",nO)):Zo("",!0),Wt("div",{class:"icon-gradient",style:Ls({height:b.value,backgroundImage:a.value})},null,4),Wt("ul",null,[(sr(!0),Ar(an,null,Wl(f.value,$=>(sr(),Ar("li",{key:$.value},[Wt("span",oO,ni($.name||$.value),1)]))),128))])])])):Zo("",!0)}},sO=js(iO,[["__scopeId","data-v-7fefba09"]]),aO={__name:"LegendItem",props:{legendConfig:{type:Object,required:!1},title:{type:String,required:!1}},setup(r){const n=r;return(u,f)=>(sr(),Ar(an,null,[Vr(jL,{"legend-config":n.legendConfig,title:n.title},null,8,["legend-config","title"]),Vr(Z3,{"legend-config":n.legendConfig,title:n.title},null,8,["legend-config","title"]),Vr(H3,{"legend-config":n.legendConfig,title:n.title},null,8,["legend-config","title"]),Vr(Q3,{"legend-config":n.legendConfig,title:n.title},null,8,["legend-config","title"]),Vr(sO,{"legend-config":n.legendConfig,title:n.title},null,8,["legend-config","title"])],64))}},lO={class:"hm-legend"},cO={__name:"Legend",setup(r){const n=Jm();return(u,f)=>(sr(),Ar("div",lO,[(sr(!0),Ar(an,null,Wl(Ol(n).visibleLayers,y=>(sr(),Ar("div",null,[Vr(aO,{"legend-config":y.legendConfig,title:y.title},null,8,["legend-config","title"])]))),256))]))}},uO={class:"basemap-control"},hO={class:"fixed-layer-control"},dO={class:"dynamic-layer-control"},fO={class:"date-navigator-control"},pO={class:"legend-control"},mO={key:0,class:"overlay-loader"},gO={__name:"Map",props:{mapSettingsUrl:{type:String,required:!0},initialBounds:{type:String,required:!1}},setup(r){const n=r,u=Jm(),f=_w(null),y=_o();let C=_o([]),b;const a=["admin-boundary-fill","admin-boundary-line","admin-boundary-line-1","weather-warnings","weather-forecast"],I=cr(()=>{const Me=u.activeTimeLayer;return Me?u.timeLayerDates[Me]||[]:[]}),R=cr(()=>{const Me=u.activeTimeLayer;return Me&&u.selectedTimeLayerDateIndex[Me]||0}),$=cr(()=>I.value[R.value]),N=async()=>(await fetch(n.mapSettingsUrl)).json(),q=async()=>{const Me={container:f.value,style:"https://tiles.basemaps.cartocdn.com/gl/voyager-gl-style/style.json",center:[0,0],zoom:4,scrollZoom:!1};if(n.initialBounds)try{const Fe=JSON.parse(n.initialBounds);Me.bounds=[[Fe[0],Fe[1]],[Fe[2],Fe[3]]],Me.fitBoundsOptions={padding:20}}catch(Fe){console.error("Error parsing initial bounds",Fe)}b=new nR.Map(Me),b.on("load",async()=>{u.setLoading(!0);try{const Fe=await N();u.setLoading(!1),V(Fe)}catch{}})},V=Me=>{const{boundaryTilesUrl:Fe,showWarningsLayer:tt,capGeojsonUrl:At,showLocationForecastLayer:ft,locationForecastDateDisplayFormat:bt,homeForecastDataUrl:Pt,weatherIconsUrl:Ut,forecastClusterConfig:dr,dynamicMapLayers:ir}=Me;ie(Fe),tt&&(u.updateLayerState("weather-warnings",!0),Pe(At)),ft&&(u.updateLayerState("weather-forecast",!0),u.setWeatherForecastLayerDateFormat({currentTime:bt}),Ne(Pt,Ut,dr)),ir&&ir.length&&ir.forEach(Ht=>{var Cr,Kr;const Mr=(Kr=(Cr=Ht.paramsSelectorConfig)==null?void 0:Cr.find(Tn=>Tn.key==="time"))==null?void 0:Kr.dateFormat,zr={...Ht,title:Ht.name,homeMapLayerType:"dynamic",visible:!1,enabled:!0,icon:Ht.icon?`icon-${Ht.icon}`:"icon-layers",dateFormat:Mr};be(zr)})},ie=Me=>{b.addSource("admin-boundary-source",{type:"vector",tiles:[Me]}),b.addLayer({id:"admin-boundary-fill",type:"fill",source:"admin-boundary-source","source-layer":"default",filter:["==","level",0],paint:{"fill-color":"#fff","fill-opacity":0}}),b.addLayer({id:"admin-boundary-line",type:"line",source:"admin-boundary-source","source-layer":"default",filter:["==","level",0],paint:{"line-color":"#C0FF24","line-width":1,"line-offset":1}}),b.addLayer({id:"admin-boundary-line-1",type:"line",source:"admin-boundary-source","source-layer":"default",filter:["==","level",0],paint:{"line-color":"#000","line-width":1.5}})},Pe=Me=>{fetch(Me).then(Fe=>Fe.json()).then(Fe=>{if(Fe.features.length>0){const tt=oR(Fe);b.fitBounds(tt,{padding:50}),b.addSource("weather-warnings",{type:"geojson",data:Fe});let At;b.getLayer("weather-forecast")&&(At="weather-forecast"),b.addLayer({id:"weather-warnings",type:"fill",source:"weather-warnings",paint:{"fill-color":["case",["==",["get","severity"],"Extreme"],"#d72f2a",["==",["get","severity"],"Severe"],"#f89904",["==",["get","severity"],"Moderate"],"#e4e616",["==",["get","severity"],"Minor"],"#53ffff",["==",["get","severity"],"Unknown"],"#3366ff","black"],"fill-opacity":.7,"fill-outline-color":"#000"}},At),u.updateLayerVisibility("weather-warnings",!0)}})},Ne=(Me,Fe,tt)=>{b.addSource("weather-forecast",{type:"geojson",data:{type:"FeatureCollection",features:[]},...tt}),b.addLayer({id:"weather-forecast",type:"symbol",layout:{"icon-image":["get","condition"],"icon-size":.3,"icon-allow-overlap":!0},source:"weather-forecast"}),u.setLoading(!0),fetch(Me).then(At=>At.json()).then(At=>{xe(Fe),Ge(At);const{data:ft}=At;ft&&ft.length&&u.updateLayerVisibility("weather-forecast",!0),u.setLoading(!1)}).catch(At=>{u.setLoading(!1)})},xe=Me=>{fetch(Me).then(Fe=>Fe.json()).then(Fe=>{Fe&&Array.isArray(Fe)&&Fe.forEach(tt=>{b.loadImage(tt.url).then(At=>{b.addImage(tt.id,At.data)})})})},Ge=Me=>{const{multi_period:Fe,data:tt}=Me;C.value=tt;const At=new Date,ft=tt.reduce((bt,Pt)=>{const Ut=new Date(Pt.datetime);return Fe&&Ut.toDateString()===At.toDateString()&&Ut.getHours()<At.getHours()||bt.push(Pt.datetime),bt},[]);u.setActiveTimeLayer("weather-forecast"),u.setSelectedTimeLayerDateIndex("weather-forecast",0),u.setTimeLayerDates("weather-forecast",ft)},qe=Me=>{const Fe=C.value.find(tt=>tt.datetime===Me);Fe&&b.getSource("weather-forecast").setData(Fe)},be=Me=>{const{layerType:Fe}=Me;Fe==="raster_file"&&(Me.mapLayerConfig=iR(Me),u.addLayer(Me))},Oe=(Me,Fe)=>{const tt=u.getLayerById(Me),{layerType:At}=tt;Fe?At==="raster_file"&&ct(tt.id):(b.getLayer(Me)&&b.removeLayer(Me),b.getSource(Me)&&b.removeSource(Me))},ct=async Me=>{const Fe=u.getLayerById(Me),{mapLayerConfig:tt}=Fe,{tileJsonUrl:At,currentTimeMethod:ft}=Fe;try{u.setLoading(!0);const bt=await fetch(At).then(Pt=>Pt.json()).then(Pt=>Pt.timestamps);if(bt&&bt.length){const Pt=AD(bt,ft),Ut=bt.indexOf(Pt);u.setSelectedTimeLayerDateIndex(Fe.id,Ut),u.setTimeLayerDates(Fe.id,bt);const dr=tt.source.id,ir=tt.layer.id,Ht=mb(tt.source.tiles,{time:Pt});b.getSource(dr)||b.addSource(dr,{type:"raster",tiles:[Ht]}),b.getLayer(ir)||(b.addLayer({id:ir,type:"raster",source:dr}),a.forEach(Mr=>{b.getLayer(Mr)&&b.moveLayer(Mr)}))}u.setLoading(!1)}catch{u.setLoading(!1)}},ut=()=>b==null?void 0:b.zoomIn(),st=()=>b==null?void 0:b.zoomOut(),Qe=Me=>{y.value.toggle(Me)},gt=({layerId:Me,visible:Fe})=>{u.updateLayerVisibility(Me,Fe);const tt=u.getLayerById(Me),{homeMapLayerType:At}=tt;At==="fixed"&&b.getLayer(Me)&&b.setLayoutProperty(Me,"visibility",Fe?"visible":"none"),tt.multiTemporal&&(Fe?(u.activeTimeLayer&&(u.updateLayerVisibility(u.activeTimeLayer,!1),b.getLayer(u.activeTimeLayer)&&b.setLayoutProperty(u.activeTimeLayer,"visibility","none"),u.activeTimeLayer!=="weather-forecast"&&(b.getLayer(u.activeTimeLayer)&&b.removeLayer(u.activeTimeLayer),b.getSource(u.activeTimeLayer)&&b.removeSource(u.activeTimeLayer))),u.setActiveTimeLayer(Me)):u.setActiveTimeLayer(null)),At==="dynamic"&&Oe(Me,Fe)},ot=(Me,Fe)=>{const{layerType:tt,mapLayerConfig:At}=Me;tt==="raster_file"&&At&&sR(b,At.source.id,{time:Fe})};return jo($,Me=>{const Fe=u.activeTimeLayer;if(Fe){const tt=u.getLayerById(Fe),{homeMapLayerType:At}=tt;At==="fixed"?Fe==="weather-forecast"&&qe(Me):ot(tt,Me)}}),df(()=>q()),Um(()=>b==null?void 0:b.remove()),(Me,Fe)=>(sr(),Ar(an,null,[Wt("div",{ref_key:"mapContainer",ref:f,class:"map-container"},null,512),Wt("div",{class:"zoom-controls"},[Wt("button",{onClick:ut},"+"),Wt("button",{onClick:st},"−")]),Wt("div",uO,[Wt("div",{class:"basemap-icon icon",onClick:Qe},Fe[0]||(Fe[0]=[Wt("svg",null,[Wt("use",{"xlink:href":"#icon-layer-group"})],-1)])),Vr(Ol(Ib),{ref_key:"basemapChooserRef",ref:y},{default:jd(()=>Fe[1]||(Fe[1]=[Gv(" Hello ")])),_:1},512)]),Wt("div",hO,[(sr(!0),Ar(an,null,Wl(Ol(u).sortedFixedLayers,tt=>(sr(),Bs(l0,{key:tt.id,title:tt.title,enabled:tt.enabled,visible:tt.visible,"home-map-layer-type":tt.homeMapLayerType,position:tt.position,id:tt.id,icon:tt.icon,"onUpdate:toggleLayer":gt},null,8,["title","enabled","visible","home-map-layer-type","position","id","icon"]))),128))]),Wt("div",dO,[(sr(!0),Ar(an,null,Wl(Ol(u).sortedDynamicLayers,tt=>(sr(),Bs(l0,{key:tt.id,title:tt.title,enabled:tt.enabled,visible:tt.visible,"home-map-layer-type":tt.homeMapLayerType,position:tt.position,id:tt.id,icon:tt.icon,"onUpdate:toggleLayer":gt},null,8,["title","enabled","visible","home-map-layer-type","position","id","icon"]))),128))]),Wt("div",fO,[Vr(DL)]),Wt("div",pO,[Vr(cO)]),Ol(u).loading?(sr(),Ar("div",mO,Fe[2]||(Fe[2]=[Wt("div",{class:"spinner"},null,-1)]))):Zo("",!0)],64))}},_O=js(gO,[["__scopeId","data-v-c7d5dfe9"]]),z0={__name:"HomeMap",props:{mapSettingsUrl:{type:String,required:!0},cityDetailUrl:{type:String,required:!1},initialBounds:{type:String,required:!1}},setup(r){return(n,u)=>(sr(),Bs(_O,{initialBounds:r.initialBounds,mapSettingsUrl:r.mapSettingsUrl},null,8,["initialBounds","mapSettingsUrl"]))}},yO=yC(),Ad=document.getElementById("home-map");if(Ad){const r=mC(z0,PC({dataset:{...Ad.dataset},component:z0}));r.use(DS,{theme:{preset:Jz}}),r.use(yO),r.use(kC,{rootElement:Ad}),r.mount(Ad)}
