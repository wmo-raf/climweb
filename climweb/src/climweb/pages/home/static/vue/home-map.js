/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Up(n){const s=Object.create(null);for(const d of n.split(","))s[d]=1;return d=>d in s}const Tr={},Il=[],fn=()=>{},ox=()=>!1,Td=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Zp=n=>n.startsWith("onUpdate:"),Ao=Object.assign,Gp=(n,s)=>{const d=n.indexOf(s);d>-1&&n.splice(d,1)},ix=Object.prototype.hasOwnProperty,dr=(n,s)=>ix.call(n,s),Bt=Array.isArray,El=n=>Sd(n)==="[object Map]",Cy=n=>Sd(n)==="[object Set]",Vt=n=>typeof n=="function",Gr=n=>typeof n=="string",Zn=n=>typeof n=="symbol",Lr=n=>n!==null&&typeof n=="object",Ty=n=>(Lr(n)||Vt(n))&&Vt(n.then)&&Vt(n.catch),Sy=Object.prototype.toString,Sd=n=>Sy.call(n),nx=n=>Sd(n).slice(8,-1),ky=n=>Sd(n)==="[object Object]",qp=n=>Gr(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,uu=Up(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),kd=n=>{const s=Object.create(null);return d=>s[d]||(s[d]=n(d))},sx=/-(\w)/g,ji=kd(n=>n.replace(sx,(s,d)=>d?d.toUpperCase():"")),ax=/\B([A-Z])/g,ma=kd(n=>n.replace(ax,"-$1").toLowerCase()),Pd=kd(n=>n.charAt(0).toUpperCase()+n.slice(1)),op=kd(n=>n?`on${Pd(n)}`:""),Ss=(n,s)=>!Object.is(n,s),ip=(n,...s)=>{for(let d=0;d<n.length;d++)n[d](...s)},Py=(n,s,d,_=!1)=>{Object.defineProperty(n,s,{configurable:!0,enumerable:!1,writable:_,value:d})},lx=n=>{const s=parseFloat(n);return isNaN(s)?n:s},cx=n=>{const s=Gr(n)?Number(n):NaN;return isNaN(s)?n:s};let Jg;const Md=()=>Jg||(Jg=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Wp(n){if(Bt(n)){const s={};for(let d=0;d<n.length;d++){const _=n[d],x=Gr(_)?fx(_):Wp(_);if(x)for(const P in x)s[P]=x[P]}return s}else if(Gr(n)||Lr(n))return n}const ux=/;(?![^(]*\))/g,hx=/:([^]+)/,dx=/\/\*[^]*?\*\//g;function fx(n){const s={};return n.replace(dx,"").split(ux).forEach(d=>{if(d){const _=d.split(hx);_.length>1&&(s[_[0].trim()]=_[1].trim())}}),s}function Id(n){let s="";if(Gr(n))s=n;else if(Bt(n))for(let d=0;d<n.length;d++){const _=Id(n[d]);_&&(s+=_+" ")}else if(Lr(n))for(const d in n)n[d]&&(s+=d+" ");return s.trim()}const px="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",mx=Up(px);function My(n){return!!n||n===""}const Iy=n=>!!(n&&n.__v_isRef===!0),Hp=n=>Gr(n)?n:n==null?"":Bt(n)||Lr(n)&&(n.toString===Sy||!Vt(n.toString))?Iy(n)?Hp(n.value):JSON.stringify(n,Ey,2):String(n),Ey=(n,s)=>Iy(s)?Ey(n,s.value):El(s)?{[`Map(${s.size})`]:[...s.entries()].reduce((d,[_,x],P)=>(d[np(_,P)+" =>"]=x,d),{})}:Cy(s)?{[`Set(${s.size})`]:[...s.values()].map(d=>np(d))}:Zn(s)?np(s):Lr(s)&&!Bt(s)&&!ky(s)?String(s):s,np=(n,s="")=>{var d;return Zn(n)?`Symbol(${(d=n.description)!=null?d:s})`:n};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ei;class Ay{constructor(s=!1){this.detached=s,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ei,!s&&ei&&(this.index=(ei.scopes||(ei.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let s,d;if(this.scopes)for(s=0,d=this.scopes.length;s<d;s++)this.scopes[s].pause();for(s=0,d=this.effects.length;s<d;s++)this.effects[s].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let s,d;if(this.scopes)for(s=0,d=this.scopes.length;s<d;s++)this.scopes[s].resume();for(s=0,d=this.effects.length;s<d;s++)this.effects[s].resume()}}run(s){if(this._active){const d=ei;try{return ei=this,s()}finally{ei=d}}}on(){ei=this}off(){ei=this.parent}stop(s){if(this._active){this._active=!1;let d,_;for(d=0,_=this.effects.length;d<_;d++)this.effects[d].stop();for(this.effects.length=0,d=0,_=this.cleanups.length;d<_;d++)this.cleanups[d]();if(this.cleanups.length=0,this.scopes){for(d=0,_=this.scopes.length;d<_;d++)this.scopes[d].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!s){const x=this.parent.scopes.pop();x&&x!==this&&(this.parent.scopes[this.index]=x,x.index=this.index)}this.parent=void 0}}}function zy(n){return new Ay(n)}function Dy(){return ei}function gx(n,s=!1){ei&&ei.cleanups.push(n)}let Pr;const sp=new WeakSet;class Ry{constructor(s){this.fn=s,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ei&&ei.active&&ei.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,sp.has(this)&&(sp.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||By(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Qg(this),Fy(this);const s=Pr,d=Yi;Pr=this,Yi=!0;try{return this.fn()}finally{Oy(this),Pr=s,Yi=d,this.flags&=-3}}stop(){if(this.flags&1){for(let s=this.deps;s;s=s.nextDep)Kp(s);this.deps=this.depsTail=void 0,Qg(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?sp.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Cp(this)&&this.run()}get dirty(){return Cp(this)}}let Ly=0,hu,du;function By(n,s=!1){if(n.flags|=8,s){n.next=du,du=n;return}n.next=hu,hu=n}function Xp(){Ly++}function Yp(){if(--Ly>0)return;if(du){let s=du;for(du=void 0;s;){const d=s.next;s.next=void 0,s.flags&=-9,s=d}}let n;for(;hu;){let s=hu;for(hu=void 0;s;){const d=s.next;if(s.next=void 0,s.flags&=-9,s.flags&1)try{s.trigger()}catch(_){n||(n=_)}s=d}}if(n)throw n}function Fy(n){for(let s=n.deps;s;s=s.nextDep)s.version=-1,s.prevActiveLink=s.dep.activeLink,s.dep.activeLink=s}function Oy(n){let s,d=n.depsTail,_=d;for(;_;){const x=_.prevDep;_.version===-1?(_===d&&(d=x),Kp(_),_x(_)):s=_,_.dep.activeLink=_.prevActiveLink,_.prevActiveLink=void 0,_=x}n.deps=s,n.depsTail=d}function Cp(n){for(let s=n.deps;s;s=s.nextDep)if(s.dep.version!==s.version||s.dep.computed&&($y(s.dep.computed)||s.dep.version!==s.version))return!0;return!!n._dirty}function $y(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===bu))return;n.globalVersion=bu;const s=n.dep;if(n.flags|=2,s.version>0&&!n.isSSR&&n.deps&&!Cp(n)){n.flags&=-3;return}const d=Pr,_=Yi;Pr=n,Yi=!0;try{Fy(n);const x=n.fn(n._value);(s.version===0||Ss(x,n._value))&&(n._value=x,s.version++)}catch(x){throw s.version++,x}finally{Pr=d,Yi=_,Oy(n),n.flags&=-3}}function Kp(n,s=!1){const{dep:d,prevSub:_,nextSub:x}=n;if(_&&(_.nextSub=x,n.prevSub=void 0),x&&(x.prevSub=_,n.nextSub=void 0),d.subs===n&&(d.subs=_,!_&&d.computed)){d.computed.flags&=-5;for(let P=d.computed.deps;P;P=P.nextDep)Kp(P,!0)}!s&&!--d.sc&&d.map&&d.map.delete(d.key)}function _x(n){const{prevDep:s,nextDep:d}=n;s&&(s.nextDep=d,n.prevDep=void 0),d&&(d.prevDep=s,n.nextDep=void 0)}let Yi=!0;const jy=[];function As(){jy.push(Yi),Yi=!1}function zs(){const n=jy.pop();Yi=n===void 0?!0:n}function Qg(n){const{cleanup:s}=n;if(n.cleanup=void 0,s){const d=Pr;Pr=void 0;try{s()}finally{Pr=d}}}let bu=0;class yx{constructor(s,d){this.sub=s,this.dep=d,this.version=d.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Jp{constructor(s){this.computed=s,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(s){if(!Pr||!Yi||Pr===this.computed)return;let d=this.activeLink;if(d===void 0||d.sub!==Pr)d=this.activeLink=new yx(Pr,this),Pr.deps?(d.prevDep=Pr.depsTail,Pr.depsTail.nextDep=d,Pr.depsTail=d):Pr.deps=Pr.depsTail=d,Ny(d);else if(d.version===-1&&(d.version=this.version,d.nextDep)){const _=d.nextDep;_.prevDep=d.prevDep,d.prevDep&&(d.prevDep.nextDep=_),d.prevDep=Pr.depsTail,d.nextDep=void 0,Pr.depsTail.nextDep=d,Pr.depsTail=d,Pr.deps===d&&(Pr.deps=_)}return d}trigger(s){this.version++,bu++,this.notify(s)}notify(s){Xp();try{for(let d=this.subs;d;d=d.prevSub)d.sub.notify()&&d.sub.dep.notify()}finally{Yp()}}}function Ny(n){if(n.dep.sc++,n.sub.flags&4){const s=n.dep.computed;if(s&&!n.dep.subs){s.flags|=20;for(let _=s.deps;_;_=_.nextDep)Ny(_)}const d=n.dep.subs;d!==n&&(n.prevSub=d,d&&(d.nextSub=n)),n.dep.subs=n}}const dd=new WeakMap,da=Symbol(""),Tp=Symbol(""),xu=Symbol("");function $o(n,s,d){if(Yi&&Pr){let _=dd.get(n);_||dd.set(n,_=new Map);let x=_.get(d);x||(_.set(d,x=new Jp),x.map=_,x.key=d),x.track()}}function jn(n,s,d,_,x,P){const b=dd.get(n);if(!b){bu++;return}const c=z=>{z&&z.trigger()};if(Xp(),s==="clear")b.forEach(c);else{const z=Bt(n),U=z&&qp(d);if(z&&d==="length"){const V=Number(_);b.forEach((H,Q)=>{(Q==="length"||Q===xu||!Zn(Q)&&Q>=V)&&c(H)})}else switch((d!==void 0||b.has(void 0))&&c(b.get(d)),U&&c(b.get(xu)),s){case"add":z?U&&c(b.get("length")):(c(b.get(da)),El(n)&&c(b.get(Tp)));break;case"delete":z||(c(b.get(da)),El(n)&&c(b.get(Tp)));break;case"set":El(n)&&c(b.get(da));break}}Yp()}function vx(n,s){const d=dd.get(n);return d&&d.get(s)}function Cl(n){const s=nr(n);return s===n?s:($o(s,"iterate",xu),$i(n)?s:s.map(jo))}function Ed(n){return $o(n=nr(n),"iterate",xu),n}const bx={__proto__:null,[Symbol.iterator](){return ap(this,Symbol.iterator,jo)},concat(...n){return Cl(this).concat(...n.map(s=>Bt(s)?Cl(s):s))},entries(){return ap(this,"entries",n=>(n[1]=jo(n[1]),n))},every(n,s){return Bn(this,"every",n,s,void 0,arguments)},filter(n,s){return Bn(this,"filter",n,s,d=>d.map(jo),arguments)},find(n,s){return Bn(this,"find",n,s,jo,arguments)},findIndex(n,s){return Bn(this,"findIndex",n,s,void 0,arguments)},findLast(n,s){return Bn(this,"findLast",n,s,jo,arguments)},findLastIndex(n,s){return Bn(this,"findLastIndex",n,s,void 0,arguments)},forEach(n,s){return Bn(this,"forEach",n,s,void 0,arguments)},includes(...n){return lp(this,"includes",n)},indexOf(...n){return lp(this,"indexOf",n)},join(n){return Cl(this).join(n)},lastIndexOf(...n){return lp(this,"lastIndexOf",n)},map(n,s){return Bn(this,"map",n,s,void 0,arguments)},pop(){return eu(this,"pop")},push(...n){return eu(this,"push",n)},reduce(n,...s){return e_(this,"reduce",n,s)},reduceRight(n,...s){return e_(this,"reduceRight",n,s)},shift(){return eu(this,"shift")},some(n,s){return Bn(this,"some",n,s,void 0,arguments)},splice(...n){return eu(this,"splice",n)},toReversed(){return Cl(this).toReversed()},toSorted(n){return Cl(this).toSorted(n)},toSpliced(...n){return Cl(this).toSpliced(...n)},unshift(...n){return eu(this,"unshift",n)},values(){return ap(this,"values",jo)}};function ap(n,s,d){const _=Ed(n),x=_[s]();return _!==n&&!$i(n)&&(x._next=x.next,x.next=()=>{const P=x._next();return P.value&&(P.value=d(P.value)),P}),x}const xx=Array.prototype;function Bn(n,s,d,_,x,P){const b=Ed(n),c=b!==n&&!$i(n),z=b[s];if(z!==xx[s]){const H=z.apply(n,P);return c?jo(H):H}let U=d;b!==n&&(c?U=function(H,Q){return d.call(this,jo(H),Q,n)}:d.length>2&&(U=function(H,Q){return d.call(this,H,Q,n)}));const V=z.call(b,U,_);return c&&x?x(V):V}function e_(n,s,d,_){const x=Ed(n);let P=d;return x!==n&&($i(n)?d.length>3&&(P=function(b,c,z){return d.call(this,b,c,z,n)}):P=function(b,c,z){return d.call(this,b,jo(c),z,n)}),x[s](P,..._)}function lp(n,s,d){const _=nr(n);$o(_,"iterate",xu);const x=_[s](...d);return(x===-1||x===!1)&&rm(d[0])?(d[0]=nr(d[0]),_[s](...d)):x}function eu(n,s,d=[]){As(),Xp();const _=nr(n)[s].apply(n,d);return Yp(),zs(),_}const wx=Up("__proto__,__v_isRef,__isVue"),Vy=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Zn));function Cx(n){Zn(n)||(n=String(n));const s=nr(this);return $o(s,"has",n),s.hasOwnProperty(n)}class Uy{constructor(s=!1,d=!1){this._isReadonly=s,this._isShallow=d}get(s,d,_){if(d==="__v_skip")return s.__v_skip;const x=this._isReadonly,P=this._isShallow;if(d==="__v_isReactive")return!x;if(d==="__v_isReadonly")return x;if(d==="__v_isShallow")return P;if(d==="__v_raw")return _===(x?P?Dx:Wy:P?qy:Gy).get(s)||Object.getPrototypeOf(s)===Object.getPrototypeOf(_)?s:void 0;const b=Bt(s);if(!x){let z;if(b&&(z=bx[d]))return z;if(d==="hasOwnProperty")return Cx}const c=Reflect.get(s,d,to(s)?s:_);return(Zn(d)?Vy.has(d):wx(d))||(x||$o(s,"get",d),P)?c:to(c)?b&&qp(d)?c:c.value:Lr(c)?x?em(c):Dl(c):c}}class Zy extends Uy{constructor(s=!1){super(!1,s)}set(s,d,_,x){let P=s[d];if(!this._isShallow){const z=pa(P);if(!$i(_)&&!pa(_)&&(P=nr(P),_=nr(_)),!Bt(s)&&to(P)&&!to(_))return z?!1:(P.value=_,!0)}const b=Bt(s)&&qp(d)?Number(d)<s.length:dr(s,d),c=Reflect.set(s,d,_,to(s)?s:x);return s===nr(x)&&(b?Ss(_,P)&&jn(s,"set",d,_):jn(s,"add",d,_)),c}deleteProperty(s,d){const _=dr(s,d);s[d];const x=Reflect.deleteProperty(s,d);return x&&_&&jn(s,"delete",d,void 0),x}has(s,d){const _=Reflect.has(s,d);return(!Zn(d)||!Vy.has(d))&&$o(s,"has",d),_}ownKeys(s){return $o(s,"iterate",Bt(s)?"length":da),Reflect.ownKeys(s)}}class Tx extends Uy{constructor(s=!1){super(!0,s)}set(s,d){return!0}deleteProperty(s,d){return!0}}const Sx=new Zy,kx=new Tx,Px=new Zy(!0);const Sp=n=>n,Kh=n=>Reflect.getPrototypeOf(n);function Mx(n,s,d){return function(..._){const x=this.__v_raw,P=nr(x),b=El(P),c=n==="entries"||n===Symbol.iterator&&b,z=n==="keys"&&b,U=x[n](..._),V=d?Sp:s?kp:jo;return!s&&$o(P,"iterate",z?Tp:da),{next(){const{value:H,done:Q}=U.next();return Q?{value:H,done:Q}:{value:c?[V(H[0]),V(H[1])]:V(H),done:Q}},[Symbol.iterator](){return this}}}}function Jh(n){return function(...s){return n==="delete"?!1:n==="clear"?void 0:this}}function Ix(n,s){const d={get(x){const P=this.__v_raw,b=nr(P),c=nr(x);n||(Ss(x,c)&&$o(b,"get",x),$o(b,"get",c));const{has:z}=Kh(b),U=s?Sp:n?kp:jo;if(z.call(b,x))return U(P.get(x));if(z.call(b,c))return U(P.get(c));P!==b&&P.get(x)},get size(){const x=this.__v_raw;return!n&&$o(nr(x),"iterate",da),Reflect.get(x,"size",x)},has(x){const P=this.__v_raw,b=nr(P),c=nr(x);return n||(Ss(x,c)&&$o(b,"has",x),$o(b,"has",c)),x===c?P.has(x):P.has(x)||P.has(c)},forEach(x,P){const b=this,c=b.__v_raw,z=nr(c),U=s?Sp:n?kp:jo;return!n&&$o(z,"iterate",da),c.forEach((V,H)=>x.call(P,U(V),U(H),b))}};return Ao(d,n?{add:Jh("add"),set:Jh("set"),delete:Jh("delete"),clear:Jh("clear")}:{add(x){!s&&!$i(x)&&!pa(x)&&(x=nr(x));const P=nr(this);return Kh(P).has.call(P,x)||(P.add(x),jn(P,"add",x,x)),this},set(x,P){!s&&!$i(P)&&!pa(P)&&(P=nr(P));const b=nr(this),{has:c,get:z}=Kh(b);let U=c.call(b,x);U||(x=nr(x),U=c.call(b,x));const V=z.call(b,x);return b.set(x,P),U?Ss(P,V)&&jn(b,"set",x,P):jn(b,"add",x,P),this},delete(x){const P=nr(this),{has:b,get:c}=Kh(P);let z=b.call(P,x);z||(x=nr(x),z=b.call(P,x)),c&&c.call(P,x);const U=P.delete(x);return z&&jn(P,"delete",x,void 0),U},clear(){const x=nr(this),P=x.size!==0,b=x.clear();return P&&jn(x,"clear",void 0,void 0),b}}),["keys","values","entries",Symbol.iterator].forEach(x=>{d[x]=Mx(x,n,s)}),d}function Qp(n,s){const d=Ix(n,s);return(_,x,P)=>x==="__v_isReactive"?!n:x==="__v_isReadonly"?n:x==="__v_raw"?_:Reflect.get(dr(d,x)&&x in _?d:_,x,P)}const Ex={get:Qp(!1,!1)},Ax={get:Qp(!1,!0)},zx={get:Qp(!0,!1)};const Gy=new WeakMap,qy=new WeakMap,Wy=new WeakMap,Dx=new WeakMap;function Rx(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Lx(n){return n.__v_skip||!Object.isExtensible(n)?0:Rx(nx(n))}function Dl(n){return pa(n)?n:tm(n,!1,Sx,Ex,Gy)}function Bx(n){return tm(n,!1,Px,Ax,qy)}function em(n){return tm(n,!0,kx,zx,Wy)}function tm(n,s,d,_,x){if(!Lr(n)||n.__v_raw&&!(s&&n.__v_isReactive))return n;const P=x.get(n);if(P)return P;const b=Lx(n);if(b===0)return n;const c=new Proxy(n,b===2?_:d);return x.set(n,c),c}function ks(n){return pa(n)?ks(n.__v_raw):!!(n&&n.__v_isReactive)}function pa(n){return!!(n&&n.__v_isReadonly)}function $i(n){return!!(n&&n.__v_isShallow)}function rm(n){return n?!!n.__v_raw:!1}function nr(n){const s=n&&n.__v_raw;return s?nr(s):n}function om(n){return!dr(n,"__v_skip")&&Object.isExtensible(n)&&Py(n,"__v_skip",!0),n}const jo=n=>Lr(n)?Dl(n):n,kp=n=>Lr(n)?em(n):n;function to(n){return n?n.__v_isRef===!0:!1}function Mi(n){return Hy(n,!1)}function Fx(n){return Hy(n,!0)}function Hy(n,s){return to(n)?n:new Ox(n,s)}class Ox{constructor(s,d){this.dep=new Jp,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=d?s:nr(s),this._value=d?s:jo(s),this.__v_isShallow=d}get value(){return this.dep.track(),this._value}set value(s){const d=this._rawValue,_=this.__v_isShallow||$i(s)||pa(s);s=_?s:nr(s),Ss(s,d)&&(this._rawValue=s,this._value=_?s:jo(s),this.dep.trigger())}}function ad(n){return to(n)?n.value:n}const $x={get:(n,s,d)=>s==="__v_raw"?n:ad(Reflect.get(n,s,d)),set:(n,s,d,_)=>{const x=n[s];return to(x)&&!to(d)?(x.value=d,!0):Reflect.set(n,s,d,_)}};function Xy(n){return ks(n)?n:new Proxy(n,$x)}function jx(n){const s=Bt(n)?new Array(n.length):{};for(const d in n)s[d]=Vx(n,d);return s}class Nx{constructor(s,d,_){this._object=s,this._key=d,this._defaultValue=_,this.__v_isRef=!0,this._value=void 0}get value(){const s=this._object[this._key];return this._value=s===void 0?this._defaultValue:s}set value(s){this._object[this._key]=s}get dep(){return vx(nr(this._object),this._key)}}function Vx(n,s,d){const _=n[s];return to(_)?_:new Nx(n,s,d)}class Ux{constructor(s,d,_){this.fn=s,this.setter=d,this._value=void 0,this.dep=new Jp(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=bu-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!d,this.isSSR=_}notify(){if(this.flags|=16,!(this.flags&8)&&Pr!==this)return By(this,!0),!0}get value(){const s=this.dep.track();return $y(this),s&&(s.version=this.dep.version),this._value}set value(s){this.setter&&this.setter(s)}}function Zx(n,s,d=!1){let _,x;return Vt(n)?_=n:(_=n.get,x=n.set),new Ux(_,x,d)}const Qh={},fd=new WeakMap;let ca;function Gx(n,s=!1,d=ca){if(d){let _=fd.get(d);_||fd.set(d,_=[]),_.push(n)}}function qx(n,s,d=Tr){const{immediate:_,deep:x,once:P,scheduler:b,augmentJob:c,call:z}=d,U=Te=>x?Te:$i(Te)||x===!1||x===0?Nn(Te,1):Nn(Te);let V,H,Q,G,se=!1,Me=!1;if(to(n)?(H=()=>n.value,se=$i(n)):ks(n)?(H=()=>U(n),se=!0):Bt(n)?(Me=!0,se=n.some(Te=>ks(Te)||$i(Te)),H=()=>n.map(Te=>{if(to(Te))return Te.value;if(ks(Te))return U(Te);if(Vt(Te))return z?z(Te,2):Te()})):Vt(n)?s?H=z?()=>z(n,2):n:H=()=>{if(Q){As();try{Q()}finally{zs()}}const Te=ca;ca=V;try{return z?z(n,3,[G]):n(G)}finally{ca=Te}}:H=fn,s&&x){const Te=H,Ye=x===!0?1/0:x;H=()=>Nn(Te(),Ye)}const rt=Dy(),He=()=>{V.stop(),rt&&rt.active&&Gp(rt.effects,V)};if(P&&s){const Te=s;s=(...Ye)=>{Te(...Ye),He()}}let lt=Me?new Array(n.length).fill(Qh):Qh;const st=Te=>{if(!(!(V.flags&1)||!V.dirty&&!Te))if(s){const Ye=V.run();if(x||se||(Me?Ye.some((dt,_t)=>Ss(dt,lt[_t])):Ss(Ye,lt))){Q&&Q();const dt=ca;ca=V;try{const _t=[Ye,lt===Qh?void 0:Me&&lt[0]===Qh?[]:lt,G];z?z(s,3,_t):s(..._t),lt=Ye}finally{ca=dt}}}else V.run()};return c&&c(st),V=new Ry(H),V.scheduler=b?()=>b(st,!1):st,G=Te=>Gx(Te,!1,V),Q=V.onStop=()=>{const Te=fd.get(V);if(Te){if(z)z(Te,4);else for(const Ye of Te)Ye();fd.delete(V)}},s?_?st(!0):lt=V.run():b?b(st.bind(null,!0),!0):V.run(),He.pause=V.pause.bind(V),He.resume=V.resume.bind(V),He.stop=He,He}function Nn(n,s=1/0,d){if(s<=0||!Lr(n)||n.__v_skip||(d=d||new Set,d.has(n)))return n;if(d.add(n),s--,to(n))Nn(n.value,s,d);else if(Bt(n))for(let _=0;_<n.length;_++)Nn(n[_],s,d);else if(Cy(n)||El(n))n.forEach(_=>{Nn(_,s,d)});else if(ky(n)){for(const _ in n)Nn(n[_],s,d);for(const _ of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,_)&&Nn(n[_],s,d)}return n}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Fu(n,s,d,_){try{return _?n(..._):n()}catch(x){Ad(x,s,d)}}function Ki(n,s,d,_){if(Vt(n)){const x=Fu(n,s,d,_);return x&&Ty(x)&&x.catch(P=>{Ad(P,s,d)}),x}if(Bt(n)){const x=[];for(let P=0;P<n.length;P++)x.push(Ki(n[P],s,d,_));return x}}function Ad(n,s,d,_=!0){const x=s?s.vnode:null,{errorHandler:P,throwUnhandledErrorInProduction:b}=s&&s.appContext.config||Tr;if(s){let c=s.parent;const z=s.proxy,U=`https://vuejs.org/error-reference/#runtime-${d}`;for(;c;){const V=c.ec;if(V){for(let H=0;H<V.length;H++)if(V[H](n,z,U)===!1)return}c=c.parent}if(P){As(),Fu(P,null,10,[n,z,U]),zs();return}}Wx(n,d,x,_,b)}function Wx(n,s,d,_=!0,x=!1){if(x)throw n;console.error(n)}const ti=[];let un=-1;const Al=[];let bs=null,kl=0;const Yy=Promise.resolve();let pd=null;function im(n){const s=pd||Yy;return n?s.then(this?n.bind(this):n):s}function Hx(n){let s=un+1,d=ti.length;for(;s<d;){const _=s+d>>>1,x=ti[_],P=wu(x);P<n||P===n&&x.flags&2?s=_+1:d=_}return s}function nm(n){if(!(n.flags&1)){const s=wu(n),d=ti[ti.length-1];!d||!(n.flags&2)&&s>=wu(d)?ti.push(n):ti.splice(Hx(s),0,n),n.flags|=1,Ky()}}function Ky(){pd||(pd=Yy.then(Qy))}function Xx(n){Bt(n)?Al.push(...n):bs&&n.id===-1?bs.splice(kl+1,0,n):n.flags&1||(Al.push(n),n.flags|=1),Ky()}function t_(n,s,d=un+1){for(;d<ti.length;d++){const _=ti[d];if(_&&_.flags&2){if(n&&_.id!==n.uid)continue;ti.splice(d,1),d--,_.flags&4&&(_.flags&=-2),_(),_.flags&4||(_.flags&=-2)}}}function Jy(n){if(Al.length){const s=[...new Set(Al)].sort((d,_)=>wu(d)-wu(_));if(Al.length=0,bs){bs.push(...s);return}for(bs=s,kl=0;kl<bs.length;kl++){const d=bs[kl];d.flags&4&&(d.flags&=-2),d.flags&8||d(),d.flags&=-2}bs=null,kl=0}}const wu=n=>n.id==null?n.flags&2?-1:1/0:n.id;function Qy(n){try{for(un=0;un<ti.length;un++){const s=ti[un];s&&!(s.flags&8)&&(s.flags&4&&(s.flags&=-2),Fu(s,s.i,s.i?15:14),s.flags&4||(s.flags&=-2))}}finally{for(;un<ti.length;un++){const s=ti[un];s&&(s.flags&=-2)}un=-1,ti.length=0,Jy(),pd=null,(ti.length||Al.length)&&Qy()}}let vo=null,e0=null;function md(n){const s=vo;return vo=n,e0=n&&n.type.__scopeId||null,s}function gd(n,s=vo,d){if(!s||n._n)return n;const _=(...x)=>{_._d&&g_(-1);const P=md(s);let b;try{b=n(...x)}finally{md(P),_._d&&g_(1)}return b};return _._n=!0,_._c=!0,_._d=!0,_}function Yx(n,s){if(vo===null)return n;const d=Od(vo),_=n.dirs||(n.dirs=[]);for(let x=0;x<s.length;x++){let[P,b,c,z=Tr]=s[x];P&&(Vt(P)&&(P={mounted:P,updated:P}),P.deep&&Nn(b),_.push({dir:P,instance:d,value:b,oldValue:void 0,arg:c,modifiers:z}))}return n}function na(n,s,d,_){const x=n.dirs,P=s&&s.dirs;for(let b=0;b<x.length;b++){const c=x[b];P&&(c.oldValue=P[b].value);let z=c.dir[_];z&&(As(),Ki(z,d,8,[n.el,c,n,s]),zs())}}const t0=Symbol("_vte"),r0=n=>n.__isTeleport,fu=n=>n&&(n.disabled||n.disabled===""),r_=n=>n&&(n.defer||n.defer===""),o_=n=>typeof SVGElement<"u"&&n instanceof SVGElement,i_=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,Pp=(n,s)=>{const d=n&&n.to;return Gr(d)?s?s(d):null:d},o0={name:"Teleport",__isTeleport:!0,process(n,s,d,_,x,P,b,c,z,U){const{mc:V,pc:H,pbc:Q,o:{insert:G,querySelector:se,createText:Me,createComment:rt}}=U,He=fu(s.props);let{shapeFlag:lt,children:st,dynamicChildren:Te}=s;if(n==null){const Ye=s.el=Me(""),dt=s.anchor=Me("");G(Ye,d,_),G(dt,d,_);const _t=(Je,bt)=>{lt&16&&(x&&x.isCE&&(x.ce._teleportTarget=Je),V(st,Je,bt,x,P,b,c,z))},nt=()=>{const Je=s.target=Pp(s.props,se),bt=i0(Je,s,Me,G);Je&&(b!=="svg"&&o_(Je)?b="svg":b!=="mathml"&&i_(Je)&&(b="mathml"),He||(_t(Je,bt),ld(s,!1)))};He&&(_t(d,dt),ld(s,!0)),r_(s.props)?Qo(()=>{nt(),s.el.__isMounted=!0},P):nt()}else{if(r_(s.props)&&!n.el.__isMounted){Qo(()=>{o0.process(n,s,d,_,x,P,b,c,z,U),delete n.el.__isMounted},P);return}s.el=n.el,s.targetStart=n.targetStart;const Ye=s.anchor=n.anchor,dt=s.target=n.target,_t=s.targetAnchor=n.targetAnchor,nt=fu(n.props),Je=nt?d:dt,bt=nt?Ye:_t;if(b==="svg"||o_(dt)?b="svg":(b==="mathml"||i_(dt))&&(b="mathml"),Te?(Q(n.dynamicChildren,Te,Je,x,P,b,c),lm(n,s,!0)):z||H(n,s,Je,bt,x,P,b,c,!1),He)nt?s.props&&n.props&&s.props.to!==n.props.to&&(s.props.to=n.props.to):ed(s,d,Ye,U,1);else if((s.props&&s.props.to)!==(n.props&&n.props.to)){const zt=s.target=Pp(s.props,se);zt&&ed(s,zt,null,U,0)}else nt&&ed(s,dt,_t,U,1);ld(s,He)}},remove(n,s,d,{um:_,o:{remove:x}},P){const{shapeFlag:b,children:c,anchor:z,targetStart:U,targetAnchor:V,target:H,props:Q}=n;if(H&&(x(U),x(V)),P&&x(z),b&16){const G=P||!fu(Q);for(let se=0;se<c.length;se++){const Me=c[se];_(Me,s,d,G,!!Me.dynamicChildren)}}},move:ed,hydrate:Kx};function ed(n,s,d,{o:{insert:_},m:x},P=2){P===0&&_(n.targetAnchor,s,d);const{el:b,anchor:c,shapeFlag:z,children:U,props:V}=n,H=P===2;if(H&&_(b,s,d),(!H||fu(V))&&z&16)for(let Q=0;Q<U.length;Q++)x(U[Q],s,d,2);H&&_(c,s,d)}function Kx(n,s,d,_,x,P,{o:{nextSibling:b,parentNode:c,querySelector:z,insert:U,createText:V}},H){const Q=s.target=Pp(s.props,z);if(Q){const G=fu(s.props),se=Q._lpa||Q.firstChild;if(s.shapeFlag&16)if(G)s.anchor=H(b(n),s,c(n),d,_,x,P),s.targetStart=se,s.targetAnchor=se&&b(se);else{s.anchor=b(n);let Me=se;for(;Me;){if(Me&&Me.nodeType===8){if(Me.data==="teleport start anchor")s.targetStart=Me;else if(Me.data==="teleport anchor"){s.targetAnchor=Me,Q._lpa=s.targetAnchor&&b(s.targetAnchor);break}}Me=b(Me)}s.targetAnchor||i0(Q,s,V,U),H(se&&b(se),s,Q,d,_,x,P)}ld(s,G)}return s.anchor&&b(s.anchor)}const Jx=o0;function ld(n,s){const d=n.ctx;if(d&&d.ut){let _,x;for(s?(_=n.el,x=n.anchor):(_=n.targetStart,x=n.targetAnchor);_&&_!==x;)_.nodeType===1&&_.setAttribute("data-v-owner",d.uid),_=_.nextSibling;d.ut()}}function i0(n,s,d,_){const x=s.targetStart=d(""),P=s.targetAnchor=d("");return x[t0]=P,n&&(_(x,n),_(P,n)),P}const xs=Symbol("_leaveCb"),td=Symbol("_enterCb");function Qx(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Rd(()=>{n.isMounted=!0}),d0(()=>{n.isUnmounting=!0}),n}const Bi=[Function,Array],n0={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Bi,onEnter:Bi,onAfterEnter:Bi,onEnterCancelled:Bi,onBeforeLeave:Bi,onLeave:Bi,onAfterLeave:Bi,onLeaveCancelled:Bi,onBeforeAppear:Bi,onAppear:Bi,onAfterAppear:Bi,onAppearCancelled:Bi},s0=n=>{const s=n.subTree;return s.component?s0(s.component):s},e1={name:"BaseTransition",props:n0,setup(n,{slots:s}){const d=um(),_=Qx();return()=>{const x=s.default&&c0(s.default(),!0);if(!x||!x.length)return;const P=a0(x),b=nr(n),{mode:c}=b;if(_.isLeaving)return cp(P);const z=n_(P);if(!z)return cp(P);let U=Mp(z,b,_,d,H=>U=H);z.type!==ri&&Cu(z,U);let V=d.subTree&&n_(d.subTree);if(V&&V.type!==ri&&!ha(z,V)&&s0(d).type!==ri){let H=Mp(V,b,_,d);if(Cu(V,H),c==="out-in"&&z.type!==ri)return _.isLeaving=!0,H.afterLeave=()=>{_.isLeaving=!1,d.job.flags&8||d.update(),delete H.afterLeave,V=void 0},cp(P);c==="in-out"&&z.type!==ri?H.delayLeave=(Q,G,se)=>{const Me=l0(_,V);Me[String(V.key)]=V,Q[xs]=()=>{G(),Q[xs]=void 0,delete U.delayedLeave,V=void 0},U.delayedLeave=()=>{se(),delete U.delayedLeave,V=void 0}}:V=void 0}else V&&(V=void 0);return P}}};function a0(n){let s=n[0];if(n.length>1){for(const d of n)if(d.type!==ri){s=d;break}}return s}const t1=e1;function l0(n,s){const{leavingVNodes:d}=n;let _=d.get(s.type);return _||(_=Object.create(null),d.set(s.type,_)),_}function Mp(n,s,d,_,x){const{appear:P,mode:b,persisted:c=!1,onBeforeEnter:z,onEnter:U,onAfterEnter:V,onEnterCancelled:H,onBeforeLeave:Q,onLeave:G,onAfterLeave:se,onLeaveCancelled:Me,onBeforeAppear:rt,onAppear:He,onAfterAppear:lt,onAppearCancelled:st}=s,Te=String(n.key),Ye=l0(d,n),dt=(Je,bt)=>{Je&&Ki(Je,_,9,bt)},_t=(Je,bt)=>{const zt=bt[1];dt(Je,bt),Bt(Je)?Je.every(De=>De.length<=1)&&zt():Je.length<=1&&zt()},nt={mode:b,persisted:c,beforeEnter(Je){let bt=z;if(!d.isMounted)if(P)bt=rt||z;else return;Je[xs]&&Je[xs](!0);const zt=Ye[Te];zt&&ha(n,zt)&&zt.el[xs]&&zt.el[xs](),dt(bt,[Je])},enter(Je){let bt=U,zt=V,De=H;if(!d.isMounted)if(P)bt=He||U,zt=lt||V,De=st||H;else return;let Ge=!1;const et=Je[td]=Dt=>{Ge||(Ge=!0,Dt?dt(De,[Je]):dt(zt,[Je]),nt.delayedLeave&&nt.delayedLeave(),Je[td]=void 0)};bt?_t(bt,[Je,et]):et()},leave(Je,bt){const zt=String(n.key);if(Je[td]&&Je[td](!0),d.isUnmounting)return bt();dt(Q,[Je]);let De=!1;const Ge=Je[xs]=et=>{De||(De=!0,bt(),et?dt(Me,[Je]):dt(se,[Je]),Je[xs]=void 0,Ye[zt]===n&&delete Ye[zt])};Ye[zt]=n,G?_t(G,[Je,Ge]):Ge()},clone(Je){const bt=Mp(Je,s,d,_,x);return x&&x(bt),bt}};return nt}function cp(n){if(zd(n))return n=Es(n),n.children=null,n}function n_(n){if(!zd(n))return r0(n.type)&&n.children?a0(n.children):n;const{shapeFlag:s,children:d}=n;if(d){if(s&16)return d[0];if(s&32&&Vt(d.default))return d.default()}}function Cu(n,s){n.shapeFlag&6&&n.component?(n.transition=s,Cu(n.component.subTree,s)):n.shapeFlag&128?(n.ssContent.transition=s.clone(n.ssContent),n.ssFallback.transition=s.clone(n.ssFallback)):n.transition=s}function c0(n,s=!1,d){let _=[],x=0;for(let P=0;P<n.length;P++){let b=n[P];const c=d==null?b.key:String(d)+String(b.key!=null?b.key:P);b.type===No?(b.patchFlag&128&&x++,_=_.concat(c0(b.children,s,c))):(s||b.type!==ri)&&_.push(c!=null?Es(b,{key:c}):b)}if(x>1)for(let P=0;P<_.length;P++)_[P].patchFlag=-2;return _}function r1(){const n=um();return n?(n.appContext.config.idPrefix||"v")+"-"+n.ids[0]+n.ids[1]++:""}function u0(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function _d(n,s,d,_,x=!1){if(Bt(n)){n.forEach((se,Me)=>_d(se,s&&(Bt(s)?s[Me]:s),d,_,x));return}if(zl(_)&&!x){_.shapeFlag&512&&_.type.__asyncResolved&&_.component.subTree.component&&_d(n,s,d,_.component.subTree);return}const P=_.shapeFlag&4?Od(_.component):_.el,b=x?null:P,{i:c,r:z}=n,U=s&&s.r,V=c.refs===Tr?c.refs={}:c.refs,H=c.setupState,Q=nr(H),G=H===Tr?()=>!1:se=>dr(Q,se);if(U!=null&&U!==z&&(Gr(U)?(V[U]=null,G(U)&&(H[U]=null)):to(U)&&(U.value=null)),Vt(z))Fu(z,c,12,[b,V]);else{const se=Gr(z),Me=to(z);if(se||Me){const rt=()=>{if(n.f){const He=se?G(z)?H[z]:V[z]:z.value;x?Bt(He)&&Gp(He,P):Bt(He)?He.includes(P)||He.push(P):se?(V[z]=[P],G(z)&&(H[z]=V[z])):(z.value=[P],n.k&&(V[n.k]=z.value))}else se?(V[z]=b,G(z)&&(H[z]=b)):Me&&(z.value=b,n.k&&(V[n.k]=b))};b?(rt.id=-1,Qo(rt,d)):rt()}}}Md().requestIdleCallback;Md().cancelIdleCallback;const zl=n=>!!n.type.__asyncLoader,zd=n=>n.type.__isKeepAlive;function o1(n,s){h0(n,"a",s)}function i1(n,s){h0(n,"da",s)}function h0(n,s,d=ko){const _=n.__wdc||(n.__wdc=()=>{let x=d;for(;x;){if(x.isDeactivated)return;x=x.parent}return n()});if(Dd(s,_,d),d){let x=d.parent;for(;x&&x.parent;)zd(x.parent.vnode)&&n1(_,s,d,x),x=x.parent}}function n1(n,s,d,_){const x=Dd(s,n,_,!0);sm(()=>{Gp(_[s],x)},d)}function Dd(n,s,d=ko,_=!1){if(d){const x=d[n]||(d[n]=[]),P=s.__weh||(s.__weh=(...b)=>{As();const c=Ou(d),z=Ki(s,d,n,b);return c(),zs(),z});return _?x.unshift(P):x.push(P),P}}const Gn=n=>(s,d=ko)=>{(!ku||n==="sp")&&Dd(n,(..._)=>s(..._),d)},s1=Gn("bm"),Rd=Gn("m"),a1=Gn("bu"),l1=Gn("u"),d0=Gn("bum"),sm=Gn("um"),c1=Gn("sp"),u1=Gn("rtg"),h1=Gn("rtc");function d1(n,s=ko){Dd("ec",n,s)}const f0="components",f1="directives";function p1(n,s){return p0(f0,n,!0,s)||n}const m1=Symbol.for("v-ndc");function g1(n){return p0(f1,n)}function p0(n,s,d=!0,_=!1){const x=vo||ko;if(x){const P=x.type;if(n===f0){const c=ow(P,!1);if(c&&(c===s||c===ji(s)||c===Pd(ji(s))))return P}const b=s_(x[n]||P[n],s)||s_(x.appContext[n],s);return!b&&_?P:b}}function s_(n,s){return n&&(n[s]||n[ji(s)]||n[Pd(ji(s))])}function a_(n,s,d,_){let x;const P=d,b=Bt(n);if(b||Gr(n)){const c=b&&ks(n);let z=!1;c&&(z=!$i(n),n=Ed(n)),x=new Array(n.length);for(let U=0,V=n.length;U<V;U++)x[U]=s(z?jo(n[U]):n[U],U,void 0,P)}else if(typeof n=="number"){x=new Array(n);for(let c=0;c<n;c++)x[c]=s(c+1,c,void 0,P)}else if(Lr(n))if(n[Symbol.iterator])x=Array.from(n,(c,z)=>s(c,z,void 0,P));else{const c=Object.keys(n);x=new Array(c.length);for(let z=0,U=c.length;z<U;z++){const V=c[z];x[z]=s(n[V],V,z,P)}}else x=[];return x}function yd(n,s,d={},_,x){if(vo.ce||vo.parent&&zl(vo.parent)&&vo.parent.ce)return s!=="default"&&(d.name=s),Vo(),Is(No,null,[Eo("slot",d,_)],64);let P=n[s];P&&P._c&&(P._d=!1),Vo();const b=P&&m0(P(d)),c=d.key||b&&b.key,z=Is(No,{key:(c&&!Zn(c)?c:`_${s}`)+""},b||[],b&&n._===1?64:-2);return z.scopeId&&(z.slotScopeIds=[z.scopeId+"-s"]),P&&P._c&&(P._d=!0),z}function m0(n){return n.some(s=>Su(s)?!(s.type===ri||s.type===No&&!m0(s.children)):!0)?n:null}const Ip=n=>n?B0(n)?Od(n):Ip(n.parent):null,pu=Ao(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Ip(n.parent),$root:n=>Ip(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>_0(n),$forceUpdate:n=>n.f||(n.f=()=>{nm(n.update)}),$nextTick:n=>n.n||(n.n=im.bind(n.proxy)),$watch:n=>$1.bind(n)}),up=(n,s)=>n!==Tr&&!n.__isScriptSetup&&dr(n,s),_1={get({_:n},s){if(s==="__v_skip")return!0;const{ctx:d,setupState:_,data:x,props:P,accessCache:b,type:c,appContext:z}=n;let U;if(s[0]!=="$"){const G=b[s];if(G!==void 0)switch(G){case 1:return _[s];case 2:return x[s];case 4:return d[s];case 3:return P[s]}else{if(up(_,s))return b[s]=1,_[s];if(x!==Tr&&dr(x,s))return b[s]=2,x[s];if((U=n.propsOptions[0])&&dr(U,s))return b[s]=3,P[s];if(d!==Tr&&dr(d,s))return b[s]=4,d[s];Ep&&(b[s]=0)}}const V=pu[s];let H,Q;if(V)return s==="$attrs"&&$o(n.attrs,"get",""),V(n);if((H=c.__cssModules)&&(H=H[s]))return H;if(d!==Tr&&dr(d,s))return b[s]=4,d[s];if(Q=z.config.globalProperties,dr(Q,s))return Q[s]},set({_:n},s,d){const{data:_,setupState:x,ctx:P}=n;return up(x,s)?(x[s]=d,!0):_!==Tr&&dr(_,s)?(_[s]=d,!0):dr(n.props,s)||s[0]==="$"&&s.slice(1)in n?!1:(P[s]=d,!0)},has({_:{data:n,setupState:s,accessCache:d,ctx:_,appContext:x,propsOptions:P}},b){let c;return!!d[b]||n!==Tr&&dr(n,b)||up(s,b)||(c=P[0])&&dr(c,b)||dr(_,b)||dr(pu,b)||dr(x.config.globalProperties,b)},defineProperty(n,s,d){return d.get!=null?n._.accessCache[s]=0:dr(d,"value")&&this.set(n,s,d.value,null),Reflect.defineProperty(n,s,d)}};function l_(n){return Bt(n)?n.reduce((s,d)=>(s[d]=null,s),{}):n}let Ep=!0;function y1(n){const s=_0(n),d=n.proxy,_=n.ctx;Ep=!1,s.beforeCreate&&c_(s.beforeCreate,n,"bc");const{data:x,computed:P,methods:b,watch:c,provide:z,inject:U,created:V,beforeMount:H,mounted:Q,beforeUpdate:G,updated:se,activated:Me,deactivated:rt,beforeDestroy:He,beforeUnmount:lt,destroyed:st,unmounted:Te,render:Ye,renderTracked:dt,renderTriggered:_t,errorCaptured:nt,serverPrefetch:Je,expose:bt,inheritAttrs:zt,components:De,directives:Ge,filters:et}=s;if(U&&v1(U,_,null),b)for(const wt in b){const Et=b[wt];Vt(Et)&&(_[wt]=Et.bind(d))}if(x){const wt=x.call(d,d);Lr(wt)&&(n.data=Dl(wt))}if(Ep=!0,P)for(const wt in P){const Et=P[wt],sr=Vt(Et)?Et.bind(d,d):Vt(Et.get)?Et.get.bind(d,d):fn,cr=!Vt(Et)&&Vt(Et.set)?Et.set.bind(d):fn,or=pi({get:sr,set:cr});Object.defineProperty(_,wt,{enumerable:!0,configurable:!0,get:()=>or.value,set:qt=>or.value=qt})}if(c)for(const wt in c)g0(c[wt],_,d,wt);if(z){const wt=Vt(z)?z.call(d):z;Reflect.ownKeys(wt).forEach(Et=>{S1(Et,wt[Et])})}V&&c_(V,n,"c");function ft(wt,Et){Bt(Et)?Et.forEach(sr=>wt(sr.bind(d))):Et&&wt(Et.bind(d))}if(ft(s1,H),ft(Rd,Q),ft(a1,G),ft(l1,se),ft(o1,Me),ft(i1,rt),ft(d1,nt),ft(h1,dt),ft(u1,_t),ft(d0,lt),ft(sm,Te),ft(c1,Je),Bt(bt))if(bt.length){const wt=n.exposed||(n.exposed={});bt.forEach(Et=>{Object.defineProperty(wt,Et,{get:()=>d[Et],set:sr=>d[Et]=sr})})}else n.exposed||(n.exposed={});Ye&&n.render===fn&&(n.render=Ye),zt!=null&&(n.inheritAttrs=zt),De&&(n.components=De),Ge&&(n.directives=Ge),Je&&u0(n)}function v1(n,s,d=fn){Bt(n)&&(n=Ap(n));for(const _ in n){const x=n[_];let P;Lr(x)?"default"in x?P=mu(x.from||_,x.default,!0):P=mu(x.from||_):P=mu(x),to(P)?Object.defineProperty(s,_,{enumerable:!0,configurable:!0,get:()=>P.value,set:b=>P.value=b}):s[_]=P}}function c_(n,s,d){Ki(Bt(n)?n.map(_=>_.bind(s.proxy)):n.bind(s.proxy),s,d)}function g0(n,s,d,_){let x=_.includes(".")?E0(d,_):()=>d[_];if(Gr(n)){const P=s[n];Vt(P)&&Fi(x,P)}else if(Vt(n))Fi(x,n.bind(d));else if(Lr(n))if(Bt(n))n.forEach(P=>g0(P,s,d,_));else{const P=Vt(n.handler)?n.handler.bind(d):s[n.handler];Vt(P)&&Fi(x,P,n)}}function _0(n){const s=n.type,{mixins:d,extends:_}=s,{mixins:x,optionsCache:P,config:{optionMergeStrategies:b}}=n.appContext,c=P.get(s);let z;return c?z=c:!x.length&&!d&&!_?z=s:(z={},x.length&&x.forEach(U=>vd(z,U,b,!0)),vd(z,s,b)),Lr(s)&&P.set(s,z),z}function vd(n,s,d,_=!1){const{mixins:x,extends:P}=s;P&&vd(n,P,d,!0),x&&x.forEach(b=>vd(n,b,d,!0));for(const b in s)if(!(_&&b==="expose")){const c=b1[b]||d&&d[b];n[b]=c?c(n[b],s[b]):s[b]}return n}const b1={data:u_,props:h_,emits:h_,methods:au,computed:au,beforeCreate:Jo,created:Jo,beforeMount:Jo,mounted:Jo,beforeUpdate:Jo,updated:Jo,beforeDestroy:Jo,beforeUnmount:Jo,destroyed:Jo,unmounted:Jo,activated:Jo,deactivated:Jo,errorCaptured:Jo,serverPrefetch:Jo,components:au,directives:au,watch:w1,provide:u_,inject:x1};function u_(n,s){return s?n?function(){return Ao(Vt(n)?n.call(this,this):n,Vt(s)?s.call(this,this):s)}:s:n}function x1(n,s){return au(Ap(n),Ap(s))}function Ap(n){if(Bt(n)){const s={};for(let d=0;d<n.length;d++)s[n[d]]=n[d];return s}return n}function Jo(n,s){return n?[...new Set([].concat(n,s))]:s}function au(n,s){return n?Ao(Object.create(null),n,s):s}function h_(n,s){return n?Bt(n)&&Bt(s)?[...new Set([...n,...s])]:Ao(Object.create(null),l_(n),l_(s??{})):s}function w1(n,s){if(!n)return s;if(!s)return n;const d=Ao(Object.create(null),n);for(const _ in s)d[_]=Jo(n[_],s[_]);return d}function y0(){return{app:null,config:{isNativeTag:ox,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let C1=0;function T1(n,s){return function(_,x=null){Vt(_)||(_=Ao({},_)),x!=null&&!Lr(x)&&(x=null);const P=y0(),b=new WeakSet,c=[];let z=!1;const U=P.app={_uid:C1++,_component:_,_props:x,_container:null,_context:P,_instance:null,version:sw,get config(){return P.config},set config(V){},use(V,...H){return b.has(V)||(V&&Vt(V.install)?(b.add(V),V.install(U,...H)):Vt(V)&&(b.add(V),V(U,...H))),U},mixin(V){return P.mixins.includes(V)||P.mixins.push(V),U},component(V,H){return H?(P.components[V]=H,U):P.components[V]},directive(V,H){return H?(P.directives[V]=H,U):P.directives[V]},mount(V,H,Q){if(!z){const G=U._ceVNode||Eo(_,x);return G.appContext=P,Q===!0?Q="svg":Q===!1&&(Q=void 0),n(G,V,Q),z=!0,U._container=V,V.__vue_app__=U,Od(G.component)}},onUnmount(V){c.push(V)},unmount(){z&&(Ki(c,U._instance,16),n(null,U._container),delete U._container.__vue_app__)},provide(V,H){return P.provides[V]=H,U},runWithContext(V){const H=fa;fa=U;try{return V()}finally{fa=H}}};return U}}let fa=null;function S1(n,s){if(ko){let d=ko.provides;const _=ko.parent&&ko.parent.provides;_===d&&(d=ko.provides=Object.create(_)),d[n]=s}}function mu(n,s,d=!1){const _=ko||vo;if(_||fa){const x=fa?fa._context.provides:_?_.parent==null?_.vnode.appContext&&_.vnode.appContext.provides:_.parent.provides:void 0;if(x&&n in x)return x[n];if(arguments.length>1)return d&&Vt(s)?s.call(_&&_.proxy):s}}function k1(){return!!(ko||vo||fa)}const v0={},b0=()=>Object.create(v0),x0=n=>Object.getPrototypeOf(n)===v0;function P1(n,s,d,_=!1){const x={},P=b0();n.propsDefaults=Object.create(null),w0(n,s,x,P);for(const b in n.propsOptions[0])b in x||(x[b]=void 0);d?n.props=_?x:Bx(x):n.type.props?n.props=x:n.props=P,n.attrs=P}function M1(n,s,d,_){const{props:x,attrs:P,vnode:{patchFlag:b}}=n,c=nr(x),[z]=n.propsOptions;let U=!1;if((_||b>0)&&!(b&16)){if(b&8){const V=n.vnode.dynamicProps;for(let H=0;H<V.length;H++){let Q=V[H];if(Ld(n.emitsOptions,Q))continue;const G=s[Q];if(z)if(dr(P,Q))G!==P[Q]&&(P[Q]=G,U=!0);else{const se=ji(Q);x[se]=zp(z,c,se,G,n,!1)}else G!==P[Q]&&(P[Q]=G,U=!0)}}}else{w0(n,s,x,P)&&(U=!0);let V;for(const H in c)(!s||!dr(s,H)&&((V=ma(H))===H||!dr(s,V)))&&(z?d&&(d[H]!==void 0||d[V]!==void 0)&&(x[H]=zp(z,c,H,void 0,n,!0)):delete x[H]);if(P!==c)for(const H in P)(!s||!dr(s,H))&&(delete P[H],U=!0)}U&&jn(n.attrs,"set","")}function w0(n,s,d,_){const[x,P]=n.propsOptions;let b=!1,c;if(s)for(let z in s){if(uu(z))continue;const U=s[z];let V;x&&dr(x,V=ji(z))?!P||!P.includes(V)?d[V]=U:(c||(c={}))[V]=U:Ld(n.emitsOptions,z)||(!(z in _)||U!==_[z])&&(_[z]=U,b=!0)}if(P){const z=nr(d),U=c||Tr;for(let V=0;V<P.length;V++){const H=P[V];d[H]=zp(x,z,H,U[H],n,!dr(U,H))}}return b}function zp(n,s,d,_,x,P){const b=n[d];if(b!=null){const c=dr(b,"default");if(c&&_===void 0){const z=b.default;if(b.type!==Function&&!b.skipFactory&&Vt(z)){const{propsDefaults:U}=x;if(d in U)_=U[d];else{const V=Ou(x);_=U[d]=z.call(null,s),V()}}else _=z;x.ce&&x.ce._setProp(d,_)}b[0]&&(P&&!c?_=!1:b[1]&&(_===""||_===ma(d))&&(_=!0))}return _}const I1=new WeakMap;function C0(n,s,d=!1){const _=d?I1:s.propsCache,x=_.get(n);if(x)return x;const P=n.props,b={},c=[];let z=!1;if(!Vt(n)){const V=H=>{z=!0;const[Q,G]=C0(H,s,!0);Ao(b,Q),G&&c.push(...G)};!d&&s.mixins.length&&s.mixins.forEach(V),n.extends&&V(n.extends),n.mixins&&n.mixins.forEach(V)}if(!P&&!z)return Lr(n)&&_.set(n,Il),Il;if(Bt(P))for(let V=0;V<P.length;V++){const H=ji(P[V]);d_(H)&&(b[H]=Tr)}else if(P)for(const V in P){const H=ji(V);if(d_(H)){const Q=P[V],G=b[H]=Bt(Q)||Vt(Q)?{type:Q}:Ao({},Q),se=G.type;let Me=!1,rt=!0;if(Bt(se))for(let He=0;He<se.length;++He){const lt=se[He],st=Vt(lt)&&lt.name;if(st==="Boolean"){Me=!0;break}else st==="String"&&(rt=!1)}else Me=Vt(se)&&se.name==="Boolean";G[0]=Me,G[1]=rt,(Me||dr(G,"default"))&&c.push(H)}}const U=[b,c];return Lr(n)&&_.set(n,U),U}function d_(n){return n[0]!=="$"&&!uu(n)}const T0=n=>n[0]==="_"||n==="$stable",am=n=>Bt(n)?n.map(hn):[hn(n)],E1=(n,s,d)=>{if(s._n)return s;const _=gd((...x)=>am(s(...x)),d);return _._c=!1,_},S0=(n,s,d)=>{const _=n._ctx;for(const x in n){if(T0(x))continue;const P=n[x];if(Vt(P))s[x]=E1(x,P,_);else if(P!=null){const b=am(P);s[x]=()=>b}}},k0=(n,s)=>{const d=am(s);n.slots.default=()=>d},P0=(n,s,d)=>{for(const _ in s)(d||_!=="_")&&(n[_]=s[_])},A1=(n,s,d)=>{const _=n.slots=b0();if(n.vnode.shapeFlag&32){const x=s._;x?(P0(_,s,d),d&&Py(_,"_",x,!0)):S0(s,_)}else s&&k0(n,s)},z1=(n,s,d)=>{const{vnode:_,slots:x}=n;let P=!0,b=Tr;if(_.shapeFlag&32){const c=s._;c?d&&c===1?P=!1:P0(x,s,d):(P=!s.$stable,S0(s,x)),b=s}else s&&(k0(n,s),b={default:1});if(P)for(const c in x)!T0(c)&&b[c]==null&&delete x[c]},Qo=q1;function D1(n){return R1(n)}function R1(n,s){const d=Md();d.__VUE__=!0;const{insert:_,remove:x,patchProp:P,createElement:b,createText:c,createComment:z,setText:U,setElementText:V,parentNode:H,nextSibling:Q,setScopeId:G=fn,insertStaticContent:se}=n,Me=(ae,pe,ke,qe=null,Ne=null,Ve=null,it=void 0,ot=null,Qe=!!pe.dynamicChildren)=>{if(ae===pe)return;ae&&!ha(ae,pe)&&(qe=bo(ae),qt(ae,Ne,Ve,!0),ae=null),pe.patchFlag===-2&&(Qe=!1,pe.dynamicChildren=null);const{type:Ue,ref:Pt,shapeFlag:at}=pe;switch(Ue){case Bd:rt(ae,pe,ke,qe);break;case ri:He(ae,pe,ke,qe);break;case dp:ae==null&&lt(pe,ke,qe,it);break;case No:De(ae,pe,ke,qe,Ne,Ve,it,ot,Qe);break;default:at&1?Ye(ae,pe,ke,qe,Ne,Ve,it,ot,Qe):at&6?Ge(ae,pe,ke,qe,Ne,Ve,it,ot,Qe):(at&64||at&128)&&Ue.process(ae,pe,ke,qe,Ne,Ve,it,ot,Qe,Zo)}Pt!=null&&Ne&&_d(Pt,ae&&ae.ref,Ve,pe||ae,!pe)},rt=(ae,pe,ke,qe)=>{if(ae==null)_(pe.el=c(pe.children),ke,qe);else{const Ne=pe.el=ae.el;pe.children!==ae.children&&U(Ne,pe.children)}},He=(ae,pe,ke,qe)=>{ae==null?_(pe.el=z(pe.children||""),ke,qe):pe.el=ae.el},lt=(ae,pe,ke,qe)=>{[ae.el,ae.anchor]=se(ae.children,pe,ke,qe,ae.el,ae.anchor)},st=({el:ae,anchor:pe},ke,qe)=>{let Ne;for(;ae&&ae!==pe;)Ne=Q(ae),_(ae,ke,qe),ae=Ne;_(pe,ke,qe)},Te=({el:ae,anchor:pe})=>{let ke;for(;ae&&ae!==pe;)ke=Q(ae),x(ae),ae=ke;x(pe)},Ye=(ae,pe,ke,qe,Ne,Ve,it,ot,Qe)=>{pe.type==="svg"?it="svg":pe.type==="math"&&(it="mathml"),ae==null?dt(pe,ke,qe,Ne,Ve,it,ot,Qe):Je(ae,pe,Ne,Ve,it,ot,Qe)},dt=(ae,pe,ke,qe,Ne,Ve,it,ot)=>{let Qe,Ue;const{props:Pt,shapeFlag:at,transition:Ct,dirs:Rt}=ae;if(Qe=ae.el=b(ae.type,Ve,Pt&&Pt.is,Pt),at&8?V(Qe,ae.children):at&16&&nt(ae.children,Qe,null,qe,Ne,hp(ae,Ve),it,ot),Rt&&na(ae,null,qe,"created"),_t(Qe,ae,ae.scopeId,it,qe),Pt){for(const Ht in Pt)Ht!=="value"&&!uu(Ht)&&P(Qe,Ht,null,Pt[Ht],Ve,qe);"value"in Pt&&P(Qe,"value",null,Pt.value,Ve),(Ue=Pt.onVnodeBeforeMount)&&cn(Ue,qe,ae)}Rt&&na(ae,null,qe,"beforeMount");const $t=L1(Ne,Ct);$t&&Ct.beforeEnter(Qe),_(Qe,pe,ke),((Ue=Pt&&Pt.onVnodeMounted)||$t||Rt)&&Qo(()=>{Ue&&cn(Ue,qe,ae),$t&&Ct.enter(Qe),Rt&&na(ae,null,qe,"mounted")},Ne)},_t=(ae,pe,ke,qe,Ne)=>{if(ke&&G(ae,ke),qe)for(let Ve=0;Ve<qe.length;Ve++)G(ae,qe[Ve]);if(Ne){let Ve=Ne.subTree;if(pe===Ve||z0(Ve.type)&&(Ve.ssContent===pe||Ve.ssFallback===pe)){const it=Ne.vnode;_t(ae,it,it.scopeId,it.slotScopeIds,Ne.parent)}}},nt=(ae,pe,ke,qe,Ne,Ve,it,ot,Qe=0)=>{for(let Ue=Qe;Ue<ae.length;Ue++){const Pt=ae[Ue]=ot?ws(ae[Ue]):hn(ae[Ue]);Me(null,Pt,pe,ke,qe,Ne,Ve,it,ot)}},Je=(ae,pe,ke,qe,Ne,Ve,it)=>{const ot=pe.el=ae.el;let{patchFlag:Qe,dynamicChildren:Ue,dirs:Pt}=pe;Qe|=ae.patchFlag&16;const at=ae.props||Tr,Ct=pe.props||Tr;let Rt;if(ke&&sa(ke,!1),(Rt=Ct.onVnodeBeforeUpdate)&&cn(Rt,ke,pe,ae),Pt&&na(pe,ae,ke,"beforeUpdate"),ke&&sa(ke,!0),(at.innerHTML&&Ct.innerHTML==null||at.textContent&&Ct.textContent==null)&&V(ot,""),Ue?bt(ae.dynamicChildren,Ue,ot,ke,qe,hp(pe,Ne),Ve):it||Et(ae,pe,ot,null,ke,qe,hp(pe,Ne),Ve,!1),Qe>0){if(Qe&16)zt(ot,at,Ct,ke,Ne);else if(Qe&2&&at.class!==Ct.class&&P(ot,"class",null,Ct.class,Ne),Qe&4&&P(ot,"style",at.style,Ct.style,Ne),Qe&8){const $t=pe.dynamicProps;for(let Ht=0;Ht<$t.length;Ht++){const Ut=$t[Ht],Br=at[Ut],Ir=Ct[Ut];(Ir!==Br||Ut==="value")&&P(ot,Ut,Br,Ir,Ne,ke)}}Qe&1&&ae.children!==pe.children&&V(ot,pe.children)}else!it&&Ue==null&&zt(ot,at,Ct,ke,Ne);((Rt=Ct.onVnodeUpdated)||Pt)&&Qo(()=>{Rt&&cn(Rt,ke,pe,ae),Pt&&na(pe,ae,ke,"updated")},qe)},bt=(ae,pe,ke,qe,Ne,Ve,it)=>{for(let ot=0;ot<pe.length;ot++){const Qe=ae[ot],Ue=pe[ot],Pt=Qe.el&&(Qe.type===No||!ha(Qe,Ue)||Qe.shapeFlag&70)?H(Qe.el):ke;Me(Qe,Ue,Pt,null,qe,Ne,Ve,it,!0)}},zt=(ae,pe,ke,qe,Ne)=>{if(pe!==ke){if(pe!==Tr)for(const Ve in pe)!uu(Ve)&&!(Ve in ke)&&P(ae,Ve,pe[Ve],null,Ne,qe);for(const Ve in ke){if(uu(Ve))continue;const it=ke[Ve],ot=pe[Ve];it!==ot&&Ve!=="value"&&P(ae,Ve,ot,it,Ne,qe)}"value"in ke&&P(ae,"value",pe.value,ke.value,Ne)}},De=(ae,pe,ke,qe,Ne,Ve,it,ot,Qe)=>{const Ue=pe.el=ae?ae.el:c(""),Pt=pe.anchor=ae?ae.anchor:c("");let{patchFlag:at,dynamicChildren:Ct,slotScopeIds:Rt}=pe;Rt&&(ot=ot?ot.concat(Rt):Rt),ae==null?(_(Ue,ke,qe),_(Pt,ke,qe),nt(pe.children||[],ke,Pt,Ne,Ve,it,ot,Qe)):at>0&&at&64&&Ct&&ae.dynamicChildren?(bt(ae.dynamicChildren,Ct,ke,Ne,Ve,it,ot),(pe.key!=null||Ne&&pe===Ne.subTree)&&lm(ae,pe,!0)):Et(ae,pe,ke,Pt,Ne,Ve,it,ot,Qe)},Ge=(ae,pe,ke,qe,Ne,Ve,it,ot,Qe)=>{pe.slotScopeIds=ot,ae==null?pe.shapeFlag&512?Ne.ctx.activate(pe,ke,qe,it,Qe):et(pe,ke,qe,Ne,Ve,it,Qe):Dt(ae,pe,Qe)},et=(ae,pe,ke,qe,Ne,Ve,it)=>{const ot=ae.component=J1(ae,qe,Ne);if(zd(ae)&&(ot.ctx.renderer=Zo),Q1(ot,!1,it),ot.asyncDep){if(Ne&&Ne.registerDep(ot,ft,it),!ae.el){const Qe=ot.subTree=Eo(ri);He(null,Qe,pe,ke)}}else ft(ot,ae,pe,ke,Ne,Ve,it)},Dt=(ae,pe,ke)=>{const qe=pe.component=ae.component;if(Z1(ae,pe,ke))if(qe.asyncDep&&!qe.asyncResolved){wt(qe,pe,ke);return}else qe.next=pe,qe.update();else pe.el=ae.el,qe.vnode=pe},ft=(ae,pe,ke,qe,Ne,Ve,it)=>{const ot=()=>{if(ae.isMounted){let{next:at,bu:Ct,u:Rt,parent:$t,vnode:Ht}=ae;{const ho=M0(ae);if(ho){at&&(at.el=Ht.el,wt(ae,at,it)),ho.asyncDep.then(()=>{ae.isUnmounted||ot()});return}}let Ut=at,Br;sa(ae,!1),at?(at.el=Ht.el,wt(ae,at,it)):at=Ht,Ct&&ip(Ct),(Br=at.props&&at.props.onVnodeBeforeUpdate)&&cn(Br,$t,at,Ht),sa(ae,!0);const Ir=p_(ae),xo=ae.subTree;ae.subTree=Ir,Me(xo,Ir,H(xo.el),bo(xo),ae,Ne,Ve),at.el=Ir.el,Ut===null&&G1(ae,Ir.el),Rt&&Qo(Rt,Ne),(Br=at.props&&at.props.onVnodeUpdated)&&Qo(()=>cn(Br,$t,at,Ht),Ne)}else{let at;const{el:Ct,props:Rt}=pe,{bm:$t,m:Ht,parent:Ut,root:Br,type:Ir}=ae,xo=zl(pe);sa(ae,!1),$t&&ip($t),!xo&&(at=Rt&&Rt.onVnodeBeforeMount)&&cn(at,Ut,pe),sa(ae,!0);{Br.ce&&Br.ce._injectChildStyle(Ir);const ho=ae.subTree=p_(ae);Me(null,ho,ke,qe,ae,Ne,Ve),pe.el=ho.el}if(Ht&&Qo(Ht,Ne),!xo&&(at=Rt&&Rt.onVnodeMounted)){const ho=pe;Qo(()=>cn(at,Ut,ho),Ne)}(pe.shapeFlag&256||Ut&&zl(Ut.vnode)&&Ut.vnode.shapeFlag&256)&&ae.a&&Qo(ae.a,Ne),ae.isMounted=!0,pe=ke=qe=null}};ae.scope.on();const Qe=ae.effect=new Ry(ot);ae.scope.off();const Ue=ae.update=Qe.run.bind(Qe),Pt=ae.job=Qe.runIfDirty.bind(Qe);Pt.i=ae,Pt.id=ae.uid,Qe.scheduler=()=>nm(Pt),sa(ae,!0),Ue()},wt=(ae,pe,ke)=>{pe.component=ae;const qe=ae.vnode.props;ae.vnode=pe,ae.next=null,M1(ae,pe.props,qe,ke),z1(ae,pe.children,ke),As(),t_(ae),zs()},Et=(ae,pe,ke,qe,Ne,Ve,it,ot,Qe=!1)=>{const Ue=ae&&ae.children,Pt=ae?ae.shapeFlag:0,at=pe.children,{patchFlag:Ct,shapeFlag:Rt}=pe;if(Ct>0){if(Ct&128){cr(Ue,at,ke,qe,Ne,Ve,it,ot,Qe);return}else if(Ct&256){sr(Ue,at,ke,qe,Ne,Ve,it,ot,Qe);return}}Rt&8?(Pt&16&&qr(Ue,Ne,Ve),at!==Ue&&V(ke,at)):Pt&16?Rt&16?cr(Ue,at,ke,qe,Ne,Ve,it,ot,Qe):qr(Ue,Ne,Ve,!0):(Pt&8&&V(ke,""),Rt&16&&nt(at,ke,qe,Ne,Ve,it,ot,Qe))},sr=(ae,pe,ke,qe,Ne,Ve,it,ot,Qe)=>{ae=ae||Il,pe=pe||Il;const Ue=ae.length,Pt=pe.length,at=Math.min(Ue,Pt);let Ct;for(Ct=0;Ct<at;Ct++){const Rt=pe[Ct]=Qe?ws(pe[Ct]):hn(pe[Ct]);Me(ae[Ct],Rt,ke,null,Ne,Ve,it,ot,Qe)}Ue>Pt?qr(ae,Ne,Ve,!0,!1,at):nt(pe,ke,qe,Ne,Ve,it,ot,Qe,at)},cr=(ae,pe,ke,qe,Ne,Ve,it,ot,Qe)=>{let Ue=0;const Pt=pe.length;let at=ae.length-1,Ct=Pt-1;for(;Ue<=at&&Ue<=Ct;){const Rt=ae[Ue],$t=pe[Ue]=Qe?ws(pe[Ue]):hn(pe[Ue]);if(ha(Rt,$t))Me(Rt,$t,ke,null,Ne,Ve,it,ot,Qe);else break;Ue++}for(;Ue<=at&&Ue<=Ct;){const Rt=ae[at],$t=pe[Ct]=Qe?ws(pe[Ct]):hn(pe[Ct]);if(ha(Rt,$t))Me(Rt,$t,ke,null,Ne,Ve,it,ot,Qe);else break;at--,Ct--}if(Ue>at){if(Ue<=Ct){const Rt=Ct+1,$t=Rt<Pt?pe[Rt].el:qe;for(;Ue<=Ct;)Me(null,pe[Ue]=Qe?ws(pe[Ue]):hn(pe[Ue]),ke,$t,Ne,Ve,it,ot,Qe),Ue++}}else if(Ue>Ct)for(;Ue<=at;)qt(ae[Ue],Ne,Ve,!0),Ue++;else{const Rt=Ue,$t=Ue,Ht=new Map;for(Ue=$t;Ue<=Ct;Ue++){const ge=pe[Ue]=Qe?ws(pe[Ue]):hn(pe[Ue]);ge.key!=null&&Ht.set(ge.key,Ue)}let Ut,Br=0;const Ir=Ct-$t+1;let xo=!1,ho=0;const _i=new Array(Ir);for(Ue=0;Ue<Ir;Ue++)_i[Ue]=0;for(Ue=Rt;Ue<=at;Ue++){const ge=ae[Ue];if(Br>=Ir){qt(ge,Ne,Ve,!0);continue}let A;if(ge.key!=null)A=Ht.get(ge.key);else for(Ut=$t;Ut<=Ct;Ut++)if(_i[Ut-$t]===0&&ha(ge,pe[Ut])){A=Ut;break}A===void 0?qt(ge,Ne,Ve,!0):(_i[A-$t]=Ue+1,A>=ho?ho=A:xo=!0,Me(ge,pe[A],ke,null,Ne,Ve,it,ot,Qe),Br++)}const oi=xo?B1(_i):Il;for(Ut=oi.length-1,Ue=Ir-1;Ue>=0;Ue--){const ge=$t+Ue,A=pe[ge],Z=ge+1<Pt?pe[ge+1].el:qe;_i[Ue]===0?Me(null,A,ke,Z,Ne,Ve,it,ot,Qe):xo&&(Ut<0||Ue!==oi[Ut]?or(A,ke,Z,2):Ut--)}}},or=(ae,pe,ke,qe,Ne=null)=>{const{el:Ve,type:it,transition:ot,children:Qe,shapeFlag:Ue}=ae;if(Ue&6){or(ae.component.subTree,pe,ke,qe);return}if(Ue&128){ae.suspense.move(pe,ke,qe);return}if(Ue&64){it.move(ae,pe,ke,Zo);return}if(it===No){_(Ve,pe,ke);for(let at=0;at<Qe.length;at++)or(Qe[at],pe,ke,qe);_(ae.anchor,pe,ke);return}if(it===dp){st(ae,pe,ke);return}if(qe!==2&&Ue&1&&ot)if(qe===0)ot.beforeEnter(Ve),_(Ve,pe,ke),Qo(()=>ot.enter(Ve),Ne);else{const{leave:at,delayLeave:Ct,afterLeave:Rt}=ot,$t=()=>_(Ve,pe,ke),Ht=()=>{at(Ve,()=>{$t(),Rt&&Rt()})};Ct?Ct(Ve,$t,Ht):Ht()}else _(Ve,pe,ke)},qt=(ae,pe,ke,qe=!1,Ne=!1)=>{const{type:Ve,props:it,ref:ot,children:Qe,dynamicChildren:Ue,shapeFlag:Pt,patchFlag:at,dirs:Ct,cacheIndex:Rt}=ae;if(at===-2&&(Ne=!1),ot!=null&&_d(ot,null,ke,ae,!0),Rt!=null&&(pe.renderCache[Rt]=void 0),Pt&256){pe.ctx.deactivate(ae);return}const $t=Pt&1&&Ct,Ht=!zl(ae);let Ut;if(Ht&&(Ut=it&&it.onVnodeBeforeUnmount)&&cn(Ut,pe,ae),Pt&6)br(ae.component,ke,qe);else{if(Pt&128){ae.suspense.unmount(ke,qe);return}$t&&na(ae,null,pe,"beforeUnmount"),Pt&64?ae.type.remove(ae,pe,ke,Zo,qe):Ue&&!Ue.hasOnce&&(Ve!==No||at>0&&at&64)?qr(Ue,pe,ke,!1,!0):(Ve===No&&at&384||!Ne&&Pt&16)&&qr(Qe,pe,ke),qe&&Sr(ae)}(Ht&&(Ut=it&&it.onVnodeUnmounted)||$t)&&Qo(()=>{Ut&&cn(Ut,pe,ae),$t&&na(ae,null,pe,"unmounted")},ke)},Sr=ae=>{const{type:pe,el:ke,anchor:qe,transition:Ne}=ae;if(pe===No){Mr(ke,qe);return}if(pe===dp){Te(ae);return}const Ve=()=>{x(ke),Ne&&!Ne.persisted&&Ne.afterLeave&&Ne.afterLeave()};if(ae.shapeFlag&1&&Ne&&!Ne.persisted){const{leave:it,delayLeave:ot}=Ne,Qe=()=>it(ke,Ve);ot?ot(ae.el,Ve,Qe):Qe()}else Ve()},Mr=(ae,pe)=>{let ke;for(;ae!==pe;)ke=Q(ae),x(ae),ae=ke;x(pe)},br=(ae,pe,ke)=>{const{bum:qe,scope:Ne,job:Ve,subTree:it,um:ot,m:Qe,a:Ue}=ae;f_(Qe),f_(Ue),qe&&ip(qe),Ne.stop(),Ve&&(Ve.flags|=8,qt(it,ae,pe,ke)),ot&&Qo(ot,pe),Qo(()=>{ae.isUnmounted=!0},pe),pe&&pe.pendingBranch&&!pe.isUnmounted&&ae.asyncDep&&!ae.asyncResolved&&ae.suspenseId===pe.pendingId&&(pe.deps--,pe.deps===0&&pe.resolve())},qr=(ae,pe,ke,qe=!1,Ne=!1,Ve=0)=>{for(let it=Ve;it<ae.length;it++)qt(ae[it],pe,ke,qe,Ne)},bo=ae=>{if(ae.shapeFlag&6)return bo(ae.component.subTree);if(ae.shapeFlag&128)return ae.suspense.next();const pe=Q(ae.anchor||ae.el),ke=pe&&pe[t0];return ke?Q(ke):pe};let Uo=!1;const ro=(ae,pe,ke)=>{ae==null?pe._vnode&&qt(pe._vnode,null,null,!0):Me(pe._vnode||null,ae,pe,null,null,null,ke),pe._vnode=ae,Uo||(Uo=!0,t_(),Jy(),Uo=!1)},Zo={p:Me,um:qt,m:or,r:Sr,mt:et,mc:nt,pc:Et,pbc:bt,n:bo,o:n};return{render:ro,hydrate:void 0,createApp:T1(ro)}}function hp({type:n,props:s},d){return d==="svg"&&n==="foreignObject"||d==="mathml"&&n==="annotation-xml"&&s&&s.encoding&&s.encoding.includes("html")?void 0:d}function sa({effect:n,job:s},d){d?(n.flags|=32,s.flags|=4):(n.flags&=-33,s.flags&=-5)}function L1(n,s){return(!n||n&&!n.pendingBranch)&&s&&!s.persisted}function lm(n,s,d=!1){const _=n.children,x=s.children;if(Bt(_)&&Bt(x))for(let P=0;P<_.length;P++){const b=_[P];let c=x[P];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=x[P]=ws(x[P]),c.el=b.el),!d&&c.patchFlag!==-2&&lm(b,c)),c.type===Bd&&(c.el=b.el)}}function B1(n){const s=n.slice(),d=[0];let _,x,P,b,c;const z=n.length;for(_=0;_<z;_++){const U=n[_];if(U!==0){if(x=d[d.length-1],n[x]<U){s[_]=x,d.push(_);continue}for(P=0,b=d.length-1;P<b;)c=P+b>>1,n[d[c]]<U?P=c+1:b=c;U<n[d[P]]&&(P>0&&(s[_]=d[P-1]),d[P]=_)}}for(P=d.length,b=d[P-1];P-- >0;)d[P]=b,b=s[b];return d}function M0(n){const s=n.subTree.component;if(s)return s.asyncDep&&!s.asyncResolved?s:M0(s)}function f_(n){if(n)for(let s=0;s<n.length;s++)n[s].flags|=8}const F1=Symbol.for("v-scx"),O1=()=>mu(F1);function Fi(n,s,d){return I0(n,s,d)}function I0(n,s,d=Tr){const{immediate:_,deep:x,flush:P,once:b}=d,c=Ao({},d),z=s&&_||!s&&P!=="post";let U;if(ku){if(P==="sync"){const G=O1();U=G.__watcherHandles||(G.__watcherHandles=[])}else if(!z){const G=()=>{};return G.stop=fn,G.resume=fn,G.pause=fn,G}}const V=ko;c.call=(G,se,Me)=>Ki(G,V,se,Me);let H=!1;P==="post"?c.scheduler=G=>{Qo(G,V&&V.suspense)}:P!=="sync"&&(H=!0,c.scheduler=(G,se)=>{se?G():nm(G)}),c.augmentJob=G=>{s&&(G.flags|=4),H&&(G.flags|=2,V&&(G.id=V.uid,G.i=V))};const Q=qx(n,s,c);return ku&&(U?U.push(Q):z&&Q()),Q}function $1(n,s,d){const _=this.proxy,x=Gr(n)?n.includes(".")?E0(_,n):()=>_[n]:n.bind(_,_);let P;Vt(s)?P=s:(P=s.handler,d=s);const b=Ou(this),c=I0(x,P.bind(_),d);return b(),c}function E0(n,s){const d=s.split(".");return()=>{let _=n;for(let x=0;x<d.length&&_;x++)_=_[d[x]];return _}}const j1=(n,s)=>s==="modelValue"||s==="model-value"?n.modelModifiers:n[`${s}Modifiers`]||n[`${ji(s)}Modifiers`]||n[`${ma(s)}Modifiers`];function N1(n,s,...d){if(n.isUnmounted)return;const _=n.vnode.props||Tr;let x=d;const P=s.startsWith("update:"),b=P&&j1(_,s.slice(7));b&&(b.trim&&(x=d.map(V=>Gr(V)?V.trim():V)),b.number&&(x=d.map(lx)));let c,z=_[c=op(s)]||_[c=op(ji(s))];!z&&P&&(z=_[c=op(ma(s))]),z&&Ki(z,n,6,x);const U=_[c+"Once"];if(U){if(!n.emitted)n.emitted={};else if(n.emitted[c])return;n.emitted[c]=!0,Ki(U,n,6,x)}}function A0(n,s,d=!1){const _=s.emitsCache,x=_.get(n);if(x!==void 0)return x;const P=n.emits;let b={},c=!1;if(!Vt(n)){const z=U=>{const V=A0(U,s,!0);V&&(c=!0,Ao(b,V))};!d&&s.mixins.length&&s.mixins.forEach(z),n.extends&&z(n.extends),n.mixins&&n.mixins.forEach(z)}return!P&&!c?(Lr(n)&&_.set(n,null),null):(Bt(P)?P.forEach(z=>b[z]=null):Ao(b,P),Lr(n)&&_.set(n,b),b)}function Ld(n,s){return!n||!Td(s)?!1:(s=s.slice(2).replace(/Once$/,""),dr(n,s[0].toLowerCase()+s.slice(1))||dr(n,ma(s))||dr(n,s))}function p_(n){const{type:s,vnode:d,proxy:_,withProxy:x,propsOptions:[P],slots:b,attrs:c,emit:z,render:U,renderCache:V,props:H,data:Q,setupState:G,ctx:se,inheritAttrs:Me}=n,rt=md(n);let He,lt;try{if(d.shapeFlag&4){const Te=x||_,Ye=Te;He=hn(U.call(Ye,Te,V,H,G,Q,se)),lt=c}else{const Te=s;He=hn(Te.length>1?Te(H,{attrs:c,slots:b,emit:z}):Te(H,null)),lt=s.props?c:V1(c)}}catch(Te){gu.length=0,Ad(Te,n,1),He=Eo(ri)}let st=He;if(lt&&Me!==!1){const Te=Object.keys(lt),{shapeFlag:Ye}=st;Te.length&&Ye&7&&(P&&Te.some(Zp)&&(lt=U1(lt,P)),st=Es(st,lt,!1,!0))}return d.dirs&&(st=Es(st,null,!1,!0),st.dirs=st.dirs?st.dirs.concat(d.dirs):d.dirs),d.transition&&Cu(st,d.transition),He=st,md(rt),He}const V1=n=>{let s;for(const d in n)(d==="class"||d==="style"||Td(d))&&((s||(s={}))[d]=n[d]);return s},U1=(n,s)=>{const d={};for(const _ in n)(!Zp(_)||!(_.slice(9)in s))&&(d[_]=n[_]);return d};function Z1(n,s,d){const{props:_,children:x,component:P}=n,{props:b,children:c,patchFlag:z}=s,U=P.emitsOptions;if(s.dirs||s.transition)return!0;if(d&&z>=0){if(z&1024)return!0;if(z&16)return _?m_(_,b,U):!!b;if(z&8){const V=s.dynamicProps;for(let H=0;H<V.length;H++){const Q=V[H];if(b[Q]!==_[Q]&&!Ld(U,Q))return!0}}}else return(x||c)&&(!c||!c.$stable)?!0:_===b?!1:_?b?m_(_,b,U):!0:!!b;return!1}function m_(n,s,d){const _=Object.keys(s);if(_.length!==Object.keys(n).length)return!0;for(let x=0;x<_.length;x++){const P=_[x];if(s[P]!==n[P]&&!Ld(d,P))return!0}return!1}function G1({vnode:n,parent:s},d){for(;s;){const _=s.subTree;if(_.suspense&&_.suspense.activeBranch===n&&(_.el=n.el),_===n)(n=s.vnode).el=d,s=s.parent;else break}}const z0=n=>n.__isSuspense;function q1(n,s){s&&s.pendingBranch?Bt(n)?s.effects.push(...n):s.effects.push(n):Xx(n)}const No=Symbol.for("v-fgt"),Bd=Symbol.for("v-txt"),ri=Symbol.for("v-cmt"),dp=Symbol.for("v-stc"),gu=[];let Pi=null;function Vo(n=!1){gu.push(Pi=n?null:[])}function W1(){gu.pop(),Pi=gu[gu.length-1]||null}let Tu=1;function g_(n,s=!1){Tu+=n,n<0&&Pi&&s&&(Pi.hasOnce=!0)}function D0(n){return n.dynamicChildren=Tu>0?Pi||Il:null,W1(),Tu>0&&Pi&&Pi.push(n),n}function Ps(n,s,d,_,x,P){return D0(yo(n,s,d,_,x,P,!0))}function Is(n,s,d,_,x){return D0(Eo(n,s,d,_,x,!0))}function Su(n){return n?n.__v_isVNode===!0:!1}function ha(n,s){return n.type===s.type&&n.key===s.key}const R0=({key:n})=>n??null,cd=({ref:n,ref_key:s,ref_for:d})=>(typeof n=="number"&&(n=""+n),n!=null?Gr(n)||to(n)||Vt(n)?{i:vo,r:n,k:s,f:!!d}:n:null);function yo(n,s=null,d=null,_=0,x=null,P=n===No?0:1,b=!1,c=!1){const z={__v_isVNode:!0,__v_skip:!0,type:n,props:s,key:s&&R0(s),ref:s&&cd(s),scopeId:e0,slotScopeIds:null,children:d,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:P,patchFlag:_,dynamicProps:x,dynamicChildren:null,appContext:null,ctx:vo};return c?(cm(z,d),P&128&&n.normalize(z)):d&&(z.shapeFlag|=Gr(d)?8:16),Tu>0&&!b&&Pi&&(z.patchFlag>0||P&6)&&z.patchFlag!==32&&Pi.push(z),z}const Eo=H1;function H1(n,s=null,d=null,_=0,x=null,P=!1){if((!n||n===m1)&&(n=ri),Su(n)){const c=Es(n,s,!0);return d&&cm(c,d),Tu>0&&!P&&Pi&&(c.shapeFlag&6?Pi[Pi.indexOf(n)]=c:Pi.push(c)),c.patchFlag=-2,c}if(iw(n)&&(n=n.__vccOpts),s){s=X1(s);let{class:c,style:z}=s;c&&!Gr(c)&&(s.class=Id(c)),Lr(z)&&(rm(z)&&!Bt(z)&&(z=Ao({},z)),s.style=Wp(z))}const b=Gr(n)?1:z0(n)?128:r0(n)?64:Lr(n)?4:Vt(n)?2:0;return yo(n,s,d,_,x,b,P,!0)}function X1(n){return n?rm(n)||x0(n)?Ao({},n):n:null}function Es(n,s,d=!1,_=!1){const{props:x,ref:P,patchFlag:b,children:c,transition:z}=n,U=s?Ms(x||{},s):x,V={__v_isVNode:!0,__v_skip:!0,type:n.type,props:U,key:U&&R0(U),ref:s&&s.ref?d&&P?Bt(P)?P.concat(cd(s)):[P,cd(s)]:cd(s):P,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:c,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:s&&n.type!==No?b===-1?16:b|16:b,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:z,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Es(n.ssContent),ssFallback:n.ssFallback&&Es(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return z&&_&&Cu(V,z.clone(V)),V}function L0(n=" ",s=0){return Eo(Bd,null,n,s)}function Fd(n="",s=!1){return s?(Vo(),Is(ri,null,n)):Eo(ri,null,n)}function hn(n){return n==null||typeof n=="boolean"?Eo(ri):Bt(n)?Eo(No,null,n.slice()):Su(n)?ws(n):Eo(Bd,null,String(n))}function ws(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Es(n)}function cm(n,s){let d=0;const{shapeFlag:_}=n;if(s==null)s=null;else if(Bt(s))d=16;else if(typeof s=="object")if(_&65){const x=s.default;x&&(x._c&&(x._d=!1),cm(n,x()),x._c&&(x._d=!0));return}else{d=32;const x=s._;!x&&!x0(s)?s._ctx=vo:x===3&&vo&&(vo.slots._===1?s._=1:(s._=2,n.patchFlag|=1024))}else Vt(s)?(s={default:s,_ctx:vo},d=32):(s=String(s),_&64?(d=16,s=[L0(s)]):d=8);n.children=s,n.shapeFlag|=d}function Ms(...n){const s={};for(let d=0;d<n.length;d++){const _=n[d];for(const x in _)if(x==="class")s.class!==_.class&&(s.class=Id([s.class,_.class]));else if(x==="style")s.style=Wp([s.style,_.style]);else if(Td(x)){const P=s[x],b=_[x];b&&P!==b&&!(Bt(P)&&P.includes(b))&&(s[x]=P?[].concat(P,b):b)}else x!==""&&(s[x]=_[x])}return s}function cn(n,s,d,_=null){Ki(n,s,7,[d,_])}const Y1=y0();let K1=0;function J1(n,s,d){const _=n.type,x=(s?s.appContext:n.appContext)||Y1,P={uid:K1++,vnode:n,type:_,parent:s,appContext:x,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Ay(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:s?s.provides:Object.create(x.provides),ids:s?s.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:C0(_,x),emitsOptions:A0(_,x),emit:null,emitted:null,propsDefaults:Tr,inheritAttrs:_.inheritAttrs,ctx:Tr,data:Tr,props:Tr,attrs:Tr,slots:Tr,refs:Tr,setupState:Tr,setupContext:null,suspense:d,suspenseId:d?d.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return P.ctx={_:P},P.root=s?s.root:P,P.emit=N1.bind(null,P),n.ce&&n.ce(P),P}let ko=null;const um=()=>ko||vo;let bd,Dp;{const n=Md(),s=(d,_)=>{let x;return(x=n[d])||(x=n[d]=[]),x.push(_),P=>{x.length>1?x.forEach(b=>b(P)):x[0](P)}};bd=s("__VUE_INSTANCE_SETTERS__",d=>ko=d),Dp=s("__VUE_SSR_SETTERS__",d=>ku=d)}const Ou=n=>{const s=ko;return bd(n),n.scope.on(),()=>{n.scope.off(),bd(s)}},__=()=>{ko&&ko.scope.off(),bd(null)};function B0(n){return n.vnode.shapeFlag&4}let ku=!1;function Q1(n,s=!1,d=!1){s&&Dp(s);const{props:_,children:x}=n.vnode,P=B0(n);P1(n,_,P,s),A1(n,x,d);const b=P?ew(n,s):void 0;return s&&Dp(!1),b}function ew(n,s){const d=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,_1);const{setup:_}=d;if(_){As();const x=n.setupContext=_.length>1?rw(n):null,P=Ou(n),b=Fu(_,n,0,[n.props,x]),c=Ty(b);if(zs(),P(),(c||n.sp)&&!zl(n)&&u0(n),c){if(b.then(__,__),s)return b.then(z=>{y_(n,z)}).catch(z=>{Ad(z,n,0)});n.asyncDep=b}else y_(n,b)}else F0(n)}function y_(n,s,d){Vt(s)?n.type.__ssrInlineRender?n.ssrRender=s:n.render=s:Lr(s)&&(n.setupState=Xy(s)),F0(n)}function F0(n,s,d){const _=n.type;n.render||(n.render=_.render||fn);{const x=Ou(n);As();try{y1(n)}finally{zs(),x()}}}const tw={get(n,s){return $o(n,"get",""),n[s]}};function rw(n){const s=d=>{n.exposed=d||{}};return{attrs:new Proxy(n.attrs,tw),slots:n.slots,emit:n.emit,expose:s}}function Od(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Xy(om(n.exposed)),{get(s,d){if(d in s)return s[d];if(d in pu)return pu[d](n)},has(s,d){return d in s||d in pu}})):n.proxy}function ow(n,s=!0){return Vt(n)?n.displayName||n.name:n.name||s&&n.__name}function iw(n){return Vt(n)&&"__vccOpts"in n}const pi=(n,s)=>Zx(n,s,ku);function nw(n,s,d){const _=arguments.length;return _===2?Lr(s)&&!Bt(s)?Su(s)?Eo(n,null,[s]):Eo(n,s):Eo(n,null,s):(_>3?d=Array.prototype.slice.call(arguments,2):_===3&&Su(d)&&(d=[d]),Eo(n,s,d))}const sw="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Rp;const v_=typeof window<"u"&&window.trustedTypes;if(v_)try{Rp=v_.createPolicy("vue",{createHTML:n=>n})}catch{}const O0=Rp?n=>Rp.createHTML(n):n=>n,aw="http://www.w3.org/2000/svg",lw="http://www.w3.org/1998/Math/MathML",$n=typeof document<"u"?document:null,b_=$n&&$n.createElement("template"),cw={insert:(n,s,d)=>{s.insertBefore(n,d||null)},remove:n=>{const s=n.parentNode;s&&s.removeChild(n)},createElement:(n,s,d,_)=>{const x=s==="svg"?$n.createElementNS(aw,n):s==="mathml"?$n.createElementNS(lw,n):d?$n.createElement(n,{is:d}):$n.createElement(n);return n==="select"&&_&&_.multiple!=null&&x.setAttribute("multiple",_.multiple),x},createText:n=>$n.createTextNode(n),createComment:n=>$n.createComment(n),setText:(n,s)=>{n.nodeValue=s},setElementText:(n,s)=>{n.textContent=s},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>$n.querySelector(n),setScopeId(n,s){n.setAttribute(s,"")},insertStaticContent(n,s,d,_,x,P){const b=d?d.previousSibling:s.lastChild;if(x&&(x===P||x.nextSibling))for(;s.insertBefore(x.cloneNode(!0),d),!(x===P||!(x=x.nextSibling)););else{b_.innerHTML=O0(_==="svg"?`<svg>${n}</svg>`:_==="mathml"?`<math>${n}</math>`:n);const c=b_.content;if(_==="svg"||_==="mathml"){const z=c.firstChild;for(;z.firstChild;)c.appendChild(z.firstChild);c.removeChild(z)}s.insertBefore(c,d)}return[b?b.nextSibling:s.firstChild,d?d.previousSibling:s.lastChild]}},_s="transition",tu="animation",Pu=Symbol("_vtc"),$0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},uw=Ao({},n0,$0),hw=n=>(n.displayName="Transition",n.props=uw,n),dw=hw((n,{slots:s})=>nw(t1,fw(n),s)),aa=(n,s=[])=>{Bt(n)?n.forEach(d=>d(...s)):n&&n(...s)},x_=n=>n?Bt(n)?n.some(s=>s.length>1):n.length>1:!1;function fw(n){const s={};for(const De in n)De in $0||(s[De]=n[De]);if(n.css===!1)return s;const{name:d="v",type:_,duration:x,enterFromClass:P=`${d}-enter-from`,enterActiveClass:b=`${d}-enter-active`,enterToClass:c=`${d}-enter-to`,appearFromClass:z=P,appearActiveClass:U=b,appearToClass:V=c,leaveFromClass:H=`${d}-leave-from`,leaveActiveClass:Q=`${d}-leave-active`,leaveToClass:G=`${d}-leave-to`}=n,se=pw(x),Me=se&&se[0],rt=se&&se[1],{onBeforeEnter:He,onEnter:lt,onEnterCancelled:st,onLeave:Te,onLeaveCancelled:Ye,onBeforeAppear:dt=He,onAppear:_t=lt,onAppearCancelled:nt=st}=s,Je=(De,Ge,et,Dt)=>{De._enterCancelled=Dt,la(De,Ge?V:c),la(De,Ge?U:b),et&&et()},bt=(De,Ge)=>{De._isLeaving=!1,la(De,H),la(De,G),la(De,Q),Ge&&Ge()},zt=De=>(Ge,et)=>{const Dt=De?_t:lt,ft=()=>Je(Ge,De,et);aa(Dt,[Ge,ft]),w_(()=>{la(Ge,De?z:P),Fn(Ge,De?V:c),x_(Dt)||C_(Ge,_,Me,ft)})};return Ao(s,{onBeforeEnter(De){aa(He,[De]),Fn(De,P),Fn(De,b)},onBeforeAppear(De){aa(dt,[De]),Fn(De,z),Fn(De,U)},onEnter:zt(!1),onAppear:zt(!0),onLeave(De,Ge){De._isLeaving=!0;const et=()=>bt(De,Ge);Fn(De,H),De._enterCancelled?(Fn(De,Q),k_()):(k_(),Fn(De,Q)),w_(()=>{De._isLeaving&&(la(De,H),Fn(De,G),x_(Te)||C_(De,_,rt,et))}),aa(Te,[De,et])},onEnterCancelled(De){Je(De,!1,void 0,!0),aa(st,[De])},onAppearCancelled(De){Je(De,!0,void 0,!0),aa(nt,[De])},onLeaveCancelled(De){bt(De),aa(Ye,[De])}})}function pw(n){if(n==null)return null;if(Lr(n))return[fp(n.enter),fp(n.leave)];{const s=fp(n);return[s,s]}}function fp(n){return cx(n)}function Fn(n,s){s.split(/\s+/).forEach(d=>d&&n.classList.add(d)),(n[Pu]||(n[Pu]=new Set)).add(s)}function la(n,s){s.split(/\s+/).forEach(_=>_&&n.classList.remove(_));const d=n[Pu];d&&(d.delete(s),d.size||(n[Pu]=void 0))}function w_(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let mw=0;function C_(n,s,d,_){const x=n._endId=++mw,P=()=>{x===n._endId&&_()};if(d!=null)return setTimeout(P,d);const{type:b,timeout:c,propCount:z}=gw(n,s);if(!b)return _();const U=b+"end";let V=0;const H=()=>{n.removeEventListener(U,Q),P()},Q=G=>{G.target===n&&++V>=z&&H()};setTimeout(()=>{V<z&&H()},c+1),n.addEventListener(U,Q)}function gw(n,s){const d=window.getComputedStyle(n),_=se=>(d[se]||"").split(", "),x=_(`${_s}Delay`),P=_(`${_s}Duration`),b=T_(x,P),c=_(`${tu}Delay`),z=_(`${tu}Duration`),U=T_(c,z);let V=null,H=0,Q=0;s===_s?b>0&&(V=_s,H=b,Q=P.length):s===tu?U>0&&(V=tu,H=U,Q=z.length):(H=Math.max(b,U),V=H>0?b>U?_s:tu:null,Q=V?V===_s?P.length:z.length:0);const G=V===_s&&/\b(transform|all)(,|$)/.test(_(`${_s}Property`).toString());return{type:V,timeout:H,propCount:Q,hasTransform:G}}function T_(n,s){for(;n.length<s.length;)n=n.concat(n);return Math.max(...s.map((d,_)=>S_(d)+S_(n[_])))}function S_(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function k_(){return document.body.offsetHeight}function _w(n,s,d){const _=n[Pu];_&&(s=(s?[s,..._]:[..._]).join(" ")),s==null?n.removeAttribute("class"):d?n.setAttribute("class",s):n.className=s}const P_=Symbol("_vod"),yw=Symbol("_vsh"),vw=Symbol(""),bw=/(^|;)\s*display\s*:/;function xw(n,s,d){const _=n.style,x=Gr(d);let P=!1;if(d&&!x){if(s)if(Gr(s))for(const b of s.split(";")){const c=b.slice(0,b.indexOf(":")).trim();d[c]==null&&ud(_,c,"")}else for(const b in s)d[b]==null&&ud(_,b,"");for(const b in d)b==="display"&&(P=!0),ud(_,b,d[b])}else if(x){if(s!==d){const b=_[vw];b&&(d+=";"+b),_.cssText=d,P=bw.test(d)}}else s&&n.removeAttribute("style");P_ in n&&(n[P_]=P?_.display:"",n[yw]&&(_.display="none"))}const M_=/\s*!important$/;function ud(n,s,d){if(Bt(d))d.forEach(_=>ud(n,s,_));else if(d==null&&(d=""),s.startsWith("--"))n.setProperty(s,d);else{const _=ww(n,s);M_.test(d)?n.setProperty(ma(_),d.replace(M_,""),"important"):n[_]=d}}const I_=["Webkit","Moz","ms"],pp={};function ww(n,s){const d=pp[s];if(d)return d;let _=ji(s);if(_!=="filter"&&_ in n)return pp[s]=_;_=Pd(_);for(let x=0;x<I_.length;x++){const P=I_[x]+_;if(P in n)return pp[s]=P}return s}const E_="http://www.w3.org/1999/xlink";function A_(n,s,d,_,x,P=mx(s)){_&&s.startsWith("xlink:")?d==null?n.removeAttributeNS(E_,s.slice(6,s.length)):n.setAttributeNS(E_,s,d):d==null||P&&!My(d)?n.removeAttribute(s):n.setAttribute(s,P?"":Zn(d)?String(d):d)}function z_(n,s,d,_,x){if(s==="innerHTML"||s==="textContent"){d!=null&&(n[s]=s==="innerHTML"?O0(d):d);return}const P=n.tagName;if(s==="value"&&P!=="PROGRESS"&&!P.includes("-")){const c=P==="OPTION"?n.getAttribute("value")||"":n.value,z=d==null?n.type==="checkbox"?"on":"":String(d);(c!==z||!("_value"in n))&&(n.value=z),d==null&&n.removeAttribute(s),n._value=d;return}let b=!1;if(d===""||d==null){const c=typeof n[s];c==="boolean"?d=My(d):d==null&&c==="string"?(d="",b=!0):c==="number"&&(d=0,b=!0)}try{n[s]=d}catch{}b&&n.removeAttribute(x||s)}function Cw(n,s,d,_){n.addEventListener(s,d,_)}function Tw(n,s,d,_){n.removeEventListener(s,d,_)}const D_=Symbol("_vei");function Sw(n,s,d,_,x=null){const P=n[D_]||(n[D_]={}),b=P[s];if(_&&b)b.value=_;else{const[c,z]=kw(s);if(_){const U=P[s]=Iw(_,x);Cw(n,c,U,z)}else b&&(Tw(n,c,b,z),P[s]=void 0)}}const R_=/(?:Once|Passive|Capture)$/;function kw(n){let s;if(R_.test(n)){s={};let _;for(;_=n.match(R_);)n=n.slice(0,n.length-_[0].length),s[_[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):ma(n.slice(2)),s]}let mp=0;const Pw=Promise.resolve(),Mw=()=>mp||(Pw.then(()=>mp=0),mp=Date.now());function Iw(n,s){const d=_=>{if(!_._vts)_._vts=Date.now();else if(_._vts<=d.attached)return;Ki(Ew(_,d.value),s,5,[_])};return d.value=n,d.attached=Mw(),d}function Ew(n,s){if(Bt(s)){const d=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{d.call(n),n._stopped=!0},s.map(_=>x=>!x._stopped&&_&&_(x))}else return s}const L_=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,Aw=(n,s,d,_,x,P)=>{const b=x==="svg";s==="class"?_w(n,_,b):s==="style"?xw(n,d,_):Td(s)?Zp(s)||Sw(n,s,d,_,P):(s[0]==="."?(s=s.slice(1),!0):s[0]==="^"?(s=s.slice(1),!1):zw(n,s,_,b))?(z_(n,s,_),!n.tagName.includes("-")&&(s==="value"||s==="checked"||s==="selected")&&A_(n,s,_,b,P,s!=="value")):n._isVueCE&&(/[A-Z]/.test(s)||!Gr(_))?z_(n,ji(s),_,P,s):(s==="true-value"?n._trueValue=_:s==="false-value"&&(n._falseValue=_),A_(n,s,_,b))};function zw(n,s,d,_){if(_)return!!(s==="innerHTML"||s==="textContent"||s in n&&L_(s)&&Vt(d));if(s==="spellcheck"||s==="draggable"||s==="translate"||s==="form"||s==="list"&&n.tagName==="INPUT"||s==="type"&&n.tagName==="TEXTAREA")return!1;if(s==="width"||s==="height"){const x=n.tagName;if(x==="IMG"||x==="VIDEO"||x==="CANVAS"||x==="SOURCE")return!1}return L_(s)&&Gr(d)?!1:s in n}const Dw=Ao({patchProp:Aw},cw);let B_;function Rw(){return B_||(B_=D1(Dw))}const Lw=(...n)=>{const s=Rw().createApp(...n),{mount:d}=s;return s.mount=_=>{const x=Fw(_);if(!x)return;const P=s._component;!Vt(P)&&!P.render&&!P.template&&(P.template=x.innerHTML),x.nodeType===1&&(x.textContent="");const b=d(x,!1,Bw(x));return x instanceof Element&&(x.removeAttribute("v-cloak"),x.setAttribute("data-v-app","")),b},s};function Bw(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function Fw(n){return Gr(n)?document.querySelector(n):n}/*!
 * pinia v3.0.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let j0;const $d=n=>j0=n,N0=Symbol();function Lp(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var _u;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(_u||(_u={}));function Ow(){const n=zy(!0),s=n.run(()=>Mi({}));let d=[],_=[];const x=om({install(P){$d(x),x._a=P,P.provide(N0,x),P.config.globalProperties.$pinia=x,_.forEach(b=>d.push(b)),_=[]},use(P){return this._a?d.push(P):_.push(P),this},_p:d,_a:null,_e:n,_s:new Map,state:s});return x}const V0=()=>{};function F_(n,s,d,_=V0){n.push(s);const x=()=>{const P=n.indexOf(s);P>-1&&(n.splice(P,1),_())};return!d&&Dy()&&gx(x),x}function Tl(n,...s){n.slice().forEach(d=>{d(...s)})}const $w=n=>n(),O_=Symbol(),gp=Symbol();function Bp(n,s){n instanceof Map&&s instanceof Map?s.forEach((d,_)=>n.set(_,d)):n instanceof Set&&s instanceof Set&&s.forEach(n.add,n);for(const d in s){if(!s.hasOwnProperty(d))continue;const _=s[d],x=n[d];Lp(x)&&Lp(_)&&n.hasOwnProperty(d)&&!to(_)&&!ks(_)?n[d]=Bp(x,_):n[d]=_}return n}const jw=Symbol();function Nw(n){return!Lp(n)||!n.hasOwnProperty(jw)}const{assign:vs}=Object;function Vw(n){return!!(to(n)&&n.effect)}function Uw(n,s,d,_){const{state:x,actions:P,getters:b}=s,c=d.state.value[n];let z;function U(){c||(d.state.value[n]=x?x():{});const V=jx(d.state.value[n]);return vs(V,P,Object.keys(b||{}).reduce((H,Q)=>(H[Q]=om(pi(()=>{$d(d);const G=d._s.get(n);return b[Q].call(G,G)})),H),{}))}return z=U0(n,U,s,d,_,!0),z}function U0(n,s,d={},_,x,P){let b;const c=vs({actions:{}},d),z={deep:!0};let U,V,H=[],Q=[],G;const se=_.state.value[n];!P&&!se&&(_.state.value[n]={}),Mi({});let Me;function rt(nt){let Je;U=V=!1,typeof nt=="function"?(nt(_.state.value[n]),Je={type:_u.patchFunction,storeId:n,events:G}):(Bp(_.state.value[n],nt),Je={type:_u.patchObject,payload:nt,storeId:n,events:G});const bt=Me=Symbol();im().then(()=>{Me===bt&&(U=!0)}),V=!0,Tl(H,Je,_.state.value[n])}const He=P?function(){const{state:Je}=d,bt=Je?Je():{};this.$patch(zt=>{vs(zt,bt)})}:V0;function lt(){b.stop(),H=[],Q=[],_._s.delete(n)}const st=(nt,Je="")=>{if(O_ in nt)return nt[gp]=Je,nt;const bt=function(){$d(_);const zt=Array.from(arguments),De=[],Ge=[];function et(wt){De.push(wt)}function Dt(wt){Ge.push(wt)}Tl(Q,{args:zt,name:bt[gp],store:Ye,after:et,onError:Dt});let ft;try{ft=nt.apply(this&&this.$id===n?this:Ye,zt)}catch(wt){throw Tl(Ge,wt),wt}return ft instanceof Promise?ft.then(wt=>(Tl(De,wt),wt)).catch(wt=>(Tl(Ge,wt),Promise.reject(wt))):(Tl(De,ft),ft)};return bt[O_]=!0,bt[gp]=Je,bt},Te={_p:_,$id:n,$onAction:F_.bind(null,Q),$patch:rt,$reset:He,$subscribe(nt,Je={}){const bt=F_(H,nt,Je.detached,()=>zt()),zt=b.run(()=>Fi(()=>_.state.value[n],De=>{(Je.flush==="sync"?V:U)&&nt({storeId:n,type:_u.direct,events:G},De)},vs({},z,Je)));return bt},$dispose:lt},Ye=Dl(Te);_._s.set(n,Ye);const _t=(_._a&&_._a.runWithContext||$w)(()=>_._e.run(()=>(b=zy()).run(()=>s({action:st}))));for(const nt in _t){const Je=_t[nt];if(to(Je)&&!Vw(Je)||ks(Je))P||(se&&Nw(Je)&&(to(Je)?Je.value=se[nt]:Bp(Je,se[nt])),_.state.value[n][nt]=Je);else if(typeof Je=="function"){const bt=st(Je,nt);_t[nt]=bt,c.actions[nt]=Je}}return vs(Ye,_t),vs(nr(Ye),_t),Object.defineProperty(Ye,"$state",{get:()=>_.state.value[n],set:nt=>{rt(Je=>{vs(Je,nt)})}}),_._p.forEach(nt=>{vs(Ye,b.run(()=>nt({store:Ye,app:_._a,pinia:_,options:c})))}),se&&P&&d.hydrate&&d.hydrate(Ye.$state,se),U=!0,V=!0,Ye}/*! #__NO_SIDE_EFFECTS__ */function Zw(n,s,d){let _;const x=typeof s=="function";_=x?d:s;function P(b,c){const z=k1();return b=b||(z?mu(N0,null):null),b&&$d(b),b=j0,b._s.has(n)||(x?U0(n,s,_,b):Uw(n,_,b)),b._s.get(n)}return P.$id=n,P}const Gw="csrfToken",$_="djangoSlot",qw={install(n,s){var _;n.config.globalProperties.$djangoSlots={};for(const x of s.rootElement.children)x instanceof HTMLElement&&$_ in x.dataset&&(n.config.globalProperties.$djangoSlots[x.dataset[$_]]=x.outerHTML);n.config.globalProperties.$rootElement=s.rootElement;const d=window.vueProvided||{};Object.keys(d).forEach(x=>{n.provide(x,d[x])}),n.provide(Gw,(_=window.document.querySelector("[name=csrfmiddlewaretoken]"))==null?void 0:_.value)}},Ww=({dataset:n,component:s})=>(Object.keys(n).forEach(function(_){if(_ in s.props){const x=s.props[_].type;n[_]=x===Date?new x(n[_]):x(n[_])}}),n);var Hw=Object.defineProperty,j_=Object.getOwnPropertySymbols,Xw=Object.prototype.hasOwnProperty,Yw=Object.prototype.propertyIsEnumerable,N_=(n,s,d)=>s in n?Hw(n,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):n[s]=d,Kw=(n,s)=>{for(var d in s||(s={}))Xw.call(s,d)&&N_(n,d,s[d]);if(j_)for(var d of j_(s))Yw.call(s,d)&&N_(n,d,s[d]);return n};function jd(n){return n==null||n===""||Array.isArray(n)&&n.length===0||!(n instanceof Date)&&typeof n=="object"&&Object.keys(n).length===0}function hm(n){return typeof n=="function"&&"call"in n&&"apply"in n}function Rr(n){return!jd(n)}function pn(n,s=!0){return n instanceof Object&&n.constructor===Object&&(s||Object.keys(n).length!==0)}function Z0(n={},s={}){const d=Kw({},n);return Object.keys(s).forEach(_=>{const x=_;pn(s[x])&&x in n&&pn(n[x])?d[x]=Z0(n[x],s[x]):d[x]=s[x]}),d}function Jw(...n){return n.reduce((s,d,_)=>_===0?d:Z0(s,d),{})}function Oi(n,...s){return hm(n)?n(...s):n}function mi(n,s=!0){return typeof n=="string"&&(s||n!=="")}function dn(n){return mi(n)?n.replace(/(-|_)/g,"").toLowerCase():n}function dm(n,s="",d={}){const _=dn(s).split("."),x=_.shift();if(x){if(pn(n)){const P=Object.keys(n).find(b=>dn(b)===x)||"";return dm(Oi(n[P],d),_.join("."),d)}return}return Oi(n,d)}function Nd(n,s=!0){return Array.isArray(n)&&(s||n.length!==0)}function Qw(n){return Rr(n)&&!isNaN(n)}function Vn(n,s){if(s){const d=s.test(n);return s.lastIndex=0,d}return!1}function e2(...n){return Jw(...n)}function yu(n){return n&&n.replace(/\/\*(?:(?!\*\/)[\s\S])*\*\/|[\r\n\t]+/g,"").replace(/ {2,}/g," ").replace(/ ([{:}]) /g,"$1").replace(/([;,]) /g,"$1").replace(/ !/g,"!").replace(/: /g,":")}function t2(n){return mi(n,!1)?n[0].toUpperCase()+n.slice(1):n}function G0(n){return mi(n)?n.replace(/(_)/g,"-").replace(/[A-Z]/g,(s,d)=>d===0?s:"-"+s.toLowerCase()).toLowerCase():n}function V_(n){return mi(n)?n.replace(/[A-Z]/g,(s,d)=>d===0?s:"."+s.toLowerCase()).toLowerCase():n}function fm(){const n=new Map;return{on(s,d){let _=n.get(s);return _?_.push(d):_=[d],n.set(s,_),this},off(s,d){const _=n.get(s);return _&&_.splice(_.indexOf(d)>>>0,1),this},emit(s,d){const _=n.get(s);_&&_.forEach(x=>{x(d)})},clear(){n.clear()}}}function r2(n,s){return n?n.classList?n.classList.contains(s):new RegExp("(^| )"+s+"( |$)","gi").test(n.className):!1}function q0(n,s){if(n&&s){const d=_=>{r2(n,_)||(n.classList?n.classList.add(_):n.className+=" "+_)};[s].flat().filter(Boolean).forEach(_=>_.split(" ").forEach(d))}}function _p(n,s){if(n&&s){const d=_=>{n.classList?n.classList.remove(_):n.className=n.className.replace(new RegExp("(^|\\b)"+_.split(" ").join("|")+"(\\b|$)","gi")," ")};[s].flat().filter(Boolean).forEach(_=>_.split(" ").forEach(d))}}function U_(n){for(const s of document==null?void 0:document.styleSheets)try{for(const d of s==null?void 0:s.cssRules)for(const _ of d==null?void 0:d.style)if(n.test(_))return{name:_,value:d.style.getPropertyValue(_).trim()}}catch{}return null}function o2(n){const s={width:0,height:0};return n&&(n.style.visibility="hidden",n.style.display="block",s.width=n.offsetWidth,s.height=n.offsetHeight,n.style.display="none",n.style.visibility="visible"),s}function i2(){const n=window,s=document,d=s.documentElement,_=s.getElementsByTagName("body")[0],x=n.innerWidth||d.clientWidth||_.clientWidth,P=n.innerHeight||d.clientHeight||_.clientHeight;return{width:x,height:P}}function Fp(n){return n?Math.abs(n.scrollLeft):0}function n2(){const n=document.documentElement;return(window.pageXOffset||Fp(n))-(n.clientLeft||0)}function s2(){const n=document.documentElement;return(window.pageYOffset||n.scrollTop)-(n.clientTop||0)}function a2(n,s,d=!0){var _,x,P,b;if(n){const c=n.offsetParent?{width:n.offsetWidth,height:n.offsetHeight}:o2(n),z=c.height,U=c.width,V=s.offsetHeight,H=s.offsetWidth,Q=s.getBoundingClientRect(),G=s2(),se=n2(),Me=i2();let rt,He,lt="top";Q.top+V+z>Me.height?(rt=Q.top+G-z,lt="bottom",rt<0&&(rt=G)):rt=V+Q.top+G,Q.left+U>Me.width?He=Math.max(0,Q.left+se+H-U):He=Q.left+se,n.style.top=rt+"px",n.style.insetInlineStart=He+"px",n.style.transformOrigin=lt,d&&(n.style.marginTop=lt==="bottom"?`calc(${(x=(_=U_(/-anchor-gutter$/))==null?void 0:_.value)!=null?x:"2px"} * -1)`:(b=(P=U_(/-anchor-gutter$/))==null?void 0:P.value)!=null?b:"")}}function l2(n,s){n&&(typeof s=="string"?n.style.cssText=s:Object.entries(s||{}).forEach(([d,_])=>n.style[d]=_))}function c2(n,s){return n instanceof HTMLElement?n.offsetWidth:0}function W0(n){if(n){let s=n.parentNode;return s&&s instanceof ShadowRoot&&s.host&&(s=s.host),s}return null}function u2(n){return!!(n!==null&&typeof n<"u"&&n.nodeName&&W0(n))}function ga(n){return typeof HTMLElement<"u"?n instanceof HTMLElement:n!==null&&typeof n=="object"&&n.nodeType===1&&typeof n.nodeName=="string"}function xd(n,s={}){if(ga(n)){const d=(_,x)=>{var P,b;const c=(P=n==null?void 0:n.$attrs)!=null&&P[_]?[(b=n==null?void 0:n.$attrs)==null?void 0:b[_]]:[];return[x].flat().reduce((z,U)=>{if(U!=null){const V=typeof U;if(V==="string"||V==="number")z.push(U);else if(V==="object"){const H=Array.isArray(U)?d(_,U):Object.entries(U).map(([Q,G])=>_==="style"&&(G||G===0)?`${Q.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${G}`:G?Q:void 0);z=H.length?z.concat(H.filter(Q=>!!Q)):z}}return z},c)};Object.entries(s).forEach(([_,x])=>{if(x!=null){const P=_.match(/^on(.+)/);P?n.addEventListener(P[1].toLowerCase(),x):_==="p-bind"||_==="pBind"?xd(n,x):(x=_==="class"?[...new Set(d("class",x))].join(" ").trim():_==="style"?d("style",x).join(";").trim():x,(n.$attrs=n.$attrs||{})&&(n.$attrs[_]=x),n.setAttribute(_,x))}})}}function H0(n,s={},...d){{const _=document.createElement(n);return xd(_,s),_.append(...d),_}}function h2(n,s){return ga(n)?Array.from(n.querySelectorAll(s)):[]}function X0(n,s){return ga(n)?n.matches(s)?n:n.querySelector(s):null}function lu(n,s){n&&document.activeElement!==n&&n.focus(s)}function d2(n,s){if(ga(n)){const d=n.getAttribute(s);return isNaN(d)?d==="true"||d==="false"?d==="true":d:+d}}function Y0(n,s=""){const d=h2(n,`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s}`),_=[];for(const x of d)getComputedStyle(x).display!="none"&&getComputedStyle(x).visibility!="hidden"&&_.push(x);return _}function ru(n,s){const d=Y0(n,s);return d.length>0?d[0]:null}function Z_(n){if(n){let s=n.offsetHeight;const d=getComputedStyle(n);return s-=parseFloat(d.paddingTop)+parseFloat(d.paddingBottom)+parseFloat(d.borderTopWidth)+parseFloat(d.borderBottomWidth),s}return 0}function f2(n,s){const d=Y0(n,s);return d.length>0?d[d.length-1]:null}function Op(n){if(n){const s=n.getBoundingClientRect();return{top:s.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:s.left+(window.pageXOffset||Fp(document.documentElement)||Fp(document.body)||0)}}return{top:"auto",left:"auto"}}function p2(n,s){return n?n.offsetHeight:0}function K0(n,s=[]){const d=W0(n);return d===null?s:K0(d,s.concat([d]))}function m2(n){const s=[];if(n){const d=K0(n),_=/(auto|scroll)/,x=P=>{try{const b=window.getComputedStyle(P,null);return _.test(b.getPropertyValue("overflow"))||_.test(b.getPropertyValue("overflowX"))||_.test(b.getPropertyValue("overflowY"))}catch{return!1}};for(const P of d){const b=P.nodeType===1&&P.dataset.scrollselectors;if(b){const c=b.split(",");for(const z of c){const U=X0(P,z);U&&x(U)&&s.push(U)}}P.nodeType!==9&&x(P)&&s.push(P)}}return s}function G_(n){if(n){let s=n.offsetWidth;const d=getComputedStyle(n);return s-=parseFloat(d.paddingLeft)+parseFloat(d.paddingRight)+parseFloat(d.borderLeftWidth)+parseFloat(d.borderRightWidth),s}return 0}function pm(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function q_(n,s=""){return ga(n)?n.matches(`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s}`):!1}function g2(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function J0(n,s="",d){ga(n)&&d!==null&&d!==void 0&&n.setAttribute(s,d)}var rd={};function _2(n="pui_id_"){return Object.hasOwn(rd,n)||(rd[n]=0),rd[n]++,`${n}${rd[n]}`}function y2(){let n=[];const s=(b,c,z=999)=>{const U=x(b,c,z),V=U.value+(U.key===b?0:z)+1;return n.push({key:b,value:V}),V},d=b=>{n=n.filter(c=>c.value!==b)},_=(b,c)=>x(b).value,x=(b,c,z=0)=>[...n].reverse().find(U=>!0)||{key:b,value:z},P=b=>b&&parseInt(b.style.zIndex,10)||0;return{get:P,set:(b,c,z)=>{c&&(c.style.zIndex=String(s(b,!0,z)))},clear:b=>{b&&(d(P(b)),b.style.zIndex="")},getCurrent:b=>_(b)}}var yp=y2(),v2=Object.defineProperty,b2=Object.defineProperties,x2=Object.getOwnPropertyDescriptors,wd=Object.getOwnPropertySymbols,Q0=Object.prototype.hasOwnProperty,ev=Object.prototype.propertyIsEnumerable,W_=(n,s,d)=>s in n?v2(n,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):n[s]=d,Xi=(n,s)=>{for(var d in s||(s={}))Q0.call(s,d)&&W_(n,d,s[d]);if(wd)for(var d of wd(s))ev.call(s,d)&&W_(n,d,s[d]);return n},vp=(n,s)=>b2(n,x2(s)),On=(n,s)=>{var d={};for(var _ in n)Q0.call(n,_)&&s.indexOf(_)<0&&(d[_]=n[_]);if(n!=null&&wd)for(var _ of wd(n))s.indexOf(_)<0&&ev.call(n,_)&&(d[_]=n[_]);return d},w2=fm(),Io=w2;function H_(n,s){Nd(n)?n.push(...s||[]):pn(n)&&Object.assign(n,s)}function C2(n){return pn(n)&&n.hasOwnProperty("$value")&&n.hasOwnProperty("$type")?n.$value:n}function T2(n){return n.replaceAll(/ /g,"").replace(/[^\w]/g,"-")}function $p(n="",s=""){return T2(`${mi(n,!1)&&mi(s,!1)?`${n}-`:n}${s}`)}function tv(n="",s=""){return`--${$p(n,s)}`}function S2(n=""){const s=(n.match(/{/g)||[]).length,d=(n.match(/}/g)||[]).length;return(s+d)%2!==0}function rv(n,s="",d="",_=[],x){if(mi(n)){const P=/{([^}]*)}/g,b=n.trim();if(S2(b))return;if(Vn(b,P)){const c=b.replaceAll(P,V=>{const Q=V.replace(/{|}/g,"").split(".").filter(G=>!_.some(se=>Vn(G,se)));return`var(${tv(d,G0(Q.join("-")))}${Rr(x)?`, ${x}`:""})`}),z=/(\d+\s+[\+\-\*\/]\s+\d+)/g,U=/var\([^)]+\)/g;return Vn(c.replace(U,"0"),z)?`calc(${c})`:c}return b}else if(Qw(n))return n}function k2(n,s,d){mi(s,!1)&&n.push(`${s}:${d};`)}function Pl(n,s){return n?`${n}{${s}}`:""}var P2=n=>{var s;const d=gr.getTheme(),_=jp(d,n,void 0,"variable"),x=(s=_==null?void 0:_.match(/--[\w-]+/g))==null?void 0:s[0],P=jp(d,n,void 0,"value");return{name:x,variable:_,value:P}},vu=(...n)=>jp(gr.getTheme(),...n),jp=(n={},s,d,_)=>{if(s){const{variable:x,options:P}=gr.defaults||{},{prefix:b,transform:c}=(n==null?void 0:n.options)||P||{},U=Vn(s,/{([^}]*)}/g)?s:`{${s}}`;return _==="value"||jd(_)&&c==="strict"?gr.getTokenValue(s):rv(U,void 0,b,[x.excludedKeyRegex],d)}return""};function M2(n,s={}){const d=gr.defaults.variable,{prefix:_=d.prefix,selector:x=d.selector,excludedKeyRegex:P=d.excludedKeyRegex}=s,b=(U,V="")=>Object.entries(U).reduce((H,[Q,G])=>{const se=Vn(Q,P)?$p(V):$p(V,G0(Q)),Me=C2(G);if(pn(Me)){const{variables:rt,tokens:He}=b(Me,se);H_(H.tokens,He),H_(H.variables,rt)}else H.tokens.push((_?se.replace(`${_}-`,""):se).replaceAll("-",".")),k2(H.variables,tv(se),rv(Me,se,_,[P]));return H},{variables:[],tokens:[]}),{variables:c,tokens:z}=b(n,_);return{value:c,tokens:z,declarations:c.join(""),css:Pl(x,c.join(""))}}var Hi={regex:{rules:{class:{pattern:/^\.([a-zA-Z][\w-]*)$/,resolve(n){return{type:"class",selector:n,matched:this.pattern.test(n.trim())}}},attr:{pattern:/^\[(.*)\]$/,resolve(n){return{type:"attr",selector:`:root${n}`,matched:this.pattern.test(n.trim())}}},media:{pattern:/^@media (.*)$/,resolve(n){return{type:"media",selector:`${n}{:root{[CSS]}}`,matched:this.pattern.test(n.trim())}}},system:{pattern:/^system$/,resolve(n){return{type:"system",selector:"@media (prefers-color-scheme: dark){:root{[CSS]}}",matched:this.pattern.test(n.trim())}}},custom:{resolve(n){return{type:"custom",selector:n,matched:!0}}}},resolve(n){const s=Object.keys(this.rules).filter(d=>d!=="custom").map(d=>this.rules[d]);return[n].flat().map(d=>{var _;return(_=s.map(x=>x.resolve(d)).find(x=>x.matched))!=null?_:this.rules.custom.resolve(d)})}},_toVariables(n,s){return M2(n,{prefix:s==null?void 0:s.prefix})},getCommon({name:n="",theme:s={},params:d,set:_,defaults:x}){var P,b,c,z,U,V,H;const{preset:Q,options:G}=s;let se,Me,rt,He,lt,st,Te;if(Rr(Q)&&G.transform!=="strict"){const{primitive:Ye,semantic:dt,extend:_t}=Q,nt=dt||{},{colorScheme:Je}=nt,bt=On(nt,["colorScheme"]),zt=_t||{},{colorScheme:De}=zt,Ge=On(zt,["colorScheme"]),et=Je||{},{dark:Dt}=et,ft=On(et,["dark"]),wt=De||{},{dark:Et}=wt,sr=On(wt,["dark"]),cr=Rr(Ye)?this._toVariables({primitive:Ye},G):{},or=Rr(bt)?this._toVariables({semantic:bt},G):{},qt=Rr(ft)?this._toVariables({light:ft},G):{},Sr=Rr(Dt)?this._toVariables({dark:Dt},G):{},Mr=Rr(Ge)?this._toVariables({semantic:Ge},G):{},br=Rr(sr)?this._toVariables({light:sr},G):{},qr=Rr(Et)?this._toVariables({dark:Et},G):{},[bo,Uo]=[(P=cr.declarations)!=null?P:"",cr.tokens],[ro,Zo]=[(b=or.declarations)!=null?b:"",or.tokens||[]],[Wr,ae]=[(c=qt.declarations)!=null?c:"",qt.tokens||[]],[pe,ke]=[(z=Sr.declarations)!=null?z:"",Sr.tokens||[]],[qe,Ne]=[(U=Mr.declarations)!=null?U:"",Mr.tokens||[]],[Ve,it]=[(V=br.declarations)!=null?V:"",br.tokens||[]],[ot,Qe]=[(H=qr.declarations)!=null?H:"",qr.tokens||[]];se=this.transformCSS(n,bo,"light","variable",G,_,x),Me=Uo;const Ue=this.transformCSS(n,`${ro}${Wr}`,"light","variable",G,_,x),Pt=this.transformCSS(n,`${pe}`,"dark","variable",G,_,x);rt=`${Ue}${Pt}`,He=[...new Set([...Zo,...ae,...ke])];const at=this.transformCSS(n,`${qe}${Ve}color-scheme:light`,"light","variable",G,_,x),Ct=this.transformCSS(n,`${ot}color-scheme:dark`,"dark","variable",G,_,x);lt=`${at}${Ct}`,st=[...new Set([...Ne,...it,...Qe])],Te=Oi(Q.css,{dt:vu})}return{primitive:{css:se,tokens:Me},semantic:{css:rt,tokens:He},global:{css:lt,tokens:st},style:Te}},getPreset({name:n="",preset:s={},options:d,params:_,set:x,defaults:P,selector:b}){var c,z,U;let V,H,Q;if(Rr(s)&&d.transform!=="strict"){const G=n.replace("-directive",""),se=s,{colorScheme:Me,extend:rt,css:He}=se,lt=On(se,["colorScheme","extend","css"]),st=rt||{},{colorScheme:Te}=st,Ye=On(st,["colorScheme"]),dt=Me||{},{dark:_t}=dt,nt=On(dt,["dark"]),Je=Te||{},{dark:bt}=Je,zt=On(Je,["dark"]),De=Rr(lt)?this._toVariables({[G]:Xi(Xi({},lt),Ye)},d):{},Ge=Rr(nt)?this._toVariables({[G]:Xi(Xi({},nt),zt)},d):{},et=Rr(_t)?this._toVariables({[G]:Xi(Xi({},_t),bt)},d):{},[Dt,ft]=[(c=De.declarations)!=null?c:"",De.tokens||[]],[wt,Et]=[(z=Ge.declarations)!=null?z:"",Ge.tokens||[]],[sr,cr]=[(U=et.declarations)!=null?U:"",et.tokens||[]],or=this.transformCSS(G,`${Dt}${wt}`,"light","variable",d,x,P,b),qt=this.transformCSS(G,sr,"dark","variable",d,x,P,b);V=`${or}${qt}`,H=[...new Set([...ft,...Et,...cr])],Q=Oi(He,{dt:vu})}return{css:V,tokens:H,style:Q}},getPresetC({name:n="",theme:s={},params:d,set:_,defaults:x}){var P;const{preset:b,options:c}=s,z=(P=b==null?void 0:b.components)==null?void 0:P[n];return this.getPreset({name:n,preset:z,options:c,params:d,set:_,defaults:x})},getPresetD({name:n="",theme:s={},params:d,set:_,defaults:x}){var P,b;const c=n.replace("-directive",""),{preset:z,options:U}=s,V=((P=z==null?void 0:z.components)==null?void 0:P[c])||((b=z==null?void 0:z.directives)==null?void 0:b[c]);return this.getPreset({name:c,preset:V,options:U,params:d,set:_,defaults:x})},applyDarkColorScheme(n){return!(n.darkModeSelector==="none"||n.darkModeSelector===!1)},getColorSchemeOption(n,s){var d;return this.applyDarkColorScheme(n)?this.regex.resolve(n.darkModeSelector===!0?s.options.darkModeSelector:(d=n.darkModeSelector)!=null?d:s.options.darkModeSelector):[]},getLayerOrder(n,s={},d,_){const{cssLayer:x}=s;return x?`@layer ${Oi(x.order||"primeui",d)}`:""},getCommonStyleSheet({name:n="",theme:s={},params:d,props:_={},set:x,defaults:P}){const b=this.getCommon({name:n,theme:s,params:d,set:x,defaults:P}),c=Object.entries(_).reduce((z,[U,V])=>z.push(`${U}="${V}"`)&&z,[]).join(" ");return Object.entries(b||{}).reduce((z,[U,V])=>{if(V!=null&&V.css){const H=yu(V==null?void 0:V.css),Q=`${U}-variables`;z.push(`<style type="text/css" data-primevue-style-id="${Q}" ${c}>${H}</style>`)}return z},[]).join("")},getStyleSheet({name:n="",theme:s={},params:d,props:_={},set:x,defaults:P}){var b;const c={name:n,theme:s,params:d,set:x,defaults:P},z=(b=n.includes("-directive")?this.getPresetD(c):this.getPresetC(c))==null?void 0:b.css,U=Object.entries(_).reduce((V,[H,Q])=>V.push(`${H}="${Q}"`)&&V,[]).join(" ");return z?`<style type="text/css" data-primevue-style-id="${n}-variables" ${U}>${yu(z)}</style>`:""},createTokens(n={},s,d="",_="",x={}){return Object.entries(n).forEach(([P,b])=>{const c=Vn(P,s.variable.excludedKeyRegex)?d:d?`${d}.${V_(P)}`:V_(P),z=_?`${_}.${P}`:P;pn(b)?this.createTokens(b,s,c,z,x):(x[c]||(x[c]={paths:[],computed(U,V={}){var H,Q;return this.paths.length===1?(H=this.paths[0])==null?void 0:H.computed(this.paths[0].scheme,V.binding):U&&U!=="none"?(Q=this.paths.find(G=>G.scheme===U))==null?void 0:Q.computed(U,V.binding):this.paths.map(G=>G.computed(G.scheme,V[G.scheme]))}}),x[c].paths.push({path:z,value:b,scheme:z.includes("colorScheme.light")?"light":z.includes("colorScheme.dark")?"dark":"none",computed(U,V={}){const H=/{([^}]*)}/g;let Q=b;if(V.name=this.path,V.binding||(V.binding={}),Vn(b,H)){const se=b.trim().replaceAll(H,He=>{var lt;const st=He.replace(/{|}/g,""),Te=(lt=x[st])==null?void 0:lt.computed(U,V);return Nd(Te)&&Te.length===2?`light-dark(${Te[0].value},${Te[1].value})`:Te==null?void 0:Te.value}),Me=/(\d+\w*\s+[\+\-\*\/]\s+\d+\w*)/g,rt=/var\([^)]+\)/g;Q=Vn(se.replace(rt,"0"),Me)?`calc(${se})`:se}return jd(V.binding)&&delete V.binding,{colorScheme:U,path:this.path,paths:V,value:Q.includes("undefined")?void 0:Q}}}))}),x},getTokenValue(n,s,d){var _;const P=(z=>z.split(".").filter(V=>!Vn(V.toLowerCase(),d.variable.excludedKeyRegex)).join("."))(s),b=s.includes("colorScheme.light")?"light":s.includes("colorScheme.dark")?"dark":void 0,c=[(_=n[P])==null?void 0:_.computed(b)].flat().filter(z=>z);return c.length===1?c[0].value:c.reduce((z={},U)=>{const V=U,{colorScheme:H}=V,Q=On(V,["colorScheme"]);return z[H]=Q,z},void 0)},getSelectorRule(n,s,d,_){return d==="class"||d==="attr"?Pl(Rr(s)?`${n}${s},${n} ${s}`:n,_):Pl(n,Rr(s)?Pl(s,_):_)},transformCSS(n,s,d,_,x={},P,b,c){if(Rr(s)){const{cssLayer:z}=x;if(_!=="style"){const U=this.getColorSchemeOption(x,b);s=d==="dark"?U.reduce((V,{type:H,selector:Q})=>(Rr(Q)&&(V+=Q.includes("[CSS]")?Q.replace("[CSS]",s):this.getSelectorRule(Q,c,H,s)),V),""):Pl(c??":root",s)}if(z){const U={name:"primeui"};pn(z)&&(U.name=Oi(z.name,{name:n,type:_})),Rr(U.name)&&(s=Pl(`@layer ${U.name}`,s),P==null||P.layerNames(U.name))}return s}return""}},gr={defaults:{variable:{prefix:"p",selector:":root",excludedKeyRegex:/^(primitive|semantic|components|directives|variables|colorscheme|light|dark|common|root|states|extend|css)$/gi},options:{prefix:"p",darkModeSelector:"system",cssLayer:!1}},_theme:void 0,_layerNames:new Set,_loadedStyleNames:new Set,_loadingStyles:new Set,_tokens:{},update(n={}){const{theme:s}=n;s&&(this._theme=vp(Xi({},s),{options:Xi(Xi({},this.defaults.options),s.options)}),this._tokens=Hi.createTokens(this.preset,this.defaults),this.clearLoadedStyleNames())},get theme(){return this._theme},get preset(){var n;return((n=this.theme)==null?void 0:n.preset)||{}},get options(){var n;return((n=this.theme)==null?void 0:n.options)||{}},get tokens(){return this._tokens},getTheme(){return this.theme},setTheme(n){this.update({theme:n}),Io.emit("theme:change",n)},getPreset(){return this.preset},setPreset(n){this._theme=vp(Xi({},this.theme),{preset:n}),this._tokens=Hi.createTokens(n,this.defaults),this.clearLoadedStyleNames(),Io.emit("preset:change",n),Io.emit("theme:change",this.theme)},getOptions(){return this.options},setOptions(n){this._theme=vp(Xi({},this.theme),{options:n}),this.clearLoadedStyleNames(),Io.emit("options:change",n),Io.emit("theme:change",this.theme)},getLayerNames(){return[...this._layerNames]},setLayerNames(n){this._layerNames.add(n)},getLoadedStyleNames(){return this._loadedStyleNames},isStyleNameLoaded(n){return this._loadedStyleNames.has(n)},setLoadedStyleName(n){this._loadedStyleNames.add(n)},deleteLoadedStyleName(n){this._loadedStyleNames.delete(n)},clearLoadedStyleNames(){this._loadedStyleNames.clear()},getTokenValue(n){return Hi.getTokenValue(this.tokens,n,this.defaults)},getCommon(n="",s){return Hi.getCommon({name:n,theme:this.theme,params:s,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getComponent(n="",s){const d={name:n,theme:this.theme,params:s,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return Hi.getPresetC(d)},getDirective(n="",s){const d={name:n,theme:this.theme,params:s,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return Hi.getPresetD(d)},getCustomPreset(n="",s,d,_){const x={name:n,preset:s,options:this.options,selector:d,params:_,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return Hi.getPreset(x)},getLayerOrderCSS(n=""){return Hi.getLayerOrder(n,this.options,{names:this.getLayerNames()},this.defaults)},transformCSS(n="",s,d="style",_){return Hi.transformCSS(n,s,_,d,this.options,{layerNames:this.setLayerNames.bind(this)},this.defaults)},getCommonStyleSheet(n="",s,d={}){return Hi.getCommonStyleSheet({name:n,theme:this.theme,params:s,props:d,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getStyleSheet(n,s,d={}){return Hi.getStyleSheet({name:n,theme:this.theme,params:s,props:d,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},onStyleMounted(n){this._loadingStyles.add(n)},onStyleUpdated(n){this._loadingStyles.add(n)},onStyleLoaded(n,{name:s}){this._loadingStyles.size&&(this._loadingStyles.delete(s),Io.emit(`theme:${s}:load`,n),!this._loadingStyles.size&&Io.emit("theme:load"))}},Oo={STARTS_WITH:"startsWith",CONTAINS:"contains",NOT_CONTAINS:"notContains",ENDS_WITH:"endsWith",EQUALS:"equals",NOT_EQUALS:"notEquals",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"lte",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"gte",DATE_IS:"dateIs",DATE_IS_NOT:"dateIsNot",DATE_BEFORE:"dateBefore",DATE_AFTER:"dateAfter"},I2=({dt:n})=>`
*,
::before,
::after {
    box-sizing: border-box;
}

/* Non vue overlay animations */
.p-connected-overlay {
    opacity: 0;
    transform: scaleY(0.8);
    transition: transform 0.12s cubic-bezier(0, 0, 0.2, 1),
        opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
}

.p-connected-overlay-visible {
    opacity: 1;
    transform: scaleY(1);
}

.p-connected-overlay-hidden {
    opacity: 0;
    transform: scaleY(1);
    transition: opacity 0.1s linear;
}

/* Vue based overlay animations */
.p-connected-overlay-enter-from {
    opacity: 0;
    transform: scaleY(0.8);
}

.p-connected-overlay-leave-to {
    opacity: 0;
}

.p-connected-overlay-enter-active {
    transition: transform 0.12s cubic-bezier(0, 0, 0.2, 1),
        opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
}

.p-connected-overlay-leave-active {
    transition: opacity 0.1s linear;
}

/* Toggleable Content */
.p-toggleable-content-enter-from,
.p-toggleable-content-leave-to {
    max-height: 0;
}

.p-toggleable-content-enter-to,
.p-toggleable-content-leave-from {
    max-height: 1000px;
}

.p-toggleable-content-leave-active {
    overflow: hidden;
    transition: max-height 0.45s cubic-bezier(0, 1, 0, 1);
}

.p-toggleable-content-enter-active {
    overflow: hidden;
    transition: max-height 1s ease-in-out;
}

.p-disabled,
.p-disabled * {
    cursor: default;
    pointer-events: none;
    user-select: none;
}

.p-disabled,
.p-component:disabled {
    opacity: ${n("disabled.opacity")};
}

.pi {
    font-size: ${n("icon.size")};
}

.p-icon {
    width: ${n("icon.size")};
    height: ${n("icon.size")};
}

.p-overlay-mask {
    background: ${n("mask.background")};
    color: ${n("mask.color")};
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.p-overlay-mask-enter {
    animation: p-overlay-mask-enter-animation ${n("mask.transition.duration")} forwards;
}

.p-overlay-mask-leave {
    animation: p-overlay-mask-leave-animation ${n("mask.transition.duration")} forwards;
}

@keyframes p-overlay-mask-enter-animation {
    from {
        background: transparent;
    }
    to {
        background: ${n("mask.background")};
    }
}
@keyframes p-overlay-mask-leave-animation {
    from {
        background: ${n("mask.background")};
    }
    to {
        background: transparent;
    }
}
`;function Mu(n){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Mu(n)}function X_(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);s&&(_=_.filter(function(x){return Object.getOwnPropertyDescriptor(n,x).enumerable})),d.push.apply(d,_)}return d}function Y_(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?X_(Object(d),!0).forEach(function(_){E2(n,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):X_(Object(d)).forEach(function(_){Object.defineProperty(n,_,Object.getOwnPropertyDescriptor(d,_))})}return n}function E2(n,s,d){return(s=A2(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function A2(n){var s=z2(n,"string");return Mu(s)=="symbol"?s:s+""}function z2(n,s){if(Mu(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Mu(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}function D2(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;um()?Rd(n):s?n():im(n)}var R2=0;function L2(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=Mi(!1),_=Mi(n),x=Mi(null),P=pm()?window.document:void 0,b=s.document,c=b===void 0?P:b,z=s.immediate,U=z===void 0?!0:z,V=s.manual,H=V===void 0?!1:V,Q=s.name,G=Q===void 0?"style_".concat(++R2):Q,se=s.id,Me=se===void 0?void 0:se,rt=s.media,He=rt===void 0?void 0:rt,lt=s.nonce,st=lt===void 0?void 0:lt,Te=s.first,Ye=Te===void 0?!1:Te,dt=s.onMounted,_t=dt===void 0?void 0:dt,nt=s.onUpdated,Je=nt===void 0?void 0:nt,bt=s.onLoad,zt=bt===void 0?void 0:bt,De=s.props,Ge=De===void 0?{}:De,et=function(){},Dt=function(Et){var sr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(c){var cr=Y_(Y_({},Ge),sr),or=cr.name||G,qt=cr.id||Me,Sr=cr.nonce||st;x.value=c.querySelector('style[data-primevue-style-id="'.concat(or,'"]'))||c.getElementById(qt)||c.createElement("style"),x.value.isConnected||(_.value=Et||n,xd(x.value,{type:"text/css",id:qt,media:He,nonce:Sr}),Ye?c.head.prepend(x.value):c.head.appendChild(x.value),J0(x.value,"data-primevue-style-id",or),xd(x.value,cr),x.value.onload=function(Mr){return zt==null?void 0:zt(Mr,{name:or})},_t==null||_t(or)),!d.value&&(et=Fi(_,function(Mr){x.value.textContent=Mr,Je==null||Je(or)},{immediate:!0}),d.value=!0)}},ft=function(){!c||!d.value||(et(),u2(x.value)&&c.head.removeChild(x.value),d.value=!1)};return U&&!H&&D2(Dt),{id:Me,name:G,el:x,css:_,unload:ft,load:Dt,isLoaded:em(d)}}function Iu(n){"@babel/helpers - typeof";return Iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Iu(n)}function K_(n,s){return $2(n)||O2(n,s)||F2(n,s)||B2()}function B2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function F2(n,s){if(n){if(typeof n=="string")return J_(n,s);var d={}.toString.call(n).slice(8,-1);return d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set"?Array.from(n):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?J_(n,s):void 0}}function J_(n,s){(s==null||s>n.length)&&(s=n.length);for(var d=0,_=Array(s);d<s;d++)_[d]=n[d];return _}function O2(n,s){var d=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(d!=null){var _,x,P,b,c=[],z=!0,U=!1;try{if(P=(d=d.call(n)).next,s!==0)for(;!(z=(_=P.call(d)).done)&&(c.push(_.value),c.length!==s);z=!0);}catch(V){U=!0,x=V}finally{try{if(!z&&d.return!=null&&(b=d.return(),Object(b)!==b))return}finally{if(U)throw x}}return c}}function $2(n){if(Array.isArray(n))return n}function Q_(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);s&&(_=_.filter(function(x){return Object.getOwnPropertyDescriptor(n,x).enumerable})),d.push.apply(d,_)}return d}function bp(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?Q_(Object(d),!0).forEach(function(_){j2(n,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):Q_(Object(d)).forEach(function(_){Object.defineProperty(n,_,Object.getOwnPropertyDescriptor(d,_))})}return n}function j2(n,s,d){return(s=N2(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function N2(n){var s=V2(n,"string");return Iu(s)=="symbol"?s:s+""}function V2(n,s){if(Iu(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Iu(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var U2=function(s){var d=s.dt;return`
.p-hidden-accessible {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    opacity: 0;
    overflow: hidden;
    padding: 0;
    pointer-events: none;
    position: absolute;
    white-space: nowrap;
    width: 1px;
}

.p-overflow-hidden {
    overflow: hidden;
    padding-right: `.concat(d("scrollbar.width"),`;
}
`)},Z2={},G2={},Nr={name:"base",css:U2,style:I2,classes:Z2,inlineStyles:G2,load:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(P){return P},x=_(Oi(s,{dt:vu}));return Rr(x)?L2(yu(x),bp({name:this.name},d)):{}},loadCSS:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.load(this.css,s)},loadStyle:function(){var s=this,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.load(this.style,d,function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return gr.transformCSS(d.name||s.name,"".concat(x).concat(_))})},getCommonTheme:function(s){return gr.getCommon(this.name,s)},getComponentTheme:function(s){return gr.getComponent(this.name,s)},getDirectiveTheme:function(s){return gr.getDirective(this.name,s)},getPresetTheme:function(s,d,_){return gr.getCustomPreset(this.name,s,d,_)},getLayerOrderThemeCSS:function(){return gr.getLayerOrderCSS(this.name)},getStyleSheet:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.css){var _=Oi(this.css,{dt:vu})||"",x=yu("".concat(_).concat(s)),P=Object.entries(d).reduce(function(b,c){var z=K_(c,2),U=z[0],V=z[1];return b.push("".concat(U,'="').concat(V,'"'))&&b},[]).join(" ");return Rr(x)?'<style type="text/css" data-primevue-style-id="'.concat(this.name,'" ').concat(P,">").concat(x,"</style>"):""}return""},getCommonThemeStyleSheet:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return gr.getCommonStyleSheet(this.name,s,d)},getThemeStyleSheet:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=[gr.getStyleSheet(this.name,s,d)];if(this.style){var x=this.name==="base"?"global-style":"".concat(this.name,"-style"),P=Oi(this.style,{dt:vu}),b=yu(gr.transformCSS(x,P)),c=Object.entries(d).reduce(function(z,U){var V=K_(U,2),H=V[0],Q=V[1];return z.push("".concat(H,'="').concat(Q,'"'))&&z},[]).join(" ");Rr(b)&&_.push('<style type="text/css" data-primevue-style-id="'.concat(x,'" ').concat(c,">").concat(b,"</style>"))}return _.join("")},extend:function(s){return bp(bp({},this),{},{css:void 0,style:void 0},s)}},Ts=fm();function Eu(n){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Eu(n)}function ey(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);s&&(_=_.filter(function(x){return Object.getOwnPropertyDescriptor(n,x).enumerable})),d.push.apply(d,_)}return d}function od(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?ey(Object(d),!0).forEach(function(_){q2(n,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):ey(Object(d)).forEach(function(_){Object.defineProperty(n,_,Object.getOwnPropertyDescriptor(d,_))})}return n}function q2(n,s,d){return(s=W2(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function W2(n){var s=H2(n,"string");return Eu(s)=="symbol"?s:s+""}function H2(n,s){if(Eu(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Eu(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var X2={ripple:!1,inputStyle:null,inputVariant:null,locale:{startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",completed:"Completed",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",today:"Today",weekHeader:"Wk",firstDayOfWeek:0,showMonthAfterYear:!1,dateFormat:"mm/dd/yy",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyFilterMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",fileChosenMessage:"{0} files",noFileChosenMessage:"No file chosen",emptyMessage:"No available options",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"Page {page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left",listLabel:"Option List"}},filterMatchModeOptions:{text:[Oo.STARTS_WITH,Oo.CONTAINS,Oo.NOT_CONTAINS,Oo.ENDS_WITH,Oo.EQUALS,Oo.NOT_EQUALS],numeric:[Oo.EQUALS,Oo.NOT_EQUALS,Oo.LESS_THAN,Oo.LESS_THAN_OR_EQUAL_TO,Oo.GREATER_THAN,Oo.GREATER_THAN_OR_EQUAL_TO],date:[Oo.DATE_IS,Oo.DATE_IS_NOT,Oo.DATE_BEFORE,Oo.DATE_AFTER]},zIndex:{modal:1100,overlay:1e3,menu:1e3,tooltip:1100},theme:void 0,unstyled:!1,pt:void 0,ptOptions:{mergeSections:!0,mergeProps:!1},csp:{nonce:void 0}},Y2=Symbol();function K2(n,s){var d={config:Dl(s)};return n.config.globalProperties.$primevue=d,n.provide(Y2,d),J2(),Q2(n,d),d}var Ml=[];function J2(){Io.clear(),Ml.forEach(function(n){return n==null?void 0:n()}),Ml=[]}function Q2(n,s){var d=Mi(!1),_=function(){var U;if(((U=s.config)===null||U===void 0?void 0:U.theme)!=="none"&&!gr.isStyleNameLoaded("common")){var V,H,Q=((V=Nr.getCommonTheme)===null||V===void 0?void 0:V.call(Nr))||{},G=Q.primitive,se=Q.semantic,Me=Q.global,rt=Q.style,He={nonce:(H=s.config)===null||H===void 0||(H=H.csp)===null||H===void 0?void 0:H.nonce};Nr.load(G==null?void 0:G.css,od({name:"primitive-variables"},He)),Nr.load(se==null?void 0:se.css,od({name:"semantic-variables"},He)),Nr.load(Me==null?void 0:Me.css,od({name:"global-variables"},He)),Nr.loadStyle(od({name:"global-style"},He),rt),gr.setLoadedStyleName("common")}};Io.on("theme:change",function(z){d.value||(n.config.globalProperties.$primevue.config.theme=z,d.value=!0)});var x=Fi(s.config,function(z,U){Ts.emit("config:change",{newValue:z,oldValue:U})},{immediate:!0,deep:!0}),P=Fi(function(){return s.config.ripple},function(z,U){Ts.emit("config:ripple:change",{newValue:z,oldValue:U})},{immediate:!0,deep:!0}),b=Fi(function(){return s.config.theme},function(z,U){d.value||gr.setTheme(z),s.config.unstyled||_(),d.value=!1,Ts.emit("config:theme:change",{newValue:z,oldValue:U})},{immediate:!0,deep:!1}),c=Fi(function(){return s.config.unstyled},function(z,U){!z&&s.config.theme&&_(),Ts.emit("config:unstyled:change",{newValue:z,oldValue:U})},{immediate:!0,deep:!0});Ml.push(x),Ml.push(P),Ml.push(b),Ml.push(c)}var eC={install:function(s,d){var _=e2(X2,d);K2(s,_)}},tC={transitionDuration:"{transition.duration}"},rC={borderWidth:"0 0 1px 0",borderColor:"{content.border.color}"},oC={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",padding:"1.125rem",fontWeight:"600",borderRadius:"0",borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",hoverBackground:"{content.background}",activeBackground:"{content.background}",activeHoverBackground:"{content.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},toggleIcon:{color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}"},first:{topBorderRadius:"{content.border.radius}",borderWidth:"0"},last:{bottomBorderRadius:"{content.border.radius}",activeBottomBorderRadius:"0"}},iC={borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",color:"{text.color}",padding:"0 1.125rem 1.125rem 1.125rem"},nC={root:tC,panel:rC,header:oC,content:iC},sC={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},aC={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},lC={padding:"{list.padding}",gap:"{list.gap}"},cC={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},uC={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},hC={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},dC={borderRadius:"{border.radius.sm}"},fC={padding:"{list.option.padding}"},pC={light:{chip:{focusBackground:"{surface.200}",focusColor:"{surface.800}"},dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",focusColor:"{surface.0}"},dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"}}},mC={root:sC,overlay:aC,list:lC,option:cC,optionGroup:uC,dropdown:hC,chip:dC,emptyMessage:fC,colorScheme:pC},gC={width:"2rem",height:"2rem",fontSize:"1rem",background:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},_C={size:"1rem"},yC={borderColor:"{content.background}",offset:"-0.75rem"},vC={width:"3rem",height:"3rem",fontSize:"1.5rem",icon:{size:"1.5rem"},group:{offset:"-1rem"}},bC={width:"4rem",height:"4rem",fontSize:"2rem",icon:{size:"2rem"},group:{offset:"-1.5rem"}},xC={root:gC,icon:_C,group:yC,lg:vC,xl:bC},wC={borderRadius:"{border.radius.md}",padding:"0 0.5rem",fontSize:"0.75rem",fontWeight:"700",minWidth:"1.5rem",height:"1.5rem"},CC={size:"0.5rem"},TC={fontSize:"0.625rem",minWidth:"1.25rem",height:"1.25rem"},SC={fontSize:"0.875rem",minWidth:"1.75rem",height:"1.75rem"},kC={fontSize:"1rem",minWidth:"2rem",height:"2rem"},PC={light:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.500}",color:"{surface.0}"},info:{background:"{sky.500}",color:"{surface.0}"},warn:{background:"{orange.500}",color:"{surface.0}"},danger:{background:"{red.500}",color:"{surface.0}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"{green.400}",color:"{green.950}"},info:{background:"{sky.400}",color:"{sky.950}"},warn:{background:"{orange.400}",color:"{orange.950}"},danger:{background:"{red.400}",color:"{red.950}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},MC={root:wC,dot:CC,sm:TC,lg:SC,xl:kC,colorScheme:PC},IC={borderRadius:{none:"0",xs:"2px",sm:"4px",md:"6px",lg:"8px",xl:"12px"},emerald:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b",950:"#022c22"},green:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d",950:"#052e16"},lime:{50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314",950:"#1a2e05"},red:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d",950:"#450a0a"},orange:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12",950:"#431407"},amber:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f",950:"#451a03"},yellow:{50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12",950:"#422006"},teal:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a",950:"#042f2e"},cyan:{50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63",950:"#083344"},sky:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e",950:"#082f49"},blue:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a",950:"#172554"},indigo:{50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81",950:"#1e1b4b"},violet:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95",950:"#2e1065"},purple:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87",950:"#3b0764"},fuchsia:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75",950:"#4a044e"},pink:{50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843",950:"#500724"},rose:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337",950:"#4c0519"},slate:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a",950:"#020617"},gray:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827",950:"#030712"},zinc:{50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b",950:"#09090b"},neutral:{50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717",950:"#0a0a0a"},stone:{50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917",950:"#0c0a09"}},EC={transitionDuration:"0.2s",focusRing:{width:"1px",style:"solid",color:"{primary.color}",offset:"2px",shadow:"none"},disabledOpacity:"0.6",iconSize:"1rem",anchorGutter:"2px",primary:{50:"{emerald.50}",100:"{emerald.100}",200:"{emerald.200}",300:"{emerald.300}",400:"{emerald.400}",500:"{emerald.500}",600:"{emerald.600}",700:"{emerald.700}",800:"{emerald.800}",900:"{emerald.900}",950:"{emerald.950}"},formField:{paddingX:"0.75rem",paddingY:"0.5rem",sm:{fontSize:"0.875rem",paddingX:"0.625rem",paddingY:"0.375rem"},lg:{fontSize:"1.125rem",paddingX:"0.875rem",paddingY:"0.625rem"},borderRadius:"{border.radius.md}",focusRing:{width:"0",style:"none",color:"transparent",offset:"0",shadow:"none"},transitionDuration:"{transition.duration}"},list:{padding:"0.25rem 0.25rem",gap:"2px",header:{padding:"0.5rem 1rem 0.25rem 1rem"},option:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}"},optionGroup:{padding:"0.5rem 0.75rem",fontWeight:"600"}},content:{borderRadius:"{border.radius.md}"},mask:{transitionDuration:"0.15s"},navigation:{list:{padding:"0.25rem 0.25rem",gap:"2px"},item:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}",gap:"0.5rem"},submenuLabel:{padding:"0.5rem 0.75rem",fontWeight:"600"},submenuIcon:{size:"0.875rem"}},overlay:{select:{borderRadius:"{border.radius.md}",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},popover:{borderRadius:"{border.radius.md}",padding:"0.75rem",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},modal:{borderRadius:"{border.radius.xl}",padding:"1.25rem",shadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1)"},navigation:{shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"}},colorScheme:{light:{surface:{0:"#ffffff",50:"{slate.50}",100:"{slate.100}",200:"{slate.200}",300:"{slate.300}",400:"{slate.400}",500:"{slate.500}",600:"{slate.600}",700:"{slate.700}",800:"{slate.800}",900:"{slate.900}",950:"{slate.950}"},primary:{color:"{primary.500}",contrastColor:"#ffffff",hoverColor:"{primary.600}",activeColor:"{primary.700}"},highlight:{background:"{primary.50}",focusBackground:"{primary.100}",color:"{primary.700}",focusColor:"{primary.800}"},mask:{background:"rgba(0,0,0,0.4)",color:"{surface.200}"},formField:{background:"{surface.0}",disabledBackground:"{surface.200}",filledBackground:"{surface.50}",filledHoverBackground:"{surface.50}",filledFocusBackground:"{surface.50}",borderColor:"{surface.300}",hoverBorderColor:"{surface.400}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.400}",color:"{surface.700}",disabledColor:"{surface.500}",placeholderColor:"{surface.500}",invalidPlaceholderColor:"{red.600}",floatLabelColor:"{surface.500}",floatLabelFocusColor:"{primary.600}",floatLabelActiveColor:"{surface.500}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.700}",hoverColor:"{surface.800}",mutedColor:"{surface.500}",hoverMutedColor:"{surface.600}"},content:{background:"{surface.0}",hoverBackground:"{surface.100}",borderColor:"{surface.200}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},popover:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},modal:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.100}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.100}",activeBackground:"{surface.100}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}}},dark:{surface:{0:"#ffffff",50:"{zinc.50}",100:"{zinc.100}",200:"{zinc.200}",300:"{zinc.300}",400:"{zinc.400}",500:"{zinc.500}",600:"{zinc.600}",700:"{zinc.700}",800:"{zinc.800}",900:"{zinc.900}",950:"{zinc.950}"},primary:{color:"{primary.400}",contrastColor:"{surface.900}",hoverColor:"{primary.300}",activeColor:"{primary.200}"},highlight:{background:"color-mix(in srgb, {primary.400}, transparent 84%)",focusBackground:"color-mix(in srgb, {primary.400}, transparent 76%)",color:"rgba(255,255,255,.87)",focusColor:"rgba(255,255,255,.87)"},mask:{background:"rgba(0,0,0,0.6)",color:"{surface.200}"},formField:{background:"{surface.950}",disabledBackground:"{surface.700}",filledBackground:"{surface.800}",filledHoverBackground:"{surface.800}",filledFocusBackground:"{surface.800}",borderColor:"{surface.600}",hoverBorderColor:"{surface.500}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.300}",color:"{surface.0}",disabledColor:"{surface.400}",placeholderColor:"{surface.400}",invalidPlaceholderColor:"{red.400}",floatLabelColor:"{surface.400}",floatLabelFocusColor:"{primary.color}",floatLabelActiveColor:"{surface.400}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.0}",hoverColor:"{surface.0}",mutedColor:"{surface.400}",hoverMutedColor:"{surface.300}"},content:{background:"{surface.900}",hoverBackground:"{surface.800}",borderColor:"{surface.700}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},popover:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},modal:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.800}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.800}",activeBackground:"{surface.800}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}}}}},AC={primitive:IC,semantic:EC},zC={borderRadius:"{content.border.radius}"},DC={root:zC},RC={padding:"1rem",background:"{content.background}",gap:"0.5rem",transitionDuration:"{transition.duration}"},LC={color:"{text.muted.color}",hoverColor:"{text.color}",borderRadius:"{content.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",hoverColor:"{navigation.item.icon.focus.color}"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},BC={color:"{navigation.item.icon.color}"},FC={root:RC,item:LC,separator:BC},OC={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",gap:"0.5rem",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",iconOnlyWidth:"2.5rem",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}",iconOnlyWidth:"2rem"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}",iconOnlyWidth:"3rem"},label:{fontWeight:"500"},raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"},badgeSize:"1rem",transitionDuration:"{form.field.transition.duration}"},$C={light:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",borderColor:"{surface.100}",hoverBorderColor:"{surface.200}",activeBorderColor:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}",focusRing:{color:"{surface.600}",shadow:"none"}},info:{background:"{sky.500}",hoverBackground:"{sky.600}",activeBackground:"{sky.700}",borderColor:"{sky.500}",hoverBorderColor:"{sky.600}",activeBorderColor:"{sky.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{sky.500}",shadow:"none"}},success:{background:"{green.500}",hoverBackground:"{green.600}",activeBackground:"{green.700}",borderColor:"{green.500}",hoverBorderColor:"{green.600}",activeBorderColor:"{green.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{green.500}",shadow:"none"}},warn:{background:"{orange.500}",hoverBackground:"{orange.600}",activeBackground:"{orange.700}",borderColor:"{orange.500}",hoverBorderColor:"{orange.600}",activeBorderColor:"{orange.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{orange.500}",shadow:"none"}},help:{background:"{purple.500}",hoverBackground:"{purple.600}",activeBackground:"{purple.700}",borderColor:"{purple.500}",hoverBorderColor:"{purple.600}",activeBorderColor:"{purple.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{purple.500}",shadow:"none"}},danger:{background:"{red.500}",hoverBackground:"{red.600}",activeBackground:"{red.700}",borderColor:"{red.500}",hoverBorderColor:"{red.600}",activeBorderColor:"{red.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{red.500}",shadow:"none"}},contrast:{background:"{surface.950}",hoverBackground:"{surface.900}",activeBackground:"{surface.800}",borderColor:"{surface.950}",hoverBorderColor:"{surface.900}",activeBorderColor:"{surface.800}",color:"{surface.0}",hoverColor:"{surface.0}",activeColor:"{surface.0}",focusRing:{color:"{surface.950}",shadow:"none"}}},outlined:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",borderColor:"{primary.200}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",borderColor:"{green.200}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",borderColor:"{sky.200}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",borderColor:"{orange.200}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",borderColor:"{purple.200}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",borderColor:"{red.200}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.700}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.700}"}},text:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.700}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}},dark:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",borderColor:"{surface.800}",hoverBorderColor:"{surface.700}",activeBorderColor:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}",focusRing:{color:"{surface.300}",shadow:"none"}},info:{background:"{sky.400}",hoverBackground:"{sky.300}",activeBackground:"{sky.200}",borderColor:"{sky.400}",hoverBorderColor:"{sky.300}",activeBorderColor:"{sky.200}",color:"{sky.950}",hoverColor:"{sky.950}",activeColor:"{sky.950}",focusRing:{color:"{sky.400}",shadow:"none"}},success:{background:"{green.400}",hoverBackground:"{green.300}",activeBackground:"{green.200}",borderColor:"{green.400}",hoverBorderColor:"{green.300}",activeBorderColor:"{green.200}",color:"{green.950}",hoverColor:"{green.950}",activeColor:"{green.950}",focusRing:{color:"{green.400}",shadow:"none"}},warn:{background:"{orange.400}",hoverBackground:"{orange.300}",activeBackground:"{orange.200}",borderColor:"{orange.400}",hoverBorderColor:"{orange.300}",activeBorderColor:"{orange.200}",color:"{orange.950}",hoverColor:"{orange.950}",activeColor:"{orange.950}",focusRing:{color:"{orange.400}",shadow:"none"}},help:{background:"{purple.400}",hoverBackground:"{purple.300}",activeBackground:"{purple.200}",borderColor:"{purple.400}",hoverBorderColor:"{purple.300}",activeBorderColor:"{purple.200}",color:"{purple.950}",hoverColor:"{purple.950}",activeColor:"{purple.950}",focusRing:{color:"{purple.400}",shadow:"none"}},danger:{background:"{red.400}",hoverBackground:"{red.300}",activeBackground:"{red.200}",borderColor:"{red.400}",hoverBorderColor:"{red.300}",activeBorderColor:"{red.200}",color:"{red.950}",hoverColor:"{red.950}",activeColor:"{red.950}",focusRing:{color:"{red.400}",shadow:"none"}},contrast:{background:"{surface.0}",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{surface.0}",hoverBorderColor:"{surface.100}",activeBorderColor:"{surface.200}",color:"{surface.950}",hoverColor:"{surface.950}",activeColor:"{surface.950}",focusRing:{color:"{surface.0}",shadow:"none"}}},outlined:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",borderColor:"{primary.700}",color:"{primary.color}"},secondary:{hoverBackground:"rgba(255,255,255,0.04)",activeBackground:"rgba(255,255,255,0.16)",borderColor:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",borderColor:"{green.700}",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",borderColor:"{sky.700}",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",borderColor:"{orange.700}",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",borderColor:"{purple.700}",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",borderColor:"{red.700}",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.500}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.600}",color:"{surface.0}"}},text:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",color:"{primary.color}"},secondary:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}}},jC={root:OC,colorScheme:$C},NC={background:"{content.background}",borderRadius:"{border.radius.xl}",color:"{content.color}",shadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)"},VC={padding:"1.25rem",gap:"0.5rem"},UC={gap:"0.5rem"},ZC={fontSize:"1.25rem",fontWeight:"500"},GC={color:"{text.muted.color}"},qC={root:NC,body:VC,caption:UC,title:ZC,subtitle:GC},WC={transitionDuration:"{transition.duration}"},HC={gap:"0.25rem"},XC={padding:"1rem",gap:"0.5rem"},YC={width:"2rem",height:"0.5rem",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},KC={light:{indicator:{background:"{surface.200}",hoverBackground:"{surface.300}",activeBackground:"{primary.color}"}},dark:{indicator:{background:"{surface.700}",hoverBackground:"{surface.600}",activeBackground:"{primary.color}"}}},JC={root:WC,content:HC,indicatorList:XC,indicator:YC,colorScheme:KC},QC={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},eT={width:"2.5rem",color:"{form.field.icon.color}"},tT={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},rT={padding:"{list.padding}",gap:"{list.gap}",mobileIndent:"1rem"},oT={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",icon:{color:"{list.option.icon.color}",focusColor:"{list.option.icon.focus.color}",size:"0.875rem"}},iT={color:"{form.field.icon.color}"},nT={root:QC,dropdown:eT,overlay:tT,list:rT,option:oT,clearIcon:iT},sT={borderRadius:"{border.radius.sm}",width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},aT={size:"0.875rem",color:"{form.field.color}",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.75rem"},lg:{size:"1rem"}},lT={root:sT,icon:aT},cT={borderRadius:"16px",paddingX:"0.75rem",paddingY:"0.5rem",gap:"0.5rem",transitionDuration:"{transition.duration}"},uT={width:"2rem",height:"2rem"},hT={size:"1rem"},dT={size:"1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"}},fT={light:{root:{background:"{surface.100}",color:"{surface.800}"},icon:{color:"{surface.800}"},removeIcon:{color:"{surface.800}"}},dark:{root:{background:"{surface.800}",color:"{surface.0}"},icon:{color:"{surface.0}"},removeIcon:{color:"{surface.0}"}}},pT={root:cT,image:uT,icon:hT,removeIcon:dT,colorScheme:fT},mT={transitionDuration:"{transition.duration}"},gT={width:"1.5rem",height:"1.5rem",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},_T={shadow:"{overlay.popover.shadow}",borderRadius:"{overlay.popover.borderRadius}"},yT={light:{panel:{background:"{surface.800}",borderColor:"{surface.900}"},handle:{color:"{surface.0}"}},dark:{panel:{background:"{surface.900}",borderColor:"{surface.700}"},handle:{color:"{surface.0}"}}},vT={root:mT,preview:gT,panel:_T,colorScheme:yT},bT={size:"2rem",color:"{overlay.modal.color}"},xT={gap:"1rem"},wT={icon:bT,content:xT},CT={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},TT={padding:"{overlay.popover.padding}",gap:"1rem"},ST={size:"1.5rem",color:"{overlay.popover.color}"},kT={gap:"0.5rem",padding:"0 {overlay.popover.padding} {overlay.popover.padding} {overlay.popover.padding}"},PT={root:CT,content:TT,icon:ST,footer:kT},MT={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},IT={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},ET={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},AT={mobileIndent:"1rem"},zT={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},DT={borderColor:"{content.border.color}"},RT={root:MT,list:IT,item:ET,submenu:AT,submenuIcon:zT,separator:DT},LT={transitionDuration:"{transition.duration}"},BT={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},FT={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{datatable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},OT={fontWeight:"600"},$T={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},jT={borderColor:"{datatable.border.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},NT={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},VT={fontWeight:"600"},UT={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},ZT={color:"{primary.color}"},GT={width:"0.5rem"},qT={width:"1px",color:"{primary.color}"},WT={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},HT={size:"2rem"},XT={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},YT={inlineGap:"0.5rem",overlaySelect:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},overlayPopover:{background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}",gap:"0.5rem"},rule:{borderColor:"{content.border.color}"},constraintList:{padding:"{list.padding}",gap:"{list.gap}"},constraint:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",separator:{borderColor:"{content.border.color}"},padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"}},KT={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},JT={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},QT={light:{root:{borderColor:"{content.border.color}"},row:{stripedBackground:"{surface.50}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},row:{stripedBackground:"{surface.950}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},eS={root:LT,header:BT,headerCell:FT,columnTitle:OT,row:$T,bodyCell:jT,footerCell:NT,columnFooter:VT,footer:UT,dropPoint:ZT,columnResizer:GT,resizeIndicator:qT,sortIcon:WT,loadingIcon:HT,rowToggleButton:XT,filter:YT,paginatorTop:KT,paginatorBottom:JT,colorScheme:QT},tS={borderColor:"transparent",borderWidth:"0",borderRadius:"0",padding:"0"},rS={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",borderRadius:"0"},oS={background:"{content.background}",color:"{content.color}",borderColor:"transparent",borderWidth:"0",padding:"0",borderRadius:"0"},iS={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"1px 0 0 0",padding:"0.75rem 1rem",borderRadius:"0"},nS={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},sS={borderColor:"{content.border.color}",borderWidth:"1px 0 0 0"},aS={root:tS,header:rS,content:oS,footer:iS,paginatorTop:nS,paginatorBottom:sS},lS={transitionDuration:"{transition.duration}"},cS={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}"},uS={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",padding:"0 0 0.5rem 0"},hS={gap:"0.5rem",fontWeight:"500"},dS={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},fS={color:"{form.field.icon.color}"},pS={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},mS={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},gS={borderColor:"{content.border.color}",gap:"{overlay.popover.padding}"},_S={margin:"0.5rem 0 0 0"},yS={padding:"0.25rem",fontWeight:"500",color:"{content.color}"},vS={hoverBackground:"{content.hover.background}",selectedBackground:"{primary.color}",rangeSelectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{primary.contrast.color}",rangeSelectedColor:"{highlight.color}",width:"2rem",height:"2rem",borderRadius:"50%",padding:"0.25rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},bS={margin:"0.5rem 0 0 0"},xS={padding:"0.375rem",borderRadius:"{content.border.radius}"},wS={margin:"0.5rem 0 0 0"},CS={padding:"0.375rem",borderRadius:"{content.border.radius}"},TS={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}"},SS={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}",gap:"0.5rem",buttonGap:"0.25rem"},kS={light:{dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"},today:{background:"{surface.200}",color:"{surface.900}"}},dark:{dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"},today:{background:"{surface.700}",color:"{surface.0}"}}},PS={root:lS,panel:cS,header:uS,title:hS,dropdown:dS,inputIcon:fS,selectMonth:pS,selectYear:mS,group:gS,dayView:_S,weekDay:yS,date:vS,monthView:bS,month:xS,yearView:wS,year:CS,buttonbar:TS,timePicker:SS,colorScheme:kS},MS={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",borderRadius:"{overlay.modal.border.radius}",shadow:"{overlay.modal.shadow}"},IS={padding:"{overlay.modal.padding}",gap:"0.5rem"},ES={fontSize:"1.25rem",fontWeight:"600"},AS={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},zS={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}",gap:"0.5rem"},DS={root:MS,header:IS,title:ES,content:AS,footer:zS},RS={borderColor:"{content.border.color}"},LS={background:"{content.background}",color:"{text.color}"},BS={margin:"1rem 0",padding:"0 1rem",content:{padding:"0 0.5rem"}},FS={margin:"0 1rem",padding:"0.5rem 0",content:{padding:"0.5rem 0"}},OS={root:RS,content:LS,horizontal:BS,vertical:FS},$S={background:"rgba(255, 255, 255, 0.1)",borderColor:"rgba(255, 255, 255, 0.2)",padding:"0.5rem",borderRadius:"{border.radius.xl}"},jS={borderRadius:"{content.border.radius}",padding:"0.5rem",size:"3rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},NS={root:$S,item:jS},VS={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",shadow:"{overlay.modal.shadow}"},US={padding:"{overlay.modal.padding}"},ZS={fontSize:"1.5rem",fontWeight:"600"},GS={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},qS={padding:"{overlay.modal.padding}"},WS={root:VS,header:US,title:ZS,content:GS,footer:qS},HS={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}"},XS={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},YS={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}",padding:"{list.padding}"},KS={focusBackground:"{list.option.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},JS={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},QS={toolbar:HS,toolbarItem:XS,overlay:YS,overlayOption:KS,content:JS},ek={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",padding:"0 1.125rem 1.125rem 1.125rem",transitionDuration:"{transition.duration}"},tk={background:"{content.background}",hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",borderRadius:"{content.border.radius}",borderWidth:"1px",borderColor:"transparent",padding:"0.5rem 0.75rem",gap:"0.5rem",fontWeight:"600",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},rk={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}"},ok={padding:"0"},ik={root:ek,legend:tk,toggleIcon:rk,content:ok},nk={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},sk={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"unset",borderWidth:"0",borderRadius:"0",gap:"0.5rem"},ak={highlightBorderColor:"{primary.color}",padding:"0 1.125rem 1.125rem 1.125rem",gap:"1rem"},lk={padding:"1rem",gap:"1rem",borderColor:"{content.border.color}",info:{gap:"0.5rem"}},ck={gap:"0.5rem"},uk={height:"0.25rem"},hk={gap:"0.5rem"},dk={root:nk,header:sk,content:ak,file:lk,fileList:ck,progressbar:uk,basic:hk},fk={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",activeColor:"{form.field.float.label.active.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",positionY:"{form.field.padding.y}",fontWeight:"500",active:{fontSize:"0.75rem",fontWeight:"400"}},pk={active:{top:"-1.25rem"}},mk={input:{paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},active:{top:"{form.field.padding.y}"}},gk={borderRadius:"{border.radius.xs}",active:{background:"{form.field.background}",padding:"0 0.125rem"}},_k={root:fk,over:pk,in:mk,on:gk},yk={borderWidth:"1px",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},vk={background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.100}",hoverColor:"{surface.0}",size:"3rem",gutter:"0.5rem",prev:{borderRadius:"50%"},next:{borderRadius:"50%"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},bk={size:"1.5rem"},xk={background:"{content.background}",padding:"1rem 0.25rem"},wk={size:"2rem",borderRadius:"{content.border.radius}",gutter:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Ck={size:"1rem"},Tk={background:"rgba(0, 0, 0, 0.5)",color:"{surface.100}",padding:"1rem"},Sk={gap:"0.5rem",padding:"1rem"},kk={width:"1rem",height:"1rem",activeBackground:"{primary.color}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Pk={background:"rgba(0, 0, 0, 0.5)"},Mk={background:"rgba(255, 255, 255, 0.4)",hoverBackground:"rgba(255, 255, 255, 0.6)",activeBackground:"rgba(255, 255, 255, 0.9)"},Ik={size:"3rem",gutter:"0.5rem",background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.50}",hoverColor:"{surface.0}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Ek={size:"1.5rem"},Ak={light:{thumbnailNavButton:{hoverBackground:"{surface.100}",color:"{surface.600}",hoverColor:"{surface.700}"},indicatorButton:{background:"{surface.200}",hoverBackground:"{surface.300}"}},dark:{thumbnailNavButton:{hoverBackground:"{surface.700}",color:"{surface.400}",hoverColor:"{surface.0}"},indicatorButton:{background:"{surface.700}",hoverBackground:"{surface.600}"}}},zk={root:yk,navButton:vk,navIcon:bk,thumbnailsContent:xk,thumbnailNavButton:wk,thumbnailNavButtonIcon:Ck,caption:Tk,indicatorList:Sk,indicatorButton:kk,insetIndicatorList:Pk,insetIndicatorButton:Mk,closeButton:Ik,closeButtonIcon:Ek,colorScheme:Ak},Dk={color:"{form.field.icon.color}"},Rk={icon:Dk},Lk={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",top:"{form.field.padding.y}",fontSize:"0.75rem",fontWeight:"400"},Bk={paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},Fk={root:Lk,input:Bk},Ok={transitionDuration:"{transition.duration}"},$k={icon:{size:"1.5rem"},mask:{background:"{mask.background}",color:"{mask.color}"}},jk={position:{left:"auto",right:"1rem",top:"1rem",bottom:"auto"},blur:"8px",background:"rgba(255,255,255,0.1)",borderColor:"rgba(255,255,255,0.2)",borderWidth:"1px",borderRadius:"30px",padding:".5rem",gap:"0.5rem"},Nk={hoverBackground:"rgba(255,255,255,0.1)",color:"{surface.50}",hoverColor:"{surface.0}",size:"3rem",iconSize:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Vk={root:Ok,preview:$k,toolbar:jk,action:Nk},Uk={size:"15px",hoverSize:"30px",background:"rgba(255,255,255,0.3)",hoverBackground:"rgba(255,255,255,0.3)",borderColor:"unset",hoverBorderColor:"unset",borderWidth:"0",borderRadius:"50%",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"rgba(255,255,255,0.3)",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Zk={handle:Uk},Gk={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",gap:"0.5rem"},qk={fontWeight:"500"},Wk={size:"1rem"},Hk={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}}},Xk={root:Gk,text:qk,icon:Wk,colorScheme:Hk},Yk={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{transition.duration}"},Kk={hoverBackground:"{content.hover.background}",hoverColor:"{content.hover.color}"},Jk={root:Yk,display:Kk},Qk={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},eP={borderRadius:"{border.radius.sm}"},tP={light:{chip:{focusBackground:"{surface.200}",color:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",color:"{surface.0}"}}},rP={root:Qk,chip:eP,colorScheme:tP},oP={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.icon.color}",borderRadius:"{form.field.border.radius}",padding:"0.5rem",minWidth:"2.5rem"},iP={addon:oP},nP={transitionDuration:"{transition.duration}"},sP={width:"2.5rem",borderRadius:"{form.field.border.radius}",verticalPadding:"{form.field.padding.y}"},aP={light:{button:{background:"transparent",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.500}",activeColor:"{surface.600}"}},dark:{button:{background:"transparent",hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.300}",activeColor:"{surface.200}"}}},lP={root:nP,button:sP,colorScheme:aP},cP={gap:"0.5rem"},uP={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"}},hP={root:cP,input:uP},dP={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},fP={root:dP},pP={transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},mP={background:"{primary.color}"},gP={background:"{content.border.color}"},_P={color:"{text.muted.color}"},yP={root:pP,value:mP,range:gP,text:_P},vP={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",borderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",shadow:"{form.field.shadow}",borderRadius:"{form.field.border.radius}",transitionDuration:"{form.field.transition.duration}"},bP={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},xP={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},wP={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},CP={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},TP={padding:"{list.option.padding}"},SP={light:{option:{stripedBackground:"{surface.50}"}},dark:{option:{stripedBackground:"{surface.900}"}}},kP={root:vP,list:bP,option:xP,optionGroup:wP,checkmark:CP,emptyMessage:TP,colorScheme:SP},PP={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",verticalOrientation:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},horizontalOrientation:{padding:"0.5rem 0.75rem",gap:"0.5rem"},transitionDuration:"{transition.duration}"},MP={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},IP={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},EP={padding:"0",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",shadow:"{overlay.navigation.shadow}",gap:"0.5rem"},AP={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},zP={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background.}",color:"{navigation.submenu.label.color}"},DP={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},RP={borderColor:"{content.border.color}"},LP={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},BP={root:PP,baseItem:MP,item:IP,overlay:EP,submenu:AP,submenuLabel:zP,submenuIcon:DP,separator:RP,mobileButton:LP},FP={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},OP={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},$P={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},jP={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background}",color:"{navigation.submenu.label.color}"},NP={borderColor:"{content.border.color}"},VP={root:FP,list:OP,item:$P,submenuLabel:jP,separator:NP},UP={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.5rem 0.75rem",transitionDuration:"{transition.duration}"},ZP={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},GP={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},qP={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",mobileIndent:"1rem",icon:{size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"}},WP={borderColor:"{content.border.color}"},HP={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},XP={root:UP,baseItem:ZP,item:GP,submenu:qP,separator:WP,mobileButton:HP},YP={borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},KP={padding:"0.5rem 0.75rem",gap:"0.5rem",sm:{padding:"0.375rem 0.625rem"},lg:{padding:"0.625rem 0.875rem"}},JP={fontSize:"1rem",fontWeight:"500",sm:{fontSize:"0.875rem"},lg:{fontSize:"1.125rem"}},QP={size:"1.125rem",sm:{size:"1rem"},lg:{size:"1.25rem"}},eM={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},tM={size:"1rem",sm:{size:"0.875rem"},lg:{size:"1.125rem"}},rM={root:{borderWidth:"1px"}},oM={content:{padding:"0"}},iM={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}},outlined:{color:"{blue.600}",borderColor:"{blue.600}"},simple:{color:"{blue.600}"}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}},outlined:{color:"{green.600}",borderColor:"{green.600}"},simple:{color:"{green.600}"}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}},outlined:{color:"{yellow.600}",borderColor:"{yellow.600}"},simple:{color:"{yellow.600}"}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}},outlined:{color:"{red.600}",borderColor:"{red.600}"},simple:{color:"{red.600}"}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}},outlined:{color:"{surface.500}",borderColor:"{surface.500}"},simple:{color:"{surface.500}"}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}},outlined:{color:"{surface.950}",borderColor:"{surface.950}"},simple:{color:"{surface.950}"}}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}},outlined:{color:"{blue.500}",borderColor:"{blue.500}"},simple:{color:"{blue.500}"}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}},outlined:{color:"{green.500}",borderColor:"{green.500}"},simple:{color:"{green.500}"}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}},outlined:{color:"{yellow.500}",borderColor:"{yellow.500}"},simple:{color:"{yellow.500}"}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}},outlined:{color:"{red.500}",borderColor:"{red.500}"},simple:{color:"{red.500}"}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}},outlined:{color:"{surface.400}",borderColor:"{surface.400}"},simple:{color:"{surface.400}"}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}},outlined:{color:"{surface.0}",borderColor:"{surface.0}"},simple:{color:"{surface.0}"}}}},nM={root:YP,content:KP,text:JP,icon:QP,closeButton:eM,closeIcon:tM,outlined:rM,simple:oM,colorScheme:iM},sM={borderRadius:"{content.border.radius}",gap:"1rem"},aM={background:"{content.border.color}",size:"0.5rem"},lM={gap:"0.5rem"},cM={size:"0.5rem"},uM={size:"1rem"},hM={verticalGap:"0.5rem",horizontalGap:"1rem"},dM={root:sM,meters:aM,label:lM,labelMarker:cM,labelIcon:uM,labelList:hM},fM={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},pM={width:"2.5rem",color:"{form.field.icon.color}"},mM={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},gM={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},_M={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",gap:"0.5rem"},yM={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},vM={color:"{form.field.icon.color}"},bM={borderRadius:"{border.radius.sm}"},xM={padding:"{list.option.padding}"},wM={root:fM,dropdown:pM,overlay:mM,list:gM,option:_M,optionGroup:yM,chip:bM,clearIcon:vM,emptyMessage:xM},CM={gap:"1.125rem"},TM={gap:"0.5rem"},SM={root:CM,controls:TM},kM={gutter:"0.75rem",transitionDuration:"{transition.duration}"},PM={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{content.border.color}",color:"{content.color}",selectedColor:"{highlight.color}",hoverColor:"{content.hover.color}",padding:"0.75rem 1rem",toggleablePadding:"0.75rem 1rem 1.25rem 1rem",borderRadius:"{content.border.radius}"},MM={background:"{content.background}",hoverBackground:"{content.hover.background}",borderColor:"{content.border.color}",color:"{text.muted.color}",hoverColor:"{text.color}",size:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},IM={color:"{content.border.color}",borderRadius:"{content.border.radius}",height:"24px"},EM={root:kM,node:PM,nodeToggleButton:MM,connector:IM},AM={outline:{width:"2px",color:"{content.background}"}},zM={root:AM},DM={padding:"0.5rem 1rem",gap:"0.25rem",borderRadius:"{content.border.radius}",background:"{content.background}",color:"{content.color}",transitionDuration:"{transition.duration}"},RM={background:"transparent",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}",width:"2.5rem",height:"2.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},LM={color:"{text.muted.color}"},BM={maxWidth:"2.5rem"},FM={root:DM,navButton:RM,currentPageReport:LM,jumpToPageInput:BM},OM={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},$M={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"{content.border.color}",borderWidth:"0",borderRadius:"0"},jM={padding:"0.375rem 1.125rem"},NM={fontWeight:"600"},VM={padding:"0 1.125rem 1.125rem 1.125rem"},UM={padding:"0 1.125rem 1.125rem 1.125rem"},ZM={root:OM,header:$M,toggleableHeader:jM,title:NM,content:VM,footer:UM},GM={gap:"0.5rem",transitionDuration:"{transition.duration}"},qM={background:"{content.background}",borderColor:"{content.border.color}",borderWidth:"1px",color:"{content.color}",padding:"0.25rem 0.25rem",borderRadius:"{content.border.radius}",first:{borderWidth:"1px",topBorderRadius:"{content.border.radius}"},last:{borderWidth:"1px",bottomBorderRadius:"{content.border.radius}"}},WM={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",gap:"0.5rem",padding:"{navigation.item.padding}",borderRadius:"{content.border.radius}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},HM={indent:"1rem"},XM={color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}"},YM={root:GM,panel:qM,item:WM,submenu:HM,submenuIcon:XM},KM={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:".75rem"},JM={color:"{form.field.icon.color}"},QM={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",padding:"{overlay.popover.padding}",shadow:"{overlay.popover.shadow}"},eI={gap:"0.5rem"},tI={light:{strength:{weakBackground:"{red.500}",mediumBackground:"{amber.500}",strongBackground:"{green.500}"}},dark:{strength:{weakBackground:"{red.400}",mediumBackground:"{amber.400}",strongBackground:"{green.400}"}}},rI={meter:KM,icon:JM,overlay:QM,content:eI,colorScheme:tI},oI={gap:"1.125rem"},iI={gap:"0.5rem"},nI={root:oI,controls:iI},sI={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},aI={padding:"{overlay.popover.padding}"},lI={root:sI,content:aI},cI={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:"1.25rem"},uI={background:"{primary.color}"},hI={color:"{primary.contrast.color}",fontSize:"0.75rem",fontWeight:"600"},dI={root:cI,value:uI,label:hI},fI={light:{root:{colorOne:"{red.500}",colorTwo:"{blue.500}",colorThree:"{green.500}",colorFour:"{yellow.500}"}},dark:{root:{colorOne:"{red.400}",colorTwo:"{blue.400}",colorThree:"{green.400}",colorFour:"{yellow.400}"}}},pI={colorScheme:fI},mI={width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},gI={size:"0.75rem",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.5rem"},lg:{size:"1rem"}},_I={root:mI,icon:gI},yI={gap:"0.25rem",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},vI={size:"1rem",color:"{text.muted.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"},bI={root:yI,icon:vI},xI={light:{root:{background:"rgba(0,0,0,0.1)"}},dark:{root:{background:"rgba(255,255,255,0.3)"}}},wI={colorScheme:xI},CI={transitionDuration:"{transition.duration}"},TI={size:"9px",borderRadius:"{border.radius.sm}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},SI={light:{bar:{background:"{surface.100}"}},dark:{bar:{background:"{surface.800}"}}},kI={root:CI,bar:TI,colorScheme:SI},PI={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},MI={width:"2.5rem",color:"{form.field.icon.color}"},II={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},EI={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},AI={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},zI={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},DI={color:"{form.field.icon.color}"},RI={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},LI={padding:"{list.option.padding}"},BI={root:PI,dropdown:MI,overlay:II,list:EI,option:AI,optionGroup:zI,clearIcon:DI,checkmark:RI,emptyMessage:LI},FI={borderRadius:"{form.field.border.radius}"},OI={light:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}},dark:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}}},$I={root:FI,colorScheme:OI},jI={borderRadius:"{content.border.radius}"},NI={light:{root:{background:"{surface.200}",animationBackground:"rgba(255,255,255,0.4)"}},dark:{root:{background:"rgba(255, 255, 255, 0.06)",animationBackground:"rgba(255, 255, 255, 0.04)"}}},VI={root:jI,colorScheme:NI},UI={transitionDuration:"{transition.duration}"},ZI={background:"{content.border.color}",borderRadius:"{content.border.radius}",size:"3px"},GI={background:"{primary.color}"},qI={width:"20px",height:"20px",borderRadius:"50%",background:"{content.border.color}",hoverBackground:"{content.border.color}",content:{borderRadius:"50%",hoverBackground:"{content.background}",width:"16px",height:"16px",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.08), 0px 1px 1px 0px rgba(0, 0, 0, 0.14)"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},WI={light:{handle:{content:{background:"{surface.0}"}}},dark:{handle:{content:{background:"{surface.950}"}}}},HI={root:UI,track:ZI,range:GI,handle:qI,colorScheme:WI},XI={gap:"0.5rem",transitionDuration:"{transition.duration}"},YI={root:XI},KI={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)"},JI={root:KI},QI={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",transitionDuration:"{transition.duration}"},eE={background:"{content.border.color}"},tE={size:"24px",background:"transparent",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},rE={root:QI,gutter:eE,handle:tE},oE={transitionDuration:"{transition.duration}"},iE={background:"{content.border.color}",activeBackground:"{primary.color}",margin:"0 0 0 1.625rem",size:"2px"},nE={padding:"0.5rem",gap:"1rem"},sE={padding:"0",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},aE={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},lE={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},cE={padding:"0.875rem 0.5rem 1.125rem 0.5rem"},uE={background:"{content.background}",color:"{content.color}",padding:"0",indent:"1rem"},hE={root:oE,separator:iE,step:nE,stepHeader:sE,stepTitle:aE,stepNumber:lE,steppanels:cE,steppanel:uE},dE={transitionDuration:"{transition.duration}"},fE={background:"{content.border.color}"},pE={borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},mE={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},gE={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},_E={root:dE,separator:fE,itemLink:pE,itemLabel:mE,itemNumber:gE},yE={transitionDuration:"{transition.duration}"},vE={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},bE={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},xE={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},wE={height:"1px",bottom:"-1px",background:"{primary.color}"},CE={root:yE,tablist:vE,item:bE,itemIcon:xE,activeBar:wE},TE={transitionDuration:"{transition.duration}"},SE={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},kE={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},PE={background:"{content.background}",color:"{content.color}",padding:"0.875rem 1.125rem 1.125rem 1.125rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"inset {focus.ring.shadow}"}},ME={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",width:"2.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},IE={height:"1px",bottom:"-1px",background:"{primary.color}"},EE={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},AE={root:TE,tablist:SE,tab:kE,tabpanel:PE,navButton:ME,activeBar:IE,colorScheme:EE},zE={transitionDuration:"{transition.duration}"},DE={background:"{content.background}",borderColor:"{content.border.color}"},RE={borderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},LE={background:"{content.background}",color:"{content.color}"},BE={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}"},FE={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},OE={root:zE,tabList:DE,tab:RE,tabPanel:LE,navButton:BE,colorScheme:FE},$E={fontSize:"0.875rem",fontWeight:"700",padding:"0.25rem 0.5rem",gap:"0.25rem",borderRadius:"{content.border.radius}",roundedBorderRadius:"{border.radius.xl}"},jE={size:"0.75rem"},NE={light:{primary:{background:"{primary.100}",color:"{primary.700}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.100}",color:"{green.700}"},info:{background:"{sky.100}",color:"{sky.700}"},warn:{background:"{orange.100}",color:"{orange.700}"},danger:{background:"{red.100}",color:"{red.700}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"color-mix(in srgb, {primary.500}, transparent 84%)",color:"{primary.300}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",color:"{green.300}"},info:{background:"color-mix(in srgb, {sky.500}, transparent 84%)",color:"{sky.300}"},warn:{background:"color-mix(in srgb, {orange.500}, transparent 84%)",color:"{orange.300}"},danger:{background:"color-mix(in srgb, {red.500}, transparent 84%)",color:"{red.300}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},VE={root:$E,icon:jE,colorScheme:NE},UE={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.color}",height:"18rem",padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{form.field.border.radius}"},ZE={gap:"0.25rem"},GE={margin:"2px 0"},qE={root:UE,prompt:ZE,commandResponse:GE},WE={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},HE={root:WE},XE={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},YE={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},KE={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},JE={mobileIndent:"1rem"},QE={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},eA={borderColor:"{content.border.color}"},tA={root:XE,list:YE,item:KE,submenu:JE,submenuIcon:QE,separator:eA},rA={minHeight:"5rem"},oA={eventContent:{padding:"1rem 0"}},iA={eventContent:{padding:"0 1rem"}},nA={size:"1.125rem",borderRadius:"50%",borderWidth:"2px",background:"{content.background}",borderColor:"{content.border.color}",content:{borderRadius:"50%",size:"0.375rem",background:"{primary.color}",insetShadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"}},sA={color:"{content.border.color}",size:"2px"},aA={event:rA,horizontal:oA,vertical:iA,eventMarker:nA,eventConnector:sA},lA={width:"25rem",borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},cA={size:"1.125rem"},uA={padding:"{overlay.popover.padding}",gap:"0.5rem"},hA={gap:"0.5rem"},dA={fontWeight:"500",fontSize:"1rem"},fA={fontWeight:"500",fontSize:"0.875rem"},pA={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},mA={size:"1rem"},gA={light:{blur:"1.5px",info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}}}},dark:{blur:"10px",info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",detailColor:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}}}}},_A={root:lA,icon:cA,content:uA,text:hA,summary:dA,detail:fA,closeButton:pA,closeIcon:mA,colorScheme:gA},yA={padding:"0.25rem",borderRadius:"{content.border.radius}",gap:"0.5rem",fontWeight:"500",disabledBackground:"{form.field.disabled.background}",disabledBorderColor:"{form.field.disabled.background}",disabledColor:"{form.field.disabled.color}",invalidBorderColor:"{form.field.invalid.border.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",padding:"0.25rem"},lg:{fontSize:"{form.field.lg.font.size}",padding:"0.25rem"}},vA={disabledColor:"{form.field.disabled.color}"},bA={padding:"0.25rem 0.75rem",borderRadius:"{content.border.radius}",checkedShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.02), 0px 1px 2px 0px rgba(0, 0, 0, 0.04)",sm:{padding:"0.25rem 0.75rem"},lg:{padding:"0.25rem 0.75rem"}},xA={light:{root:{background:"{surface.100}",checkedBackground:"{surface.100}",hoverBackground:"{surface.100}",borderColor:"{surface.100}",color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}",checkedBorderColor:"{surface.100}"},content:{checkedBackground:"{surface.0}"},icon:{color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}"}},dark:{root:{background:"{surface.950}",checkedBackground:"{surface.950}",hoverBackground:"{surface.950}",borderColor:"{surface.950}",color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}",checkedBorderColor:"{surface.950}"},content:{checkedBackground:"{surface.800}"},icon:{color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}"}}},wA={root:yA,icon:vA,content:bA,colorScheme:xA},CA={width:"2.5rem",height:"1.5rem",borderRadius:"30px",gap:"0.25rem",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},borderWidth:"1px",borderColor:"transparent",hoverBorderColor:"transparent",checkedBorderColor:"transparent",checkedHoverBorderColor:"transparent",invalidBorderColor:"{form.field.invalid.border.color}",transitionDuration:"{form.field.transition.duration}",slideDuration:"0.2s"},TA={borderRadius:"50%",size:"1rem"},SA={light:{root:{background:"{surface.300}",disabledBackground:"{form.field.disabled.background}",hoverBackground:"{surface.400}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.0}",disabledBackground:"{form.field.disabled.color}",hoverBackground:"{surface.0}",checkedBackground:"{surface.0}",checkedHoverBackground:"{surface.0}",color:"{text.muted.color}",hoverColor:"{text.color}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}},dark:{root:{background:"{surface.700}",disabledBackground:"{surface.600}",hoverBackground:"{surface.600}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.400}",disabledBackground:"{surface.900}",hoverBackground:"{surface.300}",checkedBackground:"{surface.900}",checkedHoverBackground:"{surface.900}",color:"{surface.900}",hoverColor:"{surface.800}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}}},kA={root:CA,handle:TA,colorScheme:SA},PA={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.75rem"},MA={root:PA},IA={maxWidth:"12.5rem",gutter:"0.25rem",shadow:"{overlay.popover.shadow}",padding:"0.5rem 0.75rem",borderRadius:"{overlay.popover.border.radius}"},EA={light:{root:{background:"{surface.700}",color:"{surface.0}"}},dark:{root:{background:"{surface.700}",color:"{surface.0}"}}},AA={root:IA,colorScheme:EA},zA={background:"{content.background}",color:"{content.color}",padding:"1rem",gap:"2px",indent:"1rem",transitionDuration:"{transition.duration}"},DA={padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.color}",hoverColor:"{text.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},gap:"0.25rem"},RA={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}"},LA={borderRadius:"50%",size:"1.75rem",hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedHoverColor:"{primary.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},BA={size:"2rem"},FA={margin:"0 0 0.5rem 0"},OA={root:zA,node:DA,nodeIcon:RA,nodeToggleButton:LA,loadingIcon:BA,filter:FA},$A={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},jA={width:"2.5rem",color:"{form.field.icon.color}"},NA={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},VA={padding:"{list.padding}"},UA={padding:"{list.option.padding}"},ZA={borderRadius:"{border.radius.sm}"},GA={color:"{form.field.icon.color}"},qA={root:$A,dropdown:jA,overlay:NA,tree:VA,emptyMessage:UA,chip:ZA,clearIcon:GA},WA={transitionDuration:"{transition.duration}"},HA={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},XA={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{treetable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},YA={fontWeight:"600"},KA={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},JA={borderColor:"{treetable.border.color}",padding:"0.75rem 1rem",gap:"0.5rem"},QA={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",padding:"0.75rem 1rem"},e5={fontWeight:"600"},t5={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},r5={width:"0.5rem"},o5={width:"1px",color:"{primary.color}"},i5={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},n5={size:"2rem"},s5={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},a5={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},l5={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},c5={light:{root:{borderColor:"{content.border.color}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},u5={root:WA,header:HA,headerCell:XA,columnTitle:YA,row:KA,bodyCell:JA,footerCell:QA,columnFooter:e5,footer:t5,columnResizer:r5,resizeIndicator:o5,sortIcon:i5,loadingIcon:n5,nodeToggleButton:s5,paginatorTop:a5,paginatorBottom:l5,colorScheme:c5},h5={mask:{background:"{content.background}",color:"{text.muted.color}"},icon:{size:"2rem"}},d5={loader:h5},f5=Object.defineProperty,p5=Object.defineProperties,m5=Object.getOwnPropertyDescriptors,ty=Object.getOwnPropertySymbols,g5=Object.prototype.hasOwnProperty,_5=Object.prototype.propertyIsEnumerable,ry=(n,s,d)=>s in n?f5(n,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):n[s]=d,oy,y5=(oy=((n,s)=>{for(var d in s||(s={}))g5.call(s,d)&&ry(n,d,s[d]);if(ty)for(var d of ty(s))_5.call(s,d)&&ry(n,d,s[d]);return n})({},AC),p5(oy,m5({components:{accordion:nC,autocomplete:mC,avatar:xC,badge:MC,blockui:DC,breadcrumb:FC,button:jC,card:qC,carousel:JC,cascadeselect:nT,checkbox:lT,chip:pT,colorpicker:vT,confirmdialog:wT,confirmpopup:PT,contextmenu:RT,datatable:eS,dataview:aS,datepicker:PS,dialog:DS,divider:OS,dock:NS,drawer:WS,editor:QS,fieldset:ik,fileupload:dk,floatlabel:_k,galleria:zk,iconfield:Rk,iftalabel:Fk,image:Vk,imagecompare:Zk,inlinemessage:Xk,inplace:Jk,inputchips:rP,inputgroup:iP,inputnumber:lP,inputotp:hP,inputtext:fP,knob:yP,listbox:kP,megamenu:BP,menu:VP,menubar:XP,message:nM,metergroup:dM,multiselect:wM,orderlist:SM,organizationchart:EM,overlaybadge:zM,paginator:FM,panel:ZM,panelmenu:YM,password:rI,picklist:nI,popover:lI,progressbar:dI,progressspinner:pI,radiobutton:_I,rating:bI,ripple:wI,scrollpanel:kI,select:BI,selectbutton:$I,skeleton:VI,slider:HI,speeddial:YI,splitbutton:JI,splitter:rE,stepper:hE,steps:_E,tabmenu:CE,tabs:AE,tabview:OE,tag:VE,terminal:qE,textarea:HE,tieredmenu:tA,timeline:aA,toast:_A,togglebutton:wA,toggleswitch:kA,toolbar:MA,tooltip:AA,tree:OA,treeselect:qA,treetable:u5,virtualscroller:d5}})));function v5(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var hd={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.2.0/LICENSE.txt
 */var b5=hd.exports,iy;function x5(){return iy||(iy=1,function(n,s){(function(d,_){n.exports=_()})(b5,function(){var d={},_={};function x(b,c,z){if(_[b]=z,b==="index"){var U="var sharedModule = {}; ("+_.shared+")(sharedModule); ("+_.worker+")(sharedModule);",V={};return _.shared(V),_.index(d,V),typeof window<"u"&&d.setWorkerUrl(window.URL.createObjectURL(new Blob([U],{type:"text/javascript"}))),d}}x("shared",["exports"],function(b){function c(o,t,i,a){return new(i||(i=Promise))(function(h,m){function g(S){try{C(a.next(S))}catch(M){m(M)}}function v(S){try{C(a.throw(S))}catch(M){m(M)}}function C(S){var M;S.done?h(S.value):(M=S.value,M instanceof i?M:new i(function(I){I(M)})).then(g,v)}C((a=a.apply(o,t||[])).next())})}function z(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var U,V;function H(){if(V)return U;function o(t,i){this.x=t,this.y=i}return V=1,U=o,o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,i){return this.clone()._rotateAround(t,i)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var i=t.x-this.x,a=t.y-this.y;return i*i+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,i){return Math.atan2(this.x*i-this.y*t,this.x*t+this.y*i)},_matMult:function(t){var i=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var i=Math.cos(t),a=Math.sin(t),h=a*this.x+i*this.y;return this.x=i*this.x-a*this.y,this.y=h,this},_rotateAround:function(t,i){var a=Math.cos(t),h=Math.sin(t),m=i.y+h*(this.x-i.x)+a*(this.y-i.y);return this.x=i.x+a*(this.x-i.x)-h*(this.y-i.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t},U}typeof SuppressedError=="function"&&SuppressedError;var Q,G,se=z(H()),Me=function(){if(G)return Q;function o(t,i,a,h){this.cx=3*t,this.bx=3*(a-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(h-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=a,this.p2y=h}return G=1,Q=o,o.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,i){if(i===void 0&&(i=1e-6),t<0)return 0;if(t>1)return 1;for(var a=t,h=0;h<8;h++){var m=this.sampleCurveX(a)-t;if(Math.abs(m)<i)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=m/g}var v=0,C=1;for(a=t,h=0;h<20&&(m=this.sampleCurveX(a),!(Math.abs(m-t)<i));h++)t>m?v=a:C=a,a=.5*(C-v)+v;return a},solve:function(t,i){return this.sampleCurveY(this.solveCurveX(t,i))}},Q}(),rt=z(Me);let He,lt;function st(){return He==null&&(He=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),He}function Te(){if(lt==null&&(lt=!1,st())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let a=0;a<5*5;a++){const h=4*a;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(a%5,Math.floor(a/5),1,1)}const i=t.getImageData(0,0,5,5).data;for(let a=0;a<5*5*4;a++)if(a%4!=3&&i[a]!==a){lt=!0;break}}}return lt||!1}var Ye,dt=1e-6,_t=typeof Float32Array<"u"?Float32Array:Array;function nt(){var o=new _t(9);return _t!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function Je(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function bt(){var o=new _t(3);return _t!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function zt(o,t,i){var a=new _t(3);return a[0]=o,a[1]=t,a[2]=i,a}function De(o,t,i){var a=t[0],h=t[1],m=t[2],g=t[3];return o[0]=i[0]*a+i[4]*h+i[8]*m+i[12]*g,o[1]=i[1]*a+i[5]*h+i[9]*m+i[13]*g,o[2]=i[2]*a+i[6]*h+i[10]*m+i[14]*g,o[3]=i[3]*a+i[7]*h+i[11]*m+i[15]*g,o}function Ge(){var o=new _t(4);return _t!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function et(){var o=new _t(2);return _t!=Float32Array&&(o[0]=0,o[1]=0),o}function Dt(o,t){var i=new _t(2);return i[0]=o,i[1]=t,i}Math.hypot||(Math.hypot=function(){for(var o=0,t=arguments.length;t--;)o+=arguments[t]*arguments[t];return Math.sqrt(o)}),bt(),Ye=new _t(4),_t!=Float32Array&&(Ye[0]=0,Ye[1]=0,Ye[2]=0,Ye[3]=0),bt(),zt(1,0,0),zt(0,1,0),Ge(),Ge(),nt(),et();const ft=8192;function wt(o,t,i){return t*(ft/(o.tileSize*Math.pow(2,i-o.tileID.overscaledZ)))}function Et(o,t){return(o%t+t)%t}function sr(o,t,i){return o*(1-i)+t*i}function cr(o){if(o<=0)return 0;if(o>=1)return 1;const t=o*o,i=t*o;return 4*(o<.5?i:3*(o-t)+i-.75)}function or(o,t,i,a){const h=new rt(o,t,i,a);return m=>h.solve(m)}const qt=or(.25,.1,.25,1);function Sr(o,t,i){return Math.min(i,Math.max(t,o))}function Mr(o,t,i){const a=i-t,h=((o-t)%a+a)%a+t;return h===t?i:h}function br(o,...t){for(const i of t)for(const a in i)o[a]=i[a];return o}let qr=1;function bo(o,t,i){const a={};for(const h in o)a[h]=t.call(this,o[h],h,o);return a}function Uo(o,t,i){const a={};for(const h in o)t.call(this,o[h],h,o)&&(a[h]=o[h]);return a}function ro(o){return Array.isArray(o)?o.map(ro):typeof o=="object"&&o?bo(o,ro):o}const Zo={};function Wr(o){Zo[o]||(typeof console<"u"&&console.warn(o),Zo[o]=!0)}function ae(o,t,i){return(i.y-o.y)*(t.x-o.x)>(t.y-o.y)*(i.x-o.x)}function pe(o){return typeof WorkerGlobalScope<"u"&&o!==void 0&&o instanceof WorkerGlobalScope}let ke=null;function qe(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}const Ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ve(o,t,i,a,h){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(o,{timestamp:0});try{const g=m==null?void 0:m.format;if(!g||!g.startsWith("BGR")&&!g.startsWith("RGB"))throw new Error(`Unrecognized format ${g}`);const v=g.startsWith("BGR"),C=new Uint8ClampedArray(a*h*4);if(yield m.copyTo(C,function(S,M,I,L,F){const O=4*Math.max(1,0),j=(Math.max(0,I)-I)*L*4+O,W=4*L,ee=Math.max(0,M),de=Math.max(0,I);return{rect:{x:ee,y:de,width:Math.min(S.width,M+L)-ee,height:Math.min(S.height,I+F)-de},layout:[{offset:j,stride:W}]}}(o,t,i,a,h)),v)for(let S=0;S<C.length;S+=4){const M=C[S];C[S]=C[S+2],C[S+2]=M}return C}finally{m.close()}})}let it,ot;function Qe(o,t,i,a){return o.addEventListener(t,i,a),{unsubscribe:()=>{o.removeEventListener(t,i,a)}}}function Ue(o){return o/Math.PI*180}const Pt="AbortError";function at(){return new Error(Pt)}const Ct={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Rt(o){return Ct.REGISTERED_PROTOCOLS[o.substring(0,o.indexOf("://"))]}const $t="global-dispatcher";class Ht extends Error{constructor(t,i,a,h){super(`AJAXError: ${i} (${t}): ${a}`),this.status=t,this.statusText=i,this.url=a,this.body=h}}const Ut=()=>pe(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Br=function(o,t){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){const a=Rt(o.url);if(a)return a(o,t);if(pe(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,targetMapId:$t},t)}if(!(/^file:/.test(i=o.url)||/^file:/.test(Ut())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(a,h){return c(this,void 0,void 0,function*(){const m=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,cache:a.cache,referrer:Ut(),signal:h.signal});let g,v;a.type!=="json"||m.headers.has("Accept")||m.headers.set("Accept","application/json");try{g=yield fetch(m)}catch(S){throw new Ht(0,S.message,a.url,new Blob)}if(!g.ok){const S=yield g.blob();throw new Ht(g.status,g.statusText,a.url,S)}v=a.type==="arrayBuffer"||a.type==="image"?g.arrayBuffer():a.type==="json"?g.json():g.text();const C=yield v;if(h.signal.aborted)throw at();return{data:C,cacheControl:g.headers.get("Cache-Control"),expires:g.headers.get("Expires")}})}(o,t);if(pe(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,mustQueue:!0,targetMapId:$t},t)}var i;return function(a,h){return new Promise((m,g)=>{var v;const C=new XMLHttpRequest;C.open(a.method||"GET",a.url,!0),a.type!=="arrayBuffer"&&a.type!=="image"||(C.responseType="arraybuffer");for(const S in a.headers)C.setRequestHeader(S,a.headers[S]);a.type==="json"&&(C.responseType="text",!((v=a.headers)===null||v===void 0)&&v.Accept||C.setRequestHeader("Accept","application/json")),C.withCredentials=a.credentials==="include",C.onerror=()=>{g(new Error(C.statusText))},C.onload=()=>{if(!h.signal.aborted)if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){let S=C.response;if(a.type==="json")try{S=JSON.parse(C.response)}catch(M){return void g(M)}m({data:S,cacheControl:C.getResponseHeader("Cache-Control"),expires:C.getResponseHeader("Expires")})}else{const S=new Blob([C.response],{type:C.getResponseHeader("Content-Type")});g(new Ht(C.status,C.statusText,a.url,S))}},h.signal.addEventListener("abort",()=>{C.abort(),g(at())}),C.send(a.body)})}(o,t)};function Ir(o){if(!o||o.indexOf("://")<=0||o.indexOf("data:image/")===0||o.indexOf("blob:")===0)return!0;const t=new URL(o),i=window.location;return t.protocol===i.protocol&&t.host===i.host}function xo(o,t,i){i[o]&&i[o].indexOf(t)!==-1||(i[o]=i[o]||[],i[o].push(t))}function ho(o,t,i){if(i&&i[o]){const a=i[o].indexOf(t);a!==-1&&i[o].splice(a,1)}}class _i{constructor(t,i={}){br(this,i),this.type=t}}class oi extends _i{constructor(t,i={}){super("error",br({error:t},i))}}class ge{on(t,i){return this._listeners=this._listeners||{},xo(t,i,this._listeners),{unsubscribe:()=>{this.off(t,i)}}}off(t,i){return ho(t,i,this._listeners),ho(t,i,this._oneTimeListeners),this}once(t,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},xo(t,i,this._oneTimeListeners),this):new Promise(a=>this.once(t,a))}fire(t,i){typeof t=="string"&&(t=new _i(t,i||{}));const a=t.type;if(this.listens(a)){t.target=this;const h=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const v of h)v.call(this,t);const m=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const v of m)ho(a,v,this._oneTimeListeners),v.call(this,t);const g=this._eventedParent;g&&(br(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(t))}else t instanceof oi&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,i){return this._eventedParent=t,this._eventedParentData=i,this}}var A={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Z=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function X(o,t){const i={};for(const a in o)a!=="ref"&&(i[a]=o[a]);return Z.forEach(a=>{a in t&&(i[a]=t[a])}),i}function te(o,t){if(Array.isArray(o)){if(!Array.isArray(t)||o.length!==t.length)return!1;for(let i=0;i<o.length;i++)if(!te(o[i],t[i]))return!1;return!0}if(typeof o=="object"&&o!==null&&t!==null){if(typeof t!="object"||Object.keys(o).length!==Object.keys(t).length)return!1;for(const i in o)if(!te(o[i],t[i]))return!1;return!0}return o===t}function ce(o,t){o.push(t)}function _e(o,t,i){ce(i,{command:"addSource",args:[o,t[o]]})}function Ce(o,t,i){ce(t,{command:"removeSource",args:[o]}),i[o]=!0}function me(o,t,i,a){Ce(o,i,a),_e(o,t,i)}function ze(o,t,i){let a;for(a in o[i])if(Object.prototype.hasOwnProperty.call(o[i],a)&&a!=="data"&&!te(o[i][a],t[i][a]))return!1;for(a in t[i])if(Object.prototype.hasOwnProperty.call(t[i],a)&&a!=="data"&&!te(o[i][a],t[i][a]))return!1;return!0}function Pe(o,t,i,a,h,m){o=o||{},t=t||{};for(const g in o)Object.prototype.hasOwnProperty.call(o,g)&&(te(o[g],t[g])||i.push({command:m,args:[a,g,t[g],h]}));for(const g in t)Object.prototype.hasOwnProperty.call(t,g)&&!Object.prototype.hasOwnProperty.call(o,g)&&(te(o[g],t[g])||i.push({command:m,args:[a,g,t[g],h]}))}function ye(o){return o.id}function Fe(o,t){return o[t.id]=t,o}class ve{constructor(t,i,a,h){this.message=(t?`${t}: `:"")+a,h&&(this.identifier=h),i!=null&&i.__line__&&(this.line=i.__line__)}}function tt(o,...t){for(const i of t)for(const a in i)o[a]=i[a];return o}class yt extends Error{constructor(t,i){super(i),this.message=i,this.key=t}}class Lt{constructor(t,i=[]){this.parent=t,this.bindings={};for(const[a,h]of i)this.bindings[a]=h}concat(t){return new Lt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const It={kind:"null"},Be={kind:"number"},pt={kind:"string"},ht={kind:"boolean"},Ot={kind:"color"},At={kind:"projectionDefinition"},jt={kind:"object"},Tt={kind:"value"},mn={kind:"collator"},Vr={kind:"formatted"},Hr={kind:"padding"},_r={kind:"resolvedImage"},_a={kind:"variableAnchorOffsetCollection"};function zo(o,t){return{kind:"array",itemType:o,N:t}}function ur(o){if(o.kind==="array"){const t=ur(o.itemType);return typeof o.N=="number"?`array<${t}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${t}>`}return o.kind}const $u=[It,Be,pt,ht,Ot,At,Vr,jt,zo(Tt),Hr,_r,_a];function Ds(o,t){if(t.kind==="error")return null;if(o.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Ds(o.itemType,t.itemType))&&(typeof o.N!="number"||o.N===t.N))return null}else{if(o.kind===t.kind)return null;if(o.kind==="value"){for(const i of $u)if(!Ds(i,t))return null}}return`Expected ${ur(o)} but found ${ur(t)} instead.`}function Rl(o,t){return t.some(i=>i.kind===o.kind)}function Ji(o,t){return t.some(i=>i==="null"?o===null:i==="array"?Array.isArray(o):i==="object"?o&&!Array.isArray(o)&&typeof o=="object":i===typeof o)}function qn(o,t){return o.kind==="array"&&t.kind==="array"?o.itemType.kind===t.itemType.kind&&typeof o.N=="number":o.kind===t.kind}const Ll=.96422,ju=.82521,Nu=4/29,Wn=6/29,Vu=3*Wn*Wn,Ud=Wn*Wn*Wn,Zd=Math.PI/180,Gd=180/Math.PI;function Bl(o){return(o%=360)<0&&(o+=360),o}function Hn([o,t,i,a]){let h,m;const g=Ol((.2225045*(o=Fl(o))+.7168786*(t=Fl(t))+.0606169*(i=Fl(i)))/1);o===t&&t===i?h=m=g:(h=Ol((.4360747*o+.3850649*t+.1430804*i)/Ll),m=Ol((.0139322*o+.0971045*t+.7141733*i)/ju));const v=116*g-16;return[v<0?0:v,500*(h-g),200*(g-m),a]}function Fl(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function Ol(o){return o>Ud?Math.pow(o,1/3):o/Vu+Nu}function Xn([o,t,i,a]){let h=(o+16)/116,m=isNaN(t)?h:h+t/500,g=isNaN(i)?h:h-i/200;return h=1*jl(h),m=Ll*jl(m),g=ju*jl(g),[$l(3.1338561*m-1.6168667*h-.4906146*g),$l(-.9787684*m+1.9161415*h+.033454*g),$l(.0719453*m-.2289914*h+1.4052427*g),a]}function $l(o){return(o=o<=.00304?12.92*o:1.055*Math.pow(o,1/2.4)-.055)<0?0:o>1?1:o}function jl(o){return o>Wn?o*o*o:Vu*(o-Nu)}function ya(o){return parseInt(o.padEnd(2,o),16)/255}function Nl(o,t){return gn(t?o/100:o,0,1)}function gn(o,t,i){return Math.min(Math.max(t,o),i)}function yi(o){return!o.some(Number.isNaN)}const Yt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Go(o,t,i){return o+i*(t-o)}function ii(o,t,i){return o.map((a,h)=>Go(a,t[h],i))}class Kt{constructor(t,i,a,h=1,m=!0){this.r=t,this.g=i,this.b=a,this.a=h,m||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,i,a,h]))}static parse(t){if(t instanceof Kt)return t;if(typeof t!="string")return;const i=function(a){if((a=a.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=Yt[a];if(h){const[g,v,C]=h;return[g/255,v/255,C/255,1]}if(a.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(a)){const g=a.length<6?1:2;let v=1;return[ya(a.slice(v,v+=g)),ya(a.slice(v,v+=g)),ya(a.slice(v,v+=g)),ya(a.slice(v,v+g)||"ff")]}if(a.startsWith("rgb")){const g=a.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[v,C,S,M,I,L,F,O,j,W,ee,de]=g,oe=[M||" ",F||" ",W].join("");if(oe==="  "||oe==="  /"||oe===",,"||oe===",,,"){const B=[S,L,j].join(""),q=B==="%%%"?100:B===""?255:0;if(q){const ie=[gn(+C/q,0,1),gn(+I/q,0,1),gn(+O/q,0,1),ee?Nl(+ee,de):1];if(yi(ie))return ie}}return}}const m=a.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[g,v,C,S,M,I,L,F,O]=m,j=[C||" ",M||" ",L].join("");if(j==="  "||j==="  /"||j===",,"||j===",,,"){const W=[+v,gn(+S,0,100),gn(+I,0,100),F?Nl(+F,O):1];if(yi(W))return function([ee,de,oe,B]){function q(ie){const xe=(ie+ee/30)%12,Oe=de*Math.min(oe,1-oe);return oe-Oe*Math.max(-1,Math.min(xe-3,9-xe,1))}return ee=Bl(ee),de/=100,oe/=100,[q(0),q(8),q(4),B]}(W)}}}(t);return i?new Kt(...i,!1):void 0}get rgb(){const{r:t,g:i,b:a,a:h}=this,m=h||1/0;return this.overwriteGetter("rgb",[t/m,i/m,a/m,h])}get hcl(){return this.overwriteGetter("hcl",function(t){const[i,a,h,m]=Hn(t),g=Math.sqrt(a*a+h*h);return[Math.round(1e4*g)?Bl(Math.atan2(h,a)*Gd):NaN,g,i,m]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Hn(this.rgb))}overwriteGetter(t,i){return Object.defineProperty(this,t,{value:i}),i}toString(){const[t,i,a,h]=this.rgb;return`rgba(${[t,i,a].map(m=>Math.round(255*m)).join(",")},${h})`}static interpolate(t,i,a,h="rgb"){switch(h){case"rgb":{const[m,g,v,C]=ii(t.rgb,i.rgb,a);return new Kt(m,g,v,C,!1)}case"hcl":{const[m,g,v,C]=t.hcl,[S,M,I,L]=i.hcl;let F,O;if(isNaN(m)||isNaN(S))isNaN(m)?isNaN(S)?F=NaN:(F=S,v!==1&&v!==0||(O=M)):(F=m,I!==1&&I!==0||(O=g));else{let oe=S-m;S>m&&oe>180?oe-=360:S<m&&m-S>180&&(oe+=360),F=m+a*oe}const[j,W,ee,de]=function([oe,B,q,ie]){return oe=isNaN(oe)?0:oe*Zd,Xn([q,Math.cos(oe)*B,Math.sin(oe)*B,ie])}([F,O??Go(g,M,a),Go(v,I,a),Go(C,L,a)]);return new Kt(j,W,ee,de,!1)}case"lab":{const[m,g,v,C]=Xn(ii(t.lab,i.lab,a));return new Kt(m,g,v,C,!1)}}}}Kt.black=new Kt(0,0,0,1),Kt.white=new Kt(1,1,1,1),Kt.transparent=new Kt(0,0,0,0),Kt.red=new Kt(1,0,0,1);class va{constructor(t,i,a){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,i){return this.collator.compare(t,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Vl=["bottom","center","top"];class ni{constructor(t,i,a,h,m,g){this.text=t,this.image=i,this.scale=a,this.fontStack=h,this.textColor=m,this.verticalAlign=g}}class fo{constructor(t){this.sections=t}static fromString(t){return new fo([new ni(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof fo?t:fo.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class oo{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof oo)return t;if(typeof t=="number")return new oo([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const i of t)if(typeof i!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new oo(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,i,a){return new oo(ii(t.values,i.values,a))}}class Er{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Ul=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class io{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof io)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let i=0;i<t.length;i+=2){const a=t[i],h=t[i+1];if(typeof a!="string"||!Ul.has(a)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new io(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,i,a){const h=t.values,m=i.values;if(h.length!==m.length)throw new Er(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${i.toString()}`);const g=[];for(let v=0;v<h.length;v+=2){if(h[v]!==m[v])throw new Er(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${h[v]}, to[${v}]: ${m[v]}`);g.push(h[v]);const[C,S]=h[v+1],[M,I]=m[v+1];g.push([Go(C,M,a),Go(S,I,a)])}return new io(g)}}class Po{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Po({name:t,available:!1}):null}}class Do{constructor(t,i,a){this.from=t,this.to=i,this.transition=a}static interpolate(t,i,a){return new Do(t,i,a)}static parse(t){return t instanceof Do?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Do(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Do(t.from,t.to,t.transition):typeof t=="string"?new Do(t,t,1):void 0}}function ba(o,t,i,a){return typeof o=="number"&&o>=0&&o<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[o,t,i,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[o,t,i,a]:[o,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function vi(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof Do||o instanceof Kt||o instanceof va||o instanceof fo||o instanceof oo||o instanceof io||o instanceof Po)return!0;if(Array.isArray(o)){for(const t of o)if(!vi(t))return!1;return!0}if(typeof o=="object"){for(const t in o)if(!vi(o[t]))return!1;return!0}return!1}function Ur(o){if(o===null)return It;if(typeof o=="string")return pt;if(typeof o=="boolean")return ht;if(typeof o=="number")return Be;if(o instanceof Kt)return Ot;if(o instanceof Do)return At;if(o instanceof va)return mn;if(o instanceof fo)return Vr;if(o instanceof oo)return Hr;if(o instanceof io)return _a;if(o instanceof Po)return _r;if(Array.isArray(o)){const t=o.length;let i;for(const a of o){const h=Ur(a);if(i){if(i===h)continue;i=Tt;break}i=h}return zo(i||Tt,t)}return jt}function Qi(o){const t=typeof o;return o===null?"":t==="string"||t==="number"||t==="boolean"?String(o):o instanceof Kt||o instanceof Do||o instanceof fo||o instanceof oo||o instanceof io||o instanceof Po?o.toString():JSON.stringify(o)}class si{constructor(t,i){this.type=t,this.value=i}static parse(t,i){if(t.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!vi(t[1]))return i.error("invalid value");const a=t[1];let h=Ur(a);const m=i.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new si(h,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Rs={string:pt,number:Be,boolean:ht,object:jt};class ai{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let a,h=1;const m=t[0];if(m==="array"){let v,C;if(t.length>2){const S=t[1];if(typeof S!="string"||!(S in Rs)||S==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);v=Rs[S],h++}else v=Tt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);C=t[2],h++}a=zo(v,C)}else{if(!Rs[m])throw new Error(`Types doesn't contain name = ${m}`);a=Rs[m]}const g=[];for(;h<t.length;h++){const v=i.parse(t[h],h,Tt);if(!v)return null;g.push(v)}return new ai(a,g)}evaluate(t){for(let i=0;i<this.args.length;i++){const a=this.args[i].evaluate(t);if(!Ds(this.type,Ur(a)))return a;if(i===this.args.length-1)throw new Er(`Expected value to be of type ${ur(this.type)}, but found ${ur(Ur(a))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Zl={"to-boolean":ht,"to-color":Ot,"to-number":Be,"to-string":pt};class bi{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const a=t[0];if(!Zl[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&t.length!==2)return i.error("Expected one argument.");const h=Zl[a],m=[];for(let g=1;g<t.length;g++){const v=i.parse(t[g],g,Tt);if(!v)return null;m.push(v)}return new bi(h,m)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let i,a;for(const h of this.args){if(i=h.evaluate(t),a=null,i instanceof Kt)return i;if(typeof i=="string"){const m=t.parseColor(i);if(m)return m}else if(Array.isArray(i)&&(a=i.length<3||i.length>4?`Invalid rgba value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:ba(i[0],i[1],i[2],i[3]),!a))return new Kt(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Er(a||`Could not parse color from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"padding":{let i;for(const a of this.args){i=a.evaluate(t);const h=oo.parse(i);if(h)return h}throw new Er(`Could not parse padding from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"variableAnchorOffsetCollection":{let i;for(const a of this.args){i=a.evaluate(t);const h=io.parse(i);if(h)return h}throw new Er(`Could not parse variableAnchorOffsetCollection from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"number":{let i=null;for(const a of this.args){if(i=a.evaluate(t),i===null)return 0;const h=Number(i);if(!isNaN(h))return h}throw new Er(`Could not convert ${JSON.stringify(i)} to number.`)}case"formatted":return fo.fromString(Qi(this.args[0].evaluate(t)));case"resolvedImage":return Po.fromString(Qi(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return Qi(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const xr=["Unknown","Point","LineString","Polygon"];class xa{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?xr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let i=this._parseColorCache[t];return i||(i=this._parseColorCache[t]=Kt.parse(t)),i}}class Wt{constructor(t,i,a=[],h,m=new Lt,g=[]){this.registry=t,this.path=a,this.key=a.map(v=>`[${v}]`).join(""),this.scope=m,this.errors=g,this.expectedType=h,this._isConstant=i}parse(t,i,a,h,m={}){return i?this.concat(i,a,h)._parse(t,m):this._parse(t,m)}_parse(t,i){function a(h,m,g){return g==="assert"?new ai(m,[h]):g==="coerce"?new bi(m,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let g=m.parse(t,this);if(!g)return null;if(this.expectedType){const v=this.expectedType,C=g.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||C.kind!=="value")if(v.kind!=="projectionDefinition"||C.kind!=="string"&&C.kind!=="array")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string")if(v.kind!=="padding"||C.kind!=="value"&&C.kind!=="number"&&C.kind!=="array")if(v.kind!=="variableAnchorOffsetCollection"||C.kind!=="value"&&C.kind!=="array"){if(this.checkSubtype(v,C))return null}else g=a(g,v,i.typeAnnotation||"coerce");else g=a(g,v,i.typeAnnotation||"coerce");else g=a(g,v,i.typeAnnotation||"coerce");else g=a(g,v,i.typeAnnotation||"coerce");else g=a(g,v,i.typeAnnotation||"assert")}if(!(g instanceof si)&&g.type.kind!=="resolvedImage"&&this._isConstant(g)){const v=new xa;try{g=new si(g.type,g.evaluate(v))}catch(C){return this.error(C.message),null}}return g}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,i,a){const h=typeof t=="number"?this.path.concat(t):this.path,m=a?this.scope.concat(a):this.scope;return new Wt(this.registry,this._isConstant,h,i||null,m,this.errors)}error(t,...i){const a=`${this.key}${i.map(h=>`[${h}]`).join("")}`;this.errors.push(new yt(a,t))}checkSubtype(t,i){const a=Ds(t,i);return a&&this.error(a),a}}class Ft{constructor(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const i of this.bindings)t(i[1]);t(this.result)}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const a=[];for(let m=1;m<t.length-1;m+=2){const g=t[m];if(typeof g!="string")return i.error(`Expected string, but found ${typeof g} instead.`,m);if(/[^a-zA-Z0-9_]/.test(g))return i.error("Variable names must contain only alphanumeric characters or '_'.",m);const v=i.parse(t[m+1],m+1);if(!v)return null;a.push([g,v])}const h=i.parse(t[t.length-1],t.length-1,i.expectedType,a);return h?new Ft(a,h):null}outputDefined(){return this.result.outputDefined()}}class Yn{constructor(t,i){this.type=i.type,this.name=t,this.boundExpression=i}static parse(t,i){if(t.length!==2||typeof t[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const a=t[1];return i.scope.has(a)?new Yn(a,i.scope.get(a)):i.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Xt{constructor(t,i,a){this.type=t,this.index=i,this.input=a}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const a=i.parse(t[1],1,Be),h=i.parse(t[2],2,zo(i.expectedType||Tt));return a&&h?new Xt(h.type.itemType,a,h):null}evaluate(t){const i=this.index.evaluate(t),a=this.input.evaluate(t);if(i<0)throw new Er(`Array index out of bounds: ${i} < 0.`);if(i>=a.length)throw new Er(`Array index out of bounds: ${i} > ${a.length-1}.`);if(i!==Math.floor(i))throw new Er(`Array index must be an integer, but found ${i} instead.`);return a[i]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Ls{constructor(t,i){this.type=ht,this.needle=t,this.haystack=i}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const a=i.parse(t[1],1,Tt),h=i.parse(t[2],2,Tt);return a&&h?Rl(a.type,[ht,pt,Be,It,Tt])?new Ls(a,h):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ur(a.type)} instead`):null}evaluate(t){const i=this.needle.evaluate(t),a=this.haystack.evaluate(t);if(!a)return!1;if(!Ji(i,["boolean","string","number","null"]))throw new Er(`Expected first argument to be of type boolean, string, number or null, but found ${ur(Ur(i))} instead.`);if(!Ji(a,["string","array"]))throw new Er(`Expected second argument to be of type array or string, but found ${ur(Ur(a))} instead.`);return a.indexOf(i)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class li{constructor(t,i,a){this.type=Be,this.needle=t,this.haystack=i,this.fromIndex=a}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const a=i.parse(t[1],1,Tt),h=i.parse(t[2],2,Tt);if(!a||!h)return null;if(!Rl(a.type,[ht,pt,Be,It,Tt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ur(a.type)} instead`);if(t.length===4){const m=i.parse(t[3],3,Be);return m?new li(a,h,m):null}return new li(a,h)}evaluate(t){const i=this.needle.evaluate(t),a=this.haystack.evaluate(t);if(!Ji(i,["boolean","string","number","null"]))throw new Er(`Expected first argument to be of type boolean, string, number or null, but found ${ur(Ur(i))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(t)),Ji(a,["string"])){const m=a.indexOf(i,h);return m===-1?-1:[...a.slice(0,m)].length}if(Ji(a,["array"]))return a.indexOf(i,h);throw new Er(`Expected second argument to be of type array or string, but found ${ur(Ur(a))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Bs{constructor(t,i,a,h,m,g){this.inputType=t,this.type=i,this.input=a,this.cases=h,this.outputs=m,this.otherwise=g}static parse(t,i){if(t.length<5)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return i.error("Expected an even number of arguments.");let a,h;i.expectedType&&i.expectedType.kind!=="value"&&(h=i.expectedType);const m={},g=[];for(let S=2;S<t.length-1;S+=2){let M=t[S];const I=t[S+1];Array.isArray(M)||(M=[M]);const L=i.concat(S);if(M.length===0)return L.error("Expected at least one branch label.");for(const O of M){if(typeof O!="number"&&typeof O!="string")return L.error("Branch labels must be numbers or strings.");if(typeof O=="number"&&Math.abs(O)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof O=="number"&&Math.floor(O)!==O)return L.error("Numeric branch labels must be integer values.");if(a){if(L.checkSubtype(a,Ur(O)))return null}else a=Ur(O);if(m[String(O)]!==void 0)return L.error("Branch labels must be unique.");m[String(O)]=g.length}const F=i.parse(I,S,h);if(!F)return null;h=h||F.type,g.push(F)}const v=i.parse(t[1],1,Tt);if(!v)return null;const C=i.parse(t[t.length-1],t.length-1,h);return C?v.type.kind!=="value"&&i.concat(1).checkSubtype(a,v.type)?null:new Bs(a,h,v,m,g,C):null}evaluate(t){const i=this.input.evaluate(t);return(Ur(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class wa{constructor(t,i,a){this.type=t,this.branches=i,this.otherwise=a}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return i.error("Expected an odd number of arguments.");let a;i.expectedType&&i.expectedType.kind!=="value"&&(a=i.expectedType);const h=[];for(let g=1;g<t.length-1;g+=2){const v=i.parse(t[g],g,ht);if(!v)return null;const C=i.parse(t[g+1],g+1,a);if(!C)return null;h.push([v,C]),a=a||C.type}const m=i.parse(t[t.length-1],t.length-1,a);if(!m)return null;if(!a)throw new Error("Can't infer output type");return new wa(a,h,m)}evaluate(t){for(const[i,a]of this.branches)if(i.evaluate(t))return a.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[i,a]of this.branches)t(i),t(a);t(this.otherwise)}outputDefined(){return this.branches.every(([t,i])=>i.outputDefined())&&this.otherwise.outputDefined()}}class Fs{constructor(t,i,a,h){this.type=t,this.input=i,this.beginIndex=a,this.endIndex=h}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const a=i.parse(t[1],1,Tt),h=i.parse(t[2],2,Be);if(!a||!h)return null;if(!Rl(a.type,[zo(Tt),pt,Tt]))return i.error(`Expected first argument to be of type array or string, but found ${ur(a.type)} instead`);if(t.length===4){const m=i.parse(t[3],3,Be);return m?new Fs(a.type,a,h,m):null}return new Fs(a.type,a,h)}evaluate(t){const i=this.input.evaluate(t),a=this.beginIndex.evaluate(t);let h;if(this.endIndex&&(h=this.endIndex.evaluate(t)),Ji(i,["string"]))return[...i].slice(a,h).join("");if(Ji(i,["array"]))return i.slice(a,h);throw new Er(`Expected first argument to be of type array or string, but found ${ur(Ur(i))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Kn(o,t){const i=o.length-1;let a,h,m=0,g=i,v=0;for(;m<=g;)if(v=Math.floor((m+g)/2),a=o[v],h=o[v+1],a<=t){if(v===i||t<h)return v;m=v+1}else{if(!(a>t))throw new Er("Input is not a number.");g=v-1}return 0}class Jn{constructor(t,i,a){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(const[h,m]of a)this.labels.push(h),this.outputs.push(m)}static parse(t,i){if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");const a=i.parse(t[1],1,Be);if(!a)return null;const h=[];let m=null;i.expectedType&&i.expectedType.kind!=="value"&&(m=i.expectedType);for(let g=1;g<t.length;g+=2){const v=g===1?-1/0:t[g],C=t[g+1],S=g,M=g+1;if(typeof v!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(h.length&&h[h.length-1][0]>=v)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',S);const I=i.parse(C,M,m);if(!I)return null;m=m||I.type,h.push([v,I])}return new Jn(m,a,h)}evaluate(t){const i=this.labels,a=this.outputs;if(i.length===1)return a[0].evaluate(t);const h=this.input.evaluate(t);if(h<=i[0])return a[0].evaluate(t);const m=i.length;return h>=i[m-1]?a[m-1].evaluate(t):a[Kn(i,h)].evaluate(t)}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function qd(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Ca,Gl,Os=function(){if(Gl)return Ca;function o(t,i,a,h){this.cx=3*t,this.bx=3*(a-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(h-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=a,this.p2y=h}return Gl=1,Ca=o,o.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,i){if(i===void 0&&(i=1e-6),t<0)return 0;if(t>1)return 1;for(var a=t,h=0;h<8;h++){var m=this.sampleCurveX(a)-t;if(Math.abs(m)<i)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=m/g}var v=0,C=1;for(a=t,h=0;h<20&&(m=this.sampleCurveX(a),!(Math.abs(m-t)<i));h++)t>m?v=a:C=a,a=.5*(C-v)+v;return a},solve:function(t,i){return this.sampleCurveY(this.solveCurveX(t,i))}},Ca}(),wo=qd(Os);class Co{constructor(t,i,a,h,m){this.type=t,this.operator=i,this.interpolation=a,this.input=h,this.labels=[],this.outputs=[];for(const[g,v]of m)this.labels.push(g),this.outputs.push(v)}static interpolationFactor(t,i,a,h){let m=0;if(t.name==="exponential")m=Ta(i,t.base,a,h);else if(t.name==="linear")m=Ta(i,1,a,h);else if(t.name==="cubic-bezier"){const g=t.controlPoints;m=new wo(g[0],g[1],g[2],g[3]).solve(Ta(i,1,a,h))}return m}static parse(t,i){let[a,h,m,...g]=t;if(!Array.isArray(h)||h.length===0)return i.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const S=h[1];if(typeof S!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:S}}else{if(h[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const S=h.slice(1);if(S.length!==4||S.some(M=>typeof M!="number"||M<0||M>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:S}}}if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(m=i.parse(m,2,Be),!m)return null;const v=[];let C=null;a==="interpolate-hcl"||a==="interpolate-lab"?C=Ot:i.expectedType&&i.expectedType.kind!=="value"&&(C=i.expectedType);for(let S=0;S<g.length;S+=2){const M=g[S],I=g[S+1],L=S+3,F=S+4;if(typeof M!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(v.length&&v[v.length-1][0]>=M)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const O=i.parse(I,F,C);if(!O)return null;C=C||O.type,v.push([M,O])}return qn(C,Be)||qn(C,At)||qn(C,Ot)||qn(C,Hr)||qn(C,_a)||qn(C,zo(Be))?new Co(C,a,h,m,v):i.error(`Type ${ur(C)} is not interpolatable.`)}evaluate(t){const i=this.labels,a=this.outputs;if(i.length===1)return a[0].evaluate(t);const h=this.input.evaluate(t);if(h<=i[0])return a[0].evaluate(t);const m=i.length;if(h>=i[m-1])return a[m-1].evaluate(t);const g=Kn(i,h),v=Co.interpolationFactor(this.interpolation,h,i[g],i[g+1]),C=a[g].evaluate(t),S=a[g+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Go(C,S,v);case"color":return Kt.interpolate(C,S,v);case"padding":return oo.interpolate(C,S,v);case"variableAnchorOffsetCollection":return io.interpolate(C,S,v);case"array":return ii(C,S,v);case"projectionDefinition":return Do.interpolate(C,S,v)}case"interpolate-hcl":return Kt.interpolate(C,S,v,"hcl");case"interpolate-lab":return Kt.interpolate(C,S,v,"lab")}}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Ta(o,t,i,a){const h=a-i,m=o-i;return h===0?0:t===1?m/h:(Math.pow(t,m)-1)/(Math.pow(t,h)-1)}const qo={color:Kt.interpolate,number:Go,padding:oo.interpolate,variableAnchorOffsetCollection:io.interpolate,array:ii};class Or{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let a=null;const h=i.expectedType;h&&h.kind!=="value"&&(a=h);const m=[];for(const v of t.slice(1)){const C=i.parse(v,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!C)return null;a=a||C.type,m.push(C)}if(!a)throw new Error("No output type");const g=h&&m.some(v=>Ds(h,v.type));return new Or(g?Tt:a,m)}evaluate(t){let i,a=null,h=0;for(const m of this.args)if(h++,a=m.evaluate(t),a&&a instanceof Po&&!a.available&&(i||(i=a.name),a=null,h===this.args.length&&(a=i)),a!==null)break;return a}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function ql(o,t){return o==="=="||o==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Sa(o,t,i,a){return a.compare(t,i)===0}function _n(o,t,i){const a=o!=="=="&&o!=="!=";return class ov{constructor(m,g,v){this.type=ht,this.lhs=m,this.rhs=g,this.collator=v,this.hasUntypedArgument=m.type.kind==="value"||g.type.kind==="value"}static parse(m,g){if(m.length!==3&&m.length!==4)return g.error("Expected two or three arguments.");const v=m[0];let C=g.parse(m[1],1,Tt);if(!C)return null;if(!ql(v,C.type))return g.concat(1).error(`"${v}" comparisons are not supported for type '${ur(C.type)}'.`);let S=g.parse(m[2],2,Tt);if(!S)return null;if(!ql(v,S.type))return g.concat(2).error(`"${v}" comparisons are not supported for type '${ur(S.type)}'.`);if(C.type.kind!==S.type.kind&&C.type.kind!=="value"&&S.type.kind!=="value")return g.error(`Cannot compare types '${ur(C.type)}' and '${ur(S.type)}'.`);a&&(C.type.kind==="value"&&S.type.kind!=="value"?C=new ai(S.type,[C]):C.type.kind!=="value"&&S.type.kind==="value"&&(S=new ai(C.type,[S])));let M=null;if(m.length===4){if(C.type.kind!=="string"&&S.type.kind!=="string"&&C.type.kind!=="value"&&S.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(M=g.parse(m[3],3,mn),!M)return null}return new ov(C,S,M)}evaluate(m){const g=this.lhs.evaluate(m),v=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const C=Ur(g),S=Ur(v);if(C.kind!==S.kind||C.kind!=="string"&&C.kind!=="number")throw new Er(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${C.kind}, ${S.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const C=Ur(g),S=Ur(v);if(C.kind!=="string"||S.kind!=="string")return t(m,g,v)}return this.collator?i(m,g,v,this.collator.evaluate(m)):t(m,g,v)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const Wd=_n("==",function(o,t,i){return t===i},Sa),ka=_n("!=",function(o,t,i){return t!==i},function(o,t,i,a){return!Sa(0,t,i,a)}),Wl=_n("<",function(o,t,i){return t<i},function(o,t,i,a){return a.compare(t,i)<0}),Hd=_n(">",function(o,t,i){return t>i},function(o,t,i,a){return a.compare(t,i)>0}),Pa=_n("<=",function(o,t,i){return t<=i},function(o,t,i,a){return a.compare(t,i)<=0}),Ma=_n(">=",function(o,t,i){return t>=i},function(o,t,i,a){return a.compare(t,i)>=0});class Ro{constructor(t,i,a){this.type=mn,this.locale=a,this.caseSensitive=t,this.diacriticSensitive=i}static parse(t,i){if(t.length!==2)return i.error("Expected one argument.");const a=t[1];if(typeof a!="object"||Array.isArray(a))return i.error("Collator options argument must be an object.");const h=i.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,ht);if(!h)return null;const m=i.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,ht);if(!m)return null;let g=null;return a.locale&&(g=i.parse(a.locale,1,pt),!g)?null:new Ro(h,m,g)}evaluate(t){return new va(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Ia{constructor(t,i,a,h,m){this.type=pt,this.number=t,this.locale=i,this.currency=a,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(t,i){if(t.length!==3)return i.error("Expected two arguments.");const a=i.parse(t[1],1,Be);if(!a)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return i.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=i.parse(h.locale,1,pt),!m))return null;let g=null;if(h.currency&&(g=i.parse(h.currency,1,pt),!g))return null;let v=null;if(h["min-fraction-digits"]&&(v=i.parse(h["min-fraction-digits"],1,Be),!v))return null;let C=null;return h["max-fraction-digits"]&&(C=i.parse(h["max-fraction-digits"],1,Be),!C)?null:new Ia(a,m,g,v,C)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class yn{constructor(t){this.type=Vr,this.sections=t}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const a=t[1];if(!Array.isArray(a)&&typeof a=="object")return i.error("First argument must be an image or text section.");const h=[];let m=!1;for(let g=1;g<=t.length-1;++g){const v=t[g];if(m&&typeof v=="object"&&!Array.isArray(v)){m=!1;let C=null;if(v["font-scale"]&&(C=i.parse(v["font-scale"],1,Be),!C))return null;let S=null;if(v["text-font"]&&(S=i.parse(v["text-font"],1,zo(pt)),!S))return null;let M=null;if(v["text-color"]&&(M=i.parse(v["text-color"],1,Ot),!M))return null;let I=null;if(v["vertical-align"]){if(typeof v["vertical-align"]=="string"&&!Vl.includes(v["vertical-align"]))return i.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${v["vertical-align"]}' instead.`);if(I=i.parse(v["vertical-align"],1,pt),!I)return null}const L=h[h.length-1];L.scale=C,L.font=S,L.textColor=M,L.verticalAlign=I}else{const C=i.parse(t[g],1,Tt);if(!C)return null;const S=C.type.kind;if(S!=="string"&&S!=="value"&&S!=="null"&&S!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:C,scale:null,font:null,textColor:null,verticalAlign:null})}}return new yn(h)}evaluate(t){return new fo(this.sections.map(i=>{const a=i.content.evaluate(t);return Ur(a)===_r?new ni("",a,null,null,null,i.verticalAlign?i.verticalAlign.evaluate(t):null):new ni(Qi(a),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null,i.verticalAlign?i.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const i of this.sections)t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor),i.verticalAlign&&t(i.verticalAlign)}outputDefined(){return!1}}class Hl{constructor(t){this.type=_r,this.input=t}static parse(t,i){if(t.length!==2)return i.error("Expected two arguments.");const a=i.parse(t[1],1,pt);return a?new Hl(a):i.error("No image name provided.")}evaluate(t){const i=this.input.evaluate(t),a=Po.fromString(i);return a&&t.availableImages&&(a.available=t.availableImages.indexOf(i)>-1),a}eachChild(t){t(this.input)}outputDefined(){return!1}}class $s{constructor(t){this.type=Be,this.input=t}static parse(t,i){if(t.length!==2)return i.error(`Expected 1 argument, but found ${t.length-1} instead.`);const a=i.parse(t[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${ur(a.type)} instead.`):new $s(a):null}evaluate(t){const i=this.input.evaluate(t);if(typeof i=="string")return[...i].length;if(Array.isArray(i))return i.length;throw new Er(`Expected value to be of type string or array, but found ${ur(Ur(i))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Ii=8192;function Xd(o,t){const i=(180+o[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(i*h*Ii),Math.round(a*h*Ii)]}function Xl(o,t){const i=Math.pow(2,t.z);return[(h=(o[0]/Ii+t.x)/i,360*h-180),(a=(o[1]/Ii+t.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90)];var a,h}function js(o,t){o[0]=Math.min(o[0],t[0]),o[1]=Math.min(o[1],t[1]),o[2]=Math.max(o[2],t[0]),o[3]=Math.max(o[3],t[1])}function en(o,t){return!(o[0]<=t[0]||o[2]>=t[2]||o[1]<=t[1]||o[3]>=t[3])}function Yd(o,t,i){const a=o[0]-t[0],h=o[1]-t[1],m=o[0]-i[0],g=o[1]-i[1];return a*g-m*h==0&&a*m<=0&&h*g<=0}function Ns(o,t,i,a){return(h=[a[0]-i[0],a[1]-i[1]])[0]*(m=[t[0]-o[0],t[1]-o[1]])[1]-h[1]*m[0]!=0&&!(!qu(o,t,i,a)||!qu(i,a,o,t));var h,m}function Uu(o,t,i){for(const a of i)for(let h=0;h<a.length-1;++h)if(Ns(o,t,a[h],a[h+1]))return!0;return!1}function Qn(o,t,i=!1){let a=!1;for(const v of t)for(let C=0;C<v.length-1;C++){if(Yd(o,v[C],v[C+1]))return i;(m=v[C])[1]>(h=o)[1]!=(g=v[C+1])[1]>h[1]&&h[0]<(g[0]-m[0])*(h[1]-m[1])/(g[1]-m[1])+m[0]&&(a=!a)}var h,m,g;return a}function Zu(o,t){for(const i of t)if(Qn(o,i))return!0;return!1}function Gu(o,t){for(const i of o)if(!Qn(i,t))return!1;for(let i=0;i<o.length-1;++i)if(Uu(o[i],o[i+1],t))return!1;return!0}function Kd(o,t){for(const i of t)if(Gu(o,i))return!0;return!1}function qu(o,t,i,a){const h=a[0]-i[0],m=a[1]-i[1],g=(o[0]-i[0])*m-h*(o[1]-i[1]),v=(t[0]-i[0])*m-h*(t[1]-i[1]);return g>0&&v<0||g<0&&v>0}function Yl(o,t,i){const a=[];for(let h=0;h<o.length;h++){const m=[];for(let g=0;g<o[h].length;g++){const v=Xd(o[h][g],i);js(t,v),m.push(v)}a.push(m)}return a}function Wu(o,t,i){const a=[];for(let h=0;h<o.length;h++){const m=Yl(o[h],t,i);a.push(m)}return a}function Kl(o,t,i,a){if(o[0]<i[0]||o[0]>i[2]){const h=.5*a;let m=o[0]-i[0]>h?-a:i[0]-o[0]>h?a:0;m===0&&(m=o[0]-i[2]>h?-a:i[2]-o[0]>h?a:0),o[0]+=m}js(t,o)}function Jl(o,t,i,a){const h=Math.pow(2,a.z)*Ii,m=[a.x*Ii,a.y*Ii],g=[];for(const v of o)for(const C of v){const S=[C.x+m[0],C.y+m[1]];Kl(S,t,i,h),g.push(S)}return g}function Ql(o,t,i,a){const h=Math.pow(2,a.z)*Ii,m=[a.x*Ii,a.y*Ii],g=[];for(const C of o){const S=[];for(const M of C){const I=[M.x+m[0],M.y+m[1]];js(t,I),S.push(I)}g.push(S)}if(t[2]-t[0]<=h/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const C of g)for(const S of C)Kl(S,t,i,h)}var v;return g}class vn{constructor(t,i){this.type=ht,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(vi(t[1])){const a=t[1];if(a.type==="FeatureCollection"){const h=[];for(const m of a.features){const{type:g,coordinates:v}=m.geometry;g==="Polygon"&&h.push(v),g==="MultiPolygon"&&h.push(...v)}if(h.length)return new vn(a,{type:"MultiPolygon",coordinates:h})}else if(a.type==="Feature"){const h=a.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new vn(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new vn(a,a)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(a.type==="Polygon"){const v=Yl(a.coordinates,m,g),C=Jl(i.geometry(),h,m,g);if(!en(h,m))return!1;for(const S of C)if(!Qn(S,v))return!1}if(a.type==="MultiPolygon"){const v=Wu(a.coordinates,m,g),C=Jl(i.geometry(),h,m,g);if(!en(h,m))return!1;for(const S of C)if(!Zu(S,v))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(a.type==="Polygon"){const v=Yl(a.coordinates,m,g),C=Ql(i.geometry(),h,m,g);if(!en(h,m))return!1;for(const S of C)if(!Gu(S,v))return!1}if(a.type==="MultiPolygon"){const v=Wu(a.coordinates,m,g),C=Ql(i.geometry(),h,m,g);if(!en(h,m))return!1;for(const S of C)if(!Kd(S,v))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Hu=class{constructor(o=[],t=(i,a)=>i<a?-1:i>a?1:0){if(this.data=o,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:t,compare:i}=this,a=t[o];for(;o>0;){const h=o-1>>1,m=t[h];if(i(a,m)>=0)break;t[o]=m,o=h}t[o]=a}_down(o){const{data:t,compare:i}=this,a=this.length>>1,h=t[o];for(;o<a;){let m=1+(o<<1);const g=m+1;if(g<this.length&&i(t[g],t[m])<0&&(m=g),i(t[m],h)>=0)break;t[o]=t[m],o=m}t[o]=h}};function Xu(o,t,i=0,a=o.length-1,h=Jd){for(;a>i;){if(a-i>600){const C=a-i+1,S=t-i+1,M=Math.log(C),I=.5*Math.exp(2*M/3),L=.5*Math.sqrt(M*I*(C-I)/C)*(S-C/2<0?-1:1);Xu(o,t,Math.max(i,Math.floor(t-S*I/C+L)),Math.min(a,Math.floor(t+(C-S)*I/C+L)),h)}const m=o[t];let g=i,v=a;for(bn(o,i,t),h(o[a],m)>0&&bn(o,i,a);g<v;){for(bn(o,g,v),g++,v--;h(o[g],m)<0;)g++;for(;h(o[v],m)>0;)v--}h(o[i],m)===0?bn(o,i,v):(v++,bn(o,v,a)),v<=t&&(i=v+1),t<=v&&(a=v-1)}}function bn(o,t,i){const a=o[t];o[t]=o[i],o[i]=a}function Jd(o,t){return o<t?-1:o>t?1:0}function Ea(o,t){if(o.length<=1)return[o];const i=[];let a,h;for(const m of o){const g=Yu(m);g!==0&&(m.area=Math.abs(g),h===void 0&&(h=g<0),h===g<0?(a&&i.push(a),a=[m]):a.push(m))}if(a&&i.push(a),t>1)for(let m=0;m<i.length;m++)i[m].length<=t||(Xu(i[m],t,1,i[m].length-1,Qd),i[m]=i[m].slice(0,t));return i}function Qd(o,t){return t.area-o.area}function Yu(o){let t=0;for(let i,a,h=0,m=o.length,g=m-1;h<m;g=h++)i=o[h],a=o[g],t+=(a.x-i.x)*(i.y+a.y);return t}const ec=1/298.257223563,Ku=ec*(2-ec),Ju=Math.PI/180;class Aa{constructor(t){const i=6378.137*Ju*1e3,a=Math.cos(t*Ju),h=1/(1-Ku*(1-a*a)),m=Math.sqrt(h);this.kx=i*m*a,this.ky=i*m*h*(1-Ku)}distance(t,i){const a=this.wrap(t[0]-i[0])*this.kx,h=(t[1]-i[1])*this.ky;return Math.sqrt(a*a+h*h)}pointOnLine(t,i){let a,h,m,g,v=1/0;for(let C=0;C<t.length-1;C++){let S=t[C][0],M=t[C][1],I=this.wrap(t[C+1][0]-S)*this.kx,L=(t[C+1][1]-M)*this.ky,F=0;I===0&&L===0||(F=(this.wrap(i[0]-S)*this.kx*I+(i[1]-M)*this.ky*L)/(I*I+L*L),F>1?(S=t[C+1][0],M=t[C+1][1]):F>0&&(S+=I/this.kx*F,M+=L/this.ky*F)),I=this.wrap(i[0]-S)*this.kx,L=(i[1]-M)*this.ky;const O=I*I+L*L;O<v&&(v=O,a=S,h=M,m=C,g=F)}return{point:[a,h],index:m,t:Math.max(0,Math.min(1,g))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function tc(o,t){return t[0]-o[0]}function za(o){return o[1]-o[0]+1}function Ni(o,t){return o[1]>=o[0]&&o[1]<t}function rc(o,t){if(o[0]>o[1])return[null,null];const i=za(o);if(t){if(i===2)return[o,null];const h=Math.floor(i/2);return[[o[0],o[0]+h],[o[0]+h,o[1]]]}if(i===1)return[o,null];const a=Math.floor(i/2)-1;return[[o[0],o[0]+a],[o[0]+a+1,o[1]]]}function Da(o,t){if(!Ni(t,o.length))return[1/0,1/0,-1/0,-1/0];const i=[1/0,1/0,-1/0,-1/0];for(let a=t[0];a<=t[1];++a)js(i,o[a]);return i}function oc(o){const t=[1/0,1/0,-1/0,-1/0];for(const i of o)for(const a of i)js(t,a);return t}function Qu(o){return o[0]!==-1/0&&o[1]!==-1/0&&o[2]!==1/0&&o[3]!==1/0}function ic(o,t,i){if(!Qu(o)||!Qu(t))return NaN;let a=0,h=0;return o[2]<t[0]&&(a=t[0]-o[2]),o[0]>t[2]&&(a=o[0]-t[2]),o[1]>t[3]&&(h=o[1]-t[3]),o[3]<t[1]&&(h=t[1]-o[3]),i.distance([0,0],[a,h])}function xn(o,t,i){const a=i.pointOnLine(t,o);return i.distance(o,a.point)}function Qt(o,t,i,a,h){const m=Math.min(xn(o,[i,a],h),xn(t,[i,a],h)),g=Math.min(xn(i,[o,t],h),xn(a,[o,t],h));return Math.min(m,g)}function ef(o,t,i,a,h){if(!Ni(t,o.length)||!Ni(a,i.length))return 1/0;let m=1/0;for(let g=t[0];g<t[1];++g){const v=o[g],C=o[g+1];for(let S=a[0];S<a[1];++S){const M=i[S],I=i[S+1];if(Ns(v,C,M,I))return 0;m=Math.min(m,Qt(v,C,M,I,h))}}return m}function tf(o,t,i,a,h){if(!Ni(t,o.length)||!Ni(a,i.length))return NaN;let m=1/0;for(let g=t[0];g<=t[1];++g)for(let v=a[0];v<=a[1];++v)if(m=Math.min(m,h.distance(o[g],i[v])),m===0)return m;return m}function rf(o,t,i){if(Qn(o,t,!0))return 0;let a=1/0;for(const h of t){const m=h[0],g=h[h.length-1];if(m!==g&&(a=Math.min(a,xn(o,[g,m],i)),a===0))return a;const v=i.pointOnLine(h,o);if(a=Math.min(a,i.distance(o,v.point)),a===0)return a}return a}function of(o,t,i,a){if(!Ni(t,o.length))return NaN;for(let m=t[0];m<=t[1];++m)if(Qn(o[m],i,!0))return 0;let h=1/0;for(let m=t[0];m<t[1];++m){const g=o[m],v=o[m+1];for(const C of i)for(let S=0,M=C.length,I=M-1;S<M;I=S++){const L=C[I],F=C[S];if(Ns(g,v,L,F))return 0;h=Math.min(h,Qt(g,v,L,F,a))}}return h}function eh(o,t){for(const i of o)for(const a of i)if(Qn(a,t,!0))return!0;return!1}function nf(o,t,i,a=1/0){const h=oc(o),m=oc(t);if(a!==1/0&&ic(h,m,i)>=a)return a;if(en(h,m)){if(eh(o,t))return 0}else if(eh(t,o))return 0;let g=1/0;for(const v of o)for(let C=0,S=v.length,M=S-1;C<S;M=C++){const I=v[M],L=v[C];for(const F of t)for(let O=0,j=F.length,W=j-1;O<j;W=O++){const ee=F[W],de=F[O];if(Ns(I,L,ee,de))return 0;g=Math.min(g,Qt(I,L,ee,de,i))}}return g}function th(o,t,i,a,h,m){if(!m)return;const g=ic(Da(a,m),h,i);g<t&&o.push([g,m,[0,0]])}function Ra(o,t,i,a,h,m,g){if(!m||!g)return;const v=ic(Da(a,m),Da(h,g),i);v<t&&o.push([v,m,g])}function La(o,t,i,a,h=1/0){let m=Math.min(a.distance(o[0],i[0][0]),h);if(m===0)return m;const g=new Hu([[0,[0,o.length-1],[0,0]]],tc),v=oc(i);for(;g.length>0;){const C=g.pop();if(C[0]>=m)continue;const S=C[1],M=t?50:100;if(za(S)<=M){if(!Ni(S,o.length))return NaN;if(t){const I=of(o,S,i,a);if(isNaN(I)||I===0)return I;m=Math.min(m,I)}else for(let I=S[0];I<=S[1];++I){const L=rf(o[I],i,a);if(m=Math.min(m,L),m===0)return 0}}else{const I=rc(S,t);th(g,m,a,o,v,I[0]),th(g,m,a,o,v,I[1])}}return m}function Ba(o,t,i,a,h,m=1/0){let g=Math.min(m,h.distance(o[0],i[0]));if(g===0)return g;const v=new Hu([[0,[0,o.length-1],[0,i.length-1]]],tc);for(;v.length>0;){const C=v.pop();if(C[0]>=g)continue;const S=C[1],M=C[2],I=t?50:100,L=a?50:100;if(za(S)<=I&&za(M)<=L){if(!Ni(S,o.length)&&Ni(M,i.length))return NaN;let F;if(t&&a)F=ef(o,S,i,M,h),g=Math.min(g,F);else if(t&&!a){const O=o.slice(S[0],S[1]+1);for(let j=M[0];j<=M[1];++j)if(F=xn(i[j],O,h),g=Math.min(g,F),g===0)return g}else if(!t&&a){const O=i.slice(M[0],M[1]+1);for(let j=S[0];j<=S[1];++j)if(F=xn(o[j],O,h),g=Math.min(g,F),g===0)return g}else F=tf(o,S,i,M,h),g=Math.min(g,F)}else{const F=rc(S,t),O=rc(M,a);Ra(v,g,h,o,i,F[0],O[0]),Ra(v,g,h,o,i,F[0],O[1]),Ra(v,g,h,o,i,F[1],O[0]),Ra(v,g,h,o,i,F[1],O[1])}}return g}function nc(o){return o.type==="MultiPolygon"?o.coordinates.map(t=>({type:"Polygon",coordinates:t})):o.type==="MultiLineString"?o.coordinates.map(t=>({type:"LineString",coordinates:t})):o.type==="MultiPoint"?o.coordinates.map(t=>({type:"Point",coordinates:t})):[o]}class wn{constructor(t,i){this.type=Be,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(vi(t[1])){const a=t[1];if(a.type==="FeatureCollection")return new wn(a,a.features.map(h=>nc(h.geometry)).flat());if(a.type==="Feature")return new wn(a,nc(a.geometry));if("type"in a&&"coordinates"in a)return new wn(a,nc(a))}return i.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,a){const h=i.geometry(),m=h.flat().map(C=>Xl([C.x,C.y],i.canonical));if(h.length===0)return NaN;const g=new Aa(m[0][1]);let v=1/0;for(const C of a){switch(C.type){case"Point":v=Math.min(v,Ba(m,!1,[C.coordinates],!1,g,v));break;case"LineString":v=Math.min(v,Ba(m,!1,C.coordinates,!0,g,v));break;case"Polygon":v=Math.min(v,La(m,!1,C.coordinates,g,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,a){const h=i.geometry(),m=h.flat().map(C=>Xl([C.x,C.y],i.canonical));if(h.length===0)return NaN;const g=new Aa(m[0][1]);let v=1/0;for(const C of a){switch(C.type){case"Point":v=Math.min(v,Ba(m,!0,[C.coordinates],!1,g,v));break;case"LineString":v=Math.min(v,Ba(m,!0,C.coordinates,!0,g,v));break;case"Polygon":v=Math.min(v,La(m,!0,C.coordinates,g,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="Polygon")return function(i,a){const h=i.geometry();if(h.length===0||h[0].length===0)return NaN;const m=Ea(h,0).map(C=>C.map(S=>S.map(M=>Xl([M.x,M.y],i.canonical)))),g=new Aa(m[0][0][0][1]);let v=1/0;for(const C of a)for(const S of m){switch(C.type){case"Point":v=Math.min(v,La([C.coordinates],!1,S,g,v));break;case"LineString":v=Math.min(v,La(C.coordinates,!0,S,g,v));break;case"Polygon":v=Math.min(v,nf(S,C.coordinates,g,v))}if(v===0)return v}return v}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const es={"==":Wd,"!=":ka,">":Hd,"<":Wl,">=":Ma,"<=":Pa,array:ai,at:Xt,boolean:ai,case:wa,coalesce:Or,collator:Ro,format:yn,image:Hl,in:Ls,"index-of":li,interpolate:Co,"interpolate-hcl":Co,"interpolate-lab":Co,length:$s,let:Ft,literal:si,match:Bs,number:ai,"number-format":Ia,object:ai,slice:Fs,step:Jn,string:ai,"to-boolean":bi,"to-color":bi,"to-number":bi,"to-string":bi,var:Yn,within:vn,distance:wn};class ci{constructor(t,i,a,h){this.name=t,this.type=i,this._evaluate=a,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,i){const a=t[0],h=ci.definitions[a];if(!h)return i.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,g=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=g.filter(([S])=>!Array.isArray(S)||S.length===t.length-1);let C=null;for(const[S,M]of v){C=new Wt(i.registry,Fa,i.path,null,i.scope);const I=[];let L=!1;for(let F=1;F<t.length;F++){const O=t[F],j=Array.isArray(S)?S[F-1]:S.type,W=C.parse(O,1+I.length,j);if(!W){L=!0;break}I.push(W)}if(!L)if(Array.isArray(S)&&S.length!==I.length)C.error(`Expected ${S.length} arguments, but found ${I.length} instead.`);else{for(let F=0;F<I.length;F++){const O=Array.isArray(S)?S[F]:S.type,j=I[F];C.concat(F+1).checkSubtype(O,j.type)}if(C.errors.length===0)return new ci(a,m,M,I)}}if(v.length===1)i.errors.push(...C.errors);else{const S=(v.length?v:g).map(([I])=>{return L=I,Array.isArray(L)?`(${L.map(ur).join(", ")})`:`(${ur(L.type)}...)`;var L}).join(" | "),M=[];for(let I=1;I<t.length;I++){const L=i.parse(t[I],1+M.length);if(!L)return null;M.push(ur(L.type))}i.error(`Expected arguments of type ${S}, but found (${M.join(", ")}) instead.`)}return null}static register(t,i){ci.definitions=i;for(const a in i)t[a]=ci}}function rh(o,[t,i,a,h]){t=t.evaluate(o),i=i.evaluate(o),a=a.evaluate(o);const m=h?h.evaluate(o):1,g=ba(t,i,a,m);if(g)throw new Er(g);return new Kt(t/255,i/255,a/255,m,!1)}function oh(o,t){return o in t}function sc(o,t){const i=t[o];return i===void 0?null:i}function Cn(o){return{type:o}}function Fa(o){if(o instanceof Yn)return Fa(o.boundExpression);if(o instanceof ci&&o.name==="error"||o instanceof Ro||o instanceof vn||o instanceof wn)return!1;const t=o instanceof bi||o instanceof ai;let i=!0;return o.eachChild(a=>{i=t?i&&Fa(a):i&&a instanceof si}),!!i&&Oa(o)&&$a(o,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Oa(o){if(o instanceof ci&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof vn||o instanceof wn)return!1;let t=!0;return o.eachChild(i=>{t&&!Oa(i)&&(t=!1)}),t}function Vs(o){if(o instanceof ci&&o.name==="feature-state")return!1;let t=!0;return o.eachChild(i=>{t&&!Vs(i)&&(t=!1)}),t}function $a(o,t){if(o instanceof ci&&t.indexOf(o.name)>=0)return!1;let i=!0;return o.eachChild(a=>{i&&!$a(a,t)&&(i=!1)}),i}function ih(o){return{result:"success",value:o}}function ts(o){return{result:"error",value:o}}function rs(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function nh(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function ac(o){return!!o.expression&&o.expression.interpolated}function Jt(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function ja(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)}function sf(o){return o}function sh(o,t){const i=t.type==="color",a=o.stops&&typeof o.stops[0][0]=="object",h=a||!(a||o.property!==void 0),m=o.type||(ac(t)?"exponential":"interval");if(i||t.type==="padding"){const M=i?Kt.parse:oo.parse;(o=tt({},o)).stops&&(o.stops=o.stops.map(I=>[I[0],M(I[1])])),o.default=M(o.default?o.default:t.default)}if(o.colorSpace&&(g=o.colorSpace)!=="rgb"&&g!=="hcl"&&g!=="lab")throw new Error(`Unknown color space: "${o.colorSpace}"`);var g;let v,C,S;if(m==="exponential")v=ah;else if(m==="interval")v=lf;else if(m==="categorical"){v=af,C=Object.create(null);for(const M of o.stops)C[M[0]]=M[1];S=typeof o.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);v=lh}if(a){const M={},I=[];for(let O=0;O<o.stops.length;O++){const j=o.stops[O],W=j[0].zoom;M[W]===void 0&&(M[W]={zoom:W,type:o.type,property:o.property,default:o.default,stops:[]},I.push(W)),M[W].stops.push([j[0].value,j[1]])}const L=[];for(const O of I)L.push([M[O].zoom,sh(M[O],t)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:Co.interpolationFactor.bind(void 0,F),zoomStops:L.map(O=>O[0]),evaluate:({zoom:O},j)=>ah({stops:L,base:o.base},t,O).evaluate(O,j)}}if(h){const M=m==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Co.interpolationFactor.bind(void 0,M),zoomStops:o.stops.map(I=>I[0]),evaluate:({zoom:I})=>v(o,t,I,C,S)}}return{kind:"source",evaluate(M,I){const L=I&&I.properties?I.properties[o.property]:void 0;return L===void 0?Tn(o.default,t.default):v(o,t,L,C,S)}}}function Tn(o,t,i){return o!==void 0?o:t!==void 0?t:i!==void 0?i:void 0}function af(o,t,i,a,h){return Tn(typeof i===h?a[i]:void 0,o.default,t.default)}function lf(o,t,i){if(Jt(i)!=="number")return Tn(o.default,t.default);const a=o.stops.length;if(a===1||i<=o.stops[0][0])return o.stops[0][1];if(i>=o.stops[a-1][0])return o.stops[a-1][1];const h=Kn(o.stops.map(m=>m[0]),i);return o.stops[h][1]}function ah(o,t,i){const a=o.base!==void 0?o.base:1;if(Jt(i)!=="number")return Tn(o.default,t.default);const h=o.stops.length;if(h===1||i<=o.stops[0][0])return o.stops[0][1];if(i>=o.stops[h-1][0])return o.stops[h-1][1];const m=Kn(o.stops.map(M=>M[0]),i),g=function(M,I,L,F){const O=F-L,j=M-L;return O===0?0:I===1?j/O:(Math.pow(I,j)-1)/(Math.pow(I,O)-1)}(i,a,o.stops[m][0],o.stops[m+1][0]),v=o.stops[m][1],C=o.stops[m+1][1],S=qo[t.type]||sf;return typeof v.evaluate=="function"?{evaluate(...M){const I=v.evaluate.apply(void 0,M),L=C.evaluate.apply(void 0,M);if(I!==void 0&&L!==void 0)return S(I,L,g,o.colorSpace)}}:S(v,C,g,o.colorSpace)}function lh(o,t,i){switch(t.type){case"color":i=Kt.parse(i);break;case"formatted":i=fo.fromString(i.toString());break;case"resolvedImage":i=Po.fromString(i.toString());break;case"padding":i=oo.parse(i);break;default:Jt(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0)}return Tn(i,o.default,t.default)}ci.register(es,{error:[{kind:"error"},[pt],(o,[t])=>{throw new Er(t.evaluate(o))}],typeof:[pt,[Tt],(o,[t])=>ur(Ur(t.evaluate(o)))],"to-rgba":[zo(Be,4),[Ot],(o,[t])=>{const[i,a,h,m]=t.evaluate(o).rgb;return[255*i,255*a,255*h,m]}],rgb:[Ot,[Be,Be,Be],rh],rgba:[Ot,[Be,Be,Be,Be],rh],has:{type:ht,overloads:[[[pt],(o,[t])=>oh(t.evaluate(o),o.properties())],[[pt,jt],(o,[t,i])=>oh(t.evaluate(o),i.evaluate(o))]]},get:{type:Tt,overloads:[[[pt],(o,[t])=>sc(t.evaluate(o),o.properties())],[[pt,jt],(o,[t,i])=>sc(t.evaluate(o),i.evaluate(o))]]},"feature-state":[Tt,[pt],(o,[t])=>sc(t.evaluate(o),o.featureState||{})],properties:[jt,[],o=>o.properties()],"geometry-type":[pt,[],o=>o.geometryType()],id:[Tt,[],o=>o.id()],zoom:[Be,[],o=>o.globals.zoom],"heatmap-density":[Be,[],o=>o.globals.heatmapDensity||0],"line-progress":[Be,[],o=>o.globals.lineProgress||0],accumulated:[Tt,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[Be,Cn(Be),(o,t)=>{let i=0;for(const a of t)i+=a.evaluate(o);return i}],"*":[Be,Cn(Be),(o,t)=>{let i=1;for(const a of t)i*=a.evaluate(o);return i}],"-":{type:Be,overloads:[[[Be,Be],(o,[t,i])=>t.evaluate(o)-i.evaluate(o)],[[Be],(o,[t])=>-t.evaluate(o)]]},"/":[Be,[Be,Be],(o,[t,i])=>t.evaluate(o)/i.evaluate(o)],"%":[Be,[Be,Be],(o,[t,i])=>t.evaluate(o)%i.evaluate(o)],ln2:[Be,[],()=>Math.LN2],pi:[Be,[],()=>Math.PI],e:[Be,[],()=>Math.E],"^":[Be,[Be,Be],(o,[t,i])=>Math.pow(t.evaluate(o),i.evaluate(o))],sqrt:[Be,[Be],(o,[t])=>Math.sqrt(t.evaluate(o))],log10:[Be,[Be],(o,[t])=>Math.log(t.evaluate(o))/Math.LN10],ln:[Be,[Be],(o,[t])=>Math.log(t.evaluate(o))],log2:[Be,[Be],(o,[t])=>Math.log(t.evaluate(o))/Math.LN2],sin:[Be,[Be],(o,[t])=>Math.sin(t.evaluate(o))],cos:[Be,[Be],(o,[t])=>Math.cos(t.evaluate(o))],tan:[Be,[Be],(o,[t])=>Math.tan(t.evaluate(o))],asin:[Be,[Be],(o,[t])=>Math.asin(t.evaluate(o))],acos:[Be,[Be],(o,[t])=>Math.acos(t.evaluate(o))],atan:[Be,[Be],(o,[t])=>Math.atan(t.evaluate(o))],min:[Be,Cn(Be),(o,t)=>Math.min(...t.map(i=>i.evaluate(o)))],max:[Be,Cn(Be),(o,t)=>Math.max(...t.map(i=>i.evaluate(o)))],abs:[Be,[Be],(o,[t])=>Math.abs(t.evaluate(o))],round:[Be,[Be],(o,[t])=>{const i=t.evaluate(o);return i<0?-Math.round(-i):Math.round(i)}],floor:[Be,[Be],(o,[t])=>Math.floor(t.evaluate(o))],ceil:[Be,[Be],(o,[t])=>Math.ceil(t.evaluate(o))],"filter-==":[ht,[pt,Tt],(o,[t,i])=>o.properties()[t.value]===i.value],"filter-id-==":[ht,[Tt],(o,[t])=>o.id()===t.value],"filter-type-==":[ht,[pt],(o,[t])=>o.geometryType()===t.value],"filter-<":[ht,[pt,Tt],(o,[t,i])=>{const a=o.properties()[t.value],h=i.value;return typeof a==typeof h&&a<h}],"filter-id-<":[ht,[Tt],(o,[t])=>{const i=o.id(),a=t.value;return typeof i==typeof a&&i<a}],"filter->":[ht,[pt,Tt],(o,[t,i])=>{const a=o.properties()[t.value],h=i.value;return typeof a==typeof h&&a>h}],"filter-id->":[ht,[Tt],(o,[t])=>{const i=o.id(),a=t.value;return typeof i==typeof a&&i>a}],"filter-<=":[ht,[pt,Tt],(o,[t,i])=>{const a=o.properties()[t.value],h=i.value;return typeof a==typeof h&&a<=h}],"filter-id-<=":[ht,[Tt],(o,[t])=>{const i=o.id(),a=t.value;return typeof i==typeof a&&i<=a}],"filter->=":[ht,[pt,Tt],(o,[t,i])=>{const a=o.properties()[t.value],h=i.value;return typeof a==typeof h&&a>=h}],"filter-id->=":[ht,[Tt],(o,[t])=>{const i=o.id(),a=t.value;return typeof i==typeof a&&i>=a}],"filter-has":[ht,[Tt],(o,[t])=>t.value in o.properties()],"filter-has-id":[ht,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[ht,[zo(pt)],(o,[t])=>t.value.indexOf(o.geometryType())>=0],"filter-id-in":[ht,[zo(Tt)],(o,[t])=>t.value.indexOf(o.id())>=0],"filter-in-small":[ht,[pt,zo(Tt)],(o,[t,i])=>i.value.indexOf(o.properties()[t.value])>=0],"filter-in-large":[ht,[pt,zo(Tt)],(o,[t,i])=>function(a,h,m,g){for(;m<=g;){const v=m+g>>1;if(h[v]===a)return!0;h[v]>a?g=v-1:m=v+1}return!1}(o.properties()[t.value],i.value,0,i.value.length-1)],all:{type:ht,overloads:[[[ht,ht],(o,[t,i])=>t.evaluate(o)&&i.evaluate(o)],[Cn(ht),(o,t)=>{for(const i of t)if(!i.evaluate(o))return!1;return!0}]]},any:{type:ht,overloads:[[[ht,ht],(o,[t,i])=>t.evaluate(o)||i.evaluate(o)],[Cn(ht),(o,t)=>{for(const i of t)if(i.evaluate(o))return!0;return!1}]]},"!":[ht,[ht],(o,[t])=>!t.evaluate(o)],"is-supported-script":[ht,[pt],(o,[t])=>{const i=o.globals&&o.globals.isSupportedScript;return!i||i(t.evaluate(o))}],upcase:[pt,[pt],(o,[t])=>t.evaluate(o).toUpperCase()],downcase:[pt,[pt],(o,[t])=>t.evaluate(o).toLowerCase()],concat:[pt,Cn(Tt),(o,t)=>t.map(i=>Qi(i.evaluate(o))).join("")],"resolved-locale":[pt,[mn],(o,[t])=>t.evaluate(o).resolvedLocale()]});class lc{constructor(t,i){var a;this.expression=t,this._warningHistory={},this._evaluator=new xa,this._defaultValue=i?(a=i).type==="color"&&ja(a.default)?new Kt(0,0,0,0):a.type==="color"?Kt.parse(a.default)||null:a.type==="padding"?oo.parse(a.default)||null:a.type==="variableAnchorOffsetCollection"?io.parse(a.default)||null:a.type==="projectionDefinition"?Do.parse(a.default)||null:a.default===void 0?null:a.default:null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(t,i,a,h,m,g){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=a,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)}evaluate(t,i,a,h,m,g){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=a||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new Er(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function Na(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in es}function Sn(o,t){const i=new Wt(es,Fa,[],t?function(h){const m={color:Ot,string:pt,number:Be,enum:pt,boolean:ht,formatted:Vr,padding:Hr,projectionDefinition:At,resolvedImage:_r,variableAnchorOffsetCollection:_a};return h.type==="array"?zo(m[h.value]||Tt,h.length):m[h.type]}(t):void 0),a=i.parse(o,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?ih(new lc(a,t)):ts(i.errors)}class Va{constructor(t,i){this.kind=t,this._styleExpression=i,this.isStateDependent=t!=="constant"&&!Vs(i.expression)}evaluateWithoutErrorHandling(t,i,a,h,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,i,a,h,m,g)}evaluate(t,i,a,h,m,g){return this._styleExpression.evaluate(t,i,a,h,m,g)}}class cc{constructor(t,i,a,h){this.kind=t,this.zoomStops=a,this._styleExpression=i,this.isStateDependent=t!=="camera"&&!Vs(i.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,i,a,h,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,i,a,h,m,g)}evaluate(t,i,a,h,m,g){return this._styleExpression.evaluate(t,i,a,h,m,g)}interpolationFactor(t,i,a){return this.interpolationType?Co.interpolationFactor(this.interpolationType,t,i,a):0}}function ch(o,t){const i=Sn(o,t);if(i.result==="error")return i;const a=i.value.expression,h=Oa(a);if(!h&&!rs(t))return ts([new yt("","data expressions not supported")]);const m=$a(a,["zoom"]);if(!m&&!nh(t))return ts([new yt("","zoom expressions not supported")]);const g=Za(a);return g||m?g instanceof yt?ts([g]):g instanceof Co&&!ac(t)?ts([new yt("",'"interpolate" expressions cannot be used with this property')]):ih(g?new cc(h?"camera":"composite",i.value,g.labels,g instanceof Co?g.interpolation:void 0):new Va(h?"constant":"source",i.value)):ts([new yt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ua{constructor(t,i){this._parameters=t,this._specification=i,tt(this,sh(this._parameters,this._specification))}static deserialize(t){return new Ua(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Za(o){let t=null;if(o instanceof Ft)t=Za(o.result);else if(o instanceof Or){for(const i of o.args)if(t=Za(i),t)break}else(o instanceof Jn||o instanceof Co)&&o.input instanceof ci&&o.input.name==="zoom"&&(t=o);return t instanceof yt||o.eachChild(i=>{const a=Za(i);a instanceof yt?t=a:!t&&a?t=new yt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&a&&t!==a&&(t=new yt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function uc(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const t of o.slice(1))if(!uc(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const uh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ga(o){if(o==null)return{filter:()=>!0,needGeometry:!1};uc(o)||(o=Us(o));const t=Sn(o,uh);if(t.result==="error")throw new Error(t.value.map(i=>`${i.key}: ${i.message}`).join(", "));return{filter:(i,a,h)=>t.value.evaluate(i,a,{},h),needGeometry:hh(o)}}function cf(o,t){return o<t?-1:o>t?1:0}function hh(o){if(!Array.isArray(o))return!1;if(o[0]==="within"||o[0]==="distance")return!0;for(let t=1;t<o.length;t++)if(hh(o[t]))return!0;return!1}function Us(o){if(!o)return!0;const t=o[0];return o.length<=1?t!=="any":t==="=="?qa(o[1],o[2],"=="):t==="!="?os(qa(o[1],o[2],"==")):t==="<"||t===">"||t==="<="||t===">="?qa(o[1],o[2],t):t==="any"?(i=o.slice(1),["any"].concat(i.map(Us))):t==="all"?["all"].concat(o.slice(1).map(Us)):t==="none"?["all"].concat(o.slice(1).map(Us).map(os)):t==="in"?hc(o[1],o.slice(2)):t==="!in"?os(hc(o[1],o.slice(2))):t==="has"?dc(o[1]):t!=="!has"||os(dc(o[1]));var i}function qa(o,t,i){switch(o){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,o,t]}}function hc(o,t){if(t.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(i=>typeof i!=typeof t[0])?["filter-in-large",o,["literal",t.sort(cf)]]:["filter-in-small",o,["literal",t]]}}function dc(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function os(o){return["!",o]}function Zs(o){const t=typeof o;if(t==="number"||t==="boolean"||t==="string"||o==null)return JSON.stringify(o);if(Array.isArray(o)){let h="[";for(const m of o)h+=`${Zs(m)},`;return`${h}]`}const i=Object.keys(o).sort();let a="{";for(let h=0;h<i.length;h++)a+=`${JSON.stringify(i[h])}:${Zs(o[i[h]])},`;return`${a}}`}function fc(o){let t="";for(const i of Z)t+=`/${Zs(o[i])}`;return t}function Gs(o){const t=o.value;return t?[new ve(o.key,t,"constants have been deprecated as of v8")]:[]}function Fr(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function kn(o){if(Array.isArray(o))return o.map(kn);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const t={};for(const i in o)t[i]=kn(o[i]);return t}return Fr(o)}function ui(o){const t=o.key,i=o.value,a=o.valueSpec||{},h=o.objectElementValidators||{},m=o.style,g=o.styleSpec,v=o.validateSpec;let C=[];const S=Jt(i);if(S!=="object")return[new ve(t,i,`object expected, ${S} found`)];for(const M in i){const I=M.split(".")[0],L=a[I]||a["*"];let F;if(h[I])F=h[I];else if(a[I])F=v;else if(h["*"])F=h["*"];else{if(!a["*"]){C.push(new ve(t,i[M],`unknown property "${M}"`));continue}F=v}C=C.concat(F({key:(t&&`${t}.`)+M,value:i[M],valueSpec:L,style:m,styleSpec:g,object:i,objectKey:M,validateSpec:v},i))}for(const M in a)h[M]||a[M].required&&a[M].default===void 0&&i[M]===void 0&&C.push(new ve(t,i,`missing required property "${M}"`));return C}function pc(o){const t=o.value,i=o.valueSpec,a=o.style,h=o.styleSpec,m=o.key,g=o.arrayElementValidator||o.validateSpec;if(Jt(t)!=="array")return[new ve(m,t,`array expected, ${Jt(t)} found`)];if(i.length&&t.length!==i.length)return[new ve(m,t,`array length ${i.length} expected, length ${t.length} found`)];if(i["min-length"]&&t.length<i["min-length"])return[new ve(m,t,`array length at least ${i["min-length"]} expected, length ${t.length} found`)];let v={type:i.value,values:i.values};h.$version<7&&(v.function=i.function),Jt(i.value)==="object"&&(v=i.value);let C=[];for(let S=0;S<t.length;S++)C=C.concat(g({array:t,arrayIndex:S,value:t[S],valueSpec:v,validateSpec:o.validateSpec,style:a,styleSpec:h,key:`${m}[${S}]`}));return C}function mc(o){const t=o.key,i=o.value,a=o.valueSpec;let h=Jt(i);return h==="number"&&i!=i&&(h="NaN"),h!=="number"?[new ve(t,i,`number expected, ${h} found`)]:"minimum"in a&&i<a.minimum?[new ve(t,i,`${i} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&i>a.maximum?[new ve(t,i,`${i} is greater than the maximum value ${a.maximum}`)]:[]}function dh(o){const t=o.valueSpec,i=Fr(o.value.type);let a,h,m,g={};const v=i!=="categorical"&&o.value.property===void 0,C=!v,S=Jt(o.value.stops)==="array"&&Jt(o.value.stops[0])==="array"&&Jt(o.value.stops[0][0])==="object",M=ui({key:o.key,value:o.value,valueSpec:o.styleSpec.function,validateSpec:o.validateSpec,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(F){if(i==="identity")return[new ve(F.key,F.value,'identity function may not have a "stops" property')];let O=[];const j=F.value;return O=O.concat(pc({key:F.key,value:j,valueSpec:F.valueSpec,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:I})),Jt(j)==="array"&&j.length===0&&O.push(new ve(F.key,j,"array must have at least one stop")),O},default:function(F){return F.validateSpec({key:F.key,value:F.value,valueSpec:t,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec})}}});return i==="identity"&&v&&M.push(new ve(o.key,o.value,'missing required property "property"')),i==="identity"||o.value.stops||M.push(new ve(o.key,o.value,'missing required property "stops"')),i==="exponential"&&o.valueSpec.expression&&!ac(o.valueSpec)&&M.push(new ve(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(C&&!rs(o.valueSpec)?M.push(new ve(o.key,o.value,"property functions not supported")):v&&!nh(o.valueSpec)&&M.push(new ve(o.key,o.value,"zoom functions not supported"))),i!=="categorical"&&!S||o.value.property!==void 0||M.push(new ve(o.key,o.value,'"property" property is required')),M;function I(F){let O=[];const j=F.value,W=F.key;if(Jt(j)!=="array")return[new ve(W,j,`array expected, ${Jt(j)} found`)];if(j.length!==2)return[new ve(W,j,`array length 2 expected, length ${j.length} found`)];if(S){if(Jt(j[0])!=="object")return[new ve(W,j,`object expected, ${Jt(j[0])} found`)];if(j[0].zoom===void 0)return[new ve(W,j,"object stop key must have zoom")];if(j[0].value===void 0)return[new ve(W,j,"object stop key must have value")];if(m&&m>Fr(j[0].zoom))return[new ve(W,j[0].zoom,"stop zoom values must appear in ascending order")];Fr(j[0].zoom)!==m&&(m=Fr(j[0].zoom),h=void 0,g={}),O=O.concat(ui({key:`${W}[0]`,value:j[0],valueSpec:{zoom:{}},validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:mc,value:L}}))}else O=O.concat(L({key:`${W}[0]`,value:j[0],validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec},j));return Na(kn(j[1]))?O.concat([new ve(`${W}[1]`,j[1],"expressions are not allowed in function stops.")]):O.concat(F.validateSpec({key:`${W}[1]`,value:j[1],valueSpec:t,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec}))}function L(F,O){const j=Jt(F.value),W=Fr(F.value),ee=F.value!==null?F.value:O;if(a){if(j!==a)return[new ve(F.key,ee,`${j} stop domain type must match previous stop domain type ${a}`)]}else a=j;if(j!=="number"&&j!=="string"&&j!=="boolean")return[new ve(F.key,ee,"stop domain value must be a number, string, or boolean")];if(j!=="number"&&i!=="categorical"){let de=`number expected, ${j} found`;return rs(t)&&i===void 0&&(de+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ve(F.key,ee,de)]}return i!=="categorical"||j!=="number"||isFinite(W)&&Math.floor(W)===W?i!=="categorical"&&j==="number"&&h!==void 0&&W<h?[new ve(F.key,ee,"stop domain values must appear in ascending order")]:(h=W,i==="categorical"&&W in g?[new ve(F.key,ee,"stop domain values must be unique")]:(g[W]=!0,[])):[new ve(F.key,ee,`integer expected, found ${W}`)]}}function Pn(o){const t=(o.expressionContext==="property"?ch:Sn)(kn(o.value),o.valueSpec);if(t.result==="error")return t.value.map(a=>new ve(`${o.key}${a.key}`,o.value,a.message));const i=t.value.expression||t.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!i.outputDefined())return[new ve(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!Vs(i))return[new ve(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!Vs(i))return[new ve(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!$a(i,["zoom","feature-state"]))return[new ve(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!Oa(i))return[new ve(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function is(o){const t=o.key,i=o.value,a=o.valueSpec,h=[];return Array.isArray(a.values)?a.values.indexOf(Fr(i))===-1&&h.push(new ve(t,i,`expected one of [${a.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(a.values).indexOf(Fr(i))===-1&&h.push(new ve(t,i,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(i)} found`)),h}function ns(o){return uc(kn(o.value))?Pn(tt({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):fh(o)}function fh(o){const t=o.value,i=o.key;if(Jt(t)!=="array")return[new ve(i,t,`array expected, ${Jt(t)} found`)];const a=o.styleSpec;let h,m=[];if(t.length<1)return[new ve(i,t,"filter array must have at least 1 element")];switch(m=m.concat(is({key:`${i}[0]`,value:t[0],valueSpec:a.filter_operator,style:o.style,styleSpec:o.styleSpec})),Fr(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Fr(t[1])==="$type"&&m.push(new ve(i,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&m.push(new ve(i,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=Jt(t[1]),h!=="string"&&m.push(new ve(`${i}[1]`,t[1],`string expected, ${h} found`)));for(let g=2;g<t.length;g++)h=Jt(t[g]),Fr(t[1])==="$type"?m=m.concat(is({key:`${i}[${g}]`,value:t[g],valueSpec:a.geometry_type,style:o.style,styleSpec:o.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new ve(`${i}[${g}]`,t[g],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let g=1;g<t.length;g++)m=m.concat(fh({key:`${i}[${g}]`,value:t[g],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":h=Jt(t[1]),t.length!==2?m.push(new ve(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new ve(`${i}[1]`,t[1],`string expected, ${h} found`))}return m}function gc(o,t){const i=o.key,a=o.validateSpec,h=o.style,m=o.styleSpec,g=o.value,v=o.objectKey,C=m[`${t}_${o.layerType}`];if(!C)return[];const S=v.match(/^(.*)-transition$/);if(t==="paint"&&S&&C[S[1]]&&C[S[1]].transition)return a({key:i,value:g,valueSpec:m.transition,style:h,styleSpec:m});const M=o.valueSpec||C[v];if(!M)return[new ve(i,g,`unknown property "${v}"`)];let I;if(Jt(g)==="string"&&rs(M)&&!M.tokens&&(I=/^{([^}]+)}$/.exec(g)))return[new ve(i,g,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(I[1])} }\`.`)];const L=[];return o.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&L.push(new ve(i,g,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&ja(kn(g))&&Fr(g.type)==="identity"&&L.push(new ve(i,g,'"text-font" does not support identity functions'))),L.concat(a({key:o.key,value:g,valueSpec:M,style:h,styleSpec:m,expressionContext:"property",propertyType:t,propertyKey:v}))}function _c(o){return gc(o,"paint")}function ph(o){return gc(o,"layout")}function yc(o){let t=[];const i=o.value,a=o.key,h=o.style,m=o.styleSpec;i.type||i.ref||t.push(new ve(a,i,'either "type" or "ref" is required'));let g=Fr(i.type);const v=Fr(i.ref);if(i.id){const C=Fr(i.id);for(let S=0;S<o.arrayIndex;S++){const M=h.layers[S];Fr(M.id)===C&&t.push(new ve(a,i.id,`duplicate layer id "${i.id}", previously used at line ${M.id.__line__}`))}}if("ref"in i){let C;["type","source","source-layer","filter","layout"].forEach(S=>{S in i&&t.push(new ve(a,i[S],`"${S}" is prohibited for ref layers`))}),h.layers.forEach(S=>{Fr(S.id)===v&&(C=S)}),C?C.ref?t.push(new ve(a,i.ref,"ref cannot reference another ref layer")):g=Fr(C.type):t.push(new ve(a,i.ref,`ref layer "${v}" not found`))}else if(g!=="background")if(i.source){const C=h.sources&&h.sources[i.source],S=C&&Fr(C.type);C?S==="vector"&&g==="raster"?t.push(new ve(a,i.source,`layer "${i.id}" requires a raster source`)):S!=="raster-dem"&&g==="hillshade"?t.push(new ve(a,i.source,`layer "${i.id}" requires a raster-dem source`)):S==="raster"&&g!=="raster"?t.push(new ve(a,i.source,`layer "${i.id}" requires a vector source`)):S!=="vector"||i["source-layer"]?S==="raster-dem"&&g!=="hillshade"?t.push(new ve(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!i.paint||!i.paint["line-gradient"]||S==="geojson"&&C.lineMetrics||t.push(new ve(a,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new ve(a,i,`layer "${i.id}" must specify a "source-layer"`)):t.push(new ve(a,i.source,`source "${i.source}" not found`))}else t.push(new ve(a,i,'missing required property "source"'));return t=t.concat(ui({key:a,value:i,valueSpec:m.layer,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,objectElementValidators:{"*":()=>[],type:()=>o.validateSpec({key:`${a}.type`,value:i.type,valueSpec:m.layer.type,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,object:i,objectKey:"type"}),filter:ns,layout:C=>ui({layer:i,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":S=>ph(tt({layerType:g},S))}}),paint:C=>ui({layer:i,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":S=>_c(tt({layerType:g},S))}})}})),t}function tn(o){const t=o.value,i=o.key,a=Jt(t);return a!=="string"?[new ve(i,t,`string expected, ${a} found`)]:[]}const ss={promoteId:function({key:o,value:t}){if(Jt(t)==="string")return tn({key:o,value:t});{const i=[];for(const a in t)i.push(...tn({key:`${o}.${a}`,value:t[a]}));return i}}};function mh(o){const t=o.value,i=o.key,a=o.styleSpec,h=o.style,m=o.validateSpec;if(!t.type)return[new ve(i,t,'"type" is required')];const g=Fr(t.type);let v;switch(g){case"vector":case"raster":return v=ui({key:i,value:t,valueSpec:a[`source_${g.replace("-","_")}`],style:o.style,styleSpec:a,objectElementValidators:ss,validateSpec:m}),v;case"raster-dem":return v=function(C){var S;const M=(S=C.sourceName)!==null&&S!==void 0?S:"",I=C.value,L=C.styleSpec,F=L.source_raster_dem,O=C.style;let j=[];const W=Jt(I);if(I===void 0)return j;if(W!=="object")return j.push(new ve("source_raster_dem",I,`object expected, ${W} found`)),j;const ee=Fr(I.encoding)==="custom",de=["redFactor","greenFactor","blueFactor","baseShift"],oe=C.value.encoding?`"${C.value.encoding}"`:"Default";for(const B in I)!ee&&de.includes(B)?j.push(new ve(B,I[B],`In "${M}": "${B}" is only valid when "encoding" is set to "custom". ${oe} encoding found`)):F[B]?j=j.concat(C.validateSpec({key:B,value:I[B],valueSpec:F[B],validateSpec:C.validateSpec,style:O,styleSpec:L})):j.push(new ve(B,I[B],`unknown property "${B}"`));return j}({sourceName:i,value:t,style:o.style,styleSpec:a,validateSpec:m}),v;case"geojson":if(v=ui({key:i,value:t,valueSpec:a.source_geojson,style:h,styleSpec:a,validateSpec:m,objectElementValidators:ss}),t.cluster)for(const C in t.clusterProperties){const[S,M]=t.clusterProperties[C],I=typeof S=="string"?[S,["accumulated"],["get",C]]:S;v.push(...Pn({key:`${i}.${C}.map`,value:M,expressionContext:"cluster-map"})),v.push(...Pn({key:`${i}.${C}.reduce`,value:I,expressionContext:"cluster-reduce"}))}return v;case"video":return ui({key:i,value:t,valueSpec:a.source_video,style:h,validateSpec:m,styleSpec:a});case"image":return ui({key:i,value:t,valueSpec:a.source_image,style:h,validateSpec:m,styleSpec:a});case"canvas":return[new ve(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return is({key:`${i}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function gh(o){const t=o.value,i=o.styleSpec,a=i.light,h=o.style;let m=[];const g=Jt(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new ve("light",t,`object expected, ${g} found`)]),m;for(const v in t){const C=v.match(/^(.*)-transition$/);m=m.concat(C&&a[C[1]]&&a[C[1]].transition?o.validateSpec({key:v,value:t[v],valueSpec:i.transition,validateSpec:o.validateSpec,style:h,styleSpec:i}):a[v]?o.validateSpec({key:v,value:t[v],valueSpec:a[v],validateSpec:o.validateSpec,style:h,styleSpec:i}):[new ve(v,t[v],`unknown property "${v}"`)])}return m}function _h(o){const t=o.value,i=o.styleSpec,a=i.sky,h=o.style,m=Jt(t);if(t===void 0)return[];if(m!=="object")return[new ve("sky",t,`object expected, ${m} found`)];let g=[];for(const v in t)g=g.concat(a[v]?o.validateSpec({key:v,value:t[v],valueSpec:a[v],style:h,styleSpec:i}):[new ve(v,t[v],`unknown property "${v}"`)]);return g}function yh(o){const t=o.value,i=o.styleSpec,a=i.terrain,h=o.style;let m=[];const g=Jt(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new ve("terrain",t,`object expected, ${g} found`)]),m;for(const v in t)m=m.concat(a[v]?o.validateSpec({key:v,value:t[v],valueSpec:a[v],validateSpec:o.validateSpec,style:h,styleSpec:i}):[new ve(v,t[v],`unknown property "${v}"`)]);return m}function vh(o){let t=[];const i=o.value,a=o.key;if(Array.isArray(i)){const h=[],m=[];for(const g in i)i[g].id&&h.includes(i[g].id)&&t.push(new ve(a,i,`all the sprites' ids must be unique, but ${i[g].id} is duplicated`)),h.push(i[g].id),i[g].url&&m.includes(i[g].url)&&t.push(new ve(a,i,`all the sprites' URLs must be unique, but ${i[g].url} is duplicated`)),m.push(i[g].url),t=t.concat(ui({key:`${a}[${g}]`,value:i[g],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:o.validateSpec}));return t}return tn({key:a,value:i})}const bh={"*":()=>[],array:pc,boolean:function(o){const t=o.value,i=o.key,a=Jt(t);return a!=="boolean"?[new ve(i,t,`boolean expected, ${a} found`)]:[]},number:mc,color:function(o){const t=o.key,i=o.value,a=Jt(i);return a!=="string"?[new ve(t,i,`color expected, ${a} found`)]:Kt.parse(String(i))?[]:[new ve(t,i,`color expected, "${i}" found`)]},constants:Gs,enum:is,filter:ns,function:dh,layer:yc,object:ui,source:mh,light:gh,sky:_h,terrain:yh,projection:function(o){const t=o.value,i=o.styleSpec,a=i.projection,h=o.style,m=Jt(t);if(t===void 0)return[];if(m!=="object")return[new ve("projection",t,`object expected, ${m} found`)];let g=[];for(const v in t)g=g.concat(a[v]?o.validateSpec({key:v,value:t[v],valueSpec:a[v],style:h,styleSpec:i}):[new ve(v,t[v],`unknown property "${v}"`)]);return g},projectionDefinition:function(o){const t=o.key;let i=o.value;i=i instanceof String?i.valueOf():i;const a=Jt(i);return a!=="array"||function(h){return Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"}(i)||function(h){return!!["interpolate","step","literal"].includes(h[0])}(i)?["array","string"].includes(a)?[]:[new ve(t,i,`projection expected, invalid type "${a}" found`)]:[new ve(t,i,`projection expected, invalid array ${JSON.stringify(i)} found`)]},string:tn,formatted:function(o){return tn(o).length===0?[]:Pn(o)},resolvedImage:function(o){return tn(o).length===0?[]:Pn(o)},padding:function(o){const t=o.key,i=o.value;if(Jt(i)==="array"){if(i.length<1||i.length>4)return[new ve(t,i,`padding requires 1 to 4 values; ${i.length} values found`)];const a={type:"number"};let h=[];for(let m=0;m<i.length;m++)h=h.concat(o.validateSpec({key:`${t}[${m}]`,value:i[m],validateSpec:o.validateSpec,valueSpec:a}));return h}return mc({key:t,value:i,valueSpec:{}})},variableAnchorOffsetCollection:function(o){const t=o.key,i=o.value,a=Jt(i),h=o.styleSpec;if(a!=="array"||i.length<1||i.length%2!=0)return[new ve(t,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let g=0;g<i.length;g+=2)m=m.concat(is({key:`${t}[${g}]`,value:i[g],valueSpec:h.layout_symbol["text-anchor"]})),m=m.concat(pc({key:`${t}[${g+1}]`,value:i[g+1],valueSpec:{length:2,value:"number"},validateSpec:o.validateSpec,style:o.style,styleSpec:h}));return m},sprite:vh};function rn(o){const t=o.value,i=o.valueSpec,a=o.styleSpec;return o.validateSpec=rn,i.expression&&ja(Fr(t))?dh(o):i.expression&&Na(kn(t))?Pn(o):i.type&&bh[i.type]?bh[i.type](o):ui(tt({},o,{valueSpec:i.type?a[i.type]:i}))}function as(o){const t=o.value,i=o.key,a=tn(o);return a.length||(t.indexOf("{fontstack}")===-1&&a.push(new ve(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&a.push(new ve(i,t,'"glyphs" url must include a "{range}" token'))),a}function Ar(o,t=A){let i=[];return i=i.concat(rn({key:"",value:o,valueSpec:t.$root,styleSpec:t,style:o,validateSpec:rn,objectElementValidators:{glyphs:as,"*":()=>[]}})),o.constants&&(i=i.concat(Gs({key:"constants",value:o.constants}))),vc(i)}function Lo(o){return function(t){return o({...t,validateSpec:rn})}}function vc(o){return[].concat(o).sort((t,i)=>t.line-i.line)}function Ei(o){return function(...t){return vc(o.apply(this,t))}}Ar.source=Ei(Lo(mh)),Ar.sprite=Ei(Lo(vh)),Ar.glyphs=Ei(Lo(as)),Ar.light=Ei(Lo(gh)),Ar.sky=Ei(Lo(_h)),Ar.terrain=Ei(Lo(yh)),Ar.layer=Ei(Lo(yc)),Ar.filter=Ei(Lo(ns)),Ar.paintProperty=Ei(Lo(_c)),Ar.layoutProperty=Ei(Lo(ph));const ls=Ar,qs=ls.light,xh=ls.sky,bc=ls.paintProperty,uf=ls.layoutProperty;function Wa(o,t){let i=!1;if(t&&t.length)for(const a of t)o.fire(new oi(new Error(a.message))),i=!0;return i}class Ws{constructor(t,i,a){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const g=new Int32Array(this.arrayBuffer);t=g[0],this.d=(i=g[1])+2*(a=g[2]);for(let C=0;C<this.d*this.d;C++){const S=g[3+C],M=g[3+C+1];h.push(S===M?null:g.subarray(S,M))}const v=g[3+h.length+1];this.keys=g.subarray(g[3+h.length],v),this.bboxes=g.subarray(v),this.insert=this._insertReadonly}else{this.d=i+2*a;for(let g=0;g<this.d*this.d;g++)h.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=t,this.padding=a,this.scale=i/t,this.uid=0;const m=a/i*t;this.min=-m,this.max=t+m}insert(t,i,a,h,m){this._forEachCell(i,a,h,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,i,a,h,m,g){this.cells[m].push(g)}query(t,i,a,h,m){const g=this.min,v=this.max;if(t<=g&&i<=g&&v<=a&&v<=h&&!m)return Array.prototype.slice.call(this.keys);{const C=[];return this._forEachCell(t,i,a,h,this._queryCell,C,{},m),C}}_queryCell(t,i,a,h,m,g,v,C){const S=this.cells[m];if(S!==null){const M=this.keys,I=this.bboxes;for(let L=0;L<S.length;L++){const F=S[L];if(v[F]===void 0){const O=4*F;(C?C(I[O+0],I[O+1],I[O+2],I[O+3]):t<=I[O+2]&&i<=I[O+3]&&a>=I[O+0]&&h>=I[O+1])?(v[F]=!0,g.push(M[F])):v[F]=!1}}}}_forEachCell(t,i,a,h,m,g,v,C){const S=this._convertToCellCoord(t),M=this._convertToCellCoord(i),I=this._convertToCellCoord(a),L=this._convertToCellCoord(h);for(let F=S;F<=I;F++)for(let O=M;O<=L;O++){const j=this.d*O+F;if((!C||C(this._convertFromCellCoord(F),this._convertFromCellCoord(O),this._convertFromCellCoord(F+1),this._convertFromCellCoord(O+1)))&&m.call(this,t,i,a,h,j,g,v,C))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,i=3+this.cells.length+1+1;let a=0;for(let g=0;g<this.cells.length;g++)a+=this.cells[g].length;const h=new Int32Array(i+a+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let m=i;for(let g=0;g<t.length;g++){const v=t[g];h[3+g]=m,h.set(v,m),m+=v.length}return h[3+t.length]=m,h.set(this.keys,m),m+=this.keys.length,h[3+t.length+1]=m,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer}static serialize(t,i){const a=t.toArrayBuffer();return i&&i.push(a),{buffer:a}}static deserialize(t){return new Ws(t.buffer)}}const Wo={};function ct(o,t,i={}){if(Wo[o])throw new Error(`${o} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:o,writeable:!1}),Wo[o]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}ct("Object",Object),ct("TransferableGridIndex",Ws),ct("Color",Kt),ct("Error",Error),ct("AJAXError",Ht),ct("ResolvedImage",Po),ct("StylePropertyFunction",Ua),ct("StyleExpression",lc,{omit:["_evaluator"]}),ct("ZoomDependentExpression",cc),ct("ZoomConstantExpression",Va),ct("CompoundExpression",ci,{omit:["_evaluate"]});for(const o in es)es[o]._classRegistryKey||ct(`Expression_${o}`,es[o]);function cs(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function xc(o){return o.$name||o.constructor._classRegistryKey}function wh(o){return!function(t){if(t===null||typeof t!="object")return!1;const i=xc(t);return!(!i||i==="Object")}(o)&&(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||o instanceof Error||cs(o)||qe(o)||ArrayBuffer.isView(o)||o instanceof ImageData)}function on(o,t){if(wh(o))return(cs(o)||qe(o))&&t&&t.push(o),ArrayBuffer.isView(o)&&t&&t.push(o.buffer),o instanceof ImageData&&t&&t.push(o.data.buffer),o;if(Array.isArray(o)){const m=[];for(const g of o)m.push(on(g,t));return m}if(typeof o!="object")throw new Error("can't serialize object of type "+typeof o);const i=xc(o);if(!i)throw new Error(`can't serialize object of unregistered class ${o.constructor.name}`);if(!Wo[i])throw new Error(`${i} is not registered.`);const{klass:a}=Wo[i],h=a.serialize?a.serialize(o,t):{};if(a.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in o){if(!o.hasOwnProperty(m)||Wo[i].omit.indexOf(m)>=0)continue;const g=o[m];h[m]=Wo[i].shallow.indexOf(m)>=0?g:on(g,t)}o instanceof Error&&(h.message=o.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(h.$name=i),h}function Hs(o){if(wh(o))return o;if(Array.isArray(o))return o.map(Hs);if(typeof o!="object")throw new Error("can't deserialize object of type "+typeof o);const t=xc(o)||"Object";if(!Wo[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:i}=Wo[t];if(!i)throw new Error(`can't deserialize unregistered class ${t}`);if(i.deserialize)return i.deserialize(o);const a=Object.create(i.prototype);for(const h of Object.keys(o)){if(h==="$name")continue;const m=o[h];a[h]=Wo[t].shallow.indexOf(h)>=0?m:Hs(m)}return a}class Ha{constructor(){this.first=!0}update(t,i){const a=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=i),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=a,!0))}}const Nt={"Latin-1 Supplement":o=>o>=128&&o<=255,"Hangul Jamo":o=>o>=4352&&o<=4607,Khmer:o=>o>=6016&&o<=6143,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Kanbun:o=>o>=12688&&o<=12703,"CJK Strokes":o=>o>=12736&&o<=12783,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Hangul Syllables":o=>o>=44032&&o<=55215,"Private Use Area":o=>o>=57344&&o<=63743,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function Xa(o){for(const t of o)if(Tc(t.charCodeAt(0)))return!0;return!1}function Ch(o){for(const t of o)if(!wc(t.charCodeAt(0)))return!1;return!0}function Ya(o){const t=o.map(i=>{try{return new RegExp(`\\p{sc=${i}}`,"u").source}catch{return null}}).filter(i=>i);return new RegExp(t.join("|"),"u")}const Th=Ya(["Arab","Dupl","Mong","Ougr","Syrc"]);function wc(o){return!Th.test(String.fromCodePoint(o))}const Cc=Ya(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Tc(o){return!(o!==746&&o!==747&&(o<4352||!(Nt["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||Nt["CJK Compatibility"](o)||Nt["CJK Strokes"](o)||!(!Nt["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||Nt["Enclosed CJK Letters and Months"](o)||Nt["Ideographic Description Characters"](o)||Nt.Kanbun(o)||Nt.Katakana(o)&&o!==12540||!(!Nt["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!Nt["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||Nt["Vertical Forms"](o)||Nt["Yijing Hexagram Symbols"](o)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(o))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(o))||Cc.test(String.fromCodePoint(o)))))}function Sc(o){return!(Tc(o)||function(t){return!!(Nt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Nt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Nt["Letterlike Symbols"](t)||Nt["Number Forms"](t)||Nt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Nt["Control Pictures"](t)&&t!==9251||Nt["Optical Character Recognition"](t)||Nt["Enclosed Alphanumerics"](t)||Nt["Geometric Shapes"](t)||Nt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Nt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Nt["CJK Symbols and Punctuation"](t)||Nt.Katakana(t)||Nt["Private Use Area"](t)||Nt["CJK Compatibility Forms"](t)||Nt["Small Form Variants"](t)||Nt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(o))}const hf=Ya(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function kc(o){return hf.test(String.fromCodePoint(o))}function Sh(o,t){return!(!t&&kc(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||Nt.Khmer(o))}function kh(o){for(const t of o)if(kc(t.charCodeAt(0)))return!0;return!1}const nn=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(o){this.pluginStatus=o.pluginStatus,this.pluginURL=o.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(o){if(nn.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=o.applyArabicShaping,this.processBidirectionalText=o.processBidirectionalText,this.processStyledBidirectionalText=o.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(o,t){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(o.pluginStatus!=="loading")return this.setState(o),o;const i=o.pluginURL,a=new Promise(m=>{this.loadScriptResolve=m});t(i);const h=new Promise(m=>setTimeout(()=>m(),this.TIMEOUT));if(yield Promise.race([a,h]),this.isParsed()){const m={pluginStatus:"loaded",pluginURL:i};return this.setState(m),m}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${i}`)})}};class wr{constructor(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ha,this.transition={})}isSupportedScript(t){return function(i,a){for(const h of i)if(!Sh(h.charCodeAt(0),a))return!1;return!0}(t,nn.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,i=t-Math.floor(t),a=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*i}}}class Xs{constructor(t,i){this.property=t,this.value=i,this.expression=function(a,h){if(ja(a))return new Ua(a,h);if(Na(a)){const m=ch(a,h);if(m.result==="error")throw new Error(m.value.map(g=>`${g.key}: ${g.message}`).join(", "));return m.value}{let m=a;return h.type==="color"&&typeof a=="string"?m=Kt.parse(a):h.type!=="padding"||typeof a!="number"&&!Array.isArray(a)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(a)?m=io.parse(a):h.type==="projectionDefinition"&&typeof a=="string"&&(m=Do.parse(a)):m=oo.parse(a),{kind:"constant",evaluate:()=>m}}}(i===void 0?t.specification.default:i,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,i,a){return this.property.possiblyEvaluate(this,t,i,a)}}class Ka{constructor(t){this.property=t,this.value=new Xs(t,void 0)}transitioned(t,i){return new Mc(this.property,this.value,i,br({},t.transition,this.transition),t.now)}untransitioned(){return new Mc(this.property,this.value,null,{},0)}}class Pc{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return ro(this._values[t].value.value)}setValue(t,i){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Ka(this._values[t].property)),this._values[t].value=new Xs(this._values[t].property,i===null?void 0:ro(i))}getTransition(t){return ro(this._values[t].transition)}setTransition(t,i){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Ka(this._values[t].property)),this._values[t].transition=ro(i)||void 0}serialize(){const t={};for(const i of Object.keys(this._values)){const a=this.getValue(i);a!==void 0&&(t[i]=a);const h=this.getTransition(i);h!==void 0&&(t[`${i}-transition`]=h)}return t}transitioned(t,i){const a=new Ys(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].transitioned(t,i._values[h]);return a}untransitioned(){const t=new Ys(this._properties);for(const i of Object.keys(this._values))t._values[i]=this._values[i].untransitioned();return t}}class Mc{constructor(t,i,a,h,m){this.property=t,this.value=i,this.begin=m+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=a)}possiblyEvaluate(t,i,a){const h=t.now||0,m=this.value.possiblyEvaluate(t,i,a),g=this.prior;if(g){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return g.possiblyEvaluate(t,i,a);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(t,i,a),m,cr(v))}}return m}}class Ys{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,i,a){const h=new Ja(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,i,a);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class df{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return ro(this._values[t].value)}setValue(t,i){this._values[t]=new Xs(this._values[t].property,i===null?void 0:ro(i))}serialize(){const t={};for(const i of Object.keys(this._values)){const a=this.getValue(i);a!==void 0&&(t[i]=a)}return t}possiblyEvaluate(t,i,a){const h=new Ja(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,i,a);return h}}class hi{constructor(t,i,a){this.property=t,this.value=i,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,i,a,h){return this.property.evaluate(this.value,this.parameters,t,i,a,h)}}class Ja{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class vt{constructor(t){this.specification=t}possiblyEvaluate(t,i){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(i)}interpolate(t,i,a){const h=qo[this.specification.type];return h?h(t,i,a):t}}class Mt{constructor(t,i){this.specification=t,this.overrides=i}possiblyEvaluate(t,i,a,h){return new hi(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(i,null,{},a,h)}:t.expression,i)}interpolate(t,i,a){if(t.value.kind!=="constant"||i.value.kind!=="constant")return t;if(t.value.value===void 0||i.value.value===void 0)return new hi(this,{kind:"constant",value:void 0},t.parameters);const h=qo[this.specification.type];if(h){const m=h(t.value.value,i.value.value,a);return new hi(this,{kind:"constant",value:m},t.parameters)}return t}evaluate(t,i,a,h,m,g){return t.kind==="constant"?t.value:t.evaluate(i,a,h,m,g)}}class Ks extends Mt{possiblyEvaluate(t,i,a,h){if(t.value===void 0)return new hi(this,{kind:"constant",value:void 0},i);if(t.expression.kind==="constant"){const m=t.expression.evaluate(i,null,{},a,h),g=t.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,v=this._calculate(g,g,g,i);return new hi(this,{kind:"constant",value:v},i)}if(t.expression.kind==="camera"){const m=this._calculate(t.expression.evaluate({zoom:i.zoom-1}),t.expression.evaluate({zoom:i.zoom}),t.expression.evaluate({zoom:i.zoom+1}),i);return new hi(this,{kind:"constant",value:m},i)}return new hi(this,t.expression,i)}evaluate(t,i,a,h,m,g){if(t.kind==="source"){const v=t.evaluate(i,a,h,m,g);return this._calculate(v,v,v,i)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(i.zoom)-1},a,h),t.evaluate({zoom:Math.floor(i.zoom)},a,h),t.evaluate({zoom:Math.floor(i.zoom)+1},a,h),i):t.value}_calculate(t,i,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:i}:{from:a,to:i}}interpolate(t){return t}}class Qa{constructor(t){this.specification=t}possiblyEvaluate(t,i,a,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const m=t.expression.evaluate(i,null,{},a,h);return this._calculate(m,m,m,i)}return this._calculate(t.expression.evaluate(new wr(Math.floor(i.zoom-1),i)),t.expression.evaluate(new wr(Math.floor(i.zoom),i)),t.expression.evaluate(new wr(Math.floor(i.zoom+1),i)),i)}}_calculate(t,i,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:i}:{from:a,to:i}}interpolate(t){return t}}class Ic{constructor(t){this.specification=t}possiblyEvaluate(t,i,a,h){return!!t.expression.evaluate(i,null,{},a,h)}interpolate(){return!1}}class Bo{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in t){const a=t[i];a.specification.overridable&&this.overridableProperties.push(i);const h=this.defaultPropertyValues[i]=new Xs(a,void 0),m=this.defaultTransitionablePropertyValues[i]=new Ka(a);this.defaultTransitioningPropertyValues[i]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=h.possiblyEvaluate({})}}}ct("DataDrivenProperty",Mt),ct("DataConstantProperty",vt),ct("CrossFadedDataDrivenProperty",Ks),ct("CrossFadedProperty",Qa),ct("ColorRampProperty",Ic);const Ph="-transition";class Ai extends ge{constructor(t,i){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),i.layout&&(this._unevaluatedLayout=new df(i.layout)),i.paint)){this._transitionablePaint=new Pc(i.paint);for(const a in t.paint)this.setPaintProperty(a,t.paint[a],{validate:!1});for(const a in t.layout)this.setLayoutProperty(a,t.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ja(i.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,i,a={}){i!=null&&this._validate(uf,`layers.${this.id}.layout.${t}`,t,i,a)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,i):this.visibility=i)}getPaintProperty(t){return t.endsWith(Ph)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,i,a={}){if(i!=null&&this._validate(bc,`layers.${this.id}.paint.${t}`,t,i,a))return!1;if(t.endsWith(Ph))return this._transitionablePaint.setTransition(t.slice(0,-11),i||void 0),!1;{const h=this._transitionablePaint._values[t],m=h.property.specification["property-type"]==="cross-faded-data-driven",g=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(t,i),this._handleSpecialPaintPropertyUpdate(t);const C=this._transitionablePaint._values[t].value;return C.isDataDriven()||g||m||this._handleOverridablePaintPropertyUpdate(t,v,C)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,i,a){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,i){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,i)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Uo(t,(i,a)=>!(i===void 0||a==="layout"&&!Object.keys(i).length||a==="paint"&&!Object.keys(i).length))}_validate(t,i,a,h,m={}){return(!m||m.validate!==!1)&&Wa(this,t.call(ls,{key:i,layerType:this.type,objectKey:a,value:h,styleSpec:A,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const i=this.paint.get(t);if(i instanceof hi&&rs(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}const ff={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class zi{constructor(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class zr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,i){return t._trim(),i&&(t.isTransferred=!0,i.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function $r(o,t=1){let i=0,a=0;return{members:o.map(h=>{const m=ff[h.type].BYTES_PER_ELEMENT,g=i=Mh(i,Math.max(t,m)),v=h.components||1;return a=Math.max(a,m),i+=m*v,{name:h.name,type:h.type,components:v,offset:g}}),size:Mh(i,Math.max(a,t)),alignment:t}}function Mh(o,t){return Math.ceil(o/t)*t}class us extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,i)}emplace(t,i,a){const h=2*t;return this.int16[h+0]=i,this.int16[h+1]=a,t}}us.prototype.bytesPerElement=4,ct("StructArrayLayout2i4",us);class el extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,a)}emplace(t,i,a,h){const m=3*t;return this.int16[m+0]=i,this.int16[m+1]=a,this.int16[m+2]=h,t}}el.prototype.bytesPerElement=6,ct("StructArrayLayout3i6",el);class Ec extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,i,a,h)}emplace(t,i,a,h,m){const g=4*t;return this.int16[g+0]=i,this.int16[g+1]=a,this.int16[g+2]=h,this.int16[g+3]=m,t}}Ec.prototype.bytesPerElement=8,ct("StructArrayLayout4i8",Ec);class Vi extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,a,h,m,g)}emplace(t,i,a,h,m,g,v){const C=6*t;return this.int16[C+0]=i,this.int16[C+1]=a,this.int16[C+2]=h,this.int16[C+3]=m,this.int16[C+4]=g,this.int16[C+5]=v,t}}Vi.prototype.bytesPerElement=12,ct("StructArrayLayout2i4i12",Vi);class tl extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,a,h,m,g)}emplace(t,i,a,h,m,g,v){const C=4*t,S=8*t;return this.int16[C+0]=i,this.int16[C+1]=a,this.uint8[S+4]=h,this.uint8[S+5]=m,this.uint8[S+6]=g,this.uint8[S+7]=v,t}}tl.prototype.bytesPerElement=8,ct("StructArrayLayout2i4ub8",tl);class Mn extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,i)}emplace(t,i,a){const h=2*t;return this.float32[h+0]=i,this.float32[h+1]=a,t}}Mn.prototype.bytesPerElement=8,ct("StructArrayLayout2f8",Mn);class rl extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g,v,C,S,M){const I=this.length;return this.resize(I+1),this.emplace(I,t,i,a,h,m,g,v,C,S,M)}emplace(t,i,a,h,m,g,v,C,S,M,I){const L=10*t;return this.uint16[L+0]=i,this.uint16[L+1]=a,this.uint16[L+2]=h,this.uint16[L+3]=m,this.uint16[L+4]=g,this.uint16[L+5]=v,this.uint16[L+6]=C,this.uint16[L+7]=S,this.uint16[L+8]=M,this.uint16[L+9]=I,t}}rl.prototype.bytesPerElement=20,ct("StructArrayLayout10ui20",rl);class Js extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g,v,C,S,M,I,L){const F=this.length;return this.resize(F+1),this.emplace(F,t,i,a,h,m,g,v,C,S,M,I,L)}emplace(t,i,a,h,m,g,v,C,S,M,I,L,F){const O=12*t;return this.int16[O+0]=i,this.int16[O+1]=a,this.int16[O+2]=h,this.int16[O+3]=m,this.uint16[O+4]=g,this.uint16[O+5]=v,this.uint16[O+6]=C,this.uint16[O+7]=S,this.int16[O+8]=M,this.int16[O+9]=I,this.int16[O+10]=L,this.int16[O+11]=F,t}}Js.prototype.bytesPerElement=24,ct("StructArrayLayout4i4ui4i24",Js);class Ac extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,a)}emplace(t,i,a,h){const m=3*t;return this.float32[m+0]=i,this.float32[m+1]=a,this.float32[m+2]=h,t}}Ac.prototype.bytesPerElement=12,ct("StructArrayLayout3f12",Ac);class hs extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint32[1*t+0]=i,t}}hs.prototype.bytesPerElement=4,ct("StructArrayLayout1ul4",hs);class In extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g,v,C,S){const M=this.length;return this.resize(M+1),this.emplace(M,t,i,a,h,m,g,v,C,S)}emplace(t,i,a,h,m,g,v,C,S,M){const I=10*t,L=5*t;return this.int16[I+0]=i,this.int16[I+1]=a,this.int16[I+2]=h,this.int16[I+3]=m,this.int16[I+4]=g,this.int16[I+5]=v,this.uint32[L+3]=C,this.uint16[I+8]=S,this.uint16[I+9]=M,t}}In.prototype.bytesPerElement=20,ct("StructArrayLayout6i1ul2ui20",In);class zc extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,a,h,m,g)}emplace(t,i,a,h,m,g,v){const C=6*t;return this.int16[C+0]=i,this.int16[C+1]=a,this.int16[C+2]=h,this.int16[C+3]=m,this.int16[C+4]=g,this.int16[C+5]=v,t}}zc.prototype.bytesPerElement=12,ct("StructArrayLayout2i2i2i12",zc);class ol extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,a,h,m)}emplace(t,i,a,h,m,g){const v=4*t,C=8*t;return this.float32[v+0]=i,this.float32[v+1]=a,this.float32[v+2]=h,this.int16[C+6]=m,this.int16[C+7]=g,t}}ol.prototype.bytesPerElement=16,ct("StructArrayLayout2f1f2i16",ol);class En extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,a,h,m,g)}emplace(t,i,a,h,m,g,v){const C=16*t,S=4*t,M=8*t;return this.uint8[C+0]=i,this.uint8[C+1]=a,this.float32[S+1]=h,this.float32[S+2]=m,this.int16[M+6]=g,this.int16[M+7]=v,t}}En.prototype.bytesPerElement=16,ct("StructArrayLayout2ub2f2i16",En);class il extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,a)}emplace(t,i,a,h){const m=3*t;return this.uint16[m+0]=i,this.uint16[m+1]=a,this.uint16[m+2]=h,t}}il.prototype.bytesPerElement=6,ct("StructArrayLayout3ui6",il);class Dc extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g,v,C,S,M,I,L,F,O,j,W,ee){const de=this.length;return this.resize(de+1),this.emplace(de,t,i,a,h,m,g,v,C,S,M,I,L,F,O,j,W,ee)}emplace(t,i,a,h,m,g,v,C,S,M,I,L,F,O,j,W,ee,de){const oe=24*t,B=12*t,q=48*t;return this.int16[oe+0]=i,this.int16[oe+1]=a,this.uint16[oe+2]=h,this.uint16[oe+3]=m,this.uint32[B+2]=g,this.uint32[B+3]=v,this.uint32[B+4]=C,this.uint16[oe+10]=S,this.uint16[oe+11]=M,this.uint16[oe+12]=I,this.float32[B+7]=L,this.float32[B+8]=F,this.uint8[q+36]=O,this.uint8[q+37]=j,this.uint8[q+38]=W,this.uint32[B+10]=ee,this.int16[oe+22]=de,t}}Dc.prototype.bytesPerElement=48,ct("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Dc);class nl extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g,v,C,S,M,I,L,F,O,j,W,ee,de,oe,B,q,ie,xe,Oe,Se,Ie,Ze,je){const We=this.length;return this.resize(We+1),this.emplace(We,t,i,a,h,m,g,v,C,S,M,I,L,F,O,j,W,ee,de,oe,B,q,ie,xe,Oe,Se,Ie,Ze,je)}emplace(t,i,a,h,m,g,v,C,S,M,I,L,F,O,j,W,ee,de,oe,B,q,ie,xe,Oe,Se,Ie,Ze,je,We){const Le=32*t,ut=16*t;return this.int16[Le+0]=i,this.int16[Le+1]=a,this.int16[Le+2]=h,this.int16[Le+3]=m,this.int16[Le+4]=g,this.int16[Le+5]=v,this.int16[Le+6]=C,this.int16[Le+7]=S,this.uint16[Le+8]=M,this.uint16[Le+9]=I,this.uint16[Le+10]=L,this.uint16[Le+11]=F,this.uint16[Le+12]=O,this.uint16[Le+13]=j,this.uint16[Le+14]=W,this.uint16[Le+15]=ee,this.uint16[Le+16]=de,this.uint16[Le+17]=oe,this.uint16[Le+18]=B,this.uint16[Le+19]=q,this.uint16[Le+20]=ie,this.uint16[Le+21]=xe,this.uint16[Le+22]=Oe,this.uint32[ut+12]=Se,this.float32[ut+13]=Ie,this.float32[ut+14]=Ze,this.uint16[Le+30]=je,this.uint16[Le+31]=We,t}}nl.prototype.bytesPerElement=64,ct("StructArrayLayout8i15ui1ul2f2ui64",nl);class sl extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.float32[1*t+0]=i,t}}sl.prototype.bytesPerElement=4,ct("StructArrayLayout1f4",sl);class f extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,a)}emplace(t,i,a,h){const m=3*t;return this.uint16[6*t+0]=i,this.float32[m+1]=a,this.float32[m+2]=h,t}}f.prototype.bytesPerElement=12,ct("StructArrayLayout1ui2f12",f);class e extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,a)}emplace(t,i,a,h){const m=4*t;return this.uint32[2*t+0]=i,this.uint16[m+2]=a,this.uint16[m+3]=h,t}}e.prototype.bytesPerElement=8,ct("StructArrayLayout1ul2ui8",e);class r extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,i)}emplace(t,i,a){const h=2*t;return this.uint16[h+0]=i,this.uint16[h+1]=a,t}}r.prototype.bytesPerElement=4,ct("StructArrayLayout2ui4",r);class l extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint16[1*t+0]=i,t}}l.prototype.bytesPerElement=2,ct("StructArrayLayout1ui2",l);class u extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,i,a,h)}emplace(t,i,a,h,m){const g=4*t;return this.float32[g+0]=i,this.float32[g+1]=a,this.float32[g+2]=h,this.float32[g+3]=m,t}}u.prototype.bytesPerElement=16,ct("StructArrayLayout4f16",u);class p extends zi{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new se(this.anchorPointX,this.anchorPointY)}}p.prototype.size=20;class y extends In{get(t){return new p(this,t)}}ct("CollisionBoxArray",y);class w extends zi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}w.prototype.size=48;class T extends Dc{get(t){return new w(this,t)}}ct("PlacedSymbolArray",T);class k extends zi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}k.prototype.size=64;class E extends nl{get(t){return new k(this,t)}}ct("SymbolInstanceArray",E);class D extends sl{getoffsetX(t){return this.float32[1*t+0]}}ct("GlyphOffsetArray",D);class R extends el{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}ct("SymbolLineVertexArray",R);class $ extends zi{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}$.prototype.size=12;class N extends f{get(t){return new $(this,t)}}ct("TextAnchorOffsetArray",N);class K extends zi{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}K.prototype.size=8;class Y extends e{get(t){return new K(this,t)}}ct("FeatureIndexArray",Y);class J extends us{}class re extends us{}class ne extends us{}class le extends Vi{}class ue extends tl{}class fe extends Mn{}class he extends rl{}class be extends Js{}class we extends Ac{}class Ae extends hs{}class Re extends zc{}class Ee extends En{}class Ke extends il{}class Xe extends r{}const $e=$r([{name:"a_pos",components:2,type:"Int16"}],4),{members:mt}=$e;class xt{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,i,a,h){const m=this.segments[this.segments.length-1];return t>xt.MAX_VERTEX_ARRAY_LENGTH&&Wr(`Max vertices per segment is ${xt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${xt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!m||m.vertexLength+t>xt.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h?this.createNewSegment(i,a,h):m}createNewSegment(t,i,a){const h={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0,vaos:{}};return a!==void 0&&(h.sortKey=a),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(h),h}getOrCreateLatestSegment(t,i,a){return this.prepareSegment(0,t,i,a)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const i in t.vaos)t.vaos[i].destroy()}static simpleSegment(t,i,a,h){return new xt([{vertexOffset:t,primitiveOffset:i,vertexLength:a,primitiveLength:h,vaos:{},sortKey:0}])}}function er(o,t){return 256*(o=Sr(Math.floor(o),0,255))+Sr(Math.floor(t),0,255)}xt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ct("SegmentVector",xt);const fr=$r([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ar,Cr,yr,rr={exports:{}},lr={exports:{}},no={exports:{}},so=function(){if(yr)return rr.exports;yr=1;var o=(ar||(ar=1,lr.exports=function(i,a){var h,m,g,v,C,S,M,I;for(m=i.length-(h=3&i.length),g=a,C=3432918353,S=461845907,I=0;I<m;)M=255&i.charCodeAt(I)|(255&i.charCodeAt(++I))<<8|(255&i.charCodeAt(++I))<<16|(255&i.charCodeAt(++I))<<24,++I,g=27492+(65535&(v=5*(65535&(g=(g^=M=(65535&(M=(M=(65535&M)*C+(((M>>>16)*C&65535)<<16)&4294967295)<<15|M>>>17))*S+(((M>>>16)*S&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(M=0,h){case 3:M^=(255&i.charCodeAt(I+2))<<16;case 2:M^=(255&i.charCodeAt(I+1))<<8;case 1:g^=M=(65535&(M=(M=(65535&(M^=255&i.charCodeAt(I)))*C+(((M>>>16)*C&65535)<<16)&4294967295)<<15|M>>>17))*S+(((M>>>16)*S&65535)<<16)&4294967295}return g^=i.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}),lr.exports),t=(Cr||(Cr=1,no.exports=function(i,a){for(var h,m=i.length,g=a^m,v=0;m>=4;)h=1540483477*(65535&(h=255&i.charCodeAt(v)|(255&i.charCodeAt(++v))<<8|(255&i.charCodeAt(++v))<<16|(255&i.charCodeAt(++v))<<24))+((1540483477*(h>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),m-=4,++v;switch(m){case 3:g^=(255&i.charCodeAt(v+2))<<16;case 2:g^=(255&i.charCodeAt(v+1))<<8;case 1:g=1540483477*(65535&(g^=255&i.charCodeAt(v)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}),no.exports);return rr.exports=o,rr.exports.murmur3=o,rr.exports.murmur2=t,rr.exports}(),Xr=z(so);class po{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,i,a,h){this.ids.push(sn(t)),this.positions.push(i,a,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const i=sn(t);let a=0,h=this.ids.length-1;for(;a<h;){const g=a+h>>1;this.ids[g]>=i?h=g:a=g+1}const m=[];for(;this.ids[a]===i;)m.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return m}static serialize(t,i){const a=new Float64Array(t.ids),h=new Uint32Array(t.positions);return Ui(a,h,0,a.length-1),i&&i.push(a.buffer,h.buffer),{ids:a,positions:h}}static deserialize(t){const i=new po;return i.ids=t.ids,i.positions=t.positions,i.indexed=!0,i}}function sn(o){const t=+o;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Xr(String(o))}function Ui(o,t,i,a){for(;i<a;){const h=o[i+a>>1];let m=i-1,g=a+1;for(;;){do m++;while(o[m]<h);do g--;while(o[g]>h);if(m>=g)break;Di(o,m,g),Di(t,3*m,3*g),Di(t,3*m+1,3*g+1),Di(t,3*m+2,3*g+2)}g-i<a-g?(Ui(o,t,i,g),i=g+1):(Ui(o,t,g+1,a),a=g)}}function Di(o,t,i){const a=o[t];o[t]=o[i],o[i]=a}ct("FeaturePositionMap",po);class di{constructor(t,i){this.gl=t.gl,this.location=i}}class An extends di{constructor(t,i){super(t,i),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Qs extends di{constructor(t,i){super(t,i),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class zn extends di{constructor(t,i){super(t,i),this.current=Kt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const fi=new Float32Array(16);function Ri(o){return[er(255*o.r,255*o.g),er(255*o.b,255*o.a)]}class xi{constructor(t,i,a){this.value=t,this.uniformNames=i.map(h=>`u_${h}`),this.type=a}setUniform(t,i,a){t.set(a.constantOr(this.value))}getBinding(t,i,a){return this.type==="color"?new zn(t,i):new An(t,i)}}class Li{constructor(t,i){this.uniformNames=i.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=t.tlbr}setUniform(t,i,a,h){const m=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&t.set(m)}getBinding(t,i,a){return a.substr(0,9)==="u_pattern"?new Qs(t,i):new An(t,i)}}class pr{constructor(t,i,a,h){this.expression=t,this.type=a,this.maxValue=0,this.paintVertexAttributes=i.map(m=>({name:`a_${m}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,i,a,h,m){const g=this.paintVertexArray.length,v=this.expression.evaluate(new wr(0),i,{},h,[],m);this.paintVertexArray.resize(t),this._setPaintValue(g,t,v)}updatePaintArray(t,i,a,h){const m=this.expression.evaluate({zoom:0},a,h);this._setPaintValue(t,i,m)}_setPaintValue(t,i,a){if(this.type==="color"){const h=Ri(a);for(let m=t;m<i;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=t;h<i;h++)this.paintVertexArray.emplace(h,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class hr{constructor(t,i,a,h,m,g){this.expression=t,this.uniformNames=i.map(v=>`u_${v}_t`),this.type=a,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=i.map(v=>({name:`a_${v}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,i,a,h,m){const g=this.expression.evaluate(new wr(this.zoom),i,{},h,[],m),v=this.expression.evaluate(new wr(this.zoom+1),i,{},h,[],m),C=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(C,t,g,v)}updatePaintArray(t,i,a,h){const m=this.expression.evaluate({zoom:this.zoom},a,h),g=this.expression.evaluate({zoom:this.zoom+1},a,h);this._setPaintValue(t,i,m,g)}_setPaintValue(t,i,a,h){if(this.type==="color"){const m=Ri(a),g=Ri(h);for(let v=t;v<i;v++)this.paintVertexArray.emplace(v,m[0],m[1],g[0],g[1])}else{for(let m=t;m<i;m++)this.paintVertexArray.emplace(m,a,h);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,i){const a=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,h=Sr(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,i,a){return new An(t,i)}}class Yr{constructor(t,i,a,h,m,g){this.expression=t,this.type=i,this.useIntegerZoom=a,this.zoom=h,this.layerId=g,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(t,i,a){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,i.patterns&&i.patterns[this.layerId],a)}updatePaintArray(t,i,a,h,m){this._setPaintValues(t,i,a.patterns&&a.patterns[this.layerId],m)}_setPaintValues(t,i,a,h){if(!h||!a)return;const{min:m,mid:g,max:v}=a,C=h[m],S=h[g],M=h[v];if(C&&S&&M)for(let I=t;I<i;I++)this.zoomInPaintVertexArray.emplace(I,S.tl[0],S.tl[1],S.br[0],S.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],S.pixelRatio,C.pixelRatio),this.zoomOutPaintVertexArray.emplace(I,S.tl[0],S.tl[1],S.br[0],S.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],S.pixelRatio,M.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,fr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,fr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Kr{constructor(t,i,a){this.binders={},this._buffers=[];const h=[];for(const m in t.paint._values){if(!a(m))continue;const g=t.paint.get(m);if(!(g instanceof hi&&rs(g.property.specification)))continue;const v=pf(m,t.type),C=g.value,S=g.property.specification.type,M=g.property.useIntegerZoom,I=g.property.specification["property-type"],L=I==="cross-faded"||I==="cross-faded-data-driven";if(C.kind==="constant")this.binders[m]=L?new Li(C.value,v):new xi(C.value,v,S),h.push(`/u_${m}`);else if(C.kind==="source"||L){const F=Ih(m,S,"source");this.binders[m]=L?new Yr(C,S,M,i,F,t.id):new pr(C,v,S,F),h.push(`/a_${m}`)}else{const F=Ih(m,S,"composite");this.binders[m]=new hr(C,v,S,M,i,F),h.push(`/z_${m}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const i=this.binders[t];return i instanceof pr||i instanceof hr?i.maxValue:0}populatePaintArrays(t,i,a,h,m){for(const g in this.binders){const v=this.binders[g];(v instanceof pr||v instanceof hr||v instanceof Yr)&&v.populatePaintArray(t,i,a,h,m)}}setConstantPatternPositions(t,i){for(const a in this.binders){const h=this.binders[a];h instanceof Li&&h.setConstantPatternPositions(t,i)}}updatePaintArrays(t,i,a,h,m){let g=!1;for(const v in t){const C=i.getPositions(v);for(const S of C){const M=a.feature(S.index);for(const I in this.binders){const L=this.binders[I];if((L instanceof pr||L instanceof hr||L instanceof Yr)&&L.expression.isStateDependent===!0){const F=h.paint.get(I);L.expression=F.value,L.updatePaintArray(S.start,S.end,M,t[v],m),g=!0}}}}return g}defines(){const t=[];for(const i in this.binders){const a=this.binders[i];(a instanceof xi||a instanceof Li)&&t.push(...a.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof pr||a instanceof hr)for(let h=0;h<a.paintVertexAttributes.length;h++)t.push(a.paintVertexAttributes[h].name);else if(a instanceof Yr)for(let h=0;h<fr.members.length;h++)t.push(fr.members[h].name)}return t}getBinderUniforms(){const t=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof xi||a instanceof Li||a instanceof hr)for(const h of a.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,i){const a=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof xi||m instanceof Li||m instanceof hr){for(const g of m.uniformNames)if(i[g]){const v=m.getBinding(t,i[g],g);a.push({name:g,property:h,binding:v})}}}return a}setUniforms(t,i,a,h){for(const{name:m,property:g,binding:v}of i)this.binders[g].setUniform(v,h,a.get(g),m)}updatePaintBuffers(t){this._buffers=[];for(const i in this.binders){const a=this.binders[i];if(t&&a instanceof Yr){const h=t.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(a instanceof pr||a instanceof hr)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(t){for(const i in this.binders){const a=this.binders[i];(a instanceof pr||a instanceof hr||a instanceof Yr)&&a.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const i=this.binders[t];(i instanceof pr||i instanceof hr||i instanceof Yr)&&i.destroy()}}}class Dn{constructor(t,i,a=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new Kr(h,i,a);this.needsUpload=!1,this._featureMap=new po,this._bufferOffset=0}populatePaintArrays(t,i,a,h,m,g){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(t,i,h,m,g);i.id!==void 0&&this._featureMap.add(i.id,a,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,i,a,h){for(const m of a)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(t,this._featureMap,i,m,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function pf(o,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${t}-`,"").replace(/-/g,"_")]}function Ih(o,t,i){const a={color:{source:Mn,composite:u},number:{source:sl,composite:Mn}},h=function(m){return{"line-pattern":{source:he,composite:he},"fill-pattern":{source:he,composite:he},"fill-extrusion-pattern":{source:he,composite:he}}[m]}(o);return h&&h[i]||a[t][i]}ct("ConstantBinder",xi),ct("CrossFadedConstantBinder",Li),ct("SourceExpressionBinder",pr),ct("CrossFadedCompositeBinder",Yr),ct("CompositeExpressionBinder",hr),ct("ProgramConfiguration",Kr,{omit:["_buffers"]}),ct("ProgramConfigurationSet",Dn);const Rc=Math.pow(2,14)-1,Eh=-Rc-1;function Rn(o){const t=ft/o.extent,i=o.loadGeometry();for(let a=0;a<i.length;a++){const h=i[a];for(let m=0;m<h.length;m++){const g=h[m],v=Math.round(g.x*t),C=Math.round(g.y*t);g.x=Sr(v,Eh,Rc),g.y=Sr(C,Eh,Rc),(v<g.x||v>g.x+1||C<g.y||C>g.y+1)&&Wr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function Ho(o,t){return{type:o.type,id:o.id,properties:o.properties,geometry:t?Rn(o):[]}}const Lc=-32768;function Ah(o,t,i,a,h){o.emplaceBack(Lc+8*t+a,Lc+8*i+h)}class al{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new re,this.indexArray=new Ke,this.segments=new xt,this.programConfigurations=new Dn(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,a){const h=this.layers[0],m=[];let g=null,v=!1,C=h.type==="heatmap";if(h.type==="circle"){const M=h;g=M.layout.get("circle-sort-key"),v=!g.isConstant(),C=C||M.paint.get("circle-pitch-alignment")==="map"}const S=C?i.subdivisionGranularity.circle:1;for(const{feature:M,id:I,index:L,sourceLayerIndex:F}of t){const O=this.layers[0]._featureFilter.needGeometry,j=Ho(M,O);if(!this.layers[0]._featureFilter.filter(new wr(this.zoom),j,a))continue;const W=v?g.evaluate(j,{},a):void 0,ee={id:I,properties:M.properties,type:M.type,sourceLayerIndex:F,index:L,geometry:O?j.geometry:Rn(M),patterns:{},sortKey:W};m.push(ee)}v&&m.sort((M,I)=>M.sortKey-I.sortKey);for(const M of m){const{geometry:I,index:L,sourceLayerIndex:F}=M,O=t[L].feature;this.addFeature(M,I,L,a,S),i.featureIndex.insert(O,I,L,F,this.index)}}update(t,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,mt),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,i,a,h,m=1){let g;switch(m){case 1:g=[0,7];break;case 3:g=[0,2,5,7];break;case 5:g=[0,1,3,4,6,7];break;case 7:g=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${m}; valid values are 1, 3, 5, 7.`)}const v=g.length;for(const C of i)for(const S of C){const M=S.x,I=S.y;if(M<0||M>=ft||I<0||I>=ft)continue;const L=this.segments.prepareSegment(v*v,this.layoutVertexArray,this.indexArray,t.sortKey),F=L.vertexLength;for(let O=0;O<v;O++)for(let j=0;j<v;j++)Ah(this.layoutVertexArray,M,I,g[j],g[O]);for(let O=0;O<v-1;O++)for(let j=0;j<v-1;j++){const W=F+O*v+j,ee=F+(O+1)*v+j;this.indexArray.emplaceBack(W,ee+1,W+1),this.indexArray.emplaceBack(W,ee,ee+1)}L.vertexLength+=v*v,L.primitiveLength+=(v-1)*(v-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,{},h)}}function ll(o,t){for(let i=0;i<o.length;i++)if(ul(t,o[i]))return!0;for(let i=0;i<t.length;i++)if(ul(o,t[i]))return!0;return!!mf(o,t)}function zh(o,t,i){return!!ul(o,t)||!!gf(t,o,i)}function cl(o,t){if(o.length===1)return ym(t,o[0]);for(let i=0;i<t.length;i++){const a=t[i];for(let h=0;h<a.length;h++)if(ul(o,a[h]))return!0}for(let i=0;i<o.length;i++)if(ym(t,o[i]))return!0;for(let i=0;i<t.length;i++)if(mf(o,t[i]))return!0;return!1}function xv(o,t,i){if(o.length>1){if(mf(o,t))return!0;for(let a=0;a<t.length;a++)if(gf(t[a],o,i))return!0}for(let a=0;a<o.length;a++)if(gf(o[a],t,i))return!0;return!1}function mf(o,t){if(o.length===0||t.length===0)return!1;for(let i=0;i<o.length-1;i++){const a=o[i],h=o[i+1];for(let m=0;m<t.length-1;m++)if(wv(a,h,t[m],t[m+1]))return!0}return!1}function wv(o,t,i,a){return ae(o,i,a)!==ae(t,i,a)&&ae(o,t,i)!==ae(o,t,a)}function gf(o,t,i){const a=i*i;if(t.length===1)return o.distSqr(t[0])<a;for(let h=1;h<t.length;h++)if(_m(o,t[h-1],t[h])<a)return!0;return!1}function _m(o,t,i){const a=t.distSqr(i);if(a===0)return o.distSqr(t);const h=((o.x-t.x)*(i.x-t.x)+(o.y-t.y)*(i.y-t.y))/a;return o.distSqr(h<0?t:h>1?i:i.sub(t)._mult(h)._add(t))}function ym(o,t){let i,a,h,m=!1;for(let g=0;g<o.length;g++){i=o[g];for(let v=0,C=i.length-1;v<i.length;C=v++)a=i[v],h=i[C],a.y>t.y!=h.y>t.y&&t.x<(h.x-a.x)*(t.y-a.y)/(h.y-a.y)+a.x&&(m=!m)}return m}function ul(o,t){let i=!1;for(let a=0,h=o.length-1;a<o.length;h=a++){const m=o[a],g=o[h];m.y>t.y!=g.y>t.y&&t.x<(g.x-m.x)*(t.y-m.y)/(g.y-m.y)+m.x&&(i=!i)}return i}function Cv(o,t,i){const a=i[0],h=i[2];if(o.x<a.x&&t.x<a.x||o.x>h.x&&t.x>h.x||o.y<a.y&&t.y<a.y||o.y>h.y&&t.y>h.y)return!1;const m=ae(o,t,i[0]);return m!==ae(o,t,i[1])||m!==ae(o,t,i[2])||m!==ae(o,t,i[3])}function Bc(o,t,i){const a=t.paint.get(o).value;return a.kind==="constant"?a.value:i.programConfigurations.get(t.id).getMaxValue(o)}function Dh(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function Rh(o,t,i,a,h){if(!t[0]&&!t[1])return o;const m=se.convert(t)._mult(h);i==="viewport"&&m._rotate(-a);const g=[];for(let v=0;v<o.length;v++)g.push(o[v].sub(m));return g}let vm,bm;ct("CircleBucket",al,{omit:["layers"]});var Tv={get paint(){return bm=bm||new Bo({"circle-radius":new Mt(A.paint_circle["circle-radius"]),"circle-color":new Mt(A.paint_circle["circle-color"]),"circle-blur":new Mt(A.paint_circle["circle-blur"]),"circle-opacity":new Mt(A.paint_circle["circle-opacity"]),"circle-translate":new vt(A.paint_circle["circle-translate"]),"circle-translate-anchor":new vt(A.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new vt(A.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new vt(A.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Mt(A.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Mt(A.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Mt(A.paint_circle["circle-stroke-opacity"])})},get layout(){return vm=vm||new Bo({"circle-sort-key":new Mt(A.layout_circle["circle-sort-key"])})}};class Sv extends Ai{constructor(t){super(t,Tv)}createBucket(t){return new al(t)}queryRadius(t){const i=t;return Bc("circle-radius",this,i)+Bc("circle-stroke-width",this,i)+Dh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:i,featureState:a,geometry:h,transform:m,pixelsToTileUnits:g,pixelPosMatrix:v}){const C=Rh(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-m.bearingInRadians,g),S=this.paint.get("circle-radius").evaluate(i,a)+this.paint.get("circle-stroke-width").evaluate(i,a),M=this.paint.get("circle-pitch-alignment")==="map",I=M?C:function(F,O){return F.map(j=>xm(j,O))}(C,v),L=M?S*g:S;for(const F of h)for(const O of F){const j=M?O:xm(O,v);let W=L;const ee=De([],[O.x,O.y,0,1],v);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?W*=ee[3]/m.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(W*=m.cameraToCenterDistance/ee[3]),zh(I,j,W))return!0}return!1}}function xm(o,t){const i=De([],[o.x,o.y,0,1],t);return new se(i[0]/i[3],i[1]/i[3])}class wm extends al{}let Cm;ct("HeatmapBucket",wm,{omit:["layers"]});var kv={get paint(){return Cm=Cm||new Bo({"heatmap-radius":new Mt(A.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Mt(A.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new vt(A.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ic(A.paint_heatmap["heatmap-color"]),"heatmap-opacity":new vt(A.paint_heatmap["heatmap-opacity"])})}};function _f(o,{width:t,height:i},a,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*i*a)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*i*a}`)}else h=new Uint8Array(t*i*a);return o.width=t,o.height=i,o.data=h,o}function Tm(o,{width:t,height:i},a){if(t===o.width&&i===o.height)return;const h=_f({},{width:t,height:i},a);yf(o,h,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,t),height:Math.min(o.height,i)},a),o.width=t,o.height=i,o.data=h.data}function yf(o,t,i,a,h,m){if(h.width===0||h.height===0)return t;if(h.width>o.width||h.height>o.height||i.x>o.width-h.width||i.y>o.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||a.x>t.width-h.width||a.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const g=o.data,v=t.data;if(g===v)throw new Error("srcData equals dstData, so image is already copied");for(let C=0;C<h.height;C++){const S=((i.y+C)*o.width+i.x)*m,M=((a.y+C)*t.width+a.x)*m;for(let I=0;I<h.width*m;I++)v[M+I]=g[S+I]}return t}class Fc{constructor(t,i){_f(this,t,1,i)}resize(t){Tm(this,t,1)}clone(){return new Fc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,a,h,m){yf(t,i,a,h,m,1)}}class wi{constructor(t,i){_f(this,t,4,i)}resize(t){Tm(this,t,4)}replace(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new wi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,a,h,m){yf(t,i,a,h,m,4)}}function Sm(o){const t={},i=o.resolution||256,a=o.clips?o.clips.length:1,h=o.image||new wi({width:i,height:a});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const m=(g,v,C)=>{t[o.evaluationKey]=C;const S=o.expression.evaluate(t);h.data[g+v+0]=Math.floor(255*S.r/S.a),h.data[g+v+1]=Math.floor(255*S.g/S.a),h.data[g+v+2]=Math.floor(255*S.b/S.a),h.data[g+v+3]=Math.floor(255*S.a)};if(o.clips)for(let g=0,v=0;g<a;++g,v+=4*i)for(let C=0,S=0;C<i;C++,S+=4){const M=C/(i-1),{start:I,end:L}=o.clips[g];m(v,S,I*(1-M)+L*M)}else for(let g=0,v=0;g<i;g++,v+=4)m(0,v,g/(i-1));return h}ct("AlphaImage",Fc),ct("RGBAImage",wi);const vf="big-fb";class Pv extends Ai{createBucket(t){return new wm(t)}constructor(t){super(t,kv),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Sm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(vf)&&this.heatmapFbos.delete(vf)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let km;var Mv={get paint(){return km=km||new Bo({"hillshade-illumination-direction":new vt(A.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new vt(A.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new vt(A.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new vt(A.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new vt(A.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new vt(A.paint_hillshade["hillshade-accent-color"])})}};class Iv extends Ai{constructor(t){super(t,Mv)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Ev=$r([{name:"a_pos",components:2,type:"Int16"}],4),{members:Av}=Ev;function bf(o,t,i){const a=i.patternDependencies;let h=!1;for(const m of t){const g=m.paint.get(`${o}-pattern`);g.isConstant()||(h=!0);const v=g.constantOr(null);v&&(h=!0,a[v.to]=!0,a[v.from]=!0)}return h}function xf(o,t,i,a,h){const m=h.patternDependencies;for(const g of t){const v=g.paint.get(`${o}-pattern`).value;if(v.kind!=="constant"){let C=v.evaluate({zoom:a-1},i,{},h.availableImages),S=v.evaluate({zoom:a},i,{},h.availableImages),M=v.evaluate({zoom:a+1},i,{},h.availableImages);C=C&&C.name?C.name:C,S=S&&S.name?S.name:S,M=M&&M.name?M.name:M,m[C]=!0,m[S]=!0,m[M]=!0,i.patterns[g.id]={min:C,mid:S,max:M}}}return i}function Pm(o,t,i,a,h){let m;if(h===function(g,v,C,S){let M=0;for(let I=v,L=C-S;I<C;I+=S)M+=(g[L]-g[I])*(g[I+1]+g[L+1]),L=I;return M}(o,t,i,a)>0)for(let g=t;g<i;g+=a)m=Am(g/a|0,o[g],o[g+1],m);else for(let g=i-a;g>=t;g-=a)m=Am(g/a|0,o[g],o[g+1],m);return m&&hl(m,m.next)&&(Nc(m),m=m.next),m}function ea(o,t){if(!o)return o;t||(t=o);let i,a=o;do if(i=!1,a.steiner||!hl(a,a.next)&&jr(a.prev,a,a.next)!==0)a=a.next;else{if(Nc(a),a=t=a.prev,a===a.next)break;i=!0}while(i||a!==t);return t}function Oc(o,t,i,a,h,m,g){if(!o)return;!g&&m&&function(C,S,M,I){let L=C;do L.z===0&&(L.z=wf(L.x,L.y,S,M,I)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==C);L.prevZ.nextZ=null,L.prevZ=null,function(F){let O,j=1;do{let W,ee=F;F=null;let de=null;for(O=0;ee;){O++;let oe=ee,B=0;for(let ie=0;ie<j&&(B++,oe=oe.nextZ,oe);ie++);let q=j;for(;B>0||q>0&&oe;)B!==0&&(q===0||!oe||ee.z<=oe.z)?(W=ee,ee=ee.nextZ,B--):(W=oe,oe=oe.nextZ,q--),de?de.nextZ=W:F=W,W.prevZ=de,de=W;ee=oe}de.nextZ=null,j*=2}while(O>1)}(L)}(o,a,h,m);let v=o;for(;o.prev!==o.next;){const C=o.prev,S=o.next;if(m?Dv(o,a,h,m):zv(o))t.push(C.i,o.i,S.i),Nc(o),o=S.next,v=S.next;else if((o=S)===v){g?g===1?Oc(o=Rv(ea(o),t),t,i,a,h,m,2):g===2&&Lv(o,t,i,a,h,m):Oc(ea(o),t,i,a,h,m,1);break}}}function zv(o){const t=o.prev,i=o,a=o.next;if(jr(t,i,a)>=0)return!1;const h=t.x,m=i.x,g=a.x,v=t.y,C=i.y,S=a.y,M=Math.min(h,m,g),I=Math.min(v,C,S),L=Math.max(h,m,g),F=Math.max(v,C,S);let O=a.next;for(;O!==t;){if(O.x>=M&&O.x<=L&&O.y>=I&&O.y<=F&&$c(h,v,m,C,g,S,O.x,O.y)&&jr(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function Dv(o,t,i,a){const h=o.prev,m=o,g=o.next;if(jr(h,m,g)>=0)return!1;const v=h.x,C=m.x,S=g.x,M=h.y,I=m.y,L=g.y,F=Math.min(v,C,S),O=Math.min(M,I,L),j=Math.max(v,C,S),W=Math.max(M,I,L),ee=wf(F,O,t,i,a),de=wf(j,W,t,i,a);let oe=o.prevZ,B=o.nextZ;for(;oe&&oe.z>=ee&&B&&B.z<=de;){if(oe.x>=F&&oe.x<=j&&oe.y>=O&&oe.y<=W&&oe!==h&&oe!==g&&$c(v,M,C,I,S,L,oe.x,oe.y)&&jr(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,B.x>=F&&B.x<=j&&B.y>=O&&B.y<=W&&B!==h&&B!==g&&$c(v,M,C,I,S,L,B.x,B.y)&&jr(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;oe&&oe.z>=ee;){if(oe.x>=F&&oe.x<=j&&oe.y>=O&&oe.y<=W&&oe!==h&&oe!==g&&$c(v,M,C,I,S,L,oe.x,oe.y)&&jr(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;B&&B.z<=de;){if(B.x>=F&&B.x<=j&&B.y>=O&&B.y<=W&&B!==h&&B!==g&&$c(v,M,C,I,S,L,B.x,B.y)&&jr(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function Rv(o,t){let i=o;do{const a=i.prev,h=i.next.next;!hl(a,h)&&Im(a,i,i.next,h)&&jc(a,h)&&jc(h,a)&&(t.push(a.i,i.i,h.i),Nc(i),Nc(i.next),i=o=h),i=i.next}while(i!==o);return ea(i)}function Lv(o,t,i,a,h,m){let g=o;do{let v=g.next.next;for(;v!==g.prev;){if(g.i!==v.i&&jv(g,v)){let C=Em(g,v);return g=ea(g,g.next),C=ea(C,C.next),Oc(g,t,i,a,h,m,0),void Oc(C,t,i,a,h,m,0)}v=v.next}g=g.next}while(g!==o)}function Bv(o,t){let i=o.x-t.x;return i===0&&(i=o.y-t.y,i===0)&&(i=(o.next.y-o.y)/(o.next.x-o.x)-(t.next.y-t.y)/(t.next.x-t.x)),i}function Fv(o,t){const i=function(h,m){let g=m;const v=h.x,C=h.y;let S,M=-1/0;if(hl(h,g))return g;do{if(hl(h,g.next))return g.next;if(C<=g.y&&C>=g.next.y&&g.next.y!==g.y){const j=g.x+(C-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(j<=v&&j>M&&(M=j,S=g.x<g.next.x?g:g.next,j===v))return S}g=g.next}while(g!==m);if(!S)return null;const I=S,L=S.x,F=S.y;let O=1/0;g=S;do{if(v>=g.x&&g.x>=L&&v!==g.x&&Mm(C<F?v:M,C,L,F,C<F?M:v,C,g.x,g.y)){const j=Math.abs(C-g.y)/(v-g.x);jc(g,h)&&(j<O||j===O&&(g.x>S.x||g.x===S.x&&Ov(S,g)))&&(S=g,O=j)}g=g.next}while(g!==I);return S}(o,t);if(!i)return t;const a=Em(i,o);return ea(a,a.next),ea(i,i.next)}function Ov(o,t){return jr(o.prev,o,t.prev)<0&&jr(t.next,o,o.next)<0}function wf(o,t,i,a,h){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-i)*h|0)|o<<8))|o<<4))|o<<2))|o<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-a)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function $v(o){let t=o,i=o;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==o);return i}function Mm(o,t,i,a,h,m,g,v){return(h-g)*(t-v)>=(o-g)*(m-v)&&(o-g)*(a-v)>=(i-g)*(t-v)&&(i-g)*(m-v)>=(h-g)*(a-v)}function $c(o,t,i,a,h,m,g,v){return!(o===g&&t===v)&&Mm(o,t,i,a,h,m,g,v)}function jv(o,t){return o.next.i!==t.i&&o.prev.i!==t.i&&!function(i,a){let h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==a.i&&h.next.i!==a.i&&Im(h,h.next,i,a))return!0;h=h.next}while(h!==i);return!1}(o,t)&&(jc(o,t)&&jc(t,o)&&function(i,a){let h=i,m=!1;const g=(i.x+a.x)/2,v=(i.y+a.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&g<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==i);return m}(o,t)&&(jr(o.prev,o,t.prev)||jr(o,t.prev,t))||hl(o,t)&&jr(o.prev,o,o.next)>0&&jr(t.prev,t,t.next)>0)}function jr(o,t,i){return(t.y-o.y)*(i.x-t.x)-(t.x-o.x)*(i.y-t.y)}function hl(o,t){return o.x===t.x&&o.y===t.y}function Im(o,t,i,a){const h=Bh(jr(o,t,i)),m=Bh(jr(o,t,a)),g=Bh(jr(i,a,o)),v=Bh(jr(i,a,t));return h!==m&&g!==v||!(h!==0||!Lh(o,i,t))||!(m!==0||!Lh(o,a,t))||!(g!==0||!Lh(i,o,a))||!(v!==0||!Lh(i,t,a))}function Lh(o,t,i){return t.x<=Math.max(o.x,i.x)&&t.x>=Math.min(o.x,i.x)&&t.y<=Math.max(o.y,i.y)&&t.y>=Math.min(o.y,i.y)}function Bh(o){return o>0?1:o<0?-1:0}function jc(o,t){return jr(o.prev,o,o.next)<0?jr(o,t,o.next)>=0&&jr(o,o.prev,t)>=0:jr(o,t,o.prev)<0||jr(o,o.next,t)<0}function Em(o,t){const i=Cf(o.i,o.x,o.y),a=Cf(t.i,t.x,t.y),h=o.next,m=t.prev;return o.next=t,t.prev=o,i.next=h,h.prev=i,a.next=i,i.prev=a,m.next=a,a.prev=m,a}function Am(o,t,i,a){const h=Cf(o,t,i);return a?(h.next=a.next,h.prev=a,a.next.prev=h,a.next=h):(h.prev=h,h.next=h),h}function Nc(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function Cf(o,t,i){return{i:o,x:t,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class dl{constructor(t,i){if(i>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=i}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Fh{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Fh.noSubdivision=new Fh({fill:new dl(0,0),line:new dl(0,0),tile:new dl(0,0),stencil:new dl(0,0),circle:1}),ct("SubdivisionGranularityExpression",dl),ct("SubdivisionGranularitySetting",Fh);const fl=-32768,Vc=32767;class Nv{constructor(t,i){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=ft/t,this._canonical=i}_getKey(t,i){return(t+=32768)<<16|(i+=32768)<<0}_vertexToIndex(t,i){if(t<-32768||i<-32768||t>32767||i>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const a=0|Math.round(t),h=0|Math.round(i),m=this._getKey(a,h);if(this._vertexDictionary.has(m))return this._vertexDictionary.get(m);const g=this._vertexBuffer.length/2;return this._vertexDictionary.set(m,g),this._vertexBuffer.push(a,h),g}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(h,m){const g=[];for(let v=0;v<m.length;v+=3){const C=m[v],S=m[v+1],M=m[v+2],I=h[2*C],L=h[2*C+1];(h[2*S]-I)*(h[2*M+1]-L)-(h[2*S+1]-L)*(h[2*M]-I)>0?(g.push(C),g.push(M),g.push(S)):(g.push(C),g.push(S),g.push(M))}return g}(this._vertexBuffer,t);const i=[],a=t.length;for(let h=0;h<a;h+=3){const m=[t[h+0],t[h+1],t[h+2]],g=[this._vertexBuffer[2*t[h+0]+0],this._vertexBuffer[2*t[h+0]+1],this._vertexBuffer[2*t[h+1]+0],this._vertexBuffer[2*t[h+1]+1],this._vertexBuffer[2*t[h+2]+0],this._vertexBuffer[2*t[h+2]+1]];let v=1/0,C=1/0,S=-1/0,M=-1/0;for(let j=0;j<3;j++){const W=g[2*j],ee=g[2*j+1];v=Math.min(v,W),S=Math.max(S,W),C=Math.min(C,ee),M=Math.max(M,ee)}if(v===S||C===M)continue;const I=Math.floor(v/this._granularityCellSize),L=Math.ceil(S/this._granularityCellSize),F=Math.floor(C/this._granularityCellSize),O=Math.ceil(M/this._granularityCellSize);if(I!==L||F!==O)for(let j=F;j<O;j++){const W=this._scanlineGenerateVertexRingForCellRow(j,g,m);Vv(this._vertexBuffer,W,i)}else i.push(...m)}return i}_scanlineGenerateVertexRingForCellRow(t,i,a){const h=t*this._granularityCellSize,m=h+this._granularityCellSize,g=[];for(let v=0;v<3;v++){const C=i[2*v],S=i[2*v+1],M=i[2*(v+1)%6],I=i[(2*(v+1)+1)%6],L=i[2*(v+2)%6],F=i[(2*(v+2)+1)%6],O=M-C,j=I-S,W=O===0,ee=j===0,de=(h-S)/j,oe=(m-S)/j,B=Math.min(de,oe),q=Math.max(de,oe);if(!ee&&(B>=1||q<=0)||ee&&(S<h||S>m)){I>=h&&I<=m&&g.push(a[(v+1)%3]);continue}!ee&&B>0&&g.push(this._vertexToIndex(C+O*B,S+j*B));const ie=C+O*Math.max(B,0),xe=C+O*Math.min(q,1);W||this._generateIntraEdgeVertices(g,C,S,M,I,ie,xe),!ee&&q<1&&g.push(this._vertexToIndex(C+O*q,S+j*q)),(ee||I>=h&&I<=m)&&g.push(a[(v+1)%3]),!ee&&(I<=h||I>=m)&&this._generateInterEdgeVertices(g,C,S,M,I,L,F,xe,h,m)}return g}_generateIntraEdgeVertices(t,i,a,h,m,g,v){const C=h-i,S=m-a,M=S===0,I=M?Math.min(i,h):Math.min(g,v),L=M?Math.max(i,h):Math.max(g,v),F=Math.floor(I/this._granularityCellSize)+1,O=Math.ceil(L/this._granularityCellSize)-1;if(M?i<h:g<v)for(let j=F;j<=O;j++){const W=j*this._granularityCellSize;t.push(this._vertexToIndex(W,a+S*(W-i)/C))}else for(let j=O;j>=F;j--){const W=j*this._granularityCellSize;t.push(this._vertexToIndex(W,a+S*(W-i)/C))}}_generateInterEdgeVertices(t,i,a,h,m,g,v,C,S,M){const I=m-a,L=g-h,F=v-m,O=(S-m)/F,j=(M-m)/F,W=Math.min(O,j),ee=Math.max(O,j),de=h+L*W;let oe=Math.floor(Math.min(de,C)/this._granularityCellSize)+1,B=Math.ceil(Math.max(de,C)/this._granularityCellSize)-1,q=C<de;const ie=F===0;if(ie&&(v===S||v===M))return;if(ie||W>=1||ee<=0){const Oe=a-v,Se=g+(i-g)*Math.min((S-v)/Oe,(M-v)/Oe);oe=Math.floor(Math.min(Se,C)/this._granularityCellSize)+1,B=Math.ceil(Math.max(Se,C)/this._granularityCellSize)-1,q=C<Se}const xe=I>0?M:S;if(q)for(let Oe=oe;Oe<=B;Oe++)t.push(this._vertexToIndex(Oe*this._granularityCellSize,xe));else for(let Oe=B;Oe>=oe;Oe--)t.push(this._vertexToIndex(Oe*this._granularityCellSize,xe))}_generateOutline(t){const i=[];for(const a of t){const h=ta(a,this._granularity,!0),m=this._pointArrayToIndices(h),g=[];for(let v=1;v<m.length;v++)g.push(m[v-1]),g.push(m[v]);i.push(g)}return i}_handlePoles(t){let i=!1,a=!1;this._canonical&&(this._canonical.y===0&&(i=!0),this._canonical.y===(1<<this._canonical.z)-1&&(a=!0)),(i||a)&&this._fillPoles(t,i,a)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let i=0;i<t.length;i+=2){const a=t[i+1];a===fl&&(t[i+1]=-32767),a===Vc&&(t[i+1]=32766)}}_generatePoleQuad(t,i,a,h,m,g){h>m!=(g===fl)?(t.push(i),t.push(a),t.push(this._vertexToIndex(h,g)),t.push(a),t.push(this._vertexToIndex(m,g)),t.push(this._vertexToIndex(h,g))):(t.push(a),t.push(i),t.push(this._vertexToIndex(h,g)),t.push(this._vertexToIndex(m,g)),t.push(a),t.push(this._vertexToIndex(h,g)))}_fillPoles(t,i,a){const h=this._vertexBuffer,m=ft,g=t.length;for(let v=2;v<g;v+=3){const C=t[v-2],S=t[v-1],M=t[v],I=h[2*C],L=h[2*C+1],F=h[2*S],O=h[2*S+1],j=h[2*M],W=h[2*M+1];i&&(L===0&&O===0&&this._generatePoleQuad(t,C,S,I,F,fl),O===0&&W===0&&this._generatePoleQuad(t,S,M,F,j,fl),W===0&&L===0&&this._generatePoleQuad(t,M,C,j,I,fl)),a&&(L===m&&O===m&&this._generatePoleQuad(t,C,S,I,F,Vc),O===m&&W===m&&this._generatePoleQuad(t,S,M,F,j,Vc),W===m&&L===m&&this._generatePoleQuad(t,M,C,j,I,Vc))}}_initializeVertices(t){for(let i=0;i<t.length;i+=2)this._vertexToIndex(t[i],t[i+1])}subdividePolygonInternal(t,i){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:a,holeIndices:h}=function(v){const C=[],S=[];for(const M of v)if(M.length!==0){M!==v[0]&&C.push(S.length/2);for(let I=0;I<M.length;I++)S.push(M[I].x),S.push(M[I].y)}return{flattened:S,holeIndices:C}}(t);let m;this._initializeVertices(a);try{const v=function(S,M,I=2){const L=M&&M.length,F=L?M[0]*I:S.length;let O=Pm(S,0,F,I,!0);const j=[];if(!O||O.next===O.prev)return j;let W,ee,de;if(L&&(O=function(oe,B,q,ie){const xe=[];for(let Oe=0,Se=B.length;Oe<Se;Oe++){const Ie=Pm(oe,B[Oe]*ie,Oe<Se-1?B[Oe+1]*ie:oe.length,ie,!1);Ie===Ie.next&&(Ie.steiner=!0),xe.push($v(Ie))}xe.sort(Bv);for(let Oe=0;Oe<xe.length;Oe++)q=Fv(xe[Oe],q);return q}(S,M,O,I)),S.length>80*I){W=1/0,ee=1/0;let oe=-1/0,B=-1/0;for(let q=I;q<F;q+=I){const ie=S[q],xe=S[q+1];ie<W&&(W=ie),xe<ee&&(ee=xe),ie>oe&&(oe=ie),xe>B&&(B=xe)}de=Math.max(oe-W,B-ee),de=de!==0?32767/de:0}return Oc(O,j,I,W,ee,de,0),j}(a,h),C=this._convertIndices(a,v);m=this._subdivideTrianglesScanline(C)}catch(v){console.error(v)}let g=[];return i&&(g=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(m),{verticesFlattened:this._vertexBuffer,indicesTriangles:m,indicesLineList:g}}_convertIndices(t,i){const a=[];for(let h=0;h<i.length;h++)a.push(this._vertexToIndex(t[2*i[h]],t[2*i[h]+1]));return a}_pointArrayToIndices(t){const i=[];for(let a=0;a<t.length;a++){const h=t[a];i.push(this._vertexToIndex(h.x,h.y))}return i}}function zm(o,t,i,a=!0){return new Nv(i,t).subdividePolygonInternal(o,a)}function ta(o,t,i=!1){if(!o||o.length<1)return[];if(o.length<2)return[];const a=o[0],h=o[o.length-1],m=i&&(a.x!==h.x||a.y!==h.y);if(t<2)return m?[...o,o[0]]:[...o];const g=Math.floor(ft/t),v=[];v.push(new se(o[0].x,o[0].y));const C=o.length,S=m?C:C-1;for(let M=0;M<S;M++){const I=o[M],L=M<C-1?o[M+1]:o[0],F=I.x,O=I.y,j=L.x,W=L.y,ee=F!==j,de=O!==W;if(!ee&&!de)continue;const oe=j-F,B=W-O,q=Math.abs(oe),ie=Math.abs(B);let xe=F,Oe=O;for(;;){const Ie=oe>0?(Math.floor(xe/g)+1)*g:(Math.ceil(xe/g)-1)*g,Ze=B>0?(Math.floor(Oe/g)+1)*g:(Math.ceil(Oe/g)-1)*g,je=Math.abs(xe-Ie),We=Math.abs(Oe-Ze),Le=Math.abs(xe-j),ut=Math.abs(Oe-W),kt=ee?je/q:Number.POSITIVE_INFINITY,St=de?We/ie:Number.POSITIVE_INFINITY;if((Le<=je||!ee)&&(ut<=We||!de))break;if(kt<St&&ee||!de){xe=Ie,Oe+=B*kt;const gt=new se(xe,Math.round(Oe));v[v.length-1].x===gt.x&&v[v.length-1].y===gt.y||v.push(gt)}else{xe+=oe*St,Oe=Ze;const gt=new se(Math.round(xe),Oe);v[v.length-1].x===gt.x&&v[v.length-1].y===gt.y||v.push(gt)}}const Se=new se(j,W);v[v.length-1].x===Se.x&&v[v.length-1].y===Se.y||v.push(Se)}return v}function Vv(o,t,i){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let a=0,h=o[2*t[0]];for(let C=1;C<t.length;C++){const S=o[2*t[C]];S<h&&(h=S,a=C)}const m=t.length;let g=a,v=(g+1)%m;for(;;){const C=g-1>=0?g-1:m-1,S=(v+1)%m,M=o[2*t[C]],I=o[2*t[S]],L=o[2*t[g]],F=o[2*t[g]+1],O=o[2*t[v]+1];let j=!1;if(M<I)j=!0;else if(M>I)j=!1;else{const W=O-F,ee=-(o[2*t[v]]-L),de=F<O?1:-1;((M-L)*W+(o[2*t[C]+1]-F)*ee)*de>((I-L)*W+(o[2*t[S]+1]-F)*ee)*de&&(j=!0)}if(j){const W=t[C],ee=t[g],de=t[v];W!==ee&&W!==de&&ee!==de&&i.push(de,ee,W),g--,g<0&&(g=m-1)}else{const W=t[S],ee=t[g],de=t[v];W!==ee&&W!==de&&ee!==de&&i.push(de,ee,W),v++,v>=m&&(v=0)}if(C===S)break}}function Dm(o,t,i,a,h,m,g,v,C){const S=h.length/2,M=g&&v&&C;if(S<xt.MAX_VERTEX_ARRAY_LENGTH){const I=t.prepareSegment(S,i,a),L=I.vertexLength;for(let j=0;j<m.length;j+=3)a.emplaceBack(L+m[j],L+m[j+1],L+m[j+2]);let F,O;I.vertexLength+=S,I.primitiveLength+=m.length/3,M&&(O=g.prepareSegment(S,i,v),F=O.vertexLength,O.vertexLength+=S);for(let j=0;j<h.length;j+=2)o(h[j],h[j+1]);if(M)for(let j=0;j<C.length;j++){const W=C[j];for(let ee=1;ee<W.length;ee+=2)v.emplaceBack(F+W[ee-1],F+W[ee]);O.primitiveLength+=W.length/2}}else(function(I,L,F,O,j,W){const ee=[];for(let ie=0;ie<O.length/2;ie++)ee.push(-1);const de={count:0};let oe=0,B=I.getOrCreateLatestSegment(L,F),q=B.vertexLength;for(let ie=2;ie<j.length;ie+=3){const xe=j[ie-2],Oe=j[ie-1],Se=j[ie];let Ie=ee[xe]<oe,Ze=ee[Oe]<oe,je=ee[Se]<oe;B.vertexLength+((Ie?1:0)+(Ze?1:0)+(je?1:0))>xt.MAX_VERTEX_ARRAY_LENGTH&&(B=I.createNewSegment(L,F),oe=de.count,Ie=!0,Ze=!0,je=!0,q=0);const We=Uc(ee,O,W,de,xe,Ie,B),Le=Uc(ee,O,W,de,Oe,Ze,B),ut=Uc(ee,O,W,de,Se,je,B);F.emplaceBack(q+We-oe,q+Le-oe,q+ut-oe),B.primitiveLength++}})(t,i,a,h,m,o),M&&function(I,L,F,O,j,W){const ee=[];for(let ie=0;ie<O.length/2;ie++)ee.push(-1);const de={count:0};let oe=0,B=I.getOrCreateLatestSegment(L,F),q=B.vertexLength;for(let ie=0;ie<j.length;ie++){const xe=j[ie];for(let Oe=1;Oe<j[ie].length;Oe+=2){const Se=xe[Oe-1],Ie=xe[Oe];let Ze=ee[Se]<oe,je=ee[Ie]<oe;B.vertexLength+((Ze?1:0)+(je?1:0))>xt.MAX_VERTEX_ARRAY_LENGTH&&(B=I.createNewSegment(L,F),oe=de.count,Ze=!0,je=!0,q=0);const We=Uc(ee,O,W,de,Se,Ze,B),Le=Uc(ee,O,W,de,Ie,je,B);F.emplaceBack(q+We-oe,q+Le-oe),B.primitiveLength++}}}(g,i,v,h,C,o),t.forceNewSegmentOnNextPrepare(),g==null||g.forceNewSegmentOnNextPrepare()}function Uc(o,t,i,a,h,m,g){if(m){const v=a.count;return i(t[2*h],t[2*h+1]),o[h]=a.count,a.count++,g.vertexLength++,v}return o[h]}class Tf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ne,this.indexArray=new Ke,this.indexArray2=new Xe,this.programConfigurations=new Dn(t.layers,t.zoom),this.segments=new xt,this.segments2=new xt,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,a){this.hasPattern=bf("fill",this.layers,i);const h=this.layers[0].layout.get("fill-sort-key"),m=!h.isConstant(),g=[];for(const{feature:v,id:C,index:S,sourceLayerIndex:M}of t){const I=this.layers[0]._featureFilter.needGeometry,L=Ho(v,I);if(!this.layers[0]._featureFilter.filter(new wr(this.zoom),L,a))continue;const F=m?h.evaluate(L,{},a,i.availableImages):void 0,O={id:C,properties:v.properties,type:v.type,sourceLayerIndex:M,index:S,geometry:I?L.geometry:Rn(v),patterns:{},sortKey:F};g.push(O)}m&&g.sort((v,C)=>v.sortKey-C.sortKey);for(const v of g){const{geometry:C,index:S,sourceLayerIndex:M}=v;if(this.hasPattern){const I=xf("fill",this.layers,v,this.zoom,i);this.patternFeatures.push(I)}else this.addFeature(v,C,S,a,{},i.subdivisionGranularity);i.featureIndex.insert(t[S].feature,C,S,M,this.index)}}update(t,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,a)}addFeatures(t,i,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,i,a,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Av),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,i,a,h,m,g){for(const v of Ea(i,500)){const C=zm(v,h,g.fill.getGranularityForZoomLevel(h.z)),S=this.layoutVertexArray;Dm((M,I)=>{S.emplaceBack(M,I)},this.segments,this.layoutVertexArray,this.indexArray,C.verticesFlattened,C.indicesTriangles,this.segments2,this.indexArray2,C.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,m,h)}}let Rm,Lm;ct("FillBucket",Tf,{omit:["layers","patternFeatures"]});var Uv={get paint(){return Lm=Lm||new Bo({"fill-antialias":new vt(A.paint_fill["fill-antialias"]),"fill-opacity":new Mt(A.paint_fill["fill-opacity"]),"fill-color":new Mt(A.paint_fill["fill-color"]),"fill-outline-color":new Mt(A.paint_fill["fill-outline-color"]),"fill-translate":new vt(A.paint_fill["fill-translate"]),"fill-translate-anchor":new vt(A.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ks(A.paint_fill["fill-pattern"])})},get layout(){return Rm=Rm||new Bo({"fill-sort-key":new Mt(A.layout_fill["fill-sort-key"])})}};class Zv extends Ai{constructor(t){super(t,Uv)}recalculate(t,i){super.recalculate(t,i);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Tf(t)}queryRadius(){return Dh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:i,transform:a,pixelsToTileUnits:h}){return cl(Rh(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-a.bearingInRadians,h),i)}isTileClipped(){return!0}}const Gv=$r([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),qv=$r([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Wv}=Gv;var Sf,Bm,kf,Fm,Pf,Om,$m,Oh={};function jm(){if(Bm)return Sf;Bm=1;var o=H();function t(h,m,g,v,C){this.properties={},this.extent=g,this.type=0,this._pbf=h,this._geometry=-1,this._keys=v,this._values=C,h.readFields(i,this,m)}function i(h,m,g){h==1?m.id=g.readVarint():h==2?function(v,C){for(var S=v.readVarint()+v.pos;v.pos<S;){var M=C._keys[v.readVarint()],I=C._values[v.readVarint()];C.properties[M]=I}}(g,m):h==3?m.type=g.readVarint():h==4&&(m._geometry=g.pos)}function a(h){for(var m,g,v=0,C=0,S=h.length,M=S-1;C<S;M=C++)v+=((g=h[M]).x-(m=h[C]).x)*(m.y+g.y);return v}return Sf=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var h=this._pbf;h.pos=this._geometry;for(var m,g=h.readVarint()+h.pos,v=1,C=0,S=0,M=0,I=[];h.pos<g;){if(C<=0){var L=h.readVarint();v=7&L,C=L>>3}if(C--,v===1||v===2)S+=h.readSVarint(),M+=h.readSVarint(),v===1&&(m&&I.push(m),m=[]),m.push(new o(S,M));else{if(v!==7)throw new Error("unknown command "+v);m&&m.push(m[0].clone())}}return m&&I.push(m),I},t.prototype.bbox=function(){var h=this._pbf;h.pos=this._geometry;for(var m=h.readVarint()+h.pos,g=1,v=0,C=0,S=0,M=1/0,I=-1/0,L=1/0,F=-1/0;h.pos<m;){if(v<=0){var O=h.readVarint();g=7&O,v=O>>3}if(v--,g===1||g===2)(C+=h.readSVarint())<M&&(M=C),C>I&&(I=C),(S+=h.readSVarint())<L&&(L=S),S>F&&(F=S);else if(g!==7)throw new Error("unknown command "+g)}return[M,L,I,F]},t.prototype.toGeoJSON=function(h,m,g){var v,C,S=this.extent*Math.pow(2,g),M=this.extent*h,I=this.extent*m,L=this.loadGeometry(),F=t.types[this.type];function O(ee){for(var de=0;de<ee.length;de++){var oe=ee[de];ee[de]=[360*(oe.x+M)/S-180,360/Math.PI*Math.atan(Math.exp((180-360*(oe.y+I)/S)*Math.PI/180))-90]}}switch(this.type){case 1:var j=[];for(v=0;v<L.length;v++)j[v]=L[v][0];O(L=j);break;case 2:for(v=0;v<L.length;v++)O(L[v]);break;case 3:for(L=function(ee){var de=ee.length;if(de<=1)return[ee];for(var oe,B,q=[],ie=0;ie<de;ie++){var xe=a(ee[ie]);xe!==0&&(B===void 0&&(B=xe<0),B===xe<0?(oe&&q.push(oe),oe=[ee[ie]]):oe.push(ee[ie]))}return oe&&q.push(oe),q}(L),v=0;v<L.length;v++)for(C=0;C<L[v].length;C++)O(L[v][C])}L.length===1?L=L[0]:F="Multi"+F;var W={type:"Feature",geometry:{type:F,coordinates:L},properties:this.properties};return"id"in this&&(W.id=this.id),W},Sf}function Nm(){if(Fm)return kf;Fm=1;var o=jm();function t(a,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(i,this,h),this.length=this._features.length}function i(a,h,m){a===15?h.version=m.readVarint():a===1?h.name=m.readString():a===5?h.extent=m.readVarint():a===2?h._features.push(m.pos):a===3?h._keys.push(m.readString()):a===4&&h._values.push(function(g){for(var v=null,C=g.readVarint()+g.pos;g.pos<C;){var S=g.readVarint()>>3;v=S===1?g.readString():S===2?g.readFloat():S===3?g.readDouble():S===4?g.readVarint64():S===5?g.readVarint():S===6?g.readSVarint():S===7?g.readBoolean():null}return v}(m))}return kf=t,t.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var h=this._pbf.readVarint()+this._pbf.pos;return new o(this._pbf,h,this.extent,this._keys,this._values)},kf}function Vm(){return $m||($m=1,Oh.VectorTile=function(){if(Om)return Pf;Om=1;var o=Nm();function t(i,a,h){if(i===3){var m=new o(h,h.readVarint()+h.pos);m.length&&(a[m.name]=m)}}return Pf=function(i,a){this.layers=i.readFields(t,{},a)},Pf}(),Oh.VectorTileFeature=jm(),Oh.VectorTileLayer=Nm()),Oh}var Zc=z(Vm());const Hv=Zc.VectorTileFeature.types,Mf=Math.pow(2,13);function Gc(o,t,i,a,h,m,g,v){o.emplaceBack(t,i,2*Math.floor(a*Mf)+g,h*Mf*2,m*Mf*2,Math.round(v))}class If{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new le,this.centroidVertexArray=new J,this.indexArray=new Ke,this.programConfigurations=new Dn(t.layers,t.zoom),this.segments=new xt,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,a){this.features=[],this.hasPattern=bf("fill-extrusion",this.layers,i);for(const{feature:h,id:m,index:g,sourceLayerIndex:v}of t){const C=this.layers[0]._featureFilter.needGeometry,S=Ho(h,C);if(!this.layers[0]._featureFilter.filter(new wr(this.zoom),S,a))continue;const M={id:m,sourceLayerIndex:v,index:g,geometry:C?S.geometry:Rn(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(xf("fill-extrusion",this.layers,M,this.zoom,i)):this.addFeature(M,M.geometry,g,a,{},i.subdivisionGranularity),i.featureIndex.insert(h,M.geometry,g,v,this.index,!0)}}addFeatures(t,i,a){for(const h of this.features){const{geometry:m}=h;this.addFeature(h,m,h.index,i,a,t.subdivisionGranularity)}}update(t,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Wv),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,qv.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,i,a,h,m,g){for(const v of Ea(i,500)){const C={x:0,y:0,sampleCount:0},S=this.layoutVertexArray.length;this.processPolygon(C,h,t,v,g);const M=this.layoutVertexArray.length-S,I=Math.floor(C.x/C.sampleCount),L=Math.floor(C.y/C.sampleCount);for(let F=0;F<M;F++)this.centroidVertexArray.emplaceBack(I,L)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,m,h)}processPolygon(t,i,a,h,m){if(h.length<1||Um(h[0]))return;for(const I of h)I.length!==0&&Xv(t,I);const g={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},v=m.fill.getGranularityForZoomLevel(i.z),C=Hv[a.type]==="Polygon";for(const I of h){if(I.length===0||Um(I))continue;const L=ta(I,v,C);this._generateSideFaces(L,g)}if(!C)return;const S=zm(h,i,v,!1),M=this.layoutVertexArray;Dm((I,L)=>{Gc(M,I,L,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,S.verticesFlattened,S.indicesTriangles)}_generateSideFaces(t,i){let a=0;for(let h=1;h<t.length;h++){const m=t[h],g=t[h-1];if(Yv(m,g))continue;i.segment.vertexLength+4>xt.MAX_VERTEX_ARRAY_LENGTH&&(i.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const v=m.sub(g)._perp()._unit(),C=g.dist(m);a+C>32768&&(a=0),Gc(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,0,a),Gc(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,1,a),a+=C,Gc(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,0,a),Gc(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,1,a);const S=i.segment.vertexLength;this.indexArray.emplaceBack(S,S+2,S+1),this.indexArray.emplaceBack(S+1,S+2,S+3),i.segment.vertexLength+=4,i.segment.primitiveLength+=2}}}function Xv(o,t){for(let i=0;i<t.length;i++){const a=t[i];i===t.length-1&&t[0].x===a.x&&t[0].y===a.y||(o.x+=a.x,o.y+=a.y,o.sampleCount++)}}function Yv(o,t){return o.x===t.x&&(o.x<0||o.x>ft)||o.y===t.y&&(o.y<0||o.y>ft)}function Um(o){return o.every(t=>t.x<0)||o.every(t=>t.x>ft)||o.every(t=>t.y<0)||o.every(t=>t.y>ft)}let Zm;ct("FillExtrusionBucket",If,{omit:["layers","features"]});var Kv={get paint(){return Zm=Zm||new Bo({"fill-extrusion-opacity":new vt(A["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Mt(A["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new vt(A["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new vt(A["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ks(A["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Mt(A["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Mt(A["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new vt(A["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Jv extends Ai{constructor(t){super(t,Kv)}createBucket(t){return new If(t)}queryRadius(){return Dh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:i,featureState:a,geometry:h,transform:m,pixelsToTileUnits:g,pixelPosMatrix:v}){const C=Rh(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-m.bearingInRadians,g),S=this.paint.get("fill-extrusion-height").evaluate(i,a),M=this.paint.get("fill-extrusion-base").evaluate(i,a),I=function(F,O,j){const W=[];for(const ee of F){const de=[ee.x,ee.y,0,1];De(de,de,O),W.push(new se(de[0]/de[3],de[1]/de[3]))}return W}(C,v),L=function(F,O,j,W){const ee=[],de=[],oe=W[8]*O,B=W[9]*O,q=W[10]*O,ie=W[11]*O,xe=W[8]*j,Oe=W[9]*j,Se=W[10]*j,Ie=W[11]*j;for(const Ze of F){const je=[],We=[];for(const Le of Ze){const ut=Le.x,kt=Le.y,St=W[0]*ut+W[4]*kt+W[12],gt=W[1]*ut+W[5]*kt+W[13],Zt=W[2]*ut+W[6]*kt+W[14],Dr=W[3]*ut+W[7]*kt+W[15],Qr=Zt+q,So=Dr+ie,Ti=St+xe,Yo=gt+Oe,mo=Zt+Se,kr=Dr+Ie,ao=new se((St+oe)/So,(gt+B)/So);ao.z=Qr/So,je.push(ao);const go=new se(Ti/kr,Yo/kr);go.z=mo/kr,We.push(go)}ee.push(je),de.push(We)}return[ee,de]}(h,M,S,v);return function(F,O,j){let W=1/0;cl(j,O)&&(W=Gm(j,O[0]));for(let ee=0;ee<O.length;ee++){const de=O[ee],oe=F[ee];for(let B=0;B<de.length-1;B++){const q=de[B],ie=[q,de[B+1],oe[B+1],oe[B],q];ll(j,ie)&&(W=Math.min(W,Gm(j,ie)))}}return W!==1/0&&W}(L[0],L[1],I)}}function qc(o,t){return o.x*t.x+o.y*t.y}function Gm(o,t){if(o.length===1){let i=0;const a=t[i++];let h;for(;!h||a.equals(h);)if(h=t[i++],!h)return 1/0;for(;i<t.length;i++){const m=t[i],g=o[0],v=h.sub(a),C=m.sub(a),S=g.sub(a),M=qc(v,v),I=qc(v,C),L=qc(C,C),F=qc(S,v),O=qc(S,C),j=M*L-I*I,W=(L*F-I*O)/j,ee=(M*O-I*F)/j,de=a.z*(1-W-ee)+h.z*W+m.z*ee;if(isFinite(de))return de}return 1/0}{let i=1/0;for(const a of t)i=Math.min(i,a.z);return i}}const Qv=$r([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:eb}=Qv,tb=$r([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:rb}=tb,ob=Zc.VectorTileFeature.types,ib=Math.cos(Math.PI/180*37.5),qm=Math.pow(2,14)/.5;class Ef{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new ue,this.layoutVertexArray2=new fe,this.indexArray=new Ke,this.programConfigurations=new Dn(t.layers,t.zoom),this.segments=new xt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,a){this.hasPattern=bf("line",this.layers,i);const h=this.layers[0].layout.get("line-sort-key"),m=!h.isConstant(),g=[];for(const{feature:v,id:C,index:S,sourceLayerIndex:M}of t){const I=this.layers[0]._featureFilter.needGeometry,L=Ho(v,I);if(!this.layers[0]._featureFilter.filter(new wr(this.zoom),L,a))continue;const F=m?h.evaluate(L,{},a):void 0,O={id:C,properties:v.properties,type:v.type,sourceLayerIndex:M,index:S,geometry:I?L.geometry:Rn(v),patterns:{},sortKey:F};g.push(O)}m&&g.sort((v,C)=>v.sortKey-C.sortKey);for(const v of g){const{geometry:C,index:S,sourceLayerIndex:M}=v;if(this.hasPattern){const I=xf("line",this.layers,v,this.zoom,i);this.patternFeatures.push(I)}else this.addFeature(v,C,S,a,{},i.subdivisionGranularity);i.featureIndex.insert(t[S].feature,C,S,M,this.index)}}update(t,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,a)}addFeatures(t,i,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,i,a,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,rb)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,eb),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,i,a,h,m,g){const v=this.layers[0].layout,C=v.get("line-join").evaluate(t,{}),S=v.get("line-cap"),M=v.get("line-miter-limit"),I=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const L of i)this.addLine(L,t,C,S,M,I,h,g);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,m,h)}addLine(t,i,a,h,m,g,v,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=ta(t,v?C.line.getGranularityForZoomLevel(v.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let oe=0;oe<t.length-1;oe++)this.totalDistance+=t[oe].dist(t[oe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S=ob[i.type]==="Polygon";let M=t.length;for(;M>=2&&t[M-1].equals(t[M-2]);)M--;let I=0;for(;I<M-1&&t[I].equals(t[I+1]);)I++;if(M<(S?3:2))return;a==="bevel"&&(m=1.05);const L=this.overscaling<=16?15*ft/(512*this.overscaling):0,F=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let O,j,W,ee,de;this.e1=this.e2=-1,S&&(O=t[M-2],de=t[I].sub(O)._unit()._perp());for(let oe=I;oe<M;oe++){if(W=oe===M-1?S?t[I+1]:void 0:t[oe+1],W&&t[oe].equals(W))continue;de&&(ee=de),O&&(j=O),O=t[oe],de=W?W.sub(O)._unit()._perp():ee,ee=ee||de;let B=ee.add(de);B.x===0&&B.y===0||B._unit();const q=ee.x*de.x+ee.y*de.y,ie=B.x*de.x+B.y*de.y,xe=ie!==0?1/ie:1/0,Oe=2*Math.sqrt(2-2*ie),Se=ie<ib&&j&&W,Ie=ee.x*de.y-ee.y*de.x>0;if(Se&&oe>I){const We=O.dist(j);if(We>2*L){const Le=O.sub(O.sub(j)._mult(L/We)._round());this.updateDistance(j,Le),this.addCurrentVertex(Le,ee,0,0,F),j=Le}}const Ze=j&&W;let je=Ze?a:S?"butt":h;if(Ze&&je==="round"&&(xe<g?je="miter":xe<=2&&(je="fakeround")),je==="miter"&&xe>m&&(je="bevel"),je==="bevel"&&(xe>2&&(je="flipbevel"),xe<m&&(je="miter")),j&&this.updateDistance(j,O),je==="miter")B._mult(xe),this.addCurrentVertex(O,B,0,0,F);else if(je==="flipbevel"){if(xe>100)B=de.mult(-1);else{const We=xe*ee.add(de).mag()/ee.sub(de).mag();B._perp()._mult(We*(Ie?-1:1))}this.addCurrentVertex(O,B,0,0,F),this.addCurrentVertex(O,B.mult(-1),0,0,F)}else if(je==="bevel"||je==="fakeround"){const We=-Math.sqrt(xe*xe-1),Le=Ie?We:0,ut=Ie?0:We;if(j&&this.addCurrentVertex(O,ee,Le,ut,F),je==="fakeround"){const kt=Math.round(180*Oe/Math.PI/20);for(let St=1;St<kt;St++){let gt=St/kt;if(gt!==.5){const Dr=gt-.5;gt+=gt*Dr*(gt-1)*((1.0904+q*(q*(3.55645-1.43519*q)-3.2452))*Dr*Dr+(.848013+q*(.215638*q-1.06021)))}const Zt=de.sub(ee)._mult(gt)._add(ee)._unit()._mult(Ie?-1:1);this.addHalfVertex(O,Zt.x,Zt.y,!1,Ie,0,F)}}W&&this.addCurrentVertex(O,de,-Le,-ut,F)}else if(je==="butt")this.addCurrentVertex(O,B,0,0,F);else if(je==="square"){const We=j?1:-1;this.addCurrentVertex(O,B,We,We,F)}else je==="round"&&(j&&(this.addCurrentVertex(O,ee,0,0,F),this.addCurrentVertex(O,ee,1,1,F,!0)),W&&(this.addCurrentVertex(O,de,-1,-1,F,!0),this.addCurrentVertex(O,de,0,0,F)));if(Se&&oe<M-1){const We=O.dist(W);if(We>2*L){const Le=O.add(W.sub(O)._mult(L/We)._round());this.updateDistance(O,Le),this.addCurrentVertex(Le,de,0,0,F),O=Le}}}}addCurrentVertex(t,i,a,h,m,g=!1){const v=i.y*h-i.x,C=-i.y-i.x*h;this.addHalfVertex(t,i.x+i.y*a,i.y-i.x*a,g,!1,a,m),this.addHalfVertex(t,v,C,g,!0,-h,m),this.distance>qm/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,i,a,h,m,g))}addHalfVertex({x:t,y:i},a,h,m,g,v,C){const S=.5*(this.lineClips?this.scaledDistance*(qm-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(i<<1)+(g?1:0),Math.round(63*a)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&S)<<2,S>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const M=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,M,this.e2),C.primitiveLength++),g?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,i){this.distance+=t.dist(i),this.updateScaledDistance()}}let Wm,Hm;ct("LineBucket",Ef,{omit:["layers","patternFeatures"]});var Xm={get paint(){return Hm=Hm||new Bo({"line-opacity":new Mt(A.paint_line["line-opacity"]),"line-color":new Mt(A.paint_line["line-color"]),"line-translate":new vt(A.paint_line["line-translate"]),"line-translate-anchor":new vt(A.paint_line["line-translate-anchor"]),"line-width":new Mt(A.paint_line["line-width"]),"line-gap-width":new Mt(A.paint_line["line-gap-width"]),"line-offset":new Mt(A.paint_line["line-offset"]),"line-blur":new Mt(A.paint_line["line-blur"]),"line-dasharray":new Qa(A.paint_line["line-dasharray"]),"line-pattern":new Ks(A.paint_line["line-pattern"]),"line-gradient":new Ic(A.paint_line["line-gradient"])})},get layout(){return Wm=Wm||new Bo({"line-cap":new vt(A.layout_line["line-cap"]),"line-join":new Mt(A.layout_line["line-join"]),"line-miter-limit":new vt(A.layout_line["line-miter-limit"]),"line-round-limit":new vt(A.layout_line["line-round-limit"]),"line-sort-key":new Mt(A.layout_line["line-sort-key"])})}};class nb extends Mt{possiblyEvaluate(t,i){return i=new wr(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(t,i)}evaluate(t,i,a,h){return i=br({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(t,i,a,h)}}let $h;class sb extends Ai{constructor(t){super(t,Xm),this.gradientVersion=0,$h||($h=new nb(Xm.paint.properties["line-width"].specification),$h.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const i=this.gradientExpression();this.stepInterpolant=!!function(a){return a._styleExpression!==void 0}(i)&&i._styleExpression.expression instanceof Jn,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,i){super.recalculate(t,i),this.paint._values["line-floorwidth"]=$h.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Ef(t)}queryRadius(t){const i=t,a=Ym(Bc("line-width",this,i),Bc("line-gap-width",this,i)),h=Bc("line-offset",this,i);return a/2+Math.abs(h)+Dh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:i,featureState:a,geometry:h,transform:m,pixelsToTileUnits:g}){const v=Rh(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-m.bearingInRadians,g),C=g/2*Ym(this.paint.get("line-width").evaluate(i,a),this.paint.get("line-gap-width").evaluate(i,a)),S=this.paint.get("line-offset").evaluate(i,a);return S&&(h=function(M,I){const L=[];for(let F=0;F<M.length;F++){const O=M[F],j=[];for(let W=0;W<O.length;W++){const ee=O[W-1],de=O[W],oe=O[W+1],B=W===0?new se(0,0):de.sub(ee)._unit()._perp(),q=W===O.length-1?new se(0,0):oe.sub(de)._unit()._perp(),ie=B._add(q)._unit(),xe=ie.x*q.x+ie.y*q.y;xe!==0&&ie._mult(1/xe),j.push(ie._mult(I)._add(de))}L.push(j)}return L}(h,S*g)),function(M,I,L){for(let F=0;F<I.length;F++){const O=I[F];if(M.length>=3){for(let j=0;j<O.length;j++)if(ul(M,O[j]))return!0}if(xv(M,O,L))return!0}return!1}(v,h,C)}isTileClipped(){return!0}}function Ym(o,t){return t>0?t+2*o:o}const ab=$r([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),lb=$r([{name:"a_projected_pos",components:3,type:"Float32"}],4);$r([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const cb=$r([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);$r([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Km=$r([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ub=$r([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function hb(o,t,i){return o.sections.forEach(a=>{a.text=function(h,m,g){const v=m.layout.get("text-transform").evaluate(g,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),nn.applyArabicShaping&&(h=nn.applyArabicShaping(h)),h}(a.text,t,i)}),o}$r([{name:"triangle",components:3,type:"Uint16"}]),$r([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),$r([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),$r([{type:"Float32",name:"offsetX"}]),$r([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),$r([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Wc={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Jm,Af,Qm,Jr=24,zf={};function db(){return Jm||(Jm=1,zf.read=function(o,t,i,a,h){var m,g,v=8*h-a-1,C=(1<<v)-1,S=C>>1,M=-7,I=i?h-1:0,L=i?-1:1,F=o[t+I];for(I+=L,m=F&(1<<-M)-1,F>>=-M,M+=v;M>0;m=256*m+o[t+I],I+=L,M-=8);for(g=m&(1<<-M)-1,m>>=-M,M+=a;M>0;g=256*g+o[t+I],I+=L,M-=8);if(m===0)m=1-S;else{if(m===C)return g?NaN:1/0*(F?-1:1);g+=Math.pow(2,a),m-=S}return(F?-1:1)*g*Math.pow(2,m-a)},zf.write=function(o,t,i,a,h,m){var g,v,C,S=8*m-h-1,M=(1<<S)-1,I=M>>1,L=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=a?0:m-1,O=a?1:-1,j=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,g=M):(g=Math.floor(Math.log(t)/Math.LN2),t*(C=Math.pow(2,-g))<1&&(g--,C*=2),(t+=g+I>=1?L/C:L*Math.pow(2,1-I))*C>=2&&(g++,C/=2),g+I>=M?(v=0,g=M):g+I>=1?(v=(t*C-1)*Math.pow(2,h),g+=I):(v=t*Math.pow(2,I-1)*Math.pow(2,h),g=0));h>=8;o[i+F]=255&v,F+=O,v/=256,h-=8);for(g=g<<h|v,S+=h;S>0;o[i+F]=255&g,F+=O,g/=256,S-=8);o[i+F-O]|=128*j}),zf}function eg(){if(Qm)return Af;Qm=1,Af=t;var o=db();function t(B){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(B)?B:new Uint8Array(B||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var i=4294967296,a=1/i,h=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function m(B){return B.type===t.Bytes?B.readVarint()+B.pos:B.pos+1}function g(B,q,ie){return ie?4294967296*q+(B>>>0):4294967296*(q>>>0)+(B>>>0)}function v(B,q,ie){var xe=q<=16383?1:q<=2097151?2:q<=268435455?3:Math.floor(Math.log(q)/(7*Math.LN2));ie.realloc(xe);for(var Oe=ie.pos-1;Oe>=B;Oe--)ie.buf[Oe+xe]=ie.buf[Oe]}function C(B,q){for(var ie=0;ie<B.length;ie++)q.writeVarint(B[ie])}function S(B,q){for(var ie=0;ie<B.length;ie++)q.writeSVarint(B[ie])}function M(B,q){for(var ie=0;ie<B.length;ie++)q.writeFloat(B[ie])}function I(B,q){for(var ie=0;ie<B.length;ie++)q.writeDouble(B[ie])}function L(B,q){for(var ie=0;ie<B.length;ie++)q.writeBoolean(B[ie])}function F(B,q){for(var ie=0;ie<B.length;ie++)q.writeFixed32(B[ie])}function O(B,q){for(var ie=0;ie<B.length;ie++)q.writeSFixed32(B[ie])}function j(B,q){for(var ie=0;ie<B.length;ie++)q.writeFixed64(B[ie])}function W(B,q){for(var ie=0;ie<B.length;ie++)q.writeSFixed64(B[ie])}function ee(B,q){return(B[q]|B[q+1]<<8|B[q+2]<<16)+16777216*B[q+3]}function de(B,q,ie){B[ie]=q,B[ie+1]=q>>>8,B[ie+2]=q>>>16,B[ie+3]=q>>>24}function oe(B,q){return(B[q]|B[q+1]<<8|B[q+2]<<16)+(B[q+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(B,q,ie){for(ie=ie||this.length;this.pos<ie;){var xe=this.readVarint(),Oe=xe>>3,Se=this.pos;this.type=7&xe,B(Oe,q,this),this.pos===Se&&this.skip(xe)}return q},readMessage:function(B,q){return this.readFields(B,q,this.readVarint()+this.pos)},readFixed32:function(){var B=ee(this.buf,this.pos);return this.pos+=4,B},readSFixed32:function(){var B=oe(this.buf,this.pos);return this.pos+=4,B},readFixed64:function(){var B=ee(this.buf,this.pos)+ee(this.buf,this.pos+4)*i;return this.pos+=8,B},readSFixed64:function(){var B=ee(this.buf,this.pos)+oe(this.buf,this.pos+4)*i;return this.pos+=8,B},readFloat:function(){var B=o.read(this.buf,this.pos,!0,23,4);return this.pos+=4,B},readDouble:function(){var B=o.read(this.buf,this.pos,!0,52,8);return this.pos+=8,B},readVarint:function(B){var q,ie,xe=this.buf;return q=127&(ie=xe[this.pos++]),ie<128?q:(q|=(127&(ie=xe[this.pos++]))<<7,ie<128?q:(q|=(127&(ie=xe[this.pos++]))<<14,ie<128?q:(q|=(127&(ie=xe[this.pos++]))<<21,ie<128?q:function(Oe,Se,Ie){var Ze,je,We=Ie.buf;if(Ze=(112&(je=We[Ie.pos++]))>>4,je<128||(Ze|=(127&(je=We[Ie.pos++]))<<3,je<128)||(Ze|=(127&(je=We[Ie.pos++]))<<10,je<128)||(Ze|=(127&(je=We[Ie.pos++]))<<17,je<128)||(Ze|=(127&(je=We[Ie.pos++]))<<24,je<128)||(Ze|=(1&(je=We[Ie.pos++]))<<31,je<128))return g(Oe,Ze,Se);throw new Error("Expected varint not more than 10 bytes")}(q|=(15&(ie=xe[this.pos]))<<28,B,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var B=this.readVarint();return B%2==1?(B+1)/-2:B/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var B=this.readVarint()+this.pos,q=this.pos;return this.pos=B,B-q>=12&&h?function(ie,xe,Oe){return h.decode(ie.subarray(xe,Oe))}(this.buf,q,B):function(ie,xe,Oe){for(var Se="",Ie=xe;Ie<Oe;){var Ze,je,We,Le=ie[Ie],ut=null,kt=Le>239?4:Le>223?3:Le>191?2:1;if(Ie+kt>Oe)break;kt===1?Le<128&&(ut=Le):kt===2?(192&(Ze=ie[Ie+1]))==128&&(ut=(31&Le)<<6|63&Ze)<=127&&(ut=null):kt===3?(je=ie[Ie+2],(192&(Ze=ie[Ie+1]))==128&&(192&je)==128&&((ut=(15&Le)<<12|(63&Ze)<<6|63&je)<=2047||ut>=55296&&ut<=57343)&&(ut=null)):kt===4&&(je=ie[Ie+2],We=ie[Ie+3],(192&(Ze=ie[Ie+1]))==128&&(192&je)==128&&(192&We)==128&&((ut=(15&Le)<<18|(63&Ze)<<12|(63&je)<<6|63&We)<=65535||ut>=1114112)&&(ut=null)),ut===null?(ut=65533,kt=1):ut>65535&&(ut-=65536,Se+=String.fromCharCode(ut>>>10&1023|55296),ut=56320|1023&ut),Se+=String.fromCharCode(ut),Ie+=kt}return Se}(this.buf,q,B)},readBytes:function(){var B=this.readVarint()+this.pos,q=this.buf.subarray(this.pos,B);return this.pos=B,q},readPackedVarint:function(B,q){if(this.type!==t.Bytes)return B.push(this.readVarint(q));var ie=m(this);for(B=B||[];this.pos<ie;)B.push(this.readVarint(q));return B},readPackedSVarint:function(B){if(this.type!==t.Bytes)return B.push(this.readSVarint());var q=m(this);for(B=B||[];this.pos<q;)B.push(this.readSVarint());return B},readPackedBoolean:function(B){if(this.type!==t.Bytes)return B.push(this.readBoolean());var q=m(this);for(B=B||[];this.pos<q;)B.push(this.readBoolean());return B},readPackedFloat:function(B){if(this.type!==t.Bytes)return B.push(this.readFloat());var q=m(this);for(B=B||[];this.pos<q;)B.push(this.readFloat());return B},readPackedDouble:function(B){if(this.type!==t.Bytes)return B.push(this.readDouble());var q=m(this);for(B=B||[];this.pos<q;)B.push(this.readDouble());return B},readPackedFixed32:function(B){if(this.type!==t.Bytes)return B.push(this.readFixed32());var q=m(this);for(B=B||[];this.pos<q;)B.push(this.readFixed32());return B},readPackedSFixed32:function(B){if(this.type!==t.Bytes)return B.push(this.readSFixed32());var q=m(this);for(B=B||[];this.pos<q;)B.push(this.readSFixed32());return B},readPackedFixed64:function(B){if(this.type!==t.Bytes)return B.push(this.readFixed64());var q=m(this);for(B=B||[];this.pos<q;)B.push(this.readFixed64());return B},readPackedSFixed64:function(B){if(this.type!==t.Bytes)return B.push(this.readSFixed64());var q=m(this);for(B=B||[];this.pos<q;)B.push(this.readSFixed64());return B},skip:function(B){var q=7&B;if(q===t.Varint)for(;this.buf[this.pos++]>127;);else if(q===t.Bytes)this.pos=this.readVarint()+this.pos;else if(q===t.Fixed32)this.pos+=4;else{if(q!==t.Fixed64)throw new Error("Unimplemented type: "+q);this.pos+=8}},writeTag:function(B,q){this.writeVarint(B<<3|q)},realloc:function(B){for(var q=this.length||16;q<this.pos+B;)q*=2;if(q!==this.length){var ie=new Uint8Array(q);ie.set(this.buf),this.buf=ie,this.length=q}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(B){this.realloc(4),de(this.buf,B,this.pos),this.pos+=4},writeSFixed32:function(B){this.realloc(4),de(this.buf,B,this.pos),this.pos+=4},writeFixed64:function(B){this.realloc(8),de(this.buf,-1&B,this.pos),de(this.buf,Math.floor(B*a),this.pos+4),this.pos+=8},writeSFixed64:function(B){this.realloc(8),de(this.buf,-1&B,this.pos),de(this.buf,Math.floor(B*a),this.pos+4),this.pos+=8},writeVarint:function(B){(B=+B||0)>268435455||B<0?function(q,ie){var xe,Oe;if(q>=0?(xe=q%4294967296|0,Oe=q/4294967296|0):(Oe=~(-q/4294967296),4294967295^(xe=~(-q%4294967296))?xe=xe+1|0:(xe=0,Oe=Oe+1|0)),q>=18446744073709552e3||q<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ie.realloc(10),function(Se,Ie,Ze){Ze.buf[Ze.pos++]=127&Se|128,Se>>>=7,Ze.buf[Ze.pos++]=127&Se|128,Se>>>=7,Ze.buf[Ze.pos++]=127&Se|128,Se>>>=7,Ze.buf[Ze.pos++]=127&Se|128,Ze.buf[Ze.pos]=127&(Se>>>=7)}(xe,0,ie),function(Se,Ie){var Ze=(7&Se)<<4;Ie.buf[Ie.pos++]|=Ze|((Se>>>=3)?128:0),Se&&(Ie.buf[Ie.pos++]=127&Se|((Se>>>=7)?128:0),Se&&(Ie.buf[Ie.pos++]=127&Se|((Se>>>=7)?128:0),Se&&(Ie.buf[Ie.pos++]=127&Se|((Se>>>=7)?128:0),Se&&(Ie.buf[Ie.pos++]=127&Se|((Se>>>=7)?128:0),Se&&(Ie.buf[Ie.pos++]=127&Se)))))}(Oe,ie)}(B,this):(this.realloc(4),this.buf[this.pos++]=127&B|(B>127?128:0),B<=127||(this.buf[this.pos++]=127&(B>>>=7)|(B>127?128:0),B<=127||(this.buf[this.pos++]=127&(B>>>=7)|(B>127?128:0),B<=127||(this.buf[this.pos++]=B>>>7&127))))},writeSVarint:function(B){this.writeVarint(B<0?2*-B-1:2*B)},writeBoolean:function(B){this.writeVarint(!!B)},writeString:function(B){B=String(B),this.realloc(4*B.length),this.pos++;var q=this.pos;this.pos=function(xe,Oe,Se){for(var Ie,Ze,je=0;je<Oe.length;je++){if((Ie=Oe.charCodeAt(je))>55295&&Ie<57344){if(!Ze){Ie>56319||je+1===Oe.length?(xe[Se++]=239,xe[Se++]=191,xe[Se++]=189):Ze=Ie;continue}if(Ie<56320){xe[Se++]=239,xe[Se++]=191,xe[Se++]=189,Ze=Ie;continue}Ie=Ze-55296<<10|Ie-56320|65536,Ze=null}else Ze&&(xe[Se++]=239,xe[Se++]=191,xe[Se++]=189,Ze=null);Ie<128?xe[Se++]=Ie:(Ie<2048?xe[Se++]=Ie>>6|192:(Ie<65536?xe[Se++]=Ie>>12|224:(xe[Se++]=Ie>>18|240,xe[Se++]=Ie>>12&63|128),xe[Se++]=Ie>>6&63|128),xe[Se++]=63&Ie|128)}return Se}(this.buf,B,this.pos);var ie=this.pos-q;ie>=128&&v(q,ie,this),this.pos=q-1,this.writeVarint(ie),this.pos+=ie},writeFloat:function(B){this.realloc(4),o.write(this.buf,B,this.pos,!0,23,4),this.pos+=4},writeDouble:function(B){this.realloc(8),o.write(this.buf,B,this.pos,!0,52,8),this.pos+=8},writeBytes:function(B){var q=B.length;this.writeVarint(q),this.realloc(q);for(var ie=0;ie<q;ie++)this.buf[this.pos++]=B[ie]},writeRawMessage:function(B,q){this.pos++;var ie=this.pos;B(q,this);var xe=this.pos-ie;xe>=128&&v(ie,xe,this),this.pos=ie-1,this.writeVarint(xe),this.pos+=xe},writeMessage:function(B,q,ie){this.writeTag(B,t.Bytes),this.writeRawMessage(q,ie)},writePackedVarint:function(B,q){q.length&&this.writeMessage(B,C,q)},writePackedSVarint:function(B,q){q.length&&this.writeMessage(B,S,q)},writePackedBoolean:function(B,q){q.length&&this.writeMessage(B,L,q)},writePackedFloat:function(B,q){q.length&&this.writeMessage(B,M,q)},writePackedDouble:function(B,q){q.length&&this.writeMessage(B,I,q)},writePackedFixed32:function(B,q){q.length&&this.writeMessage(B,F,q)},writePackedSFixed32:function(B,q){q.length&&this.writeMessage(B,O,q)},writePackedFixed64:function(B,q){q.length&&this.writeMessage(B,j,q)},writePackedSFixed64:function(B,q){q.length&&this.writeMessage(B,W,q)},writeBytesField:function(B,q){this.writeTag(B,t.Bytes),this.writeBytes(q)},writeFixed32Field:function(B,q){this.writeTag(B,t.Fixed32),this.writeFixed32(q)},writeSFixed32Field:function(B,q){this.writeTag(B,t.Fixed32),this.writeSFixed32(q)},writeFixed64Field:function(B,q){this.writeTag(B,t.Fixed64),this.writeFixed64(q)},writeSFixed64Field:function(B,q){this.writeTag(B,t.Fixed64),this.writeSFixed64(q)},writeVarintField:function(B,q){this.writeTag(B,t.Varint),this.writeVarint(q)},writeSVarintField:function(B,q){this.writeTag(B,t.Varint),this.writeSVarint(q)},writeStringField:function(B,q){this.writeTag(B,t.Bytes),this.writeString(q)},writeFloatField:function(B,q){this.writeTag(B,t.Fixed32),this.writeFloat(q)},writeDoubleField:function(B,q){this.writeTag(B,t.Fixed64),this.writeDouble(q)},writeBooleanField:function(B,q){this.writeVarintField(B,!!q)}},Af}var Df=z(eg());const Rf=3;function fb(o,t,i){o===1&&i.readMessage(pb,t)}function pb(o,t,i){if(o===3){const{id:a,bitmap:h,width:m,height:g,left:v,top:C,advance:S}=i.readMessage(mb,{});t.push({id:a,bitmap:new Fc({width:m+2*Rf,height:g+2*Rf},h),metrics:{width:m,height:g,left:v,top:C,advance:S}})}}function mb(o,t,i){o===1?t.id=i.readVarint():o===2?t.bitmap=i.readBytes():o===3?t.width=i.readVarint():o===4?t.height=i.readVarint():o===5?t.left=i.readSVarint():o===6?t.top=i.readSVarint():o===7&&(t.advance=i.readVarint())}const gb=Rf;function tg(o){let t=0,i=0;for(const g of o)t+=g.w*g.h,i=Math.max(i,g.w);o.sort((g,v)=>v.h-g.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let h=0,m=0;for(const g of o)for(let v=a.length-1;v>=0;v--){const C=a[v];if(!(g.w>C.w||g.h>C.h)){if(g.x=C.x,g.y=C.y,m=Math.max(m,g.y+g.h),h=Math.max(h,g.x+g.w),g.w===C.w&&g.h===C.h){const S=a.pop();v<a.length&&(a[v]=S)}else g.h===C.h?(C.x+=g.w,C.w-=g.w):g.w===C.w?(C.y+=g.h,C.h-=g.h):(a.push({x:C.x+g.w,y:C.y,w:C.w-g.w,h:g.h}),C.y+=g.h,C.h-=g.h);break}}return{w:h,h:m,fill:t/(h*m)||0}}const Xo=1;class Lf{constructor(t,{pixelRatio:i,version:a,stretchX:h,stretchY:m,content:g,textFitWidth:v,textFitHeight:C}){this.paddedRect=t,this.pixelRatio=i,this.stretchX=h,this.stretchY=m,this.content=g,this.version=a,this.textFitWidth=v,this.textFitHeight=C}get tl(){return[this.paddedRect.x+Xo,this.paddedRect.y+Xo]}get br(){return[this.paddedRect.x+this.paddedRect.w-Xo,this.paddedRect.y+this.paddedRect.h-Xo]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Xo)/this.pixelRatio,(this.paddedRect.h-2*Xo)/this.pixelRatio]}}class rg{constructor(t,i){const a={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,a,m),this.addImages(i,h,m);const{w:g,h:v}=tg(m),C=new wi({width:g||1,height:v||1});for(const S in t){const M=t[S],I=a[S].paddedRect;wi.copy(M.data,C,{x:0,y:0},{x:I.x+Xo,y:I.y+Xo},M.data)}for(const S in i){const M=i[S],I=h[S].paddedRect,L=I.x+Xo,F=I.y+Xo,O=M.data.width,j=M.data.height;wi.copy(M.data,C,{x:0,y:0},{x:L,y:F},M.data),wi.copy(M.data,C,{x:0,y:j-1},{x:L,y:F-1},{width:O,height:1}),wi.copy(M.data,C,{x:0,y:0},{x:L,y:F+j},{width:O,height:1}),wi.copy(M.data,C,{x:O-1,y:0},{x:L-1,y:F},{width:1,height:j}),wi.copy(M.data,C,{x:0,y:0},{x:L+O,y:F},{width:1,height:j})}this.image=C,this.iconPositions=a,this.patternPositions=h}addImages(t,i,a){for(const h in t){const m=t[h],g={x:0,y:0,w:m.data.width+2*Xo,h:m.data.height+2*Xo};a.push(g),i[h]=new Lf(g,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,i){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in t.updatedImages)this.patchUpdatedImage(this.iconPositions[a],t.getImage(a),i),this.patchUpdatedImage(this.patternPositions[a],t.getImage(a),i)}patchUpdatedImage(t,i,a){if(!t||!i||t.version===i.version)return;t.version=i.version;const[h,m]=t.tl;a.update(i.data,void 0,{x:h,y:m})}}var ds;ct("ImagePosition",Lf),ct("ImageAtlas",rg),b.ag=void 0,(ds=b.ag||(b.ag={}))[ds.none=0]="none",ds[ds.horizontal=1]="horizontal",ds[ds.vertical=2]="vertical",ds[ds.horizontalOnly=3]="horizontalOnly";const jh=-17;class Hc{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,i,a){const h=new Hc;return h.scale=t||1,h.fontStack=i,h.verticalAlign=a||"bottom",h}static forImage(t,i){const a=new Hc;return a.imageName=t,a.verticalAlign=i||"bottom",a}}class pl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,i){const a=new pl;for(let h=0;h<t.sections.length;h++){const m=t.sections[h];m.image?a.addImageSection(m):a.addTextSection(m,i)}return a}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let i="";for(let a=0;a<t.length;a++){const h=t.charCodeAt(a+1)||null,m=t.charCodeAt(a-1)||null;i+=h&&Sc(h)&&!Wc[t[a+1]]||m&&Sc(m)&&!Wc[t[a-1]]||!Wc[t[a]]?t[a]:Wc[t[a]]}return i}(this.text)}trim(){let t=0;for(let a=0;a<this.text.length&&Vh[this.text.charCodeAt(a)];a++)t++;let i=this.text.length;for(let a=this.text.length-1;a>=0&&a>=t&&Vh[this.text.charCodeAt(a)];a--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)}substring(t,i){const a=new pl;return a.text=this.text.substring(t,i),a.sectionIndex=this.sectionIndex.slice(t,i),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,i)=>Math.max(t,this.sections[i].scale),0)}getMaxImageSize(t){let i=0,a=0;for(let h=0;h<this.length();h++){const m=this.getSection(h);if(m.imageName){const g=t[m.imageName];if(!g)continue;const v=g.displaySize;i=Math.max(i,v[0]),a=Math.max(a,v[1])}}return{maxImageWidth:i,maxImageHeight:a}}addTextSection(t,i){this.text+=t.text,this.sections.push(Hc.forText(t.scale,t.fontStack||i,t.verticalAlign));const a=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(a)}addImageSection(t){const i=t.image?t.image.name:"";if(i.length===0)return void Wr("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(Hc.forImage(i,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Wr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Nh(o,t,i,a,h,m,g,v,C,S,M,I,L,F,O){const j=pl.fromFeature(o,h);let W;I===b.ag.vertical&&j.verticalizePunctuation();const{processBidirectionalText:ee,processStyledBidirectionalText:de}=nn;if(ee&&j.sections.length===1){W=[];const q=ee(j.toString(),Bf(j,S,m,t,a,F));for(const ie of q){const xe=new pl;xe.text=ie,xe.sections=j.sections;for(let Oe=0;Oe<ie.length;Oe++)xe.sectionIndex.push(0);W.push(xe)}}else if(de){W=[];const q=de(j.text,j.sectionIndex,Bf(j,S,m,t,a,F));for(const ie of q){const xe=new pl;xe.text=ie[0],xe.sectionIndex=ie[1],xe.sections=j.sections,W.push(xe)}}else W=function(q,ie){const xe=[],Oe=q.text;let Se=0;for(const Ie of ie)xe.push(q.substring(Se,Ie)),Se=Ie;return Se<Oe.length&&xe.push(q.substring(Se,Oe.length)),xe}(j,Bf(j,S,m,t,a,F));const oe=[],B={positionedLines:oe,text:j.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:I,iconsInText:!1,verticalizable:!1};return function(q,ie,xe,Oe,Se,Ie,Ze,je,We,Le,ut,kt){let St=0,gt=0,Zt=0,Dr=0;const Qr=je==="right"?1:je==="left"?0:.5,So=Jr/kt;let Ti=0;for(const kr of Se){kr.trim();const ao=kr.getMaxScale(),go={positionedGlyphs:[],lineOffset:0};q.positionedLines[Ti]=go;const _o=go.positionedGlyphs;let Fo=0;if(!kr.length()){gt+=Ie,++Ti;continue}const Si=bb(Oe,kr,So);for(let Ko=0;Ko<kr.length();Ko++){const eo=kr.getSection(Ko),co=kr.getSectionIndex(Ko),uo=kr.getCharCode(Ko),Zr=xb(We,ut,uo);let vr;if(eo.imageName){if(q.iconsInText=!0,eo.scale=eo.scale*So,vr=Cb(eo,Zr,ao,Si,Oe),!vr)continue;Fo=Math.max(Fo,vr.imageOffset)}else if(vr=wb(eo,uo,Zr,Si,ie,xe),!vr)continue;const{rect:Zi,metrics:yl,baselineOffset:Gi}=vr;_o.push({glyph:uo,imageName:eo.imageName,x:St,y:gt+Gi+jh,vertical:Zr,scale:eo.scale,fontStack:eo.fontStack,sectionIndex:co,metrics:yl,rect:Zi}),Zr?(q.verticalizable=!0,St+=(eo.imageName?yl.advance:Jr)*eo.scale+Le):St+=yl.advance*eo.scale+Le}_o.length!==0&&(Zt=Math.max(St-Le,Zt),Tb(_o,0,_o.length-1,Qr)),St=0,go.lineOffset=Math.max(Fo,(ao-1)*Jr);const lo=Ie*ao+Fo;gt+=lo,Dr=Math.max(lo,Dr),++Ti}const{horizontalAlign:Yo,verticalAlign:mo}=Ff(Ze);(function(kr,ao,go,_o,Fo,Si,lo,Ko,eo){const co=(ao-go)*Fo;let uo=0;uo=Si!==lo?-Ko*_o-jh:-_o*eo*lo+.5*lo;for(const Zr of kr)for(const vr of Zr.positionedGlyphs)vr.x+=co,vr.y+=uo})(q.positionedLines,Qr,Yo,mo,Zt,Dr,Ie,gt,Se.length),q.top+=-mo*gt,q.bottom=q.top+gt,q.left+=-Yo*Zt,q.right=q.left+Zt}(B,t,i,a,W,g,v,C,I,S,L,O),!function(q){for(const ie of q)if(ie.positionedGlyphs.length!==0)return!1;return!0}(oe)&&B}const Vh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_b={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},yb={40:!0};function og(o,t,i,a,h,m){if(t.imageName){const g=a[t.imageName];return g?g.displaySize[0]*t.scale*Jr/m+h:0}{const g=i[t.fontStack],v=g&&g[o];return v?v.metrics.advance*t.scale+h:0}}function ig(o,t,i,a){const h=Math.pow(o-t,2);return a?o<t?h/2:2*h:h+Math.abs(i)*i}function vb(o,t,i){let a=0;return o===10&&(a-=1e4),i&&(a+=150),o!==40&&o!==65288||(a+=50),t!==41&&t!==65289||(a+=50),a}function ng(o,t,i,a,h,m){let g=null,v=ig(t,i,h,m);for(const C of a){const S=ig(t-C.x,i,h,m)+C.badness;S<=v&&(g=C,v=S)}return{index:o,x:t,priorBreak:g,badness:v}}function sg(o){return o?sg(o.priorBreak).concat(o.index):[]}function Bf(o,t,i,a,h,m){if(!o)return[];const g=[],v=function(I,L,F,O,j,W){let ee=0;for(let de=0;de<I.length();de++){const oe=I.getSection(de);ee+=og(I.getCharCode(de),oe,O,j,L,W)}return ee/Math.max(1,Math.ceil(ee/F))}(o,t,i,a,h,m),C=o.text.indexOf("")>=0;let S=0;for(let I=0;I<o.length();I++){const L=o.getSection(I),F=o.getCharCode(I);if(Vh[F]||(S+=og(F,L,a,h,t,m)),I<o.length()-1){const O=!((M=F)<11904)&&(!!Nt["CJK Compatibility Forms"](M)||!!Nt["CJK Compatibility"](M)||!!Nt["CJK Strokes"](M)||!!Nt["CJK Symbols and Punctuation"](M)||!!Nt["Enclosed CJK Letters and Months"](M)||!!Nt["Halfwidth and Fullwidth Forms"](M)||!!Nt["Ideographic Description Characters"](M)||!!Nt["Vertical Forms"](M)||Cc.test(String.fromCodePoint(M)));(_b[F]||O||L.imageName||I!==o.length()-2&&yb[o.getCharCode(I+1)])&&g.push(ng(I+1,S,v,g,vb(F,o.getCharCode(I+1),O&&C),!1))}}var M;return sg(ng(o.length(),S,v,g,0,!0))}function Ff(o){let t=.5,i=.5;switch(o){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function bb(o,t,i){const a=t.getMaxScale()*Jr,{maxImageWidth:h,maxImageHeight:m}=t.getMaxImageSize(o),g=Math.max(a,m*i);return{verticalLineContentWidth:Math.max(a,h*i),horizontalLineContentHeight:g}}function ag(o){switch(o){case"top":return 0;case"center":return .5;default:return 1}}function xb(o,t,i){return!(o===b.ag.horizontal||!t&&!Tc(i)||t&&(Vh[i]||(a=i,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(a)))));var a}function wb(o,t,i,a,h,m){const g=m[o.fontStack],v=function(S,M,I,L){if(S&&S.rect)return S;const F=M[I.fontStack],O=F&&F[L];return O?{rect:null,metrics:O.metrics}:null}(g&&g[t],h,o,t);if(v===null)return null;let C;if(i)C=a.verticalLineContentWidth-o.scale*Jr;else{const S=ag(o.verticalAlign);C=(a.horizontalLineContentHeight-o.scale*Jr)*S}return{rect:v.rect,metrics:v.metrics,baselineOffset:C}}function Cb(o,t,i,a,h){const m=h[o.imageName];if(!m)return null;const g=m.paddedRect,v=m.displaySize,C={width:v[0],height:v[1],left:Xo,top:-3,advance:t?v[1]:v[0]};let S;if(t)S=a.verticalLineContentWidth-v[1]*o.scale;else{const M=ag(o.verticalAlign);S=(a.horizontalLineContentHeight-v[1]*o.scale)*M}return{rect:g,metrics:C,baselineOffset:S,imageOffset:(t?v[0]:v[1])*o.scale-Jr*i}}function Tb(o,t,i,a){if(a===0)return;const h=o[i],m=(o[i].x+h.metrics.advance*h.scale)*a;for(let g=t;g<=i;g++)o[g].x-=m}function Sb(o,t,i){const{horizontalAlign:a,verticalAlign:h}=Ff(i),m=t[0]-o.displaySize[0]*a,g=t[1]-o.displaySize[1]*h;return{image:o,top:g,bottom:g+o.displaySize[1],left:m,right:m+o.displaySize[0]}}function lg(o){var t,i;let a=o.left,h=o.top,m=o.right-a,g=o.bottom-h;const v=(t=o.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",C=(i=o.image.textFitHeight)!==null&&i!==void 0?i:"stretchOrShrink",S=(o.image.content[2]-o.image.content[0])/(o.image.content[3]-o.image.content[1]);if(C==="proportional"){if(v==="stretchOnly"&&m/g<S||v==="proportional"){const M=Math.ceil(g*S);a*=M/m,m=M}}else if(v==="proportional"&&C==="stretchOnly"&&S!==0&&m/g>S){const M=Math.ceil(m/S);h*=M/g,g=M}return{x1:a,y1:h,x2:a+m,y2:h+g}}function cg(o,t,i,a,h,m){const g=o.image;let v;if(g.content){const W=g.content,ee=g.pixelRatio||1;v=[W[0]/ee,W[1]/ee,g.displaySize[0]-W[2]/ee,g.displaySize[1]-W[3]/ee]}const C=t.left*m,S=t.right*m;let M,I,L,F;i==="width"||i==="both"?(F=h[0]+C-a[3],I=h[0]+S+a[1]):(F=h[0]+(C+S-g.displaySize[0])/2,I=F+g.displaySize[0]);const O=t.top*m,j=t.bottom*m;return i==="height"||i==="both"?(M=h[1]+O-a[0],L=h[1]+j+a[2]):(M=h[1]+(O+j-g.displaySize[1])/2,L=M+g.displaySize[1]),{image:g,top:M,right:I,bottom:L,left:F,collisionPadding:v}}const Xc=255,an=128,fs=Xc*an;function ug(o,t){const{expression:i}=t;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new wr(o+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:h}=i;let m=0;for(;m<a.length&&a[m]<=o;)m++;m=Math.max(0,m-1);let g=m;for(;g<a.length&&a[g]<o+1;)g++;g=Math.min(a.length-1,g);const v=a[m],C=a[g];return i.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:C,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:C,minSize:i.evaluate(new wr(v)),maxSize:i.evaluate(new wr(C)),interpolationType:h}}}function Of(o,t,i){let a="never";const h=o.get(t);return h?a=h:o.get(i)&&(a="always"),a}const kb=Zc.VectorTileFeature.types,Pb=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Uh(o,t,i,a,h,m,g,v,C,S,M,I,L){const F=v?Math.min(fs,Math.round(v[0])):0,O=v?Math.min(fs,Math.round(v[1])):0;o.emplaceBack(t,i,Math.round(32*a),Math.round(32*h),m,g,(F<<1)+(C?1:0),O,16*S,16*M,256*I,256*L)}function $f(o,t,i){o.emplaceBack(t.x,t.y,i),o.emplaceBack(t.x,t.y,i),o.emplaceBack(t.x,t.y,i),o.emplaceBack(t.x,t.y,i)}function Mb(o){for(const t of o.sections)if(kh(t.text))return!0;return!1}class jf{constructor(t){this.layoutVertexArray=new be,this.indexArray=new Ke,this.programConfigurations=t,this.segments=new xt,this.dynamicLayoutVertexArray=new we,this.opacityVertexArray=new Ae,this.hasVisibleVertices=!1,this.placedSymbolArray=new T}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,i,a,h){this.isEmpty()||(a&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ab.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,lb.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Pb,!0),this.opacityVertexBuffer.itemSize=1),(a||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ct("SymbolBuffers",jf);class Nf{constructor(t,i,a){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new a,this.segments=new xt,this.collisionVertexArray=new Ee}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,cb.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ct("CollisionBuffers",Nf);class ml{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(g=>g.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ug(this.zoom,i["text-size"]),this.iconSizeData=ug(this.zoom,i["icon-size"]);const a=this.layers[0].layout,h=a.get("symbol-sort-key"),m=a.get("symbol-z-order");this.canOverlap=Of(a,"text-overlap","text-allow-overlap")!=="never"||Of(a,"icon-overlap","icon-allow-overlap")!=="never"||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(g=>b.ag[g])),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=t.sourceID}createArrays(){this.text=new jf(new Dn(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new jf(new Dn(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new D,this.lineVertexArray=new R,this.symbolInstances=new E,this.textAnchorOffsets=new N}calculateGlyphDependencies(t,i,a,h,m){for(let g=0;g<t.length;g++)if(i[t.charCodeAt(g)]=!0,(a||h)&&m){const v=Wc[t.charAt(g)];v&&(i[v.charCodeAt(0)]=!0)}}populate(t,i,a){const h=this.layers[0],m=h.layout,g=m.get("text-font"),v=m.get("text-field"),C=m.get("icon-image"),S=(v.value.kind!=="constant"||v.value.value instanceof fo&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),M=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,I=m.get("symbol-sort-key");if(this.features=[],!S&&!M)return;const L=i.iconDependencies,F=i.glyphDependencies,O=i.availableImages,j=new wr(this.zoom);for(const{feature:W,id:ee,index:de,sourceLayerIndex:oe}of t){const B=h._featureFilter.needGeometry,q=Ho(W,B);if(!h._featureFilter.filter(j,q,a))continue;let ie,xe;if(B||(q.geometry=Rn(W)),S){const Se=h.getValueAndResolveTokens("text-field",q,a,O),Ie=fo.factory(Se),Ze=this.hasRTLText=this.hasRTLText||Mb(Ie);(!Ze||nn.getRTLTextPluginStatus()==="unavailable"||Ze&&nn.isParsed())&&(ie=hb(Ie,h,q))}if(M){const Se=h.getValueAndResolveTokens("icon-image",q,a,O);xe=Se instanceof Po?Se:Po.fromString(Se)}if(!ie&&!xe)continue;const Oe=this.sortFeaturesByKey?I.evaluate(q,{},a):void 0;if(this.features.push({id:ee,text:ie,icon:xe,index:de,sourceLayerIndex:oe,geometry:q.geometry,properties:W.properties,type:kb[W.type],sortKey:Oe}),xe&&(L[xe.name]=!0),ie){const Se=g.evaluate(q,{},a).join(","),Ie=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(b.ag.vertical)>=0;for(const Ze of ie.sections)if(Ze.image)L[Ze.image.name]=!0;else{const je=Xa(ie.toString()),We=Ze.fontStack||Se,Le=F[We]=F[We]||{};this.calculateGlyphDependencies(Ze.text,Le,Ie,this.allowVerticalPlacement,je)}}}m.get("symbol-placement")==="line"&&(this.features=function(W){const ee={},de={},oe=[];let B=0;function q(Se){oe.push(W[Se]),B++}function ie(Se,Ie,Ze){const je=de[Se];return delete de[Se],de[Ie]=je,oe[je].geometry[0].pop(),oe[je].geometry[0]=oe[je].geometry[0].concat(Ze[0]),je}function xe(Se,Ie,Ze){const je=ee[Ie];return delete ee[Ie],ee[Se]=je,oe[je].geometry[0].shift(),oe[je].geometry[0]=Ze[0].concat(oe[je].geometry[0]),je}function Oe(Se,Ie,Ze){const je=Ze?Ie[0][Ie[0].length-1]:Ie[0][0];return`${Se}:${je.x}:${je.y}`}for(let Se=0;Se<W.length;Se++){const Ie=W[Se],Ze=Ie.geometry,je=Ie.text?Ie.text.toString():null;if(!je){q(Se);continue}const We=Oe(je,Ze),Le=Oe(je,Ze,!0);if(We in de&&Le in ee&&de[We]!==ee[Le]){const ut=xe(We,Le,Ze),kt=ie(We,Le,oe[ut].geometry);delete ee[We],delete de[Le],de[Oe(je,oe[kt].geometry,!0)]=kt,oe[ut].geometry=null}else We in de?ie(We,Le,Ze):Le in ee?xe(We,Le,Ze):(q(Se),ee[We]=B-1,de[Le]=B-1)}return oe.filter(Se=>Se.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((W,ee)=>W.sortKey-ee.sortKey)}update(t,i,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,i,this.layers,a),this.icon.programConfigurations.updatePaintArrays(t,i,this.layers,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,i){const a=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(i[t.segment+1]),m=t.dist(i[t.segment]);const g={};for(let v=t.segment+1;v<i.length;v++)g[v]={x:i[v].x,y:i[v].y,tileUnitDistanceFromAnchor:h},v<i.length-1&&(h+=i[v+1].dist(i[v]));for(let v=t.segment||0;v>=0;v--)g[v]={x:i[v].x,y:i[v].y,tileUnitDistanceFromAnchor:m},v>0&&(m+=i[v-1].dist(i[v]));for(let v=0;v<i.length;v++){const C=g[v];this.lineVertexArray.emplaceBack(C.x,C.y,C.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(t,i,a,h,m,g,v,C,S,M,I,L){const F=t.indexArray,O=t.layoutVertexArray,j=t.segments.prepareSegment(4*i.length,O,F,this.canOverlap?g.sortKey:void 0),W=this.glyphOffsetArray.length,ee=j.vertexLength,de=this.allowVerticalPlacement&&v===b.ag.vertical?Math.PI/2:0,oe=g.text&&g.text.sections;for(let B=0;B<i.length;B++){const{tl:q,tr:ie,bl:xe,br:Oe,tex:Se,pixelOffsetTL:Ie,pixelOffsetBR:Ze,minFontScaleX:je,minFontScaleY:We,glyphOffset:Le,isSDF:ut,sectionIndex:kt}=i[B],St=j.vertexLength,gt=Le[1];Uh(O,C.x,C.y,q.x,gt+q.y,Se.x,Se.y,a,ut,Ie.x,Ie.y,je,We),Uh(O,C.x,C.y,ie.x,gt+ie.y,Se.x+Se.w,Se.y,a,ut,Ze.x,Ie.y,je,We),Uh(O,C.x,C.y,xe.x,gt+xe.y,Se.x,Se.y+Se.h,a,ut,Ie.x,Ze.y,je,We),Uh(O,C.x,C.y,Oe.x,gt+Oe.y,Se.x+Se.w,Se.y+Se.h,a,ut,Ze.x,Ze.y,je,We),$f(t.dynamicLayoutVertexArray,C,de),F.emplaceBack(St,St+2,St+1),F.emplaceBack(St+1,St+2,St+3),j.vertexLength+=4,j.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Le[0]),B!==i.length-1&&kt===i[B+1].sectionIndex||t.programConfigurations.populatePaintArrays(O.length,g,g.index,{},L,oe&&oe[kt])}t.placedSymbolArray.emplaceBack(C.x,C.y,W,this.glyphOffsetArray.length-W,ee,S,M,C.segment,a?a[0]:0,a?a[1]:0,h[0],h[1],v,0,!1,0,I)}_addCollisionDebugVertex(t,i,a,h,m,g){return i.emplaceBack(0,0),t.emplaceBack(a.x,a.y,h,m,Math.round(g.x),Math.round(g.y))}addCollisionDebugVertices(t,i,a,h,m,g,v){const C=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),S=C.vertexLength,M=m.layoutVertexArray,I=m.collisionVertexArray,L=v.anchorX,F=v.anchorY;this._addCollisionDebugVertex(M,I,g,L,F,new se(t,i)),this._addCollisionDebugVertex(M,I,g,L,F,new se(a,i)),this._addCollisionDebugVertex(M,I,g,L,F,new se(a,h)),this._addCollisionDebugVertex(M,I,g,L,F,new se(t,h)),C.vertexLength+=4;const O=m.indexArray;O.emplaceBack(S,S+1),O.emplaceBack(S+1,S+2),O.emplaceBack(S+2,S+3),O.emplaceBack(S+3,S),C.primitiveLength+=4}addDebugCollisionBoxes(t,i,a,h){for(let m=t;m<i;m++){const g=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,h?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,a)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Nf(Re,Km.members,Xe),this.iconCollisionBox=new Nf(Re,Km.members,Xe);for(let t=0;t<this.symbolInstances.length;t++){const i=this.symbolInstances.get(t);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}}_deserializeCollisionBoxesForSymbol(t,i,a,h,m,g,v,C,S){const M={};for(let I=i;I<a;I++){const L=t.get(I);M.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},M.textFeatureIndex=L.featureIndex;break}for(let I=h;I<m;I++){const L=t.get(I);M.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},M.verticalTextFeatureIndex=L.featureIndex;break}for(let I=g;I<v;I++){const L=t.get(I);M.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},M.iconFeatureIndex=L.featureIndex;break}for(let I=C;I<S;I++){const L=t.get(I);M.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},M.verticalIconFeatureIndex=L.featureIndex;break}return M}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const a=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,i){const a=t.placedSymbolArray.get(i),h=a.vertexStartIndex+4*a.numGlyphs;for(let m=a.vertexStartIndex;m<h;m+=4)t.indexArray.emplaceBack(m,m+2,m+1),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(t),a=Math.cos(t),h=[],m=[],g=[];for(let v=0;v<this.symbolInstances.length;++v){g.push(v);const C=this.symbolInstances.get(v);h.push(0|Math.round(i*C.anchorX+a*C.anchorY)),m.push(C.featureIndex)}return g.sort((v,C)=>h[v]-h[C]||m[C]-m[v]),g}addToSortKeyRanges(t,i){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===i?a.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const a=this.symbolInstances.get(i);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((h,m,g)=>{h>=0&&g.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let hg,dg;ct("SymbolBucket",ml,{omit:["layers","collisionBoxArray","features","compareText"]}),ml.MAX_GLYPHS=65535,ml.addDynamicAttributes=$f;var Vf={get paint(){return dg=dg||new Bo({"icon-opacity":new Mt(A.paint_symbol["icon-opacity"]),"icon-color":new Mt(A.paint_symbol["icon-color"]),"icon-halo-color":new Mt(A.paint_symbol["icon-halo-color"]),"icon-halo-width":new Mt(A.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Mt(A.paint_symbol["icon-halo-blur"]),"icon-translate":new vt(A.paint_symbol["icon-translate"]),"icon-translate-anchor":new vt(A.paint_symbol["icon-translate-anchor"]),"text-opacity":new Mt(A.paint_symbol["text-opacity"]),"text-color":new Mt(A.paint_symbol["text-color"],{runtimeType:Ot,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new Mt(A.paint_symbol["text-halo-color"]),"text-halo-width":new Mt(A.paint_symbol["text-halo-width"]),"text-halo-blur":new Mt(A.paint_symbol["text-halo-blur"]),"text-translate":new vt(A.paint_symbol["text-translate"]),"text-translate-anchor":new vt(A.paint_symbol["text-translate-anchor"])})},get layout(){return hg=hg||new Bo({"symbol-placement":new vt(A.layout_symbol["symbol-placement"]),"symbol-spacing":new vt(A.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new vt(A.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Mt(A.layout_symbol["symbol-sort-key"]),"symbol-z-order":new vt(A.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new vt(A.layout_symbol["icon-allow-overlap"]),"icon-overlap":new vt(A.layout_symbol["icon-overlap"]),"icon-ignore-placement":new vt(A.layout_symbol["icon-ignore-placement"]),"icon-optional":new vt(A.layout_symbol["icon-optional"]),"icon-rotation-alignment":new vt(A.layout_symbol["icon-rotation-alignment"]),"icon-size":new Mt(A.layout_symbol["icon-size"]),"icon-text-fit":new vt(A.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new vt(A.layout_symbol["icon-text-fit-padding"]),"icon-image":new Mt(A.layout_symbol["icon-image"]),"icon-rotate":new Mt(A.layout_symbol["icon-rotate"]),"icon-padding":new Mt(A.layout_symbol["icon-padding"]),"icon-keep-upright":new vt(A.layout_symbol["icon-keep-upright"]),"icon-offset":new Mt(A.layout_symbol["icon-offset"]),"icon-anchor":new Mt(A.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new vt(A.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new vt(A.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new vt(A.layout_symbol["text-rotation-alignment"]),"text-field":new Mt(A.layout_symbol["text-field"]),"text-font":new Mt(A.layout_symbol["text-font"]),"text-size":new Mt(A.layout_symbol["text-size"]),"text-max-width":new Mt(A.layout_symbol["text-max-width"]),"text-line-height":new vt(A.layout_symbol["text-line-height"]),"text-letter-spacing":new Mt(A.layout_symbol["text-letter-spacing"]),"text-justify":new Mt(A.layout_symbol["text-justify"]),"text-radial-offset":new Mt(A.layout_symbol["text-radial-offset"]),"text-variable-anchor":new vt(A.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Mt(A.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Mt(A.layout_symbol["text-anchor"]),"text-max-angle":new vt(A.layout_symbol["text-max-angle"]),"text-writing-mode":new vt(A.layout_symbol["text-writing-mode"]),"text-rotate":new Mt(A.layout_symbol["text-rotate"]),"text-padding":new vt(A.layout_symbol["text-padding"]),"text-keep-upright":new vt(A.layout_symbol["text-keep-upright"]),"text-transform":new Mt(A.layout_symbol["text-transform"]),"text-offset":new Mt(A.layout_symbol["text-offset"]),"text-allow-overlap":new vt(A.layout_symbol["text-allow-overlap"]),"text-overlap":new vt(A.layout_symbol["text-overlap"]),"text-ignore-placement":new vt(A.layout_symbol["text-ignore-placement"]),"text-optional":new vt(A.layout_symbol["text-optional"])})}};class fg{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:It,this.defaultValue=t}evaluate(t){if(t.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ct("FormatSectionOverride",fg,{omit:["defaultValue"]});class Zh extends Ai{constructor(t){super(t,Vf)}recalculate(t,i){if(super.recalculate(t,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const a=this.layout.get("text-writing-mode");if(a){const h=[];for(const m of a)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,i,a,h){const m=this.layout.get(t).evaluate(i,{},a,h),g=this._unevaluatedLayout._values[t];return g.isDataDriven()||Na(g.value)||!m?m:function(v,C){return C.replace(/{([^{}]+)}/g,(S,M)=>v&&M in v?String(v[M]):"")}(i.properties,m)}createBucket(t){return new ml(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Vf.paint.overridableProperties){if(!Zh.hasPaintOverride(this.layout,t))continue;const i=this.paint.get(t),a=new fg(i),h=new lc(a,i.property.specification);let m=null;m=i.value.kind==="constant"||i.value.kind==="source"?new Va("source",h):new cc("composite",h,i.value.zoomStops),this.paint._values[t]=new hi(i.property,m,i.parameters)}}_handleOverridablePaintPropertyUpdate(t,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven())&&Zh.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,i){const a=t.get("text-field"),h=Vf.paint.properties[i];let m=!1;const g=v=>{for(const C of v)if(h.overrides&&h.overrides.hasOverride(C))return void(m=!0)};if(a.value.kind==="constant"&&a.value.value instanceof fo)g(a.value.value.sections);else if(a.value.kind==="source"){const v=S=>{m||(S instanceof si&&Ur(S.value)===Vr?g(S.value.sections):S instanceof yn?g(S.sections):S.eachChild(v))},C=a.value;C._styleExpression&&v(C._styleExpression.expression)}return m}}let pg;var Ib={get paint(){return pg=pg||new Bo({"background-color":new vt(A.paint_background["background-color"]),"background-pattern":new Qa(A.paint_background["background-pattern"]),"background-opacity":new vt(A.paint_background["background-opacity"])})}};class Eb extends Ai{constructor(t){super(t,Ib)}}let mg;var Ab={get paint(){return mg=mg||new Bo({"raster-opacity":new vt(A.paint_raster["raster-opacity"]),"raster-hue-rotate":new vt(A.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new vt(A.paint_raster["raster-brightness-min"]),"raster-brightness-max":new vt(A.paint_raster["raster-brightness-max"]),"raster-saturation":new vt(A.paint_raster["raster-saturation"]),"raster-contrast":new vt(A.paint_raster["raster-contrast"]),"raster-resampling":new vt(A.paint_raster["raster-resampling"]),"raster-fade-duration":new vt(A.paint_raster["raster-fade-duration"])})}};class zb extends Ai{constructor(t){super(t,Ab)}}class Db extends Ai{constructor(t){super(t,{}),this.onAdd=i=>{this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},this.onRemove=i=>{this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Rb{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Lb={once:!0},Uf=63710088e-1;class ps{constructor(t,i){if(isNaN(t)||isNaN(i))throw new Error(`Invalid LngLat object: (${t}, ${i})`);if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ps(Mr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const i=Math.PI/180,a=this.lat*i,h=t.lat*i,m=Math.sin(a)*Math.sin(h)+Math.cos(a)*Math.cos(h)*Math.cos((t.lng-this.lng)*i);return Uf*Math.acos(Math.min(m,1))}static convert(t){if(t instanceof ps)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new ps(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new ps(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const gg=2*Math.PI*Uf;function _g(o){return gg*Math.cos(o*Math.PI/180)}function yg(o){return(180+o)/360}function vg(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function bg(o,t){return o/_g(t)}function Zf(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function xg(o,t){return o*_g(Zf(t))}class Yc{constructor(t,i,a=0){this.x=+t,this.y=+i,this.z=+a}static fromLngLat(t,i=0){const a=ps.convert(t);return new Yc(yg(a.lng),vg(a.lat),bg(i,a.lat))}toLngLat(){return new ps(360*this.x-180,Zf(this.y))}toAltitude(){return xg(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/gg*(t=Zf(this.y),1/Math.cos(t*Math.PI/180));var t}}function wg(o,t,i){var a=2*Math.PI*6378137/256/Math.pow(2,i);return[o*a-2*Math.PI*6378137/2,t*a-2*Math.PI*6378137/2]}class Gf{constructor(t,i,a){if(!function(h,m,g){return!(h<0||h>25||g<0||g>=Math.pow(2,h)||m<0||m>=Math.pow(2,h))}(t,i,a))throw new Error(`x=${i}, y=${a}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=i,this.y=a,this.key=gl(0,t,t,i,a)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,i,a){const h=(g=this.y,v=this.z,C=wg(256*(m=this.x),256*(g=Math.pow(2,v)-g-1),v),S=wg(256*(m+1),256*(g+1),v),C[0]+","+C[1]+","+S[0]+","+S[1]);var m,g,v,C,S;const M=function(I,L,F){let O,j="";for(let W=I;W>0;W--)O=1<<W-1,j+=(L&O?1:0)+(F&O?2:0);return j}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,i>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const i=this.z-t.z;return i>0&&t.x===this.x>>i&&t.y===this.y>>i}getTilePoint(t){const i=Math.pow(2,this.z);return new se((t.x*i-this.x)*ft,(t.y*i-this.y)*ft)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Cg{constructor(t,i){this.wrap=t,this.canonical=i,this.key=gl(t,i.z,i.z,i.x,i.y)}}class Ci{constructor(t,i,a,h,m){if(this.terrainRttPosMatrix32f=null,t<a)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${a}`);this.overscaledZ=t,this.wrap=i,this.canonical=new Gf(a,+h,+m),this.key=gl(i,t,a,h,m)}clone(){return new Ci(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-t;return t>this.canonical.z?new Ci(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ci(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(t,i){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?gl(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y):gl(this.wrap*+i,t,t,this.canonical.x>>a,this.canonical.y>>a)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const i=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i}children(t){if(this.overscaledZ>=t)return[new Ci(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,a=2*this.canonical.x,h=2*this.canonical.y;return[new Ci(i,this.wrap,i,a,h),new Ci(i,this.wrap,i,a+1,h),new Ci(i,this.wrap,i,a,h+1),new Ci(i,this.wrap,i,a+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ci(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ci(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Cg(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Yc(t.x-this.wrap,t.y))}}function gl(o,t,i,a,h){(o*=2)<0&&(o=-1*o-1);const m=1<<i;return(m*m*o+m*h+a).toString(36)+i.toString(36)+t.toString(36)}ct("CanonicalTileID",Gf),ct("OverscaledTileID",Ci,{omit:["terrainRttPosMatrix32f"]});class Tg{constructor(t,i,a,h=1,m=1,g=1,v=0){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(a&&!["mapbox","terrarium","custom"].includes(a))return void Wr(`"${a}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=i.height;const C=this.dim=i.height-2;switch(this.data=new Uint32Array(i.data.buffer),a){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=m,this.blueFactor=g,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let S=0;S<C;S++)this.data[this._idx(-1,S)]=this.data[this._idx(0,S)],this.data[this._idx(C,S)]=this.data[this._idx(C-1,S)],this.data[this._idx(S,-1)]=this.data[this._idx(S,0)],this.data[this._idx(S,C)]=this.data[this._idx(S,C-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(C,-1)]=this.data[this._idx(C-1,0)],this.data[this._idx(-1,C)]=this.data[this._idx(0,C-1)],this.data[this._idx(C,C)]=this.data[this._idx(C-1,C-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let S=0;S<C;S++)for(let M=0;M<C;M++){const I=this.get(S,M);I>this.max&&(this.max=I),I<this.min&&(this.min=I)}}get(t,i){const a=new Uint8Array(this.data.buffer),h=4*this._idx(t,i);return this.unpack(a[h],a[h+1],a[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)}unpack(t,i,a){return t*this.redFactor+i*this.greenFactor+a*this.blueFactor-this.baseShift}getPixels(){return new wi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,i,a){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=i*this.dim,m=i*this.dim+this.dim,g=a*this.dim,v=a*this.dim+this.dim;switch(i){case-1:h=m-1;break;case 1:m=h+1}switch(a){case-1:g=v-1;break;case 1:v=g+1}const C=-i*this.dim,S=-a*this.dim;for(let M=g;M<v;M++)for(let I=h;I<m;I++)this.data[this._idx(I,M)]=t.data[this._idx(I+C,M+S)]}}ct("DEMData",Tg);class Sg{constructor(t){this._stringToNumber={},this._numberToString=[];for(let i=0;i<t.length;i++){const a=t[i];this._stringToNumber[a]=i,this._numberToString[i]=a}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class kg{constructor(t,i,a,h,m){this.type="Feature",this._vectorTileFeature=t,t._z=i,t._x=a,t._y=h,this.properties=t.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&(t[i]=this[i]);return t}}class Pg{constructor(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ws(ft,16,0),this.grid3D=new Ws(ft,16,0),this.featureIndexArray=new Y,this.promoteId=i}insert(t,i,a,h,m,g){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,h,m);const C=g?this.grid3D:this.grid;for(let S=0;S<i.length;S++){const M=i[S],I=[1/0,1/0,-1/0,-1/0];for(let L=0;L<M.length;L++){const F=M[L];I[0]=Math.min(I[0],F.x),I[1]=Math.min(I[1],F.y),I[2]=Math.max(I[2],F.x),I[3]=Math.max(I[3],F.y)}I[0]<ft&&I[1]<ft&&I[2]>=0&&I[3]>=0&&C.insert(v,I[0],I[1],I[2],I[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Zc.VectorTile(new Df(this.rawTileData)).layers,this.sourceLayerCoder=new Sg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,i,a,h){this.loadVTLayers();const m=t.params,g=ft/t.tileSize/t.scale,v=Ga(m.filter),C=t.queryGeometry,S=t.queryPadding*g,M=Ig(C),I=this.grid.query(M.minX-S,M.minY-S,M.maxX+S,M.maxY+S),L=Ig(t.cameraQueryGeometry),F=this.grid3D.query(L.minX-S,L.minY-S,L.maxX+S,L.maxY+S,(W,ee,de,oe)=>function(B,q,ie,xe,Oe){for(const Ie of B)if(q<=Ie.x&&ie<=Ie.y&&xe>=Ie.x&&Oe>=Ie.y)return!0;const Se=[new se(q,ie),new se(q,Oe),new se(xe,Oe),new se(xe,ie)];if(B.length>2){for(const Ie of Se)if(ul(B,Ie))return!0}for(let Ie=0;Ie<B.length-1;Ie++)if(Cv(B[Ie],B[Ie+1],Se))return!0;return!1}(t.cameraQueryGeometry,W-S,ee-S,de+S,oe+S));for(const W of F)I.push(W);I.sort(Bb);const O={};let j;for(let W=0;W<I.length;W++){const ee=I[W];if(ee===j)continue;j=ee;const de=this.featureIndexArray.get(ee);let oe=null;this.loadMatchingFeature(O,de.bucketIndex,de.sourceLayerIndex,de.featureIndex,v,m.layers,m.availableImages,i,a,h,(B,q,ie)=>(oe||(oe=Rn(B)),q.queryIntersectsFeature({queryGeometry:C,feature:B,featureState:ie,geometry:oe,zoom:this.z,transform:t.transform,pixelsToTileUnits:g,pixelPosMatrix:t.pixelPosMatrix})))}return O}loadMatchingFeature(t,i,a,h,m,g,v,C,S,M,I){const L=this.bucketLayerIDs[i];if(g&&!L.some(W=>g.has(W)))return;const F=this.sourceLayerCoder.decode(a),O=this.vtLayers[F].feature(h);if(m.needGeometry){const W=Ho(O,!0);if(!m.filter(new wr(this.tileID.overscaledZ),W,this.tileID.canonical))return}else if(!m.filter(new wr(this.tileID.overscaledZ),O))return;const j=this.getId(O,F);for(let W=0;W<L.length;W++){const ee=L[W];if(g&&!g.has(ee))continue;const de=C[ee];if(!de)continue;let oe={};j&&M&&(oe=M.getState(de.sourceLayer||"_geojsonTileLayer",j));const B=br({},S[ee]);B.paint=Mg(B.paint,de.paint,O,oe,v),B.layout=Mg(B.layout,de.layout,O,oe,v);const q=!I||I(O,de,oe);if(!q)continue;const ie=new kg(O,this.z,this.x,this.y,j);ie.layer=B;let xe=t[ee];xe===void 0&&(xe=t[ee]=[]),xe.push({featureIndex:h,feature:ie,intersectionZ:q})}}lookupSymbolFeatures(t,i,a,h,m,g,v,C){const S={};this.loadVTLayers();const M=Ga(m);for(const I of t)this.loadMatchingFeature(S,a,h,I,M,g,v,C,i);return S}hasLayer(t){for(const i of this.bucketLayerIDs)for(const a of i)if(t===a)return!0;return!1}getId(t,i){var a;let h=t.id;return this.promoteId&&(h=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof h=="boolean"&&(h=Number(h)),h===void 0&&(!((a=t.properties)===null||a===void 0)&&a.cluster)&&this.promoteId&&(h=Number(t.properties.cluster_id))),h}}function Mg(o,t,i,a,h){return bo(o,(m,g)=>{const v=t instanceof Ja?t.get(g):null;return v&&v.evaluate?v.evaluate(i,a,h):v})}function Ig(o){let t=1/0,i=1/0,a=-1/0,h=-1/0;for(const m of o)t=Math.min(t,m.x),i=Math.min(i,m.y),a=Math.max(a,m.x),h=Math.max(h,m.y);return{minX:t,minY:i,maxX:a,maxY:h}}function Bb(o,t){return t-o}function Eg(o,t,i,a,h){const m=[];for(let g=0;g<o.length;g++){const v=o[g];let C;for(let S=0;S<v.length-1;S++){let M=v[S],I=v[S+1];M.x<t&&I.x<t||(M.x<t?M=new se(t,M.y+(t-M.x)/(I.x-M.x)*(I.y-M.y))._round():I.x<t&&(I=new se(t,M.y+(t-M.x)/(I.x-M.x)*(I.y-M.y))._round()),M.y<i&&I.y<i||(M.y<i?M=new se(M.x+(i-M.y)/(I.y-M.y)*(I.x-M.x),i)._round():I.y<i&&(I=new se(M.x+(i-M.y)/(I.y-M.y)*(I.x-M.x),i)._round()),M.x>=a&&I.x>=a||(M.x>=a?M=new se(a,M.y+(a-M.x)/(I.x-M.x)*(I.y-M.y))._round():I.x>=a&&(I=new se(a,M.y+(a-M.x)/(I.x-M.x)*(I.y-M.y))._round()),M.y>=h&&I.y>=h||(M.y>=h?M=new se(M.x+(h-M.y)/(I.y-M.y)*(I.x-M.x),h)._round():I.y>=h&&(I=new se(M.x+(h-M.y)/(I.y-M.y)*(I.x-M.x),h)._round()),C&&M.equals(C[C.length-1])||(C=[M],m.push(C)),C.push(I)))))}}return m}ct("FeatureIndex",Pg,{omit:["rawTileData","sourceLayerCoder"]});class ms extends se{constructor(t,i,a,h){super(t,i),this.angle=a,h!==void 0&&(this.segment=h)}clone(){return new ms(this.x,this.y,this.angle,this.segment)}}function Ag(o,t,i,a,h){if(t.segment===void 0||i===0)return!0;let m=t,g=t.segment+1,v=0;for(;v>-i/2;){if(g--,g<0)return!1;v-=o[g].dist(m),m=o[g]}v+=o[g].dist(o[g+1]),g++;const C=[];let S=0;for(;v<i/2;){const M=o[g],I=o[g+1];if(!I)return!1;let L=o[g-1].angleTo(M)-M.angleTo(I);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:v,angleDelta:L}),S+=L;v-C[0].distance>a;)S-=C.shift().angleDelta;if(S>h)return!1;g++,v+=M.dist(I)}return!0}function zg(o){let t=0;for(let i=0;i<o.length-1;i++)t+=o[i].dist(o[i+1]);return t}function Dg(o,t,i){return o?.6*t*i:0}function Rg(o,t){return Math.max(o?o.right-o.left:0,t?t.right-t.left:0)}function Fb(o,t,i,a,h,m){const g=Dg(i,h,m),v=Rg(i,a)*m;let C=0;const S=zg(o)/2;for(let M=0;M<o.length-1;M++){const I=o[M],L=o[M+1],F=I.dist(L);if(C+F>S){const O=(S-C)/F,j=qo.number(I.x,L.x,O),W=qo.number(I.y,L.y,O),ee=new ms(j,W,L.angleTo(I),M);return ee._round(),!g||Ag(o,ee,v,g,t)?ee:void 0}C+=F}}function Ob(o,t,i,a,h,m,g,v,C){const S=Dg(a,m,g),M=Rg(a,h),I=M*g,L=o[0].x===0||o[0].x===C||o[0].y===0||o[0].y===C;return t-I<t/4&&(t=I+t/4),Lg(o,L?t/2*v%t:(M/2+2*m)*g*v%t,t,S,i,I,L,!1,C)}function Lg(o,t,i,a,h,m,g,v,C){const S=m/2,M=zg(o);let I=0,L=t-i,F=[];for(let O=0;O<o.length-1;O++){const j=o[O],W=o[O+1],ee=j.dist(W),de=W.angleTo(j);for(;L+i<I+ee;){L+=i;const oe=(L-I)/ee,B=qo.number(j.x,W.x,oe),q=qo.number(j.y,W.y,oe);if(B>=0&&B<C&&q>=0&&q<C&&L-S>=0&&L+S<=M){const ie=new ms(B,q,de,O);ie._round(),a&&!Ag(o,ie,m,a,h)||F.push(ie)}}I+=ee}return v||F.length||g||(F=Lg(o,I/2,i,a,h,m,g,!0,C)),F}ct("Anchor",ms);const Kc=Xo;function Bg(o,t,i,a){const h=[],m=o.image,g=m.pixelRatio,v=m.paddedRect.w-2*Kc,C=m.paddedRect.h-2*Kc;let S={x1:o.left,y1:o.top,x2:o.right,y2:o.bottom};const M=m.stretchX||[[0,v]],I=m.stretchY||[[0,C]],L=(Le,ut)=>Le+ut[1]-ut[0],F=M.reduce(L,0),O=I.reduce(L,0),j=v-F,W=C-O;let ee=0,de=F,oe=0,B=O,q=0,ie=j,xe=0,Oe=W;if(m.content&&a){const Le=m.content,ut=Le[2]-Le[0],kt=Le[3]-Le[1];(m.textFitWidth||m.textFitHeight)&&(S=lg(o)),ee=Gh(M,0,Le[0]),oe=Gh(I,0,Le[1]),de=Gh(M,Le[0],Le[2]),B=Gh(I,Le[1],Le[3]),q=Le[0]-ee,xe=Le[1]-oe,ie=ut-de,Oe=kt-B}const Se=S.x1,Ie=S.y1,Ze=S.x2-Se,je=S.y2-Ie,We=(Le,ut,kt,St)=>{const gt=qh(Le.stretch-ee,de,Ze,Se),Zt=Wh(Le.fixed-q,ie,Le.stretch,F),Dr=qh(ut.stretch-oe,B,je,Ie),Qr=Wh(ut.fixed-xe,Oe,ut.stretch,O),So=qh(kt.stretch-ee,de,Ze,Se),Ti=Wh(kt.fixed-q,ie,kt.stretch,F),Yo=qh(St.stretch-oe,B,je,Ie),mo=Wh(St.fixed-xe,Oe,St.stretch,O),kr=new se(gt,Dr),ao=new se(So,Dr),go=new se(So,Yo),_o=new se(gt,Yo),Fo=new se(Zt/g,Qr/g),Si=new se(Ti/g,mo/g),lo=t*Math.PI/180;if(lo){const co=Math.sin(lo),uo=Math.cos(lo),Zr=[uo,-co,co,uo];kr._matMult(Zr),ao._matMult(Zr),_o._matMult(Zr),go._matMult(Zr)}const Ko=Le.stretch+Le.fixed,eo=ut.stretch+ut.fixed;return{tl:kr,tr:ao,bl:_o,br:go,tex:{x:m.paddedRect.x+Kc+Ko,y:m.paddedRect.y+Kc+eo,w:kt.stretch+kt.fixed-Ko,h:St.stretch+St.fixed-eo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Fo,pixelOffsetBR:Si,minFontScaleX:ie/g/Ze,minFontScaleY:Oe/g/je,isSDF:i}};if(a&&(m.stretchX||m.stretchY)){const Le=Fg(M,j,F),ut=Fg(I,W,O);for(let kt=0;kt<Le.length-1;kt++){const St=Le[kt],gt=Le[kt+1];for(let Zt=0;Zt<ut.length-1;Zt++)h.push(We(St,ut[Zt],gt,ut[Zt+1]))}}else h.push(We({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:C+1}));return h}function Gh(o,t,i){let a=0;for(const h of o)a+=Math.max(t,Math.min(i,h[1]))-Math.max(t,Math.min(i,h[0]));return a}function Fg(o,t,i){const a=[{fixed:-1,stretch:0}];for(const[h,m]of o){const g=a[a.length-1];a.push({fixed:h-g.stretch,stretch:g.stretch}),a.push({fixed:h-g.stretch,stretch:g.stretch+(m-h)})}return a.push({fixed:t+Kc,stretch:i}),a}function qh(o,t,i,a){return o/t*i+a}function Wh(o,t,i,a){return o-t*i/a}class Hh{constructor(t,i,a,h,m,g,v,C,S,M){var I;if(this.boxStartIndex=t.length,S){let L=g.top,F=g.bottom;const O=g.collisionPadding;O&&(L-=O[1],F+=O[3]);let j=F-L;j>0&&(j=Math.max(10,j),this.circleDiameter=j)}else{const L=!((I=g.image)===null||I===void 0)&&I.content&&(g.image.textFitWidth||g.image.textFitHeight)?lg(g):{x1:g.left,y1:g.top,x2:g.right,y2:g.bottom};L.y1=L.y1*v-C[0],L.y2=L.y2*v+C[2],L.x1=L.x1*v-C[3],L.x2=L.x2*v+C[1];const F=g.collisionPadding;if(F&&(L.x1-=F[0]*v,L.y1-=F[1]*v,L.x2+=F[2]*v,L.y2+=F[3]*v),M){const O=new se(L.x1,L.y1),j=new se(L.x2,L.y1),W=new se(L.x1,L.y2),ee=new se(L.x2,L.y2),de=M*Math.PI/180;O._rotate(de),j._rotate(de),W._rotate(de),ee._rotate(de),L.x1=Math.min(O.x,j.x,W.x,ee.x),L.x2=Math.max(O.x,j.x,W.x,ee.x),L.y1=Math.min(O.y,j.y,W.y,ee.y),L.y2=Math.max(O.y,j.y,W.y,ee.y)}t.emplaceBack(i.x,i.y,L.x1,L.y1,L.x2,L.y2,a,h,m)}this.boxEndIndex=t.length}}class $b{constructor(t=[],i=(a,h)=>a<h?-1:a>h?1:0){if(this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:i,compare:a}=this,h=i[t];for(;t>0;){const m=t-1>>1,g=i[m];if(a(h,g)>=0)break;i[t]=g,t=m}i[t]=h}_down(t){const{data:i,compare:a}=this,h=this.length>>1,m=i[t];for(;t<h;){let g=1+(t<<1);const v=g+1;if(v<this.length&&a(i[v],i[g])<0&&(g=v),a(i[g],m)>=0)break;i[t]=i[g],t=g}i[t]=m}}function jb(o,t=1,i=!1){let a=1/0,h=1/0,m=-1/0,g=-1/0;const v=o[0];for(let F=0;F<v.length;F++){const O=v[F];(!F||O.x<a)&&(a=O.x),(!F||O.y<h)&&(h=O.y),(!F||O.x>m)&&(m=O.x),(!F||O.y>g)&&(g=O.y)}const C=Math.min(m-a,g-h);let S=C/2;const M=new $b([],Nb);if(C===0)return new se(a,h);for(let F=a;F<m;F+=C)for(let O=h;O<g;O+=C)M.push(new _l(F+S,O+S,S,o));let I=function(F){let O=0,j=0,W=0;const ee=F[0];for(let de=0,oe=ee.length,B=oe-1;de<oe;B=de++){const q=ee[de],ie=ee[B],xe=q.x*ie.y-ie.x*q.y;j+=(q.x+ie.x)*xe,W+=(q.y+ie.y)*xe,O+=3*xe}return new _l(j/O,W/O,0,F)}(o),L=M.length;for(;M.length;){const F=M.pop();(F.d>I.d||!I.d)&&(I=F,i&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,L)),F.max-I.d<=t||(S=F.h/2,M.push(new _l(F.p.x-S,F.p.y-S,S,o)),M.push(new _l(F.p.x+S,F.p.y-S,S,o)),M.push(new _l(F.p.x-S,F.p.y+S,S,o)),M.push(new _l(F.p.x+S,F.p.y+S,S,o)),L+=4)}return i&&(console.log(`num probes: ${L}`),console.log(`best distance: ${I.d}`)),I.p}function Nb(o,t){return t.max-o.max}function _l(o,t,i,a){this.p=new se(o,t),this.h=i,this.d=function(h,m){let g=!1,v=1/0;for(let C=0;C<m.length;C++){const S=m[C];for(let M=0,I=S.length,L=I-1;M<I;L=M++){const F=S[M],O=S[L];F.y>h.y!=O.y>h.y&&h.x<(O.x-F.x)*(h.y-F.y)/(O.y-F.y)+F.x&&(g=!g),v=Math.min(v,_m(h,F,O))}}return(g?1:-1)*Math.sqrt(v)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}var To;b.ax=void 0,(To=b.ax||(b.ax={}))[To.center=1]="center",To[To.left=2]="left",To[To.right=3]="right",To[To.top=4]="top",To[To.bottom=5]="bottom",To[To["top-left"]=6]="top-left",To[To["top-right"]=7]="top-right",To[To["bottom-left"]=8]="bottom-left",To[To["bottom-right"]=9]="bottom-right";const gs=7,qf=Number.POSITIVE_INFINITY;function Og(o,t){return t[1]!==qf?function(i,a,h){let m=0,g=0;switch(a=Math.abs(a),h=Math.abs(h),i){case"top-right":case"top-left":case"top":g=h-gs;break;case"bottom-right":case"bottom-left":case"bottom":g=-h+gs}switch(i){case"top-right":case"bottom-right":case"right":m=-a;break;case"top-left":case"bottom-left":case"left":m=a}return[m,g]}(o,t[0],t[1]):function(i,a){let h=0,m=0;a<0&&(a=0);const g=a/Math.SQRT2;switch(i){case"top-right":case"top-left":m=g-gs;break;case"bottom-right":case"bottom-left":m=-g+gs;break;case"bottom":m=-a+gs;break;case"top":m=a-gs}switch(i){case"top-right":case"bottom-right":h=-g;break;case"top-left":case"bottom-left":h=g;break;case"left":h=a;break;case"right":h=-a}return[h,m]}(o,t[0])}function $g(o,t,i){var a;const h=o.layout,m=(a=h.get("text-variable-anchor-offset"))===null||a===void 0?void 0:a.evaluate(t,{},i);if(m){const v=m.values,C=[];for(let S=0;S<v.length;S+=2){const M=C[S]=v[S],I=v[S+1].map(L=>L*Jr);M.startsWith("top")?I[1]-=gs:M.startsWith("bottom")&&(I[1]+=gs),C[S+1]=I}return new io(C)}const g=h.get("text-variable-anchor");if(g){let v;v=o._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},i)*Jr,qf]:h.get("text-offset").evaluate(t,{},i).map(S=>S*Jr);const C=[];for(const S of g)C.push(S,Og(S,v));return new io(C)}return null}function Wf(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Vb(o,t,i,a,h,m,g,v,C,S,M,I){let L=m.textMaxSize.evaluate(t,{});L===void 0&&(L=g);const F=o.layers[0].layout,O=F.get("icon-offset").evaluate(t,{},M),j=Ng(i.horizontal),W=g/24,ee=o.tilePixelRatio*W,de=o.tilePixelRatio*L/24,oe=o.tilePixelRatio*v,B=o.tilePixelRatio*F.get("symbol-spacing"),q=F.get("text-padding")*o.tilePixelRatio,ie=function(kt,St,gt,Zt=1){const Dr=kt.get("icon-padding").evaluate(St,{},gt),Qr=Dr&&Dr.values;return[Qr[0]*Zt,Qr[1]*Zt,Qr[2]*Zt,Qr[3]*Zt]}(F,t,M,o.tilePixelRatio),xe=F.get("text-max-angle")/180*Math.PI,Oe=F.get("text-rotation-alignment")!=="viewport"&&F.get("symbol-placement")!=="point",Se=F.get("icon-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",Ie=F.get("symbol-placement"),Ze=B/2,je=F.get("icon-text-fit");let We;a&&je!=="none"&&(o.allowVerticalPlacement&&i.vertical&&(We=cg(a,i.vertical,je,F.get("icon-text-fit-padding"),O,W)),j&&(a=cg(a,j,je,F.get("icon-text-fit-padding"),O,W)));const Le=M?I.line.getGranularityForZoomLevel(M.z):1,ut=(kt,St)=>{St.x<0||St.x>=ft||St.y<0||St.y>=ft||function(gt,Zt,Dr,Qr,So,Ti,Yo,mo,kr,ao,go,_o,Fo,Si,lo,Ko,eo,co,uo,Zr,vr,Zi,yl,Gi,Gb){const vl=gt.addToLineVertexArray(Zt,Dr);let ra,bl,xl,wl,Gg=0,qg=0,Wg=0,Hg=0,tp=-1,rp=-1;const Ln={};let Xg=Xr("");if(gt.allowVerticalPlacement&&Qr.vertical){const Mo=mo.layout.get("text-rotate").evaluate(vr,{},Gi)+90;xl=new Hh(kr,Zt,ao,go,_o,Qr.vertical,Fo,Si,lo,Mo),Yo&&(wl=new Hh(kr,Zt,ao,go,_o,Yo,eo,co,lo,Mo))}if(So){const Mo=mo.layout.get("icon-rotate").evaluate(vr,{}),ki=mo.layout.get("icon-text-fit")!=="none",oa=Bg(So,Mo,yl,ki),Wi=Yo?Bg(Yo,Mo,yl,ki):void 0;bl=new Hh(kr,Zt,ao,go,_o,So,eo,co,!1,Mo),Gg=4*oa.length;const ia=gt.iconSizeData;let ln=null;ia.kind==="source"?(ln=[an*mo.layout.get("icon-size").evaluate(vr,{})],ln[0]>fs&&Wr(`${gt.layerIds[0]}: Value for "icon-size" is >= ${Xc}. Reduce your "icon-size".`)):ia.kind==="composite"&&(ln=[an*Zi.compositeIconSizes[0].evaluate(vr,{},Gi),an*Zi.compositeIconSizes[1].evaluate(vr,{},Gi)],(ln[0]>fs||ln[1]>fs)&&Wr(`${gt.layerIds[0]}: Value for "icon-size" is >= ${Xc}. Reduce your "icon-size".`)),gt.addSymbols(gt.icon,oa,ln,Zr,uo,vr,b.ag.none,Zt,vl.lineStartIndex,vl.lineLength,-1,Gi),tp=gt.icon.placedSymbolArray.length-1,Wi&&(qg=4*Wi.length,gt.addSymbols(gt.icon,Wi,ln,Zr,uo,vr,b.ag.vertical,Zt,vl.lineStartIndex,vl.lineLength,-1,Gi),rp=gt.icon.placedSymbolArray.length-1)}const Yg=Object.keys(Qr.horizontal);for(const Mo of Yg){const ki=Qr.horizontal[Mo];if(!ra){Xg=Xr(ki.text);const Wi=mo.layout.get("text-rotate").evaluate(vr,{},Gi);ra=new Hh(kr,Zt,ao,go,_o,ki,Fo,Si,lo,Wi)}const oa=ki.positionedLines.length===1;if(Wg+=jg(gt,Zt,ki,Ti,mo,lo,vr,Ko,vl,Qr.vertical?b.ag.horizontal:b.ag.horizontalOnly,oa?Yg:[Mo],Ln,tp,Zi,Gi),oa)break}Qr.vertical&&(Hg+=jg(gt,Zt,Qr.vertical,Ti,mo,lo,vr,Ko,vl,b.ag.vertical,["vertical"],Ln,rp,Zi,Gi));const qb=ra?ra.boxStartIndex:gt.collisionBoxArray.length,Wb=ra?ra.boxEndIndex:gt.collisionBoxArray.length,Hb=xl?xl.boxStartIndex:gt.collisionBoxArray.length,Xb=xl?xl.boxEndIndex:gt.collisionBoxArray.length,Yb=bl?bl.boxStartIndex:gt.collisionBoxArray.length,Kb=bl?bl.boxEndIndex:gt.collisionBoxArray.length,Jb=wl?wl.boxStartIndex:gt.collisionBoxArray.length,Qb=wl?wl.boxEndIndex:gt.collisionBoxArray.length;let qi=-1;const Yh=(Mo,ki)=>Mo&&Mo.circleDiameter?Math.max(Mo.circleDiameter,ki):ki;qi=Yh(ra,qi),qi=Yh(xl,qi),qi=Yh(bl,qi),qi=Yh(wl,qi);const Kg=qi>-1?1:0;Kg&&(qi*=Gb/Jr),gt.glyphOffsetArray.length>=ml.MAX_GLYPHS&&Wr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),vr.sortKey!==void 0&&gt.addToSortKeyRanges(gt.symbolInstances.length,vr.sortKey);const ex=$g(mo,vr,Gi),[tx,rx]=function(Mo,ki){const oa=Mo.length,Wi=ki==null?void 0:ki.values;if((Wi==null?void 0:Wi.length)>0)for(let ia=0;ia<Wi.length;ia+=2){const ln=Wi[ia+1];Mo.emplaceBack(b.ax[Wi[ia]],ln[0],ln[1])}return[oa,Mo.length]}(gt.textAnchorOffsets,ex);gt.symbolInstances.emplaceBack(Zt.x,Zt.y,Ln.right>=0?Ln.right:-1,Ln.center>=0?Ln.center:-1,Ln.left>=0?Ln.left:-1,Ln.vertical||-1,tp,rp,Xg,qb,Wb,Hb,Xb,Yb,Kb,Jb,Qb,ao,Wg,Hg,Gg,qg,Kg,0,Fo,qi,tx,rx)}(o,St,kt,i,a,h,We,o.layers[0],o.collisionBoxArray,t.index,t.sourceLayerIndex,o.index,ee,[q,q,q,q],Oe,C,oe,ie,Se,O,t,m,S,M,g)};if(Ie==="line")for(const kt of Eg(t.geometry,0,0,ft,ft)){const St=ta(kt,Le),gt=Ob(St,B,xe,i.vertical||j,a,24,de,o.overscaling,ft);for(const Zt of gt)j&&Ub(o,j.text,Ze,Zt)||ut(St,Zt)}else if(Ie==="line-center"){for(const kt of t.geometry)if(kt.length>1){const St=ta(kt,Le),gt=Fb(St,xe,i.vertical||j,a,24,de);gt&&ut(St,gt)}}else if(t.type==="Polygon")for(const kt of Ea(t.geometry,0)){const St=jb(kt,16);ut(ta(kt[0],Le,!0),new ms(St.x,St.y,0))}else if(t.type==="LineString")for(const kt of t.geometry){const St=ta(kt,Le);ut(St,new ms(St[0].x,St[0].y,0))}else if(t.type==="Point")for(const kt of t.geometry)for(const St of kt)ut([St],new ms(St.x,St.y,0))}function jg(o,t,i,a,h,m,g,v,C,S,M,I,L,F,O){const j=function(de,oe,B,q,ie,xe,Oe,Se){const Ie=q.layout.get("text-rotate").evaluate(xe,{})*Math.PI/180,Ze=[];for(const je of oe.positionedLines)for(const We of je.positionedGlyphs){if(!We.rect)continue;const Le=We.rect||{};let ut=gb+1,kt=!0,St=1,gt=0;const Zt=(ie||Se)&&We.vertical,Dr=We.metrics.advance*We.scale/2;if(Se&&oe.verticalizable&&(gt=je.lineOffset/2-(We.imageName?-(Jr-We.metrics.width*We.scale)/2:(We.scale-1)*Jr)),We.imageName){const co=Oe[We.imageName];kt=co.sdf,St=co.pixelRatio,ut=Xo/St}const Qr=ie?[We.x+Dr,We.y]:[0,0];let So=ie?[0,0]:[We.x+Dr+B[0],We.y+B[1]-gt],Ti=[0,0];Zt&&(Ti=So,So=[0,0]);const Yo=We.metrics.isDoubleResolution?2:1,mo=(We.metrics.left-ut)*We.scale-Dr+So[0],kr=(-We.metrics.top-ut)*We.scale+So[1],ao=mo+Le.w/Yo*We.scale/St,go=kr+Le.h/Yo*We.scale/St,_o=new se(mo,kr),Fo=new se(ao,kr),Si=new se(mo,go),lo=new se(ao,go);if(Zt){const co=new se(-Dr,Dr-jh),uo=-Math.PI/2,Zr=Jr/2-Dr,vr=new se(5-jh-Zr,-(We.imageName?Zr:0)),Zi=new se(...Ti);_o._rotateAround(uo,co)._add(vr)._add(Zi),Fo._rotateAround(uo,co)._add(vr)._add(Zi),Si._rotateAround(uo,co)._add(vr)._add(Zi),lo._rotateAround(uo,co)._add(vr)._add(Zi)}if(Ie){const co=Math.sin(Ie),uo=Math.cos(Ie),Zr=[uo,-co,co,uo];_o._matMult(Zr),Fo._matMult(Zr),Si._matMult(Zr),lo._matMult(Zr)}const Ko=new se(0,0),eo=new se(0,0);Ze.push({tl:_o,tr:Fo,bl:Si,br:lo,tex:Le,writingMode:oe.writingMode,glyphOffset:Qr,sectionIndex:We.sectionIndex,isSDF:kt,pixelOffsetTL:Ko,pixelOffsetBR:eo,minFontScaleX:0,minFontScaleY:0})}return Ze}(0,i,v,h,m,g,a,o.allowVerticalPlacement),W=o.textSizeData;let ee=null;W.kind==="source"?(ee=[an*h.layout.get("text-size").evaluate(g,{})],ee[0]>fs&&Wr(`${o.layerIds[0]}: Value for "text-size" is >= ${Xc}. Reduce your "text-size".`)):W.kind==="composite"&&(ee=[an*F.compositeTextSizes[0].evaluate(g,{},O),an*F.compositeTextSizes[1].evaluate(g,{},O)],(ee[0]>fs||ee[1]>fs)&&Wr(`${o.layerIds[0]}: Value for "text-size" is >= ${Xc}. Reduce your "text-size".`)),o.addSymbols(o.text,j,ee,v,m,g,S,t,C.lineStartIndex,C.lineLength,L,O);for(const de of M)I[de]=o.text.placedSymbolArray.length-1;return 4*j.length}function Ng(o){for(const t in o)return o[t];return null}function Ub(o,t,i,a){const h=o.compareText;if(t in h){const m=h[t];for(let g=m.length-1;g>=0;g--)if(a.dist(m[g])<i)return!0}else h[t]=[];return h[t].push(a),!1}const Vg=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Hf{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,a]=new Uint8Array(t,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=a>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=Vg[15&a];if(!m)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(t,2,1),[v]=new Uint32Array(t,4,1);return new Hf(v,g,m,t)}constructor(t,i=64,a=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=a,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=Vg.indexOf(this.ArrayType),g=2*t*this.ArrayType.BYTES_PER_ELEMENT,v=t*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-v%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${a}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+C,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+g+v+C),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+C,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t)}add(t,i){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=t,this.coords[this._pos++]=i,a}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Xf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,i,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:g,nodeSize:v}=this,C=[0,m.length-1,0],S=[];for(;C.length;){const M=C.pop()||0,I=C.pop()||0,L=C.pop()||0;if(I-L<=v){for(let W=L;W<=I;W++){const ee=g[2*W],de=g[2*W+1];ee>=t&&ee<=a&&de>=i&&de<=h&&S.push(m[W])}continue}const F=L+I>>1,O=g[2*F],j=g[2*F+1];O>=t&&O<=a&&j>=i&&j<=h&&S.push(m[F]),(M===0?t<=O:i<=j)&&(C.push(L),C.push(F-1),C.push(1-M)),(M===0?a>=O:h>=j)&&(C.push(F+1),C.push(I),C.push(1-M))}return S}within(t,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:g}=this,v=[0,h.length-1,0],C=[],S=a*a;for(;v.length;){const M=v.pop()||0,I=v.pop()||0,L=v.pop()||0;if(I-L<=g){for(let W=L;W<=I;W++)Zg(m[2*W],m[2*W+1],t,i)<=S&&C.push(h[W]);continue}const F=L+I>>1,O=m[2*F],j=m[2*F+1];Zg(O,j,t,i)<=S&&C.push(h[F]),(M===0?t-a<=O:i-a<=j)&&(v.push(L),v.push(F-1),v.push(1-M)),(M===0?t+a>=O:i+a>=j)&&(v.push(F+1),v.push(I),v.push(1-M))}return C}}function Xf(o,t,i,a,h,m){if(h-a<=i)return;const g=a+h>>1;Ug(o,t,g,a,h,m),Xf(o,t,i,a,g-1,1-m),Xf(o,t,i,g+1,h,1-m)}function Ug(o,t,i,a,h,m){for(;h>a;){if(h-a>600){const S=h-a+1,M=i-a+1,I=Math.log(S),L=.5*Math.exp(2*I/3),F=.5*Math.sqrt(I*L*(S-L)/S)*(M-S/2<0?-1:1);Ug(o,t,i,Math.max(a,Math.floor(i-M*L/S+F)),Math.min(h,Math.floor(i+(S-M)*L/S+F)),m)}const g=t[2*i+m];let v=a,C=h;for(Jc(o,t,a,i),t[2*h+m]>g&&Jc(o,t,a,h);v<C;){for(Jc(o,t,v,C),v++,C--;t[2*v+m]<g;)v++;for(;t[2*C+m]>g;)C--}t[2*a+m]===g?Jc(o,t,a,C):(C++,Jc(o,t,C,h)),C<=i&&(a=C+1),i<=C&&(h=C-1)}}function Jc(o,t,i,a){Yf(o,i,a),Yf(t,2*i,2*a),Yf(t,2*i+1,2*a+1)}function Yf(o,t,i){const a=o[t];o[t]=o[i],o[i]=a}function Zg(o,t,i,a){const h=o-i,m=t-a;return h*h+m*m}var Kf;b.cg=void 0,(Kf=b.cg||(b.cg={})).create="create",Kf.load="load",Kf.fullLoad="fullLoad";let Xh=null,Qc=[];const Jf=1e3/60,Qf="loadTime",ep="fullLoadTime",Zb={mark(o){performance.mark(o)},frame(o){const t=o;Xh!=null&&Qc.push(t-Xh),Xh=t},clearMetrics(){Xh=null,Qc=[],performance.clearMeasures(Qf),performance.clearMeasures(ep);for(const o in b.cg)performance.clearMarks(b.cg[o])},getPerformanceMetrics(){performance.measure(Qf,b.cg.create,b.cg.load),performance.measure(ep,b.cg.create,b.cg.fullLoad);const o=performance.getEntriesByName(Qf)[0].duration,t=performance.getEntriesByName(ep)[0].duration,i=Qc.length,a=1/(Qc.reduce((m,g)=>m+g,0)/i/1e3),h=Qc.filter(m=>m>Jf).reduce((m,g)=>m+(g-Jf)/Jf,0);return{loadTime:o,fullLoadTime:t,fps:a,percentDroppedFrames:h/(i+h)*100,totalFrames:i}}};b.$=Yc,b.A=_t,b.B=qo,b.C=wr,b.D=vt,b.E=ge,b.F=xh,b.G=function(o){if(ke==null){const t=o.navigator?o.navigator.userAgent:null;ke=!!o.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ke},b.H=class{constructor(o,t){this.target=o,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Rb(()=>this.process()),this.subscription=Qe(this.target,"message",i=>this.receive(i),!1),this.globalScope=pe(self)?o:window}registerMessageHandler(o,t){this.messageHandlers[o]=t}sendAsync(o,t){return new Promise((i,a)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10),m=t?Qe(t.signal,"abort",()=>{m==null||m.unsubscribe(),delete this.resolveRejects[h];const C={id:h,type:"<cancel>",origin:location.origin,targetMapId:o.targetMapId,sourceMapId:this.mapId};this.target.postMessage(C)},Lb):null;this.resolveRejects[h]={resolve:C=>{m==null||m.unsubscribe(),i(C)},reject:C=>{m==null||m.unsubscribe(),a(C)}};const g=[],v=Object.assign(Object.assign({},o),{id:h,sourceMapId:this.mapId,origin:location.origin,data:on(o.data,g)});this.target.postMessage(v,{transfer:g})})}receive(o){const t=o.data,i=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[i];const a=this.abortControllers[i];return delete this.abortControllers[i],void(a&&a.abort())}if(pe(self)||t.mustQueue)return this.tasks[i]=t,this.taskQueue.push(i),void this.invoker.trigger();this.processTask(i,t)}}process(){if(this.taskQueue.length===0)return;const o=this.taskQueue.shift(),t=this.tasks[o];delete this.tasks[o],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(o,t)}processTask(o,t){return c(this,void 0,void 0,function*(){if(t.type==="<response>"){const h=this.resolveRejects[o];return delete this.resolveRejects[o],h?void(t.error?h.reject(Hs(t.error)):h.resolve(Hs(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(o,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const i=Hs(t.data),a=new AbortController;this.abortControllers[o]=a;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,i,a);this.completeTask(o,null,h)}catch(h){this.completeTask(o,h)}})}completeTask(o,t,i){const a=[];delete this.abortControllers[o];const h={id:o,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?on(t):null,data:on(i,a)};this.target.postMessage(h,{transfer:a})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},b.I=Lf,b.J=$t,b.K=function(){var o=new _t(16);return _t!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},b.L=function(o,t,i){var a,h,m,g,v,C,S,M,I,L,F,O,j=i[0],W=i[1],ee=i[2];return t===o?(o[12]=t[0]*j+t[4]*W+t[8]*ee+t[12],o[13]=t[1]*j+t[5]*W+t[9]*ee+t[13],o[14]=t[2]*j+t[6]*W+t[10]*ee+t[14],o[15]=t[3]*j+t[7]*W+t[11]*ee+t[15]):(h=t[1],m=t[2],g=t[3],v=t[4],C=t[5],S=t[6],M=t[7],I=t[8],L=t[9],F=t[10],O=t[11],o[0]=a=t[0],o[1]=h,o[2]=m,o[3]=g,o[4]=v,o[5]=C,o[6]=S,o[7]=M,o[8]=I,o[9]=L,o[10]=F,o[11]=O,o[12]=a*j+v*W+I*ee+t[12],o[13]=h*j+C*W+L*ee+t[13],o[14]=m*j+S*W+F*ee+t[14],o[15]=g*j+M*W+O*ee+t[15]),o},b.M=function(o,t,i){var a=i[0],h=i[1],m=i[2];return o[0]=t[0]*a,o[1]=t[1]*a,o[2]=t[2]*a,o[3]=t[3]*a,o[4]=t[4]*h,o[5]=t[5]*h,o[6]=t[6]*h,o[7]=t[7]*h,o[8]=t[8]*m,o[9]=t[9]*m,o[10]=t[10]*m,o[11]=t[11]*m,o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},b.N=function(o,t,i){var a=t[0],h=t[1],m=t[2],g=t[3],v=t[4],C=t[5],S=t[6],M=t[7],I=t[8],L=t[9],F=t[10],O=t[11],j=t[12],W=t[13],ee=t[14],de=t[15],oe=i[0],B=i[1],q=i[2],ie=i[3];return o[0]=oe*a+B*v+q*I+ie*j,o[1]=oe*h+B*C+q*L+ie*W,o[2]=oe*m+B*S+q*F+ie*ee,o[3]=oe*g+B*M+q*O+ie*de,o[4]=(oe=i[4])*a+(B=i[5])*v+(q=i[6])*I+(ie=i[7])*j,o[5]=oe*h+B*C+q*L+ie*W,o[6]=oe*m+B*S+q*F+ie*ee,o[7]=oe*g+B*M+q*O+ie*de,o[8]=(oe=i[8])*a+(B=i[9])*v+(q=i[10])*I+(ie=i[11])*j,o[9]=oe*h+B*C+q*L+ie*W,o[10]=oe*m+B*S+q*F+ie*ee,o[11]=oe*g+B*M+q*O+ie*de,o[12]=(oe=i[12])*a+(B=i[13])*v+(q=i[14])*I+(ie=i[15])*j,o[13]=oe*h+B*C+q*L+ie*W,o[14]=oe*m+B*S+q*F+ie*ee,o[15]=oe*g+B*M+q*O+ie*de,o},b.O=function(o,t){const i={};for(let a=0;a<t.length;a++){const h=t[a];h in o&&(i[h]=o[h])}return i},b.P=se,b.Q=ps,b.R=wi,b.S=vg,b.T=Pc,b.U=yg,b.V=st,b.W=Te,b.X=Ve,b.Y=Ci,b.Z=ft,b._=c,b.a=Ct,b.a$=function(){const o=new Float32Array(16);return Je(o),o},b.a0=Gf,b.a1=o=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(i=>{t.onloadstart=()=>{i(t)};for(const a of o){const h=window.document.createElement("source");Ir(a)||(t.crossOrigin="Anonymous"),h.src=a,t.appendChild(h)}})},b.a2=ve,b.a3=function(){return qr++},b.a4=y,b.a5=ml,b.a6=Ga,b.a7=Ho,b.a8=kg,b.a9=function(o){const t={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,a,h,m)=>{const g=h||m;return t[a]=!g||g.toLowerCase(),""}),t["max-age"]){const i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t},b.aA=Ff,b.aB=Hf,b.aC=$r,b.aD=Fh,b.aE=J,b.aF=xt,b.aG=Ke,b.aH=function(o){return Math.pow(2,o)},b.aI=85.051129,b.aJ=bg,b.aK=Mr,b.aL=Ue,b.aM=xg,b.aN=function(o,t,i){return o[0]=t[0]*i,o[1]=t[1]*i,o[2]=t[2]*i,o},b.aO=function(o,t,i){return o[0]=t[0]+i[0],o[1]=t[1]+i[1],o[2]=t[2]+i[2],o},b.aP=function(o){var t=new _t(3);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t},b.aQ=function(o,t,i){return o[0]=t[0]*i[0],o[1]=t[1]*i[1],o[2]=t[2]*i[2],o[3]=t[3]*i[3],o},b.aR=function(o,t,i){return o[0]=t[0]-i[0],o[1]=t[1]-i[1],o[2]=t[2]-i[2],o},b.aS=function(o,t){var i=t[0],a=t[1],h=t[2],m=i*i+a*a+h*h;return m>0&&(m=1/Math.sqrt(m)),o[0]=t[0]*m,o[1]=t[1]*m,o[2]=t[2]*m,o},b.aT=function(o,t,i){var a=t[0],h=t[1],m=t[2],g=i[0],v=i[1],C=i[2];return o[0]=h*C-m*v,o[1]=m*g-a*C,o[2]=a*v-h*g,o},b.aU=function(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]},b.aV=Cg,b.aW=gl,b.aX=function(o,t,i,a,h){var m,g=1/Math.tan(t/2);return o[0]=g/i,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=g,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,h!=null&&h!==1/0?(o[10]=(h+a)*(m=1/(a-h)),o[14]=2*h*a*m):(o[10]=-1,o[14]=-2*a),o},b.aY=function(o){var t=new _t(16);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],t},b.aZ=function(o,t,i){var a=Math.sin(i),h=Math.cos(i),m=t[0],g=t[1],v=t[2],C=t[3],S=t[4],M=t[5],I=t[6],L=t[7];return t!==o&&(o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=m*h+S*a,o[1]=g*h+M*a,o[2]=v*h+I*a,o[3]=C*h+L*a,o[4]=S*h-m*a,o[5]=M*h-g*a,o[6]=I*h-v*a,o[7]=L*h-C*a,o},b.a_=function(o,t,i){var a=Math.sin(i),h=Math.cos(i),m=t[4],g=t[5],v=t[6],C=t[7],S=t[8],M=t[9],I=t[10],L=t[11];return t!==o&&(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[4]=m*h+S*a,o[5]=g*h+M*a,o[6]=v*h+I*a,o[7]=C*h+L*a,o[8]=S*h-m*a,o[9]=M*h-g*a,o[10]=I*h-v*a,o[11]=L*h-C*a,o},b.aa=function(o){return Math.log(o)/Math.LN2},b.ab=function(o){var t=o[0],i=o[1];return t*t+i*i},b.ac=function(o){return o*Math.PI/180},b.ad=Sr,b.ae=function(o,t){const i=[];for(const a in o)a in t||i.push(a);return i},b.af=function(o,t){let i=0,a=0;if(o.kind==="constant")a=o.layoutSize;else if(o.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:g}=o,v=h?Sr(Co.interpolationFactor(h,t,m,g),0,1):0;o.kind==="camera"?a=qo.number(o.minSize,o.maxSize,v):i=v}return{uSizeT:i,uSize:a}},b.ah=function(o,{uSize:t,uSizeT:i},{lowerSize:a,upperSize:h}){return o.kind==="source"?a/an:o.kind==="composite"?qo.number(a/an,h/an,i):t},b.ai=function(o,t){var i=t[0],a=t[1],h=t[2],m=t[3],g=t[4],v=t[5],C=t[6],S=t[7],M=t[8],I=t[9],L=t[10],F=t[11],O=t[12],j=t[13],W=t[14],ee=t[15],de=i*v-a*g,oe=i*C-h*g,B=i*S-m*g,q=a*C-h*v,ie=a*S-m*v,xe=h*S-m*C,Oe=M*j-I*O,Se=M*W-L*O,Ie=M*ee-F*O,Ze=I*W-L*j,je=I*ee-F*j,We=L*ee-F*W,Le=de*We-oe*je+B*Ze+q*Ie-ie*Se+xe*Oe;return Le?(o[0]=(v*We-C*je+S*Ze)*(Le=1/Le),o[1]=(h*je-a*We-m*Ze)*Le,o[2]=(j*xe-W*ie+ee*q)*Le,o[3]=(L*ie-I*xe-F*q)*Le,o[4]=(C*Ie-g*We-S*Se)*Le,o[5]=(i*We-h*Ie+m*Se)*Le,o[6]=(W*B-O*xe-ee*oe)*Le,o[7]=(M*xe-L*B+F*oe)*Le,o[8]=(g*je-v*Ie+S*Oe)*Le,o[9]=(a*Ie-i*je-m*Oe)*Le,o[10]=(O*ie-j*B+ee*de)*Le,o[11]=(I*B-M*ie-F*de)*Le,o[12]=(v*Se-g*Ze-C*Oe)*Le,o[13]=(i*Ze-a*Se+h*Oe)*Le,o[14]=(j*oe-O*q-W*de)*Le,o[15]=(M*q-I*oe+L*de)*Le,o):null},b.aj=et,b.ak=function(o){return Math.hypot(o[0],o[1])},b.al=function(o){return o[0]=0,o[1]=0,o},b.am=function(o,t,i){return o[0]=t[0]*i,o[1]=t[1]*i,o},b.an=$f,b.ao=De,b.ap=function(o,t,i,a){const h=t.y-o.y,m=t.x-o.x,g=a.y-i.y,v=a.x-i.x,C=g*m-v*h;if(C===0)return null;const S=(v*(o.y-i.y)-g*(o.x-i.x))/C;return new se(o.x+S*m,o.y+S*h)},b.aq=Eg,b.ar=ll,b.as=Je,b.at=function(o){let t=1/0,i=1/0,a=-1/0,h=-1/0;for(const m of o)t=Math.min(t,m.x),i=Math.min(i,m.y),a=Math.max(a,m.x),h=Math.max(h,m.y);return[t,i,a,h]},b.au=Jr,b.av=wt,b.aw=function(o,t,i,a,h=!1){if(!i[0]&&!i[1])return[0,0];const m=h?a==="map"?-o.bearingInRadians:0:a==="viewport"?o.bearingInRadians:0;if(m){const g=Math.sin(m),v=Math.cos(m);i=[i[0]*v-i[1]*g,i[0]*g+i[1]*v]}return[h?i[0]:wt(t,i[0],o.zoom),h?i[1]:wt(t,i[1],o.zoom)]},b.ay=Of,b.az=Wf,b.b=qe,b.b$=o=>o.type==="circle",b.b0=function(){const o=new Float64Array(16);return Je(o),o},b.b1=function(){return new Float64Array(16)},b.b2=function(o,t,i){const a=new Float64Array(4);return function(h,m,g,v){var C=.5*Math.PI/180;m*=C,g*=C,v*=C;var S=Math.sin(m),M=Math.cos(m),I=Math.sin(g),L=Math.cos(g),F=Math.sin(v),O=Math.cos(v);h[0]=S*L*O-M*I*F,h[1]=M*I*O+S*L*F,h[2]=M*L*F-S*I*O,h[3]=M*L*O+S*I*F}(a,o,t-90,i),a},b.b3=function(o,t,i,a){var h,m,g,v,C,S=t[0],M=t[1],I=t[2],L=t[3],F=i[0],O=i[1],j=i[2],W=i[3];return(m=S*F+M*O+I*j+L*W)<0&&(m=-m,F=-F,O=-O,j=-j,W=-W),1-m>dt?(h=Math.acos(m),g=Math.sin(h),v=Math.sin((1-a)*h)/g,C=Math.sin(a*h)/g):(v=1-a,C=a),o[0]=v*S+C*F,o[1]=v*M+C*O,o[2]=v*I+C*j,o[3]=v*L+C*W,o},b.b4=function(o){const t=new Float64Array(9);var i,a,h,m,g,v,C,S,M,I,L,F,O,j,W,ee,de,oe;I=(h=(a=o)[0])*(C=h+h),L=(m=a[1])*C,O=(g=a[2])*C,j=g*(S=m+m),ee=(v=a[3])*C,de=v*S,oe=v*(M=g+g),(i=t)[0]=1-(F=m*S)-(W=g*M),i[3]=L-oe,i[6]=O+de,i[1]=L+oe,i[4]=1-I-W,i[7]=j-ee,i[2]=O-de,i[5]=j+ee,i[8]=1-I-F;const B=Ue(-Math.asin(Sr(t[2],-1,1)));let q,ie;return Math.hypot(t[5],t[8])<.001?(q=0,ie=-Ue(Math.atan2(t[3],t[4]))):(q=Ue(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),ie=Ue(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:q,pitch:B+90,bearing:ie}},b.b5=function(o,t){return o.roll==t.roll&&o.pitch==t.pitch&&o.bearing==t.bearing},b.b6=Kt,b.b7=An,b.b8=fl,b.b9=Vc,b.bA=function(o){const t=[],i=o.id;return i===void 0&&t.push({message:`layers.${i}: missing required property "id"`}),o.render===void 0&&t.push({message:`layers.${i}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},b.bB=function o(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(let a=0;a<t.length;a++)if(!o(t[a],i[a]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(const a in t)if(!o(t[a],i[a]))return!1;return!0}return t===i},b.bC=bo,b.bD=Uo,b.bE=class extends di{constructor(o,t){super(o,t),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},b.bF=zn,b.bG=class extends di{constructor(o,t){super(o,t),this.current=fi}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let t=1;t<16;t++)if(o[t]!==this.current[t]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},b.bH=Qs,b.bI=class extends di{constructor(o,t){super(o,t),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},b.bJ=class extends di{constructor(o,t){super(o,t),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},b.bK=nt,b.bL=function(o,t){var i=Math.sin(t),a=Math.cos(t);return o[0]=a,o[1]=i,o[2]=0,o[3]=-i,o[4]=a,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},b.bM=function(o,t,i){var a=t[0],h=t[1],m=t[2];return o[0]=a*i[0]+h*i[3]+m*i[6],o[1]=a*i[1]+h*i[4]+m*i[7],o[2]=a*i[2]+h*i[5]+m*i[8],o},b.bN=function(o,t,i,a,h,m,g){var v=1/(t-i),C=1/(a-h),S=1/(m-g);return o[0]=-2*v,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*C,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*S,o[11]=0,o[12]=(t+i)*v,o[13]=(h+a)*C,o[14]=(g+m)*S,o[15]=1,o},b.bO=class extends ol{},b.bP=ub,b.bQ=class extends il{},b.bR=vf,b.bS=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},b.bT=Sm,b.bU=function(o,t,i){var a=t[0],h=t[1],m=t[2],g=i[3]*a+i[7]*h+i[11]*m+i[15];return o[0]=(i[0]*a+i[4]*h+i[8]*m+i[12])/(g=g||1),o[1]=(i[1]*a+i[5]*h+i[9]*m+i[13])/g,o[2]=(i[2]*a+i[6]*h+i[10]*m+i[14])/g,o},b.bV=class extends Ec{},b.bW=class extends l{},b.bX=function(o,t){return o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]&&o[3]===t[3]&&o[4]===t[4]&&o[5]===t[5]&&o[6]===t[6]&&o[7]===t[7]&&o[8]===t[8]&&o[9]===t[9]&&o[10]===t[10]&&o[11]===t[11]&&o[12]===t[12]&&o[13]===t[13]&&o[14]===t[14]&&o[15]===t[15]},b.bY=function(o,t){var i=o[0],a=o[1],h=o[2],m=o[3],g=o[4],v=o[5],C=o[6],S=o[7],M=o[8],I=o[9],L=o[10],F=o[11],O=o[12],j=o[13],W=o[14],ee=o[15],de=t[0],oe=t[1],B=t[2],q=t[3],ie=t[4],xe=t[5],Oe=t[6],Se=t[7],Ie=t[8],Ze=t[9],je=t[10],We=t[11],Le=t[12],ut=t[13],kt=t[14],St=t[15];return Math.abs(i-de)<=dt*Math.max(1,Math.abs(i),Math.abs(de))&&Math.abs(a-oe)<=dt*Math.max(1,Math.abs(a),Math.abs(oe))&&Math.abs(h-B)<=dt*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(m-q)<=dt*Math.max(1,Math.abs(m),Math.abs(q))&&Math.abs(g-ie)<=dt*Math.max(1,Math.abs(g),Math.abs(ie))&&Math.abs(v-xe)<=dt*Math.max(1,Math.abs(v),Math.abs(xe))&&Math.abs(C-Oe)<=dt*Math.max(1,Math.abs(C),Math.abs(Oe))&&Math.abs(S-Se)<=dt*Math.max(1,Math.abs(S),Math.abs(Se))&&Math.abs(M-Ie)<=dt*Math.max(1,Math.abs(M),Math.abs(Ie))&&Math.abs(I-Ze)<=dt*Math.max(1,Math.abs(I),Math.abs(Ze))&&Math.abs(L-je)<=dt*Math.max(1,Math.abs(L),Math.abs(je))&&Math.abs(F-We)<=dt*Math.max(1,Math.abs(F),Math.abs(We))&&Math.abs(O-Le)<=dt*Math.max(1,Math.abs(O),Math.abs(Le))&&Math.abs(j-ut)<=dt*Math.max(1,Math.abs(j),Math.abs(ut))&&Math.abs(W-kt)<=dt*Math.max(1,Math.abs(W),Math.abs(kt))&&Math.abs(ee-St)<=dt*Math.max(1,Math.abs(ee),Math.abs(St))},b.bZ=function(o,t){return o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},b.b_=o=>o.type==="symbol",b.ba=dl,b.bb=sr,b.bc=cr,b.bd=Do,b.be=function(o,t,i,a,h){return sr(a,h,Sr((o-t)/(i-t),0,1))},b.bf=Et,b.bg=function(){return new Float64Array(4)},b.bh=function(){return new Float64Array(3)},b.bi=function(o,t,i,a){var h=[],m=[];return h[0]=t[0]-i[0],h[1]=t[1]-i[1],h[2]=t[2]-i[2],m[0]=h[0]*Math.cos(a)-h[1]*Math.sin(a),m[1]=h[0]*Math.sin(a)+h[1]*Math.cos(a),m[2]=h[2],o[0]=m[0]+i[0],o[1]=m[1]+i[1],o[2]=m[2]+i[2],o},b.bj=function(o,t,i,a){var h=[],m=[];return h[0]=t[0]-i[0],h[1]=t[1]-i[1],h[2]=t[2]-i[2],m[0]=h[0],m[1]=h[1]*Math.cos(a)-h[2]*Math.sin(a),m[2]=h[1]*Math.sin(a)+h[2]*Math.cos(a),o[0]=m[0]+i[0],o[1]=m[1]+i[1],o[2]=m[2]+i[2],o},b.bk=function(o,t,i,a){var h=[],m=[];return h[0]=t[0]-i[0],h[1]=t[1]-i[1],h[2]=t[2]-i[2],m[0]=h[2]*Math.sin(a)+h[0]*Math.cos(a),m[1]=h[1],m[2]=h[2]*Math.cos(a)-h[0]*Math.sin(a),o[0]=m[0]+i[0],o[1]=m[1]+i[1],o[2]=m[2]+i[2],o},b.bl=function(o,t,i){var a=Math.sin(i),h=Math.cos(i),m=t[0],g=t[1],v=t[2],C=t[3],S=t[8],M=t[9],I=t[10],L=t[11];return t!==o&&(o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=m*h-S*a,o[1]=g*h-M*a,o[2]=v*h-I*a,o[3]=C*h-L*a,o[8]=m*a+S*h,o[9]=g*a+M*h,o[10]=v*a+I*h,o[11]=C*a+L*h,o},b.bm=function(o,t){const i=Et(o,360),a=Et(t,360),h=a-i,m=a>i?h-360:h+360;return Math.abs(h)<Math.abs(m)?h:m},b.bn=function(o){return o[0]=0,o[1]=0,o[2]=0,o},b.bo=function(o,t,i,a){const h=Math.sqrt(o*o+t*t),m=Math.sqrt(i*i+a*a);o/=h,t/=h,i/=m,a/=m;const g=Math.acos(o*i+t*a);return-t*i+o*a>0?g:-g},b.bp=function(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]+o[3]},b.bq=Uf,b.br=function(o,t){const i=Et(o,2*Math.PI),a=Et(t,2*Math.PI);return Math.min(Math.abs(i-a),Math.abs(i-a+2*Math.PI),Math.abs(i-a-2*Math.PI))},b.bs=function(o){return Math.hypot(o[0],o[1],o[2])},b.bt=function(){const o={},t=A.$version;for(const i in A.$root){const a=A.$root[i];if(a.required){let h=null;h=i==="version"?t:a.type==="array"?[]:{},h!=null&&(o[i]=h)}}return o},b.bu=Ha,b.bv=Ut,b.bw=function(o){o=o.slice();const t=Object.create(null);for(let i=0;i<o.length;i++)t[o[i].id]=o[i];for(let i=0;i<o.length;i++)"ref"in o[i]&&(o[i]=X(o[i],t[o[i].ref]));return o},b.bx=function(o){if(o.type==="custom")return new Db(o);switch(o.type){case"background":return new Eb(o);case"circle":return new Sv(o);case"fill":return new Zv(o);case"fill-extrusion":return new Jv(o);case"heatmap":return new Pv(o);case"hillshade":return new Iv(o);case"line":return new sb(o);case"raster":return new zb(o);case"symbol":return new Zh(o)}},b.by=ro,b.bz=function(o,t){if(!o)return[{command:"setStyle",args:[t]}];let i=[];try{if(!te(o.version,t.version))return[{command:"setStyle",args:[t]}];te(o.center,t.center)||i.push({command:"setCenter",args:[t.center]}),te(o.centerAltitude,t.centerAltitude)||i.push({command:"setCenterAltitude",args:[t.centerAltitude]}),te(o.zoom,t.zoom)||i.push({command:"setZoom",args:[t.zoom]}),te(o.bearing,t.bearing)||i.push({command:"setBearing",args:[t.bearing]}),te(o.pitch,t.pitch)||i.push({command:"setPitch",args:[t.pitch]}),te(o.roll,t.roll)||i.push({command:"setRoll",args:[t.roll]}),te(o.sprite,t.sprite)||i.push({command:"setSprite",args:[t.sprite]}),te(o.glyphs,t.glyphs)||i.push({command:"setGlyphs",args:[t.glyphs]}),te(o.transition,t.transition)||i.push({command:"setTransition",args:[t.transition]}),te(o.light,t.light)||i.push({command:"setLight",args:[t.light]}),te(o.terrain,t.terrain)||i.push({command:"setTerrain",args:[t.terrain]}),te(o.sky,t.sky)||i.push({command:"setSky",args:[t.sky]}),te(o.projection,t.projection)||i.push({command:"setProjection",args:[t.projection]});const a={},h=[];(function(g,v,C,S){let M;for(M in v=v||{},g=g||{})Object.prototype.hasOwnProperty.call(g,M)&&(Object.prototype.hasOwnProperty.call(v,M)||Ce(M,C,S));for(M in v)Object.prototype.hasOwnProperty.call(v,M)&&(Object.prototype.hasOwnProperty.call(g,M)?te(g[M],v[M])||(g[M].type==="geojson"&&v[M].type==="geojson"&&ze(g,v,M)?ce(C,{command:"setGeoJSONSourceData",args:[M,v[M].data]}):me(M,v,C,S)):_e(M,v,C))})(o.sources,t.sources,h,a);const m=[];o.layers&&o.layers.forEach(g=>{"source"in g&&a[g.source]?i.push({command:"removeLayer",args:[g.id]}):m.push(g)}),i=i.concat(h),function(g,v,C){v=v||[];const S=(g=g||[]).map(ye),M=v.map(ye),I=g.reduce(Fe,{}),L=v.reduce(Fe,{}),F=S.slice(),O=Object.create(null);let j,W,ee,de,oe;for(let B=0,q=0;B<S.length;B++)j=S[B],Object.prototype.hasOwnProperty.call(L,j)?q++:(ce(C,{command:"removeLayer",args:[j]}),F.splice(F.indexOf(j,q),1));for(let B=0,q=0;B<M.length;B++)j=M[M.length-1-B],F[F.length-1-B]!==j&&(Object.prototype.hasOwnProperty.call(I,j)?(ce(C,{command:"removeLayer",args:[j]}),F.splice(F.lastIndexOf(j,F.length-q),1)):q++,de=F[F.length-B],ce(C,{command:"addLayer",args:[L[j],de]}),F.splice(F.length-B,0,j),O[j]=!0);for(let B=0;B<M.length;B++)if(j=M[B],W=I[j],ee=L[j],!O[j]&&!te(W,ee))if(te(W.source,ee.source)&&te(W["source-layer"],ee["source-layer"])&&te(W.type,ee.type)){for(oe in Pe(W.layout,ee.layout,C,j,null,"setLayoutProperty"),Pe(W.paint,ee.paint,C,j,null,"setPaintProperty"),te(W.filter,ee.filter)||ce(C,{command:"setFilter",args:[j,ee.filter]}),te(W.minzoom,ee.minzoom)&&te(W.maxzoom,ee.maxzoom)||ce(C,{command:"setLayerZoomRange",args:[j,ee.minzoom,ee.maxzoom]}),W)Object.prototype.hasOwnProperty.call(W,oe)&&oe!=="layout"&&oe!=="paint"&&oe!=="filter"&&oe!=="metadata"&&oe!=="minzoom"&&oe!=="maxzoom"&&(oe.indexOf("paint.")===0?Pe(W[oe],ee[oe],C,j,oe.slice(6),"setPaintProperty"):te(W[oe],ee[oe])||ce(C,{command:"setLayerProperty",args:[j,oe,ee[oe]]}));for(oe in ee)Object.prototype.hasOwnProperty.call(ee,oe)&&!Object.prototype.hasOwnProperty.call(W,oe)&&oe!=="layout"&&oe!=="paint"&&oe!=="filter"&&oe!=="metadata"&&oe!=="minzoom"&&oe!=="maxzoom"&&(oe.indexOf("paint.")===0?Pe(W[oe],ee[oe],C,j,oe.slice(6),"setPaintProperty"):te(W[oe],ee[oe])||ce(C,{command:"setLayerProperty",args:[j,oe,ee[oe]]}))}else ce(C,{command:"removeLayer",args:[j]}),de=F[F.lastIndexOf(j)+1],ce(C,{command:"addLayer",args:[ee,de]})}(m,t.layers,i)}catch(a){console.warn("Unable to compute style diff:",a),i=[{command:"setStyle",args:[t]}]}return i},b.c=at,b.c0=o=>o.type==="heatmap",b.c1=o=>o.type==="line",b.c2=o=>o.type==="fill",b.c3=o=>o.type==="fill-extrusion",b.c4=o=>o.type==="hillshade",b.c5=o=>o.type==="raster",b.c6=o=>o.type==="background",b.c7=o=>o.type==="custom",b.c8=or,b.c9=function(o,t,i){const a=Dt(t.x-i.x,t.y-i.y),h=Dt(o.x-i.x,o.y-i.y);var m,g;return Ue(Math.atan2(a[0]*h[1]-a[1]*h[0],(m=a)[0]*(g=h)[0]+m[1]*g[1]))},b.cA=H,b.cB=Vm,b.cC=eg,b.cD=Sn,b.cE=nn,b.ca=qt,b.cb=function(o,t,i){var a=t[0],h=t[1];return o[0]=i[0]*a+i[4]*h+i[12],o[1]=i[1]*a+i[5]*h+i[13],o},b.cc=function(o,t){const{x:i,y:a}=Yc.fromLngLat(t);return!(o<0||o>25||a<0||a>=1||i<0||i>=1)},b.cd=function(o,t){return o[0]=t[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=t[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=t[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},b.ce=class extends el{},b.cf=Zb,b.ch=function(o){return o.message===Pt},b.ci=Ht,b.cj=function(o,t){Ct.REGISTERED_PROTOCOLS[o]=t},b.ck=function(o){delete Ct.REGISTERED_PROTOCOLS[o]},b.cl=function(o,t){const i={};for(let h=0;h<o.length;h++){const m=t&&t[o[h].id]||fc(o[h]);t&&(t[o[h].id]=m);let g=i[m];g||(g=i[m]=[]),g.push(o[h])}const a=[];for(const h in i)a.push(i[h]);return a},b.cm=ct,b.cn=Sg,b.co=Pg,b.cp=rg,b.cq=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=ft/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;const t=o.bucket.layers[0],i=t.layout,a=t._unevaluatedLayout._values,h={layoutIconSize:a["icon-size"].possiblyEvaluate(new wr(o.bucket.zoom+1),o.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new wr(o.bucket.zoom+1),o.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new wr(18))};if(o.bucket.textSizeData.kind==="composite"){const{minZoom:S,maxZoom:M}=o.bucket.textSizeData;h.compositeTextSizes=[a["text-size"].possiblyEvaluate(new wr(S),o.canonical),a["text-size"].possiblyEvaluate(new wr(M),o.canonical)]}if(o.bucket.iconSizeData.kind==="composite"){const{minZoom:S,maxZoom:M}=o.bucket.iconSizeData;h.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new wr(S),o.canonical),a["icon-size"].possiblyEvaluate(new wr(M),o.canonical)]}const m=i.get("text-line-height")*Jr,g=i.get("text-rotation-alignment")!=="viewport"&&i.get("symbol-placement")!=="point",v=i.get("text-keep-upright"),C=i.get("text-size");for(const S of o.bucket.features){const M=i.get("text-font").evaluate(S,{},o.canonical).join(","),I=C.evaluate(S,{},o.canonical),L=h.layoutTextSize.evaluate(S,{},o.canonical),F=h.layoutIconSize.evaluate(S,{},o.canonical),O={horizontal:{},vertical:void 0},j=S.text;let W,ee=[0,0];if(j){const B=j.toString(),q=i.get("text-letter-spacing").evaluate(S,{},o.canonical)*Jr,ie=Ch(B)?q:0,xe=i.get("text-anchor").evaluate(S,{},o.canonical),Oe=$g(t,S,o.canonical);if(!Oe){const je=i.get("text-radial-offset").evaluate(S,{},o.canonical);ee=je?Og(xe,[je*Jr,qf]):i.get("text-offset").evaluate(S,{},o.canonical).map(We=>We*Jr)}let Se=g?"center":i.get("text-justify").evaluate(S,{},o.canonical);const Ie=i.get("symbol-placement")==="point"?i.get("text-max-width").evaluate(S,{},o.canonical)*Jr:1/0,Ze=()=>{o.bucket.allowVerticalPlacement&&Xa(B)&&(O.vertical=Nh(j,o.glyphMap,o.glyphPositions,o.imagePositions,M,Ie,m,xe,"left",ie,ee,b.ag.vertical,!0,L,I))};if(!g&&Oe){const je=new Set;if(Se==="auto")for(let Le=0;Le<Oe.values.length;Le+=2)je.add(Wf(Oe.values[Le]));else je.add(Se);let We=!1;for(const Le of je)if(!O.horizontal[Le])if(We)O.horizontal[Le]=O.horizontal[0];else{const ut=Nh(j,o.glyphMap,o.glyphPositions,o.imagePositions,M,Ie,m,"center",Le,ie,ee,b.ag.horizontal,!1,L,I);ut&&(O.horizontal[Le]=ut,We=ut.positionedLines.length===1)}Ze()}else{Se==="auto"&&(Se=Wf(xe));const je=Nh(j,o.glyphMap,o.glyphPositions,o.imagePositions,M,Ie,m,xe,Se,ie,ee,b.ag.horizontal,!1,L,I);je&&(O.horizontal[Se]=je),Ze(),Xa(B)&&g&&v&&(O.vertical=Nh(j,o.glyphMap,o.glyphPositions,o.imagePositions,M,Ie,m,xe,Se,ie,ee,b.ag.vertical,!1,L,I))}}let de=!1;if(S.icon&&S.icon.name){const B=o.imageMap[S.icon.name];B&&(W=Sb(o.imagePositions[S.icon.name],i.get("icon-offset").evaluate(S,{},o.canonical),i.get("icon-anchor").evaluate(S,{},o.canonical)),de=!!B.sdf,o.bucket.sdfIcons===void 0?o.bucket.sdfIcons=de:o.bucket.sdfIcons!==de&&Wr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(B.pixelRatio!==o.bucket.pixelRatio||i.get("icon-rotate").constantOr(1)!==0)&&(o.bucket.iconsNeedLinear=!0))}const oe=Ng(O.horizontal)||O.vertical;o.bucket.iconsInText=!!oe&&oe.iconsInText,(oe||W)&&Vb(o.bucket,S,O,W,o.imageMap,h,L,F,ee,de,o.canonical,o.subdivisionGranularity)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},b.cr=Ef,b.cs=Tf,b.ct=If,b.cu=Zc,b.cv=Df,b.cw=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return o.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},b.cx=function(o,t,i,a,h){return c(this,void 0,void 0,function*(){if(Te())try{return yield Ve(o,t,i,a,h)}catch{}return function(m,g,v,C,S){const M=m.width,I=m.height;it&&ot||(it=new OffscreenCanvas(M,I),ot=it.getContext("2d",{willReadFrequently:!0})),it.width=M,it.height=I,ot.drawImage(m,0,0,M,I);const L=ot.getImageData(g,v,C,S);return ot.clearRect(0,0,M,I),L.data}(o,t,i,a,h)})},b.cy=Tg,b.cz=z,b.d=Ir,b.e=br,b.f=o=>c(void 0,void 0,void 0,function*(){if(o.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(o)],{type:"image/png"});try{return createImageBitmap(t)}catch(i){throw new Error(`Could not load image because of ${i.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),b.g=Rt,b.h=o=>new Promise((t,i)=>{const a=new Image;a.onload=()=>{t(a),URL.revokeObjectURL(a.src),a.onload=null,window.requestAnimationFrame(()=>{a.src=Ne})},a.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(o)],{type:"image/png"});a.src=o.byteLength?URL.createObjectURL(h):Ne}),b.i=pe,b.j=(o,t)=>Br(br(o,{type:"json"}),t),b.k=oi,b.l=_i,b.m=Br,b.n=(o,t)=>Br(br(o,{type:"arrayBuffer"}),t),b.o=function(o){return new Df(o).readFields(fb,[])},b.p=tg,b.q=Fc,b.r=Bo,b.s=Qe,b.t=qs,b.u=Nt,b.v=A,b.w=Wr,b.x=Wa,b.y=ls,b.z=function([o,t,i]){return t+=90,t*=Math.PI/180,i*=Math.PI/180,{x:o*Math.cos(t)*Math.sin(i),y:o*Math.sin(t)*Math.sin(i),z:o*Math.cos(i)}}}),x("worker",["./shared"],function(b){class c{constructor(A){this.keyCache={},A&&this.replace(A)}replace(A){this._layerConfigs={},this._layers={},this.update(A,[])}update(A,Z){for(const te of A){this._layerConfigs[te.id]=te;const ce=this._layers[te.id]=b.bx(te);ce._featureFilter=b.a6(ce.filter),this.keyCache[te.id]&&delete this.keyCache[te.id]}for(const te of Z)delete this.keyCache[te],delete this._layerConfigs[te],delete this._layers[te];this.familiesBySource={};const X=b.cl(Object.values(this._layerConfigs),this.keyCache);for(const te of X){const ce=te.map(ye=>this._layers[ye.id]),_e=ce[0];if(_e.visibility==="none")continue;const Ce=_e.source||"";let me=this.familiesBySource[Ce];me||(me=this.familiesBySource[Ce]={});const ze=_e.sourceLayer||"_geojsonTileLayer";let Pe=me[ze];Pe||(Pe=me[ze]=[]),Pe.push(ce)}}}class z{constructor(A){const Z={},X=[];for(const Ce in A){const me=A[Ce],ze=Z[Ce]={};for(const Pe in me){const ye=me[+Pe];if(!ye||ye.bitmap.width===0||ye.bitmap.height===0)continue;const Fe={x:0,y:0,w:ye.bitmap.width+2,h:ye.bitmap.height+2};X.push(Fe),ze[Pe]={rect:Fe,metrics:ye.metrics}}}const{w:te,h:ce}=b.p(X),_e=new b.q({width:te||1,height:ce||1});for(const Ce in A){const me=A[Ce];for(const ze in me){const Pe=me[+ze];if(!Pe||Pe.bitmap.width===0||Pe.bitmap.height===0)continue;const ye=Z[Ce][ze].rect;b.q.copy(Pe.bitmap,_e,{x:0,y:0},{x:ye.x+1,y:ye.y+1},Pe.bitmap)}}this.image=_e,this.positions=Z}}b.cm("GlyphAtlas",z);class U{constructor(A){this.tileID=new b.Y(A.tileID.overscaledZ,A.tileID.wrap,A.tileID.canonical.z,A.tileID.canonical.x,A.tileID.canonical.y),this.uid=A.uid,this.zoom=A.zoom,this.pixelRatio=A.pixelRatio,this.tileSize=A.tileSize,this.source=A.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=A.showCollisionBoxes,this.collectResourceTiming=!!A.collectResourceTiming,this.returnDependencies=!!A.returnDependencies,this.promoteId=A.promoteId,this.inFlightDependencies=[]}parse(A,Z,X,te,ce){return b._(this,void 0,void 0,function*(){this.status="parsing",this.data=A,this.collisionBoxArray=new b.a4;const _e=new b.cn(Object.keys(A.layers).sort()),Ce=new b.co(this.tileID,this.promoteId);Ce.bucketLayerIDs=[];const me={},ze={featureIndex:Ce,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:X,subdivisionGranularity:ce},Pe=Z.familiesBySource[this.source];for(const At in Pe){const jt=A.layers[At];if(!jt)continue;jt.version===1&&b.w(`Vector tile source "${this.source}" layer "${At}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Tt=_e.encode(At),mn=[];for(let Vr=0;Vr<jt.length;Vr++){const Hr=jt.feature(Vr),_r=Ce.getId(Hr,At);mn.push({feature:Hr,id:_r,index:Vr,sourceLayerIndex:Tt})}for(const Vr of Pe[At]){const Hr=Vr[0];Hr.source!==this.source&&b.w(`layer.source = ${Hr.source} does not equal this.source = ${this.source}`),Hr.minzoom&&this.zoom<Math.floor(Hr.minzoom)||Hr.maxzoom&&this.zoom>=Hr.maxzoom||Hr.visibility!=="none"&&(V(Vr,this.zoom,X),(me[Hr.id]=Hr.createBucket({index:Ce.bucketLayerIDs.length,layers:Vr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Tt,sourceID:this.source})).populate(mn,ze,this.tileID.canonical),Ce.bucketLayerIDs.push(Vr.map(_r=>_r.id)))}}const ye=b.bC(ze.glyphDependencies,At=>Object.keys(At).map(Number));this.inFlightDependencies.forEach(At=>At==null?void 0:At.abort()),this.inFlightDependencies=[];let Fe=Promise.resolve({});if(Object.keys(ye).length){const At=new AbortController;this.inFlightDependencies.push(At),Fe=te.sendAsync({type:"GG",data:{stacks:ye,source:this.source,tileID:this.tileID,type:"glyphs"}},At)}const ve=Object.keys(ze.iconDependencies);let tt=Promise.resolve({});if(ve.length){const At=new AbortController;this.inFlightDependencies.push(At),tt=te.sendAsync({type:"GI",data:{icons:ve,source:this.source,tileID:this.tileID,type:"icons"}},At)}const yt=Object.keys(ze.patternDependencies);let Lt=Promise.resolve({});if(yt.length){const At=new AbortController;this.inFlightDependencies.push(At),Lt=te.sendAsync({type:"GI",data:{icons:yt,source:this.source,tileID:this.tileID,type:"patterns"}},At)}const[It,Be,pt]=yield Promise.all([Fe,tt,Lt]),ht=new z(It),Ot=new b.cp(Be,pt);for(const At in me){const jt=me[At];jt instanceof b.a5?(V(jt.layers,this.zoom,X),b.cq({bucket:jt,glyphMap:It,glyphPositions:ht.positions,imageMap:Be,imagePositions:Ot.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ze.subdivisionGranularity})):jt.hasPattern&&(jt instanceof b.cr||jt instanceof b.cs||jt instanceof b.ct)&&(V(jt.layers,this.zoom,X),jt.addFeatures(ze,this.tileID.canonical,Ot.patternPositions))}return this.status="done",{buckets:Object.values(me).filter(At=>!At.isEmpty()),featureIndex:Ce,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ht.image,imageAtlas:Ot,glyphMap:this.returnDependencies?It:null,iconMap:this.returnDependencies?Be:null,glyphPositions:this.returnDependencies?ht.positions:null}})}}function V(ge,A,Z){const X=new b.C(A);for(const te of ge)te.recalculate(X,Z)}class H{constructor(A,Z,X){this.actor=A,this.layerIndex=Z,this.availableImages=X,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(A,Z){return b._(this,void 0,void 0,function*(){const X=yield b.n(A.request,Z);try{return{vectorTile:new b.cu.VectorTile(new b.cv(X.data)),rawData:X.data,cacheControl:X.cacheControl,expires:X.expires}}catch(te){const ce=new Uint8Array(X.data);let _e=`Unable to parse the tile at ${A.request.url}, `;throw _e+=ce[0]===31&&ce[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${te.message}`,new Error(_e)}})}loadTile(A){return b._(this,void 0,void 0,function*(){const Z=A.uid,X=!!(A&&A.request&&A.request.collectResourceTiming)&&new b.cw(A.request),te=new U(A);this.loading[Z]=te;const ce=new AbortController;te.abort=ce;try{const _e=yield this.loadVectorTile(A,ce);if(delete this.loading[Z],!_e)return null;const Ce=_e.rawData,me={};_e.expires&&(me.expires=_e.expires),_e.cacheControl&&(me.cacheControl=_e.cacheControl);const ze={};if(X){const ye=X.finish();ye&&(ze.resourceTiming=JSON.parse(JSON.stringify(ye)))}te.vectorTile=_e.vectorTile;const Pe=te.parse(_e.vectorTile,this.layerIndex,this.availableImages,this.actor,A.subdivisionGranularity);this.loaded[Z]=te,this.fetching[Z]={rawTileData:Ce,cacheControl:me,resourceTiming:ze};try{const ye=yield Pe;return b.e({rawTileData:Ce.slice(0)},ye,me,ze)}finally{delete this.fetching[Z]}}catch(_e){throw delete this.loading[Z],te.status="done",this.loaded[Z]=te,_e}})}reloadTile(A){return b._(this,void 0,void 0,function*(){const Z=A.uid;if(!this.loaded||!this.loaded[Z])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const X=this.loaded[Z];if(X.showCollisionBoxes=A.showCollisionBoxes,X.status==="parsing"){const te=yield X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,A.subdivisionGranularity);let ce;if(this.fetching[Z]){const{rawTileData:_e,cacheControl:Ce,resourceTiming:me}=this.fetching[Z];delete this.fetching[Z],ce=b.e({rawTileData:_e.slice(0)},te,Ce,me)}else ce=te;return ce}if(X.status==="done"&&X.vectorTile)return X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,A.subdivisionGranularity)})}abortTile(A){return b._(this,void 0,void 0,function*(){const Z=this.loading,X=A.uid;Z&&Z[X]&&Z[X].abort&&(Z[X].abort.abort(),delete Z[X])})}removeTile(A){return b._(this,void 0,void 0,function*(){this.loaded&&this.loaded[A.uid]&&delete this.loaded[A.uid]})}}class Q{constructor(){this.loaded={}}loadTile(A){return b._(this,void 0,void 0,function*(){const{uid:Z,encoding:X,rawImageData:te,redFactor:ce,greenFactor:_e,blueFactor:Ce,baseShift:me}=A,ze=te.width+2,Pe=te.height+2,ye=b.b(te)?new b.R({width:ze,height:Pe},yield b.cx(te,-1,-1,ze,Pe)):te,Fe=new b.cy(Z,ye,X,ce,_e,Ce,me);return this.loaded=this.loaded||{},this.loaded[Z]=Fe,Fe})}removeTile(A){const Z=this.loaded,X=A.uid;Z&&Z[X]&&delete Z[X]}}var G,se,Me=function(){if(se)return G;function ge(Z,X){if(Z.length!==0){A(Z[0],X);for(var te=1;te<Z.length;te++)A(Z[te],!X)}}function A(Z,X){for(var te=0,ce=0,_e=0,Ce=Z.length,me=Ce-1;_e<Ce;me=_e++){var ze=(Z[_e][0]-Z[me][0])*(Z[me][1]+Z[_e][1]),Pe=te+ze;ce+=Math.abs(te)>=Math.abs(ze)?te-Pe+ze:ze-Pe+te,te=Pe}te+ce>=0!=!!X&&Z.reverse()}return se=1,G=function Z(X,te){var ce,_e=X&&X.type;if(_e==="FeatureCollection")for(ce=0;ce<X.features.length;ce++)Z(X.features[ce],te);else if(_e==="GeometryCollection")for(ce=0;ce<X.geometries.length;ce++)Z(X.geometries[ce],te);else if(_e==="Feature")Z(X.geometry,te);else if(_e==="Polygon")ge(X.coordinates,te);else if(_e==="MultiPolygon")for(ce=0;ce<X.coordinates.length;ce++)ge(X.coordinates[ce],te);return X}}(),rt=b.cz(Me);const He=b.cu.VectorTileFeature.prototype.toGeoJSON;class lt{constructor(A){this._feature=A,this.extent=b.Z,this.type=A.type,this.properties=A.tags,"id"in A&&!isNaN(A.id)&&(this.id=parseInt(A.id,10))}loadGeometry(){if(this._feature.type===1){const A=[];for(const Z of this._feature.geometry)A.push([new b.P(Z[0],Z[1])]);return A}{const A=[];for(const Z of this._feature.geometry){const X=[];for(const te of Z)X.push(new b.P(te[0],te[1]));A.push(X)}return A}}toGeoJSON(A,Z,X){return He.call(this,A,Z,X)}}class st{constructor(A){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=b.Z,this.length=A.length,this._features=A}feature(A){return new lt(this._features[A])}}var Te,Ye,dt,_t={exports:{}},nt=function(){if(dt)return _t.exports;dt=1;var ge=b.cC(),A=function(){if(Ye)return Te;Ye=1;var Pe=b.cA(),ye=b.cB().VectorTileFeature;function Fe(tt,yt){this.options=yt||{},this.features=tt,this.length=tt.length}function ve(tt,yt){this.id=typeof tt.id=="number"?tt.id:void 0,this.type=tt.type,this.rawGeometry=tt.type===1?[tt.geometry]:tt.geometry,this.properties=tt.tags,this.extent=yt||4096}return Te=Fe,Fe.prototype.feature=function(tt){return new ve(this.features[tt],this.options.extent)},ve.prototype.loadGeometry=function(){var tt=this.rawGeometry;this.geometry=[];for(var yt=0;yt<tt.length;yt++){for(var Lt=tt[yt],It=[],Be=0;Be<Lt.length;Be++)It.push(new Pe(Lt[Be][0],Lt[Be][1]));this.geometry.push(It)}return this.geometry},ve.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var tt=this.geometry,yt=1/0,Lt=-1/0,It=1/0,Be=-1/0,pt=0;pt<tt.length;pt++)for(var ht=tt[pt],Ot=0;Ot<ht.length;Ot++){var At=ht[Ot];yt=Math.min(yt,At.x),Lt=Math.max(Lt,At.x),It=Math.min(It,At.y),Be=Math.max(Be,At.y)}return[yt,It,Lt,Be]},ve.prototype.toGeoJSON=ye.prototype.toGeoJSON,Te}();function Z(Pe){var ye=new ge;return function(Fe,ve){for(var tt in Fe.layers)ve.writeMessage(3,X,Fe.layers[tt])}(Pe,ye),ye.finish()}function X(Pe,ye){var Fe;ye.writeVarintField(15,Pe.version||1),ye.writeStringField(1,Pe.name||""),ye.writeVarintField(5,Pe.extent||4096);var ve={keys:[],values:[],keycache:{},valuecache:{}};for(Fe=0;Fe<Pe.length;Fe++)ve.feature=Pe.feature(Fe),ye.writeMessage(2,te,ve);var tt=ve.keys;for(Fe=0;Fe<tt.length;Fe++)ye.writeStringField(3,tt[Fe]);var yt=ve.values;for(Fe=0;Fe<yt.length;Fe++)ye.writeMessage(4,ze,yt[Fe])}function te(Pe,ye){var Fe=Pe.feature;Fe.id!==void 0&&ye.writeVarintField(1,Fe.id),ye.writeMessage(2,ce,Pe),ye.writeVarintField(3,Fe.type),ye.writeMessage(4,me,Fe)}function ce(Pe,ye){var Fe=Pe.feature,ve=Pe.keys,tt=Pe.values,yt=Pe.keycache,Lt=Pe.valuecache;for(var It in Fe.properties){var Be=Fe.properties[It],pt=yt[It];if(Be!==null){pt===void 0&&(ve.push(It),yt[It]=pt=ve.length-1),ye.writeVarint(pt);var ht=typeof Be;ht!=="string"&&ht!=="boolean"&&ht!=="number"&&(Be=JSON.stringify(Be));var Ot=ht+":"+Be,At=Lt[Ot];At===void 0&&(tt.push(Be),Lt[Ot]=At=tt.length-1),ye.writeVarint(At)}}}function _e(Pe,ye){return(ye<<3)+(7&Pe)}function Ce(Pe){return Pe<<1^Pe>>31}function me(Pe,ye){for(var Fe=Pe.loadGeometry(),ve=Pe.type,tt=0,yt=0,Lt=Fe.length,It=0;It<Lt;It++){var Be=Fe[It],pt=1;ve===1&&(pt=Be.length),ye.writeVarint(_e(1,pt));for(var ht=ve===3?Be.length-1:Be.length,Ot=0;Ot<ht;Ot++){Ot===1&&ve!==1&&ye.writeVarint(_e(2,ht-1));var At=Be[Ot].x-tt,jt=Be[Ot].y-yt;ye.writeVarint(Ce(At)),ye.writeVarint(Ce(jt)),tt+=At,yt+=jt}ve===3&&ye.writeVarint(_e(7,1))}}function ze(Pe,ye){var Fe=typeof Pe;Fe==="string"?ye.writeStringField(1,Pe):Fe==="boolean"?ye.writeBooleanField(7,Pe):Fe==="number"&&(Pe%1!=0?ye.writeDoubleField(3,Pe):Pe<0?ye.writeSVarintField(6,Pe):ye.writeVarintField(5,Pe))}return _t.exports=Z,_t.exports.fromVectorTileJs=Z,_t.exports.fromGeojsonVt=function(Pe,ye){ye=ye||{};var Fe={};for(var ve in Pe)Fe[ve]=new A(Pe[ve].features,ye),Fe[ve].name=ve,Fe[ve].version=ye.version,Fe[ve].extent=ye.extent;return Z({layers:Fe})},_t.exports.GeoJSONWrapper=A,_t.exports}(),Je=b.cz(nt);const bt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ge=>ge},zt=Math.fround||(De=new Float32Array(1),ge=>(De[0]=+ge,De[0]));var De;const Ge=3,et=5,Dt=6;class ft{constructor(A){this.options=Object.assign(Object.create(bt),A),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(A){const{log:Z,minZoom:X,maxZoom:te}=this.options;Z&&console.time("total time");const ce=`prepare ${A.length} points`;Z&&console.time(ce),this.points=A;const _e=[];for(let me=0;me<A.length;me++){const ze=A[me];if(!ze.geometry)continue;const[Pe,ye]=ze.geometry.coordinates,Fe=zt(sr(Pe)),ve=zt(cr(ye));_e.push(Fe,ve,1/0,me,-1,1),this.options.reduce&&_e.push(0)}let Ce=this.trees[te+1]=this._createTree(_e);Z&&console.timeEnd(ce);for(let me=te;me>=X;me--){const ze=+Date.now();Ce=this.trees[me]=this._createTree(this._cluster(Ce,me)),Z&&console.log("z%d: %d clusters in %dms",me,Ce.numItems,+Date.now()-ze)}return Z&&console.timeEnd("total time"),this}getClusters(A,Z){let X=((A[0]+180)%360+360)%360-180;const te=Math.max(-90,Math.min(90,A[1]));let ce=A[2]===180?180:((A[2]+180)%360+360)%360-180;const _e=Math.max(-90,Math.min(90,A[3]));if(A[2]-A[0]>=360)X=-180,ce=180;else if(X>ce){const ye=this.getClusters([X,te,180,_e],Z),Fe=this.getClusters([-180,te,ce,_e],Z);return ye.concat(Fe)}const Ce=this.trees[this._limitZoom(Z)],me=Ce.range(sr(X),cr(_e),sr(ce),cr(te)),ze=Ce.data,Pe=[];for(const ye of me){const Fe=this.stride*ye;Pe.push(ze[Fe+et]>1?wt(ze,Fe,this.clusterProps):this.points[ze[Fe+Ge]])}return Pe}getChildren(A){const Z=this._getOriginId(A),X=this._getOriginZoom(A),te="No cluster with the specified id.",ce=this.trees[X];if(!ce)throw new Error(te);const _e=ce.data;if(Z*this.stride>=_e.length)throw new Error(te);const Ce=this.options.radius/(this.options.extent*Math.pow(2,X-1)),me=ce.within(_e[Z*this.stride],_e[Z*this.stride+1],Ce),ze=[];for(const Pe of me){const ye=Pe*this.stride;_e[ye+4]===A&&ze.push(_e[ye+et]>1?wt(_e,ye,this.clusterProps):this.points[_e[ye+Ge]])}if(ze.length===0)throw new Error(te);return ze}getLeaves(A,Z,X){const te=[];return this._appendLeaves(te,A,Z=Z||10,X=X||0,0),te}getTile(A,Z,X){const te=this.trees[this._limitZoom(A)],ce=Math.pow(2,A),{extent:_e,radius:Ce}=this.options,me=Ce/_e,ze=(X-me)/ce,Pe=(X+1+me)/ce,ye={features:[]};return this._addTileFeatures(te.range((Z-me)/ce,ze,(Z+1+me)/ce,Pe),te.data,Z,X,ce,ye),Z===0&&this._addTileFeatures(te.range(1-me/ce,ze,1,Pe),te.data,ce,X,ce,ye),Z===ce-1&&this._addTileFeatures(te.range(0,ze,me/ce,Pe),te.data,-1,X,ce,ye),ye.features.length?ye:null}getClusterExpansionZoom(A){let Z=this._getOriginZoom(A)-1;for(;Z<=this.options.maxZoom;){const X=this.getChildren(A);if(Z++,X.length!==1)break;A=X[0].properties.cluster_id}return Z}_appendLeaves(A,Z,X,te,ce){const _e=this.getChildren(Z);for(const Ce of _e){const me=Ce.properties;if(me&&me.cluster?ce+me.point_count<=te?ce+=me.point_count:ce=this._appendLeaves(A,me.cluster_id,X,te,ce):ce<te?ce++:A.push(Ce),A.length===X)break}return ce}_createTree(A){const Z=new b.aB(A.length/this.stride|0,this.options.nodeSize,Float32Array);for(let X=0;X<A.length;X+=this.stride)Z.add(A[X],A[X+1]);return Z.finish(),Z.data=A,Z}_addTileFeatures(A,Z,X,te,ce,_e){for(const Ce of A){const me=Ce*this.stride,ze=Z[me+et]>1;let Pe,ye,Fe;if(ze)Pe=Et(Z,me,this.clusterProps),ye=Z[me],Fe=Z[me+1];else{const yt=this.points[Z[me+Ge]];Pe=yt.properties;const[Lt,It]=yt.geometry.coordinates;ye=sr(Lt),Fe=cr(It)}const ve={type:1,geometry:[[Math.round(this.options.extent*(ye*ce-X)),Math.round(this.options.extent*(Fe*ce-te))]],tags:Pe};let tt;tt=ze||this.options.generateId?Z[me+Ge]:this.points[Z[me+Ge]].id,tt!==void 0&&(ve.id=tt),_e.features.push(ve)}}_limitZoom(A){return Math.max(this.options.minZoom,Math.min(Math.floor(+A),this.options.maxZoom+1))}_cluster(A,Z){const{radius:X,extent:te,reduce:ce,minPoints:_e}=this.options,Ce=X/(te*Math.pow(2,Z)),me=A.data,ze=[],Pe=this.stride;for(let ye=0;ye<me.length;ye+=Pe){if(me[ye+2]<=Z)continue;me[ye+2]=Z;const Fe=me[ye],ve=me[ye+1],tt=A.within(me[ye],me[ye+1],Ce),yt=me[ye+et];let Lt=yt;for(const It of tt){const Be=It*Pe;me[Be+2]>Z&&(Lt+=me[Be+et])}if(Lt>yt&&Lt>=_e){let It,Be=Fe*yt,pt=ve*yt,ht=-1;const Ot=((ye/Pe|0)<<5)+(Z+1)+this.points.length;for(const At of tt){const jt=At*Pe;if(me[jt+2]<=Z)continue;me[jt+2]=Z;const Tt=me[jt+et];Be+=me[jt]*Tt,pt+=me[jt+1]*Tt,me[jt+4]=Ot,ce&&(It||(It=this._map(me,ye,!0),ht=this.clusterProps.length,this.clusterProps.push(It)),ce(It,this._map(me,jt)))}me[ye+4]=Ot,ze.push(Be/Lt,pt/Lt,1/0,Ot,-1,Lt),ce&&ze.push(ht)}else{for(let It=0;It<Pe;It++)ze.push(me[ye+It]);if(Lt>1)for(const It of tt){const Be=It*Pe;if(!(me[Be+2]<=Z)){me[Be+2]=Z;for(let pt=0;pt<Pe;pt++)ze.push(me[Be+pt])}}}}return ze}_getOriginId(A){return A-this.points.length>>5}_getOriginZoom(A){return(A-this.points.length)%32}_map(A,Z,X){if(A[Z+et]>1){const _e=this.clusterProps[A[Z+Dt]];return X?Object.assign({},_e):_e}const te=this.points[A[Z+Ge]].properties,ce=this.options.map(te);return X&&ce===te?Object.assign({},ce):ce}}function wt(ge,A,Z){return{type:"Feature",id:ge[A+Ge],properties:Et(ge,A,Z),geometry:{type:"Point",coordinates:[(X=ge[A],360*(X-.5)),or(ge[A+1])]}};var X}function Et(ge,A,Z){const X=ge[A+et],te=X>=1e4?`${Math.round(X/1e3)}k`:X>=1e3?Math.round(X/100)/10+"k":X,ce=ge[A+Dt],_e=ce===-1?{}:Object.assign({},Z[ce]);return Object.assign(_e,{cluster:!0,cluster_id:ge[A+Ge],point_count:X,point_count_abbreviated:te})}function sr(ge){return ge/360+.5}function cr(ge){const A=Math.sin(ge*Math.PI/180),Z=.5-.25*Math.log((1+A)/(1-A))/Math.PI;return Z<0?0:Z>1?1:Z}function or(ge){const A=(180-360*ge)*Math.PI/180;return 360*Math.atan(Math.exp(A))/Math.PI-90}function qt(ge,A,Z,X){let te=X;const ce=A+(Z-A>>1);let _e,Ce=Z-A;const me=ge[A],ze=ge[A+1],Pe=ge[Z],ye=ge[Z+1];for(let Fe=A+3;Fe<Z;Fe+=3){const ve=Sr(ge[Fe],ge[Fe+1],me,ze,Pe,ye);if(ve>te)_e=Fe,te=ve;else if(ve===te){const tt=Math.abs(Fe-ce);tt<Ce&&(_e=Fe,Ce=tt)}}te>X&&(_e-A>3&&qt(ge,A,_e,X),ge[_e+2]=te,Z-_e>3&&qt(ge,_e,Z,X))}function Sr(ge,A,Z,X,te,ce){let _e=te-Z,Ce=ce-X;if(_e!==0||Ce!==0){const me=((ge-Z)*_e+(A-X)*Ce)/(_e*_e+Ce*Ce);me>1?(Z=te,X=ce):me>0&&(Z+=_e*me,X+=Ce*me)}return _e=ge-Z,Ce=A-X,_e*_e+Ce*Ce}function Mr(ge,A,Z,X){const te={id:ge??null,type:A,geometry:Z,tags:X,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(A==="Point"||A==="MultiPoint"||A==="LineString")br(te,Z);else if(A==="Polygon")br(te,Z[0]);else if(A==="MultiLineString")for(const ce of Z)br(te,ce);else if(A==="MultiPolygon")for(const ce of Z)br(te,ce[0]);return te}function br(ge,A){for(let Z=0;Z<A.length;Z+=3)ge.minX=Math.min(ge.minX,A[Z]),ge.minY=Math.min(ge.minY,A[Z+1]),ge.maxX=Math.max(ge.maxX,A[Z]),ge.maxY=Math.max(ge.maxY,A[Z+1])}function qr(ge,A,Z,X){if(!A.geometry)return;const te=A.geometry.coordinates;if(te&&te.length===0)return;const ce=A.geometry.type,_e=Math.pow(Z.tolerance/((1<<Z.maxZoom)*Z.extent),2);let Ce=[],me=A.id;if(Z.promoteId?me=A.properties[Z.promoteId]:Z.generateId&&(me=X||0),ce==="Point")bo(te,Ce);else if(ce==="MultiPoint")for(const ze of te)bo(ze,Ce);else if(ce==="LineString")Uo(te,Ce,_e,!1);else if(ce==="MultiLineString"){if(Z.lineMetrics){for(const ze of te)Ce=[],Uo(ze,Ce,_e,!1),ge.push(Mr(me,"LineString",Ce,A.properties));return}ro(te,Ce,_e,!1)}else if(ce==="Polygon")ro(te,Ce,_e,!0);else{if(ce!=="MultiPolygon"){if(ce==="GeometryCollection"){for(const ze of A.geometry.geometries)qr(ge,{id:me,geometry:ze,properties:A.properties},Z,X);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ze of te){const Pe=[];ro(ze,Pe,_e,!0),Ce.push(Pe)}}ge.push(Mr(me,ce,Ce,A.properties))}function bo(ge,A){A.push(Zo(ge[0]),Wr(ge[1]),0)}function Uo(ge,A,Z,X){let te,ce,_e=0;for(let me=0;me<ge.length;me++){const ze=Zo(ge[me][0]),Pe=Wr(ge[me][1]);A.push(ze,Pe,0),me>0&&(_e+=X?(te*Pe-ze*ce)/2:Math.sqrt(Math.pow(ze-te,2)+Math.pow(Pe-ce,2))),te=ze,ce=Pe}const Ce=A.length-3;A[2]=1,qt(A,0,Ce,Z),A[Ce+2]=1,A.size=Math.abs(_e),A.start=0,A.end=A.size}function ro(ge,A,Z,X){for(let te=0;te<ge.length;te++){const ce=[];Uo(ge[te],ce,Z,X),A.push(ce)}}function Zo(ge){return ge/360+.5}function Wr(ge){const A=Math.sin(ge*Math.PI/180),Z=.5-.25*Math.log((1+A)/(1-A))/Math.PI;return Z<0?0:Z>1?1:Z}function ae(ge,A,Z,X,te,ce,_e,Ce){if(X/=A,ce>=(Z/=A)&&_e<X)return ge;if(_e<Z||ce>=X)return null;const me=[];for(const ze of ge){const Pe=ze.geometry;let ye=ze.type;const Fe=te===0?ze.minX:ze.minY,ve=te===0?ze.maxX:ze.maxY;if(Fe>=Z&&ve<X){me.push(ze);continue}if(ve<Z||Fe>=X)continue;let tt=[];if(ye==="Point"||ye==="MultiPoint")pe(Pe,tt,Z,X,te);else if(ye==="LineString")ke(Pe,tt,Z,X,te,!1,Ce.lineMetrics);else if(ye==="MultiLineString")Ne(Pe,tt,Z,X,te,!1);else if(ye==="Polygon")Ne(Pe,tt,Z,X,te,!0);else if(ye==="MultiPolygon")for(const yt of Pe){const Lt=[];Ne(yt,Lt,Z,X,te,!0),Lt.length&&tt.push(Lt)}if(tt.length){if(Ce.lineMetrics&&ye==="LineString"){for(const yt of tt)me.push(Mr(ze.id,ye,yt,ze.tags));continue}ye!=="LineString"&&ye!=="MultiLineString"||(tt.length===1?(ye="LineString",tt=tt[0]):ye="MultiLineString"),ye!=="Point"&&ye!=="MultiPoint"||(ye=tt.length===3?"Point":"MultiPoint"),me.push(Mr(ze.id,ye,tt,ze.tags))}}return me.length?me:null}function pe(ge,A,Z,X,te){for(let ce=0;ce<ge.length;ce+=3){const _e=ge[ce+te];_e>=Z&&_e<=X&&Ve(A,ge[ce],ge[ce+1],ge[ce+2])}}function ke(ge,A,Z,X,te,ce,_e){let Ce=qe(ge);const me=te===0?it:ot;let ze,Pe,ye=ge.start;for(let Lt=0;Lt<ge.length-3;Lt+=3){const It=ge[Lt],Be=ge[Lt+1],pt=ge[Lt+2],ht=ge[Lt+3],Ot=ge[Lt+4],At=te===0?It:Be,jt=te===0?ht:Ot;let Tt=!1;_e&&(ze=Math.sqrt(Math.pow(It-ht,2)+Math.pow(Be-Ot,2))),At<Z?jt>Z&&(Pe=me(Ce,It,Be,ht,Ot,Z),_e&&(Ce.start=ye+ze*Pe)):At>X?jt<X&&(Pe=me(Ce,It,Be,ht,Ot,X),_e&&(Ce.start=ye+ze*Pe)):Ve(Ce,It,Be,pt),jt<Z&&At>=Z&&(Pe=me(Ce,It,Be,ht,Ot,Z),Tt=!0),jt>X&&At<=X&&(Pe=me(Ce,It,Be,ht,Ot,X),Tt=!0),!ce&&Tt&&(_e&&(Ce.end=ye+ze*Pe),A.push(Ce),Ce=qe(ge)),_e&&(ye+=ze)}let Fe=ge.length-3;const ve=ge[Fe],tt=ge[Fe+1],yt=te===0?ve:tt;yt>=Z&&yt<=X&&Ve(Ce,ve,tt,ge[Fe+2]),Fe=Ce.length-3,ce&&Fe>=3&&(Ce[Fe]!==Ce[0]||Ce[Fe+1]!==Ce[1])&&Ve(Ce,Ce[0],Ce[1],Ce[2]),Ce.length&&A.push(Ce)}function qe(ge){const A=[];return A.size=ge.size,A.start=ge.start,A.end=ge.end,A}function Ne(ge,A,Z,X,te,ce){for(const _e of ge)ke(_e,A,Z,X,te,ce,!1)}function Ve(ge,A,Z,X){ge.push(A,Z,X)}function it(ge,A,Z,X,te,ce){const _e=(ce-A)/(X-A);return Ve(ge,ce,Z+(te-Z)*_e,1),_e}function ot(ge,A,Z,X,te,ce){const _e=(ce-Z)/(te-Z);return Ve(ge,A+(X-A)*_e,ce,1),_e}function Qe(ge,A){const Z=[];for(let X=0;X<ge.length;X++){const te=ge[X],ce=te.type;let _e;if(ce==="Point"||ce==="MultiPoint"||ce==="LineString")_e=Ue(te.geometry,A);else if(ce==="MultiLineString"||ce==="Polygon"){_e=[];for(const Ce of te.geometry)_e.push(Ue(Ce,A))}else if(ce==="MultiPolygon"){_e=[];for(const Ce of te.geometry){const me=[];for(const ze of Ce)me.push(Ue(ze,A));_e.push(me)}}Z.push(Mr(te.id,ce,_e,te.tags))}return Z}function Ue(ge,A){const Z=[];Z.size=ge.size,ge.start!==void 0&&(Z.start=ge.start,Z.end=ge.end);for(let X=0;X<ge.length;X+=3)Z.push(ge[X]+A,ge[X+1],ge[X+2]);return Z}function Pt(ge,A){if(ge.transformed)return ge;const Z=1<<ge.z,X=ge.x,te=ge.y;for(const ce of ge.features){const _e=ce.geometry,Ce=ce.type;if(ce.geometry=[],Ce===1)for(let me=0;me<_e.length;me+=2)ce.geometry.push(at(_e[me],_e[me+1],A,Z,X,te));else for(let me=0;me<_e.length;me++){const ze=[];for(let Pe=0;Pe<_e[me].length;Pe+=2)ze.push(at(_e[me][Pe],_e[me][Pe+1],A,Z,X,te));ce.geometry.push(ze)}}return ge.transformed=!0,ge}function at(ge,A,Z,X,te,ce){return[Math.round(Z*(ge*X-te)),Math.round(Z*(A*X-ce))]}function Ct(ge,A,Z,X,te){const ce=A===te.maxZoom?0:te.tolerance/((1<<A)*te.extent),_e={features:[],numPoints:0,numSimplified:0,numFeatures:ge.length,source:null,x:Z,y:X,z:A,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ce of ge)Rt(_e,Ce,ce,te);return _e}function Rt(ge,A,Z,X){const te=A.geometry,ce=A.type,_e=[];if(ge.minX=Math.min(ge.minX,A.minX),ge.minY=Math.min(ge.minY,A.minY),ge.maxX=Math.max(ge.maxX,A.maxX),ge.maxY=Math.max(ge.maxY,A.maxY),ce==="Point"||ce==="MultiPoint")for(let Ce=0;Ce<te.length;Ce+=3)_e.push(te[Ce],te[Ce+1]),ge.numPoints++,ge.numSimplified++;else if(ce==="LineString")$t(_e,te,ge,Z,!1,!1);else if(ce==="MultiLineString"||ce==="Polygon")for(let Ce=0;Ce<te.length;Ce++)$t(_e,te[Ce],ge,Z,ce==="Polygon",Ce===0);else if(ce==="MultiPolygon")for(let Ce=0;Ce<te.length;Ce++){const me=te[Ce];for(let ze=0;ze<me.length;ze++)$t(_e,me[ze],ge,Z,!0,ze===0)}if(_e.length){let Ce=A.tags||null;if(ce==="LineString"&&X.lineMetrics){Ce={};for(const ze in A.tags)Ce[ze]=A.tags[ze];Ce.mapbox_clip_start=te.start/te.size,Ce.mapbox_clip_end=te.end/te.size}const me={geometry:_e,type:ce==="Polygon"||ce==="MultiPolygon"?3:ce==="LineString"||ce==="MultiLineString"?2:1,tags:Ce};A.id!==null&&(me.id=A.id),ge.features.push(me)}}function $t(ge,A,Z,X,te,ce){const _e=X*X;if(X>0&&A.size<(te?_e:X))return void(Z.numPoints+=A.length/3);const Ce=[];for(let me=0;me<A.length;me+=3)(X===0||A[me+2]>_e)&&(Z.numSimplified++,Ce.push(A[me],A[me+1])),Z.numPoints++;te&&function(me,ze){let Pe=0;for(let ye=0,Fe=me.length,ve=Fe-2;ye<Fe;ve=ye,ye+=2)Pe+=(me[ye]-me[ve])*(me[ye+1]+me[ve+1]);if(Pe>0===ze)for(let ye=0,Fe=me.length;ye<Fe/2;ye+=2){const ve=me[ye],tt=me[ye+1];me[ye]=me[Fe-2-ye],me[ye+1]=me[Fe-1-ye],me[Fe-2-ye]=ve,me[Fe-1-ye]=tt}}(Ce,ce),ge.push(Ce)}const Ht={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ut{constructor(A,Z){const X=(Z=this.options=function(ce,_e){for(const Ce in _e)ce[Ce]=_e[Ce];return ce}(Object.create(Ht),Z)).debug;if(X&&console.time("preprocess data"),Z.maxZoom<0||Z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Z.promoteId&&Z.generateId)throw new Error("promoteId and generateId cannot be used together.");let te=function(ce,_e){const Ce=[];if(ce.type==="FeatureCollection")for(let me=0;me<ce.features.length;me++)qr(Ce,ce.features[me],_e,me);else qr(Ce,ce.type==="Feature"?ce:{geometry:ce},_e);return Ce}(A,Z);this.tiles={},this.tileCoords=[],X&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Z.indexMaxZoom,Z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),te=function(ce,_e){const Ce=_e.buffer/_e.extent;let me=ce;const ze=ae(ce,1,-1-Ce,Ce,0,-1,2,_e),Pe=ae(ce,1,1-Ce,2+Ce,0,-1,2,_e);return(ze||Pe)&&(me=ae(ce,1,-Ce,1+Ce,0,-1,2,_e)||[],ze&&(me=Qe(ze,1).concat(me)),Pe&&(me=me.concat(Qe(Pe,-1)))),me}(te,Z),te.length&&this.splitTile(te,0,0,0),X&&(te.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(A,Z,X,te,ce,_e,Ce){const me=[A,Z,X,te],ze=this.options,Pe=ze.debug;for(;me.length;){te=me.pop(),X=me.pop(),Z=me.pop(),A=me.pop();const ye=1<<Z,Fe=Br(Z,X,te);let ve=this.tiles[Fe];if(!ve&&(Pe>1&&console.time("creation"),ve=this.tiles[Fe]=Ct(A,Z,X,te,ze),this.tileCoords.push({z:Z,x:X,y:te}),Pe)){Pe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Z,X,te,ve.numFeatures,ve.numPoints,ve.numSimplified),console.timeEnd("creation"));const Tt=`z${Z}`;this.stats[Tt]=(this.stats[Tt]||0)+1,this.total++}if(ve.source=A,ce==null){if(Z===ze.indexMaxZoom||ve.numPoints<=ze.indexMaxPoints)continue}else{if(Z===ze.maxZoom||Z===ce)continue;if(ce!=null){const Tt=ce-Z;if(X!==_e>>Tt||te!==Ce>>Tt)continue}}if(ve.source=null,A.length===0)continue;Pe>1&&console.time("clipping");const tt=.5*ze.buffer/ze.extent,yt=.5-tt,Lt=.5+tt,It=1+tt;let Be=null,pt=null,ht=null,Ot=null,At=ae(A,ye,X-tt,X+Lt,0,ve.minX,ve.maxX,ze),jt=ae(A,ye,X+yt,X+It,0,ve.minX,ve.maxX,ze);A=null,At&&(Be=ae(At,ye,te-tt,te+Lt,1,ve.minY,ve.maxY,ze),pt=ae(At,ye,te+yt,te+It,1,ve.minY,ve.maxY,ze),At=null),jt&&(ht=ae(jt,ye,te-tt,te+Lt,1,ve.minY,ve.maxY,ze),Ot=ae(jt,ye,te+yt,te+It,1,ve.minY,ve.maxY,ze),jt=null),Pe>1&&console.timeEnd("clipping"),me.push(Be||[],Z+1,2*X,2*te),me.push(pt||[],Z+1,2*X,2*te+1),me.push(ht||[],Z+1,2*X+1,2*te),me.push(Ot||[],Z+1,2*X+1,2*te+1)}}getTile(A,Z,X){A=+A,Z=+Z,X=+X;const te=this.options,{extent:ce,debug:_e}=te;if(A<0||A>24)return null;const Ce=1<<A,me=Br(A,Z=Z+Ce&Ce-1,X);if(this.tiles[me])return Pt(this.tiles[me],ce);_e>1&&console.log("drilling down to z%d-%d-%d",A,Z,X);let ze,Pe=A,ye=Z,Fe=X;for(;!ze&&Pe>0;)Pe--,ye>>=1,Fe>>=1,ze=this.tiles[Br(Pe,ye,Fe)];return ze&&ze.source?(_e>1&&(console.log("found parent tile z%d-%d-%d",Pe,ye,Fe),console.time("drilling down")),this.splitTile(ze.source,Pe,ye,Fe,A,Z,X),_e>1&&console.timeEnd("drilling down"),this.tiles[me]?Pt(this.tiles[me],ce):null):null}}function Br(ge,A,Z){return 32*((1<<ge)*Z+A)+ge}function Ir(ge,A){return A?ge.properties[A]:ge.id}function xo(ge,A){if(ge==null)return!0;if(ge.type==="Feature")return Ir(ge,A)!=null;if(ge.type==="FeatureCollection"){const Z=new Set;for(const X of ge.features){const te=Ir(X,A);if(te==null||Z.has(te))return!1;Z.add(te)}return!0}return!1}function ho(ge,A){const Z=new Map;if(ge!=null)if(ge.type==="Feature")Z.set(Ir(ge,A),ge);else for(const X of ge.features)Z.set(Ir(X,A),X);return Z}class _i extends H{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(A,Z){return b._(this,void 0,void 0,function*(){const X=A.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const te=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!te)return null;const ce=new st(te.features);let _e=Je(ce);return _e.byteOffset===0&&_e.byteLength===_e.buffer.byteLength||(_e=new Uint8Array(_e)),{vectorTile:ce,rawData:_e.buffer}})}loadData(A){return b._(this,void 0,void 0,function*(){var Z;(Z=this._pendingRequest)===null||Z===void 0||Z.abort();const X=!!(A&&A.request&&A.request.collectResourceTiming)&&new b.cw(A.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(A,this._pendingRequest),this._geoJSONIndex=A.cluster?new ft(function({superclusterOptions:_e,clusterProperties:Ce}){if(!Ce||!_e)return _e;const me={},ze={},Pe={accumulated:null,zoom:0},ye={properties:null},Fe=Object.keys(Ce);for(const ve of Fe){const[tt,yt]=Ce[ve],Lt=b.cD(yt),It=b.cD(typeof tt=="string"?[tt,["accumulated"],["get",ve]]:tt);me[ve]=Lt.value,ze[ve]=It.value}return _e.map=ve=>{ye.properties=ve;const tt={};for(const yt of Fe)tt[yt]=me[yt].evaluate(Pe,ye);return tt},_e.reduce=(ve,tt)=>{ye.properties=tt;for(const yt of Fe)Pe.accumulated=ve[yt],ve[yt]=ze[yt].evaluate(Pe,ye)},_e}(A)).load((yield this._pendingData).features):(te=yield this._pendingData,new Ut(te,A.geojsonVtOptions)),this.loaded={};const ce={};if(X){const _e=X.finish();_e&&(ce.resourceTiming={},ce.resourceTiming[A.source]=JSON.parse(JSON.stringify(_e)))}return ce}catch(ce){if(delete this._pendingRequest,b.ch(ce))return{abandoned:!0};throw ce}var te})}getData(){return b._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(A){const Z=this.loaded;return Z&&Z[A.uid]?super.reloadTile(A):this.loadTile(A)}loadAndProcessGeoJSON(A,Z){return b._(this,void 0,void 0,function*(){let X=yield this.loadGeoJSON(A,Z);if(delete this._pendingRequest,typeof X!="object")throw new Error(`Input data given to '${A.source}' is not a valid GeoJSON object.`);if(rt(X,!0),A.filter){const te=b.cD(A.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(te.result==="error")throw new Error(te.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));X={type:"FeatureCollection",features:X.features.filter(_e=>te.value.evaluate({zoom:0},_e))}}return X})}loadGeoJSON(A,Z){return b._(this,void 0,void 0,function*(){const{promoteId:X}=A;if(A.request){const te=yield b.j(A.request,Z);return this._dataUpdateable=xo(te.data,X)?ho(te.data,X):void 0,te.data}if(typeof A.data=="string")try{const te=JSON.parse(A.data);return this._dataUpdateable=xo(te,X)?ho(te,X):void 0,te}catch{throw new Error(`Input data given to '${A.source}' is not a valid GeoJSON object.`)}if(!A.dataDiff)throw new Error(`Input data given to '${A.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${A.source}`);return function(te,ce,_e){var Ce,me,ze,Pe;if(ce.removeAll&&te.clear(),ce.remove)for(const ye of ce.remove)te.delete(ye);if(ce.add)for(const ye of ce.add){const Fe=Ir(ye,_e);Fe!=null&&te.set(Fe,ye)}if(ce.update)for(const ye of ce.update){let Fe=te.get(ye.id);if(Fe==null)continue;const ve=!ye.removeAllProperties&&(((Ce=ye.removeProperties)===null||Ce===void 0?void 0:Ce.length)>0||((me=ye.addOrUpdateProperties)===null||me===void 0?void 0:me.length)>0);if((ye.newGeometry||ye.removeAllProperties||ve)&&(Fe=Object.assign({},Fe),te.set(ye.id,Fe),ve&&(Fe.properties=Object.assign({},Fe.properties))),ye.newGeometry&&(Fe.geometry=ye.newGeometry),ye.removeAllProperties)Fe.properties={};else if(((ze=ye.removeProperties)===null||ze===void 0?void 0:ze.length)>0)for(const tt of ye.removeProperties)Object.prototype.hasOwnProperty.call(Fe.properties,tt)&&delete Fe.properties[tt];if(((Pe=ye.addOrUpdateProperties)===null||Pe===void 0?void 0:Pe.length)>0)for(const{key:tt,value:yt}of ye.addOrUpdateProperties)Fe.properties[tt]=yt}}(this._dataUpdateable,A.dataDiff,X),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(A){return b._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(A){return this._geoJSONIndex.getClusterExpansionZoom(A.clusterId)}getClusterChildren(A){return this._geoJSONIndex.getChildren(A.clusterId)}getClusterLeaves(A){return this._geoJSONIndex.getLeaves(A.clusterId,A.limit,A.offset)}}class oi{constructor(A){this.self=A,this.actor=new b.H(A),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Z,X)=>{if(this.externalWorkerSourceTypes[Z])throw new Error(`Worker source with name "${Z}" already registered.`);this.externalWorkerSourceTypes[Z]=X},this.self.addProtocol=b.cj,this.self.removeProtocol=b.ck,this.self.registerRTLTextPlugin=Z=>{b.cE.setMethods(Z)},this.actor.registerMessageHandler("LDT",(Z,X)=>this._getDEMWorkerSource(Z,X.source).loadTile(X)),this.actor.registerMessageHandler("RDT",(Z,X)=>b._(this,void 0,void 0,function*(){this._getDEMWorkerSource(Z,X.source).removeTile(X)})),this.actor.registerMessageHandler("GCEZ",(Z,X)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,X.type,X.source).getClusterExpansionZoom(X)})),this.actor.registerMessageHandler("GCC",(Z,X)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,X.type,X.source).getClusterChildren(X)})),this.actor.registerMessageHandler("GCL",(Z,X)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,X.type,X.source).getClusterLeaves(X)})),this.actor.registerMessageHandler("LD",(Z,X)=>this._getWorkerSource(Z,X.type,X.source).loadData(X)),this.actor.registerMessageHandler("GD",(Z,X)=>this._getWorkerSource(Z,X.type,X.source).getData()),this.actor.registerMessageHandler("LT",(Z,X)=>this._getWorkerSource(Z,X.type,X.source).loadTile(X)),this.actor.registerMessageHandler("RT",(Z,X)=>this._getWorkerSource(Z,X.type,X.source).reloadTile(X)),this.actor.registerMessageHandler("AT",(Z,X)=>this._getWorkerSource(Z,X.type,X.source).abortTile(X)),this.actor.registerMessageHandler("RMT",(Z,X)=>this._getWorkerSource(Z,X.type,X.source).removeTile(X)),this.actor.registerMessageHandler("RS",(Z,X)=>b._(this,void 0,void 0,function*(){if(!this.workerSources[Z]||!this.workerSources[Z][X.type]||!this.workerSources[Z][X.type][X.source])return;const te=this.workerSources[Z][X.type][X.source];delete this.workerSources[Z][X.type][X.source],te.removeSource!==void 0&&te.removeSource(X)})),this.actor.registerMessageHandler("RM",Z=>b._(this,void 0,void 0,function*(){delete this.layerIndexes[Z],delete this.availableImages[Z],delete this.workerSources[Z],delete this.demWorkerSources[Z]})),this.actor.registerMessageHandler("SR",(Z,X)=>b._(this,void 0,void 0,function*(){this.referrer=X})),this.actor.registerMessageHandler("SRPS",(Z,X)=>this._syncRTLPluginState(Z,X)),this.actor.registerMessageHandler("IS",(Z,X)=>b._(this,void 0,void 0,function*(){this.self.importScripts(X)})),this.actor.registerMessageHandler("SI",(Z,X)=>this._setImages(Z,X)),this.actor.registerMessageHandler("UL",(Z,X)=>b._(this,void 0,void 0,function*(){this._getLayerIndex(Z).update(X.layers,X.removedIds)})),this.actor.registerMessageHandler("SL",(Z,X)=>b._(this,void 0,void 0,function*(){this._getLayerIndex(Z).replace(X)}))}_setImages(A,Z){return b._(this,void 0,void 0,function*(){this.availableImages[A]=Z;for(const X in this.workerSources[A]){const te=this.workerSources[A][X];for(const ce in te)te[ce].availableImages=Z}})}_syncRTLPluginState(A,Z){return b._(this,void 0,void 0,function*(){return yield b.cE.syncState(Z,this.self.importScripts)})}_getAvailableImages(A){let Z=this.availableImages[A];return Z||(Z=[]),Z}_getLayerIndex(A){let Z=this.layerIndexes[A];return Z||(Z=this.layerIndexes[A]=new c),Z}_getWorkerSource(A,Z,X){if(this.workerSources[A]||(this.workerSources[A]={}),this.workerSources[A][Z]||(this.workerSources[A][Z]={}),!this.workerSources[A][Z][X]){const te={sendAsync:(ce,_e)=>(ce.targetMapId=A,this.actor.sendAsync(ce,_e))};switch(Z){case"vector":this.workerSources[A][Z][X]=new H(te,this._getLayerIndex(A),this._getAvailableImages(A));break;case"geojson":this.workerSources[A][Z][X]=new _i(te,this._getLayerIndex(A),this._getAvailableImages(A));break;default:this.workerSources[A][Z][X]=new this.externalWorkerSourceTypes[Z](te,this._getLayerIndex(A),this._getAvailableImages(A))}}return this.workerSources[A][Z][X]}_getDEMWorkerSource(A,Z){return this.demWorkerSources[A]||(this.demWorkerSources[A]={}),this.demWorkerSources[A][Z]||(this.demWorkerSources[A][Z]=new Q),this.demWorkerSources[A][Z]}}return b.i(self)&&(self.worker=new oi(self)),oi}),x("index",["exports","./shared"],function(b,c){var z="5.2.0";function U(){var f=new c.A(4);return c.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}let V,H;const Q={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f,e,r){const l=requestAnimationFrame(p=>{u(),e(p)}),{unsubscribe:u}=c.s(f.signal,"abort",()=>{u(),cancelAnimationFrame(l),r(c.c())},!1)},frameAsync(f){return new Promise((e,r)=>{this.frame(f,e,r)})},getImageData(f,e=0){return this.getImageCanvasContext(f).getImageData(-e,-e,f.width+2*e,f.height+2*e)},getImageCanvasContext(f){const e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=f.width,e.height=f.height,r.drawImage(f,0,0,f.width,f.height),r},resolveURL:f=>(V||(V=document.createElement("a")),V.href=f,V.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(H==null&&(H=matchMedia("(prefers-reduced-motion: reduce)")),H.matches)}};class G{static testProp(e){if(!G.docStyle)return e[0];for(let r=0;r<e.length;r++)if(e[r]in G.docStyle)return e[r];return e[0]}static create(e,r,l){const u=window.document.createElement(e);return r!==void 0&&(u.className=r),l&&l.appendChild(u),u}static createNS(e,r){return window.document.createElementNS(e,r)}static disableDrag(){G.docStyle&&G.selectProp&&(G.userSelect=G.docStyle[G.selectProp],G.docStyle[G.selectProp]="none")}static enableDrag(){G.docStyle&&G.selectProp&&(G.docStyle[G.selectProp]=G.userSelect)}static setTransform(e,r){e.style[G.transformProp]=r}static addEventListener(e,r,l,u={}){e.addEventListener(r,l,"passive"in u?u:u.capture)}static removeEventListener(e,r,l,u={}){e.removeEventListener(r,l,"passive"in u?u:u.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",G.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",G.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",G.suppressClickInternal,!0)},0)}static getScale(e){const r=e.getBoundingClientRect();return{x:r.width/e.offsetWidth||1,y:r.height/e.offsetHeight||1,boundingClientRect:r}}static getPoint(e,r,l){const u=r.boundingClientRect;return new c.P((l.clientX-u.left)/r.x-e.clientLeft,(l.clientY-u.top)/r.y-e.clientTop)}static mousePos(e,r){const l=G.getScale(e);return G.getPoint(e,l,r)}static touchPos(e,r){const l=[],u=G.getScale(e);for(let p=0;p<r.length;p++)l.push(G.getPoint(e,u,r[p]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const r=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=r.querySelectorAll("script");for(const u of l)u.remove();return G.clean(r),r.innerHTML}static isPossiblyDangerous(e,r){const l=r.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const r=e.children;for(const l of r)G.removeAttributes(l),G.clean(l)}static removeAttributes(e){for(const{name:r,value:l}of e.attributes)G.isPossiblyDangerous(r,l)&&e.removeAttribute(r)}}G.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,G.selectProp=G.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),G.transformProp=G.testProp(["transform","WebkitTransform"]);const se={supported:!1,testSupport:function(f){!He&&rt&&(lt?st(f):Me=f)}};let Me,rt,He=!1,lt=!1;function st(f){const e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,rt),f.isContextLost())return;se.supported=!0}catch{}f.deleteTexture(e),He=!0}var Te;typeof document<"u"&&(rt=document.createElement("img"),rt.onload=()=>{Me&&st(Me),Me=null,lt=!0},rt.onerror=()=>{He=!0,Me=null},rt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(f){let e,r,l,u;f.resetRequestQueue=()=>{e=[],r=0,l=0,u={}},f.addThrottleControl=T=>{const k=l++;return u[k]=T,k},f.removeThrottleControl=T=>{delete u[T],y()},f.getImage=(T,k,E=!0)=>new Promise((D,R)=>{se.supported&&(T.headers||(T.headers={}),T.headers.accept="image/webp,*/*"),c.e(T,{type:"image"}),e.push({abortController:k,requestParameters:T,supportImageRefresh:E,state:"queued",onError:$=>{R($)},onSuccess:$=>{D($)}}),y()});const p=T=>c._(this,void 0,void 0,function*(){T.state="running";const{requestParameters:k,supportImageRefresh:E,onError:D,onSuccess:R,abortController:$}=T,N=E===!1&&!c.i(self)&&!c.g(k.url)&&(!k.headers||Object.keys(k.headers).reduce((J,re)=>J&&re==="accept",!0));r++;const K=N?w(k,$):c.m(k,$);try{const J=yield K;delete T.abortController,T.state="completed",J.data instanceof HTMLImageElement||c.b(J.data)?R(J):J.data&&R({data:yield(Y=J.data,typeof createImageBitmap=="function"?c.f(Y):c.h(Y)),cacheControl:J.cacheControl,expires:J.expires})}catch(J){delete T.abortController,D(J)}finally{r--,y()}var Y}),y=()=>{const T=(()=>{for(const k of Object.keys(u))if(u[k]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=r;k<T&&e.length>0;k++){const E=e.shift();E.abortController.signal.aborted?k--:p(E)}},w=(T,k)=>new Promise((E,D)=>{const R=new Image,$=T.url,N=T.credentials;N&&N==="include"?R.crossOrigin="use-credentials":(N&&N==="same-origin"||!c.d($))&&(R.crossOrigin="anonymous"),k.signal.addEventListener("abort",()=>{R.src="",D(c.c())}),R.fetchPriority="high",R.onload=()=>{R.onerror=R.onload=null,E({data:R})},R.onerror=()=>{R.onerror=R.onload=null,k.signal.aborted||D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},R.src=$})}(Te||(Te={})),Te.resetRequestQueue();class Ye{constructor(e){this._transformRequestFn=e}transformRequest(e,r){return this._transformRequestFn&&this._transformRequestFn(e,r)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function dt(f){const e=[];if(typeof f=="string")e.push({id:"default",url:f});else if(f&&f.length>0){const r=[];for(const{id:l,url:u}of f){const p=`${l}${u}`;r.indexOf(p)===-1&&(r.push(p),e.push({id:l,url:u}))}}return e}function _t(f,e,r){try{const l=new URL(f);return l.pathname+=`${e}${r}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${f}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class nt{constructor(e,r,l,u){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(r,u)}update(e,r,l){const{width:u,height:p}=e,y=!(this.size&&this.size[0]===u&&this.size[1]===p||l),{context:w}=this,{gl:T}=w;if(this.useMipmap=!!(r&&r.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!r||r.premultiply!==!1)),y)this.size=[u,p],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,e):T.texImage2D(T.TEXTURE_2D,0,this.format,u,p,0,this.format,T.UNSIGNED_BYTE,e.data);else{const{x:k,y:E}=l||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?T.texSubImage2D(T.TEXTURE_2D,0,k,E,T.RGBA,T.UNSIGNED_BYTE,e):T.texSubImage2D(T.TEXTURE_2D,0,k,E,u,p,T.RGBA,T.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(e,r,l){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),l!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=p.LINEAR),e!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,l||e),this.filter=e),r!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,r),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Je(f){const{userImage:e}=f;return!!(e&&e.render&&e.render())&&(f.data.replace(new Uint8Array(e.data.buffer)),!0)}class bt extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:r,promiseResolve:l}of this.requestors)l(this._getImagesForIds(r));this.requestors=[]}}getImage(e){const r=this.images[e];if(r&&!r.data&&r.spriteData){const l=r.spriteData;r.data=new c.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),r.spriteData=null}return r}addImage(e,r){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,r)&&(this.images[e]=r)}_validate(e,r){let l=!0;const u=r.data||r.spriteData;return this._validateStretch(r.stretchX,u&&u.width)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(r.stretchY,u&&u.height)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(r.content,r)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,r){if(!e)return!0;let l=0;for(const u of e){if(u[0]<l||u[1]<u[0]||r<u[1])return!1;l=u[1]}return!0}_validateContent(e,r){if(!e)return!0;if(e.length!==4)return!1;const l=r.spriteData,u=l&&l.width||r.data.width,p=l&&l.height||r.data.height;return!(e[0]<0||u<e[0]||e[1]<0||p<e[1]||e[2]<0||u<e[2]||e[3]<0||p<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,r,l=!0){const u=this.getImage(e);if(l&&(u.data.width!==r.data.width||u.data.height!==r.data.height))throw new Error(`size mismatch between old image (${u.data.width}x${u.data.height}) and new image (${r.data.width}x${r.data.height}).`);r.version=u.version+1,this.images[e]=r,this.updatedImages[e]=!0}removeImage(e){const r=this.images[e];delete this.images[e],delete this.patterns[e],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((r,l)=>{let u=!0;if(!this.isLoaded())for(const p of e)this.images[p]||(u=!1);this.isLoaded()||u?r(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:r})})}_getImagesForIds(e){const r={};for(const l of e){let u=this.getImage(l);u||(this.fire(new c.l("styleimagemissing",{id:l})),u=this.getImage(l)),u?r[l]={data:u.data.clone(),pixelRatio:u.pixelRatio,sdf:u.sdf,version:u.version,stretchX:u.stretchX,stretchY:u.stretchY,content:u.content,textFitWidth:u.textFitWidth,textFitHeight:u.textFitHeight,hasRenderCallback:!!(u.userImage&&u.userImage.render)}:c.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:e,height:r}=this.atlasImage;return{width:e,height:r}}getPattern(e){const r=this.patterns[e],l=this.getImage(e);if(!l)return null;if(r&&r.position.version===l.version)return r.position;if(r)r.position.version=l.version;else{const u={w:l.data.width+2,h:l.data.height+2,x:0,y:0},p=new c.I(u,l);this.patterns[e]={bin:u,position:p}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new nt(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const p in this.patterns)e.push(this.patterns[p].bin);const{w:r,h:l}=c.p(e),u=this.atlasImage;u.resize({width:r||1,height:l||1});for(const p in this.patterns){const{bin:y}=this.patterns[p],w=y.x+1,T=y.y+1,k=this.getImage(p).data,E=k.width,D=k.height;c.R.copy(k,u,{x:0,y:0},{x:w,y:T},{width:E,height:D}),c.R.copy(k,u,{x:0,y:D-1},{x:w,y:T-1},{width:E,height:1}),c.R.copy(k,u,{x:0,y:0},{x:w,y:T+D},{width:E,height:1}),c.R.copy(k,u,{x:E-1,y:0},{x:w-1,y:T},{width:1,height:D}),c.R.copy(k,u,{x:0,y:0},{x:w+E,y:T},{width:1,height:D})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const l=this.getImage(r);l||c.w(`Image with ID: "${r}" was not found`),Je(l)&&this.updateImage(r,l)}}}const zt=1e20;function De(f,e,r,l,u,p,y,w,T){for(let k=e;k<e+l;k++)Ge(f,r*p+k,p,u,y,w,T);for(let k=r;k<r+u;k++)Ge(f,k*p+e,1,l,y,w,T)}function Ge(f,e,r,l,u,p,y){p[0]=0,y[0]=-1e20,y[1]=zt,u[0]=f[e];for(let w=1,T=0,k=0;w<l;w++){u[w]=f[e+w*r];const E=w*w;do{const D=p[T];k=(u[w]-u[D]+E-D*D)/(w-D)/2}while(k<=y[T]&&--T>-1);T++,p[T]=w,y[T]=k,y[T+1]=zt}for(let w=0,T=0;w<l;w++){for(;y[T+1]<w;)T++;const k=p[T],E=w-k;f[e+w*r]=u[k]+E*E}}class et{constructor(e,r){this.requestManager=e,this.localIdeographFontFamily=r,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,function*(){const r=[];for(const p in e)for(const y of e[p])r.push(this._getAndCacheGlyphsPromise(p,y));const l=yield Promise.all(r),u={};for(const{stack:p,id:y,glyph:w}of l)u[p]||(u[p]={}),u[p][y]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics};return u})}_getAndCacheGlyphsPromise(e,r){return c._(this,void 0,void 0,function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let u=l.glyphs[r];if(u!==void 0)return{stack:e,id:r,glyph:u};if(u=this._tinySDF(l,e,r),u)return l.glyphs[r]=u,{stack:e,id:r,glyph:u};const p=Math.floor(r/256);if(256*p>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[p])return{stack:e,id:r,glyph:u};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[p]){const w=et.loadGlyphRange(e,p,this.url,this.requestManager);l.requests[p]=w}const y=yield l.requests[p];for(const w in y)this._doesCharSupportLocalGlyph(+w)||(l.glyphs[+w]=y[+w]);return l.ranges[p]=!0,{stack:e,id:r,glyph:y[r]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||c.u["CJK Unified Ideographs"](e)||c.u["Hangul Syllables"](e)||c.u.Hiragana(e)||c.u.Katakana(e)||c.u["CJK Symbols and Punctuation"](e)||c.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,r,l){const u=this.localIdeographFontFamily;if(!u||!this._doesCharSupportLocalGlyph(l))return;let p=e.tinySDF;if(!p){let w="400";/bold/i.test(r)?w="900":/medium/i.test(r)?w="500":/light/i.test(r)&&(w="200"),p=e.tinySDF=new et.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:u,fontWeight:w})}const y=p.draw(String.fromCharCode(l));return{id:l,bitmap:new c.q({width:y.width||60,height:y.height||60},y.data),metrics:{width:y.glyphWidth/2||24,height:y.glyphHeight/2||24,left:y.glyphLeft/2+.5||0,top:y.glyphTop/2-27.5||-8,advance:y.glyphAdvance/2||24,isDoubleResolution:!0}}}}et.loadGlyphRange=function(f,e,r,l){return c._(this,void 0,void 0,function*(){const u=256*e,p=u+255,y=l.transformRequest(r.replace("{fontstack}",f).replace("{range}",`${u}-${p}`),"Glyphs"),w=yield c.n(y,new AbortController);if(!w||!w.data)throw new Error(`Could not load glyph range. range: ${e}, ${u}-${p}`);const T={};for(const k of c.o(w.data))T[k.id]=k;return T})},et.TinySDF=class{constructor({fontSize:f=24,buffer:e=3,radius:r=8,cutoff:l=.25,fontFamily:u="sans-serif",fontWeight:p="normal",fontStyle:y="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=r;const w=this.size=f+4*e,T=this._createCanvas(w),k=this.ctx=T.getContext("2d",{willReadFrequently:!0});k.font=`${y} ${p} ${f}px ${u}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(f){const e=document.createElement("canvas");return e.width=e.height=f,e}draw(f){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:l,actualBoundingBoxLeft:u,actualBoundingBoxRight:p}=this.ctx.measureText(f),y=Math.ceil(r),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-u))),T=Math.min(this.size-this.buffer,y+Math.ceil(l)),k=w+2*this.buffer,E=T+2*this.buffer,D=Math.max(k*E,0),R=new Uint8ClampedArray(D),$={data:R,width:k,height:E,glyphWidth:w,glyphHeight:T,glyphTop:y,glyphLeft:0,glyphAdvance:e};if(w===0||T===0)return $;const{ctx:N,buffer:K,gridInner:Y,gridOuter:J}=this;N.clearRect(K,K,w,T),N.fillText(f,K,K+y);const re=N.getImageData(K,K,w,T);J.fill(zt,0,D),Y.fill(0,0,D);for(let ne=0;ne<T;ne++)for(let le=0;le<w;le++){const ue=re.data[4*(ne*w+le)+3]/255;if(ue===0)continue;const fe=(ne+K)*k+le+K;if(ue===1)J[fe]=0,Y[fe]=zt;else{const he=.5-ue;J[fe]=he>0?he*he:0,Y[fe]=he<0?he*he:0}}De(J,0,0,k,E,k,this.f,this.v,this.z),De(Y,K,K,w,T,k,this.f,this.v,this.z);for(let ne=0;ne<D;ne++){const le=Math.sqrt(J[ne])-Math.sqrt(Y[ne]);R[ne]=Math.round(255-255*(le/this.radius+this.cutoff))}return $}};class Dt{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,r){return c.z(e.expression.evaluate(r))}interpolate(e,r,l){return{x:c.B.number(e.x,r.x,l),y:c.B.number(e.y,r.y,l),z:c.B.number(e.z,r.z,l)}}}let ft;class wt extends c.E{constructor(e){super(),ft=ft||new c.r({anchor:new c.D(c.v.light.anchor),position:new Dt,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(ft),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(c.t,e,r))for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,l){return(!l||l.validate!==!1)&&c.x(this,e.call(c.y,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const Et=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class sr extends c.E{constructor(e){super(),this._transitionable=new c.T(Et),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.C(0))}setSky(e,r={}){if(!this._validate(c.F,e,r)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,l={}){return(l==null?void 0:l.validate)!==!1&&c.x(this,e.call(c.y,c.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class cr{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,r){const l=e.join(",")+String(r);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,r)),this.dashEntry[l]}getDashRanges(e,r,l){const u=[];let p=e.length%2==1?-e[e.length-1]*l:0,y=e[0]*l,w=!0;u.push({left:p,right:y,isDash:w,zeroLength:e[0]===0});let T=e[0];for(let k=1;k<e.length;k++){w=!w;const E=e[k];p=T*l,T+=E,y=T*l,u.push({left:p,right:y,isDash:w,zeroLength:E===0})}return u}addRoundDash(e,r,l){const u=r/2;for(let p=-l;p<=l;p++){const y=this.width*(this.nextRow+l+p);let w=0,T=e[w];for(let k=0;k<this.width;k++){k/T.right>1&&(T=e[++w]);const E=Math.abs(k-T.left),D=Math.abs(k-T.right),R=Math.min(E,D);let $;const N=p/l*(u+1);if(T.isDash){const K=u-Math.abs(N);$=Math.sqrt(R*R+K*K)}else $=u-Math.sqrt(R*R+N*N);this.data[y+k]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(e){for(let w=e.length-1;w>=0;--w){const T=e[w],k=e[w+1];T.zeroLength?e.splice(w,1):k&&k.isDash===T.isDash&&(k.left=T.left,e.splice(w,1))}const r=e[0],l=e[e.length-1];r.isDash===l.isDash&&(r.left=l.left-this.width,l.right=r.right+this.width);const u=this.width*this.nextRow;let p=0,y=e[p];for(let w=0;w<this.width;w++){w/y.right>1&&(y=e[++p]);const T=Math.abs(w-y.left),k=Math.abs(w-y.right),E=Math.min(T,k);this.data[u+w]=Math.max(0,Math.min(255,(y.isDash?E:-E)+128))}}addDash(e,r){const l=r?7:0,u=2*l+1;if(this.nextRow+u>this.height)return c.w("LineAtlas out of space"),null;let p=0;for(let w=0;w<e.length;w++)p+=e[w];if(p!==0){const w=this.width/p,T=this.getDashRanges(e,this.width,w);r?this.addRoundDash(T,w,l):this.addRegularDash(T)}const y={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:p};return this.nextRow+=u,this.dirty=!0,y}bind(e){const r=e.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}}const or="maplibre_preloaded_worker_pool";class qt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<qt.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[or]}numActive(){return Object.keys(this.active).length}}const Sr=Math.floor(Q.hardwareConcurrency/2);let Mr,br;function qr(){return Mr||(Mr=new qt),Mr}qt.workerCount=c.G(globalThis)?Math.max(Math.min(Sr,3),1):1;class bo{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;const l=this.workerPool.acquire(r);for(let u=0;u<l.length;u++){const p=new c.H(l[u],r);p.name=`Worker ${u}`,this.actors.push(p)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,r){const l=[];for(const u of this.actors)l.push(u.sendAsync({type:e,data:r}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(r=>{r.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,r){for(const l of this.actors)l.registerMessageHandler(e,r)}}function Uo(){return br||(br=new bo(qr(),c.J),br.registerMessageHandler("GR",(f,e,r)=>c.m(e,r))),br}function ro(f,e){const r=c.K();return c.L(r,r,[1,1,0]),c.M(r,r,[.5*f.width,.5*f.height,1]),f.calculatePosMatrix?c.N(r,r,f.calculatePosMatrix(e.toUnwrapped())):r}function Zo(f,e,r,l,u,p){var y;const w=function(D,R,$){if(D)for(const N of D){const K=R[N];if(K&&K.source===$&&K.type==="fill-extrusion")return!0}else for(const N in R){const K=R[N];if(K.source===$&&K.type==="fill-extrusion")return!0}return!1}((y=u==null?void 0:u.layers)!==null&&y!==void 0?y:null,e,f.id),T=p.maxPitchScaleFactor(),k=f.tilesIn(l,T,w);k.sort(Wr);const E=[];for(const D of k)E.push({wrappedTileID:D.tileID.wrapped().key,queryResults:D.tile.queryRenderedFeatures(e,r,f._state,D.queryGeometry,D.cameraQueryGeometry,D.scale,u,p,T,ro(f.transform,D.tileID))});return function(D,R){for(const $ in D)for(const N of D[$])ae(N,R);return D}(function(D){const R={},$={};for(const N of D){const K=N.queryResults,Y=N.wrappedTileID,J=$[Y]=$[Y]||{};for(const re in K){const ne=K[re],le=J[re]=J[re]||{},ue=R[re]=R[re]||[];for(const fe of ne)le[fe.featureIndex]||(le[fe.featureIndex]=!0,ue.push(fe))}}return R}(E),f)}function Wr(f,e){const r=f.tileID,l=e.tileID;return r.overscaledZ-l.overscaledZ||r.canonical.y-l.canonical.y||r.wrap-l.wrap||r.canonical.x-l.canonical.x}function ae(f,e){const r=f.feature,l=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=l}function pe(f,e,r){return c._(this,void 0,void 0,function*(){let l=f;if(f.url?l=(yield c.j(e.transformRequest(f.url,"Source"),r)).data:yield Q.frameAsync(r),!l)return null;const u=c.O(c.e(l,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(u.vectorLayerIds=l.vector_layers.map(p=>p.id)),u})}class ke{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.Q?new c.Q(e.lng,e.lat):c.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.Q?new c.Q(e.lng,e.lat):c.Q.convert(e),this}extend(e){const r=this._sw,l=this._ne;let u,p;if(e instanceof c.Q)u=e,p=e;else{if(!(e instanceof ke))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ke.convert(e)):this.extend(c.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.Q.convert(e)):this;if(u=e._sw,p=e._ne,!u||!p)return this}return r||l?(r.lng=Math.min(u.lng,r.lng),r.lat=Math.min(u.lat,r.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new c.Q(u.lng,u.lat),this._ne=new c.Q(p.lng,p.lat)),this}getCenter(){return new c.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.Q(this.getWest(),this.getNorth())}getSouthEast(){return new c.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:l}=c.Q.convert(e);let u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&u}static convert(e){return e instanceof ke?e:e&&new ke(e)}static fromLngLat(e,r=0){const l=360*r/40075017,u=l/Math.cos(Math.PI/180*e.lat);return new ke(new c.Q(e.lng-u,e.lat-l),new c.Q(e.lng+u,e.lat+l))}adjustAntiMeridian(){const e=new c.Q(this._sw.lng,this._sw.lat),r=new c.Q(this._ne.lng,this._ne.lat);return new ke(e,e.lng>r.lng?new c.Q(r.lng+360,r.lat):r)}}class qe{constructor(e,r,l){this.bounds=ke.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),l=Math.floor(c.U(this.bounds.getWest())*r),u=Math.floor(c.S(this.bounds.getNorth())*r),p=Math.ceil(c.U(this.bounds.getEast())*r),y=Math.ceil(c.S(this.bounds.getSouth())*r);return e.x>=l&&e.x<p&&e.y>=u&&e.y<y}}class Ne extends c.E{constructor(e,r,l,u){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.O(r,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield pe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new qe(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new c.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(r,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let u="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((p,y)=>{e.reloadPromise={resolve:p,reject:y}})}else e.actor=this.dispatcher.getActor(),u="LT";e.abortController=new AbortController;try{const p=yield e.actor.sendAsync({type:u,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,p)}catch(p){if(delete e.abortController,e.aborted)return;if(p&&p.status!==404)throw p;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,r){if(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ve extends c.E{constructor(e,r,l,u){super(),this.id=e,this.dispatcher=l,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},r),c.e(this,c.O(r,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield pe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(c.e(this,r),r.bounds&&(this.tileBounds=new qe(r.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(r){this._tileJSONRequest=null,this.fire(new c.k(r))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield Te.getImage(this.map._requestManager.transformRequest(r,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const u=this.map.painter.context,p=u.gl,y=l.data;e.texture=this.map.painter.getTileTexture(y.width),e.texture?e.texture.update(y,{useMipmap:!0}):(e.texture=new nt(u,y,p.RGBA,{useMipmap:!0}),e.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE,p.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class it extends Ve{constructor(e,r,l,u){super(e,r,l,u),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return c._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const u=yield Te.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){const p=u.data;this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const y=c.b(p)&&c.V()?p:yield this.readImageNow(p),w={type:this.type,uid:e.uid,source:this.id,rawImageData:y,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const T=yield e.actor.sendAsync({type:"LDT",data:w});e.dem=T,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}readImageNow(e){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.W()){const r=e.width+2,l=e.height+2;try{return new c.R({width:r,height:l},yield c.X(e,-1,-1,r,l))}catch{}}return Q.getImageData(e,1)})}_getNeighboringTiles(e){const r=e.canonical,l=Math.pow(2,r.z),u=(r.x-1+l)%l,p=r.x===0?e.wrap-1:e.wrap,y=(r.x+1+l)%l,w=r.x+1===l?e.wrap+1:e.wrap,T={};return T[new c.Y(e.overscaledZ,p,r.z,u,r.y).key]={backfilled:!1},T[new c.Y(e.overscaledZ,w,r.z,y,r.y).key]={backfilled:!1},r.y>0&&(T[new c.Y(e.overscaledZ,p,r.z,u,r.y-1).key]={backfilled:!1},T[new c.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},T[new c.Y(e.overscaledZ,w,r.z,y,r.y-1).key]={backfilled:!1}),r.y+1<l&&(T[new c.Y(e.overscaledZ,p,r.z,u,r.y+1).key]={backfilled:!1},T[new c.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},T[new c.Y(e.overscaledZ,w,r.z,y,r.y+1).key]={backfilled:!1}),T}unloadTile(e){return c._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class ot extends c.E{constructor(e,r,l,u){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(u),this._data=r.data,this._options=c.e({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,r.clusterMaxZoom!==void 0&&this.maxzoom<=r.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(r.buffer!==void 0?r.buffer:128),tolerance:this._pixelsToTileUnits(r.tolerance!==void 0?r.tolerance:.375),extent:c.Z,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:c.Z,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(c.Z/this.tileSize)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return c._(this,void 0,void 0,function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,r,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:r,offset:l}})}_updateWorkerData(e){return c._(this,void 0,void 0,function*(){const r=c.e({type:this.type},this.workerOptions);e?r.dataDiff=e:typeof this._data=="string"?(r.request=this.map._requestManager.transformRequest(Q.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.l("dataloading",{dataType:"source"}));try{const l=yield this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||l.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));let u=null;l.resourceTiming&&l.resourceTiming[this.id]&&(u=l.resourceTiming[this.id].slice(0));const p={dataType:"source"};this._collectResourceTiming&&u&&u.length>0&&c.e(p,{resourceTiming:u}),this.fire(new c.l("data",Object.assign(Object.assign({},p),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},p),{sourceDataType:"content"})))}catch(l){if(this._pendingLoads--,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(l))}})}loaded(){return this._pendingLoads===0}loadTile(e){return c._(this,void 0,void 0,function*(){const r=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const u=yield this.actor.sendAsync({type:r,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(u,this.map.painter,r==="RT")})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Qe extends c.E{constructor(e,r,l,u){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(u),this.options=r}load(e){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const r=yield Te.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,r&&r.data&&(this.image=r.data,e&&(this.coordinates=e),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,this.fire(new c.k(r))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const r=e.map(c.$.fromLngLat);var l;return this.tileID=function(u){let p=1/0,y=1/0,w=-1/0,T=-1/0;for(const R of u)p=Math.min(p,R.x),y=Math.min(y,R.y),w=Math.max(w,R.x),T=Math.max(T,R.y);const k=Math.max(w-p,T-y),E=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),D=Math.pow(2,E);return new c.a0(E,Math.floor((p+w)/2*D),Math.floor((y+T)/2*D))}(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map(u=>this.tileID.getTilePoint(u)._round()),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,r=e.gl;this.texture||(this.texture=new nt(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const p=this.tiles[u];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Ue extends Qe{constructor(e,r,l,u){super(e,r,l,u),this.roundZoom=!0,this.type="video",this.options=r}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const r of e.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{const r=yield c.a1(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new c.k(r))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new c.k(new c.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new nt(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const p=this.tiles[u];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Pt extends Qe{constructor(e,r,l,u){super(e,r,l,u),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(p=>!Array.isArray(p)||p.length!==2||p.some(y=>typeof y!="number"))||this.fire(new c.k(new c.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a2(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new c.k(new c.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,l=r.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new nt(r,this.canvas,l.RGBA,{premultiply:!0});let u=!1;for(const p in this.tiles){const y=this.tiles[p];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,u=!0)}u&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const at={},Ct=f=>{switch(f){case"geojson":return ot;case"image":return Qe;case"raster":return Ve;case"raster-dem":return it;case"vector":return Ne;case"video":return Ue;case"canvas":return Pt}return at[f]},Rt="RTLPluginLoaded";class $t extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Uo()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(r=>{throw this.status="error",r})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,function*(r,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=Q.resolveURL(r),!this.url)throw new Error(`requested url ${r} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(Rt))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ht=null;function Ut(){return Ht||(Ht=new $t),Ht}class Br{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a3(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const r=e+this.timeAdded;r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,p){const y={};if(!p)return y;for(const w of u){const T=w.layerIds.map(k=>p.getLayer(k)).filter(Boolean);if(T.length!==0){w.layers=T,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(k=>T.filter(E=>E.id===k)[0]));for(const k of T)y[k.id]=w}}return y}(e.buckets,r==null?void 0:r.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const p=this.buckets[u];if(p instanceof c.a5){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const p=this.buckets[u];if(p instanceof c.a5&&p.hasRTLText){this.hasRTLText=!0,Ut().lazyLoad();break}}this.queryPadding=0;for(const u in this.buckets){const p=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(u).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a4}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const u=this.buckets[l];u.uploadPending()&&u.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new nt(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new nt(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,l,u,p,y,w,T,k,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:p,scale:y,tileSize:this.tileSize,pixelPosMatrix:E,transform:T,params:w,queryPadding:this.queryPadding*k},e,r,l):{}}querySourceFeatures(e,r){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const u=l.loadVTLayers(),p=r&&r.sourceLayer?r.sourceLayer:"",y=u._geojsonTileLayer||u[p];if(!y)return;const w=c.a6(r&&r.filter),{z:T,x:k,y:E}=this.tileID.canonical,D={z:T,x:k,y:E};for(let R=0;R<y.length;R++){const $=y.feature(R);if(w.needGeometry){const Y=c.a7($,!0);if(!w.filter(new c.C(this.tileID.overscaledZ),Y,this.tileID.canonical))continue}else if(!w.filter(new c.C(this.tileID.overscaledZ),$))continue;const N=l.getId($,p),K=new c.a8($,T,k,E,N);K.tile=D,e.push(K)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const l=c.a9(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let u=!1;if(this.expirationTime>l)u=!1;else if(r)if(this.expirationTime<r)u=!0;else{const p=this.expirationTime-r;p?this.expirationTime=l+Math.max(p,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const u in this.buckets){if(!r.style.hasLayer(u))continue;const p=this.buckets[u],y=p.layers[0].sourceLayer||"_geojsonTileLayer",w=l[y],T=e[y];if(!w||!T||Object.keys(T).length===0)continue;p.update(T,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=r&&r.style&&r.style.getLayer(u);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(p)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Q.now()+e}setDependencies(e,r){const l={};for(const u of r)l[u]=!0;this.dependencies[e]=l}hasDependency(e,r){for(const l of e){const u=this.dependencies[l];if(u){for(const p of r)if(u[p])return!0}}return!1}}class Ir{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,l){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const p={value:r,timeout:void 0};if(l!==void 0&&(p.timeout=setTimeout(()=>{this.remove(e,p)},l)),this.data[u].push(p),this.order.push(u),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const l=e.wrapped().key,u=r===void 0?0:this.data[l].indexOf(r),p=this.data[l][u];return this.data[l].splice(u,1),p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(p.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const l in this.data)for(const u of this.data[l])e(u.value)||r.push(u);for(const l of r)this.remove(l.value.tileID,l)}}class xo{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,l){const u=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},c.e(this.stateChanges[e][u],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const p in this.state[e])p!==u&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const p in this.state[e][u])l[p]||(this.deletedStates[e][u][p]=null)}else for(const p in l)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][p]===null&&delete this.deletedStates[e][u][p]}removeFeatureState(e,r,l){if(this.deletedStates[e]===null)return;const u=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&r!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][l]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(l in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][l]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,r){const l=String(r),u=c.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const p=this.deletedStates[e][r];if(p===null)return{};for(const y in p)delete u[y]}return u}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const l={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const p={};for(const y in this.stateChanges[u])this.state[u][y]||(this.state[u][y]={}),c.e(this.state[u][y],this.stateChanges[u][y]),p[y]=this.state[u][y];l[u]=p}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const p={};if(this.deletedStates[u]===null)for(const y in this.state[u])p[y]={},this.state[u][y]={};else for(const y in this.deletedStates[u]){if(this.deletedStates[u][y]===null)this.state[u][y]={};else for(const w of Object.keys(this.deletedStates[u][y]))delete this.state[u][y][w];p[y]=this.state[u][y]}l[u]=l[u]||{},c.e(l[u],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const u in e)e[u].setFeatureState(l,r)}}function ho(f,e,r){const l=e.intersectsFrustum(f);if(!r)return l;const u=e.intersectsPlane(r);return l===0||u===0?0:l===2&&u===2?2:1}function _i(f,e,r,l,u){let p=f;const y=Math.atan(e/r),w=Math.hypot(e,r);return p=f+c.aa(l/w/Math.max(.5,Math.cos(c.ac(u/2)))),p+=1*c.aa(Math.cos(y))/2,p+=c.ad(f-p,-0,0),p}function oi(f,e){const r=(e.roundZoom?Math.round:Math.floor)(f.zoom+c.aa(f.tileSize/e.tileSize));return Math.max(0,r)}function ge(f,e){const r=f.getCameraFrustum(),l=f.getClippingPlane(),u=f.screenPointToMercatorCoordinate(f.getCameraPoint()),p=c.$.fromLngLat(f.center,f.elevation);u.z=p.z+Math.cos(f.pitchInRadians)*f.cameraToCenterDistance/f.worldSize;const y=f.getCoveringTilesDetailsProvider(),w=y.allowVariableZoom(f,e),T=oi(f,e),k=e.minzoom||0,E=e.maxzoom!==void 0?e.maxzoom:f.maxZoom,D=Math.min(Math.max(0,T),E),R=Math.pow(2,D),$=[R*u.x,R*u.y,0],N=[R*p.x,R*p.y,0],K=Math.hypot(p.x-u.x,p.y-u.y),Y=Math.abs(p.z-u.z),J=Math.hypot(K,Y),re=ue=>({zoom:0,x:0,y:0,wrap:ue,fullyVisible:!1}),ne=[],le=[];if(f.renderWorldCopies&&y.allowWorldCopies())for(let ue=1;ue<=3;ue++)ne.push(re(-ue)),ne.push(re(ue));for(ne.push(re(0));ne.length>0;){const ue=ne.pop(),fe=ue.x,he=ue.y;let be=ue.fullyVisible;const we={x:fe,y:he,z:ue.zoom},Ae=y.getTileAABB(we,ue.wrap,f.elevation,e);if(!be){const Xe=ho(r,Ae,l);if(Xe===0)continue;be=Xe===2}const Re=y.distanceToTile2d(u.x,u.y,we,Ae);let Ee=T;w&&(Ee=(e.calculateTileZoom||_i)(f.zoom+c.aa(f.tileSize/e.tileSize),Re,Y,J,f.fov)),Ee=(e.roundZoom?Math.round:Math.floor)(Ee),Ee=Math.max(0,Ee);const Ke=Math.min(Ee,E);if(ue.wrap=y.getWrap(p,we,ue.wrap),ue.zoom>=Ke){if(ue.zoom<k)continue;const Xe=D-ue.zoom,$e=$[0]-.5-(fe<<Xe),mt=$[1]-.5-(he<<Xe),xt=e.reparseOverscaled?Math.max(ue.zoom,Ee):ue.zoom;le.push({tileID:new c.Y(ue.zoom===E?xt:ue.zoom,ue.wrap,ue.zoom,fe,he),distanceSq:c.ab([N[0]-.5-fe,N[1]-.5-he]),tileDistanceToCamera:Math.sqrt($e*$e+mt*mt)})}else for(let Xe=0;Xe<4;Xe++)ne.push({zoom:ue.zoom+1,x:(fe<<1)+Xe%2,y:(he<<1)+(Xe>>1),wrap:ue.wrap,fullyVisible:be})}return le.sort((ue,fe)=>ue.distanceSq-fe.distanceSq).map(ue=>ue.tileID)}class A extends c.E{constructor(e,r,l){super(),this.id=e,this.dispatcher=l,this.on("data",u=>this._dataHandler(u)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((u,p,y,w)=>{const T=new(Ct(p.type))(u,p,y,w);if(T.id!==u)throw new Error(`Expected Source id to be ${u} instead of ${T.id}`);return T})(e,r,l,this),this._tiles={},this._cache=new Ir(0,u=>this._unloadTile(u)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new xo,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,r,l){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,l)}catch(u){e.state="errored",u.status!==404?this._source.fire(new c.k(u,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const l=this._tiles[r];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Z).map(e=>e.key)}getRenderableIds(e){const r=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&r.push(this._tiles[l]);return e?r.sort((l,u)=>{const p=l.tileID,y=u.tileID,w=new c.P(p.canonical.x,p.canonical.y)._rotate(-this.transform.bearingInRadians),T=new c.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians);return p.overscaledZ-y.overscaledZ||T.y-w.y||T.x-w.x}).map(l=>l.tileID.key):r.map(l=>l.tileID).sort(Z).map(l=>l.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)(e||this._tiles[r].state!=="errored")&&this._reloadTile(r,"reloading")}}_reloadTile(e,r){return c._(this,void 0,void 0,function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=r),yield this._loadTile(l,e,r))})}_tileLoaded(e,r,l){e.timeAdded=Q.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const r=this.getRenderableIds();for(let u=0;u<r.length;u++){const p=r[u];if(e.neighboringTiles&&e.neighboringTiles[p]){const y=this.getTileByID(p);l(e,y),l(y,e)}}function l(u,p){u.needsHillshadePrepare=!0,u.needsTerrainPrepare=!0;let y=p.tileID.canonical.x-u.tileID.canonical.x;const w=p.tileID.canonical.y-u.tileID.canonical.y,T=Math.pow(2,u.tileID.canonical.z),k=p.tileID.key;y===0&&w===0||Math.abs(w)>1||(Math.abs(y)>1&&(Math.abs(y+T)===1?y+=T:Math.abs(y-T)===1&&(y-=T)),p.dem&&u.dem&&(u.dem.backfillBorder(p.dem,y,w),u.neighboringTiles&&u.neighboringTiles[k]&&(u.neighboringTiles[k].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,l,u){for(const p in this._tiles){let y=this._tiles[p];if(u[p]||!y.hasData()||y.tileID.overscaledZ<=r||y.tileID.overscaledZ>l)continue;let w=y.tileID;for(;y&&y.tileID.overscaledZ>r+1;){const k=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[k.key],y&&y.hasData()&&(w=k)}let T=w;for(;T.overscaledZ>r;)if(T=T.scaledTo(T.overscaledZ-1),e[T.key]||e[T.canonical.key]){u[w.key]=w;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=r?l:null}for(let l=e.overscaledZ-1;l>=r;l--){const u=e.scaledTo(l),p=this._getLoadedTile(u);if(p)return p}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const r=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,u=Math.floor(r*l*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),p=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,u):u;this._cache.setMaxSize(p)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const l={};for(const u in this._tiles){const p=this._tiles[u];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+r),l[p.tileID.key]=p}this._tiles=l;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(u,this._tiles[u])}}_updateCoveredAndRetainedTiles(e,r,l,u,p,y){const w={},T={},k=Object.keys(e),E=Q.now();for(const D of k){const R=e[D],$=this._tiles[D];if(!$||$.fadeEndTime!==0&&$.fadeEndTime<=E)continue;const N=this.findLoadedParent(R,r),K=this.findLoadedSibling(R),Y=N||K||null;Y&&(this._addTile(Y.tileID),w[Y.tileID.key]=Y.tileID),T[D]=R}this._retainLoadedChildren(T,u,l,e);for(const D in w)e[D]||(this._coveredTiles[D]=!0,e[D]=w[D]);if(y){const D={},R={};for(const $ of p)this._tiles[$.key].hasData()?D[$.key]=$:R[$.key]=$;for(const $ in R){const N=R[$].children(this._source.maxzoom);this._tiles[N[0].key]&&this._tiles[N[1].key]&&this._tiles[N[2].key]&&this._tiles[N[3].key]&&(D[N[0].key]=e[N[0].key]=N[0],D[N[1].key]=e[N[1].key]=N[1],D[N[2].key]=e[N[2].key]=N[2],D[N[3].key]=e[N[3].key]=N[3],delete R[$])}for(const $ in R){const N=R[$],K=this.findLoadedParent(N,this._source.minzoom),Y=this.findLoadedSibling(N),J=K||Y||null;if(J){D[J.tileID.key]=e[J.tileID.key]=J.tileID;for(const re in D)D[re].isChildOf(J.tileID)&&delete D[re]}}for(const $ in this._tiles)D[$]||(this._coveredTiles[$]=!0)}}update(e,r){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(E=>new c.Y(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y)):(l=ge(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter(E=>this._source.hasTile(E)))):l=[];const u=oi(e,this._source),p=Math.max(u-A.maxOverzooming,this._source.minzoom),y=Math.max(u+A.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const E={};for(const D of l)if(D.canonical.z>this._source.minzoom){const R=D.scaledTo(D.canonical.z-1);E[R.key]=R;const $=D.scaledTo(Math.max(this._source.minzoom,Math.min(D.canonical.z,5)));E[$.key]=$}l=l.concat(Object.values(E))}const w=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(l,u);X(this._source.type)&&this._updateCoveredAndRetainedTiles(T,p,y,u,l,r);for(const E in T)this._tiles[E].clearFadeHold();const k=c.ae(this._tiles,T);for(const E of k){const D=this._tiles[E];D.hasSymbolBuckets&&!D.holdingForFade()?D.setHoldDuration(this.map._fadeDuration):D.hasSymbolBuckets&&!D.symbolFadeFinished()||this._removeTile(E)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,r){var l;const u={},p={},y=Math.max(r-A.maxOverzooming,this._source.minzoom),w=Math.max(r+A.maxUnderzooming,this._source.minzoom),T={};for(const k of e){const E=this._addTile(k);u[k.key]=k,E.hasData()||r<this._source.maxzoom&&(T[k.key]=k)}this._retainLoadedChildren(T,r,w,u);for(const k of e){let E=this._tiles[k.key];if(E.hasData())continue;if(r+1>this._source.maxzoom){const R=k.children(this._source.maxzoom)[0],$=this.getTile(R);if($&&$.hasData()){u[R.key]=R;continue}}else{const R=k.children(this._source.maxzoom);if(u[R[0].key]&&u[R[1].key]&&u[R[2].key]&&u[R[3].key])continue}let D=E.wasRequested();for(let R=k.overscaledZ-1;R>=y;--R){const $=k.scaledTo(R);if(p[$.key])break;if(p[$.key]=!0,E=this.getTile($),!E&&D&&(E=this._addTile($)),E){const N=E.hasData();if((N||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||D)&&(u[$.key]=$),D=E.wasRequested(),N)break}}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let l,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){l=this._loadedParentTiles[u.key];break}r.push(u.key);const p=u.scaledTo(u.overscaledZ-1);if(l=this._getLoadedTile(p),l)break;u=p}for(const p of r)this._loadedParentTiles[p]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const r=this._tiles[e].tileID,l=this._getLoadedTile(r);this._loadedSiblingTiles[r.key]=l}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const l=r;return r||(r=new Br(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,l||this._source.fire(new c.l("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=r.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(e){const r=e.sourceDataType;e.dataType==="source"&&r==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&r==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,l){const u=[],p=this.transform;if(!p)return u;const y=l?p.getCameraQueryGeometry(e):e,w=e.map(N=>p.screenPointToMercatorCoordinate(N,this.terrain)),T=y.map(N=>p.screenPointToMercatorCoordinate(N,this.terrain)),k=this.getIds();let E=1/0,D=1/0,R=-1/0,$=-1/0;for(const N of T)E=Math.min(E,N.x),D=Math.min(D,N.y),R=Math.max(R,N.x),$=Math.max($,N.y);for(let N=0;N<k.length;N++){const K=this._tiles[k[N]];if(K.holdingForFade())continue;const Y=K.tileID,J=Math.pow(2,p.zoom-K.tileID.overscaledZ),re=r*K.queryPadding*c.Z/K.tileSize/J,ne=[Y.getTilePoint(new c.$(E,D)),Y.getTilePoint(new c.$(R,$))];if(ne[0].x-re<c.Z&&ne[0].y-re<c.Z&&ne[1].x+re>=0&&ne[1].y+re>=0){const le=w.map(fe=>Y.getTilePoint(fe)),ue=T.map(fe=>Y.getTilePoint(fe));u.push({tile:K,tileID:Y,queryGeometry:le,cameraQueryGeometry:ue,scale:J})}}return u}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);return this.transform&&this.transform.populateCache(r),r}hasTransition(){if(this._source.hasTransition())return!0;if(X(this._source.type)){const e=Q.now();for(const r in this._tiles)if(this._tiles[r].fadeEndTime>=e)return!0}return!1}setFeatureState(e,r,l){this._state.updateState(e=e||"_geojsonTileLayer",r,l)}removeFeatureState(e,r,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,l)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,l){const u=this._tiles[e];u&&u.setDependencies(r,l)}reloadTilesForDependencies(e,r){for(const l in this._tiles)this._tiles[l].hasDependency(e,r)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(e,r))}}function Z(f,e){const r=Math.abs(2*f.wrap)-+(f.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return f.overscaledZ-e.overscaledZ||l-r||e.canonical.y-f.canonical.y||e.canonical.x-f.canonical.x}function X(f){return f==="raster"||f==="image"||f==="video"}A.maxOverzooming=10,A.maxUnderzooming=3;class te{constructor(e,r){this.reset(e,r)}reset(e,r){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ad(e,0,1);let r=1,l=this._distances[r];const u=e*this.paddedLength+this.padding;for(;l<u&&r<this._distances.length;)l=this._distances[++r];const p=r-1,y=this._distances[p],w=l-y,T=w>0?(u-y)/w:0;return this.points[p].mult(1-T).add(this.points[r].mult(T))}}function ce(f,e){let r=!0;return f==="always"||f!=="never"&&e!=="never"||(r=!1),r}class _e{constructor(e,r,l){const u=this.boxCells=[],p=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(r/l);for(let y=0;y<this.xCellCount*this.yCellCount;y++)u.push([]),p.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,r,l,u,p){this._forEachCell(r,l,u,p,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(p)}insertCircle(e,r,l,u){this._forEachCell(r-u,l-u,r+u,l+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(r),this.circles.push(l),this.circles.push(u)}_insertBoxCell(e,r,l,u,p,y){this.boxCells[p].push(y)}_insertCircleCell(e,r,l,u,p,y){this.circleCells[p].push(y)}_query(e,r,l,u,p,y,w){if(l<0||e>this.width||u<0||r>this.height)return[];const T=[];if(e<=0&&r<=0&&this.width<=l&&this.height<=u){if(p)return[{key:null,x1:e,y1:r,x2:l,y2:u}];for(let k=0;k<this.boxKeys.length;k++)T.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const E=this.circles[3*k],D=this.circles[3*k+1],R=this.circles[3*k+2];T.push({key:this.circleKeys[k],x1:E-R,y1:D-R,x2:E+R,y2:D+R})}}else this._forEachCell(e,r,l,u,this._queryCell,T,{hitTest:p,overlapMode:y,seenUids:{box:{},circle:{}}},w);return T}query(e,r,l,u){return this._query(e,r,l,u,!1,null)}hitTest(e,r,l,u,p,y){return this._query(e,r,l,u,!0,p,y).length>0}hitTestCircle(e,r,l,u,p){const y=e-l,w=e+l,T=r-l,k=r+l;if(w<0||y>this.width||k<0||T>this.height)return!1;const E=[];return this._forEachCell(y,T,w,k,this._queryCellCircle,E,{hitTest:!0,overlapMode:u,circle:{x:e,y:r,radius:l},seenUids:{box:{},circle:{}}},p),E.length>0}_queryCell(e,r,l,u,p,y,w,T){const{seenUids:k,hitTest:E,overlapMode:D}=w,R=this.boxCells[p];if(R!==null){const N=this.bboxes;for(const K of R)if(!k.box[K]){k.box[K]=!0;const Y=4*K,J=this.boxKeys[K];if(e<=N[Y+2]&&r<=N[Y+3]&&l>=N[Y+0]&&u>=N[Y+1]&&(!T||T(J))&&(!E||!ce(D,J.overlapMode))&&(y.push({key:J,x1:N[Y],y1:N[Y+1],x2:N[Y+2],y2:N[Y+3]}),E))return!0}}const $=this.circleCells[p];if($!==null){const N=this.circles;for(const K of $)if(!k.circle[K]){k.circle[K]=!0;const Y=3*K,J=this.circleKeys[K];if(this._circleAndRectCollide(N[Y],N[Y+1],N[Y+2],e,r,l,u)&&(!T||T(J))&&(!E||!ce(D,J.overlapMode))){const re=N[Y],ne=N[Y+1],le=N[Y+2];if(y.push({key:J,x1:re-le,y1:ne-le,x2:re+le,y2:ne+le}),E)return!0}}}return!1}_queryCellCircle(e,r,l,u,p,y,w,T){const{circle:k,seenUids:E,overlapMode:D}=w,R=this.boxCells[p];if(R!==null){const N=this.bboxes;for(const K of R)if(!E.box[K]){E.box[K]=!0;const Y=4*K,J=this.boxKeys[K];if(this._circleAndRectCollide(k.x,k.y,k.radius,N[Y+0],N[Y+1],N[Y+2],N[Y+3])&&(!T||T(J))&&!ce(D,J.overlapMode))return y.push(!0),!0}}const $=this.circleCells[p];if($!==null){const N=this.circles;for(const K of $)if(!E.circle[K]){E.circle[K]=!0;const Y=3*K,J=this.circleKeys[K];if(this._circlesCollide(N[Y],N[Y+1],N[Y+2],k.x,k.y,k.radius)&&(!T||T(J))&&!ce(D,J.overlapMode))return y.push(!0),!0}}}_forEachCell(e,r,l,u,p,y,w,T){const k=this._convertToXCellCoord(e),E=this._convertToYCellCoord(r),D=this._convertToXCellCoord(l),R=this._convertToYCellCoord(u);for(let $=k;$<=D;$++)for(let N=E;N<=R;N++)if(p.call(this,e,r,l,u,this.xCellCount*N+$,y,w,T))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,r,l,u,p,y){const w=u-e,T=p-r,k=l+y;return k*k>w*w+T*T}_circleAndRectCollide(e,r,l,u,p,y,w){const T=(y-u)/2,k=Math.abs(e-(u+T));if(k>T+l)return!1;const E=(w-p)/2,D=Math.abs(r-(p+E));if(D>E+l)return!1;if(k<=T||D<=E)return!0;const R=k-T,$=D-E;return R*R+$*$<=l*l}}function Ce(f,e,r){const l=c.K();if(!f){const{vecSouth:D,vecEast:R}=ze(e),$=U();$[0]=R[0],$[1]=R[1],$[2]=D[0],$[3]=D[1],u=$,(E=(y=(p=$)[0])*(k=p[3])-(T=p[2])*(w=p[1]))&&(u[0]=k*(E=1/E),u[1]=-w*E,u[2]=-T*E,u[3]=y*E),l[0]=$[0],l[1]=$[1],l[4]=$[2],l[5]=$[3]}var u,p,y,w,T,k,E;return c.M(l,l,[1/r,1/r,1]),l}function me(f,e,r,l){if(f){const u=c.K();if(!e){const{vecSouth:p,vecEast:y}=ze(r);u[0]=y[0],u[1]=y[1],u[4]=p[0],u[5]=p[1]}return c.M(u,u,[l,l,1]),u}return r.pixelsToClipSpaceMatrix}function ze(f){const e=Math.cos(f.rollInRadians),r=Math.sin(f.rollInRadians),l=Math.cos(f.pitchInRadians),u=Math.cos(f.bearingInRadians),p=Math.sin(f.bearingInRadians),y=c.aj();y[0]=-u*l*r-p*e,y[1]=-p*l*r+u*e;const w=c.ak(y);w<1e-9?c.al(y):c.am(y,y,1/w);const T=c.aj();T[0]=u*l*e-p*r,T[1]=p*l*e+u*r;const k=c.ak(T);return k<1e-9?c.al(T):c.am(T,T,1/k),{vecEast:T,vecSouth:y}}function Pe(f,e,r,l){let u;l?(u=[f,e,l(f,e),1],c.ao(u,u,r)):(u=[f,e,0,1],Hr(u,u,r));const p=u[3];return{point:new c.P(u[0]/p,u[1]/p),signedDistanceFromCamera:p,isOccluded:!1}}function ye(f,e){return .5+f/e*.5}function Fe(f,e){return f.x>=-e[0]&&f.x<=e[0]&&f.y>=-e[1]&&f.y<=e[1]}function ve(f,e,r,l,u,p,y,w,T,k,E,D,R){const $=r?f.textSizeData:f.iconSizeData,N=c.af($,e.transform.zoom),K=[256/e.width*2+1,256/e.height*2+1],Y=r?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;Y.clear();const J=f.lineVertexArray,re=r?f.text.placedSymbolArray:f.icon.placedSymbolArray,ne=e.transform.width/e.transform.height;let le=!1;for(let ue=0;ue<re.length;ue++){const fe=re.get(ue);if(fe.hidden||fe.writingMode===c.ag.vertical&&!le){Vr(fe.numGlyphs,Y);continue}le=!1;const he=new c.P(fe.anchorX,fe.anchorY),be={getElevation:R,pitchedLabelPlaneMatrix:l,lineVertexArray:J,pitchWithMap:p,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:he,unwrappedTileID:T,width:k,height:E,translation:D},we=Ot(fe.anchorX,fe.anchorY,be);if(!Fe(we.point,K)){Vr(fe.numGlyphs,Y);continue}const Ae=ye(e.transform.cameraToCenterDistance,we.signedDistanceFromCamera),Re=c.ah($,N,fe),Ee=p?Re*e.transform.getPitchedTextCorrection(fe.anchorX,fe.anchorY,T)/Ae:Re*Ae,Ke=Lt({projectionContext:be,pitchedLabelPlaneMatrixInverse:u,symbol:fe,fontSize:Ee,flip:!1,keepUpright:y,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:Y,aspectRatio:ne,rotateToLine:w});le=Ke.useVertical,(Ke.notEnoughRoom||le||Ke.needsFlipping&&Lt({projectionContext:be,pitchedLabelPlaneMatrixInverse:u,symbol:fe,fontSize:Ee,flip:!0,keepUpright:y,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:Y,aspectRatio:ne,rotateToLine:w}).notEnoughRoom)&&Vr(fe.numGlyphs,Y)}r?f.text.dynamicLayoutVertexBuffer.updateData(Y):f.icon.dynamicLayoutVertexBuffer.updateData(Y)}function tt(f,e,r,l,u,p,y,w){const T=p.glyphStartIndex+p.numGlyphs,k=p.lineStartIndex,E=p.lineStartIndex+p.lineLength,D=e.getoffsetX(p.glyphStartIndex),R=e.getoffsetX(T-1),$=Tt(f*D,r,l,u,p.segment,k,E,w,y);if(!$)return null;const N=Tt(f*R,r,l,u,p.segment,k,E,w,y);return N?w.projectionCache.anyProjectionOccluded?null:{first:$,last:N}:null}function yt(f,e,r,l){return f===c.ag.horizontal&&Math.abs(r.y-e.y)>Math.abs(r.x-e.x)*l?{useVertical:!0}:(f===c.ag.vertical?e.y<r.y:e.x>r.x)?{needsFlipping:!0}:null}function Lt(f){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:r,symbol:l,fontSize:u,flip:p,keepUpright:y,glyphOffsetArray:w,dynamicLayoutVertexArray:T,aspectRatio:k,rotateToLine:E}=f,D=u/24,R=l.lineOffsetX*D,$=l.lineOffsetY*D;let N;if(l.numGlyphs>1){const K=l.glyphStartIndex+l.numGlyphs,Y=l.lineStartIndex,J=l.lineStartIndex+l.lineLength,re=tt(D,w,R,$,p,l,E,e);if(!re)return{notEnoughRoom:!0};const ne=ht(re.first.point.x,re.first.point.y,e,r),le=ht(re.last.point.x,re.last.point.y,e,r);if(y&&!p){const ue=yt(l.writingMode,ne,le,k);if(ue)return ue}N=[re.first];for(let ue=l.glyphStartIndex+1;ue<K-1;ue++)N.push(Tt(D*w.getoffsetX(ue),R,$,p,l.segment,Y,J,e,E));N.push(re.last)}else{if(y&&!p){const Y=pt(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,J=l.lineStartIndex+l.segment+1,re=new c.P(e.lineVertexArray.getx(J),e.lineVertexArray.gety(J)),ne=pt(re.x,re.y,e),le=ne.signedDistanceFromCamera>0?ne.point:It(e.tileAnchorPoint,re,Y,1,e),ue=ht(Y.x,Y.y,e,r),fe=ht(le.x,le.y,e,r),he=yt(l.writingMode,ue,fe,k);if(he)return he}const K=Tt(D*w.getoffsetX(l.glyphStartIndex),R,$,p,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,E);if(!K||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};N=[K]}for(const K of N)c.an(T,K.point,K.angle);return{}}function It(f,e,r,l,u){const p=f.add(f.sub(e)._unit()),y=pt(p.x,p.y,u).point,w=r.sub(y);return r.add(w._mult(l/w.mag()))}function Be(f,e,r){const l=e.projectionCache;if(l.projections[f])return l.projections[f];const u=new c.P(e.lineVertexArray.getx(f),e.lineVertexArray.gety(f)),p=pt(u.x,u.y,e);if(p.signedDistanceFromCamera>0)return l.projections[f]=p.point,l.anyProjectionOccluded=l.anyProjectionOccluded||p.isOccluded,p.point;const y=f-r.direction;return It(r.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(y),e.lineVertexArray.gety(y)),u,r.previousVertex,r.absOffsetX-r.distanceFromAnchor+1,e)}function pt(f,e,r){const l=f+r.translation[0],u=e+r.translation[1];let p;return r.pitchWithMap?(p=Pe(l,u,r.pitchedLabelPlaneMatrix,r.getElevation),p.isOccluded=!1):(p=r.transform.projectTileCoordinates(l,u,r.unwrappedTileID,r.getElevation),p.point.x=(.5*p.point.x+.5)*r.width,p.point.y=(.5*-p.point.y+.5)*r.height),p}function ht(f,e,r,l){if(r.pitchWithMap){const u=[f,e,0,1];return c.ao(u,u,l),r.transform.projectTileCoordinates(u[0]/u[3],u[1]/u[3],r.unwrappedTileID,r.getElevation).point}return{x:f/r.width*2-1,y:e/r.height*2-1}}function Ot(f,e,r){return r.transform.projectTileCoordinates(f,e,r.unwrappedTileID,r.getElevation)}function At(f,e,r){return f._unit()._perp()._mult(e*r)}function jt(f,e,r,l,u,p,y,w,T){if(w.projectionCache.offsets[f])return w.projectionCache.offsets[f];const k=r.add(e);if(f+T.direction<l||f+T.direction>=u)return w.projectionCache.offsets[f]=k,k;const E=Be(f+T.direction,w,T),D=At(E.sub(r),y,T.direction),R=r.add(D),$=E.add(D);return w.projectionCache.offsets[f]=c.ap(p,k,R,$)||k,w.projectionCache.offsets[f]}function Tt(f,e,r,l,u,p,y,w,T){const k=l?f-e:f+e;let E=k>0?1:-1,D=0;l&&(E*=-1,D=Math.PI),E<0&&(D+=Math.PI);let R,$=E>0?p+u:p+u+1;w.projectionCache.cachedAnchorPoint?R=w.projectionCache.cachedAnchorPoint:(R=pt(w.tileAnchorPoint.x,w.tileAnchorPoint.y,w).point,w.projectionCache.cachedAnchorPoint=R);let N,K,Y=R,J=R,re=0,ne=0;const le=Math.abs(k),ue=[];let fe;for(;re+ne<=le;){if($+=E,$<p||$>=y)return null;re+=ne,J=Y,K=N;const we={absOffsetX:le,direction:E,distanceFromAnchor:re,previousVertex:J};if(Y=Be($,w,we),r===0)ue.push(J),fe=Y.sub(J);else{let Ae;const Re=Y.sub(J);Ae=Re.mag()===0?At(Be($+E,w,we).sub(Y),r,E):At(Re,r,E),K||(K=J.add(Ae)),N=jt($,Ae,Y,p,y,K,r,w,we),ue.push(K),fe=N.sub(K)}ne=fe.mag()}const he=fe._mult((le-re)/ne)._add(K||J),be=D+Math.atan2(Y.y-J.y,Y.x-J.x);return ue.push(he),{point:he,angle:T?be:0,path:ue}}const mn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Vr(f,e){for(let r=0;r<f;r++){const l=e.length;e.resize(l+4),e.float32.set(mn,3*l)}}function Hr(f,e,r){const l=e[0],u=e[1];return f[0]=r[0]*l+r[4]*u+r[12],f[1]=r[1]*l+r[5]*u+r[13],f[3]=r[3]*l+r[7]*u+r[15],f}const _r=100;class _a{constructor(e,r=new _e(e.width+200,e.height+200,25),l=new _e(e.width+200,e.height+200,25)){this.transform=e,this.grid=r,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+_r,this.screenBottomBoundary=e.height+_r,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,r,l,u,p,y,w,T,k,E,D,R){const $=this.projectAndGetPerspectiveRatio(e.anchorPointX+T[0],e.anchorPointY+T[1],p,E,R),N=l*$.perspectiveRatio;let K;if(y||w)K=this._projectCollisionBox(e,N,u,p,y,w,T,$,E,D,R);else{const fe=$.x+(D?D.x*N:0),he=$.y+(D?D.y*N:0);K={allPointsOccluded:!1,box:[fe+e.x1*N,he+e.y1*N,fe+e.x2*N,he+e.y2*N]}}const[Y,J,re,ne]=K.box,le=y?K.allPointsOccluded:$.isOccluded;let ue=le;return ue||(ue=$.perspectiveRatio<this.perspectiveRatioCutoff),ue||(ue=!this.isInsideGrid(Y,J,re,ne)),ue||r!=="always"&&this.grid.hitTest(Y,J,re,ne,r,k)?{box:[Y,J,re,ne],placeable:!1,offscreen:!1,occluded:le}:{box:[Y,J,re,ne],placeable:!0,offscreen:this.isOffscreen(Y,J,re,ne),occluded:le}}placeCollisionCircles(e,r,l,u,p,y,w,T,k,E,D,R,$,N){const K=[],Y=new c.P(r.anchorX,r.anchorY),J=this.getPerspectiveRatio(Y.x,Y.y,y,N),re=(k?p*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,y)/J:p*J)/c.au,ne={getElevation:N,pitchedLabelPlaneMatrix:w,lineVertexArray:l,pitchWithMap:k,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Y,unwrappedTileID:y,width:this.transform.width,height:this.transform.height,translation:$},le=tt(re,u,r.lineOffsetX*re,r.lineOffsetY*re,!1,r,!1,ne);let ue=!1,fe=!1,he=!0;if(le){const be=.5*D*J+R,we=new c.P(-100,-100),Ae=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Re=new te,Ee=le.first,Ke=le.last;let Xe=[];for(let xt=Ee.path.length-1;xt>=1;xt--)Xe.push(Ee.path[xt]);for(let xt=1;xt<Ke.path.length;xt++)Xe.push(Ke.path[xt]);const $e=2.5*be;if(k){const xt=this.projectPathToScreenSpace(Xe,ne);Xe=xt.some(er=>er.signedDistanceFromCamera<=0)?[]:xt.map(er=>er.point)}let mt=[];if(Xe.length>0){const xt=Xe[0].clone(),er=Xe[0].clone();for(let fr=1;fr<Xe.length;fr++)xt.x=Math.min(xt.x,Xe[fr].x),xt.y=Math.min(xt.y,Xe[fr].y),er.x=Math.max(er.x,Xe[fr].x),er.y=Math.max(er.y,Xe[fr].y);mt=xt.x>=we.x&&er.x<=Ae.x&&xt.y>=we.y&&er.y<=Ae.y?[Xe]:er.x<we.x||xt.x>Ae.x||er.y<we.y||xt.y>Ae.y?[]:c.aq([Xe],we.x,we.y,Ae.x,Ae.y)}for(const xt of mt){Re.reset(xt,.25*be);let er=0;er=Re.length<=.5*be?1:Math.ceil(Re.paddedLength/$e)+1;for(let fr=0;fr<er;fr++){const ar=fr/Math.max(er-1,1),Cr=Re.lerp(ar),yr=Cr.x+_r,rr=Cr.y+_r;K.push(yr,rr,be,0);const lr=yr-be,no=rr-be,so=yr+be,Xr=rr+be;if(he=he&&this.isOffscreen(lr,no,so,Xr),fe=fe||this.isInsideGrid(lr,no,so,Xr),e!=="always"&&this.grid.hitTestCircle(yr,rr,be,e,E)&&(ue=!0,!T))return{circles:[],offscreen:!1,collisionDetected:ue}}}}return{circles:!T&&ue||!fe||J<this.perspectiveRatioCutoff?[]:K,offscreen:he,collisionDetected:ue}}projectPathToScreenSpace(e,r){const l=function(u,p){const y=c.K();return c.ai(y,p.pitchedLabelPlaneMatrix),u.map(w=>{const T=Pe(w.x,w.y,y,p.getElevation),k=p.transform.projectTileCoordinates(T.point.x,T.point.y,p.unwrappedTileID,p.getElevation);return k.point.x=(.5*k.point.x+.5)*p.width,k.point.y=(.5*-k.point.y+.5)*p.height,k})}(e,r);return function(u){let p=0,y=0,w=0,T=0;for(let k=0;k<u.length;k++)u[k].isOccluded?(w=k+1,T=0):(T++,T>y&&(y=T,p=w));return u.slice(p,p+y)}(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[];let l=1/0,u=1/0,p=-1/0,y=-1/0;for(const E of e){const D=new c.P(E.x+_r,E.y+_r);l=Math.min(l,D.x),u=Math.min(u,D.y),p=Math.max(p,D.x),y=Math.max(y,D.y),r.push(D)}const w=this.grid.query(l,u,p,y).concat(this.ignoredGrid.query(l,u,p,y)),T={},k={};for(const E of w){const D=E.key;if(T[D.bucketInstanceId]===void 0&&(T[D.bucketInstanceId]={}),T[D.bucketInstanceId][D.featureIndex])continue;const R=[new c.P(E.x1,E.y1),new c.P(E.x2,E.y1),new c.P(E.x2,E.y2),new c.P(E.x1,E.y2)];c.ar(r,R)&&(T[D.bucketInstanceId][D.featureIndex]=!0,k[D.bucketInstanceId]===void 0&&(k[D.bucketInstanceId]=[]),k[D.bucketInstanceId].push(D.featureIndex))}return k}insertCollisionBox(e,r,l,u,p,y){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:u,featureIndex:p,collisionGroupID:y,overlapMode:r},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,r,l,u,p,y){const w=l?this.ignoredGrid:this.grid,T={bucketInstanceId:u,featureIndex:p,collisionGroupID:y,overlapMode:r};for(let k=0;k<e.length;k+=4)w.insertCircle(T,e[k],e[k+1],e[k+2])}projectAndGetPerspectiveRatio(e,r,l,u,p){if(p){let y;u?(y=[e,r,u(e,r),1],c.ao(y,y,p)):(y=[e,r,0,1],Hr(y,y,p));const w=y[3];return{x:(y[0]/w+1)/2*this.transform.width+_r,y:(-y[1]/w+1)/2*this.transform.height+_r,perspectiveRatio:.5+this.transform.cameraToCenterDistance/w*.5,isOccluded:!1,signedDistanceFromCamera:w}}{const y=this.transform.projectTileCoordinates(e,r,l,u);return{x:(y.point.x+1)/2*this.transform.width+_r,y:(1-y.point.y)/2*this.transform.height+_r,perspectiveRatio:.5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5,isOccluded:y.isOccluded,signedDistanceFromCamera:y.signedDistanceFromCamera}}}getPerspectiveRatio(e,r,l,u){const p=this.transform.projectTileCoordinates(e,r,l,u);return .5+this.transform.cameraToCenterDistance/p.signedDistanceFromCamera*.5}isOffscreen(e,r,l,u){return l<_r||e>=this.screenRightBoundary||u<_r||r>this.screenBottomBoundary}isInsideGrid(e,r,l,u){return l>=0&&e<this.gridRightBoundary&&u>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const e=c.as([]);return c.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,r,l,u,p,y,w,T,k,E,D){let R=1,$=0,N=0,K=1;const Y=e.anchorPointX+w[0],J=e.anchorPointY+w[1];if(y&&!p){const Xe=this.projectAndGetPerspectiveRatio(Y+1,J,u,k,D),$e=Xe.x-T.x,mt=Math.atan((Xe.y-T.y)/$e)+($e<0?Math.PI:0),xt=Math.sin(mt),er=Math.cos(mt);R=er,$=xt,N=-xt,K=er}else if(!y&&p){const Xe=ze(this.transform);R=Xe.vecEast[0],$=Xe.vecEast[1],N=Xe.vecSouth[0],K=Xe.vecSouth[1]}let re=T.x,ne=T.y,le=r;p&&(re=Y,ne=J,le=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),le*=this.transform.getPitchedTextCorrection(Y,J,u),E||(le*=c.ad(.5+T.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),E&&(re+=R*E.x*le+N*E.y*le,ne+=$*E.x*le+K*E.y*le);const ue=e.x1*le,fe=e.x2*le,he=(ue+fe)/2,be=e.y1*le,we=e.y2*le,Ae=(be+we)/2,Re=[{offsetX:ue,offsetY:be},{offsetX:he,offsetY:be},{offsetX:fe,offsetY:be},{offsetX:fe,offsetY:Ae},{offsetX:fe,offsetY:we},{offsetX:he,offsetY:we},{offsetX:ue,offsetY:we},{offsetX:ue,offsetY:Ae}];let Ee=[];for(const{offsetX:Xe,offsetY:$e}of Re)Ee.push(new c.P(re+R*Xe+N*$e,ne+$*Xe+K*$e));let Ke=!1;if(p){const Xe=Ee.map($e=>this.projectAndGetPerspectiveRatio($e.x,$e.y,u,k,D));Ke=Xe.some($e=>!$e.isOccluded),Ee=Xe.map($e=>new c.P($e.x,$e.y))}else Ke=!0;return{box:c.at(Ee),allPointsOccluded:!Ke}}}class zo{constructor(e,r,l,u){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?r:-r))):u&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class ur{constructor(e,r,l,u,p){this.text=new zo(e?e.text:null,r,l,p),this.icon=new zo(e?e.icon:null,r,u,p)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class $u{constructor(e,r,l){this.text=e,this.icon=r,this.skipFade=l}}class Ds{constructor(e,r,l,u,p){this.bucketInstanceId=e,this.featureIndex=r,this.sourceLayerIndex=l,this.bucketIndex=u,this.tileID=p}}class Rl{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const r=++this.maxGroupID;this.collisionGroups[e]={ID:r,predicate:l=>l.collisionGroupID===r}}return this.collisionGroups[e]}}function Ji(f,e,r,l,u){const{horizontalAlign:p,verticalAlign:y}=c.aA(f);return new c.P(-(p-.5)*e+l[0]*u,-(y-.5)*r+l[1]*u)}class qn{constructor(e,r,l,u,p){this.transform=e.clone(),this.terrain=r,this.collisionIndex=new _a(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Rl(u),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=p,p&&(p.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const r=this.terrain;return r?(l,u)=>r.getElevation(e,l,u):null}getBucketParts(e,r,l,u){const p=l.getBucket(r),y=l.latestFeatureIndex;if(!p||!y||r.id!==p.layerIds[0])return;const w=l.collisionBoxArray,T=p.layers[0].layout,k=p.layers[0].paint,E=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),D=l.tileSize/c.Z,R=l.tileID.toUnwrapped(),$=T.get("text-rotation-alignment")==="map",N=c.av(l,1,this.transform.zoom),K=c.aw(this.collisionIndex.transform,l,k.get("text-translate"),k.get("text-translate-anchor")),Y=c.aw(this.collisionIndex.transform,l,k.get("icon-translate"),k.get("icon-translate-anchor")),J=Ce($,this.transform,N);this.retainedQueryData[p.bucketInstanceId]=new Ds(p.bucketInstanceId,y,p.sourceLayerIndex,p.index,l.tileID);const re={bucket:p,layout:T,translationText:K,translationIcon:Y,unwrappedTileID:R,pitchedLabelPlaneMatrix:J,scale:E,textPixelRatio:D,holdingForFade:l.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:c.af(p.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(p.sourceID)};if(u)for(const ne of p.sortKeyRanges){const{sortKey:le,symbolInstanceStart:ue,symbolInstanceEnd:fe}=ne;e.push({sortKey:le,symbolInstanceStart:ue,symbolInstanceEnd:fe,parameters:re})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:p.symbolInstances.length,parameters:re})}attemptAnchorPlacement(e,r,l,u,p,y,w,T,k,E,D,R,$,N,K,Y,J,re,ne,le){const ue=c.ax[e.textAnchor],fe=[e.textOffset0,e.textOffset1],he=Ji(ue,l,u,fe,p),be=this.collisionIndex.placeCollisionBox(r,R,T,k,E,w,y,Y,D.predicate,ne,he,le);if((!re||this.collisionIndex.placeCollisionBox(re,R,T,k,E,w,y,J,D.predicate,ne,he,le).placeable)&&be.placeable){let we;if(this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&(we=this.prevPlacement.variableOffsets[$.crossTileID].anchor),$.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[$.crossTileID]={textOffset:fe,width:l,height:u,anchor:ue,textBoxScale:p,prevAnchor:we},this.markUsedJustification(N,ue,$,K),N.allowVerticalPlacement&&(this.markUsedOrientation(N,K,$),this.placedOrientations[$.crossTileID]=K),{shift:he,placedGlyphBoxes:be}}}placeLayerBucketPart(e,r,l){const{bucket:u,layout:p,translationText:y,translationIcon:w,unwrappedTileID:T,pitchedLabelPlaneMatrix:k,textPixelRatio:E,holdingForFade:D,collisionBoxArray:R,partiallyEvaluatedTextSize:$,collisionGroup:N}=e.parameters,K=p.get("text-optional"),Y=p.get("icon-optional"),J=c.ay(p,"text-overlap","text-allow-overlap"),re=J==="always",ne=c.ay(p,"icon-overlap","icon-allow-overlap"),le=ne==="always",ue=p.get("text-rotation-alignment")==="map",fe=p.get("text-pitch-alignment")==="map",he=p.get("icon-text-fit")!=="none",be=p.get("symbol-z-order")==="viewport-y",we=re&&(le||!u.hasIconData()||Y),Ae=le&&(re||!u.hasTextData()||K);!u.collisionArrays&&R&&u.deserializeCollisionBoxes(R);const Re=this.retainedQueryData[u.bucketInstanceId].tileID,Ee=this._getTerrainElevationFunc(Re),Ke=this.transform.getFastPathSimpleProjectionMatrix(Re),Xe=($e,mt,xt)=>{var er,fr;if(r[$e.crossTileID])return;if(D)return void(this.placements[$e.crossTileID]=new $u(!1,!1,!1));let ar=!1,Cr=!1,yr=!0,rr=null,lr={box:null,placeable:!1,offscreen:null,occluded:!1},no={placeable:!1},so=null,Xr=null,po=null,sn=0,Ui=0,Di=0;mt.textFeatureIndex?sn=mt.textFeatureIndex:$e.useRuntimeCollisionCircles&&(sn=$e.featureIndex),mt.verticalTextFeatureIndex&&(Ui=mt.verticalTextFeatureIndex);const di=mt.textBox;if(di){const fi=pr=>{let hr=c.ag.horizontal;if(u.allowVerticalPlacement&&!pr&&this.prevPlacement){const Yr=this.prevPlacement.placedOrientations[$e.crossTileID];Yr&&(this.placedOrientations[$e.crossTileID]=Yr,hr=Yr,this.markUsedOrientation(u,hr,$e))}return hr},Ri=(pr,hr)=>{if(u.allowVerticalPlacement&&$e.numVerticalGlyphVertices>0&&mt.verticalTextBox){for(const Yr of u.writingModes)if(Yr===c.ag.vertical?(lr=hr(),no=lr):lr=pr(),lr&&lr.placeable)break}else lr=pr()},xi=$e.textAnchorOffsetStartIndex,Li=$e.textAnchorOffsetEndIndex;if(Li===xi){const pr=(hr,Yr)=>{const Kr=this.collisionIndex.placeCollisionBox(hr,J,E,Re,T,fe,ue,y,N.predicate,Ee,void 0,Ke);return Kr&&Kr.placeable&&(this.markUsedOrientation(u,Yr,$e),this.placedOrientations[$e.crossTileID]=Yr),Kr};Ri(()=>pr(di,c.ag.horizontal),()=>{const hr=mt.verticalTextBox;return u.allowVerticalPlacement&&$e.numVerticalGlyphVertices>0&&hr?pr(hr,c.ag.vertical):{box:null,offscreen:null}}),fi(lr&&lr.placeable)}else{let pr=c.ax[(fr=(er=this.prevPlacement)===null||er===void 0?void 0:er.variableOffsets[$e.crossTileID])===null||fr===void 0?void 0:fr.anchor];const hr=(Kr,Dn,pf)=>{const Ih=Kr.x2-Kr.x1,Rc=Kr.y2-Kr.y1,Eh=$e.textBoxScale,Rn=he&&ne==="never"?Dn:null;let Ho=null,Lc=J==="never"?1:2,Ah="never";pr&&Lc++;for(let al=0;al<Lc;al++){for(let ll=xi;ll<Li;ll++){const zh=u.textAnchorOffsets.get(ll);if(pr&&zh.textAnchor!==pr)continue;const cl=this.attemptAnchorPlacement(zh,Kr,Ih,Rc,Eh,ue,fe,E,Re,T,N,Ah,$e,u,pf,y,w,Rn,Ee);if(cl&&(Ho=cl.placedGlyphBoxes,Ho&&Ho.placeable))return ar=!0,rr=cl.shift,Ho}pr?pr=null:Ah=J}return l&&!Ho&&(Ho={box:this.collisionIndex.placeCollisionBox(di,"always",E,Re,T,fe,ue,y,N.predicate,Ee,void 0,Ke).box,offscreen:!1,placeable:!1,occluded:!1}),Ho};Ri(()=>hr(di,mt.iconBox,c.ag.horizontal),()=>{const Kr=mt.verticalTextBox;return u.allowVerticalPlacement&&(!lr||!lr.placeable)&&$e.numVerticalGlyphVertices>0&&Kr?hr(Kr,mt.verticalIconBox,c.ag.vertical):{box:null,occluded:!0,offscreen:null}}),lr&&(ar=lr.placeable,yr=lr.offscreen);const Yr=fi(lr&&lr.placeable);if(!ar&&this.prevPlacement){const Kr=this.prevPlacement.variableOffsets[$e.crossTileID];Kr&&(this.variableOffsets[$e.crossTileID]=Kr,this.markUsedJustification(u,Kr.anchor,$e,Yr))}}}if(so=lr,ar=so&&so.placeable,yr=so&&so.offscreen,$e.useRuntimeCollisionCircles){const fi=u.text.placedSymbolArray.get($e.centerJustifiedTextSymbolIndex),Ri=c.ah(u.textSizeData,$,fi),xi=p.get("text-padding");Xr=this.collisionIndex.placeCollisionCircles(J,fi,u.lineVertexArray,u.glyphOffsetArray,Ri,T,k,l,fe,N.predicate,$e.collisionCircleDiameter,xi,y,Ee),Xr.circles.length&&Xr.collisionDetected&&!l&&c.w("Collisions detected, but collision boxes are not shown"),ar=re||Xr.circles.length>0&&!Xr.collisionDetected,yr=yr&&Xr.offscreen}if(mt.iconFeatureIndex&&(Di=mt.iconFeatureIndex),mt.iconBox){const fi=Ri=>this.collisionIndex.placeCollisionBox(Ri,ne,E,Re,T,fe,ue,w,N.predicate,Ee,he&&rr?rr:void 0,Ke);no&&no.placeable&&mt.verticalIconBox?(po=fi(mt.verticalIconBox),Cr=po.placeable):(po=fi(mt.iconBox),Cr=po.placeable),yr=yr&&po.offscreen}const An=K||$e.numHorizontalGlyphVertices===0&&$e.numVerticalGlyphVertices===0,Qs=Y||$e.numIconVertices===0;An||Qs?Qs?An||(Cr=Cr&&ar):ar=Cr&&ar:Cr=ar=Cr&&ar;const zn=Cr&&po.placeable;if(ar&&so.placeable&&this.collisionIndex.insertCollisionBox(so.box,J,p.get("text-ignore-placement"),u.bucketInstanceId,no&&no.placeable&&Ui?Ui:sn,N.ID),zn&&this.collisionIndex.insertCollisionBox(po.box,ne,p.get("icon-ignore-placement"),u.bucketInstanceId,Di,N.ID),Xr&&ar&&this.collisionIndex.insertCollisionCircles(Xr.circles,J,p.get("text-ignore-placement"),u.bucketInstanceId,sn,N.ID),l&&this.storeCollisionData(u.bucketInstanceId,xt,mt,so,po,Xr),$e.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(u.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[$e.crossTileID]=new $u((ar||we)&&!(so!=null&&so.occluded),(Cr||Ae)&&!(po!=null&&po.occluded),yr||u.justReloaded),r[$e.crossTileID]=!0};if(be){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const $e=u.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let mt=$e.length-1;mt>=0;--mt){const xt=$e[mt];Xe(u.symbolInstances.get(xt),u.collisionArrays[xt],xt)}}else for(let $e=e.symbolInstanceStart;$e<e.symbolInstanceEnd;$e++)Xe(u.symbolInstances.get($e),u.collisionArrays[$e],$e);u.justReloaded=!1}storeCollisionData(e,r,l,u,p,y){if(l.textBox||l.iconBox){let w,T;this.collisionBoxArrays.has(e)?w=this.collisionBoxArrays.get(e):(w=new Map,this.collisionBoxArrays.set(e,w)),w.has(r)?T=w.get(r):(T={text:null,icon:null},w.set(r,T)),l.textBox&&(T.text=u.box),l.iconBox&&(T.icon=p.box)}if(y){let w=this.collisionCircleArrays[e];w===void 0&&(w=this.collisionCircleArrays[e]=[]);for(let T=0;T<y.circles.length;T+=4)w.push(y.circles[T+0]-_r),w.push(y.circles[T+1]-_r),w.push(y.circles[T+2]),w.push(y.collisionDetected?1:0)}}markUsedJustification(e,r,l,u){let p;p=u===c.ag.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[c.az(r)];const y=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const w of y)w>=0&&(e.text.placedSymbolArray.get(w).crossTileID=p>=0&&w!==p?0:l.crossTileID)}markUsedOrientation(e,r,l){const u=r===c.ag.horizontal||r===c.ag.horizontalOnly?r:0,p=r===c.ag.vertical?r:0,y=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const w of y)e.text.placedSymbolArray.get(w).placedOrientation=u;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=p)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let l=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const u=r?r.symbolFadeChange(e):1,p=r?r.opacities:{},y=r?r.variableOffsets:{},w=r?r.placedOrientations:{};for(const T in this.placements){const k=this.placements[T],E=p[T];E?(this.opacities[T]=new ur(E,u,k.text,k.icon),l=l||k.text!==E.text.placed||k.icon!==E.icon.placed):(this.opacities[T]=new ur(null,u,k.text,k.icon,k.skipFade),l=l||k.text||k.icon)}for(const T in p){const k=p[T];if(!this.opacities[T]){const E=new ur(k,u,!1,!1);E.isHidden()||(this.opacities[T]=E,l=l||k.text.placed||k.icon.placed)}}for(const T in y)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=y[T]);for(const T in w)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=w[T]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:e)}updateLayerOpacities(e,r){const l={};for(const u of r){const p=u.getBucket(e);p&&u.latestFeatureIndex&&e.id===p.layerIds[0]&&this.updateBucketOpacities(p,u.tileID,l,u.collisionBoxArray)}}updateBucketOpacities(e,r,l,u){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const p=e.layers[0],y=p.layout,w=new ur(null,0,!1,!1,!0),T=y.get("text-allow-overlap"),k=y.get("icon-allow-overlap"),E=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),D=y.get("text-rotation-alignment")==="map",R=y.get("text-pitch-alignment")==="map",$=y.get("icon-text-fit")!=="none",N=new ur(null,0,T&&(k||!e.hasIconData()||y.get("icon-optional")),k&&(T||!e.hasTextData()||y.get("text-optional")),!0);!e.collisionArrays&&u&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(u);const K=(J,re,ne)=>{for(let le=0;le<re/4;le++)J.opacityVertexArray.emplaceBack(ne);J.hasVisibleVertices=J.hasVisibleVertices||ne!==Hn},Y=this.collisionBoxArrays.get(e.bucketInstanceId);for(let J=0;J<e.symbolInstances.length;J++){const re=e.symbolInstances.get(J),{numHorizontalGlyphVertices:ne,numVerticalGlyphVertices:le,crossTileID:ue}=re;let fe=this.opacities[ue];l[ue]?fe=w:fe||(fe=N,this.opacities[ue]=fe),l[ue]=!0;const he=re.numIconVertices>0,be=this.placedOrientations[re.crossTileID],we=be===c.ag.vertical,Ae=be===c.ag.horizontal||be===c.ag.horizontalOnly;if(ne>0||le>0){const Ee=Bl(fe.text);K(e.text,ne,we?Hn:Ee),K(e.text,le,Ae?Hn:Ee);const Ke=fe.text.isHidden();[re.rightJustifiedTextSymbolIndex,re.centerJustifiedTextSymbolIndex,re.leftJustifiedTextSymbolIndex].forEach(mt=>{mt>=0&&(e.text.placedSymbolArray.get(mt).hidden=Ke||we?1:0)}),re.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(re.verticalPlacedTextSymbolIndex).hidden=Ke||Ae?1:0);const Xe=this.variableOffsets[re.crossTileID];Xe&&this.markUsedJustification(e,Xe.anchor,re,be);const $e=this.placedOrientations[re.crossTileID];$e&&(this.markUsedJustification(e,"left",re,$e),this.markUsedOrientation(e,$e,re))}if(he){const Ee=Bl(fe.icon),Ke=!($&&re.verticalPlacedIconSymbolIndex&&we);re.placedIconSymbolIndex>=0&&(K(e.icon,re.numIconVertices,Ke?Ee:Hn),e.icon.placedSymbolArray.get(re.placedIconSymbolIndex).hidden=fe.icon.isHidden()),re.verticalPlacedIconSymbolIndex>=0&&(K(e.icon,re.numVerticalIconVertices,Ke?Hn:Ee),e.icon.placedSymbolArray.get(re.verticalPlacedIconSymbolIndex).hidden=fe.icon.isHidden())}const Re=Y&&Y.has(J)?Y.get(J):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ee=e.collisionArrays[J];if(Ee){let Ke=new c.P(0,0);if(Ee.textBox||Ee.verticalTextBox){let Xe=!0;if(E){const $e=this.variableOffsets[ue];$e?(Ke=Ji($e.anchor,$e.width,$e.height,$e.textOffset,$e.textBoxScale),D&&Ke._rotate(R?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Xe=!1}if(Ee.textBox||Ee.verticalTextBox){let $e;Ee.textBox&&($e=we),Ee.verticalTextBox&&($e=Ae),Ll(e.textCollisionBox.collisionVertexArray,fe.text.placed,!Xe||$e,Re.text,Ke.x,Ke.y)}}if(Ee.iconBox||Ee.verticalIconBox){const Xe=!!(!Ae&&Ee.verticalIconBox);let $e;Ee.iconBox&&($e=Xe),Ee.verticalIconBox&&($e=!Xe),Ll(e.iconCollisionBox.collisionVertexArray,fe.icon.placed,$e,Re.icon,$?Ke.x:0,$?Ke.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,r){const l=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function Ll(f,e,r,l,u,p){l&&l.length!==0||(l=[0,0,0,0]);const y=l[0]-_r,w=l[1]-_r,T=l[2]-_r,k=l[3]-_r;f.emplaceBack(e?1:0,r?1:0,u||0,p||0,y,w),f.emplaceBack(e?1:0,r?1:0,u||0,p||0,T,w),f.emplaceBack(e?1:0,r?1:0,u||0,p||0,T,k),f.emplaceBack(e?1:0,r?1:0,u||0,p||0,y,k)}const ju=Math.pow(2,25),Nu=Math.pow(2,24),Wn=Math.pow(2,17),Vu=Math.pow(2,16),Ud=Math.pow(2,9),Zd=Math.pow(2,8),Gd=Math.pow(2,1);function Bl(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const e=f.placed?1:0,r=Math.floor(127*f.opacity);return r*ju+e*Nu+r*Wn+e*Vu+r*Ud+e*Zd+r*Gd+e}const Hn=0;class Fl{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,r,l,u,p){const y=this._bucketParts;for(;this._currentTileIndex<e.length;)if(r.getBucketParts(y,u,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,p())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,y.sort((w,T)=>w.sortKey-T.sortKey));this._currentPartIndex<y.length;)if(r.placeLayerBucketPart(y[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,p())return!0;return!1}}class Ol{constructor(e,r,l,u,p,y,w,T){this.placement=new qn(e,r,y,w,T),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=u,this._showCollisionBoxes=p,this._done=!1}isDone(){return this._done}continuePlacement(e,r,l){const u=Q.now(),p=()=>!this._forceFullPlacement&&Q.now()-u>2;for(;this._currentPlacementIndex>=0;){const y=r[e[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(y.type==="symbol"&&(!y.minzoom||y.minzoom<=w)&&(!y.maxzoom||y.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Fl(y)),this._inProgressLayer.continuePlacement(l[y.source],this.placement,this._showCollisionBoxes,y,p))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Xn=512/c.Z/2;class $l{constructor(e,r,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const u=new Map;for(let p=0;p<r.length;p++){const y=r.get(p),w=y.key,T=u.get(w);T?T.push(y):u.set(w,[y])}for(const[p,y]of u){const w={positions:y.map(T=>({x:Math.floor(T.anchorX*Xn),y:Math.floor(T.anchorY*Xn)})),crossTileIDs:y.map(T=>T.crossTileID)};if(w.positions.length>128){const T=new c.aB(w.positions.length,16,Uint16Array);for(const{x:k,y:E}of w.positions)T.add(k,E);T.finish(),delete w.positions,w.index=T}this._symbolsByKey[p]=w}}getScaledCoordinates(e,r){const{x:l,y:u,z:p}=this.tileID.canonical,{x:y,y:w,z:T}=r.canonical,k=Xn/Math.pow(2,T-p),E=(w*c.Z+e.anchorY)*k,D=u*c.Z*Xn;return{x:Math.floor((y*c.Z+e.anchorX)*k-l*c.Z*Xn),y:Math.floor(E-D)}}findMatches(e,r,l){const u=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let p=0;p<e.length;p++){const y=e.get(p);if(y.crossTileID)continue;const w=this._symbolsByKey[y.key];if(!w)continue;const T=this.getScaledCoordinates(y,r);if(w.index){const k=w.index.range(T.x-u,T.y-u,T.x+u,T.y+u).sort();for(const E of k){const D=w.crossTileIDs[E];if(!l[D]){l[D]=!0,y.crossTileID=D;break}}}else if(w.positions)for(let k=0;k<w.positions.length;k++){const E=w.positions[k],D=w.crossTileIDs[k];if(Math.abs(E.x-T.x)<=u&&Math.abs(E.y-T.y)<=u&&!l[D]){l[D]=!0,y.crossTileID=D;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class jl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ya{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const r=Math.round((e-this.lng)/360);if(r!==0)for(const l in this.indexes){const u=this.indexes[l],p={};for(const y in u){const w=u[y];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+r),p[w.tileID.key]=w}this.indexes[l]=p}this.lng=e}addBucket(e,r,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let p=0;p<r.symbolInstances.length;p++)r.symbolInstances.get(p).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const u=this.usedCrossTileIDs[e.overscaledZ];for(const p in this.indexes){const y=this.indexes[p];if(Number(p)>e.overscaledZ)for(const w in y){const T=y[w];T.tileID.isChildOf(e)&&T.findMatches(r.symbolInstances,e,u)}else{const w=y[e.scaledTo(Number(p)).key];w&&w.findMatches(r.symbolInstances,e,u)}}for(let p=0;p<r.symbolInstances.length;p++){const y=r.symbolInstances.get(p);y.crossTileID||(y.crossTileID=l.generate(),u[y.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new $l(e,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(e,r){for(const l of r.getCrossTileIDsLists())for(const u of l)delete this.usedCrossTileIDs[e][u]}removeStaleBuckets(e){let r=!1;for(const l in this.indexes){const u=this.indexes[l];for(const p in u)e[u[p].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,u[p]),delete u[p],r=!0)}return r}}class Nl{constructor(){this.layerIndexes={},this.crossTileIDs=new jl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,r,l){let u=this.layerIndexes[e.id];u===void 0&&(u=this.layerIndexes[e.id]=new ya);let p=!1;const y={};u.handleWrapJump(l);for(const w of r){const T=w.getBucket(e);T&&e.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(w.tileID,T,this.crossTileIDs)&&(p=!0),y[T.bucketInstanceId]=!0)}return u.removeStaleBuckets(y)&&(p=!0),p}pruneUnusedLayers(e){const r={};e.forEach(l=>{r[l]=!0});for(const l in this.layerIndexes)r[l]||delete this.layerIndexes[l]}}var gn="void main() {fragColor=vec4(1.0);}";const yi={prelude:Yt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Yt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Yt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Yt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Yt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Yt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Yt(gn,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Yt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Yt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Yt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Yt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Yt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Yt(gn,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Yt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Yt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Yt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Yt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Yt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Yt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Yt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Yt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Yt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Yt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Yt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Yt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Yt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Yt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Yt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Yt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Yt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Yt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Yt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Yt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Yt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Yt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Yt(f,e){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),u=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),p=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=p?p.concat(u):u,w={};return{fragmentSource:f=f.replace(r,(T,k,E,D,R)=>(w[R]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${R}
in ${E} ${D} ${R};
#else
uniform ${E} ${D} u_${R};
#endif
`:`
#ifdef HAS_UNIFORM_u_${R}
    ${E} ${D} ${R} = u_${R};
#endif
`)),vertexSource:e=e.replace(r,(T,k,E,D,R)=>{const $=D==="float"?"vec2":"vec4",N=R.match(/color/)?"color":$;return w[R]?k==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
in ${E} ${$} a_${R};
out ${E} ${D} ${R};
#else
uniform ${E} ${D} u_${R};
#endif
`:N==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = a_${R};
#else
    ${E} ${D} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = unpack_mix_${N}(a_${R}, u_${R}_t);
#else
    ${E} ${D} ${R} = u_${R};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
in ${E} ${$} a_${R};
#else
uniform ${E} ${D} u_${R};
#endif
`:N==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${E} ${D} ${R} = a_${R};
#else
    ${E} ${D} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${E} ${D} ${R} = unpack_mix_${N}(a_${R}, u_${R}_t);
#else
    ${E} ${D} ${R} = u_${R};
#endif
`}),staticAttributes:l,staticUniforms:y}}class Go{constructor(e,r,l){this.vertexBuffer=e,this.indexBuffer=r,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ii=c.aC([{name:"a_pos",type:"Int16",components:2}]);const Kt="#define PROJECTION_MERCATOR",va="mercator";class Vl{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return va}get shaderDefine(){return Kt}get shaderPreludeCode(){return yi.projectionMercator}get vertexShaderPreludeCode(){return yi.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aD.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,r,l,u,p){if(this._cachedMesh)return this._cachedMesh;const y=new c.aE;y.emplaceBack(0,0),y.emplaceBack(c.Z,0),y.emplaceBack(0,c.Z),y.emplaceBack(c.Z,c.Z);const w=e.createVertexBuffer(y,ii.members),T=c.aF.simpleSegment(0,0,4,2),k=new c.aG;k.emplaceBack(1,0,2),k.emplaceBack(1,2,3);const E=e.createIndexBuffer(k);return this._cachedMesh=new Go(w,E,T),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function ni(f,e){const r=c.ad(e.lat,-85.051129,c.aI);return new c.P(c.U(e.lng)*f,c.S(r)*f)}function fo(f,e){return new c.$(e.x/f,e.y/f).toLngLat()}function oo(f){return f.cameraToCenterDistance*Math.min(.85*Math.tan(c.ac(90-f.pitch)),Math.tan(c.ac(89.25-f.pitch)))}function Er(f,e){const r=f.canonical,l=e/c.aH(r.z),u=r.x+Math.pow(2,r.z)*f.wrap,p=c.as(new Float64Array(16));return c.L(p,p,[u*l,r.y*l,0]),c.M(p,p,[l/c.Z,l/c.Z,1]),p}function Ul(f,e,r,l,u){const p=c.$.fromLngLat(f,e),y=u*c.aJ(1,f.lat),w=y*Math.cos(c.ac(r)),T=Math.sqrt(y*y-w*w),k=T*Math.sin(c.ac(-l)),E=T*Math.cos(c.ac(-l));return new c.$(p.x+k,p.y+E,p.z+w)}class io{constructor(e=0,r=0,l=0,u=0){if(isNaN(e)||e<0||isNaN(r)||r<0||isNaN(l)||l<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=l,this.right=u}interpolate(e,r,l){return r.top!=null&&e.top!=null&&(this.top=c.B.number(e.top,r.top,l)),r.bottom!=null&&e.bottom!=null&&(this.bottom=c.B.number(e.bottom,r.bottom,l)),r.left!=null&&e.left!=null&&(this.left=c.B.number(e.left,r.left,l)),r.right!=null&&e.right!=null&&(this.right=c.B.number(e.right,r.right,l)),this}getCenter(e,r){const l=c.ad((this.left+e-this.right)/2,0,e),u=c.ad((this.top+r-this.bottom)/2,0,r);return new c.P(l,u)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new io(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Po(f,e){if(!f.renderWorldCopies||f.lngRange)return;const r=e.lng-f.center.lng;e.lng+=r>180?-360:r<-180?360:0}function Do(f){return Math.max(0,Math.floor(f))}class ba{constructor(e,r,l,u,p,y){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=y===void 0||!!y,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=u??0,this._maxPitch=p??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Do(this._zoom),this._scale=c.aH(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new io,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,r,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Do(this._zoom),this._scale=c.aH(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new io(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,r&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const r=c.aK(e,-180,180)*Math.PI/180;var l,u,p,y,w,T,k,E,D;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=U(),l=this._rotationMatrix,p=-this._bearingInRadians,y=(u=this._rotationMatrix)[0],w=u[1],T=u[2],k=u[3],E=Math.sin(p),D=Math.cos(p),l[0]=y*D+T*E,l[1]=w*D+k*E,l[2]=y*-E+T*D,l[3]=w*-E+k*D)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const r=c.ad(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const r=e/180*Math.PI;this._rollInRadians!==r&&(this._unmodified=!1,this._rollInRadians=r,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aL(this._fovInRadians)}setFov(e){e=c.ad(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.ac(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const r=this.getConstrained(this._center,e).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=c.aH(r),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,r){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=r,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,r,l){this._unmodified=!1,this._edgeInsets.interpolate(e,r,l),this._constrain(),this._calcMatrices()}resize(e,r,l=!0){this._width=e,this._height=r,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new ke([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,c.aI])}getConstrained(e,r){return this._callbacks.getConstrained(e,r)}getCameraQueryGeometry(e,r){if(r.length===1)return[r[0],e];{let l=e.x,u=e.y,p=e.x,y=e.y;for(const w of r)l=Math.min(l,w.x),u=Math.min(u,w.y),p=Math.max(p,w.x),y=Math.max(y,w.y);return[new c.P(l,u),new c.P(p,u),new c.P(p,y),new c.P(l,y),new c.P(l,u)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:r,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(r),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.as(new Float64Array(16));c.M(e,e,[this._width/2,-this._height/2,1]),c.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.as(new Float64Array(16)),c.M(e,e,[1,-1,1]),c.L(e,e,[-1,-1,0]),c.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,r,l,u){const p=l!==void 0?l:this.bearing,y=u=u!==void 0?u:this.pitch,w=c.$.fromLngLat(e,r),T=-Math.cos(c.ac(y)),k=Math.sin(c.ac(y)),E=k*Math.sin(c.ac(p)),D=-k*Math.cos(c.ac(p));let R=this.elevation;const $=r-R;let N;T*$>=0||Math.abs(T)<.1?(N=1e4,R=r+N*T):N=-$/T;let K,Y,J=c.aM(1,w.y),re=0;do{if(re+=1,re>10)break;Y=N/J,K=new c.$(w.x+E*Y,w.y+D*Y),J=1/K.meterInMercatorCoordinateUnits()}while(Math.abs(N-Y*J)>1e-12);return{center:K.toLngLat(),elevation:R,zoom:c.aa(this.height/2/Math.tan(this.fovInRadians/2)/Y/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const r=c.aJ(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/r,u=c.$.fromLngLat(this.center,this.elevation),p=Ul(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const y=this.calculateCenterFromCameraLngLatAlt(p.toLngLat(),c.aM(p.z,u.y),this.bearing,this.pitch);this._elevation=y.elevation,this._center=y.center,this.setZoom(y.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.aJ(1,this.center.lat)*this.worldSize;return Ul(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const r=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/r,e.canonical.y/r,1/r/c.Z,1/r/c.Z]}}class vi{constructor(e,r){this.min=e,this.max=r,this.center=c.aN([],c.aO([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],l=c.aP(this.min),u=c.aP(this.max);for(let p=0;p<r.length;p++)l[p]=r[p]?this.min[p]:this.center[p],u[p]=r[p]?this.center[p]:this.max[p];return u[2]=this.max[2],new vi(l,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let r=!0;for(let l=0;l<e.planes.length;l++){const u=this.intersectsPlane(e.planes[l]);if(u===0)return 0;u===1&&(r=!1)}return r?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let r=e[3],l=e[3];for(let u=0;u<3;u++)e[u]>0?(r+=e[u]*this.min[u],l+=e[u]*this.max[u]):(l+=e[u]*this.min[u],r+=e[u]*this.max[u]);return r>=0?2:l<0?0:1}}class Ur{distanceToTile2d(e,r,l,u){const p=u.distanceX([e,r]),y=u.distanceY([e,r]);return Math.hypot(p,y)}getWrap(e,r,l){return l}getTileAABB(e,r,l,u){var p,y;let w=l,T=l;if(u.terrain){const E=new c.Y(e.z,r,e.z,e.x,e.y),D=u.terrain.getMinMaxElevation(E);w=(p=D.minElevation)!==null&&p!==void 0?p:l,T=(y=D.maxElevation)!==null&&y!==void 0?y:l}const k=1<<e.z;return new vi([r+e.x/k,e.y/k,w],[r+(e.x+1)/k,(e.y+1)/k,T])}allowVariableZoom(e,r){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,u=c.ad(78.5-l/2,0,60);return!!r.terrain||e.pitch>u}allowWorldCopies(){return!0}recalculateCache(){}}class Qi{constructor(e,r,l){this.points=e,this.planes=r,this.aabb=l}static fromInvProjectionMatrix(e,r=1,l=0){const u=Math.pow(2,l),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const E=1/(k=c.ao([],k,e))[3]/r*u;return c.aQ(k,k,[E,E,1/k[3],E])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const E=c.aR([],p[k[0]],p[k[1]]),D=c.aR([],p[k[2]],p[k[1]]),R=c.aS([],c.aT([],E,D)),$=-c.aU(R,p[k[1]]);return R.concat($)}),w=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],T=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const k of p)for(let E=0;E<3;E++)w[E]=Math.min(w[E],k[E]),T[E]=Math.max(T[E],k[E]);return new Qi(p,y,new vi(w,T))}}class si{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,l=!0){this._helper.resize(e,r,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,r){}constructor(e,r,l,u,p){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new ba({calcMatrices:()=>{this._calcMatrices()},getConstrained:(y,w)=>this.getConstrained(y,w)},e,r,l,u,p),this._coveringTilesDetailsProvider=new Ur}clone(){const e=new si;return e.apply(this),e}apply(e,r,l){this._helper.apply(e,r,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const r=[new c.aV(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new c.P(0,0)),u=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),p=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),y=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),w=Math.floor(Math.min(l.x,u.x,p.x,y.x)),T=Math.floor(Math.max(l.x,u.x,p.x,y.x)),k=1;for(let E=w-k;E<=T+k;E++)E!==0&&r.push(new c.aV(E,e))}return r}getCameraFrustum(){return Qi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const r=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(r,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,r){const l=c.aJ(this.elevation,this.center.lat),u=this.screenPointToMercatorCoordinateAtZ(r,l),p=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),y=c.$.fromLngLat(e),w=new c.$(y.x-(u.x-p.x),y.y-(u.y-p.y));this.setCenter(w==null?void 0:w.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,r){return r?this.coordinatePoint(c.$.fromLngLat(e),r.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.$.fromLngLat(e))}screenPointToLocation(e,r){var l;return(l=this.screenPointToMercatorCoordinate(e,r))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,r){if(r){const l=r.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,r){const l=r||0,u=[e.x,e.y,0,1],p=[e.x,e.y,1,1];c.ao(u,u,this._pixelMatrixInverse),c.ao(p,p,this._pixelMatrixInverse);const y=u[3],w=p[3],T=u[1]/y,k=p[1]/w,E=u[2]/y,D=p[2]/w,R=E===D?0:(l-E)/(D-E);return new c.$(c.B.number(u[0]/y,p[0]/w,R)/this.worldSize,c.B.number(T,k,R)/this.worldSize,l)}coordinatePoint(e,r=0,l=this._pixelMatrix){const u=[e.x*this.worldSize,e.y*this.worldSize,r,1];return c.ao(u,u,l),new c.P(u[0]/u[3],u[1]/u[3])}getBounds(){const e=Math.max(0,this._helper._height/2-oo(this));return new ke().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,r){return r?r.pointCoordinate(e)!=null:e.y>this.height/2-oo(this)}calculatePosMatrix(e,r=!1,l){var u;const p=(u=e.key)!==null&&u!==void 0?u:c.aW(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),y=r?this._alignedPosMatrixCache:this._posMatrixCache;if(y.has(p)){const k=y.get(p);return l?k.f32:k.f64}const w=Er(e,this.worldSize);c.N(w,r?this._alignedProjMatrix:this._viewProjMatrix,w);const T={f64:w,f32:new Float32Array(w)};return y.set(p,T),l?T.f32:T.f64}calculateFogMatrix(e){const r=e.key,l=this._fogMatrixCacheF32;if(l.has(r))return l.get(r);const u=Er(e,this.worldSize);return c.N(u,this._fogMatrix,u),l.set(r,new Float32Array(u)),l.get(r)}getConstrained(e,r){r=c.ad(+r,this.minZoom,this.maxZoom);const l={center:new c.Q(e.lng,e.lat),zoom:r};let u=this._helper._lngRange;this._helper._renderWorldCopies||u!==null||(u=[-179.9999999999,180-1e-10]);const p=this.tileSize*c.aH(l.zoom);let y=0,w=p,T=0,k=p,E=0,D=0;const{x:R,y:$}=this.size;if(this._helper._latRange){const ne=this._helper._latRange;y=c.S(ne[1])*p,w=c.S(ne[0])*p,w-y<$&&(E=$/(w-y))}u&&(T=c.aK(c.U(u[0])*p,0,p),k=c.aK(c.U(u[1])*p,0,p),k<T&&(k+=p),k-T<R&&(D=R/(k-T)));const{x:N,y:K}=ni(p,e);let Y,J;const re=Math.max(D||0,E||0);if(re){const ne=new c.P(D?(k+T)/2:N,E?(w+y)/2:K);return l.center=fo(p,ne).wrap(),l.zoom+=c.aa(re),l}if(this._helper._latRange){const ne=$/2;K-ne<y&&(J=y+ne),K+ne>w&&(J=w-ne)}if(u){const ne=(T+k)/2;let le=N;this._helper._renderWorldCopies&&(le=c.aK(N,ne-p/2,ne+p/2));const ue=R/2;le-ue<T&&(Y=T+ue),le+ue>k&&(Y=k-ue)}if(Y!==void 0||J!==void 0){const ne=new c.P(Y??N,J??K);l.center=fo(p,ne).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,r,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,u)}_calculateNearFarZIfNeeded(e,r,l){if(!this._helper.autoCalculateNearFarZ)return;const u=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),p=e-u*this._helper._pixelPerMeter/Math.cos(r),y=u<0?p:e,w=Math.PI/2+this.pitchInRadians,T=c.ac(this.fov)*(Math.abs(Math.cos(c.ac(this.roll)))*this.height+Math.abs(Math.sin(c.ac(this.roll)))*this.width)/this.height*(.5+l.y/this.height),k=Math.sin(T)*y/Math.sin(c.ad(Math.PI-w-T,.01,Math.PI-.01)),E=oo(this),D=Math.atan(E/this._helper.cameraToCenterDistance),R=c.ac(.75),$=D>R?2*D*(.5+l.y/(2*E)):R,N=Math.sin($)*y/Math.sin(c.ad(Math.PI-w-$,.01,Math.PI-.01)),K=Math.min(k,N);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*K+y),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,r=ni(this.worldSize,this.center),l=r.x,u=r.y;this._helper._pixelPerMeter=c.aJ(1,this.center.lat)*this.worldSize;const p=c.ac(Math.min(this.pitch,89.25)),y=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(p));let w;this._calculateNearFarZIfNeeded(y,p,e),w=new Float64Array(16),c.aX(w,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.ai(this._invProjMatrix,w),w[8]=2*-e.x/this._helper._width,w[9]=2*e.y/this._helper._height,this._projectionMatrix=c.aY(w),c.M(w,w,[1,-1,1]),c.L(w,w,[0,0,-this._helper.cameraToCenterDistance]),c.aZ(w,w,-this.rollInRadians),c.a_(w,w,this.pitchInRadians),c.aZ(w,w,-this.bearingInRadians),c.L(w,w,[-l,-u,0]),this._mercatorMatrix=c.M([],w,[this.worldSize,this.worldSize,this.worldSize]),c.M(w,w,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,w),c.L(w,w,[0,0,-this.elevation]),this._viewProjMatrix=w,this._invViewProjMatrix=c.ai([],w);const T=[0,0,-1,1];c.ao(T,T,this._invViewProjMatrix),this._cameraPosition=[T[0]/T[3],T[1]/T[3],T[2]/T[3]],this._fogMatrix=new Float64Array(16),c.aX(this._fogMatrix,this.fovInRadians,this.width/this.height,y,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.aZ(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.a_(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.aZ(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.L(this._fogMatrix,this._fogMatrix,[-l,-u,0]),c.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,w);const k=this._helper._width%2/2,E=this._helper._height%2/2,D=Math.cos(this.bearingInRadians),R=Math.sin(-this.bearingInRadians),$=l-Math.round(l)+D*k+R*E,N=u-Math.round(u)+D*E+R*k,K=new Float64Array(w);if(c.L(K,K,[$>.5?$-1:$,N>.5?N-1:N,0]),this._alignedProjMatrix=K,w=c.ai(new Float64Array(16),this._pixelMatrix),!w)throw new Error("failed to invert matrix");this._pixelMatrixInverse=w,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.ao(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.aJ(1,this.center.lat)*this.worldSize;return Ul(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,r){const l=c.$.fromLngLat(e),u=[l.x*this.worldSize,l.y*this.worldSize,r,1];return c.ao(u,u,this._viewProjMatrix),u[2]/u[3]}getProjectionData(e){const{overscaledTileID:r,aligned:l,applyTerrainMatrix:u}=e,p=this._helper.getMercatorTileCoordinates(r),y=r?this.calculatePosMatrix(r,l,!0):null;let w;return w=r&&r.terrainRttPosMatrix32f&&u?r.terrainRttPosMatrix32f:y||c.a$(),{mainMatrix:w,tileMercatorCoords:p,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:w}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,r,l){return 1}transformLightDirection(e){return c.aP(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,r,l,u){const p=this.calculatePosMatrix(l);let y;u?(y=[e,r,u(e,r),1],c.ao(y,y,p)):(y=[e,r,0,1],Hr(y,y,p));const w=y[3];return{point:new c.P(y[0]/w,y[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}populateCache(e){for(const r of e)this.calculatePosMatrix(r)}getMatrixForModel(e,r){const l=c.$.fromLngLat(e,r),u=l.meterInMercatorCoordinateUnits(),p=c.b0();return c.L(p,p,[l.x,l.y,l.z]),c.aZ(p,p,Math.PI),c.a_(p,p,Math.PI/2),c.M(p,p,[-u,u,u]),p}getProjectionDataForCustomLayer(e=!0){const r=new c.Y(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:e}),u=Er(r,this.worldSize);c.N(u,this._viewProjMatrix,u),l.tileMercatorCoords=[0,0,1,1];const p=[c.Z,c.Z,this.worldSize/this._helper.pixelsPerMeter],y=c.b1();return c.M(y,u,p),l.fallbackMatrix=y,l.mainMatrix=y,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Rs(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function ai(f){if(f.useSlerp)if(f.k<1){const e=c.b2(f.startEulerAngles.roll,f.startEulerAngles.pitch,f.startEulerAngles.bearing),r=c.b2(f.endEulerAngles.roll,f.endEulerAngles.pitch,f.endEulerAngles.bearing),l=new Float64Array(4);c.b3(l,e,r,f.k);const u=c.b4(l);f.tr.setRoll(u.roll),f.tr.setPitch(u.pitch),f.tr.setBearing(u.bearing)}else f.tr.setRoll(f.endEulerAngles.roll),f.tr.setPitch(f.endEulerAngles.pitch),f.tr.setBearing(f.endEulerAngles.bearing);else f.tr.setRoll(c.B.number(f.startEulerAngles.roll,f.endEulerAngles.roll,f.k)),f.tr.setPitch(c.B.number(f.startEulerAngles.pitch,f.endEulerAngles.pitch,f.k)),f.tr.setBearing(c.B.number(f.startEulerAngles.bearing,f.endEulerAngles.bearing,f.k))}function Zl(f,e,r,l,u){const p=u.padding,y=ni(u.worldSize,r.getNorthWest()),w=ni(u.worldSize,r.getNorthEast()),T=ni(u.worldSize,r.getSouthEast()),k=ni(u.worldSize,r.getSouthWest()),E=c.ac(-l),D=y.rotate(E),R=w.rotate(E),$=T.rotate(E),N=k.rotate(E),K=new c.P(Math.max(D.x,R.x,N.x,$.x),Math.max(D.y,R.y,N.y,$.y)),Y=new c.P(Math.min(D.x,R.x,N.x,$.x),Math.min(D.y,R.y,N.y,$.y)),J=K.sub(Y),re=(u.width-(p.left+p.right+e.left+e.right))/J.x,ne=(u.height-(p.top+p.bottom+e.top+e.bottom))/J.y;if(ne<0||re<0)return void Rs();const le=Math.min(c.aa(u.scale*Math.min(re,ne)),f.maxZoom),ue=c.P.convert(f.offset),fe=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.ac(l)),he=ue.add(fe).mult(u.scale/c.aH(le));return{center:fo(u.worldSize,y.add(T).div(2).sub(he)),zoom:le,bearing:l}}class bi{get useGlobeControls(){return!1}handlePanInertia(e,r){return{easingOffset:e,easingCenter:r.center}}handleMapControlsRollPitchBearingZoom(e,r){e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta),e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta)}handleMapControlsPan(e,r,l){e.around.distSqr(r.centerPoint)<.01||r.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,r,l,u,p){return Zl(e,r,l,u,p)}handleJumpToCenterZoom(e,r){e.zoom!==(r.zoom!==void 0?+r.zoom:e.zoom)&&e.setZoom(+r.zoom),r.center!==void 0&&e.setCenter(c.Q.convert(r.center))}handleEaseTo(e,r){const l=e.zoom,u=e.padding,p={roll:e.roll,pitch:e.pitch,bearing:e.bearing},y={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},w=r.zoom!==void 0,T=!e.isPaddingEqual(r.padding);let k=!1;const E=w?+r.zoom:e.zoom;let D=e.centerPoint.add(r.offsetAsPoint);const R=e.screenPointToLocation(D),{center:$,zoom:N}=e.getConstrained(c.Q.convert(r.center||R),E??l);Po(e,$);const K=ni(e.worldSize,R),Y=ni(e.worldSize,$).sub(K),J=c.aH(N-l);return k=N!==l,{easeFunc:re=>{if(k&&e.setZoom(c.B.number(l,N,re)),c.b5(p,y)||ai({startEulerAngles:p,endEulerAngles:y,tr:e,k:re,useSlerp:p.roll!=y.roll}),T&&(e.interpolatePadding(u,r.padding,re),D=e.centerPoint.add(r.offsetAsPoint)),r.around)e.setLocationAtPoint(r.around,r.aroundPoint);else{const ne=c.aH(e.zoom-l),le=N>l?Math.min(2,J):Math.max(.5,J),ue=Math.pow(le,1-re),fe=fo(e.worldSize,K.add(Y.mult(re*ue)).mult(ne));e.setLocationAtPoint(e.renderWorldCopies?fe.wrap():fe,D)}},isZooming:k,elevationCenter:$}}handleFlyTo(e,r){const l=r.zoom!==void 0,u=e.zoom,p=e.getConstrained(c.Q.convert(r.center||r.locationAtOffset),l?+r.zoom:u),y=p.center,w=p.zoom;Po(e,y);const T=ni(e.worldSize,r.locationAtOffset),k=ni(e.worldSize,y).sub(T),E=k.mag(),D=c.aH(w-u);let R;if(r.minZoom!==void 0){const $=Math.min(+r.minZoom,u,w),N=e.getConstrained(y,$).zoom;R=c.aH(N-u)}return{easeFunc:($,N,K,Y)=>{e.setZoom($===1?w:u+c.aa(N));const J=$===1?y:fo(e.worldSize,T.add(k.mult(K)).mult(N));e.setLocationAtPoint(e.renderWorldCopies?J.wrap():J,Y)},scaleOfZoom:D,targetCenter:y,scaleOfMinZoom:R,pixelPathLength:E}}}class xr{constructor(e,r,l){this.blendFunction=e,this.blendColor=r,this.mask=l}}xr.Replace=[1,0],xr.disabled=new xr(xr.Replace,c.b6.transparent,[!1,!1,!1,!1]),xr.unblended=new xr(xr.Replace,c.b6.transparent,[!0,!0,!0,!0]),xr.alphaBlended=new xr([1,771],c.b6.transparent,[!0,!0,!0,!0]);const xa=2305;class Wt{constructor(e,r,l){this.enable=e,this.mode=r,this.frontFace=l}}Wt.disabled=new Wt(!1,1029,xa),Wt.backCCW=new Wt(!0,1029,xa),Wt.frontCCW=new Wt(!0,1028,xa);class Ft{constructor(e,r,l){this.func=e,this.mask=r,this.range=l}}Ft.ReadOnly=!1,Ft.ReadWrite=!0,Ft.disabled=new Ft(519,Ft.ReadOnly,[0,1]);const Yn=7680;class Xt{constructor(e,r,l,u,p,y){this.test=e,this.ref=r,this.mask=l,this.fail=u,this.depthFail=p,this.pass=y}}Xt.disabled=new Xt({func:519,mask:0},0,0,Yn,Yn,Yn);const Ls=new WeakMap;function li(f){var e;if(Ls.has(f))return Ls.get(f);{const r=(e=f.getParameter(f.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Ls.set(f,r),r}}class Bs{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const r=e.context,l=r.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const u=new c.aE;u.emplaceBack(-1,-1),u.emplaceBack(2,-1),u.emplaceBack(-1,2);const p=new c.aG;p.emplaceBack(0,1,2),this._fullscreenTriangle=new Go(r.createVertexBuffer(u,ii.members),r.createIndexBuffer(p),c.aF.simpleSegment(0,0,u.length,p.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(l.TEXTURE1);const y=l.createTexture();l.bindTexture(l.TEXTURE_2D,y),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(y),li(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,r){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,r),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,r=e.gl;e.activeTexture.set(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,r){const l=this._cachedRenderContext.context,u=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:c.b6.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,u.TRIANGLES,Ft.disabled,Xt.disabled,xr.unblended,Wt.disabled,((p,y)=>({u_input:p,u_output_expected:y}))(e,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&li(u)){u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.readBuffer(u.COLOR_ATTACHMENT0),u.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),u.bindBuffer(u.PIXEL_PACK_BUFFER,null);const p=u.fenceSync(u.SYNC_GPU_COMMANDS_COMPLETE,0);u.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:p}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&li(e)){const r=e.clientWaitSync(this._readbackQueue.sync,0,0);if(r===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Bs._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let r=0;return r+=e[0]/256,r+=e[1]/65536,r+=e[2]/16777216,e[3]<127&&(r=-r),r/128}}const wa=c.Z/128;function Fs(f,e){const r=f.granularity!==void 0?Math.max(f.granularity,1):1,l=r+(f.generateBorders?2:0),u=r+(f.extendToNorthPole||f.generateBorders?1:0)+(f.extendToSouthPole||f.generateBorders?1:0),p=l+1,y=u+1,w=f.generateBorders?-1:0,T=f.generateBorders||f.extendToNorthPole?-1:0,k=r+(f.generateBorders?1:0),E=r+(f.generateBorders||f.extendToSouthPole?1:0),D=p*y,R=l*u*6,$=p*y>65536;if($&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const N=$||e==="32bit",K=new Int16Array(2*D);let Y=0;for(let ne=T;ne<=E;ne++)for(let le=w;le<=k;le++){let ue=le/r*c.Z;le===-1&&(ue=-64),le===r+1&&(ue=c.Z+wa);let fe=ne/r*c.Z;ne===-1&&(fe=f.extendToNorthPole?c.b8:-64),ne===r+1&&(fe=f.extendToSouthPole?c.b9:c.Z+wa),K[Y++]=ue,K[Y++]=fe}const J=N?new Uint32Array(R):new Uint16Array(R);let re=0;for(let ne=0;ne<u;ne++)for(let le=0;le<l;le++){const ue=le+1+ne*p,fe=le+(ne+1)*p,he=le+1+(ne+1)*p;J[re++]=le+ne*p,J[re++]=fe,J[re++]=ue,J[re++]=ue,J[re++]=fe,J[re++]=he}return{vertices:K.buffer.slice(0),indices:J.buffer.slice(0),uses32bitIndices:N}}const Kn=new c.aD({fill:new c.ba(128,2),line:new c.ba(512,0),tile:new c.ba(128,32),stencil:new c.ba(128,1),circle:3});class Jn{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return yi.projectionGlobe}get vertexShaderPreludeCode(){return yi.projectionMercator.vertexSource}get subdivisionGranularity(){return Kn}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Bs(e));const r=c.S(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,u=this._errorMeasurement.updateErrorLoop(r,l),p=Q.now();u!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=u,this._errorMeasurementLastChangeTime=p);const y=Math.min(Math.max((p-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bb(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bc(y))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,r,l,u,p){const y=(p==="stencil"?Kn.stencil:Kn.tile).getGranularityForZoomLevel(r.z);return this._getMesh(e,{granularity:y,generateBorders:l,extendToNorthPole:r.y===0&&u,extendToSouthPole:r.y===(1<<r.z)-1&&u})}_getMesh(e,r){const l=this._getMeshKey(r);if(l in this._tileMeshCache)return this._tileMeshCache[l];const u=function(p,y){const w=Fs(y,"16bit"),T=c.aE.deserialize({arrayBuffer:w.vertices,length:w.vertices.byteLength/2/2}),k=c.aG.deserialize({arrayBuffer:w.indices,length:w.indices.byteLength/2/3});return new Go(p.createVertexBuffer(T,ii.members),p.createIndexBuffer(k),c.aF.simpleSegment(0,0,T.length,k.length))}(e,r);return this._tileMeshCache[l]=u,u}recalculate(e){}hasTransition(){const e=Q.now();let r=!1;return r=r||(e-this._errorMeasurementLastChangeTime)/1e3<.7,r=r||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,r}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const qd=new c.r({type:new c.D(c.v.projection.type)});class Ca extends c.E{constructor(e){super(),this._transitionable=new c.T(qd),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.C(0)),this._mercatorProjection=new Vl,this._verticalPerspectiveProjection=new Jn}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.bd){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,r,l,u,p){return this.currentProjection.getMeshFromTileID(e,r,l,u,p)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Gl(f){const e=Co(f.worldSize,f.center.lat);return 2*Math.PI*e}function Os(f,e,r,l,u){const p=1/(1<<u),y=e/c.Z*p+l*p,w=c.bf((f/c.Z*p+r*p)*Math.PI*2+Math.PI,2*Math.PI),T=2*Math.atan(Math.exp(Math.PI-y*Math.PI*2))-.5*Math.PI,k=Math.cos(T),E=new Float64Array(3);return E[0]=Math.sin(w)*k,E[1]=Math.sin(T),E[2]=Math.cos(w)*k,E}function wo(f){return function(e,r){const l=Math.cos(r),u=new Float64Array(3);return u[0]=Math.sin(e)*l,u[1]=Math.sin(r),u[2]=Math.cos(e)*l,u}(f.lng*Math.PI/180,f.lat*Math.PI/180)}function Co(f,e){return f/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Ta(f){const e=Math.asin(f[1])/Math.PI*180,r=Math.sqrt(f[0]*f[0]+f[2]*f[2]);if(r>1e-6){const l=f[0]/r,u=Math.acos(f[2]/r),p=(l>0?u:-u)/Math.PI*180;return new c.Q(c.aK(p,-180,180),e)}return new c.Q(0,e)}function qo(f){return Math.cos(f*Math.PI/180)}function Or(f,e){const r=qo(f),l=qo(e);return c.aa(l/r)}function ql(f,e){const r=f.rotate(e.bearingInRadians),l=e.zoom+Or(e.center.lat,0),u=c.bb(1/qo(e.center.lat),1/qo(Math.min(Math.abs(e.center.lat),60)),c.be(l,7,3,0,1)),p=360/Gl({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.Q(e.center.lng-r.x*p*u,c.ad(e.center.lat+r.y*p,-85.051129,c.aI))}function Sa(f){const e=.5*f,r=Math.sin(e),l=Math.cos(e);return Math.log(r+l)-Math.log(l-r)}function _n(f,e,r,l){const u=f.lat+r*l;if(Math.abs(r)>1){const p=(Math.sign(f.lat+r)!==Math.sign(f.lat)?-Math.abs(f.lat):Math.abs(f.lat))*Math.PI/180,y=Math.abs(f.lat+r)*Math.PI/180,w=Sa(p+l*(y-p)),T=Sa(p),k=Sa(y);return new c.Q(f.lng+e*((w-T)/(k-T)),u)}return new c.Q(f.lng+e*l,u)}class Wd{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,r,l,u){const p=`${e.z}_${e.x}_${e.y}`,y=this._cache.get(p);if(y)return y;const w=this._cachePrevious.get(p);if(w)return this._cache.set(p,w),w;const T=this._aabbFactory(e,r,l,u);return this._cache.set(p,T),this._hadAnyChanges=!0,T}}function ka(f,e,r){const l=f-e;return l<0?-l:Math.max(0,l-r)}function Wl(f,e,r,l,u){const p=f-r;let y;return y=p<0?Math.min(-p,1+p-u):p>1?Math.min(Math.max(p-u,0),1-p):0,Math.max(y,ka(e,l,u))}class Hd{constructor(){this._aabbCache=new Wd(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,r,l,u){const p=1<<l.z,y=1/p,w=l.x/p,T=l.y/p;let k=2;return k=Math.min(k,Wl(e,r,w,T,y)),k=Math.min(k,Wl(e,r,w+.5,-T-y,y)),k=Math.min(k,Wl(e,r,w+.5,2-T-y,y)),k}getWrap(e,r,l){const u=1<<r.z,p=1/u,y=r.x/u,w=ka(e.x,y,p),T=ka(e.x,y-1,p),k=ka(e.x,y+1,p),E=Math.min(w,T,k);return E===k?1:E===T?-1:0}allowVariableZoom(e,r){return oi(e,r)>4}allowWorldCopies(){return!1}getTileAABB(e,r,l,u){return this._aabbCache.getTileAABB(e,r,l,u)}_computeTileAABB(e,r,l,u){if(e.z<=0)return new vi([-1,-1,-1],[1,1,1]);if(e.z===1)return new vi([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const p=[Os(0,0,e.x,e.y,e.z),Os(c.Z,0,e.x,e.y,e.z),Os(c.Z,c.Z,e.x,e.y,e.z),Os(0,c.Z,e.x,e.y,e.z)],y=[1,1,1],w=[-1,-1,-1];for(const T of p)for(let k=0;k<3;k++)y[k]=Math.min(y[k],T[k]),w[k]=Math.max(w[k],T[k]);if(e.y===0||e.y===(1<<e.z)-1){const T=[0,e.y===0?1:-1,0];for(let k=0;k<3;k++)y[k]=Math.min(y[k],T[k]),w[k]=Math.max(w[k],T[k])}return new vi(y,w)}}}class Pa{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r){this._helper.resize(e,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=c.bg(),this._projectionMatrix=c.b0(),this._globeViewProjMatrix32f=c.a$(),this._globeViewProjMatrixNoCorrection=c.b0(),this._globeViewProjMatrixNoCorrectionInverted=c.b0(),this._globeProjMatrixInverted=c.b0(),this._cameraPosition=c.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new ba({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._coveringTilesDetailsProvider=new Hd}clone(){const e=new Pa;return e.apply(this),e}apply(e,r){this._globeLatitudeErrorCorrectionRadians=r||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:r,applyGlobeMatrix:l}=e,u=this._helper.getMercatorTileCoordinates(r);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:u,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const r=this.pitchInRadians,l=this.cameraToCenterDistance/e,u=Math.sin(r)*l,p=Math.cos(r)*l+1,y=1/Math.sqrt(u*u+p*p)*1;let w=-u,T=p;const k=Math.sqrt(w*w+T*T);w/=k,T/=k;const E=[0,w,T];return c.bi(E,E,[0,0,0],-this.bearingInRadians),c.bj(E,E,[0,0,0],-1*this.center.lat*Math.PI/180),c.bk(E,E,[0,0,0],this.center.lng*Math.PI/180),c.aN(E,E,.25),[...E,.25*-y]}isLocationOccluded(e){return!this.isSurfacePointVisible(wo(e))}transformLightDirection(e){const r=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,u=Math.cos(l),p=[Math.sin(r)*u,Math.sin(l),Math.cos(r)*u],y=[p[2],0,-p[0]],w=[0,0,0];c.aT(w,y,p),c.aS(y,y),c.aS(w,w);const T=[0,0,0];return c.aS(T,[y[0]*e[0]+w[0]*e[1]+p[0]*e[2],y[1]*e[0]+w[1]*e[1]+p[1]*e[2],y[2]*e[0]+w[2]*e[1]+p[2]*e[2]]),T}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,r,l){const u=function(w,T,k){const E=1/(1<<k.z);return new c.$(w/c.Z*E+k.x*E,T/c.Z*E+k.y*E)}(e,r,l.canonical),p=(y=u.y,[c.bf(u.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-y*Math.PI*2))-.5*Math.PI]);var y;return this.getCircleRadiusCorrection()/Math.cos(p[1])}projectTileCoordinates(e,r,l,u){const p=l.canonical,y=Os(e,r,p.x,p.y,p.z),w=1+(u?u(e,r):0)/c.bq,T=[y[0]*w,y[1]*w,y[2]*w,1];c.ao(T,T,this._globeViewProjMatrixNoCorrection);const k=this._cachedClippingPlane,E=k[0]*y[0]+k[1]*y[1]+k[2]*y[2]+k[3]<0;return{point:new c.P(T[0]/T[3],T[1]/T[3]),signedDistanceFromCamera:T[3],isOccluded:E}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Co(this.worldSize,this.center.lat),r=c.b1(),l=c.b1();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.aX(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const u=this.centerOffset;r[8]=2*-u.x/this._helper._width,r[9]=2*u.y/this._helper._height,this._projectionMatrix=c.aY(r),this._globeProjMatrixInverted=c.b1(),c.ai(this._globeProjMatrixInverted,r),c.L(r,r,[0,0,-this.cameraToCenterDistance]),c.aZ(r,r,this.rollInRadians),c.a_(r,r,-this.pitchInRadians),c.aZ(r,r,this.bearingInRadians),c.L(r,r,[0,0,-e]);const p=c.bh();p[0]=e,p[1]=e,p[2]=e,c.a_(l,r,this.center.lat*Math.PI/180),c.bl(l,l,-this.center.lng*Math.PI/180),c.M(l,l,p),this._globeViewProjMatrixNoCorrection=l,c.a_(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bl(r,r,-this.center.lng*Math.PI/180),c.M(r,r,p),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=c.b1(),c.ai(this._globeViewProjMatrixNoCorrectionInverted,l);const y=c.bh();this._cameraPosition=c.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bi(this._cameraPosition,this._cameraPosition,y,-this.rollInRadians),c.bj(this._cameraPosition,this._cameraPosition,y,this.pitchInRadians),c.bi(this._cameraPosition,this._cameraPosition,y,-this.bearingInRadians),c.aO(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bj(this._cameraPosition,this._cameraPosition,y,-this.center.lat*Math.PI/180),c.bk(this._cameraPosition,this._cameraPosition,y,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const w=c.aY(this._globeViewProjMatrixNoCorrectionInverted);c.M(w,w,[1,1,-1]),this._cachedFrustum=Qi.fromInvProjectionMatrix(w)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const r=c.b1();return c.as(r),r}getVisibleUnwrappedCoordinates(e){return[new c.aV(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=wo(e);c.aN(l,l,1+r/c.bq);const u=c.bg();return c.ao(u,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),u[2]/u[3]}populateCache(e){}getBounds(){const e=.5*this.width,r=.5*this.height,l=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,r),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,r)],u=[];for(const D of l)u.push(this.unprojectScreenPoint(D));let p=0,y=0,w=0,T=0;const k=this.center;for(const D of u){const R=c.bm(k.lng,D.lng),$=c.bm(k.lat,D.lat);R<y&&(y=R),R>p&&(p=R),$<T&&(T=$),$>w&&(w=$)}const E=[k.lng+y,k.lat+T,k.lng+p,k.lat+w];return this.isSurfacePointOnScreen([0,1,0])&&(E[3]=90,E[0]=-180,E[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(E[1]=-90,E[0]=-180,E[2]=180),new ke(E)}getConstrained(e,r){const l=c.ad(e.lat,-85.051129,c.aI),u=c.ad(+r,this.minZoom+Or(0,l),this.maxZoom);return{center:new c.Q(e.lng,l),zoom:u}}calculateCenterFromCameraLngLatAlt(e,r,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,u)}setLocationAtPoint(e,r){const l=wo(this.unprojectScreenPoint(r)),u=wo(e),p=c.bh();c.bn(p);const y=c.bh();c.bk(y,l,p,-this.center.lng*Math.PI/180),c.bj(y,y,p,this.center.lat*Math.PI/180);const w=u[0]*u[0]+u[2]*u[2],T=y[0]*y[0];if(w<T)return;const k=Math.sqrt(w-T),E=-k,D=c.bo(u[0],u[2],y[0],k),R=c.bo(u[0],u[2],y[0],E),$=c.bh();c.bk($,u,p,-D);const N=c.bo($[1],$[2],y[1],y[2]),K=c.bh();c.bk(K,u,p,-R);const Y=c.bo(K[1],K[2],y[1],y[2]),J=.5*Math.PI,re=N>=-J&&N<=J,ne=Y>=-J&&Y<=J;let le,ue;if(re&&ne){const we=this.center.lng*Math.PI/180,Ae=this.center.lat*Math.PI/180;c.br(D,we)+c.br(N,Ae)<c.br(R,we)+c.br(Y,Ae)?(le=D,ue=N):(le=R,ue=Y)}else if(re)le=D,ue=N;else{if(!ne)return;le=R,ue=Y}const fe=le/Math.PI*180,he=ue/Math.PI*180,be=this.center.lat;this.setCenter(new c.Q(fe,c.ad(he,-90,90))),this.setZoom(this.zoom+Or(be,this.center.lat))}locationToScreenPoint(e,r){const l=wo(e);if(r){const u=r.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aN(l,l,1+u/c.bq)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const r=c.bg();return c.ao(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new c.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,r){if(r){const l=r.pointCoordinate(e);if(l)return l}return c.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,r){var l;return(l=this.screenPointToMercatorCoordinate(e,r))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,r){const l=this._cameraPosition,u=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,u)}getRayDirectionFromPixel(e){const r=c.bg();r[0]=e.x/this.width*2-1,r[1]=-1*(e.y/this.height*2-1),r[2]=1,r[3]=1,c.ao(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const l=c.bh();l[0]=r[0]-this._cameraPosition[0],l[1]=r[1]-this._cameraPosition[1],l[2]=r[2]-this._cameraPosition[2];const u=c.bh();return c.aS(u,l),u}isSurfacePointVisible(e){const r=this._cachedClippingPlane;return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const r=c.bg();return c.ao(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(e,r){const l=c.aU(e,r),u=c.bh(),p=c.bh();c.aN(p,r,l),c.aR(u,e,p);const y=1-c.aU(u,u);if(y<0)return null;const w=c.aU(e,e)-1,T=-l+(l<0?1:-1)*Math.sqrt(y),k=w/T,E=T;return{tMin:Math.min(k,E),tMax:Math.max(k,E)}}unprojectScreenPoint(e){const r=this._cameraPosition,l=this.getRayDirectionFromPixel(e),u=this.rayPlanetIntersection(r,l);if(u){const k=c.bh();c.aO(k,r,[l[0]*u.tMin,l[1]*u.tMin,l[2]*u.tMin]);const E=c.bh();return c.aS(E,k),Ta(E)}const p=this._cachedClippingPlane[0]*l[0]+this._cachedClippingPlane[1]*l[1]+this._cachedClippingPlane[2]*l[2],y=-c.bp(this._cachedClippingPlane,r)/p,w=c.bh();if(y>0)c.aO(w,r,[l[0]*y,l[1]*y,l[2]*y]);else{const k=c.bh();c.aO(k,r,[2*l[0],2*l[1],2*l[2]]);const E=c.bp(this._cachedClippingPlane,k);c.aR(w,k,[this._cachedClippingPlane[0]*E,this._cachedClippingPlane[1]*E,this._cachedClippingPlane[2]*E])}const T=c.bh();return c.aS(T,w),Ta(T)}getMatrixForModel(e,r){const l=c.Q.convert(e),u=1/c.bq,p=c.b0();return c.bl(p,p,l.lng/180*Math.PI),c.a_(p,p,-l.lat/180*Math.PI),c.L(p,p,[0,0,1+r/c.bq]),c.a_(p,p,.5*Math.PI),c.M(p,p,[u,u,u]),p}getProjectionDataForCustomLayer(e=!0){const r=this.getProjectionData({overscaledTileID:new c.Y(0,0,0,0,0),applyGlobeMatrix:e});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(e){}}class Ma{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,l=!0){this._helper.resize(e,r,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,r){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=r,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new ba({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._globeness=1,this._mercatorTransform=new si,this._verticalPerspectiveTransform=new Pa}clone(){const e=new Ma;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const r=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:r.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:r.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.bb(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bb(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,r,l){const u=this._mercatorTransform.getPitchedTextCorrection(e,r,l),p=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,r,l);return c.bb(u,p,this._globeness)}projectTileCoordinates(e,r,l,u){return this.currentTransform.projectTileCoordinates(e,r,l,u)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){return this.currentTransform.lngLatToCameraDepth(e,r)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,r){return this.currentTransform.getConstrained(e,r)}calculateCenterFromCameraLngLatAlt(e,r,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,u)}setLocationAtPoint(e,r){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,r),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,r),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,r){return this.currentTransform.locationToScreenPoint(e,r)}screenPointToMercatorCoordinate(e,r){return this.currentTransform.screenPointToMercatorCoordinate(e,r)}screenPointToLocation(e,r){return this.currentTransform.screenPointToLocation(e,r)}isPointOnMapSurface(e,r){return this.currentTransform.isPointOnMapSurface(e,r)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,r){return this.currentTransform.getMatrixForModel(e,r)}getProjectionDataForCustomLayer(e=!0){const r=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return r;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=r.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Ro{get useGlobeControls(){return!0}handlePanInertia(e,r){const l=ql(e,r);return Math.abs(l.lng-r.center.lng)>180&&(l.lng=r.center.lng+179.5*Math.sign(l.lng-r.center.lng)),{easingCenter:l,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,r){const l=e.around,u=r.screenPointToLocation(l);e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta);const p=r.zoom;e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta);const y=r.zoom-p;if(y===0)return;const w=c.bm(r.center.lng,u.lng),T=w/(Math.abs(w/180)+1),k=c.bm(r.center.lat,u.lat),E=r.getRayDirectionFromPixel(l),D=r.cameraPosition,R=-1*c.aU(D,E),$=c.bh();c.aO($,D,[E[0]*R,E[1]*R,E[2]*R]);const N=c.bs($)-1,K=Math.exp(.5*-Math.max(N-.3,0)),Y=Co(r.worldSize,r.center.lat)/Math.min(r.width,r.height),J=c.be(Y,.9,.5,1,.25),re=(1-c.aH(-y))*Math.min(K,J),ne=r.center.lat,le=r.zoom,ue=new c.Q(r.center.lng+T*re,c.ad(r.center.lat+k*re,-85.051129,c.aI));r.setLocationAtPoint(u,l);const fe=r.center,he=c.be(Math.abs(w),45,85,0,1),be=c.be(Y,.75,.35,0,1),we=Math.pow(Math.max(he,be),.25),Ae=c.bm(fe.lng,ue.lng),Re=c.bm(fe.lat,ue.lat);r.setCenter(new c.Q(fe.lng+Ae*we,fe.lat+Re*we).wrap()),r.setZoom(le+Or(ne,r.center.lat))}handleMapControlsPan(e,r,l){if(!e.panDelta)return;const u=r.center.lat,p=r.zoom;r.setCenter(ql(e.panDelta,r).wrap()),r.setZoom(p+Or(u,r.center.lat))}cameraForBoxAndBearing(e,r,l,u,p){const y=Zl(e,r,l,u,p),w=r.left/p.width*2-1,T=(p.width-r.right)/p.width*2-1,k=r.top/p.height*-2+1,E=(p.height-r.bottom)/p.height*-2+1,D=c.bm(l.getWest(),l.getEast())<0,R=D?l.getEast():l.getWest(),$=D?l.getWest():l.getEast(),N=Math.max(l.getNorth(),l.getSouth()),K=Math.min(l.getNorth(),l.getSouth()),Y=R+.5*c.bm(R,$),J=N+.5*c.bm(N,K),re=p.clone();re.setCenter(y.center),re.setBearing(y.bearing),re.setPitch(0),re.setRoll(0),re.setZoom(y.zoom);const ne=re.modelViewProjectionMatrix,le=[wo(l.getNorthWest()),wo(l.getNorthEast()),wo(l.getSouthWest()),wo(l.getSouthEast()),wo(new c.Q($,J)),wo(new c.Q(R,J)),wo(new c.Q(Y,N)),wo(new c.Q(Y,K))],ue=wo(y.center);let fe=Number.POSITIVE_INFINITY;for(const he of le)w<0&&(fe=Ro.getLesserNonNegativeNonNull(fe,Ro.solveVectorScale(he,ue,ne,"x",w))),T>0&&(fe=Ro.getLesserNonNegativeNonNull(fe,Ro.solveVectorScale(he,ue,ne,"x",T))),k>0&&(fe=Ro.getLesserNonNegativeNonNull(fe,Ro.solveVectorScale(he,ue,ne,"y",k))),E<0&&(fe=Ro.getLesserNonNegativeNonNull(fe,Ro.solveVectorScale(he,ue,ne,"y",E)));if(Number.isFinite(fe)&&fe!==0)return y.zoom=re.zoom+c.aa(fe),y;Rs()}handleJumpToCenterZoom(e,r){const l=e.center.lat,u=e.getConstrained(r.center?c.Q.convert(r.center):e.center,e.zoom).center;e.setCenter(u.wrap());const p=r.zoom!==void 0?+r.zoom:e.zoom+Or(l,u.lat);e.zoom!==p&&e.setZoom(p)}handleEaseTo(e,r){const l=e.zoom,u=e.center,p=e.padding,y={roll:e.roll,pitch:e.pitch,bearing:e.bearing},w={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},T=r.zoom!==void 0,k=!e.isPaddingEqual(r.padding);let E=!1;const D=r.center?c.Q.convert(r.center):u,R=e.getConstrained(D,l).center;Po(e,R);const $=e.clone();$.setCenter(R),$.setZoom(T?+r.zoom:l+Or(u.lat,D.lat)),$.setBearing(r.bearing);const N=new c.P(c.ad(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),c.ad(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));$.setLocationAtPoint(R,N);const K=(r.offset&&r.offsetAsPoint.mag())>0?$.center:R,Y=T?+r.zoom:l+Or(u.lat,K.lat),J=l+Or(u.lat,0),re=Y+Or(K.lat,0),ne=c.bm(u.lng,K.lng),le=c.bm(u.lat,K.lat),ue=c.aH(re-J);return E=Y!==l,{easeFunc:fe=>{if(c.b5(y,w)||ai({startEulerAngles:y,endEulerAngles:w,tr:e,k:fe,useSlerp:y.roll!=w.roll}),k&&e.interpolatePadding(p,r.padding,fe),r.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(r.around,r.aroundPoint);else{const he=re>J?Math.min(2,ue):Math.max(.5,ue),be=Math.pow(he,1-fe),we=_n(u,ne,le,fe*be);e.setCenter(we.wrap())}if(E){const he=c.B.number(J,re,fe)+Or(0,e.center.lat);e.setZoom(he)}},isZooming:E,elevationCenter:K}}handleFlyTo(e,r){const l=r.zoom!==void 0,u=e.center,p=e.zoom,y=e.padding,w=!e.isPaddingEqual(r.padding),T=e.getConstrained(c.Q.convert(r.center||r.locationAtOffset),p).center,k=l?+r.zoom:e.zoom+Or(e.center.lat,T.lat),E=e.clone();E.setCenter(T),E.setZoom(k),E.setBearing(r.bearing);const D=new c.P(c.ad(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),c.ad(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));E.setLocationAtPoint(T,D);const R=E.center;Po(e,R);const $=function(le,ue,fe){const he=wo(ue),be=wo(fe),we=c.aU(he,be),Ae=Math.acos(we),Re=Gl(le);return Ae/(2*Math.PI)*Re}(e,u,R),N=p+Or(u.lat,0),K=k+Or(R.lat,0),Y=c.aH(K-N);let J;if(typeof r.minZoom=="number"){const le=+r.minZoom+Or(R.lat,0),ue=Math.min(le,N,K)+Or(0,R.lat),fe=e.getConstrained(R,ue).zoom+Or(R.lat,0);J=c.aH(fe-N)}const re=c.bm(u.lng,R.lng),ne=c.bm(u.lat,R.lat);return{easeFunc:(le,ue,fe,he)=>{const be=_n(u,re,ne,fe);w&&e.interpolatePadding(y,r.padding,le);const we=le===1?R:be;e.setCenter(we.wrap());const Ae=N+c.aa(ue);e.setZoom(le===1?k:Ae+Or(0,we.lat))},scaleOfZoom:Y,targetCenter:R,scaleOfMinZoom:J,pixelPathLength:$}}static solveVectorScale(e,r,l,u,p){const y=u==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],w=[l[3],l[7],l[11],l[15]],T=e[0]*y[0]+e[1]*y[1]+e[2]*y[2],k=e[0]*w[0]+e[1]*w[1]+e[2]*w[2],E=r[0]*y[0]+r[1]*y[1]+r[2]*y[2],D=r[0]*w[0]+r[1]*w[1]+r[2]*w[2];return E+p*k===T+p*D||w[3]*(T-E)+y[3]*(D-k)+T*D==E*k?null:(E+y[3]-p*D-p*w[3])/(E-T-p*D+p*k)}static getLesserNonNegativeNonNull(e,r){return r!==null&&r>=0&&r<e?r:e}}class Ia{constructor(e){this._globe=e,this._mercatorCameraHelper=new bi,this._verticalPerspectiveCameraHelper=new Ro}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,r){return this.currentHelper.handlePanInertia(e,r)}handleMapControlsRollPitchBearingZoom(e,r){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,r)}handleMapControlsPan(e,r,l){this.currentHelper.handleMapControlsPan(e,r,l)}cameraForBoxAndBearing(e,r,l,u,p){return this.currentHelper.cameraForBoxAndBearing(e,r,l,u,p)}handleJumpToCenterZoom(e,r){this.currentHelper.handleJumpToCenterZoom(e,r)}handleEaseTo(e,r){return this.currentHelper.handleEaseTo(e,r)}handleFlyTo(e,r){return this.currentHelper.handleFlyTo(e,r)}}const yn=(f,e)=>c.x(f,e&&e.filter(r=>r.identifier!=="source.canvas")),Hl=c.bt();class $s extends c.E{constructor(e,r={}){super(),this._rtlPluginLoaded=()=>{for(const l in this.sourceCaches){const u=this.sourceCaches[l].getSource().type;u!=="vector"&&u!=="geojson"||this.sourceCaches[l].reload()}},this.map=e,this.dispatcher=new bo(qr(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(l,u)=>this.getGlyphs(l,u)),this.dispatcher.registerMessageHandler("GI",(l,u)=>this.getImages(l,u)),this.imageManager=new bt,this.imageManager.setEventedParent(this),this.glyphManager=new et(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new cr(256,512),this.crossTileSymbolIndex=new Nl,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bu,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.bv()),Ut().on(Rt,this._rtlPluginLoaded),this.on("data",l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const u=this.sourceCaches[l.sourceId];if(!u)return;const p=u.getSource();if(p&&p.vectorLayerIds)for(const y in this._layers){const w=this._layers[y];w.source===p.id&&this._validateLayer(w)}})}loadURL(e,r={},l){this.fire(new c.l("dataloading",{dataType:"style"})),r.validate=typeof r.validate!="boolean"||r.validate;const u=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const p=this._loadStyleRequest;c.j(u,this._loadStyleRequest).then(y=>{this._loadStyleRequest=null,this._load(y.data,r,l)}).catch(y=>{this._loadStyleRequest=null,y&&!p.signal.aborted&&this.fire(new c.k(y))})}loadJSON(e,r={},l){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,Q.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(e,r,l)}).catch(()=>{})}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(Hl,{validate:!1})}_load(e,r,l){var u,p;const y=r.transformStyle?r.transformStyle(l,e):e;if(!r.validate||!yn(this,c.y(y))){this._loaded=!0,this.stylesheet=y;for(const w in y.sources)this.addSource(w,y.sources[w],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new wt(this.stylesheet.light),this._setProjectionInternal(((u=this.stylesheet.projection)===null||u===void 0?void 0:u.type)||"mercator"),this.sky=new sr(this.stylesheet.sky),this.map.setTerrain((p=this.stylesheet.terrain)!==null&&p!==void 0?p:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){const e=c.bw(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(r=>r.id),this._layers={},this._serializedLayers=null;for(const r of e){const l=c.bx(r);l.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=l}}_loadSprite(e,r=!1,l=void 0){let u;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(p,y,w,T){return c._(this,void 0,void 0,function*(){const k=dt(p),E=w>1?"@2x":"",D={},R={};for(const{id:$,url:N}of k){const K=y.transformRequest(_t(N,E,".json"),"SpriteJSON");D[$]=c.j(K,T);const Y=y.transformRequest(_t(N,E,".png"),"SpriteImage");R[$]=Te.getImage(Y,T)}return yield Promise.all([...Object.values(D),...Object.values(R)]),function($,N){return c._(this,void 0,void 0,function*(){const K={};for(const Y in $){K[Y]={};const J=Q.getImageCanvasContext((yield N[Y]).data),re=(yield $[Y]).data;for(const ne in re){const{width:le,height:ue,x:fe,y:he,sdf:be,pixelRatio:we,stretchX:Ae,stretchY:Re,content:Ee,textFitWidth:Ke,textFitHeight:Xe}=re[ne];K[Y][ne]={data:null,pixelRatio:we,sdf:be,stretchX:Ae,stretchY:Re,content:Ee,textFitWidth:Ke,textFitHeight:Xe,spriteData:{width:le,height:ue,x:fe,y:he,context:J}}}}return K})}(D,R)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(p=>{if(this._spriteRequest=null,p)for(const y in p){this._spritesImagesIds[y]=[];const w=this._spritesImagesIds[y]?this._spritesImagesIds[y].filter(T=>!(T in p)):[];for(const T of w)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in p[y]){const k=y==="default"?T:`${y}:${T}`;this._spritesImagesIds[y].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,p[y][T],!1):this.imageManager.addImage(k,p[y][T]),r&&(this._changedImages[k]=!0)}}}).catch(p=>{this._spriteRequest=null,u=p,this.fire(new c.k(u))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),l&&l(u)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(e){const r=this.sourceCaches[e.source];if(!r)return;const l=e.sourceLayer;if(!l)return;const u=r.getSource();(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(l)===-1)&&this.fire(new c.k(new Error(`Source layer "${l}" does not exist on source "${u.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,r=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(r?c.by(l):l);const u=[];for(const p of e)if(l[p]){const y=r?c.by(l[p]):l[p];u.push(y)}return u}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const r=Object.keys(this._layers);for(const l of r){const u=this._layers[l];u.type!=="custom"&&(e[l]=u.serialize())}return e}hasTransitions(){var e,r,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((r=this.sky)===null||r===void 0)&&r.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const u in this.sourceCaches)if(this.sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const r=this._changed;if(r){const u=Object.keys(this._updatedLayers),p=Object.keys(this._removedLayers);(u.length||p.length)&&this._updateWorkerLayers(u,p);for(const y in this._updatedSources){const w=this._updatedSources[y];if(w==="reload")this._reloadSource(y);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(y)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const y in this._updatedPaintProps)this._layers[y].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const u in this.sourceCaches){const p=this.sourceCaches[u];l[u]=p.used,p.used=!1}for(const u of this._order){const p=this._layers[u];p.recalculate(e,this._availableImages),!p.isHidden(e.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}for(const u in l){const p=this.sourceCaches[u];!!l[u]!=!!p.used&&p.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:u}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,r&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var l;this._checkLoaded();const u=this.serialize();if(e=r.transformStyle?r.transformStyle(u,e):e,((l=r.validate)===null||l===void 0||l)&&yn(this,c.y(e)))return!1;(e=c.by(e)).layers=c.bw(e.layers);const p=c.bz(u,e),y=this._getOperationsToPerform(p);if(y.unimplemented.length>0)throw new Error(`Unimplemented: ${y.unimplemented.join(", ")}.`);if(y.operations.length===0)return!1;for(const w of y.operations)w();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const r=[],l=[];for(const u of e)switch(u.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":r.push(()=>this.addLayer.apply(this,u.args));break;case"removeLayer":r.push(()=>this.removeLayer.apply(this,u.args));break;case"setPaintProperty":r.push(()=>this.setPaintProperty.apply(this,u.args));break;case"setLayoutProperty":r.push(()=>this.setLayoutProperty.apply(this,u.args));break;case"setFilter":r.push(()=>this.setFilter.apply(this,u.args));break;case"addSource":r.push(()=>this.addSource.apply(this,u.args));break;case"removeSource":r.push(()=>this.removeSource.apply(this,u.args));break;case"setLayerZoomRange":r.push(()=>this.setLayerZoomRange.apply(this,u.args));break;case"setLight":r.push(()=>this.setLight.apply(this,u.args));break;case"setGeoJSONSourceData":r.push(()=>this.setGeoJSONSourceData.apply(this,u.args));break;case"setGlyphs":r.push(()=>this.setGlyphs.apply(this,u.args));break;case"setSprite":r.push(()=>this.setSprite.apply(this,u.args));break;case"setTerrain":r.push(()=>this.map.setTerrain.apply(this,u.args));break;case"setSky":r.push(()=>this.setSky.apply(this,u.args));break;case"setProjection":this.setProjection.apply(this,u.args);break;case"setTransition":r.push(()=>{});break;default:l.push(u.command)}return{operations:r,unimplemented:l}}addImage(e,r){if(this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,r){this.imageManager.updateImage(e,r)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(c.y.source,`sources.${e}`,r,null,l))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const u=this.sourceCaches[e]=new A(e,r,this.dispatcher);u.style=this,u.setEventedParent(this,()=>({isSourceLoaded:u.loaded(),source:u.serialize(),sourceId:e})),u.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new c.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,r){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(r),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,l={}){this._checkLoaded();const u=e.id;if(this.getLayer(u))return void this.fire(new c.k(new Error(`Layer "${u}" already exists on this map.`)));let p;if(e.type==="custom"){if(yn(this,c.bA(e)))return;p=c.bx(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(u,e.source),e=c.by(e),e=c.e(e,{source:u})),this._validate(c.y.layer,`layers.${u}`,e,{arrayIndex:-1},l))return;p=c.bx(e),this._validateLayer(p),p.setEventedParent(this,{layer:{id:u}})}const y=r?this._order.indexOf(r):this._order.length;if(r&&y===-1)this.fire(new c.k(new Error(`Cannot add layer "${u}" before non-existing layer "${r}".`)));else{if(this._order.splice(y,0,u),this._layerOrderChanged=!0,this._layers[u]=p,this._removedLayers[u]&&p.source&&p.type!=="custom"){const w=this._removedLayers[u];delete this._removedLayers[u],w.type!==p.type?this._updatedSources[p.source]="clear":(this._updatedSources[p.source]="reload",this.sourceCaches[p.source].pause())}this._updateLayer(p),p.onAdd&&p.onAdd(this.map)}}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;const l=this._order.indexOf(e);this._order.splice(l,1);const u=r?this._order.indexOf(r):this._order.length;r&&u===-1?this.fire(new c.k(new Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(u,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const r=this._layers[e];if(!r)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${e}".`)));r.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,l){this._checkLoaded();const u=this.getLayer(e);u?u.minzoom===r&&u.maxzoom===l||(r!=null&&(u.minzoom=r),l!=null&&(u.maxzoom=l),this._updateLayer(u)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r,l={}){this._checkLoaded();const u=this.getLayer(e);if(u){if(!c.bB(u.filter,r))return r==null?(u.filter=void 0,void this._updateLayer(u)):void(this._validate(c.y.filter,`layers.${u.id}.filter`,r,null,l)||(u.filter=c.by(r),this._updateLayer(u)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.by(this.getLayer(e).filter)}setLayoutProperty(e,r,l,u={}){this._checkLoaded();const p=this.getLayer(e);p?c.bB(p.getLayoutProperty(r),l)||(p.setLayoutProperty(r,l,u),this._updateLayer(p)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){const l=this.getLayer(e);if(l)return l.getLayoutProperty(r);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,l,u={}){this._checkLoaded();const p=this.getLayer(e);p?c.bB(p.getPaintProperty(r),l)||(p.setPaintProperty(r,l,u)&&this._updateLayer(p),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,r){return this.getLayer(e).getPaintProperty(r)}setFeatureState(e,r){this._checkLoaded();const l=e.source,u=e.sourceLayer,p=this.sourceCaches[l];if(p===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const y=p.getSource().type;y==="geojson"&&u?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):y!=="vector"||u?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),p.setFeatureState(u,e.id,r)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();const l=e.source,u=this.sourceCaches[l];if(u===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const p=u.getSource().type,y=p==="vector"?e.sourceLayer:void 0;p!=="vector"||y?r&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):u.removeFeatureState(y,e.id,r):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const r=e.source,l=e.sourceLayer,u=this.sourceCaches[r];if(u!==void 0)return u.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),u.getFeatureState(l,e.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bC(this.sourceCaches,p=>p.serialize()),r=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,u=this.stylesheet;return c.bD({version:u.version,name:u.name,metadata:u.metadata,light:u.light,sky:u.sky,center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,sprite:u.sprite,glyphs:u.glyphs,transition:u.transition,projection:u.projection,sources:e,layers:r,terrain:l},p=>p!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const r=y=>this._layers[y].type==="fill-extrusion",l={},u=[];for(let y=this._order.length-1;y>=0;y--){const w=this._order[y];if(r(w)){l[w]=y;for(const T of e){const k=T[w];if(k)for(const E of k)u.push(E)}}}u.sort((y,w)=>w.intersectionZ-y.intersectionZ);const p=[];for(let y=this._order.length-1;y>=0;y--){const w=this._order[y];if(r(w))for(let T=u.length-1;T>=0;T--){const k=u[T].feature;if(l[k.layer.id]<y)break;p.push(k),u.pop()}else for(const T of e){const k=T[w];if(k)for(const E of k)p.push(E.feature)}}return p}queryRenderedFeatures(e,r,l){r&&r.filter&&this._validate(c.y.filter,"queryRenderedFeatures.filter",r.filter,null,r);const u={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const k of r.layers){const E=this._layers[k];if(!E)return this.fire(new c.k(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];u[E.source]=!0}}const p=[];r.availableImages=this._availableImages;const y=this._serializedAllLayers(),w=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,T=Object.assign(Object.assign({},r),{layers:w});for(const k in this.sourceCaches)r.layers&&!u[k]||p.push(Zo(this.sourceCaches[k],this._layers,y,e,T,l));return this.placement&&p.push(function(k,E,D,R,$,N,K){const Y={},J=N.queryRenderedSymbols(R),re=[];for(const ne of Object.keys(J).map(Number))re.push(K[ne]);re.sort(Wr);for(const ne of re){const le=ne.featureIndex.lookupSymbolFeatures(J[ne.bucketInstanceId],E,ne.bucketIndex,ne.sourceLayerIndex,$.filter,$.layers,$.availableImages,k);for(const ue in le){const fe=Y[ue]=Y[ue]||[],he=le[ue];he.sort((be,we)=>{const Ae=ne.featureSortOrder;if(Ae){const Re=Ae.indexOf(be.featureIndex);return Ae.indexOf(we.featureIndex)-Re}return we.featureIndex-be.featureIndex});for(const be of he)fe.push(be)}}return function(ne,le,ue){for(const fe in ne)for(const he of ne[fe])ae(he,ue[le[fe].source]);return ne}(Y,k,D)}(this._layers,y,this.sourceCaches,e,T,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(p)}querySourceFeatures(e,r){r&&r.filter&&this._validate(c.y.filter,"querySourceFeatures.filter",r.filter,null,r);const l=this.sourceCaches[e];return l?function(u,p){const y=u.getRenderableIds().map(k=>u.getTileByID(k)),w=[],T={};for(let k=0;k<y.length;k++){const E=y[k],D=E.tileID.canonical.key;T[D]||(T[D]=!0,E.querySourceFeatures(w,p))}return w}(l,r):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();const l=this.light.getLight();let u=!1;for(const y in e)if(!c.bB(e[y],l[y])){u=!0;break}if(!u)return;const p={now:Q.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(p)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,r={}){this._checkLoaded();const l=this.getSky();let u=!1;if(!e&&!l)return;if(e&&!l)u=!0;else if(!e&&l)u=!0;else for(const y in e)if(!c.bB(e[y],l[y])){u=!0;break}if(!u)return;const p={now:Q.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(p)}_setProjectionInternal(e){const r=function(l){if(Array.isArray(l)){const u=new Ca({type:l});return{projection:u,transform:new Ma,cameraHelper:new Ia(u)}}switch(l){case"mercator":return{projection:new Vl,transform:new si,cameraHelper:new bi};case"globe":{const u=new Ca({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:u,transform:new Ma,cameraHelper:new Ia(u)}}case"vertical-perspective":return{projection:new Jn,transform:new Pa,cameraHelper:new Ro};default:return c.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new Vl,transform:new si,cameraHelper:new bi}}}(e);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,r,l,u,p={}){return(!p||p.validate!==!1)&&yn(this,e.call(c.y,c.e({key:r,style:this.serialize(),value:l,styleSpec:c.v},u)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ut().off(Rt,this._rtlPluginLoaded);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const l=this.sourceCaches[r];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const r in this.sourceCaches)this.sourceCaches[r].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,r,l,u,p=!1){let y=!1,w=!1;const T={};for(const k of this._order){const E=this._layers[k];if(E.type!=="symbol")continue;if(!T[E.source]){const R=this.sourceCaches[E.source];T[E.source]=R.getRenderableIds(!0).map($=>R.getTileByID($)).sort(($,N)=>N.tileID.overscaledZ-$.tileID.overscaledZ||($.tileID.isLessThan(N.tileID)?-1:1))}const D=this.crossTileSymbolIndex.addLayer(E,T[E.source],e.center.lng);y=y||D}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((p=p||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Q.now(),e.zoom))&&(this.pauseablePlacement=new Ol(e,this.map.terrain,this._order,p,r,l,u,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Q.now()),w=!0),y&&this.pauseablePlacement.placement.setStale()),w||y)for(const k of this._order){const E=this._layers[k];E.type==="symbol"&&this.placement.updateLayerOpacities(E,T[E.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Q.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,r){return c._(this,void 0,void 0,function*(){const l=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const u=this.sourceCaches[r.source];return u&&u.setDependencies(r.tileID.key,r.type,r.icons),l})}getGlyphs(e,r){return c._(this,void 0,void 0,function*(){const l=yield this.glyphManager.getGlyphs(r.stacks),u=this.sourceCaches[r.source];return u&&u.setDependencies(r.tileID.key,r.type,[""]),l})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),e&&this._validate(c.y.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r,l={},u){this._checkLoaded();const p=[{id:e,url:r}],y=[...dt(this.stylesheet.sprite),...p];this._validate(c.y.sprite,"sprite",y,null,l)||(this.stylesheet.sprite=y,this._loadSprite(p,!0,u))}removeSprite(e){this._checkLoaded();const r=dt(this.stylesheet.sprite);if(r.find(l=>l.id===e)){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;r.splice(r.findIndex(l=>l.id===e),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return dt(this.stylesheet.sprite)}setSprite(e,r={},l){this._checkLoaded(),e&&this._validate(c.y.sprite,"sprite",e,null,r)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var Ii=c.aC([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Xd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,r,l,u,p,y,w,T,k){this.context=e;let E=this.boundPaintVertexBuffers.length!==u.length;for(let D=0;!E&&D<u.length;D++)this.boundPaintVertexBuffers[D]!==u[D]&&(E=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==l||E||this.boundIndexBuffer!==p||this.boundVertexOffset!==y||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==k?this.freshBind(r,l,u,p,y,w,T,k):(e.bindVertexArray.set(this.vao),w&&w.bind(),p&&p.dynamicDraw&&p.bind(),T&&T.bind(),k&&k.bind())}freshBind(e,r,l,u,p,y,w,T){const k=e.numAttributes,E=this.context,D=E.gl;this.vao&&this.destroy(),this.vao=E.createVertexArray(),E.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=u,this.boundVertexOffset=p,this.boundDynamicVertexBuffer=y,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=T,r.enableAttributes(D,e);for(const R of l)R.enableAttributes(D,e);y&&y.enableAttributes(D,e),w&&w.enableAttributes(D,e),T&&T.enableAttributes(D,e),r.bind(),r.setVertexAttribPointers(D,e,p);for(const R of l)R.bind(),R.setVertexAttribPointers(D,e,p);y&&(y.bind(),y.setVertexAttribPointers(D,e,p)),u&&u.bind(),w&&(w.bind(),w.setVertexAttribPointers(D,e,p)),T&&(T.bind(),T.setVertexAttribPointers(D,e,p)),E.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Xl=(f,e,r,l,u)=>({u_texture:0,u_ele_delta:f,u_fog_matrix:e,u_fog_color:r?r.properties.get("fog-color"):c.b6.white,u_fog_ground_blend:r?r.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:u?0:r?r.calculateFogBlendOpacity(l):0,u_horizon_color:r?r.properties.get("horizon-color"):c.b6.white,u_horizon_fog_blend:r?r.properties.get("horizon-fog-blend"):1,u_is_globe_mode:u?1:0}),js={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function en(f){const e=[];for(let r=0;r<f.length;r++){if(f[r]===null)continue;const l=f[r].split(" ");e.push(l.pop())}return e}class Yd{constructor(e,r,l,u,p,y,w,T){const k=e.gl;this.program=k.createProgram();const E=en(r.staticAttributes),D=l?l.getBinderAttributes():[],R=E.concat(D),$=yi.prelude.staticUniforms?en(yi.prelude.staticUniforms):[],N=w.staticUniforms?en(w.staticUniforms):[],K=r.staticUniforms?en(r.staticUniforms):[],Y=l?l.getBinderUniforms():[],J=$.concat(N).concat(K).concat(Y),re=[];for(const we of J)re.indexOf(we)<0&&re.push(we);const ne=l?l.defines():[];li(k)&&ne.unshift("#version 300 es"),p&&ne.push("#define OVERDRAW_INSPECTOR;"),y&&ne.push("#define TERRAIN3D;"),T&&ne.push(T);let le=ne.concat(yi.prelude.fragmentSource,w.fragmentSource,r.fragmentSource).join(`
`),ue=ne.concat(yi.prelude.vertexSource,w.vertexSource,r.vertexSource).join(`
`);li(k)||(le=function(we){return we.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(le),ue=function(we){return we.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(ue));const fe=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(fe,le),k.compileShader(fe),!k.getShaderParameter(fe,k.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${k.getShaderInfoLog(fe)}`);k.attachShader(this.program,fe);const he=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(he,ue),k.compileShader(he),!k.getShaderParameter(he,k.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${k.getShaderInfoLog(he)}`);k.attachShader(this.program,he),this.attributes={};const be={};this.numAttributes=R.length;for(let we=0;we<this.numAttributes;we++)R[we]&&(k.bindAttribLocation(this.program,we,R[we]),this.attributes[R[we]]=we);if(k.linkProgram(this.program),!k.getProgramParameter(this.program,k.LINK_STATUS))throw new Error(`Program failed to link: ${k.getProgramInfoLog(this.program)}`);k.deleteShader(he),k.deleteShader(fe);for(let we=0;we<re.length;we++){const Ae=re[we];if(Ae&&!be[Ae]){const Re=k.getUniformLocation(this.program,Ae);Re&&(be[Ae]=Re)}}this.fixedUniforms=u(e,be),this.terrainUniforms=((we,Ae)=>({u_depth:new c.bE(we,Ae.u_depth),u_terrain:new c.bE(we,Ae.u_terrain),u_terrain_dim:new c.b7(we,Ae.u_terrain_dim),u_terrain_matrix:new c.bG(we,Ae.u_terrain_matrix),u_terrain_unpack:new c.bH(we,Ae.u_terrain_unpack),u_terrain_exaggeration:new c.b7(we,Ae.u_terrain_exaggeration)}))(e,be),this.projectionUniforms=((we,Ae)=>({u_projection_matrix:new c.bG(we,Ae.u_projection_matrix),u_projection_tile_mercator_coords:new c.bH(we,Ae.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bH(we,Ae.u_projection_clipping_plane),u_projection_transition:new c.b7(we,Ae.u_projection_transition),u_projection_fallback_matrix:new c.bG(we,Ae.u_projection_fallback_matrix)}))(e,be),this.binderUniforms=l?l.getUniforms(e,be):[]}draw(e,r,l,u,p,y,w,T,k,E,D,R,$,N,K,Y,J,re,ne){const le=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(u),e.setColorMode(p),e.setCullFace(y),T){e.activeTexture.set(le.TEXTURE2),le.bindTexture(le.TEXTURE_2D,T.depthTexture),e.activeTexture.set(le.TEXTURE3),le.bindTexture(le.TEXTURE_2D,T.texture);for(const fe in this.terrainUniforms)this.terrainUniforms[fe].set(T[fe])}if(k)for(const fe in k)this.projectionUniforms[js[fe]].set(k[fe]);if(w)for(const fe in this.fixedUniforms)this.fixedUniforms[fe].set(w[fe]);Y&&Y.setUniforms(e,this.binderUniforms,N,{zoom:K});let ue=0;switch(r){case le.LINES:ue=2;break;case le.TRIANGLES:ue=3;break;case le.LINE_STRIP:ue=1}for(const fe of $.get()){const he=fe.vaos||(fe.vaos={});(he[E]||(he[E]=new Xd)).bind(e,this,D,Y?Y.getPaintVertexBuffers():[],R,fe.vertexOffset,J,re,ne),le.drawElements(r,fe.primitiveLength*ue,le.UNSIGNED_SHORT,fe.primitiveOffset*ue*2)}}}function Ns(f,e,r){const l=1/c.av(r,1,e.transform.tileZoom),u=Math.pow(2,r.tileID.overscaledZ),p=r.tileSize*Math.pow(2,e.transform.tileZoom)/u,y=p*(r.tileID.canonical.x+r.tileID.wrap*u),w=p*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[l,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[y>>16,w>>16],u_pixel_coord_lower:[65535&y,65535&w]}}const Uu=(f,e,r,l)=>{const u=f.style.light,p=u.properties.get("position"),y=[p.x,p.y,p.z],w=c.bK();u.properties.get("anchor")==="viewport"&&c.bL(w,f.transform.bearingInRadians),c.bM(y,y,w);const T=f.transform.transformLightDirection(y),k=u.properties.get("color");return{u_lightpos:y,u_lightpos_globe:T,u_lightintensity:u.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+e,u_opacity:r,u_fill_translate:l}},Qn=(f,e,r,l,u,p,y)=>c.e(Uu(f,e,r,l),Ns(p,f,y),{u_height_factor:-Math.pow(2,u.overscaledZ)/y.tileSize/8}),Zu=(f,e,r,l)=>c.e(Ns(e,f,r),{u_fill_translate:l}),Gu=(f,e)=>({u_world:f,u_fill_translate:e}),Kd=(f,e,r,l,u)=>c.e(Zu(f,e,r,u),{u_world:l}),qu=(f,e,r,l,u)=>{const p=f.transform;let y,w,T=0;if(r.paint.get("circle-pitch-alignment")==="map"){const k=c.av(e,1,p.zoom);y=!0,w=[k,k],T=k/(c.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*u}else y=!1,w=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+y,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:w,u_globe_extrude_scale:T,u_translate:l}},Yl=f=>({u_pixel_extrude_scale:[1/f.width,1/f.height]}),Wu=f=>({u_viewport_size:[f.width,f.height]}),Kl=(f,e=1)=>({u_color:f,u_overlay:0,u_overlay_scale:e}),Jl=(f,e,r,l)=>{const u=c.av(f,1,e)/(c.Z*Math.pow(2,f.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:c.av(f,1,e),u_intensity:r,u_globe_extrude_scale:u}},Ql=(f,e,r,l)=>{const u=c.K();c.bN(u,0,f.width,f.height,0,0,1);const p=f.context.gl;return{u_matrix:u,u_world:[p.drawingBufferWidth,p.drawingBufferHeight],u_image:r,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},vn=(f,e,r)=>{const l=r.paint.get("hillshade-shadow-color"),u=r.paint.get("hillshade-highlight-color"),p=r.paint.get("hillshade-accent-color");let y=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);return r.paint.get("hillshade-illumination-anchor")==="viewport"&&(y+=f.transform.bearingInRadians),{u_image:0,u_latrange:Xu(0,e.tileID),u_light:[r.paint.get("hillshade-exaggeration"),y],u_shadow:l,u_highlight:u,u_accent:p}},Hu=(f,e)=>{const r=e.stride,l=c.K();return c.bN(l,0,c.Z,-8192,0,0,1),c.L(l,l,[0,-8192,0]),{u_matrix:l,u_image:1,u_dimension:[r,r],u_zoom:f.overscaledZ,u_unpack:e.getUnpackVector()}};function Xu(f,e){const r=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new c.$(0,l/r).toLngLat().lat,new c.$(0,(l+1)/r).toLngLat().lat]}const bn=(f,e,r,l)=>{const u=f.transform;return{u_translation:ec(f,e,r),u_ratio:l/c.av(e,1,u.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},Jd=(f,e,r,l,u)=>c.e(bn(f,e,r,l),{u_image:0,u_image_height:u}),Ea=(f,e,r,l,u)=>{const p=f.transform,y=Yu(e,p);return{u_translation:ec(f,e,r),u_texsize:e.imageAtlasTexture.size,u_ratio:l/c.av(e,1,p.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[y,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},Qd=(f,e,r,l,u,p)=>{const y=f.lineAtlas,w=Yu(e,f.transform),T=r.layout.get("line-cap")==="round",k=y.getDash(u.from,T),E=y.getDash(u.to,T),D=k.width*p.fromScale,R=E.width*p.toScale;return c.e(bn(f,e,r,l),{u_patternscale_a:[w/D,-k.height/2],u_patternscale_b:[w/R,-E.height/2],u_sdfgamma:y.width/(256*Math.min(D,R)*f.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:E.y,u_mix:p.t})};function Yu(f,e){return 1/c.av(f,1,e.tileZoom)}function ec(f,e,r){return c.aw(f.transform,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const Ku=(f,e,r,l,u)=>{return{u_tl_parent:f,u_scale_parent:e,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(y=l.paint.get("raster-saturation"),y>0?1-1/(1.001-y):-y),u_contrast_factor:(p=l.paint.get("raster-contrast"),p>0?1/(1-p):1+p),u_spin_weights:Ju(l.paint.get("raster-hue-rotate")),u_coords_top:[u[0].x,u[0].y,u[1].x,u[1].y],u_coords_bottom:[u[3].x,u[3].y,u[2].x,u[2].y]};var p,y};function Ju(f){f*=Math.PI/180;const e=Math.sin(f),r=Math.cos(f);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}const Aa=(f,e,r,l,u,p,y,w,T,k,E,D,R)=>{const $=y.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:$.cameraToCenterDistance,u_pitch:$.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:$.width/$.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_label_plane_matrix:w,u_coord_matrix:T,u_is_text:+E,u_pitch_with_map:+l,u_is_along_line:u,u_is_variable_anchor:p,u_texsize:D,u_texture:0,u_translation:k,u_pitched_scale:R}},tc=(f,e,r,l,u,p,y,w,T,k,E,D,R,$)=>{const N=y.transform;return c.e(Aa(f,e,r,l,u,p,y,w,T,k,E,D,$),{u_gamma_scale:l?Math.cos(N.pitch*Math.PI/180)*N.cameraToCenterDistance:1,u_device_pixel_ratio:y.pixelRatio,u_is_halo:1})},za=(f,e,r,l,u,p,y,w,T,k,E,D,R)=>c.e(tc(f,e,r,l,u,p,y,w,T,k,!0,E,0,R),{u_texsize_icon:D,u_texture_icon:1}),Ni=(f,e)=>({u_opacity:f,u_color:e}),rc=(f,e,r,l,u)=>c.e(function(p,y,w,T){const k=w.imageManager.getPattern(p.from.toString()),E=w.imageManager.getPattern(p.to.toString()),{width:D,height:R}=w.imageManager.getPixelSize(),$=Math.pow(2,T.tileID.overscaledZ),N=T.tileSize*Math.pow(2,w.transform.tileZoom)/$,K=N*(T.tileID.canonical.x+T.tileID.wrap*$),Y=N*T.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:E.tl,u_pattern_br_b:E.br,u_texsize:[D,R],u_mix:y.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:E.displaySize,u_scale_a:y.fromScale,u_scale_b:y.toScale,u_tile_units_to_pixels:1/c.av(T,1,w.transform.tileZoom),u_pixel_coord_upper:[K>>16,Y>>16],u_pixel_coord_lower:[65535&K,65535&Y]}}(r,u,e,l),{u_opacity:f}),Da=(f,e)=>{},oc={fillExtrusion:(f,e)=>({u_lightpos:new c.bI(f,e.u_lightpos),u_lightpos_globe:new c.bI(f,e.u_lightpos_globe),u_lightintensity:new c.b7(f,e.u_lightintensity),u_lightcolor:new c.bI(f,e.u_lightcolor),u_vertical_gradient:new c.b7(f,e.u_vertical_gradient),u_opacity:new c.b7(f,e.u_opacity),u_fill_translate:new c.bJ(f,e.u_fill_translate)}),fillExtrusionPattern:(f,e)=>({u_lightpos:new c.bI(f,e.u_lightpos),u_lightpos_globe:new c.bI(f,e.u_lightpos_globe),u_lightintensity:new c.b7(f,e.u_lightintensity),u_lightcolor:new c.bI(f,e.u_lightcolor),u_vertical_gradient:new c.b7(f,e.u_vertical_gradient),u_height_factor:new c.b7(f,e.u_height_factor),u_opacity:new c.b7(f,e.u_opacity),u_fill_translate:new c.bJ(f,e.u_fill_translate),u_image:new c.bE(f,e.u_image),u_texsize:new c.bJ(f,e.u_texsize),u_pixel_coord_upper:new c.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bJ(f,e.u_pixel_coord_lower),u_scale:new c.bI(f,e.u_scale),u_fade:new c.b7(f,e.u_fade)}),fill:(f,e)=>({u_fill_translate:new c.bJ(f,e.u_fill_translate)}),fillPattern:(f,e)=>({u_image:new c.bE(f,e.u_image),u_texsize:new c.bJ(f,e.u_texsize),u_pixel_coord_upper:new c.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bJ(f,e.u_pixel_coord_lower),u_scale:new c.bI(f,e.u_scale),u_fade:new c.b7(f,e.u_fade),u_fill_translate:new c.bJ(f,e.u_fill_translate)}),fillOutline:(f,e)=>({u_world:new c.bJ(f,e.u_world),u_fill_translate:new c.bJ(f,e.u_fill_translate)}),fillOutlinePattern:(f,e)=>({u_world:new c.bJ(f,e.u_world),u_image:new c.bE(f,e.u_image),u_texsize:new c.bJ(f,e.u_texsize),u_pixel_coord_upper:new c.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bJ(f,e.u_pixel_coord_lower),u_scale:new c.bI(f,e.u_scale),u_fade:new c.b7(f,e.u_fade),u_fill_translate:new c.bJ(f,e.u_fill_translate)}),circle:(f,e)=>({u_camera_to_center_distance:new c.b7(f,e.u_camera_to_center_distance),u_scale_with_map:new c.bE(f,e.u_scale_with_map),u_pitch_with_map:new c.bE(f,e.u_pitch_with_map),u_extrude_scale:new c.bJ(f,e.u_extrude_scale),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.b7(f,e.u_globe_extrude_scale),u_translate:new c.bJ(f,e.u_translate)}),collisionBox:(f,e)=>({u_pixel_extrude_scale:new c.bJ(f,e.u_pixel_extrude_scale)}),collisionCircle:(f,e)=>({u_viewport_size:new c.bJ(f,e.u_viewport_size)}),debug:(f,e)=>({u_color:new c.bF(f,e.u_color),u_overlay:new c.bE(f,e.u_overlay),u_overlay_scale:new c.b7(f,e.u_overlay_scale)}),depth:Da,clippingMask:Da,heatmap:(f,e)=>({u_extrude_scale:new c.b7(f,e.u_extrude_scale),u_intensity:new c.b7(f,e.u_intensity),u_globe_extrude_scale:new c.b7(f,e.u_globe_extrude_scale)}),heatmapTexture:(f,e)=>({u_matrix:new c.bG(f,e.u_matrix),u_world:new c.bJ(f,e.u_world),u_image:new c.bE(f,e.u_image),u_color_ramp:new c.bE(f,e.u_color_ramp),u_opacity:new c.b7(f,e.u_opacity)}),hillshade:(f,e)=>({u_image:new c.bE(f,e.u_image),u_latrange:new c.bJ(f,e.u_latrange),u_light:new c.bJ(f,e.u_light),u_shadow:new c.bF(f,e.u_shadow),u_highlight:new c.bF(f,e.u_highlight),u_accent:new c.bF(f,e.u_accent)}),hillshadePrepare:(f,e)=>({u_matrix:new c.bG(f,e.u_matrix),u_image:new c.bE(f,e.u_image),u_dimension:new c.bJ(f,e.u_dimension),u_zoom:new c.b7(f,e.u_zoom),u_unpack:new c.bH(f,e.u_unpack)}),line:(f,e)=>({u_translation:new c.bJ(f,e.u_translation),u_ratio:new c.b7(f,e.u_ratio),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bJ(f,e.u_units_to_pixels)}),lineGradient:(f,e)=>({u_translation:new c.bJ(f,e.u_translation),u_ratio:new c.b7(f,e.u_ratio),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bJ(f,e.u_units_to_pixels),u_image:new c.bE(f,e.u_image),u_image_height:new c.b7(f,e.u_image_height)}),linePattern:(f,e)=>({u_translation:new c.bJ(f,e.u_translation),u_texsize:new c.bJ(f,e.u_texsize),u_ratio:new c.b7(f,e.u_ratio),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_image:new c.bE(f,e.u_image),u_units_to_pixels:new c.bJ(f,e.u_units_to_pixels),u_scale:new c.bI(f,e.u_scale),u_fade:new c.b7(f,e.u_fade)}),lineSDF:(f,e)=>({u_translation:new c.bJ(f,e.u_translation),u_ratio:new c.b7(f,e.u_ratio),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bJ(f,e.u_units_to_pixels),u_patternscale_a:new c.bJ(f,e.u_patternscale_a),u_patternscale_b:new c.bJ(f,e.u_patternscale_b),u_sdfgamma:new c.b7(f,e.u_sdfgamma),u_image:new c.bE(f,e.u_image),u_tex_y_a:new c.b7(f,e.u_tex_y_a),u_tex_y_b:new c.b7(f,e.u_tex_y_b),u_mix:new c.b7(f,e.u_mix)}),raster:(f,e)=>({u_tl_parent:new c.bJ(f,e.u_tl_parent),u_scale_parent:new c.b7(f,e.u_scale_parent),u_buffer_scale:new c.b7(f,e.u_buffer_scale),u_fade_t:new c.b7(f,e.u_fade_t),u_opacity:new c.b7(f,e.u_opacity),u_image0:new c.bE(f,e.u_image0),u_image1:new c.bE(f,e.u_image1),u_brightness_low:new c.b7(f,e.u_brightness_low),u_brightness_high:new c.b7(f,e.u_brightness_high),u_saturation_factor:new c.b7(f,e.u_saturation_factor),u_contrast_factor:new c.b7(f,e.u_contrast_factor),u_spin_weights:new c.bI(f,e.u_spin_weights),u_coords_top:new c.bH(f,e.u_coords_top),u_coords_bottom:new c.bH(f,e.u_coords_bottom)}),symbolIcon:(f,e)=>({u_is_size_zoom_constant:new c.bE(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bE(f,e.u_is_size_feature_constant),u_size_t:new c.b7(f,e.u_size_t),u_size:new c.b7(f,e.u_size),u_camera_to_center_distance:new c.b7(f,e.u_camera_to_center_distance),u_pitch:new c.b7(f,e.u_pitch),u_rotate_symbol:new c.bE(f,e.u_rotate_symbol),u_aspect_ratio:new c.b7(f,e.u_aspect_ratio),u_fade_change:new c.b7(f,e.u_fade_change),u_label_plane_matrix:new c.bG(f,e.u_label_plane_matrix),u_coord_matrix:new c.bG(f,e.u_coord_matrix),u_is_text:new c.bE(f,e.u_is_text),u_pitch_with_map:new c.bE(f,e.u_pitch_with_map),u_is_along_line:new c.bE(f,e.u_is_along_line),u_is_variable_anchor:new c.bE(f,e.u_is_variable_anchor),u_texsize:new c.bJ(f,e.u_texsize),u_texture:new c.bE(f,e.u_texture),u_translation:new c.bJ(f,e.u_translation),u_pitched_scale:new c.b7(f,e.u_pitched_scale)}),symbolSDF:(f,e)=>({u_is_size_zoom_constant:new c.bE(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bE(f,e.u_is_size_feature_constant),u_size_t:new c.b7(f,e.u_size_t),u_size:new c.b7(f,e.u_size),u_camera_to_center_distance:new c.b7(f,e.u_camera_to_center_distance),u_pitch:new c.b7(f,e.u_pitch),u_rotate_symbol:new c.bE(f,e.u_rotate_symbol),u_aspect_ratio:new c.b7(f,e.u_aspect_ratio),u_fade_change:new c.b7(f,e.u_fade_change),u_label_plane_matrix:new c.bG(f,e.u_label_plane_matrix),u_coord_matrix:new c.bG(f,e.u_coord_matrix),u_is_text:new c.bE(f,e.u_is_text),u_pitch_with_map:new c.bE(f,e.u_pitch_with_map),u_is_along_line:new c.bE(f,e.u_is_along_line),u_is_variable_anchor:new c.bE(f,e.u_is_variable_anchor),u_texsize:new c.bJ(f,e.u_texsize),u_texture:new c.bE(f,e.u_texture),u_gamma_scale:new c.b7(f,e.u_gamma_scale),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_is_halo:new c.bE(f,e.u_is_halo),u_translation:new c.bJ(f,e.u_translation),u_pitched_scale:new c.b7(f,e.u_pitched_scale)}),symbolTextAndIcon:(f,e)=>({u_is_size_zoom_constant:new c.bE(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bE(f,e.u_is_size_feature_constant),u_size_t:new c.b7(f,e.u_size_t),u_size:new c.b7(f,e.u_size),u_camera_to_center_distance:new c.b7(f,e.u_camera_to_center_distance),u_pitch:new c.b7(f,e.u_pitch),u_rotate_symbol:new c.bE(f,e.u_rotate_symbol),u_aspect_ratio:new c.b7(f,e.u_aspect_ratio),u_fade_change:new c.b7(f,e.u_fade_change),u_label_plane_matrix:new c.bG(f,e.u_label_plane_matrix),u_coord_matrix:new c.bG(f,e.u_coord_matrix),u_is_text:new c.bE(f,e.u_is_text),u_pitch_with_map:new c.bE(f,e.u_pitch_with_map),u_is_along_line:new c.bE(f,e.u_is_along_line),u_is_variable_anchor:new c.bE(f,e.u_is_variable_anchor),u_texsize:new c.bJ(f,e.u_texsize),u_texsize_icon:new c.bJ(f,e.u_texsize_icon),u_texture:new c.bE(f,e.u_texture),u_texture_icon:new c.bE(f,e.u_texture_icon),u_gamma_scale:new c.b7(f,e.u_gamma_scale),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_is_halo:new c.bE(f,e.u_is_halo),u_translation:new c.bJ(f,e.u_translation),u_pitched_scale:new c.b7(f,e.u_pitched_scale)}),background:(f,e)=>({u_opacity:new c.b7(f,e.u_opacity),u_color:new c.bF(f,e.u_color)}),backgroundPattern:(f,e)=>({u_opacity:new c.b7(f,e.u_opacity),u_image:new c.bE(f,e.u_image),u_pattern_tl_a:new c.bJ(f,e.u_pattern_tl_a),u_pattern_br_a:new c.bJ(f,e.u_pattern_br_a),u_pattern_tl_b:new c.bJ(f,e.u_pattern_tl_b),u_pattern_br_b:new c.bJ(f,e.u_pattern_br_b),u_texsize:new c.bJ(f,e.u_texsize),u_mix:new c.b7(f,e.u_mix),u_pattern_size_a:new c.bJ(f,e.u_pattern_size_a),u_pattern_size_b:new c.bJ(f,e.u_pattern_size_b),u_scale_a:new c.b7(f,e.u_scale_a),u_scale_b:new c.b7(f,e.u_scale_b),u_pixel_coord_upper:new c.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bJ(f,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.b7(f,e.u_tile_units_to_pixels)}),terrain:(f,e)=>({u_texture:new c.bE(f,e.u_texture),u_ele_delta:new c.b7(f,e.u_ele_delta),u_fog_matrix:new c.bG(f,e.u_fog_matrix),u_fog_color:new c.bF(f,e.u_fog_color),u_fog_ground_blend:new c.b7(f,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.b7(f,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bF(f,e.u_horizon_color),u_horizon_fog_blend:new c.b7(f,e.u_horizon_fog_blend),u_is_globe_mode:new c.b7(f,e.u_is_globe_mode)}),terrainDepth:(f,e)=>({u_ele_delta:new c.b7(f,e.u_ele_delta)}),terrainCoords:(f,e)=>({u_texture:new c.bE(f,e.u_texture),u_terrain_coords_id:new c.b7(f,e.u_terrain_coords_id),u_ele_delta:new c.b7(f,e.u_ele_delta)}),projectionErrorMeasurement:(f,e)=>({u_input:new c.b7(f,e.u_input),u_output_expected:new c.b7(f,e.u_output_expected)}),atmosphere:(f,e)=>({u_sun_pos:new c.bI(f,e.u_sun_pos),u_atmosphere_blend:new c.b7(f,e.u_atmosphere_blend),u_globe_position:new c.bI(f,e.u_globe_position),u_globe_radius:new c.b7(f,e.u_globe_radius),u_inv_proj_matrix:new c.bG(f,e.u_inv_proj_matrix)}),sky:(f,e)=>({u_sky_color:new c.bF(f,e.u_sky_color),u_horizon_color:new c.bF(f,e.u_horizon_color),u_horizon:new c.bJ(f,e.u_horizon),u_horizon_normal:new c.bJ(f,e.u_horizon_normal),u_sky_horizon_blend:new c.b7(f,e.u_sky_horizon_blend),u_sky_blend:new c.b7(f,e.u_sky_blend)})};class Qu{constructor(e,r,l){this.context=e;const u=e.gl;this.buffer=u.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const r=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ic={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class xn{constructor(e,r,l,u){this.length=r.length,this.attributes=l,this.itemSize=r.bytesPerElement,this.dynamicDraw=u,this.context=e;const p=e.gl;this.buffer=p.createBuffer(),e.bindVertexBuffer.set(this.buffer),p.bufferData(p.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,r){for(let l=0;l<this.attributes.length;l++){const u=r.attributes[this.attributes[l].name];u!==void 0&&e.enableVertexAttribArray(u)}}setVertexAttribPointers(e,r,l){for(let u=0;u<this.attributes.length;u++){const p=this.attributes[u],y=r.attributes[p.name];y!==void 0&&e.vertexAttribPointer(y,p.components,e[ic[p.type]],!1,this.itemSize,p.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Qt{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ef extends Qt{getDefault(){return c.b6.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class tf extends Qt{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class rf extends Qt{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class of extends Qt{getDefault(){return[!0,!0,!0,!0]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class eh extends Qt{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class nf extends Qt{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class th extends Qt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const r=this.current;(e.func!==r.func||e.ref!==r.ref||e.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Ra extends Qt{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class La extends Qt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=e,this.dirty=!1}}class Ba extends Qt{getDefault(){return[0,1]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class nc extends Qt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=e,this.dirty=!1}}class wn extends Qt{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class es extends Qt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.BLEND):r.disable(r.BLEND),this.current=e,this.dirty=!1}}class ci extends Qt{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class rh extends Qt{getDefault(){return c.b6.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class oh extends Qt{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class sc extends Qt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=e,this.dirty=!1}}class Cn extends Qt{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Fa extends Qt{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Oa extends Qt{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Vs extends Qt{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class $a extends Qt{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class ih extends Qt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class ts extends Qt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class rs extends Qt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class nh extends Qt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class ac extends Qt{getDefault(){return null}set(e){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Jt extends Qt{getDefault(){return null}set(e){var r;if(e===this.current&&!this.dirty)return;const l=this.gl;li(l)?l.bindVertexArray(e):(r=l.getExtension("OES_vertex_array_object"))===null||r===void 0||r.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class ja extends Qt{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class sf extends Qt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class sh extends Qt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Tn extends Qt{constructor(e,r){super(e),this.context=e,this.parent=r}getDefault(){return null}}class af extends Tn{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class lf extends Tn{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ah extends Tn{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const lh="Framebuffer is not complete";class lc{constructor(e,r,l,u,p){this.context=e,this.width=r,this.height=l;const y=e.gl,w=this.framebuffer=y.createFramebuffer();if(this.colorAttachment=new af(e,w),u)this.depthAttachment=p?new ah(e,w):new lf(e,w);else if(p)throw new Error("Stencil cannot be set without depth");if(y.checkFramebufferStatus(y.FRAMEBUFFER)!==y.FRAMEBUFFER_COMPLETE)throw new Error(lh)}destroy(){const e=this.context.gl,r=this.colorAttachment.get();if(r&&e.deleteTexture(r),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class Na{constructor(e){var r,l;if(this.gl=e,this.clearColor=new ef(this),this.clearDepth=new tf(this),this.clearStencil=new rf(this),this.colorMask=new of(this),this.depthMask=new eh(this),this.stencilMask=new nf(this),this.stencilFunc=new th(this),this.stencilOp=new Ra(this),this.stencilTest=new La(this),this.depthRange=new Ba(this),this.depthTest=new nc(this),this.depthFunc=new wn(this),this.blend=new es(this),this.blendFunc=new ci(this),this.blendColor=new rh(this),this.blendEquation=new oh(this),this.cullFace=new sc(this),this.cullFaceSide=new Cn(this),this.frontFace=new Fa(this),this.program=new Oa(this),this.activeTexture=new Vs(this),this.viewport=new $a(this),this.bindFramebuffer=new ih(this),this.bindRenderbuffer=new ts(this),this.bindTexture=new rs(this),this.bindVertexBuffer=new nh(this),this.bindElementBuffer=new ac(this),this.bindVertexArray=new Jt(this),this.pixelStoreUnpack=new ja(this),this.pixelStoreUnpackPremultiplyAlpha=new sf(this),this.pixelStoreUnpackFlipY=new sh(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),li(e)){this.HALF_FLOAT=e.HALF_FLOAT;const u=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=e.RGBA16F)!==null&&r!==void 0?r:u==null?void 0:u.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:u==null?void 0:u.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const u=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=u==null?void 0:u.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r){return new Qu(this,e,r)}createVertexBuffer(e,r,l){return new xn(this,e,r,l)}createRenderbuffer(e,r,l){const u=this.gl,p=u.createRenderbuffer();return this.bindRenderbuffer.set(p),u.renderbufferStorage(u.RENDERBUFFER,e,r,l),this.bindRenderbuffer.set(null),p}createFramebuffer(e,r,l,u){return new lc(this,e,r,l,u)}clear({color:e,depth:r,stencil:l}){const u=this.gl;let p=0;e&&(p|=u.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),r!==void 0&&(p|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),l!==void 0&&(p|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),u.clear(p)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bB(e.blendFunction,xr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return li(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var r;return li(this.gl)?this.gl.deleteVertexArray(e):(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Sn;function Va(f,e,r,l,u){const p=f.context,y=f.transform,w=p.gl,T=f.useProgram("collisionBox"),k=[];let E=0,D=0;for(let J=0;J<l.length;J++){const re=l[J],ne=e.getTile(re).getBucket(r);if(!ne)continue;const le=u?ne.textCollisionBox:ne.iconCollisionBox,ue=ne.collisionCircleArray;ue.length>0&&(k.push({circleArray:ue,circleOffset:D,coord:re}),E+=ue.length/4,D=E),le&&T.draw(p,w.LINES,Ft.disabled,Xt.disabled,f.colorModeForRenderPass(),Wt.disabled,Yl(f.transform),f.style.map.terrain&&f.style.map.terrain.getTerrainData(re),y.getProjectionData({overscaledTileID:re,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),r.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,null,f.transform.zoom,null,null,le.collisionVertexBuffer)}if(!u||!k.length)return;const R=f.useProgram("collisionCircle"),$=new c.bO;$.resize(4*E),$._trim();let N=0;for(const J of k)for(let re=0;re<J.circleArray.length/4;re++){const ne=4*re,le=J.circleArray[ne+0],ue=J.circleArray[ne+1],fe=J.circleArray[ne+2],he=J.circleArray[ne+3];$.emplace(N++,le,ue,fe,he,0),$.emplace(N++,le,ue,fe,he,1),$.emplace(N++,le,ue,fe,he,2),$.emplace(N++,le,ue,fe,he,3)}(!Sn||Sn.length<2*E)&&(Sn=function(J){const re=2*J,ne=new c.bQ;ne.resize(re),ne._trim();for(let le=0;le<re;le++){const ue=6*le;ne.uint16[ue+0]=4*le+0,ne.uint16[ue+1]=4*le+1,ne.uint16[ue+2]=4*le+2,ne.uint16[ue+3]=4*le+2,ne.uint16[ue+4]=4*le+3,ne.uint16[ue+5]=4*le+0}return ne}(E));const K=p.createIndexBuffer(Sn,!0),Y=p.createVertexBuffer($,c.bP.members,!0);for(const J of k){const re=Wu(f.transform);R.draw(p,w.TRIANGLES,Ft.disabled,Xt.disabled,f.colorModeForRenderPass(),Wt.disabled,re,f.style.map.terrain&&f.style.map.terrain.getTerrainData(J.coord),null,r.id,Y,K,c.aF.simpleSegment(0,2*J.circleOffset,J.circleArray.length,J.circleArray.length/2),null,f.transform.zoom,null,null,null)}Y.destroy(),K.destroy()}const cc=c.as(new Float32Array(16));function ch(f,e,r,l,u,p){const{horizontalAlign:y,verticalAlign:w}=c.aA(f);return new c.P((-(y-.5)*e/u+l[0])*p,(-(w-.5)*r/u+l[1])*p)}function Ua(f,e,r,l,u,p){const y=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let w=l.mult(p);r||(w=w.rotate(-u));const T=y.add(w);return Pe(T.x,T.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(r){const w=pt(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(f),T=Math.atan(w.y/w.x)+(w.x<0?Math.PI:0);return f.add(l.rotate(T))}return f.add(l)}function Za(f,e,r,l,u,p,y,w,T,k,E,D){const R=f.text.placedSymbolArray,$=f.text.dynamicLayoutVertexArray,N=f.icon.dynamicLayoutVertexArray,K={};$.clear();for(let Y=0;Y<R.length;Y++){const J=R.get(Y),re=J.hidden||!J.crossTileID||f.allowVerticalPlacement&&!J.placedOrientation?null:l[J.crossTileID];if(re){const ne=new c.P(J.anchorX,J.anchorY),le={getElevation:D,width:u.width,height:u.height,pitchedLabelPlaneMatrix:p,pitchWithMap:r,transform:u,tileAnchorPoint:ne,translation:k,unwrappedTileID:E},ue=r?Ot(ne.x,ne.y,le):pt(ne.x,ne.y,le),fe=ye(u.cameraToCenterDistance,ue.signedDistanceFromCamera);let he=c.ah(f.textSizeData,w,J)*fe/c.au;r&&(he*=f.tilePixelRatio/y);const{width:be,height:we,anchor:Ae,textOffset:Re,textBoxScale:Ee}=re,Ke=ch(Ae,be,we,Re,Ee,he),Xe=u.getPitchedTextCorrection(ne.x+k[0],ne.y+k[1],E),$e=Ua(ue.point,le,e,Ke,-u.bearingInRadians,Xe),mt=f.allowVerticalPlacement&&J.placedOrientation===c.ag.vertical?Math.PI/2:0;for(let xt=0;xt<J.numGlyphs;xt++)c.an($,$e,mt);T&&J.associatedIconIndex>=0&&(K[J.associatedIconIndex]={shiftedAnchor:$e,angle:mt})}else Vr(J.numGlyphs,$)}if(T){N.clear();const Y=f.icon.placedSymbolArray;for(let J=0;J<Y.length;J++){const re=Y.get(J);if(re.hidden)Vr(re.numGlyphs,N);else{const ne=K[J];if(ne)for(let le=0;le<re.numGlyphs;le++)c.an(N,ne.shiftedAnchor,ne.angle);else Vr(re.numGlyphs,N)}}f.icon.dynamicLayoutVertexBuffer.updateData(N)}f.text.dynamicLayoutVertexBuffer.updateData($)}function uc(f,e,r){return r.iconsInText&&e?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function uh(f,e,r,l,u,p,y,w,T,k,E,D,R){const $=f.context,N=$.gl,K=f.transform,Y=w==="map",J=T==="map",re=w!=="viewport"&&r.layout.get("symbol-placement")!=="point",ne=Y&&!J&&!re,le=!r.layout.get("symbol-sort-key").isConstant();let ue=!1;const fe=f.getDepthModeForSublayer(0,Ft.ReadOnly),he=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),be=[],we=K.getCircleRadiusCorrection();for(const Ae of l){const Re=e.getTile(Ae),Ee=Re.getBucket(r);if(!Ee)continue;const Ke=u?Ee.text:Ee.icon;if(!Ke||!Ke.segments.get().length||!Ke.hasVisibleVertices)continue;const Xe=Ke.programConfigurations.get(r.id),$e=u||Ee.sdfIcons,mt=u?Ee.textSizeData:Ee.iconSizeData,xt=J||K.pitch!==0,er=f.useProgram(uc($e,u,Ee),Xe),fr=c.af(mt,K.zoom),ar=f.style.map.terrain&&f.style.map.terrain.getTerrainData(Ae);let Cr,yr,rr,lr,no=[0,0],so=null;if(u)yr=Re.glyphAtlasTexture,rr=N.LINEAR,Cr=Re.glyphAtlasTexture.size,Ee.iconsInText&&(no=Re.imageAtlasTexture.size,so=Re.imageAtlasTexture,lr=xt||f.options.rotating||f.options.zooming||mt.kind==="composite"||mt.kind==="camera"?N.LINEAR:N.NEAREST);else{const pr=r.layout.get("icon-size").constantOr(0)!==1||Ee.iconsNeedLinear;yr=Re.imageAtlasTexture,rr=$e||f.options.rotating||f.options.zooming||pr||xt?N.LINEAR:N.NEAREST,Cr=Re.imageAtlasTexture.size}const Xr=c.av(Re,1,f.transform.zoom),po=Ce(Y,f.transform,Xr),sn=c.K();c.ai(sn,po);const Ui=me(J,Y,f.transform,Xr),Di=c.aw(K,Re,p,y),di=K.getProjectionData({overscaledTileID:Ae,applyGlobeMatrix:!R,applyTerrainMatrix:!0}),An=he&&Ee.hasTextData(),Qs=r.layout.get("icon-text-fit")!=="none"&&An&&Ee.hasIconData();if(re){const pr=f.style.map.terrain?(Yr,Kr)=>f.style.map.terrain.getElevation(Ae,Yr,Kr):null,hr=r.layout.get("text-rotation-alignment")==="map";ve(Ee,f,u,po,sn,J,k,hr,Ae.toUnwrapped(),K.width,K.height,Di,pr)}const zn=u&&he||Qs,fi=re||zn?cc:J?po:f.transform.clipSpaceToPixelsMatrix,Ri=$e&&r.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let xi;xi=$e?Ee.iconsInText?za(mt.kind,fr,ne,J,re,zn,f,fi,Ui,Di,Cr,no,we):tc(mt.kind,fr,ne,J,re,zn,f,fi,Ui,Di,u,Cr,0,we):Aa(mt.kind,fr,ne,J,re,zn,f,fi,Ui,Di,u,Cr,we);const Li={program:er,buffers:Ke,uniformValues:xi,projectionData:di,atlasTexture:yr,atlasTextureIcon:so,atlasInterpolation:rr,atlasInterpolationIcon:lr,isSDF:$e,hasHalo:Ri};if(le&&Ee.canOverlap){ue=!0;const pr=Ke.segments.get();for(const hr of pr)be.push({segments:new c.aF([hr]),sortKey:hr.sortKey,state:Li,terrainData:ar})}else be.push({segments:Ke.segments,sortKey:0,state:Li,terrainData:ar})}ue&&be.sort((Ae,Re)=>Ae.sortKey-Re.sortKey);for(const Ae of be){const Re=Ae.state;if($.activeTexture.set(N.TEXTURE0),Re.atlasTexture.bind(Re.atlasInterpolation,N.CLAMP_TO_EDGE),Re.atlasTextureIcon&&($.activeTexture.set(N.TEXTURE1),Re.atlasTextureIcon&&Re.atlasTextureIcon.bind(Re.atlasInterpolationIcon,N.CLAMP_TO_EDGE)),Re.isSDF){const Ee=Re.uniformValues;Re.hasHalo&&(Ee.u_is_halo=1,Ga(Re.buffers,Ae.segments,r,f,Re.program,fe,E,D,Ee,Re.projectionData,Ae.terrainData)),Ee.u_is_halo=0}Ga(Re.buffers,Ae.segments,r,f,Re.program,fe,E,D,Re.uniformValues,Re.projectionData,Ae.terrainData)}}function Ga(f,e,r,l,u,p,y,w,T,k,E){const D=l.context;u.draw(D,D.gl.TRIANGLES,p,y,w,Wt.backCCW,T,E,k,r.id,f.layoutVertexBuffer,f.indexBuffer,e,r.paint,l.transform.zoom,f.programConfigurations.get(r.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function cf(f,e,r,l,u){const p=f.context,y=p.gl,w=Xt.disabled,T=new xr([y.ONE,y.ONE],c.b6.transparent,[!0,!0,!0,!0]),k=e.getBucket(r);if(!k)return;const E=l.key;let D=r.heatmapFbos.get(E);D||(D=Us(p,e.tileSize,e.tileSize),r.heatmapFbos.set(E,D)),p.bindFramebuffer.set(D.framebuffer),p.viewport.set([0,0,e.tileSize,e.tileSize]),p.clear({color:c.b6.transparent});const R=k.programConfigurations.get(r.id),$=f.useProgram("heatmap",R,!u),N=f.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),K=f.style.map.terrain.getTerrainData(l);$.draw(p,y.TRIANGLES,Ft.disabled,w,T,Wt.disabled,Jl(e,f.transform.zoom,r.paint.get("heatmap-intensity"),1),K,N,r.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,r.paint,f.transform.zoom,R)}function hh(f,e,r,l,u){const p=f.context,y=p.gl,w=f.transform;p.setColorMode(f.colorModeForRenderPass());const T=qa(p,e),k=r.key,E=e.heatmapFbos.get(k);if(!E)return;p.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,E.colorAttachment.get()),p.activeTexture.set(y.TEXTURE1),T.bind(y.LINEAR,y.CLAMP_TO_EDGE);const D=w.getProjectionData({overscaledTileID:r,applyTerrainMatrix:u,applyGlobeMatrix:!l});f.useProgram("heatmapTexture").draw(p,y.TRIANGLES,Ft.disabled,Xt.disabled,f.colorModeForRenderPass(),Wt.disabled,Ql(f,e,0,1),null,D,e.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,e.paint,w.zoom),E.destroy(),e.heatmapFbos.delete(k)}function Us(f,e,r){var l,u;const p=f.gl,y=p.createTexture();p.bindTexture(p.TEXTURE_2D,y),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR);const w=(l=f.HALF_FLOAT)!==null&&l!==void 0?l:p.UNSIGNED_BYTE,T=(u=f.RGBA16F)!==null&&u!==void 0?u:p.RGBA;p.texImage2D(p.TEXTURE_2D,0,T,e,r,0,p.RGBA,w,null);const k=f.createFramebuffer(e,r,!1,!1);return k.colorAttachment.set(y),k}function qa(f,e){return e.colorRampTexture||(e.colorRampTexture=new nt(f,e.colorRamp,f.gl.RGBA)),e.colorRampTexture}function hc(f,e,r,l,u){if(!r||!l||!l.imageAtlas)return;const p=l.imageAtlas.patternPositions;let y=p[r.to.toString()],w=p[r.from.toString()];if(!y&&w&&(y=w),!w&&y&&(w=y),!y||!w){const T=u.getPaintProperty(e);y=p[T],w=p[T]}y&&w&&f.setConstantPatternPositions(y,w)}function dc(f,e,r,l,u,p,y,w){const T=f.context.gl,k="fill-pattern",E=r.paint.get(k),D=E&&E.constantOr(1),R=r.getCrossfadeParameters();let $,N,K,Y,J;const re=f.transform,ne=r.paint.get("fill-translate"),le=r.paint.get("fill-translate-anchor");y?(N=D&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=T.LINES):(N=D?"fillPattern":"fill",$=T.TRIANGLES);const ue=E.constantOr(null);for(const fe of l){const he=e.getTile(fe);if(D&&!he.patternsLoaded())continue;const be=he.getBucket(r);if(!be)continue;const we=be.programConfigurations.get(r.id),Ae=f.useProgram(N,we),Re=f.style.map.terrain&&f.style.map.terrain.getTerrainData(fe);D&&(f.context.activeTexture.set(T.TEXTURE0),he.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),we.updatePaintBuffers(R)),hc(we,k,ue,he,r);const Ee=re.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!w,applyTerrainMatrix:!0}),Ke=c.aw(re,he,ne,le);if(y){Y=be.indexBuffer2,J=be.segments2;const $e=[T.drawingBufferWidth,T.drawingBufferHeight];K=N==="fillOutlinePattern"&&D?Kd(f,R,he,$e,Ke):Gu($e,Ke)}else Y=be.indexBuffer,J=be.segments,K=D?Zu(f,R,he,Ke):{u_fill_translate:Ke};let Xe;if(f.renderPass==="translucent"&&w){const[$e]=f.getStencilConfigForOverlapAndUpdateStencilID(l);Xe=$e[fe.overscaledZ]}else Xe=f.stencilModeForClipping(fe);Ae.draw(f.context,$,u,Xe,p,Wt.backCCW,K,Re,Ee,r.id,be.layoutVertexBuffer,Y,J,r.paint,f.transform.zoom,we)}}function os(f,e,r,l,u,p,y,w){const T=f.context,k=T.gl,E="fill-extrusion-pattern",D=r.paint.get(E),R=D.constantOr(1),$=r.getCrossfadeParameters(),N=r.paint.get("fill-extrusion-opacity"),K=D.constantOr(null),Y=f.transform;for(const J of l){const re=e.getTile(J),ne=re.getBucket(r);if(!ne)continue;const le=f.style.map.terrain&&f.style.map.terrain.getTerrainData(J),ue=ne.programConfigurations.get(r.id),fe=f.useProgram(R?"fillExtrusionPattern":"fillExtrusion",ue);R&&(f.context.activeTexture.set(k.TEXTURE0),re.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ue.updatePaintBuffers($));const he=Y.getProjectionData({overscaledTileID:J,applyGlobeMatrix:!w,applyTerrainMatrix:!0});hc(ue,E,K,re,r);const be=c.aw(Y,re,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),we=r.paint.get("fill-extrusion-vertical-gradient"),Ae=R?Qn(f,we,N,be,J,$,re):Uu(f,we,N,be);fe.draw(T,T.gl.TRIANGLES,u,p,y,Wt.backCCW,Ae,le,he,r.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,r.paint,f.transform.zoom,ue,f.style.map.terrain&&ne.centroidVertexBuffer)}}function Zs(f,e,r,l,u,p,y,w,T){var k;const E=f.style.projection,D=f.context,R=f.transform,$=D.gl,N=f.useProgram("hillshade"),K=!f.options.moving;for(const Y of l){const J=e.getTile(Y),re=J.fbo;if(!re)continue;const ne=E.getMeshFromTileID(D,Y.canonical,w,!0,"raster"),le=(k=f.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(Y);D.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,re.colorAttachment.get());const ue=R.getProjectionData({overscaledTileID:Y,aligned:K,applyGlobeMatrix:!T,applyTerrainMatrix:!0});N.draw(D,$.TRIANGLES,p,u[Y.overscaledZ],y,Wt.backCCW,vn(f,J,r),le,ue,r.id,ne.vertexBuffer,ne.indexBuffer,ne.segments)}}const fc=[new c.P(0,0),new c.P(c.Z,0),new c.P(c.Z,c.Z),new c.P(0,c.Z)];function Gs(f,e,r,l,u,p,y,w,T=!1,k=!1){const E=l[l.length-1].overscaledZ,D=f.context,R=D.gl,$=f.useProgram("raster"),N=f.transform,K=f.style.projection,Y=f.colorModeForRenderPass(),J=!f.options.moving;for(const re of l){const ne=f.getDepthModeForSublayer(re.overscaledZ-E,r.paint.get("raster-opacity")===1?Ft.ReadWrite:Ft.ReadOnly,R.LESS),le=e.getTile(re);le.registerFadeDuration(r.paint.get("raster-fade-duration"));const ue=e.findLoadedParent(re,0),fe=e.findLoadedSibling(re),he=Fr(le,ue||fe||null,e,r,f.transform,f.style.map.terrain);let be,we;const Ae=r.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;D.activeTexture.set(R.TEXTURE0),le.texture.bind(Ae,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),D.activeTexture.set(R.TEXTURE1),ue?(ue.texture.bind(Ae,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),be=Math.pow(2,ue.tileID.overscaledZ-le.tileID.overscaledZ),we=[le.tileID.canonical.x*be%1,le.tileID.canonical.y*be%1]):le.texture.bind(Ae,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),le.texture.useMipmap&&D.extTextureFilterAnisotropic&&f.transform.pitch>20&&R.texParameterf(R.TEXTURE_2D,D.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,D.extTextureFilterAnisotropicMax);const Re=f.style.map.terrain&&f.style.map.terrain.getTerrainData(re),Ee=N.getProjectionData({overscaledTileID:re,aligned:J,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),Ke=Ku(we||[0,0],be||1,he,r,w),Xe=K.getMeshFromTileID(D,re.canonical,p,y,"raster");$.draw(D,R.TRIANGLES,ne,u?u[re.overscaledZ]:Xt.disabled,Y,T?Wt.frontCCW:Wt.backCCW,Ke,Re,Ee,r.id,Xe.vertexBuffer,Xe.indexBuffer,Xe.segments)}}function Fr(f,e,r,l,u,p){const y=l.paint.get("raster-fade-duration");if(!p&&y>0){const w=Q.now(),T=(w-f.timeAdded)/y,k=e?(w-e.timeAdded)/y:-1,E=r.getSource(),D=oi(u,{tileSize:E.tileSize,roundZoom:E.roundZoom}),R=!e||Math.abs(e.tileID.overscaledZ-D)>Math.abs(f.tileID.overscaledZ-D),$=R&&f.refreshedUponExpiration?1:c.ad(R?T:1-k,0,1);return f.refreshedUponExpiration&&T>=1&&(f.refreshedUponExpiration=!1),e?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}const kn=new c.b6(1,0,0,1),ui=new c.b6(0,1,0,1),pc=new c.b6(0,0,1,1),mc=new c.b6(1,0,1,1),dh=new c.b6(0,1,1,1);function Pn(f,e,r,l){ns(f,0,e+r/2,f.transform.width,r,l)}function is(f,e,r,l){ns(f,e-r/2,0,r,f.transform.height,l)}function ns(f,e,r,l,u,p){const y=f.context,w=y.gl;w.enable(w.SCISSOR_TEST),w.scissor(e*f.pixelRatio,r*f.pixelRatio,l*f.pixelRatio,u*f.pixelRatio),y.clear({color:p}),w.disable(w.SCISSOR_TEST)}function fh(f,e,r){const l=f.context,u=l.gl,p=f.useProgram("debug"),y=Ft.disabled,w=Xt.disabled,T=f.colorModeForRenderPass(),k="$debug",E=f.style.map.terrain&&f.style.map.terrain.getTerrainData(r);l.activeTexture.set(u.TEXTURE0);const D=e.getTileByID(r.key).latestRawTileData,R=Math.floor((D&&D.byteLength||0)/1024),$=e.getTile(r).tileSize,N=512/Math.min($,512)*(r.overscaledZ/f.transform.zoom)*.5;let K=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(K+=` => ${r.overscaledZ}`),function(J,re){J.initDebugOverlayCanvas();const ne=J.debugOverlayCanvas,le=J.context.gl,ue=J.debugOverlayCanvas.getContext("2d");ue.clearRect(0,0,ne.width,ne.height),ue.shadowColor="white",ue.shadowBlur=2,ue.lineWidth=1.5,ue.strokeStyle="white",ue.textBaseline="top",ue.font="bold 36px Open Sans, sans-serif",ue.fillText(re,5,5),ue.strokeText(re,5,5),J.debugOverlayTexture.update(ne),J.debugOverlayTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE)}(f,`${K} ${R}kB`);const Y=f.transform.getProjectionData({overscaledTileID:r,applyGlobeMatrix:!0,applyTerrainMatrix:!0});p.draw(l,u.TRIANGLES,y,w,xr.alphaBlended,Wt.disabled,Kl(c.b6.transparent,N),null,Y,k,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),p.draw(l,u.LINE_STRIP,y,w,T,Wt.disabled,Kl(c.b6.red),E,Y,k,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function gc(f,e,r,l){const{isRenderingGlobe:u}=l,p=f.context,y=p.gl,w=f.transform,T=f.colorModeForRenderPass(),k=f.getDepthModeFor3D(),E=f.useProgram("terrain");p.bindFramebuffer.set(null),p.viewport.set([0,0,f.width,f.height]);for(const D of r){const R=e.getTerrainMesh(D.tileID),$=f.renderToTexture.getTexture(D),N=e.getTerrainData(D.tileID);p.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,$.texture);const K=e.getMeshFrameDelta(w.zoom),Y=w.calculateFogMatrix(D.tileID.toUnwrapped()),J=Xl(K,Y,f.style.sky,w.pitch,u),re=w.getProjectionData({overscaledTileID:D.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});E.draw(p,y.TRIANGLES,k,Xt.disabled,T,Wt.backCCW,J,N,re,"terrain",R.vertexBuffer,R.indexBuffer,R.segments)}}function _c(f,e){if(!e.mesh){const r=new c.aE;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(1,1),r.emplaceBack(-1,1);const l=new c.aG;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new Go(f.createVertexBuffer(r,ii.members),f.createIndexBuffer(l),c.aF.simpleSegment(0,0,r.length,l.length))}return e.mesh}class ph{constructor(e,r){this.context=new Na(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.as(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=A.maxUnderzooming+A.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Nl}resize(e,r,l){if(this.width=Math.floor(e*l),this.height=Math.floor(r*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const u of this.style._order)this.style._layers[u].resize()}setup(){const e=this.context,r=new c.aE;r.emplaceBack(0,0),r.emplaceBack(c.Z,0),r.emplaceBack(0,c.Z),r.emplaceBack(c.Z,c.Z),this.tileExtentBuffer=e.createVertexBuffer(r,ii.members),this.tileExtentSegments=c.aF.simpleSegment(0,0,4,2);const l=new c.aE;l.emplaceBack(0,0),l.emplaceBack(c.Z,0),l.emplaceBack(0,c.Z),l.emplaceBack(c.Z,c.Z),this.debugBuffer=e.createVertexBuffer(l,ii.members),this.debugSegments=c.aF.simpleSegment(0,0,4,5);const u=new c.bV;u.emplaceBack(0,0,0,0),u.emplaceBack(c.Z,0,c.Z,0),u.emplaceBack(0,c.Z,0,c.Z),u.emplaceBack(c.Z,c.Z,c.Z,c.Z),this.rasterBoundsBuffer=e.createVertexBuffer(u,Ii.members),this.rasterBoundsSegments=c.aF.simpleSegment(0,0,4,2);const p=new c.aE;p.emplaceBack(0,0),p.emplaceBack(c.Z,0),p.emplaceBack(0,c.Z),p.emplaceBack(c.Z,c.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(p,ii.members),this.rasterBoundsSegmentsPosOnly=c.aF.simpleSegment(0,0,4,5);const y=new c.aE;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(y,ii.members),this.viewportSegments=c.aF.simpleSegment(0,0,4,2);const w=new c.bW;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(w);const T=new c.aG;T.emplaceBack(1,0,2),T.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(T);const k=this.context.gl;this.stencilClearMode=new Xt({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.tileExtentMesh=new Go(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=c.K();c.bN(l,0,this.width,this.height,0,0,1),c.M(l,l,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const u={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,r.TRIANGLES,Ft.disabled,this.stencilClearMode,xr.disabled,Wt.disabled,null,null,u,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,r,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!r||!r.length)return;this.currentStencilSource=e.source,this.nextStencilID+r.length>256&&this.clearStencil();const u=this.context;u.setColorMode(xr.disabled),u.setDepthMode(Ft.disabled);const p={};for(const y of r)p[y.key]=this.nextStencilID++;this._renderTileMasks(p,r,l,!0),this._renderTileMasks(p,r,l,!1),this._tileClippingMaskIDs=p}_renderTileMasks(e,r,l,u){const p=this.context,y=p.gl,w=this.style.projection,T=this.transform,k=this.useProgram("clippingMask");for(const E of r){const D=e[E.key],R=this.style.map.terrain&&this.style.map.terrain.getTerrainData(E),$=w.getMeshFromTileID(this.context,E.canonical,u,!0,"stencil"),N=T.getProjectionData({overscaledTileID:E,applyGlobeMatrix:!0,applyTerrainMatrix:!0});k.draw(p,y.TRIANGLES,Ft.disabled,new Xt({func:y.ALWAYS,mask:0},D,255,y.KEEP,y.KEEP,y.REPLACE),xr.disabled,l?Wt.disabled:Wt.backCCW,null,R,N,"$clipping",$.vertexBuffer,$.indexBuffer,$.segments)}}_renderTilesDepthBuffer(){const e=this.context,r=e.gl,l=this.style.projection,u=this.transform,p=this.useProgram("depth"),y=this.getDepthModeFor3D(),w=ge(u,{tileSize:u.tileSize});for(const T of w){const k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(T),E=l.getMeshFromTileID(this.context,T.canonical,!0,!0,"raster"),D=u.getProjectionData({overscaledTileID:T,applyGlobeMatrix:!0,applyTerrainMatrix:!0});p.draw(e,r.TRIANGLES,y,Xt.disabled,xr.disabled,Wt.backCCW,null,k,D,"$clipping",E.vertexBuffer,E.indexBuffer,E.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,r=this.context.gl;return new Xt({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){const r=this.context.gl;return new Xt({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const r=this.context.gl,l=e.sort((y,w)=>w.overscaledZ-y.overscaledZ),u=l[l.length-1].overscaledZ,p=l[0].overscaledZ-u+1;if(p>1){this.currentStencilSource=void 0,this.nextStencilID+p>256&&this.clearStencil();const y={};for(let w=0;w<p;w++)y[w+u]=new Xt({func:r.GEQUAL,mask:255},w+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=p,[y,l]}return[{[u]:Xt.disabled},l]}stencilConfigForOverlapTwoPass(e){const r=this.context.gl,l=e.sort((y,w)=>w.overscaledZ-y.overscaledZ),u=l[l.length-1].overscaledZ,p=l[0].overscaledZ-u+1;if(this.clearStencil(),p>1){const y={},w={};for(let T=0;T<p;T++)y[T+u]=new Xt({func:r.GREATER,mask:255},p+1+T,255,r.KEEP,r.KEEP,r.REPLACE),w[T+u]=new Xt({func:r.GREATER,mask:255},1+T,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID=2*p+1,[y,w,l]}return this.nextStencilID=3,[{[u]:new Xt({func:r.GREATER,mask:255},2,255,r.KEEP,r.KEEP,r.REPLACE)},{[u]:new Xt({func:r.GREATER,mask:255},1,255,r.KEEP,r.KEEP,r.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new xr([e.CONSTANT_COLOR,e.ONE],new c.b6(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?xr.unblended:xr.alphaBlended}getDepthModeForSublayer(e,r,l){if(!this.opaquePassEnabledForLayer())return Ft.disabled;const u=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Ft(l||this.context.gl.LEQUAL,r,[u,u])}getDepthModeFor3D(){return new Ft(this.context.gl.LEQUAL,Ft.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){var l,u;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(Q.now()),this.imageManager.beginFrame();const p=this.style._order,y=this.style.sourceCaches,w={},T={},k={},E={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const R in y){const $=y[R];$.used&&$.prepare(this.context),w[R]=$.getVisibleCoordinates(!1),T[R]=w[R].slice().reverse(),k[R]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let R=0;R<p.length;R++)if(this.style._layers[p[R]].is3D()){this.opaquePassCutoff=R;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const R of p){const $=this.style._layers[R];if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const N=T[$.source];($.type==="custom"||N.length)&&this.renderLayer(this,y[$.source],$,N,E)}if((u=this.style.projection)===null||u===void 0||u.updateGPUdependent({context:this.context,useProgram:R=>this.useProgram(R)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?c.b6.black:c.b6.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(R,$){const N=R.context,K=N.gl,Y=((fe,he,be)=>{const we=Math.cos(he.rollInRadians),Ae=Math.sin(he.rollInRadians),Re=oo(he),Ee=he.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:fe.properties.get("sky-color"),u_horizon_color:fe.properties.get("horizon-color"),u_horizon:[(he.width/2-Re*Ae)*be,(he.height/2+Re*we)*be],u_horizon_normal:[-Ae,we],u_sky_horizon_blend:fe.properties.get("sky-horizon-blend")*he.height/2*be,u_sky_blend:Ee}})($,R.style.map.transform,R.pixelRatio),J=new Ft(K.LEQUAL,Ft.ReadWrite,[0,1]),re=Xt.disabled,ne=R.colorModeForRenderPass(),le=R.useProgram("sky"),ue=_c(N,$);le.draw(N,K.TRIANGLES,J,re,ne,Wt.disabled,Y,null,void 0,"sky",ue.vertexBuffer,ue.indexBuffer,ue.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const R=this.style._layers[p[this.currentLayer]],$=y[R.source],N=w[R.source];this._renderTileClippingMasks(R,N,!1),this.renderLayer(this,$,R,N,E)}this.renderPass="translucent";let D=!1;for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const R=this.style._layers[p[this.currentLayer]],$=y[R.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(R,E))continue;this.opaquePassEnabledForLayer()||D||(D=!0,E.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const N=(R.type==="symbol"?k:T)[R.source];this._renderTileClippingMasks(R,w[R.source],!1),this.renderLayer(this,$,R,N,E)}if(E.isRenderingGlobe&&function(R,$,N){const K=R.context,Y=K.gl,J=R.useProgram("atmosphere"),re=new Ft(Y.LEQUAL,Ft.ReadOnly,[0,1]),ne=R.transform,le=function(Ee,Ke){const Xe=Ee.properties.get("position"),$e=[-Xe.x,-Xe.y,-Xe.z],mt=c.as(new Float64Array(16));return Ee.properties.get("anchor")==="map"&&(c.aZ(mt,mt,Ke.rollInRadians),c.a_(mt,mt,-Ke.pitchInRadians),c.aZ(mt,mt,Ke.bearingInRadians),c.a_(mt,mt,Ke.center.lat*Math.PI/180),c.bl(mt,mt,-Ke.center.lng*Math.PI/180)),c.bU($e,$e,mt),$e}(N,R.transform),ue=ne.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),fe=$.properties.get("atmosphere-blend")*ue.projectionTransition;if(fe===0)return;const he=Co(ne.worldSize,ne.center.lat),be=ne.inverseProjectionMatrix,we=new Float64Array(4);we[3]=1,c.ao(we,we,ne.modelViewProjectionMatrix),we[0]/=we[3],we[1]/=we[3],we[2]/=we[3],we[3]=1,c.ao(we,we,be),we[0]/=we[3],we[1]/=we[3],we[2]/=we[3],we[3]=1;const Ae=((Ee,Ke,Xe,$e,mt)=>({u_sun_pos:Ee,u_atmosphere_blend:Ke,u_globe_position:Xe,u_globe_radius:$e,u_inv_proj_matrix:mt}))(le,fe,[we[0],we[1],we[2]],he,be),Re=_c(K,$);J.draw(K,Y.TRIANGLES,re,Xt.disabled,xr.alphaBlended,Wt.disabled,Ae,null,null,"atmosphere",Re.vertexBuffer,Re.indexBuffer,Re.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const R=function($,N){let K=null;const Y=Object.values($._layers).flatMap(le=>le.source&&!le.isHidden(N)?[$.sourceCaches[le.source]]:[]),J=Y.filter(le=>le.getSource().type==="vector"),re=Y.filter(le=>le.getSource().type!=="vector"),ne=le=>{(!K||K.getSource().maxzoom<le.getSource().maxzoom)&&(K=le)};return J.forEach(le=>ne(le)),K||re.forEach(le=>ne(le)),K}(this.style,this.transform.zoom);R&&function($,N,K){for(let Y=0;Y<K.length;Y++)fh($,N,K[Y])}(this,R,R.getVisibleCoordinates())}this.options.showPadding&&function(R){const $=R.transform.padding;Pn(R,R.transform.height-($.top||0),3,kn),Pn(R,$.bottom||0,3,ui),is(R,$.left||0,3,pc),is(R,R.transform.width-($.right||0),3,mc);const N=R.transform.centerPoint;(function(K,Y,J,re){ns(K,Y-1,J-10,2,20,re),ns(K,Y-10,J-1,20,2,re)})(R,N.x,R.transform.height-N.y,dh)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let u=this.terrainFacilitator.dirty;u||(u=e?!c.bX(r,l):!c.bY(r,l)),u||(u=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),u&&(c.bZ(r,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(p,y){const w=p.context,T=w.gl,k=p.transform,E=xr.unblended,D=new Ft(T.LEQUAL,Ft.ReadWrite,[0,1]),R=y.sourceCache.getRenderableTiles(),$=p.useProgram("terrainDepth");w.bindFramebuffer.set(y.getFramebuffer("depth").framebuffer),w.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),w.clear({color:c.b6.transparent,depth:1});for(const N of R){const K=y.getTerrainMesh(N.tileID),Y=y.getTerrainData(N.tileID),J=k.getProjectionData({overscaledTileID:N.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),re={u_ele_delta:y.getMeshFrameDelta(k.zoom)};$.draw(w,T.TRIANGLES,D,Xt.disabled,E,Wt.backCCW,re,Y,J,"terrain",K.vertexBuffer,K.indexBuffer,K.segments)}w.bindFramebuffer.set(null),w.viewport.set([0,0,p.width,p.height])}(this,this.style.map.terrain),function(p,y){const w=p.context,T=w.gl,k=p.transform,E=xr.unblended,D=new Ft(T.LEQUAL,Ft.ReadWrite,[0,1]),R=y.getCoordsTexture(),$=y.sourceCache.getRenderableTiles(),N=p.useProgram("terrainCoords");w.bindFramebuffer.set(y.getFramebuffer("coords").framebuffer),w.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),w.clear({color:c.b6.transparent,depth:1}),y.coordsIndex=[];for(const K of $){const Y=y.getTerrainMesh(K.tileID),J=y.getTerrainData(K.tileID);w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,R.texture);const re={u_terrain_coords_id:(255-y.coordsIndex.length)/255,u_texture:0,u_ele_delta:y.getMeshFrameDelta(k.zoom)},ne=k.getProjectionData({overscaledTileID:K.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});N.draw(w,T.TRIANGLES,D,Xt.disabled,E,Wt.backCCW,re,J,ne,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments),y.coordsIndex.push(K.tileID.key)}w.bindFramebuffer.set(null),w.viewport.set([0,0,p.width,p.height])}(this,this.style.map.terrain))}renderLayer(e,r,l,u,p){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(u||[]).length)&&(this.id=l.id,c.b_(l)?function(y,w,T,k,E,D){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:R}=D,$=Xt.disabled,N=y.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(K,Y,J,re,ne,le,ue,fe,he){const be=Y.transform,we=Y.style.map.terrain,Ae=ne==="map",Re=le==="map";for(const Ee of K){const Ke=re.getTile(Ee),Xe=Ke.getBucket(J);if(!Xe||!Xe.text||!Xe.text.segments.get().length)continue;const $e=c.af(Xe.textSizeData,be.zoom),mt=c.av(Ke,1,Y.transform.zoom),xt=Ce(Ae,Y.transform,mt),er=J.layout.get("icon-text-fit")!=="none"&&Xe.hasIconData();if($e){const fr=Math.pow(2,be.zoom-Ke.tileID.overscaledZ),ar=we?(Cr,yr)=>we.getElevation(Ee,Cr,yr):null;Za(Xe,Ae,Re,he,be,xt,fr,$e,er,c.aw(be,Ke,ue,fe),Ee.toUnwrapped(),ar)}}}(k,y,T,w,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),E),T.paint.get("icon-opacity").constantOr(1)!==0&&uh(y,w,T,k,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),$,N,R),T.paint.get("text-opacity").constantOr(1)!==0&&uh(y,w,T,k,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),$,N,R),w.map.showCollisionBoxes&&(Va(y,w,T,k,!0),Va(y,w,T,k,!1))}(e,r,l,u,this.style.placement.variableOffsets,p):c.b$(l)?function(y,w,T,k,E){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:D}=E,R=T.paint.get("circle-opacity"),$=T.paint.get("circle-stroke-width"),N=T.paint.get("circle-stroke-opacity"),K=!T.layout.get("circle-sort-key").isConstant();if(R.constantOr(1)===0&&($.constantOr(1)===0||N.constantOr(1)===0))return;const Y=y.context,J=Y.gl,re=y.transform,ne=y.getDepthModeForSublayer(0,Ft.ReadOnly),le=Xt.disabled,ue=y.colorModeForRenderPass(),fe=[],he=re.getCircleRadiusCorrection();for(let be=0;be<k.length;be++){const we=k[be],Ae=w.getTile(we),Re=Ae.getBucket(T);if(!Re)continue;const Ee=T.paint.get("circle-translate"),Ke=T.paint.get("circle-translate-anchor"),Xe=c.aw(re,Ae,Ee,Ke),$e=Re.programConfigurations.get(T.id),mt=y.useProgram("circle",$e),xt=Re.layoutVertexBuffer,er=Re.indexBuffer,fr=y.style.map.terrain&&y.style.map.terrain.getTerrainData(we),ar={programConfiguration:$e,program:mt,layoutVertexBuffer:xt,indexBuffer:er,uniformValues:qu(y,Ae,T,Xe,he),terrainData:fr,projectionData:re.getProjectionData({overscaledTileID:we,applyGlobeMatrix:!D,applyTerrainMatrix:!0})};if(K){const Cr=Re.segments.get();for(const yr of Cr)fe.push({segments:new c.aF([yr]),sortKey:yr.sortKey,state:ar})}else fe.push({segments:Re.segments,sortKey:0,state:ar})}K&&fe.sort((be,we)=>be.sortKey-we.sortKey);for(const be of fe){const{programConfiguration:we,program:Ae,layoutVertexBuffer:Re,indexBuffer:Ee,uniformValues:Ke,terrainData:Xe,projectionData:$e}=be.state;Ae.draw(Y,J.TRIANGLES,ne,le,ue,Wt.backCCW,Ke,Xe,$e,T.id,Re,Ee,be.segments,T.paint,y.transform.zoom,we)}}(e,r,l,u,p):c.c0(l)?function(y,w,T,k,E){if(T.paint.get("heatmap-opacity")===0)return;const D=y.context,{isRenderingToTexture:R,isRenderingGlobe:$}=E;if(y.style.map.terrain){for(const N of k){const K=w.getTile(N);w.hasRenderableParent(N)||(y.renderPass==="offscreen"?cf(y,K,T,N,$):y.renderPass==="translucent"&&hh(y,T,N,R,$))}D.viewport.set([0,0,y.width,y.height])}else y.renderPass==="offscreen"?function(N,K,Y,J){const re=N.context,ne=re.gl,le=N.transform,ue=Xt.disabled,fe=new xr([ne.ONE,ne.ONE],c.b6.transparent,[!0,!0,!0,!0]);(function(he,be,we){const Ae=he.gl;he.activeTexture.set(Ae.TEXTURE1),he.viewport.set([0,0,be.width/4,be.height/4]);let Re=we.heatmapFbos.get(c.bR);Re?(Ae.bindTexture(Ae.TEXTURE_2D,Re.colorAttachment.get()),he.bindFramebuffer.set(Re.framebuffer)):(Re=Us(he,be.width/4,be.height/4),we.heatmapFbos.set(c.bR,Re))})(re,N,Y),re.clear({color:c.b6.transparent});for(let he=0;he<J.length;he++){const be=J[he];if(K.hasRenderableParent(be))continue;const we=K.getTile(be),Ae=we.getBucket(Y);if(!Ae)continue;const Re=Ae.programConfigurations.get(Y.id),Ee=N.useProgram("heatmap",Re),Ke=le.getProjectionData({overscaledTileID:be,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Xe=le.getCircleRadiusCorrection();Ee.draw(re,ne.TRIANGLES,Ft.disabled,ue,fe,Wt.backCCW,Jl(we,le.zoom,Y.paint.get("heatmap-intensity"),Xe),null,Ke,Y.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,Y.paint,le.zoom,Re)}re.viewport.set([0,0,N.width,N.height])}(y,w,T,k):y.renderPass==="translucent"&&function(N,K){const Y=N.context,J=Y.gl;Y.setColorMode(N.colorModeForRenderPass());const re=K.heatmapFbos.get(c.bR);re&&(Y.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,re.colorAttachment.get()),Y.activeTexture.set(J.TEXTURE1),qa(Y,K).bind(J.LINEAR,J.CLAMP_TO_EDGE),N.useProgram("heatmapTexture").draw(Y,J.TRIANGLES,Ft.disabled,Xt.disabled,N.colorModeForRenderPass(),Wt.disabled,Ql(N,K,0,1),null,null,K.id,N.viewportBuffer,N.quadTriangleIndexBuffer,N.viewportSegments,K.paint,N.transform.zoom))}(y,T)}(e,r,l,u,p):c.c1(l)?function(y,w,T,k,E){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:D}=E,R=T.paint.get("line-opacity"),$=T.paint.get("line-width");if(R.constantOr(1)===0||$.constantOr(1)===0)return;const N=y.getDepthModeForSublayer(0,Ft.ReadOnly),K=y.colorModeForRenderPass(),Y=T.paint.get("line-dasharray"),J=T.paint.get("line-pattern"),re=J.constantOr(1),ne=T.paint.get("line-gradient"),le=T.getCrossfadeParameters(),ue=re?"linePattern":Y?"lineSDF":ne?"lineGradient":"line",fe=y.context,he=fe.gl,be=y.transform;let we=!0;for(const Ae of k){const Re=w.getTile(Ae);if(re&&!Re.patternsLoaded())continue;const Ee=Re.getBucket(T);if(!Ee)continue;const Ke=Ee.programConfigurations.get(T.id),Xe=y.context.program.get(),$e=y.useProgram(ue,Ke),mt=we||$e.program!==Xe,xt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ae),er=J.constantOr(null);if(er&&Re.imageAtlas){const rr=Re.imageAtlas,lr=rr.patternPositions[er.to.toString()],no=rr.patternPositions[er.from.toString()];lr&&no&&Ke.setConstantPatternPositions(lr,no)}const fr=be.getProjectionData({overscaledTileID:Ae,applyGlobeMatrix:!D,applyTerrainMatrix:!0}),ar=be.getPixelScale(),Cr=re?Ea(y,Re,T,ar,le):Y?Qd(y,Re,T,ar,Y,le):ne?Jd(y,Re,T,ar,Ee.lineClipsArray.length):bn(y,Re,T,ar);if(re)fe.activeTexture.set(he.TEXTURE0),Re.imageAtlasTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE),Ke.updatePaintBuffers(le);else if(Y&&(mt||y.lineAtlas.dirty))fe.activeTexture.set(he.TEXTURE0),y.lineAtlas.bind(fe);else if(ne){const rr=Ee.gradients[T.id];let lr=rr.texture;if(T.gradientVersion!==rr.version){let no=256;if(T.stepInterpolant){const so=w.getSource().maxzoom,Xr=Ae.canonical.z===so?Math.ceil(1<<y.transform.maxZoom-Ae.canonical.z):1;no=c.ad(c.bS(Ee.maxLineLength/c.Z*1024*Xr),256,fe.maxTextureSize)}rr.gradient=c.bT({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:no,image:rr.gradient||void 0,clips:Ee.lineClipsArray}),rr.texture?rr.texture.update(rr.gradient):rr.texture=new nt(fe,rr.gradient,he.RGBA),rr.version=T.gradientVersion,lr=rr.texture}fe.activeTexture.set(he.TEXTURE0),lr.bind(T.stepInterpolant?he.NEAREST:he.LINEAR,he.CLAMP_TO_EDGE)}let yr;if(D){const[rr]=y.getStencilConfigForOverlapAndUpdateStencilID(k);yr=rr[Ae.overscaledZ]}else yr=y.stencilModeForClipping(Ae);$e.draw(fe,he.TRIANGLES,N,yr,K,Wt.disabled,Cr,xt,fr,T.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,T.paint,y.transform.zoom,Ke,Ee.layoutVertexBuffer2),we=!1}}(e,r,l,u,p):c.c2(l)?function(y,w,T,k,E){const D=T.paint.get("fill-color"),R=T.paint.get("fill-opacity");if(R.constantOr(1)===0)return;const{isRenderingToTexture:$}=E,N=y.colorModeForRenderPass(),K=T.paint.get("fill-pattern"),Y=y.opaquePassEnabledForLayer()&&!K.constantOr(1)&&D.constantOr(c.b6.transparent).a===1&&R.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===Y){const J=y.getDepthModeForSublayer(1,y.renderPass==="opaque"?Ft.ReadWrite:Ft.ReadOnly);dc(y,w,T,k,J,N,!1,$)}if(y.renderPass==="translucent"&&T.paint.get("fill-antialias")){const J=y.getDepthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,Ft.ReadOnly);dc(y,w,T,k,J,N,!0,$)}}(e,r,l,u,p):c.c3(l)?function(y,w,T,k,E){const D=T.paint.get("fill-extrusion-opacity");if(D===0)return;const{isRenderingToTexture:R}=E;if(y.renderPass==="translucent"){const $=new Ft(y.context.gl.LEQUAL,Ft.ReadWrite,y.depthRangeFor3D);if(D!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))os(y,w,T,k,$,Xt.disabled,xr.disabled,R),os(y,w,T,k,$,y.stencilModeFor3D(),y.colorModeForRenderPass(),R);else{const N=y.colorModeForRenderPass();os(y,w,T,k,$,Xt.disabled,N,R)}}}(e,r,l,u,p):c.c4(l)?function(y,w,T,k,E){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const{isRenderingToTexture:D}=E,R=y.context,$=y.style.projection.useSubdivision,N=y.getDepthModeForSublayer(0,Ft.ReadOnly),K=y.colorModeForRenderPass();if(y.renderPass==="offscreen")(function(Y,J,re,ne,le,ue,fe){const he=Y.context,be=he.gl;for(const we of re){const Ae=J.getTile(we),Re=Ae.dem;if(!Re||!Re.data||!Ae.needsHillshadePrepare)continue;const Ee=Re.dim,Ke=Re.stride,Xe=Re.getPixels();if(he.activeTexture.set(be.TEXTURE1),he.pixelStoreUnpackPremultiplyAlpha.set(!1),Ae.demTexture=Ae.demTexture||Y.getTileTexture(Ke),Ae.demTexture){const mt=Ae.demTexture;mt.update(Xe,{premultiply:!1}),mt.bind(be.NEAREST,be.CLAMP_TO_EDGE)}else Ae.demTexture=new nt(he,Xe,be.RGBA,{premultiply:!1}),Ae.demTexture.bind(be.NEAREST,be.CLAMP_TO_EDGE);he.activeTexture.set(be.TEXTURE0);let $e=Ae.fbo;if(!$e){const mt=new nt(he,{width:Ee,height:Ee,data:null},be.RGBA);mt.bind(be.LINEAR,be.CLAMP_TO_EDGE),$e=Ae.fbo=he.createFramebuffer(Ee,Ee,!0,!1),$e.colorAttachment.set(mt.texture)}he.bindFramebuffer.set($e.framebuffer),he.viewport.set([0,0,Ee,Ee]),Y.useProgram("hillshadePrepare").draw(he,be.TRIANGLES,le,ue,fe,Wt.disabled,Hu(Ae.tileID,Re),null,null,ne.id,Y.rasterBoundsBuffer,Y.quadTriangleIndexBuffer,Y.rasterBoundsSegments),Ae.needsHillshadePrepare=!1}})(y,w,k,T,N,Xt.disabled,K),R.viewport.set([0,0,y.width,y.height]);else if(y.renderPass==="translucent")if($){const[Y,J,re]=y.stencilConfigForOverlapTwoPass(k);Zs(y,w,T,re,Y,N,K,!1,D),Zs(y,w,T,re,J,N,K,!0,D)}else{const[Y,J]=y.getStencilConfigForOverlapAndUpdateStencilID(k);Zs(y,w,T,J,Y,N,K,!1,D)}}(e,r,l,u,p):c.c5(l)?function(y,w,T,k,E){if(y.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!k.length)return;const{isRenderingToTexture:D}=E,R=w.getSource(),$=y.style.projection.useSubdivision;if(R instanceof Qe)Gs(y,w,T,k,null,!1,!1,R.tileCoords,R.flippedWindingOrder,D);else if($){const[N,K,Y]=y.stencilConfigForOverlapTwoPass(k);Gs(y,w,T,Y,N,!1,!0,fc,!1,D),Gs(y,w,T,Y,K,!0,!0,fc,!1,D)}else{const[N,K]=y.getStencilConfigForOverlapAndUpdateStencilID(k);Gs(y,w,T,K,N,!1,!0,fc,!1,D)}}(e,r,l,u,p):c.c6(l)?function(y,w,T,k,E){const D=T.paint.get("background-color"),R=T.paint.get("background-opacity");if(R===0)return;const{isRenderingToTexture:$}=E,N=y.context,K=N.gl,Y=y.style.projection,J=y.transform,re=J.tileSize,ne=T.paint.get("background-pattern");if(y.isPatternMissing(ne))return;const le=!ne&&D.a===1&&R===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==le)return;const ue=Xt.disabled,fe=y.getDepthModeForSublayer(0,le==="opaque"?Ft.ReadWrite:Ft.ReadOnly),he=y.colorModeForRenderPass(),be=y.useProgram(ne?"backgroundPattern":"background"),we=k||ge(J,{tileSize:re,terrain:y.style.map.terrain});ne&&(N.activeTexture.set(K.TEXTURE0),y.imageManager.bind(y.context));const Ae=T.getCrossfadeParameters();for(const Re of we){const Ee=J.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),Ke=ne?rc(R,y,ne,{tileID:Re,tileSize:re},Ae):Ni(R,D),Xe=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Re),$e=Y.getMeshFromTileID(N,Re.canonical,!1,!0,"raster");be.draw(N,K.TRIANGLES,fe,ue,he,Wt.backCCW,Ke,Xe,Ee,T.id,$e.vertexBuffer,$e.indexBuffer,$e.segments)}}(e,0,l,u,p):c.c7(l)&&function(y,w,T,k){const{isRenderingGlobe:E}=k,D=y.context,R=T.implementation,$=y.style.projection,N=y.transform,K=N.getProjectionDataForCustomLayer(E),Y={farZ:N.farZ,nearZ:N.nearZ,fov:N.fov*Math.PI/180,modelViewProjectionMatrix:N.modelViewProjectionMatrix,projectionMatrix:N.projectionMatrix,shaderData:{variantName:$.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${$.shaderPreludeCode.vertexSource}`,define:$.shaderDefine},defaultProjectionData:K},J=R.renderingMode?R.renderingMode:"2d";if(y.renderPass==="offscreen"){const re=R.prerender;re&&(y.setCustomLayerDefaults(),D.setColorMode(y.colorModeForRenderPass()),re.call(R,D.gl,Y),D.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),D.setColorMode(y.colorModeForRenderPass()),D.setStencilMode(Xt.disabled);const re=J==="3d"?y.getDepthModeFor3D():y.getDepthModeForSublayer(0,Ft.ReadOnly);D.setDepthMode(re),R.render(D.gl,Y),D.setDirty(),y.setBaseState(),D.bindFramebuffer.set(null)}}(e,0,l,p))}saveTileTexture(e){const r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const r=this._tileTextures[e];return r&&r.length>0?r.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const r=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!r||!l}useProgram(e,r,l=!1){this.cache=this.cache||{};const u=!!this.style.map.terrain,p=this.style.projection,y=e+(r?r.cacheKey:"")+`/${l?va:p.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(u?"/terrain":"");return this.cache[y]||(this.cache[y]=new Yd(this.context,yi[e],r,oc[e],this._showOverdrawInspector,u,l?yi.projectionMercator:p.shaderPreludeCode,l?Kt:p.shaderDefine)),this.cache[y]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new nt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:r}=this.context.gl;return this.width!==e||this.height!==r}}function yc(f,e){let r,l=!1,u=null,p=null;const y=()=>{u=null,l&&(f.apply(p,r),u=setTimeout(y,e),l=!1)};return(...w)=>(l=!0,p=this,r=w,u||y(),u)}class tn{constructor(e){this._getCurrentHash=()=>{const r=window.location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(u=>u.split("=")).forEach(u=>{u[0]===this._hashName&&(l=u)}),(l&&l[1]||"").split("/")}return r.split("/")},this._onHashChange=()=>{const r=this._getCurrentHash();if(!this._isValidHash(r))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:l,pitch:+(r[4]||0)}),!0},this._updateHashUnthrottled=()=>{const r=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,r)},this._removeHash=()=>{const r=this._getCurrentHash();if(r.length===0)return;const l=r.join("/");let u=l;u.split("&").length>0&&(u=u.split("&")[0]),this._hashName&&(u=`${this._hashName}=${l}`);let p=window.location.hash.replace(u,"");p.startsWith("#&")?p=p.slice(0,1)+p.slice(2):p==="#"&&(p="");let y=window.location.href.replace(/(#.+)?$/,p);y=y.replace("&&","&"),window.history.replaceState(window.history.state,null,y)},this._updateHash=yc(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const r=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,u=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),p=Math.pow(10,u),y=Math.round(r.lng*p)/p,w=Math.round(r.lat*p)/p,T=this._map.getBearing(),k=this._map.getPitch();let E="";if(E+=e?`/${y}/${w}/${l}`:`${l}/${w}/${y}`,(T||k)&&(E+="/"+Math.round(10*T)/10),k&&(E+=`/${Math.round(k)}`),this._hashName){const D=this._hashName;let R=!1;const $=window.location.hash.slice(1).split("&").map(N=>{const K=N.split("=")[0];return K===D?(R=!0,`${K}=${E}`):N}).filter(N=>N);return R||$.push(`${D}=${E}`),`#${$.join("&")}`}return`#${E}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.Q(+e[2],+e[1])}catch{return!1}const r=+e[0],l=+(e[3]||0),u=+(e[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&l>=-180&&l<=180&&u>=this._map.getMinPitch()&&u<=this._map.getMaxPitch()}}const ss={linearity:.3,easing:c.c8(0,0,.3,1)},mh=c.e({deceleration:2500,maxSpeed:1400},ss),gh=c.e({deceleration:20,maxSpeed:1400},ss),_h=c.e({deceleration:1e3,maxSpeed:360},ss),yh=c.e({deceleration:1e3,maxSpeed:90},ss),vh=c.e({deceleration:1e3,maxSpeed:360},ss);class bh{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Q.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,r=Q.now();for(;e.length>0&&r-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:p}of this._inertiaBuffer)r.zoom+=p.zoomDelta||0,r.bearing+=p.bearingDelta||0,r.pitch+=p.pitchDelta||0,r.roll+=p.rollDelta||0,p.panDelta&&r.pan._add(p.panDelta),p.around&&(r.around=p.around),p.pinchAround&&(r.pinchAround=p.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(r.pan.mag()){const p=as(r.pan.mag(),l,c.e({},mh,e||{})),y=r.pan.mult(p.amount/r.pan.mag()),w=this._map.cameraHelper.handlePanInertia(y,this._map.transform);u.center=w.easingCenter,u.offset=w.easingOffset,rn(u,p)}if(r.zoom){const p=as(r.zoom,l,gh);u.zoom=this._map.transform.zoom+p.amount,rn(u,p)}if(r.bearing){const p=as(r.bearing,l,_h);u.bearing=this._map.transform.bearing+c.ad(p.amount,-179,179),rn(u,p)}if(r.pitch){const p=as(r.pitch,l,yh);u.pitch=this._map.transform.pitch+p.amount,rn(u,p)}if(r.roll){const p=as(r.roll,l,vh);u.roll=this._map.transform.roll+c.ad(p.amount,-179,179),rn(u,p)}if(u.zoom||u.bearing){const p=r.pinchAround===void 0?r.around:r.pinchAround;u.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),c.e(u,{noMoveStart:!0})}}function rn(f,e){(!f.duration||f.duration<e.duration)&&(f.duration=e.duration,f.easing=e.easing)}function as(f,e,r){const{maxSpeed:l,linearity:u,deceleration:p}=r,y=c.ad(f*u/(e/1e3),-l,l),w=Math.abs(y)/(p*u);return{easing:r.easing,duration:1e3*w,amount:y*(w/2)}}class Ar extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l,u={}){const p=G.mousePos(r.getCanvas(),l),y=r.unproject(p);super(e,c.e({point:p,lngLat:y,originalEvent:l},u)),this._defaultPrevented=!1,this.target=r}}class Lo extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l){const u=e==="touchend"?l.changedTouches:l.touches,p=G.touchPos(r.getCanvasContainer(),u),y=p.map(T=>r.unproject(T)),w=p.reduce((T,k,E,D)=>T.add(k.div(D.length)),new c.P(0,0));super(e,{points:p,point:w,lngLats:y,lngLat:r.unproject(w),originalEvent:l}),this._defaultPrevented=!1}}class vc extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class Ei{constructor(e,r){this._map=e,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new vc(e.type,this._map,e))}mousedown(e,r){return this._mousedownPos=r,this._firePreventable(new Ar(e.type,this._map,e))}mouseup(e){this._map.fire(new Ar(e.type,this._map,e))}click(e,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new Ar(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Ar(e.type,this._map,e))}mouseover(e){this._map.fire(new Ar(e.type,this._map,e))}mouseout(e){this._map.fire(new Ar(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Lo(e.type,this._map,e))}touchmove(e){this._map.fire(new Lo(e.type,this._map,e))}touchend(e){this._map.fire(new Lo(e.type,this._map,e))}touchcancel(e){this._map.fire(new Lo(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ls{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Ar(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ar("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Ar(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qs{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class xh{constructor(e,r){this._map=e,this._tr=new qs(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,r){this.isEnabled()&&e.shiftKey&&e.button===0&&(G.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(e,r){if(!this._active)return;const l=r;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const u=this._startPos;this._lastPos=l,this._box||(this._box=G.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const p=Math.min(u.x,l.x),y=Math.max(u.x,l.x),w=Math.min(u.y,l.y),T=Math.max(u.y,l.y);G.setTransform(this._box,`translate(${p}px,${w}px)`),this._box.style.width=y-p+"px",this._box.style.height=T-w+"px"}mouseupWindow(e,r){if(!this._active||e.button!==0)return;const l=this._startPos,u=r;if(this.reset(),G.suppressClick(),l.x!==u.x||l.y!==u.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:e})),{cameraAnimation:p=>p.fitScreenCoordinates(l,u,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(G.remove(this._box),this._box=null),G.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new c.l(e,{originalEvent:r}))}}function bc(f,e){if(f.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${e.length}`);const r={};for(let l=0;l<f.length;l++)r[f[l].identifier]=e[l];return r}class uf{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=function(u){const p=new c.P(0,0);for(const y of u)p._add(y);return p.div(u.length)}(r),this.touches=bc(l,r)))}touchmove(e,r,l){if(this.aborted||!this.centroid)return;const u=bc(l,r);for(const p in this.touches){const y=u[p];(!y||y.dist(this.touches[p])>30)&&(this.aborted=!0)}}touchend(e,r,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class Wa{constructor(e){this.singleTap=new uf(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,r,l){this.singleTap.touchstart(e,r,l)}touchmove(e,r,l){this.singleTap.touchmove(e,r,l)}touchend(e,r,l){const u=this.singleTap.touchend(e,r,l);if(u){const p=e.timeStamp-this.lastTime<500,y=!this.lastTap||this.lastTap.dist(u)<30;if(p&&y||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class Ws{constructor(e){this._tr=new qs(e),this._zoomIn=new Wa({numTouches:1,numTaps:2}),this._zoomOut=new Wa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,r,l){this._zoomIn.touchstart(e,r,l),this._zoomOut.touchstart(e,r,l)}touchmove(e,r,l){this._zoomIn.touchmove(e,r,l),this._zoomOut.touchmove(e,r,l)}touchend(e,r,l){const u=this._zoomIn.touchend(e,r,l),p=this._zoomOut.touchend(e,r,l),y=this._tr;return u?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:y.zoom+1,around:y.unproject(u)},{originalEvent:e})}):p?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:y.zoom-1,around:y.unproject(p)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wo{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const r=this._moveFunction(...e);if(r.bearingDelta||r.pitchDelta||r.rollDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(e,r){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(r)?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,r){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const u=Array.isArray(r)?r[0]:r;return!this._moved&&u.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=u,this._move(l,u))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&G.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const ct={0:1,2:2};class cs{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const r=G.mouseButton(e);this._eventButton=r}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(r,l){const u=ct[l];return r.buttons===void 0||(r.buttons&u)!==u}(e,this._eventButton)}isValidEndEvent(e){return G.mouseButton(e)===this._eventButton}}class xc{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class wh{constructor(e=new cs({checkCorrectEvent:()=>!0}),r=new xc){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=r}_executeRelevantHandler(e,r,l){return e instanceof MouseEvent?r(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.startMove(r),r=>this.oneFingerTouchMoveStateManager.startMove(r))}endMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.endMove(r),r=>this.oneFingerTouchMoveStateManager.endMove(r))}isValidStartEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidStartEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidStartEvent(r))}isValidMoveEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidMoveEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(r))}isValidEndEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidEndEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidEndEvent(r))}}const on=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=e=>{e.preventDefault()}};class Hs{constructor(e,r){this._clickTolerance=e.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,r,l){return this._calculateTransform(e,r,l)}touchmove(e,r,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,r,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,r,l){this._calculateTransform(e,r,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,l){l.length>0&&(this._active=!0);const u=bc(l,r),p=new c.P(0,0),y=new c.P(0,0);let w=0;for(const k in u){const E=u[k],D=this._touches[k];D&&(p._add(E),y._add(E.sub(D)),w++,u[k]=E)}if(this._touches=u,this._shouldBePrevented(w)||!y.mag())return;const T=y.div(w);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:p.div(w),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ha{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,r,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([r[0],r[1]]))}touchmove(e,r,l){if(!this._firstTwoTouches)return;e.preventDefault();const[u,p]=this._firstTwoTouches,y=Nt(l,r,u),w=Nt(l,r,p);if(!y||!w)return;const T=this._aroundCenter?null:y.add(w).div(2);return this._move([y,w],T,e)}touchend(e,r,l){if(!this._firstTwoTouches)return;const[u,p]=this._firstTwoTouches,y=Nt(l,r,u),w=Nt(l,r,p);y&&w||(this._active&&G.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Nt(f,e,r){for(let l=0;l<f.length;l++)if(f[l].identifier===r)return e[l]}function Xa(f,e){return Math.log(f/e)/Math.LN2}class Ch extends Ha{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,r){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Xa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Xa(this._distance,l),pinchAround:r}}}function Ya(f,e){return 180*f.angleWith(e)/Math.PI}class Th extends Ha{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,r,l){const u=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ya(this._vector,u),pinchAround:r}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const r=25/(Math.PI*this._minDiameter)*360,l=Ya(e,this._startVector);return Math.abs(l)<r}}function wc(f){return Math.abs(f.y)>Math.abs(f.x)}class Cc extends Ha{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,r,l){super.touchstart(e,r,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,wc(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,r,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const u=e[0].sub(this._lastPoints[0]),p=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(u,p,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(u.y+p.y)/2*-.5}):void 0}gestureBeginsVertically(e,r,l){if(this._valid!==void 0)return this._valid;const u=e.mag()>=2,p=r.mag()>=2;if(!u&&!p)return;if(!u||!p)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const y=e.y>0==r.y>0;return wc(e)&&wc(r)&&y}}const Tc={panStep:100,bearingStep:15,pitchStep:10};class Sc{constructor(e){this._tr=new qs(e);const r=Tc;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let r=0,l=0,u=0,p=0,y=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),p=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),p=1);break;case 38:e.shiftKey?u=1:(e.preventDefault(),y=-1);break;case 40:e.shiftKey?u=-1:(e.preventDefault(),y=1);break;default:return}return this._rotationDisabled&&(l=0,u=0),{cameraAnimation:w=>{const T=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:hf,zoom:r?Math.round(T.zoom)+r*(e.shiftKey?2:1):T.zoom,bearing:T.bearing+l*this._bearingStep,pitch:T.pitch+u*this._pitchStep,offset:[-p*this._panStep,-y*this._panStep],center:T.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function hf(f){return f*(2-f)}const kc=4.000244140625;class Sh{constructor(e,r){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new qs(e),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let r=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=Q.now(),u=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,r!==0&&r%kc==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(u*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=G.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(c.Q.convert(l.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const w=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=w),typeof this._targetZoom=="number"&&(this._targetZoom+=w)}if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>kc?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&T!==0&&(T=1/T);const k=typeof this._targetZoom!="number"?e.scale:c.aH(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,c.aa(k*T))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,u=this._easing;let p,y=!1;if(this._type==="wheel"&&l&&u){const w=Q.now()-this._lastWheelEventTime,T=Math.min((w+5)/200,1),k=u(T);p=c.B.number(l,r,k),T<1?this._frameId||(this._frameId=!0):y=!0}else p=r,y=!0;return this._active=!0,y&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=p,{noInertia:!0,needsRenderFrame:!y,zoomDelta:p-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=c.ca;if(this._prevEase){const l=this._prevEase,u=(Q.now()-l.start)/l.duration,p=l.easing(u+.01)-l.easing(u),y=.27/Math.sqrt(p*p+1e-4)*.01,w=Math.sqrt(.0729-y*y);r=c.c8(y,w,.25,1)}return this._prevEase={start:Q.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class kh{constructor(e,r){this._clickZoom=e,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class nn{constructor(e){this._tr=new qs(e),this.reset()}reset(){this._active=!1}dblclick(e,r){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wr{constructor(){this._tap=new Wa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,r,l){if(!this._swipePoint)if(this._tapTime){const u=r[0],p=e.timeStamp-this._tapTime<500,y=this._tapPoint.dist(u)<30;p&&y?l.length>0&&(this._swipePoint=u,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,r,l)}touchmove(e,r,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const u=r[0],p=u.y-this._swipePoint.y;return this._swipePoint=u,e.preventDefault(),this._active=!0,{zoomDelta:p/128}}}else this._tap.touchmove(e,r,l)}touchend(e,r,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const u=this._tap.touchend(e,r,l);u&&(this._tapTime=e.timeStamp,this._tapPoint=u)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xs{constructor(e,r,l){this._el=e,this._mousePan=r,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ka{constructor(e,r,l,u){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=r,this._mousePitch=l,this._mouseRoll=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Pc{constructor(e,r,l,u){this._el=e,this._touchZoom=r,this._touchRotate=l,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Mc{constructor(e,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=G.create("div","maplibregl-cooperative-gesture-screen",e);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),u=document.createElement("div");u.className="maplibregl-desktop-message",u.textContent=r,this._container.appendChild(u);const p=document.createElement("div");p.className="maplibregl-mobile-message",p.textContent=l,this._container.appendChild(p),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(G.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,r){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:e,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Ys=f=>f.zoom||f.drag||f.roll||f.pitch||f.rotate;class df extends c.l{}function hi(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta||f.rollDelta}class Ja{constructor(e,r){this.handleWindowEvent=u=>{this.handleEvent(u,`${u.type}Window`)},this.handleEvent=(u,p)=>{if(u.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const y=u.type==="renderFrame"?void 0:u,w={needsRenderFrame:!1},T={},k={},E=u.touches,D=E?this._getMapTouches(E):void 0,R=D?G.touchPos(this._map.getCanvas(),D):G.mousePos(this._map.getCanvas(),u);for(const{handlerName:K,handler:Y,allowed:J}of this._handlers){if(!Y.isEnabled())continue;let re;this._blockedByActive(k,J,K)?Y.reset():Y[p||u.type]&&(re=Y[p||u.type](u,R,D),this.mergeHandlerResult(w,T,re,K,y),re&&re.needsRenderFrame&&this._triggerRenderFrame()),(re||Y.isActive())&&(k[K]=Y)}const $={};for(const K in this._previousActiveHandlers)k[K]||($[K]=y);this._previousActiveHandlers=k,(Object.keys($).length||hi(w))&&(this._changes.push([w,T,$]),this._triggerRenderFrame()),(Object.keys(k).length||hi(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=w;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bh(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[u,p,y]of this._listeners)G.addEventListener(u,p,u===document?this.handleWindowEvent:this.handleEvent,y)}destroy(){for(const[e,r,l]of this._listeners)G.removeEventListener(e,r,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const r=this._map,l=r.getCanvasContainer();this._add("mapEvent",new Ei(r,e));const u=r.boxZoom=new xh(r,e);this._add("boxZoom",u),e.interactive&&e.boxZoom&&u.enable();const p=r.cooperativeGestures=new Mc(r,e.cooperativeGestures);this._add("cooperativeGestures",p),e.cooperativeGestures&&p.enable();const y=new Ws(r),w=new nn(r);r.doubleClickZoom=new kh(w,y),this._add("tapZoom",y),this._add("clickZoom",w),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();const T=new wr;this._add("tapDragZoom",T);const k=r.touchPitch=new Cc(r);this._add("touchPitch",k),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);const E=()=>r.project(r.getCenter()),D=function({enable:le,clickTolerance:ue,aroundCenter:fe=!0,minPixelCenterThreshold:he=100,rotateDegreesPerPixelMoved:be=.8},we){const Ae=new cs({checkCorrectEvent:Re=>G.mouseButton(Re)===0&&Re.ctrlKey||G.mouseButton(Re)===2&&!Re.ctrlKey});return new Wo({clickTolerance:ue,move:(Re,Ee)=>{const Ke=we();if(fe&&Math.abs(Ke.y-Re.y)>he)return{bearingDelta:c.c9(new c.P(Re.x,Ee.y),Ee,Ke)};let Xe=(Ee.x-Re.x)*be;return fe&&Ee.y<Ke.y&&(Xe=-Xe),{bearingDelta:Xe}},moveStateManager:Ae,enable:le,assignEvents:on})}(e,E),R=function({enable:le,clickTolerance:ue,pitchDegreesPerPixelMoved:fe=-.5}){const he=new cs({checkCorrectEvent:be=>G.mouseButton(be)===0&&be.ctrlKey||G.mouseButton(be)===2});return new Wo({clickTolerance:ue,move:(be,we)=>({pitchDelta:(we.y-be.y)*fe}),moveStateManager:he,enable:le,assignEvents:on})}(e),$=function({enable:le,clickTolerance:ue,rollDegreesPerPixelMoved:fe=.3},he){const be=new cs({checkCorrectEvent:we=>G.mouseButton(we)===2&&we.ctrlKey});return new Wo({clickTolerance:ue,move:(we,Ae)=>{const Re=he();let Ee=(Ae.x-we.x)*fe;return Ae.y<Re.y&&(Ee=-Ee),{rollDelta:Ee}},moveStateManager:be,enable:le,assignEvents:on})}(e,E);r.dragRotate=new Ka(e,D,R,$),this._add("mouseRotate",D,["mousePitch"]),this._add("mousePitch",R,["mouseRotate","mouseRoll"]),this._add("mouseRoll",$,["mousePitch"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();const N=function({enable:le,clickTolerance:ue}){const fe=new cs({checkCorrectEvent:he=>G.mouseButton(he)===0&&!he.ctrlKey});return new Wo({clickTolerance:ue,move:(he,be)=>({around:be,panDelta:be.sub(he)}),activateOnStart:!0,moveStateManager:fe,enable:le,assignEvents:on})}(e),K=new Hs(e,r);r.dragPan=new Xs(l,N,K),this._add("mousePan",N),this._add("touchPan",K,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);const Y=new Th,J=new Ch;r.touchZoomRotate=new Pc(l,J,Y,T),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",J,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate);const re=r.scrollZoom=new Sh(r,()=>this._triggerRenderFrame());this._add("scrollZoom",re,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);const ne=r.keyboard=new Sc(r);this._add("keyboard",ne),e.interactive&&e.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new ls(r))}_add(e,r,l){this._handlers.push({handlerName:e,handler:r,allowed:l}),this._handlersById[e]=r}stop(e){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ys(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,r,l){for(const u in e)if(u!==l&&(!r||r.indexOf(u)<0))return!0;return!1}_getMapTouches(e){const r=[];for(const l of e)this._el.contains(l.target)&&r.push(l);return r}mergeHandlerResult(e,r,l,u,p){if(!l)return;c.e(e,l);const y={handlerName:u,originalEvent:l.originalEvent||p};l.zoomDelta!==void 0&&(r.zoom=y),l.panDelta!==void 0&&(r.drag=y),l.rollDelta!==void 0&&(r.roll=y),l.pitchDelta!==void 0&&(r.pitch=y),l.bearingDelta!==void 0&&(r.rotate=y)}_applyChanges(){const e={},r={},l={};for(const[u,p,y]of this._changes)u.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(u.panDelta)),u.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+u.pitchDelta),u.rollDelta&&(e.rollDelta=(e.rollDelta||0)+u.rollDelta),u.around!==void 0&&(e.around=u.around),u.pinchAround!==void 0&&(e.pinchAround=u.pinchAround),u.noInertia&&(e.noInertia=u.noInertia),c.e(r,p),c.e(l,y);this._updateMapTransform(e,r,l),this._changes=[]}_updateMapTransform(e,r,l){const u=this._map,p=u._getTransformForUpdate(),y=u.terrain;if(!(hi(e)||y&&this._terrainMovement))return this._fireEvents(r,l,!0);u._stop(!0);let{panDelta:w,zoomDelta:T,bearingDelta:k,pitchDelta:E,rollDelta:D,around:R,pinchAround:$}=e;$!==void 0&&(R=$),R=R||u.transform.centerPoint,y&&!p.isPointOnMapSurface(R)&&(R=p.centerPoint);const N={panDelta:w,zoomDelta:T,rollDelta:D,pitchDelta:E,bearingDelta:k,around:R};this._map.cameraHelper.useGlobeControls&&!p.isPointOnMapSurface(R)&&(R=p.centerPoint);const K=R.distSqr(p.centerPoint)<.01?p.center:p.screenPointToLocation(w?R.sub(w):R);y?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(N,p),this._terrainMovement||!r.drag&&!r.zoom?r.drag&&this._terrainMovement?p.setCenter(p.screenPointToLocation(p.centerPoint.sub(w))):this._map.cameraHelper.handleMapControlsPan(N,p,K):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(N,p,K))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(N,p),this._map.cameraHelper.handleMapControlsPan(N,p,K)),u._applyUpdatedTransform(p),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,l,!0)}_fireEvents(e,r,l){const u=Ys(this._eventsInProgress),p=Ys(e),y={};for(const D in e){const{originalEvent:R}=e[D];this._eventsInProgress[D]||(y[`${D}start`]=R),this._eventsInProgress[D]=e[D]}!u&&p&&this._fireEvent("movestart",p.originalEvent);for(const D in y)this._fireEvent(D,y[D]);p&&this._fireEvent("move",p.originalEvent);for(const D in e){const{originalEvent:R}=e[D];this._fireEvent(D,R)}const w={};let T;for(const D in this._eventsInProgress){const{handlerName:R,originalEvent:$}=this._eventsInProgress[D];this._handlersById[R].isActive()||(delete this._eventsInProgress[D],T=r[R]||$,w[`${D}end`]=T)}for(const D in w)this._fireEvent(D,w[D]);const k=Ys(this._eventsInProgress),E=(u||p)&&!k;if(E&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const D=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&D.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(D)}if(l&&E){this._updatingCamera=!0;const D=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),R=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;!D||!D.essential&&Q.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:T})),R(this._map.getBearing())&&this._map.resetNorth()):(R(D.bearing||this._map.getBearing())&&(D.bearing=0),D.freezeElevation=!0,this._map.easeTo(D,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new c.l(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new df("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class vt extends c.E{constructor(e,r,l){super(),this._renderFrameCallback=()=>{const u=Math.min((Q.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=r,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,r){e.apply(this.transform),this.transform=e,this.cameraHelper=r}getCenter(){return new c.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,r){return this.jumpTo({center:e},r)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,r){return this.jumpTo({elevation:e},r),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,r,l){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},r),l)}panTo(e,r,l){return this.easeTo(c.e({center:e},r),l)}getZoom(){return this.transform.zoom}setZoom(e,r){return this.jumpTo({zoom:e},r),this}zoomTo(e,r,l){return this.easeTo(c.e({zoom:e},r),l)}zoomIn(e,r){return this.zoomTo(this.getZoom()+1,e,r),this}zoomOut(e,r){return this.zoomTo(this.getZoom()-1,e,r),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,r){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.l("movestart",r)).fire(new c.l("move",r)).fire(new c.l("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(e,r){return this.jumpTo({bearing:e},r),this}getPadding(){return this.transform.padding}setPadding(e,r){return this.jumpTo({padding:e},r),this}rotateTo(e,r,l){return this.easeTo(c.e({bearing:e},r),l)}resetNorth(e,r){return this.rotateTo(0,c.e({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),r),this}snapToNorth(e,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,r):this}getPitch(){return this.transform.pitch}setPitch(e,r){return this.jumpTo({pitch:e},r),this}getRoll(){return this.transform.roll}setRoll(e,r){return this.jumpTo({roll:e},r),this}cameraForBounds(e,r){e=ke.convert(e).adjustAntiMeridian();const l=r&&r.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,r)}_cameraForBoxAndBearing(e,r,l,u){const p={top:0,bottom:0,right:0,left:0};if(typeof(u=c.e({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=="number"){const k=u.padding;u.padding={top:k,bottom:k,right:k,left:k}}const y=c.e(p,u.padding);u.padding=y;const w=this.transform,T=new ke(e,r);return this.cameraHelper.cameraForBoxAndBearing(u,y,T,l,w)}fitBounds(e,r,l){return this._fitInternal(this.cameraForBounds(e,r),r,l)}fitScreenCoordinates(e,r,l,u,p){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(r)),l,u),u,p)}_fitInternal(e,r,l){return e?(delete(r=c.e(e,r)).padding,r.linear?this.easeTo(r,l):this.flyTo(r,l)):this}jumpTo(e,r){this.stop();const l=this._getTransformForUpdate();let u=!1,p=!1,y=!1;const w=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const T=l.zoom!==w;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(u=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(p=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(y=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new c.l("movestart",r)).fire(new c.l("move",r)),T&&this.fire(new c.l("zoomstart",r)).fire(new c.l("zoom",r)).fire(new c.l("zoomend",r)),u&&this.fire(new c.l("rotatestart",r)).fire(new c.l("rotate",r)).fire(new c.l("rotateend",r)),p&&this.fire(new c.l("pitchstart",r)).fire(new c.l("pitch",r)).fire(new c.l("pitchend",r)),y&&this.fire(new c.l("rollstart",r)).fire(new c.l("roll",r)).fire(new c.l("rollend",r)),this.fire(new c.l("moveend",r))}calculateCameraOptionsFromTo(e,r,l,u=0){const p=c.$.fromLngLat(e,r),y=c.$.fromLngLat(l,u),w=y.x-p.x,T=y.y-p.y,k=y.z-p.z,E=Math.hypot(w,T,k);if(E===0)throw new Error("Can't calculate camera options with same From and To");const D=Math.hypot(w,T),R=c.aa(this.transform.cameraToCenterDistance/E/this.transform.tileSize),$=180*Math.atan2(w,-T)/Math.PI;let N=180*Math.acos(D/E)/Math.PI;return N=k<0?90-N:90+N,{center:y.toLngLat(),elevation:u,zoom:R,pitch:N,bearing:$}}calculateCameraOptionsFromCameraLngLatAltRotation(e,r,l,u,p){const y=this.transform.calculateCenterFromCameraLngLatAlt(e,r,l,u);return{center:y.center,elevation:y.elevation,zoom:y.zoom,bearing:l,pitch:u,roll:p}}easeTo(e,r){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.ca},e)).animate===!1||!e.essential&&Q.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),u=this.getBearing(),p=l.pitch,y=l.roll,w="bearing"in e?this._normalizeBearing(e.bearing,u):u,T="pitch"in e?+e.pitch:p,k="roll"in e?this._normalizeBearing(e.roll,y):y,E="padding"in e?e.padding:l.padding,D=c.P.convert(e.offset);let R,$;e.around&&(R=c.Q.convert(e.around),$=l.locationToScreenPoint(R));const N={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},K=this.cameraHelper.handleEaseTo(l,{bearing:w,pitch:T,roll:k,padding:E,around:R,aroundPoint:$,offsetAsPoint:D,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||u!==w,this._pitching=this._pitching||T!==p,this._rolling=this._rolling||k!==y,this._padding=!l.isPaddingEqual(E),this._zooming=this._zooming||K.isZooming,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,N),this.terrain&&this._prepareElevation(K.elevationCenter),this._ease(Y=>{K.easeFunc(Y),this.terrain&&!e.freezeElevation&&this._updateElevation(Y),this._applyUpdatedTransform(l),this._fireMoveEvents(r)},Y=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,Y)},e),this}_prepareEase(e,r,l={}){this._moving=!0,r||l.moving||this.fire(new c.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new c.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new c.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new c.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new c.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(r-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=r}this.transform.setElevation(c.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const r=e.getCameraLngLat(),l=e.getCameraAltitude(),u=this.terrain?this.terrain.getElevationForLngLatZoom(r,e.zoom):0;if(l<u){const p=this.calculateCameraOptionsFromTo(r,u,e.center,e.elevation);return{pitch:p.pitch,zoom:p.zoom}}return{}}_applyUpdatedTransform(e){const r=[];if(r.push(u=>this._elevateCameraIfInsideTerrain(u)),this.transformCameraUpdate&&r.push(u=>this.transformCameraUpdate(u)),!r.length)return;const l=e.clone();for(const u of r){const p=l.clone(),{center:y,zoom:w,roll:T,pitch:k,bearing:E,elevation:D}=u(p);y&&p.setCenter(y),D!==void 0&&p.setElevation(D),w!==void 0&&p.setZoom(w),T!==void 0&&p.setRoll(T),k!==void 0&&p.setPitch(k),E!==void 0&&p.setBearing(E),l.apply(p)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new c.l("move",e)),this._zooming&&this.fire(new c.l("zoom",e)),this._rotating&&this.fire(new c.l("rotate",e)),this._pitching&&this.fire(new c.l("pitch",e)),this._rolling&&this.fire(new c.l("roll",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const l=this._zooming,u=this._rotating,p=this._pitching,y=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new c.l("zoomend",e)),u&&this.fire(new c.l("rotateend",e)),p&&this.fire(new c.l("pitchend",e)),y&&this.fire(new c.l("rollend",e)),this.fire(new c.l("moveend",e))}flyTo(e,r){if(!e.essential&&Q.prefersReducedMotion){const Ee=c.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ee,r)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.ca},e);const l=this._getTransformForUpdate(),u=l.bearing,p=l.pitch,y=l.roll,w=l.padding,T="bearing"in e?this._normalizeBearing(e.bearing,u):u,k="pitch"in e?+e.pitch:p,E="roll"in e?this._normalizeBearing(e.roll,y):y,D="padding"in e?e.padding:l.padding,R=c.P.convert(e.offset);let $=l.centerPoint.add(R);const N=l.screenPointToLocation($),K=this.cameraHelper.handleFlyTo(l,{bearing:T,pitch:k,roll:E,padding:D,locationAtOffset:N,offsetAsPoint:R,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let Y=e.curve;const J=Math.max(l.width,l.height),re=J/K.scaleOfZoom,ne=K.pixelPathLength;typeof K.scaleOfMinZoom=="number"&&(Y=Math.sqrt(J/K.scaleOfMinZoom/ne*2));const le=Y*Y;function ue(Ee){const Ke=(re*re-J*J+(Ee?-1:1)*le*le*ne*ne)/(2*(Ee?re:J)*le*ne);return Math.log(Math.sqrt(Ke*Ke+1)-Ke)}function fe(Ee){return(Math.exp(Ee)-Math.exp(-Ee))/2}function he(Ee){return(Math.exp(Ee)+Math.exp(-Ee))/2}const be=ue(!1);let we=function(Ee){return he(be)/he(be+Y*Ee)},Ae=function(Ee){return J*((he(be)*(fe(Ke=be+Y*Ee)/he(Ke))-fe(be))/le)/ne;var Ke},Re=(ue(!0)-be)/Y;if(Math.abs(ne)<2e-6||!isFinite(Re)){if(Math.abs(J-re)<1e-6)return this.easeTo(e,r);const Ee=re<J?-1:1;Re=Math.abs(Math.log(re/J))/Y,Ae=()=>0,we=Ke=>Math.exp(Ee*Y*Ke)}return e.duration="duration"in e?+e.duration:1e3*Re/("screenSpeed"in e?+e.screenSpeed/Y:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=u!==T,this._pitching=k!==p,this._rolling=E!==y,this._padding=!l.isPaddingEqual(D),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(K.targetCenter),this._ease(Ee=>{const Ke=Ee*Re,Xe=1/we(Ke),$e=Ae(Ke);this._rotating&&l.setBearing(c.B.number(u,T,Ee)),this._pitching&&l.setPitch(c.B.number(p,k,Ee)),this._rolling&&l.setRoll(c.B.number(y,E,Ee)),this._padding&&(l.interpolatePadding(w,D,Ee),$=l.centerPoint.add(R)),K.easeFunc(Ee,Xe,$e,$),this.terrain&&!e.freezeElevation&&this._updateElevation(Ee),this._applyUpdatedTransform(l),this._fireMoveEvents(r)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,r){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,r)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,r,l){l.animate===!1||l.duration===0?(e(1),r()):(this._easeStart=Q.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=c.aK(e,-180,180);const l=Math.abs(e-r);return Math.abs(e-360-r)<l&&(e-=360),Math.abs(e+360-r)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.Q.convert(e),this.transform.tileZoom):null}}const Mt={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ks{constructor(e=Mt){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=r=>{!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=G.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=G.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=G.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(e,r){const l=this._map._getUIString(`AttributionControl.${r}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(u=>typeof u!="string"?"":u)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const r=this._map.style.sourceCaches;for(const u in r){const p=r[u];if(p.used||p.usedForTerrain){const y=p.getSource();y.attribution&&e.indexOf(y.attribution)<0&&e.push(y.attribution)}}e=e.filter(u=>String(u).trim()),e.sort((u,p)=>u.length-p.length),e=e.filter((u,p)=>{for(let y=p+1;y<e.length;y++)if(e[y].indexOf(u)>=0)return!1;return!0});const l=e.join(" | ");l!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=G.sanitize(l),e.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Qa{constructor(e={}){this._updateCompact=()=>{const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=G.create("div","maplibregl-ctrl");const r=G.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){G.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ic{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const r=++this._id;return this._queue.push({callback:e,id:r,cancelled:!1}),r}remove(e){const r=this._currentlyRunning,l=r?this._queue.concat(r):this._queue;for(const u of l)if(u.id===e)return void(u.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const r=this._currentlyRunning=this._queue;this._queue=[];for(const l of r)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Bo=c.aC([{name:"a_pos3d",type:"Int16",components:3}]);class Ph extends c.E{constructor(e){super(),this._lastTilesetChange=Q.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];const l={};for(const u of ge(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[u.key]=!0,this._renderableTilesKeys.push(u.key),this._tiles[u.key]||(u.terrainRttPosMatrix32f=new Float64Array(16),c.bN(u.terrainRttPosMatrix32f,0,c.Z,c.Z,0,0,1),this._tiles[u.key]=new Br(u,this.tileSize),this._lastTilesetChange=Q.now());for(const u in this._tiles)l[u]||delete this._tiles[u]}freeRtt(e){for(const r in this._tiles){const l=this._tiles[r];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const r={};for(const l of this._renderableTilesKeys){const u=this._tiles[l].tileID,p=e.clone(),y=c.b1();if(u.canonical.equals(e.canonical))c.bN(y,0,c.Z,c.Z,0,0,1);else if(u.canonical.isChildOf(e.canonical)){const w=u.canonical.z-e.canonical.z,T=u.canonical.x-(u.canonical.x>>w<<w),k=u.canonical.y-(u.canonical.y>>w<<w),E=c.Z>>w;c.bN(y,0,E,E,0,0,1),c.L(y,y,[-T*E,-k*E,0])}else{if(!e.canonical.isChildOf(u.canonical))continue;{const w=e.canonical.z-u.canonical.z,T=e.canonical.x-(e.canonical.x>>w<<w),k=e.canonical.y-(e.canonical.y>>w<<w),E=c.Z>>w;c.bN(y,0,c.Z,c.Z,0,0,1),c.L(y,y,[T*E,k*E,0]),c.M(y,y,[1/2**w,1/2**w,0])}}p.terrainRttPosMatrix32f=new Float32Array(y),r[l]=p}return r}getSourceTile(e,r){const l=this.sourceCache._source;let u=e.overscaledZ-this.deltaZoom;if(u>l.maxzoom&&(u=l.maxzoom),u<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(u).key);let p=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!p||!p.dem)&&r)for(;u>=l.minzoom&&(!p||!p.dem);)p=this.sourceCache.getTileByID(e.scaledTo(u--).key);return p}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}}class Ai{constructor(e,r,l){this._meshCache={},this.painter=e,this.sourceCache=new Ph(r),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,l,u=c.Z){var p;if(!(r>=0&&r<u&&l>=0&&l<u))return 0;const y=this.getTerrainData(e),w=(p=y.tile)===null||p===void 0?void 0:p.dem;if(!w)return 0;const T=c.cb([],[r/u*c.Z,l/u*c.Z],y.u_terrain_matrix),k=[T[0]*w.dim,T[1]*w.dim],E=Math.floor(k[0]),D=Math.floor(k[1]),R=k[0]-E,$=k[1]-D;return w.get(E,D)*(1-R)*(1-$)+w.get(E+1,D)*R*(1-$)+w.get(E,D+1)*(1-R)*$+w.get(E+1,D+1)*R*$}getElevationForLngLatZoom(e,r){if(!c.cc(r,e.wrap()))return 0;const{tileID:l,mercatorX:u,mercatorY:p}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(l,u%c.Z,p%c.Z,c.Z)}getElevation(e,r,l,u=c.Z){return this.getDEMElevation(e,r,l,u)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const u=this.painter.context,p=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new nt(u,p,u.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new nt(u,new c.R({width:1,height:1}),u.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.as([])}const r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const u=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new nt(u,r.dem.getPixels(),u.gl.RGBA,{premultiply:!1}),r.demTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const l=r&&r+r.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const u=this.sourceCache.sourceCache._source.maxzoom;let p=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=u?p=e.canonical.z-u:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const y=e.canonical.x-(e.canonical.x>>p<<p),w=e.canonical.y-(e.canonical.y>>p<<p),T=c.cd(new Float64Array(16),[1/(c.Z<<p),1/(c.Z<<p),0]);c.L(T,T,[y*c.Z,w*c.Z,0]),this._demMatrixCache[e.key]={matrix:T,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){const r=this.painter,l=r.width/devicePixelRatio,u=r.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===u||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new nt(r.context,{width:l,height:u,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new nt(r.context,{width:l,height:u,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(l,u,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,l,u))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let p=0,y=0;p<this._coordsTextureSize;p++)for(let w=0;w<this._coordsTextureSize;w++,y+=4)r[y+0]=255&w,r[y+1]=255&p,r[y+2]=w>>8<<4|p>>8,r[y+3]=0;const l=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),u=new nt(e,l,e.gl.RGBA,{premultiply:!1});return u.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=u,u}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),l=this.painter.context,u=l.gl,p=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),y=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),w=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),u.readPixels(p,w-y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,r),l.bindFramebuffer.set(null);const T=r[0]+(r[2]>>4<<8),k=r[1]+((15&r[2])<<8),E=this.coordsIndex[255-r[3]],D=E&&this.sourceCache.getTileByID(E);if(!D)return null;const R=this._coordsTextureSize,$=(1<<D.tileID.canonical.z)*R;return new c.$((D.tileID.canonical.x*R+T)/$+D.tileID.wrap,(D.tileID.canonical.y*R+k)/$,this.getElevation(D.tileID,T,k,R))}depthAtPoint(e){const r=new Uint8Array(4),l=this.painter.context,u=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),u.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,r),l.bindFramebuffer.set(null),(r[0]/16777216+r[1]/65536+r[2]/256+r[3])/256}getTerrainMesh(e){var r;const l=((r=this.painter.style.projection)===null||r===void 0?void 0:r.transitionState)>0,u=l&&e.canonical.y===0,p=l&&e.canonical.y===(1<<e.canonical.z)-1,y=`m_${u?"n":""}_${p?"s":""}`;if(this._meshCache[y])return this._meshCache[y];const w=this.painter.context,T=new c.ce,k=new c.aG,E=this.meshSize,D=c.Z/E,R=E*E;for(let he=0;he<=E;he++)for(let be=0;be<=E;be++)T.emplaceBack(be*D,he*D,0);for(let he=0;he<R;he+=E+1)for(let be=0;be<E;be++)k.emplaceBack(be+he,E+be+he+1,E+be+he+2),k.emplaceBack(be+he,E+be+he+2,be+he+1);const $=T.length,N=$+(E+1),K=(E+1)*E,Y=u?c.b8:0,J=u?0:1,re=p?c.b9:c.Z,ne=p?0:1;for(let he=0;he<=E;he++)T.emplaceBack(he*D,Y,J);for(let he=0;he<=E;he++)T.emplaceBack(he*D,re,ne);for(let he=0;he<E;he++)k.emplaceBack(K+he,N+he,N+he+1),k.emplaceBack(K+he,N+he+1,K+he+1),k.emplaceBack(0+he,$+he+1,$+he),k.emplaceBack(0+he,0+he+1,$+he+1);const le=T.length,ue=le+2*(E+1);for(const he of[0,1])for(let be=0;be<=E;be++)for(const we of[0,1])T.emplaceBack(he*c.Z,be*D,we);for(let he=0;he<2*E;he+=2)k.emplaceBack(le+he,le+he+1,le+he+3),k.emplaceBack(le+he,le+he+3,le+he+2),k.emplaceBack(ue+he,ue+he+3,ue+he+1),k.emplaceBack(ue+he,ue+he+2,ue+he+3);const fe=new Go(w.createVertexBuffer(T,Bo.members),w.createIndexBuffer(k),c.aF.simpleSegment(0,0,T.length,k.length));return this._meshCache[y]=fe,fe}getMeshFrameDelta(e){return 2*Math.PI*c.bq/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,r){var l;const{tileID:u}=this._getOverscaledTileIDFromLngLatZoom(e,r);return(l=this.getMinMaxElevation(u).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const r=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return r&&r.dem&&(l.minElevation=r.dem.min*this.exaggeration,l.maxElevation=r.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,r){const l=c.$.fromLngLat(e.wrap()),u=(1<<r)*c.Z,p=l.x*u,y=l.y*u,w=Math.floor(p/c.Z),T=Math.floor(y/c.Z);return{tileID:new c.Y(r,0,r,w,T),mercatorX:p,mercatorY:y}}}class ff{constructor(e,r,l){this._context=e,this._size=r,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new nt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(l.texture),{id:e,fbo:r,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(r=>e.id!==r),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const zi={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class zr{constructor(e,r){this.painter=e,this.terrain=r,this.pool=new ff(e.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(l=>!e._layers[l].isHidden(r)),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const u=e.sourceCaches[l].getVisibleCoordinates();for(const p of u){const y=this.terrain.sourceCache.getTerrainCoords(p);for(const w in y)this._coordsAscending[l][w]||(this._coordsAscending[l][w]=[]),this._coordsAscending[l][w].push(y[w])}}this._coordsAscendingStr={};for(const l of e._order){const u=e._layers[l],p=u.source;if(zi[u.type]&&!this._coordsAscendingStr[p]){this._coordsAscendingStr[p]={};for(const y in this._coordsAscending[p])this._coordsAscendingStr[p][y]=this._coordsAscending[p][y].map(w=>w.key).sort().join()}}for(const l of this._renderableTiles)for(const u in this._coordsAscendingStr){const p=this._coordsAscendingStr[u][l.tileID.key];p&&p!==l.rttCoords[u]&&(l.rtt=[])}}renderLayer(e,r){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),u=e.type,p=this.painter,y=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(zi[u]&&(this._prevType&&zi[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(e.id),!y))return!0;if(zi[this._prevType]||zi[u]&&y){this._prevType=u;const w=this._stacks.length-1,T=this._stacks[w]||[];for(const k of this._renderableTiles){if(this.pool.isFull()&&(gc(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[w]){const D=this.pool.getObjectForId(k.rtt[w].id);if(D.stamp===k.rtt[w].stamp){this.pool.useObject(D);continue}}const E=this.pool.getOrCreateFreeObject();this.pool.useObject(E),this.pool.stampObject(E),k.rtt[w]={id:E.id,stamp:E.stamp},p.context.bindFramebuffer.set(E.fbo.framebuffer),p.context.clear({color:c.b6.transparent,stencil:0}),p.currentStencilSource=void 0;for(let D=0;D<T.length;D++){const R=p.style._layers[T[D]],$=R.source?this._coordsAscending[R.source][k.tileID.key]:[k.tileID];p.context.viewport.set([0,0,E.fbo.width,E.fbo.height]),p._renderTileClippingMasks(R,$,!0),p.renderLayer(p,p.style.sourceCaches[R.source],R,$,l),R.source&&(k.rttCoords[R.source]=this._coordsAscendingStr[R.source][k.tileID.key])}}return gc(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),zi[u]}return!1}}const $r={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Mh=z,us={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Mt,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},el={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Ec{constructor(e,r,l=!1){this.mousedown=p=>{this.startMove(p,G.mousePos(this.element,p)),G.addEventListener(window,"mousemove",this.mousemove),G.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=p=>{this.move(p,G.mousePos(this.element,p))},this.mouseup=p=>{this._rotatePitchHanlder.dragEnd(p),this.offTemp()},this.touchstart=p=>{p.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=G.touchPos(this.element,p.targetTouches)[0],this.startMove(p,this._startPos),G.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.addEventListener(window,"touchend",this.touchend))},this.touchmove=p=>{p.targetTouches.length!==1?this.reset():(this._lastPos=G.touchPos(this.element,p.targetTouches)[0],this.move(p,this._lastPos))},this.touchend=p=>{p.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const u=new wh;this._rotatePitchHanlder=new Wo({clickTolerance:3,move:(p,y)=>{const w=r.getBoundingClientRect(),T=new c.P((w.bottom-w.top)/2,(w.right-w.left)/2);return{bearingDelta:c.c9(new c.P(p.x,y.y),y,T),pitchDelta:l?-.5*(y.y-p.y):void 0}},moveStateManager:u,enable:!0,assignEvents:()=>{}}),this.map=e,G.addEventListener(r,"mousedown",this.mousedown),G.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),G.addEventListener(r,"touchcancel",this.reset)}startMove(e,r){this._rotatePitchHanlder.dragStart(e,r),G.disableDrag()}move(e,r){const l=this.map,{bearingDelta:u,pitchDelta:p}=this._rotatePitchHanlder.dragMove(e,r)||{};u&&l.setBearing(l.getBearing()+u),p&&l.setPitch(l.getPitch()+p)}off(){const e=this.element;G.removeEventListener(e,"mousedown",this.mousedown),G.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),G.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.removeEventListener(window,"touchend",this.touchend),G.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){G.enableDrag(),G.removeEventListener(window,"mousemove",this.mousemove),G.removeEventListener(window,"mouseup",this.mouseup),G.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.removeEventListener(window,"touchend",this.touchend)}}let Vi;function tl(f,e,r){const l=new c.Q(f.lng,f.lat);if(f=new c.Q(f.lng,f.lat),e){const u=new c.Q(f.lng-360,f.lat),p=new c.Q(f.lng+360,f.lat),y=r.locationToScreenPoint(f).distSqr(e);r.locationToScreenPoint(u).distSqr(e)<y?f=u:r.locationToScreenPoint(p).distSqr(e)<y&&(f=p)}for(;Math.abs(f.lng-r.center.lng)>180;){const u=r.locationToScreenPoint(f);if(u.x>=0&&u.y>=0&&u.x<=r.width&&u.y<=r.height)break;f.lng>r.center.lng?f.lng-=360:f.lng+=360}return f.lng!==l.lng&&r.isPointOnMapSurface(r.locationToScreenPoint(f))?f:l}const Mn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function rl(f,e,r){const l=f.classList;for(const u in Mn)l.remove(`maplibregl-${r}-anchor-${u}`);l.add(`maplibregl-${r}-anchor-${e}`)}class Js extends c.E{constructor(e){if(super(),this._onKeyPress=r=>{const l=r.code,u=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&u!==32&&u!==13||this.togglePopup()},this._onMapClick=r=>{const l=r.originalEvent.target,u=this._element;this._popup&&(l===u||u.contains(l))&&this.togglePopup()},this._update=r=>{var l;if(!this._map)return;const u=this._map.loaded()&&!this._map.isMoving();((r==null?void 0:r.type)==="terrain"||(r==null?void 0:r.type)==="render"&&!u)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?tl(this._lngLat,this._flatPos,this._map.transform):(l=this._lngLat)===null||l===void 0?void 0:l.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||r&&r.type!=="moveend"||(this._pos=this._pos.round()),G.setTransform(this._element,`${Mn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${p}`),Q.frameAsync(new AbortController).then(()=>{this._updateOpacity(r&&r.type==="moveend")}).catch(()=>{})},this._onMove=r=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=r=>{this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=G.create("div");const r=G.createNS("http://www.w3.org/2000/svg","svg"),l=41,u=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${l}px`),r.setAttributeNS(null,"width",`${u}px`),r.setAttributeNS(null,"viewBox",`0 0 ${u} ${l}`);const p=G.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"stroke","none"),p.setAttributeNS(null,"stroke-width","1"),p.setAttributeNS(null,"fill","none"),p.setAttributeNS(null,"fill-rule","evenodd");const y=G.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"fill-rule","nonzero");const w=G.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const J of T){const re=G.createNS("http://www.w3.org/2000/svg","ellipse");re.setAttributeNS(null,"opacity","0.04"),re.setAttributeNS(null,"cx","10.5"),re.setAttributeNS(null,"cy","5.80029008"),re.setAttributeNS(null,"rx",J.rx),re.setAttributeNS(null,"ry",J.ry),w.appendChild(re)}const k=G.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const E=G.createNS("http://www.w3.org/2000/svg","path");E.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(E);const D=G.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"opacity","0.25"),D.setAttributeNS(null,"fill","#000000");const R=G.createNS("http://www.w3.org/2000/svg","path");R.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),D.appendChild(R);const $=G.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$.setAttributeNS(null,"fill","#FFFFFF");const N=G.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(8.0, 8.0)");const K=G.createNS("http://www.w3.org/2000/svg","circle");K.setAttributeNS(null,"fill","#000000"),K.setAttributeNS(null,"opacity","0.25"),K.setAttributeNS(null,"cx","5.5"),K.setAttributeNS(null,"cy","5.5"),K.setAttributeNS(null,"r","5.4999962");const Y=G.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#FFFFFF"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962"),N.appendChild(K),N.appendChild(Y),y.appendChild(w),y.appendChild(k),y.appendChild(D),y.appendChild($),y.appendChild(N),r.appendChild(y),r.setAttributeNS(null,"height",l*this._scale+"px"),r.setAttributeNS(null,"width",u*this._scale+"px"),this._element.appendChild(r),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",r=>{r.preventDefault()}),this._element.addEventListener("mousedown",r=>{r.preventDefault()}),rl(this._element,this._anchor,"marker"),e&&e.className)for(const r of e.className.split(" "))this._element.classList.add(r);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),G.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const u=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var r,l;if(!(!((r=this._map)===null||r===void 0)&&r.terrain)){const D=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==D&&(this._element.style.opacity=D))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const u=this._map,p=u.terrain.depthAtPoint(this._pos),y=u.terrain.getElevationForLngLatZoom(this._lngLat,u.transform.tileZoom);if(u.transform.lngLatToCameraDepth(this._lngLat,y)-p<.006)return void(this._element.style.opacity=this._opacity);const w=-this._offset.y/u.transform.pixelsPerMeter,T=Math.sin(u.getPitch()*Math.PI/180)*w,k=u.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),E=u.transform.lngLatToCameraDepth(this._lngLat,y+T)-k>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&E&&this._popup.remove(),this._element.style.opacity=E?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,r){return(this._opacity===void 0||e===void 0&&r===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),r!==void 0&&(this._opacityWhenCovered=r),this._map&&this._updateOpacity(!0),this}}const Ac={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let hs=0,In=!1;const zc={maxWidth:100,unit:"metric"};function ol(f,e,r){const l=r&&r.maxWidth||100,u=f._container.clientHeight/2,p=f._container.clientWidth/2,y=f.unproject([p-l/2,u]),w=f.unproject([p+l/2,u]),T=Math.round(f.project(w).x-f.project(y).x),k=Math.min(l,T,f._container.clientWidth),E=y.distanceTo(w);if(r&&r.unit==="imperial"){const D=3.2808*E;D>5280?En(e,k,D/5280,f._getUIString("ScaleControl.Miles")):En(e,k,D,f._getUIString("ScaleControl.Feet"))}else r&&r.unit==="nautical"?En(e,k,E/1852,f._getUIString("ScaleControl.NauticalMiles")):E>=1e3?En(e,k,E/1e3,f._getUIString("ScaleControl.Kilometers")):En(e,k,E,f._getUIString("ScaleControl.Meters"))}function En(f,e,r,l){const u=function(p){const y=Math.pow(10,`${Math.floor(p)}`.length-1);let w=p/y;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(T){const k=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*k)/k}(w),y*w}(r);f.style.width=e*(u/r)+"px",f.innerHTML=`${u}&nbsp;${l}`}const il={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Dc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function nl(f){if(f){if(typeof f=="number"){const e=Math.round(Math.abs(f)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,f),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-f),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(f,0),right:new c.P(-f,0)}}if(f instanceof c.P||Array.isArray(f)){const e=c.P.convert(f);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(f.center||[0,0]),top:c.P.convert(f.top||[0,0]),"top-left":c.P.convert(f["top-left"]||[0,0]),"top-right":c.P.convert(f["top-right"]||[0,0]),bottom:c.P.convert(f.bottom||[0,0]),"bottom-left":c.P.convert(f["bottom-left"]||[0,0]),"bottom-right":c.P.convert(f["bottom-right"]||[0,0]),left:c.P.convert(f.left||[0,0]),right:c.P.convert(f.right||[0,0])}}return nl(new c.P(0,0))}const sl=z;b.AJAXError=c.ci,b.Event=c.l,b.Evented=c.E,b.LngLat=c.Q,b.MercatorCoordinate=c.$,b.Point=c.P,b.addProtocol=c.cj,b.config=c.a,b.removeProtocol=c.ck,b.AttributionControl=Ks,b.BoxZoomHandler=xh,b.CanvasSource=Pt,b.CooperativeGesturesHandler=Mc,b.DoubleClickZoomHandler=kh,b.DragPanHandler=Xs,b.DragRotateHandler=Ka,b.EdgeInsets=io,b.FullscreenControl=class extends c.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var e;let r=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=r==null?void 0:r.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)r=r.shadowRoot.fullscreenElement;r===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){G.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=G.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);G.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},b.GeoJSONSource=ot,b.GeolocateControl=class extends c.E{constructor(f){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const r=new c.Q(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,u=this._map.getBearing(),p=c.e({bearing:u},this.options.fitBoundsOptions),y=ke.fromLngLat(r,l);this._map.fitBounds(y,p,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const r=new c.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&In)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=G.create("button","maplibregl-ctrl-geolocate",this._container),G.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=G.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Js({element:this._dotElement}),this._circleElement=G.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Js({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))})}},this.options=c.e({},Ac,f)}onAdd(f){return this._map=f,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(e=!1){if(Vi!==void 0&&!e)return Vi;if(window.navigator.permissions===void 0)return Vi=!!window.navigator.geolocation,Vi;try{Vi=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Vi=!!window.navigator.geolocation}return Vi})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),G.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,hs=0,In=!1}_isOutOfMapMaxBounds(f){const e=this._map.getMaxBounds(),r=f.coords;return e&&(r.longitude<e.getWest()||r.longitude>e.getEast()||r.latitude<e.getSouth()||r.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const f=this._map.getBounds(),e=f.getSouthEast(),r=f.getNorthEast(),l=e.distanceTo(r),u=Math.ceil(this._accuracy/(l/this._map._container.clientHeight)*2);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":hs--,In=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),hs++,hs>1?(f={maximumAge:6e5,timeout:0},In=!0):(f=this.options.positionOptions,In=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},b.GlobeControl=class{constructor(){this._toggleProjection=()=>{var f;const e=(f=this._map.getProjection())===null||f===void 0?void 0:f.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var f;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((f=this._map.getProjection())===null||f===void 0?void 0:f.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(f){return this._map=f,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=G.create("button","maplibregl-ctrl-globe",this._container),G.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},b.Hash=tn,b.ImageSource=Qe,b.KeyboardHandler=Sc,b.LngLatBounds=ke,b.LogoControl=Qa,b.Map=class extends vt{constructor(f){var e,r;c.cf.mark(c.cg.create);const l=Object.assign(Object.assign(Object.assign({},us),f),{canvasContextAttributes:Object.assign(Object.assign({},us.canvasContextAttributes),f.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const u=new si,p=new bi;if(l.minZoom!==void 0&&u.setMinZoom(l.minZoom),l.maxZoom!==void 0&&u.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&u.setMinPitch(l.minPitch),l.maxPitch!==void 0&&u.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&u.setRenderWorldCopies(l.renderWorldCopies),super(u,p,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Ic,this._controls=[],this._mapId=c.a3(),this._contextLost=w=>{w.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:w}))},this._contextRestored=w=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:w}))},this._onMapScroll=w=>{if(w.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},$r),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Te.addThrottleControl(()=>this.isMoving()),this._requestManager=new Ye(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let w=!1;const T=yc(k=>{this._trackResize&&!this._removed&&(this.resize(k),this.redraw())},50);this._resizeObserver=new ResizeObserver(k=>{w?T(k):w=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ja(this,l),this._hash=l.hash&&new tn(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,c.e({},l.fitBoundsOptions,{duration:0}))));const y=typeof l.style=="string"||((r=(e=l.style)===null||e===void 0?void 0:e.projection)===null||r===void 0?void 0:r.type)!=="globe";this.resize(null,y),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new Ks(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new Qa,l.logoPosition),this.on("style.load",()=>{if(y||this._resizeTransform(),this.transform.unmodified){const w=c.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(w)}}),this.on("data",w=>{this._update(w.dataType==="style"),this.fire(new c.l(`${w.dataType}data`,w))}),this.on("dataloading",w=>{this.fire(new c.l(`${w.dataType}dataloading`,w))}),this.on("dataabort",w=>{this.fire(new c.l("sourcedataabort",w))})}_getMapId(){return this._mapId}addControl(f,e){if(e===void 0&&(e=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=f.onAdd(this);this._controls.push(f);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(r,l.firstChild):l.appendChild(r),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(f);return e>-1&&this._controls.splice(e,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}calculateCameraOptionsFromTo(f,e,r,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,e,r,l)}resize(f,e=!0){const[r,l]=this._containerDimensions(),u=this._getClampedPixelRatio(r,l);if(this._resizeCanvas(r,l,u),this.painter.resize(r,l,u),this.painter.overLimit()){const y=this.painter.context.gl;this._maxCanvasSize=[y.drawingBufferWidth,y.drawingBufferHeight];const w=this._getClampedPixelRatio(r,l);this._resizeCanvas(r,l,w),this.painter.resize(r,l,w)}this._resizeTransform(e);const p=!this._moving;return p&&(this.stop(),this.fire(new c.l("movestart",f)).fire(new c.l("move",f))),this.fire(new c.l("resize",f)),p&&this.fire(new c.l("moveend",f)),this}_resizeTransform(f=!0){var e;const[r,l]=this._containerDimensions();this.transform.resize(r,l,f),(e=this._requestedCameraState)===null||e===void 0||e.resize(r,l,f)}_getClampedPixelRatio(f,e){const{0:r,1:l}=this._maxCanvasSize,u=this.getPixelRatio(),p=f*u,y=e*u;return Math.min(p>r?r/p:1,y>l?l/y:1)*u}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(ke.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.setMinZoom(f),this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.setMaxZoom(f),this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.setMinPitch(f),this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(f>=this.transform.minPitch)return this.transform.setMaxPitch(f),this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.setRenderWorldCopies(f),this._update()}project(f){return this.transform.locationToScreenPoint(c.Q.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.screenPointToLocation(c.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,e,r){if(f==="mouseenter"||f==="mouseover"){let l=!1;return{layers:e,listener:r,delegates:{mousemove:p=>{const y=e.filter(T=>this.getLayer(T)),w=y.length!==0?this.queryRenderedFeatures(p.point,{layers:y}):[];w.length?l||(l=!0,r.call(this,new Ar(f,this,p.originalEvent,{features:w}))):l=!1},mouseout:()=>{l=!1}}}}if(f==="mouseleave"||f==="mouseout"){let l=!1;return{layers:e,listener:r,delegates:{mousemove:y=>{const w=e.filter(T=>this.getLayer(T));(w.length!==0?this.queryRenderedFeatures(y.point,{layers:w}):[]).length?l=!0:l&&(l=!1,r.call(this,new Ar(f,this,y.originalEvent)))},mouseout:y=>{l&&(l=!1,r.call(this,new Ar(f,this,y.originalEvent)))}}}}{const l=u=>{const p=e.filter(w=>this.getLayer(w)),y=p.length!==0?this.queryRenderedFeatures(u.point,{layers:p}):[];y.length&&(u.features=y,r.call(this,u),delete u.features)};return{layers:e,listener:r,delegates:{[f]:l}}}}_saveDelegatedListener(f,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(e)}_removeDelegatedListener(f,e,r){if(!this._delegatedListeners||!this._delegatedListeners[f])return;const l=this._delegatedListeners[f];for(let u=0;u<l.length;u++){const p=l[u];if(p.listener===r&&p.layers.length===e.length&&p.layers.every(y=>e.includes(y))){for(const y in p.delegates)this.off(y,p.delegates[y]);return void l.splice(u,1)}}}on(f,e,r){if(r===void 0)return super.on(f,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(f,l,r);this._saveDelegatedListener(f,u);for(const p in u.delegates)this.on(p,u.delegates[p]);return{unsubscribe:()=>{this._removeDelegatedListener(f,l,r)}}}once(f,e,r){if(r===void 0)return super.once(f,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(f,l,r);for(const p in u.delegates){const y=u.delegates[p];u.delegates[p]=(...w)=>{this._removeDelegatedListener(f,l,r),y(...w)}}this._saveDelegatedListener(f,u);for(const p in u.delegates)this.once(p,u.delegates[p]);return this}off(f,e,r){return r===void 0?super.off(f,e):(this._removeDelegatedListener(f,typeof e=="string"?[e]:e,r),this)}queryRenderedFeatures(f,e){if(!this.style)return[];let r;const l=f instanceof c.P||Array.isArray(f),u=l?f:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:f)||{},u instanceof c.P||typeof u[0]=="number")r=[c.P.convert(u)];else{const p=c.P.convert(u[0]),y=c.P.convert(u[1]);r=[p,new c.P(y.x,p.y),y,new c.P(p.x,y.y),p]}return this.style.queryRenderedFeatures(r,e,this.transform)}querySourceFeatures(f,e){return this.style.querySourceFeatures(f,e)}setStyle(f,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(f,e))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const e=this._locale[f];if(e==null)throw new Error(`Missing UI string '${f}'`);return e}_updateStyle(f,e){var r,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(f,e));const u=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new $s(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,e,u):this.style.loadJSON(f,e,u),this):((l=(r=this.style)===null||r===void 0?void 0:r.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new $s(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,e){if(typeof f=="string"){const r=this._requestManager.transformRequest(f,"Style");c.j(r,new AbortController).then(l=>{this._updateDiff(l.data,e)}).catch(l=>{l&&this.fire(new c.k(l))})}else typeof f=="object"&&this._updateDiff(f,e)}_updateDiff(f,e){try{this.style.setState(f,e)&&this._update(!0)}catch(r){c.w(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(f,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(f,e){return this._lazyInitEmptyStyle(),this.style.addSource(f,e),this._update(!0)}isSourceLoaded(f){const e=this.style&&this.style.sourceCaches[f];if(e!==void 0)return e.loaded();this.fire(new c.k(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const e=this.style.sourceCaches[f.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&e.reload();for(const r in this.style._layers){const l=this.style._layers[r];l.type==="hillshade"&&l.source===f.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ai(this.painter,e,f),this.painter.renderToTexture=new zr(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=r=>{r.dataType==="style"?this.terrain.sourceCache.freeRtt():r.dataType==="source"&&r.tile&&(r.sourceId!==f.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(r.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:f})),this}getTerrain(){var f,e;return(e=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const e in f){const r=f[e]._tiles;for(const l in r){const u=r[l];if(u.state!=="loaded"&&u.state!=="errored")return!1}}return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,e,r={}){const{pixelRatio:l=1,sdf:u=!1,stretchX:p,stretchY:y,content:w,textFitWidth:T,textFitHeight:k}=r;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:D,data:R}=e,$=e;return this.style.addImage(f,{data:new c.R({width:E,height:D},new Uint8Array(R)),pixelRatio:l,stretchX:p,stretchY:y,content:w,textFitWidth:T,textFitHeight:k,sdf:u,version:0,userImage:$}),$.onAdd&&$.onAdd(this,f),this}}{const{width:E,height:D,data:R}=Q.getImageData(e);this.style.addImage(f,{data:new c.R({width:E,height:D},R),pixelRatio:l,stretchX:p,stretchY:y,content:w,textFitWidth:T,textFitHeight:k,sdf:u,version:0})}}updateImage(f,e){const r=this.style.getImage(f);if(!r)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||c.b(e)?Q.getImageData(e):e,{width:u,height:p,data:y}=l;if(u===void 0||p===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(u!==r.data.width||p!==r.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(e instanceof HTMLImageElement||c.b(e));return r.data.replace(y,w),this.style.updateImage(f,r),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return Te.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,e){return this._lazyInitEmptyStyle(),this.style.addLayer(f,e),this._update(!0)}moveLayer(f,e){return this.style.moveLayer(f,e),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,e,r){return this.style.setLayerZoomRange(f,e,r),this._update(!0)}setFilter(f,e,r={}){return this.style.setFilter(f,e,r),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,e,r,l={}){return this.style.setPaintProperty(f,e,r,l),this._update(!0)}getPaintProperty(f,e){return this.style.getPaintProperty(f,e)}setLayoutProperty(f,e,r,l={}){return this.style.setLayoutProperty(f,e,r,l),this._update(!0)}getLayoutProperty(f,e){return this.style.getLayoutProperty(f,e)}setGlyphs(f,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,e,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,e,r,l=>{l||this._update(!0)}),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,e,r=>{r||this._update(!0)}),this}setLight(f,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(f,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,e){return this.style.setFeatureState(f,e),this._update()}removeFeatureState(f,e){return this.style.removeFeatureState(f,e),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,e=0;return this._container&&(f=this._container.clientWidth||400,e=this._container.clientHeight||300),[f,e]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const e=this._canvasContainer=G.create("div","maplibregl-canvas-container",f);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=G.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),l=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],l);const u=this._controlContainer=G.create("div","maplibregl-control-container",f),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{p[y]=G.create("div",`maplibregl-ctrl-${y} `,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,e,r){this._canvas.width=Math.floor(r*f),this._canvas.height=Math.floor(r*e),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const f=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",l=>{e={requestedAttributes:f},l&&(e.statusMessage=l.statusMessage,e.type=l.type)},{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,f):this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f),!r){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new ph(r,this.transform),se.testSupport(r)}migrateProjection(f,e){super.migrateProjection(f,e),this.painter.transform=f,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){var e,r,l,u,p;const y=this._idleTriggered?this._fadeDuration:0,w=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let T=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const D=this.transform.zoom,R=Q.now();this.style.zoomHistory.update(D,R);const $=new c.C(D,{now:R,fadeDuration:y,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),N=$.crossFadingFactor();N===1&&N===this._crossFadingFactor||(T=!0,this._crossFadingFactor=N),this.style.update($)}const k=((r=this.style.projection)===null||r===void 0?void 0:r.transitionState)>0!==w;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((u=this.style.projection)===null||u===void 0?void 0:u.transitionState,(p=this.style.projection)===null||p===void 0?void 0:p.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||k)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,y,this._crossSourceCollisions,k),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cf.mark(c.cg.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||T)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const E=this._sourcesDirty||this._styleDirty||this._placementDirty;return E||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||E||(this._fullyLoaded=!0,c.cf.mark(c.cg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Te.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),G.remove(this._canvasContainer),G.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cf.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,Q.frame(this._frameRequest,f=>{c.cf.frame(f),this._frameRequest=null;try{this._render(f)}catch(e){if(!c.ch(e)&&!function(r){return r.message===lh}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return Mh}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(f){return this._lazyInitEmptyStyle(),this.style.setProjection(f),this._update(!0)}},b.MapMouseEvent=Ar,b.MapTouchEvent=Lo,b.MapWheelEvent=vc,b.Marker=Js,b.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const e=this._map.getZoom(),r=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,r)=>{const l=this._map._getUIString(`NavigationControl.${r}`);e.title=l,e.setAttribute("aria-label",l)},this.options=c.e({},el,f),this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),G.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),G.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=G.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ec(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){G.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,e){const r=G.create("button",f,this._container);return r.type="button",r.addEventListener("click",e),r}},b.Popup=class extends c.E{constructor(f){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&G.remove(this._content),this._container&&(G.remove(this._container),delete this._container),this._closeButton&&this._closeButton.removeEventListener("click",this._onClose),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var r;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=G.create("div","maplibregl-popup",this._map.getContainer()),this._tip=G.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const w of this.options.className.split(" "))this._container.classList.add(w);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?tl(this._lngLat,this._flatPos,this._map.transform):(r=this._lngLat)===null||r===void 0?void 0:r.wrap(),this._trackPointer&&!e)return;const l=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let u=this.options.anchor;const p=nl(this.options.offset);if(!u){const w=this._container.offsetWidth,T=this._container.offsetHeight;let k;k=l.y+p.bottom.y<T?["top"]:l.y>this._map.transform.height-T?["bottom"]:[],l.x<w/2?k.push("left"):l.x>this._map.transform.width-w/2&&k.push("right"),u=k.length===0?"bottom":k.join("-")}let y=l.add(p[u]);this.options.subpixelPositioning||(y=y.round()),G.setTransform(this._container,`${Mn[u]} translate(${y.x}px,${y.y}px)`),rl(this._container,u,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(il),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=c.Q.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const e=document.createDocumentFragment(),r=document.createElement("body");let l;for(r.innerHTML=f;l=r.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=G.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=G.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Dc);f&&f.focus()}},b.RasterDEMTileSource=it,b.RasterTileSource=Ve,b.ScaleControl=class{constructor(f){this._onMove=()=>{ol(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,ol(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},zc),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){G.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},b.ScrollZoomHandler=Sh,b.Style=$s,b.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=G.create("button","maplibregl-ctrl-terrain",this._container),G.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){G.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},b.TwoFingersTouchPitchHandler=Cc,b.TwoFingersTouchRotateHandler=Th,b.TwoFingersTouchZoomHandler=Ch,b.TwoFingersTouchZoomRotateHandler=Pc,b.VectorTileSource=Ne,b.VideoSource=Ue,b.addSourceType=(f,e)=>c._(void 0,void 0,void 0,function*(){if(Ct(f))throw new Error(`A source type called "${f}" already exists.`);((r,l)=>{at[r]=l})(f,e)}),b.clearPrewarmedResources=function(){const f=Mr;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(or),Mr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},b.createTileMesh=Fs,b.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},b.getRTLTextPluginStatus=function(){return Ut().getRTLTextPluginStatus()},b.getVersion=function(){return sl},b.getWorkerCount=function(){return qt.workerCount},b.getWorkerUrl=function(){return c.a.WORKER_URL},b.importScriptInWorkers=function(f){return Uo().broadcast("IS",f)},b.prewarm=function(){qr().acquire(or)},b.setMaxParallelImageRequests=function(f){c.a.MAX_PARALLEL_IMAGE_REQUESTS=f},b.setRTLTextPlugin=function(f,e){return Ut().setRTLTextPlugin(f,e)},b.setWorkerCount=function(f){qt.workerCount=f},b.setWorkerUrl=function(f){c.a.WORKER_URL=f}});var P=d;return P})}(hd)),hd.exports}var w5=x5();const C5=v5(w5);function iv(n,s,d){if(n!==null)for(var _,x,P,b,c,z,U,V=0,H=0,Q,G=n.type,se=G==="FeatureCollection",Me=G==="Feature",rt=se?n.features.length:1,He=0;He<rt;He++){U=se?n.features[He].geometry:Me?n.geometry:n,Q=U?U.type==="GeometryCollection":!1,c=Q?U.geometries.length:1;for(var lt=0;lt<c;lt++){var st=0,Te=0;if(b=Q?U.geometries[lt]:U,b!==null){z=b.coordinates;var Ye=b.type;switch(V=0,Ye){case null:break;case"Point":if(s(z,H,He,st,Te)===!1)return!1;H++,st++;break;case"LineString":case"MultiPoint":for(_=0;_<z.length;_++){if(s(z[_],H,He,st,Te)===!1)return!1;H++,Ye==="MultiPoint"&&st++}Ye==="LineString"&&st++;break;case"Polygon":case"MultiLineString":for(_=0;_<z.length;_++){for(x=0;x<z[_].length-V;x++){if(s(z[_][x],H,He,st,Te)===!1)return!1;H++}Ye==="MultiLineString"&&st++,Ye==="Polygon"&&Te++}Ye==="Polygon"&&st++;break;case"MultiPolygon":for(_=0;_<z.length;_++){for(Te=0,x=0;x<z[_].length;x++){for(P=0;P<z[_][x].length-V;P++){if(s(z[_][x][P],H,He,st,Te)===!1)return!1;H++}Te++}st++}break;case"GeometryCollection":for(_=0;_<b.geometries.length;_++)if(iv(b.geometries[_],s)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function T5(n,s={}){if(n.bbox!=null&&s.recompute!==!0)return n.bbox;const d=[1/0,1/0,-1/0,-1/0];return iv(n,_=>{d[0]>_[0]&&(d[0]=_[0]),d[1]>_[1]&&(d[1]=_[1]),d[2]<_[0]&&(d[2]=_[0]),d[3]<_[1]&&(d[3]=_[1])}),d}const nv=Zw("map",()=>{const n=Dl({"weather-warnings":{id:"weather-warnings",homeMapLayerType:"fixed",title:"Weather Warnings",position:1,visible:!1,enabled:!1,icon:"icon-warning",multiTemporal:!1},"weather-forecast":{id:"weather-forecast",homeMapLayerType:"fixed",title:"Weather Forecast",position:2,visible:!1,enabled:!1,dateFormat:{currentTime:"yyyy-MM-dd HH:mm"},icon:"icon-heavy-rain",multiTemporal:!0}}),s=pi(()=>Object.values(n).filter(se=>se.enabled&&se.homeMapLayerType==="fixed").sort((se,Me)=>se.position-Me.position)),d=pi(()=>Object.values(n).filter(se=>se.enabled&&se.homeMapLayerType==="dynamic").sort((se,Me)=>se.position-Me.position)),_=Mi({}),x=Mi({}),P=Mi(null);return{layers:n,sortedFixedLayers:s,sortedDynamicLayers:d,timeLayerDates:_,selectedTimeLayerDateIndex:x,activeTimeLayer:P,setTimeLayerDates:(se,Me)=>{_.value={..._.value,[se]:Me}},setSelectedTimeLayerDateIndex:(se,Me)=>{x.value={...x.value,[se]:Me}},updateLayerState:(se,Me)=>{n[se]?n[se].enabled=Me:console.warn(`Layer with ID '${se}' not found`)},updateLayerVisibility:(se,Me)=>{n[se]?n[se].visible=Me:console.warn(`Layer with ID '${se}' not found`)},setActiveTimeLayer:se=>{P.value=se},setWeatherForecastLayerDateFormat:se=>{n["weather-forecast"]&&(n["weather-forecast"].dateFormat=se)},getLayerById:se=>n[se]||null,addLayer:se=>{if(!se.id||n[se.id]){console.error("Invalid or duplicate layer ID");return}n[se.id]=se}}}),sv=6048e5,S5=864e5,av=6e4,lv=36e5,ny=Symbol.for("constructDateFrom");function Un(n,s){return typeof n=="function"?n(s):n&&typeof n=="object"&&ny in n?n[ny](s):n instanceof Date?new n.constructor(s):new Date(s)}function gi(n,s){return Un(s||n,n)}let k5={};function Vd(){return k5}function Au(n,s){var c,z,U,V;const d=Vd(),_=(s==null?void 0:s.weekStartsOn)??((z=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:z.weekStartsOn)??d.weekStartsOn??((V=(U=d.locale)==null?void 0:U.options)==null?void 0:V.weekStartsOn)??0,x=gi(n,s==null?void 0:s.in),P=x.getDay(),b=(P<_?7:0)+P-_;return x.setDate(x.getDate()-b),x.setHours(0,0,0,0),x}function Cd(n,s){return Au(n,{...s,weekStartsOn:1})}function cv(n,s){const d=gi(n,s==null?void 0:s.in),_=d.getFullYear(),x=Un(d,0);x.setFullYear(_+1,0,4),x.setHours(0,0,0,0);const P=Cd(x),b=Un(d,0);b.setFullYear(_,0,4),b.setHours(0,0,0,0);const c=Cd(b);return d.getTime()>=P.getTime()?_+1:d.getTime()>=c.getTime()?_:_-1}function sy(n){const s=gi(n),d=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return d.setUTCFullYear(s.getFullYear()),+n-+d}function P5(n,...s){const d=Un.bind(null,s.find(_=>typeof _=="object"));return s.map(d)}function ay(n,s){const d=gi(n,s==null?void 0:s.in);return d.setHours(0,0,0,0),d}function M5(n,s,d){const[_,x]=P5(d==null?void 0:d.in,n,s),P=ay(_),b=ay(x),c=+P-sy(P),z=+b-sy(b);return Math.round((c-z)/S5)}function I5(n,s){const d=cv(n,s),_=Un(n,0);return _.setFullYear(d,0,4),_.setHours(0,0,0,0),Cd(_)}function E5(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function A5(n){return!(!E5(n)&&typeof n!="number"||isNaN(+gi(n)))}function uv(n,s){const d=gi(n,s==null?void 0:s.in),_=d.getMonth();return d.setFullYear(d.getFullYear(),_+1,0),d.setHours(23,59,59,999),d}function z5(n,s){const d=gi(n,s==null?void 0:s.in);return d.setFullYear(d.getFullYear(),0,1),d.setHours(0,0,0,0),d}const D5={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},R5=(n,s,d)=>{let _;const x=D5[n];return typeof x=="string"?_=x:s===1?_=x.one:_=x.other.replace("{{count}}",s.toString()),d!=null&&d.addSuffix?d.comparison&&d.comparison>0?"in "+_:_+" ago":_};function xp(n){return(s={})=>{const d=s.width?String(s.width):n.defaultWidth;return n.formats[d]||n.formats[n.defaultWidth]}}const L5={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},B5={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},F5={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},O5={date:xp({formats:L5,defaultWidth:"full"}),time:xp({formats:B5,defaultWidth:"full"}),dateTime:xp({formats:F5,defaultWidth:"full"})},$5={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},j5=(n,s,d,_)=>$5[n];function ou(n){return(s,d)=>{const _=d!=null&&d.context?String(d.context):"standalone";let x;if(_==="formatting"&&n.formattingValues){const b=n.defaultFormattingWidth||n.defaultWidth,c=d!=null&&d.width?String(d.width):b;x=n.formattingValues[c]||n.formattingValues[b]}else{const b=n.defaultWidth,c=d!=null&&d.width?String(d.width):n.defaultWidth;x=n.values[c]||n.values[b]}const P=n.argumentCallback?n.argumentCallback(s):s;return x[P]}}const N5={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},V5={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},U5={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Z5={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},G5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},q5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},W5=(n,s)=>{const d=Number(n),_=d%100;if(_>20||_<10)switch(_%10){case 1:return d+"st";case 2:return d+"nd";case 3:return d+"rd"}return d+"th"},H5={ordinalNumber:W5,era:ou({values:N5,defaultWidth:"wide"}),quarter:ou({values:V5,defaultWidth:"wide",argumentCallback:n=>n-1}),month:ou({values:U5,defaultWidth:"wide"}),day:ou({values:Z5,defaultWidth:"wide"}),dayPeriod:ou({values:G5,defaultWidth:"wide",formattingValues:q5,defaultFormattingWidth:"wide"})};function iu(n){return(s,d={})=>{const _=d.width,x=_&&n.matchPatterns[_]||n.matchPatterns[n.defaultMatchWidth],P=s.match(x);if(!P)return null;const b=P[0],c=_&&n.parsePatterns[_]||n.parsePatterns[n.defaultParseWidth],z=Array.isArray(c)?Y5(c,H=>H.test(b)):X5(c,H=>H.test(b));let U;U=n.valueCallback?n.valueCallback(z):z,U=d.valueCallback?d.valueCallback(U):U;const V=s.slice(b.length);return{value:U,rest:V}}}function X5(n,s){for(const d in n)if(Object.prototype.hasOwnProperty.call(n,d)&&s(n[d]))return d}function Y5(n,s){for(let d=0;d<n.length;d++)if(s(n[d]))return d}function K5(n){return(s,d={})=>{const _=s.match(n.matchPattern);if(!_)return null;const x=_[0],P=s.match(n.parsePattern);if(!P)return null;let b=n.valueCallback?n.valueCallback(P[0]):P[0];b=d.valueCallback?d.valueCallback(b):b;const c=s.slice(x.length);return{value:b,rest:c}}}const J5=/^(\d+)(th|st|nd|rd)?/i,Q5=/\d+/i,ez={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},tz={any:[/^b/i,/^(a|c)/i]},rz={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},oz={any:[/1/i,/2/i,/3/i,/4/i]},iz={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},nz={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},sz={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},az={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},lz={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},cz={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},uz={ordinalNumber:K5({matchPattern:J5,parsePattern:Q5,valueCallback:n=>parseInt(n,10)}),era:iu({matchPatterns:ez,defaultMatchWidth:"wide",parsePatterns:tz,defaultParseWidth:"any"}),quarter:iu({matchPatterns:rz,defaultMatchWidth:"wide",parsePatterns:oz,defaultParseWidth:"any",valueCallback:n=>n+1}),month:iu({matchPatterns:iz,defaultMatchWidth:"wide",parsePatterns:nz,defaultParseWidth:"any"}),day:iu({matchPatterns:sz,defaultMatchWidth:"wide",parsePatterns:az,defaultParseWidth:"any"}),dayPeriod:iu({matchPatterns:lz,defaultMatchWidth:"any",parsePatterns:cz,defaultParseWidth:"any"})},hz={code:"en-US",formatDistance:R5,formatLong:O5,formatRelative:j5,localize:H5,match:uz,options:{weekStartsOn:0,firstWeekContainsDate:1}};function dz(n,s){const d=gi(n,s==null?void 0:s.in);return M5(d,z5(d))+1}function fz(n,s){const d=gi(n,s==null?void 0:s.in),_=+Cd(d)-+I5(d);return Math.round(_/sv)+1}function hv(n,s){var V,H,Q,G;const d=gi(n,s==null?void 0:s.in),_=d.getFullYear(),x=Vd(),P=(s==null?void 0:s.firstWeekContainsDate)??((H=(V=s==null?void 0:s.locale)==null?void 0:V.options)==null?void 0:H.firstWeekContainsDate)??x.firstWeekContainsDate??((G=(Q=x.locale)==null?void 0:Q.options)==null?void 0:G.firstWeekContainsDate)??1,b=Un((s==null?void 0:s.in)||n,0);b.setFullYear(_+1,0,P),b.setHours(0,0,0,0);const c=Au(b,s),z=Un((s==null?void 0:s.in)||n,0);z.setFullYear(_,0,P),z.setHours(0,0,0,0);const U=Au(z,s);return+d>=+c?_+1:+d>=+U?_:_-1}function pz(n,s){var c,z,U,V;const d=Vd(),_=(s==null?void 0:s.firstWeekContainsDate)??((z=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:z.firstWeekContainsDate)??d.firstWeekContainsDate??((V=(U=d.locale)==null?void 0:U.options)==null?void 0:V.firstWeekContainsDate)??1,x=hv(n,s),P=Un((s==null?void 0:s.in)||n,0);return P.setFullYear(x,0,_),P.setHours(0,0,0,0),Au(P,s)}function mz(n,s){const d=gi(n,s==null?void 0:s.in),_=+Au(d,s)-+pz(d,s);return Math.round(_/sv)+1}function mr(n,s){const d=n<0?"-":"",_=Math.abs(n).toString().padStart(s,"0");return d+_}const ys={y(n,s){const d=n.getFullYear(),_=d>0?d:1-d;return mr(s==="yy"?_%100:_,s.length)},M(n,s){const d=n.getMonth();return s==="M"?String(d+1):mr(d+1,2)},d(n,s){return mr(n.getDate(),s.length)},a(n,s){const d=n.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return d.toUpperCase();case"aaa":return d;case"aaaaa":return d[0];case"aaaa":default:return d==="am"?"a.m.":"p.m."}},h(n,s){return mr(n.getHours()%12||12,s.length)},H(n,s){return mr(n.getHours(),s.length)},m(n,s){return mr(n.getMinutes(),s.length)},s(n,s){return mr(n.getSeconds(),s.length)},S(n,s){const d=s.length,_=n.getMilliseconds(),x=Math.trunc(_*Math.pow(10,d-3));return mr(x,s.length)}},Sl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ly={G:function(n,s,d){const _=n.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return d.era(_,{width:"abbreviated"});case"GGGGG":return d.era(_,{width:"narrow"});case"GGGG":default:return d.era(_,{width:"wide"})}},y:function(n,s,d){if(s==="yo"){const _=n.getFullYear(),x=_>0?_:1-_;return d.ordinalNumber(x,{unit:"year"})}return ys.y(n,s)},Y:function(n,s,d,_){const x=hv(n,_),P=x>0?x:1-x;if(s==="YY"){const b=P%100;return mr(b,2)}return s==="Yo"?d.ordinalNumber(P,{unit:"year"}):mr(P,s.length)},R:function(n,s){const d=cv(n);return mr(d,s.length)},u:function(n,s){const d=n.getFullYear();return mr(d,s.length)},Q:function(n,s,d){const _=Math.ceil((n.getMonth()+1)/3);switch(s){case"Q":return String(_);case"QQ":return mr(_,2);case"Qo":return d.ordinalNumber(_,{unit:"quarter"});case"QQQ":return d.quarter(_,{width:"abbreviated",context:"formatting"});case"QQQQQ":return d.quarter(_,{width:"narrow",context:"formatting"});case"QQQQ":default:return d.quarter(_,{width:"wide",context:"formatting"})}},q:function(n,s,d){const _=Math.ceil((n.getMonth()+1)/3);switch(s){case"q":return String(_);case"qq":return mr(_,2);case"qo":return d.ordinalNumber(_,{unit:"quarter"});case"qqq":return d.quarter(_,{width:"abbreviated",context:"standalone"});case"qqqqq":return d.quarter(_,{width:"narrow",context:"standalone"});case"qqqq":default:return d.quarter(_,{width:"wide",context:"standalone"})}},M:function(n,s,d){const _=n.getMonth();switch(s){case"M":case"MM":return ys.M(n,s);case"Mo":return d.ordinalNumber(_+1,{unit:"month"});case"MMM":return d.month(_,{width:"abbreviated",context:"formatting"});case"MMMMM":return d.month(_,{width:"narrow",context:"formatting"});case"MMMM":default:return d.month(_,{width:"wide",context:"formatting"})}},L:function(n,s,d){const _=n.getMonth();switch(s){case"L":return String(_+1);case"LL":return mr(_+1,2);case"Lo":return d.ordinalNumber(_+1,{unit:"month"});case"LLL":return d.month(_,{width:"abbreviated",context:"standalone"});case"LLLLL":return d.month(_,{width:"narrow",context:"standalone"});case"LLLL":default:return d.month(_,{width:"wide",context:"standalone"})}},w:function(n,s,d,_){const x=mz(n,_);return s==="wo"?d.ordinalNumber(x,{unit:"week"}):mr(x,s.length)},I:function(n,s,d){const _=fz(n);return s==="Io"?d.ordinalNumber(_,{unit:"week"}):mr(_,s.length)},d:function(n,s,d){return s==="do"?d.ordinalNumber(n.getDate(),{unit:"date"}):ys.d(n,s)},D:function(n,s,d){const _=dz(n);return s==="Do"?d.ordinalNumber(_,{unit:"dayOfYear"}):mr(_,s.length)},E:function(n,s,d){const _=n.getDay();switch(s){case"E":case"EE":case"EEE":return d.day(_,{width:"abbreviated",context:"formatting"});case"EEEEE":return d.day(_,{width:"narrow",context:"formatting"});case"EEEEEE":return d.day(_,{width:"short",context:"formatting"});case"EEEE":default:return d.day(_,{width:"wide",context:"formatting"})}},e:function(n,s,d,_){const x=n.getDay(),P=(x-_.weekStartsOn+8)%7||7;switch(s){case"e":return String(P);case"ee":return mr(P,2);case"eo":return d.ordinalNumber(P,{unit:"day"});case"eee":return d.day(x,{width:"abbreviated",context:"formatting"});case"eeeee":return d.day(x,{width:"narrow",context:"formatting"});case"eeeeee":return d.day(x,{width:"short",context:"formatting"});case"eeee":default:return d.day(x,{width:"wide",context:"formatting"})}},c:function(n,s,d,_){const x=n.getDay(),P=(x-_.weekStartsOn+8)%7||7;switch(s){case"c":return String(P);case"cc":return mr(P,s.length);case"co":return d.ordinalNumber(P,{unit:"day"});case"ccc":return d.day(x,{width:"abbreviated",context:"standalone"});case"ccccc":return d.day(x,{width:"narrow",context:"standalone"});case"cccccc":return d.day(x,{width:"short",context:"standalone"});case"cccc":default:return d.day(x,{width:"wide",context:"standalone"})}},i:function(n,s,d){const _=n.getDay(),x=_===0?7:_;switch(s){case"i":return String(x);case"ii":return mr(x,s.length);case"io":return d.ordinalNumber(x,{unit:"day"});case"iii":return d.day(_,{width:"abbreviated",context:"formatting"});case"iiiii":return d.day(_,{width:"narrow",context:"formatting"});case"iiiiii":return d.day(_,{width:"short",context:"formatting"});case"iiii":default:return d.day(_,{width:"wide",context:"formatting"})}},a:function(n,s,d){const x=n.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return d.dayPeriod(x,{width:"abbreviated",context:"formatting"});case"aaa":return d.dayPeriod(x,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return d.dayPeriod(x,{width:"narrow",context:"formatting"});case"aaaa":default:return d.dayPeriod(x,{width:"wide",context:"formatting"})}},b:function(n,s,d){const _=n.getHours();let x;switch(_===12?x=Sl.noon:_===0?x=Sl.midnight:x=_/12>=1?"pm":"am",s){case"b":case"bb":return d.dayPeriod(x,{width:"abbreviated",context:"formatting"});case"bbb":return d.dayPeriod(x,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return d.dayPeriod(x,{width:"narrow",context:"formatting"});case"bbbb":default:return d.dayPeriod(x,{width:"wide",context:"formatting"})}},B:function(n,s,d){const _=n.getHours();let x;switch(_>=17?x=Sl.evening:_>=12?x=Sl.afternoon:_>=4?x=Sl.morning:x=Sl.night,s){case"B":case"BB":case"BBB":return d.dayPeriod(x,{width:"abbreviated",context:"formatting"});case"BBBBB":return d.dayPeriod(x,{width:"narrow",context:"formatting"});case"BBBB":default:return d.dayPeriod(x,{width:"wide",context:"formatting"})}},h:function(n,s,d){if(s==="ho"){let _=n.getHours()%12;return _===0&&(_=12),d.ordinalNumber(_,{unit:"hour"})}return ys.h(n,s)},H:function(n,s,d){return s==="Ho"?d.ordinalNumber(n.getHours(),{unit:"hour"}):ys.H(n,s)},K:function(n,s,d){const _=n.getHours()%12;return s==="Ko"?d.ordinalNumber(_,{unit:"hour"}):mr(_,s.length)},k:function(n,s,d){let _=n.getHours();return _===0&&(_=24),s==="ko"?d.ordinalNumber(_,{unit:"hour"}):mr(_,s.length)},m:function(n,s,d){return s==="mo"?d.ordinalNumber(n.getMinutes(),{unit:"minute"}):ys.m(n,s)},s:function(n,s,d){return s==="so"?d.ordinalNumber(n.getSeconds(),{unit:"second"}):ys.s(n,s)},S:function(n,s){return ys.S(n,s)},X:function(n,s,d){const _=n.getTimezoneOffset();if(_===0)return"Z";switch(s){case"X":return uy(_);case"XXXX":case"XX":return ua(_);case"XXXXX":case"XXX":default:return ua(_,":")}},x:function(n,s,d){const _=n.getTimezoneOffset();switch(s){case"x":return uy(_);case"xxxx":case"xx":return ua(_);case"xxxxx":case"xxx":default:return ua(_,":")}},O:function(n,s,d){const _=n.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+cy(_,":");case"OOOO":default:return"GMT"+ua(_,":")}},z:function(n,s,d){const _=n.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+cy(_,":");case"zzzz":default:return"GMT"+ua(_,":")}},t:function(n,s,d){const _=Math.trunc(+n/1e3);return mr(_,s.length)},T:function(n,s,d){return mr(+n,s.length)}};function cy(n,s=""){const d=n>0?"-":"+",_=Math.abs(n),x=Math.trunc(_/60),P=_%60;return P===0?d+String(x):d+String(x)+s+mr(P,2)}function uy(n,s){return n%60===0?(n>0?"-":"+")+mr(Math.abs(n)/60,2):ua(n,s)}function ua(n,s=""){const d=n>0?"-":"+",_=Math.abs(n),x=mr(Math.trunc(_/60),2),P=mr(_%60,2);return d+x+s+P}const hy=(n,s)=>{switch(n){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},dv=(n,s)=>{switch(n){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},gz=(n,s)=>{const d=n.match(/(P+)(p+)?/)||[],_=d[1],x=d[2];if(!x)return hy(n,s);let P;switch(_){case"P":P=s.dateTime({width:"short"});break;case"PP":P=s.dateTime({width:"medium"});break;case"PPP":P=s.dateTime({width:"long"});break;case"PPPP":default:P=s.dateTime({width:"full"});break}return P.replace("{{date}}",hy(_,s)).replace("{{time}}",dv(x,s))},_z={p:dv,P:gz},yz=/^D+$/,vz=/^Y+$/,bz=["D","DD","YY","YYYY"];function xz(n){return yz.test(n)}function wz(n){return vz.test(n)}function Cz(n,s,d){const _=Tz(n,s,d);if(console.warn(_),bz.includes(n))throw new RangeError(_)}function Tz(n,s,d){const _=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${s}\`) for formatting ${_} to the input \`${d}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Sz=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,kz=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Pz=/^'([^]*?)'?$/,Mz=/''/g,Iz=/[a-zA-Z]/;function Ez(n,s,d){var V,H,Q,G;const _=Vd(),x=_.locale??hz,P=_.firstWeekContainsDate??((H=(V=_.locale)==null?void 0:V.options)==null?void 0:H.firstWeekContainsDate)??1,b=_.weekStartsOn??((G=(Q=_.locale)==null?void 0:Q.options)==null?void 0:G.weekStartsOn)??0,c=gi(n,d==null?void 0:d.in);if(!A5(c))throw new RangeError("Invalid time value");let z=s.match(kz).map(se=>{const Me=se[0];if(Me==="p"||Me==="P"){const rt=_z[Me];return rt(se,x.formatLong)}return se}).join("").match(Sz).map(se=>{if(se==="''")return{isToken:!1,value:"'"};const Me=se[0];if(Me==="'")return{isToken:!1,value:Az(se)};if(ly[Me])return{isToken:!0,value:se};if(Me.match(Iz))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Me+"`");return{isToken:!1,value:se}});x.localize.preprocessor&&(z=x.localize.preprocessor(c,z));const U={firstWeekContainsDate:P,weekStartsOn:b,locale:x};return z.map(se=>{if(!se.isToken)return se.value;const Me=se.value;(wz(Me)||xz(Me))&&Cz(Me,s,String(n));const rt=ly[Me[0]];return rt(c,Me,x.localize,U)}).join("")}function Az(n){const s=n.match(Pz);return s?s[1].replace(Mz,"'"):n}function mm(n,s){const d=()=>Un(s==null?void 0:s.in,NaN),x=Lz(n);let P;if(x.date){const U=Bz(x.date,2);P=Fz(U.restDateString,U.year)}if(!P||isNaN(+P))return d();const b=+P;let c=0,z;if(x.time&&(c=Oz(x.time),isNaN(c)))return d();if(x.timezone){if(z=$z(x.timezone),isNaN(z))return d()}else{const U=new Date(b+c),V=gi(0,s==null?void 0:s.in);return V.setFullYear(U.getUTCFullYear(),U.getUTCMonth(),U.getUTCDate()),V.setHours(U.getUTCHours(),U.getUTCMinutes(),U.getUTCSeconds(),U.getUTCMilliseconds()),V}return gi(b+c+z,s==null?void 0:s.in)}const id={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},zz=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Dz=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Rz=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Lz(n){const s={},d=n.split(id.dateTimeDelimiter);let _;if(d.length>2)return s;if(/:/.test(d[0])?_=d[0]:(s.date=d[0],_=d[1],id.timeZoneDelimiter.test(s.date)&&(s.date=n.split(id.timeZoneDelimiter)[0],_=n.substr(s.date.length,n.length))),_){const x=id.timezone.exec(_);x?(s.time=_.replace(x[1],""),s.timezone=x[1]):s.time=_}return s}function Bz(n,s){const d=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),_=n.match(d);if(!_)return{year:NaN,restDateString:""};const x=_[1]?parseInt(_[1]):null,P=_[2]?parseInt(_[2]):null;return{year:P===null?x:P*100,restDateString:n.slice((_[1]||_[2]).length)}}function Fz(n,s){if(s===null)return new Date(NaN);const d=n.match(zz);if(!d)return new Date(NaN);const _=!!d[4],x=nu(d[1]),P=nu(d[2])-1,b=nu(d[3]),c=nu(d[4]),z=nu(d[5])-1;if(_)return Zz(s,c,z)?jz(s,c,z):new Date(NaN);{const U=new Date(0);return!Vz(s,P,b)||!Uz(s,x)?new Date(NaN):(U.setUTCFullYear(s,P,Math.max(x,b)),U)}}function nu(n){return n?parseInt(n):1}function Oz(n){const s=n.match(Dz);if(!s)return NaN;const d=wp(s[1]),_=wp(s[2]),x=wp(s[3]);return Gz(d,_,x)?d*lv+_*av+x*1e3:NaN}function wp(n){return n&&parseFloat(n.replace(",","."))||0}function $z(n){if(n==="Z")return 0;const s=n.match(Rz);if(!s)return 0;const d=s[1]==="+"?-1:1,_=parseInt(s[2]),x=s[3]&&parseInt(s[3])||0;return qz(_,x)?d*(_*lv+x*av):NaN}function jz(n,s,d){const _=new Date(0);_.setUTCFullYear(n,0,4);const x=_.getUTCDay()||7,P=(s-1)*7+d+1-x;return _.setUTCDate(_.getUTCDate()+P),_}const Nz=[31,null,31,30,31,30,31,31,30,31,30,31];function fv(n){return n%400===0||n%4===0&&n%100!==0}function Vz(n,s,d){return s>=0&&s<=11&&d>=1&&d<=(Nz[s]||(fv(n)?29:28))}function Uz(n,s){return s>=1&&s<=(fv(n)?366:365)}function Zz(n,s,d){return s>=1&&s<=53&&d>=0&&d<=6}function Gz(n,s,d){return n===24?s===0&&d===0:d>=0&&d<60&&s>=0&&s<60&&n>=0&&n<25}function qz(n,s){return s>=0&&s<=59}const Wz=n=>{const s=new Date;return n.find(_=>new Date(_)>s)||null},Hz=n=>{const s=new Date;return n.reverse().find(_=>new Date(_)<s)||null},Xz=(n,s)=>{let d=n[n.length-1];switch(s){case"next_to_now":const _=Wz(n);_&&(d=_);break;case"previous_to_now":const x=Hz(n);x&&(d=x);break;case"latest_from_source":d=n[n.length-1];break;case"earliest_from_source":d=n[0];break}return d},Yz=n=>{const{layerConfig:s,id:d}=n,_=s.source.tiles[0].replace("{geostore_id}","");return{source:{id:d,type:"raster",tiles:[_]},layer:{id:d,type:"raster"}}},pv=(n,s)=>{const d=new URL(n),_=new URLSearchParams(d.search);return Object.keys(s).forEach(x=>{_.set(x,s[x])}),d.search=decodeURIComponent(_),decodeURIComponent(d.href)},Kz=(n,s,d)=>{const _=n.getSource(s);if(_&&_.tiles){const x=_.tiles[0],P=pv(x,d);n.getSource(s).tiles=[P],n.style.sourceCaches[s].clearTiles(),n.style.sourceCaches[s].update(n.transform),n.triggerRepaint()}},mv=n=>{let s;return n<=0?s=4:n>3&&n<21||n%10>3?s=0:s=n%10,n+["th","st","nd","rd",""][s]};function Jz(n){let s;typeof n=="string"?s=mm(n):s=n;const d=uv(s).getDate(),_=s.getDate();return _<=5?[1,"1-5th",1]:_<=10?[2,"6-10th",6]:_<=15?[3,"11-15th",11]:_<=20?[4,"16-20th",16]:_<=25?[4,"21-25th",21]:[6,`26-${mv(d)}`,26]}function Qz(n){let s;typeof n=="string"?s=mm(n):s=n;const d=uv(s).getDate(),_=s.getDate();return _<=10?[1,"1-10th",1]:_<=20?[2,"11-20th",11]:[3,`21-${mv(d)}`,21]}function eD(n,s,d){let _;typeof n=="string"?_=mm(n):_=n;let x=Ez(_,s);if(d){if(d==="pentadal"){const[P,b]=Jz(n);x=`${x} - P${P} ${b}`}else if(d==="dekadal"){const[P,b]=Qz(n);x=`${x} - D${P} ${b}`}}return x}function zu(n){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},zu(n)}function tD(n,s){if(!(n instanceof s))throw new TypeError("Cannot call a class as a function")}function rD(n,s){for(var d=0;d<s.length;d++){var _=s[d];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(n,iD(_.key),_)}}function oD(n,s,d){return s&&rD(n.prototype,s),Object.defineProperty(n,"prototype",{writable:!1}),n}function iD(n){var s=nD(n,"string");return zu(s)=="symbol"?s:s+""}function nD(n,s){if(zu(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(zu(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var sD=function(){function n(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};tD(this,n),this.element=s,this.listener=d}return oD(n,[{key:"bindScrollListener",value:function(){this.scrollableParents=m2(this.element);for(var d=0;d<this.scrollableParents.length;d++)this.scrollableParents[d].addEventListener("scroll",this.listener)}},{key:"unbindScrollListener",value:function(){if(this.scrollableParents)for(var d=0;d<this.scrollableParents.length;d++)this.scrollableParents[d].removeEventListener("scroll",this.listener)}},{key:"destroy",value:function(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}])}(),Cs={_loadedStyleNames:new Set,getLoadedStyleNames:function(){return this._loadedStyleNames},isStyleNameLoaded:function(s){return this._loadedStyleNames.has(s)},setLoadedStyleName:function(s){this._loadedStyleNames.add(s)},deleteLoadedStyleName:function(s){this._loadedStyleNames.delete(s)},clearLoadedStyleNames:function(){this._loadedStyleNames.clear()}};function Du(n){"@babel/helpers - typeof";return Du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Du(n)}function dy(n,s){return uD(n)||cD(n,s)||lD(n,s)||aD()}function aD(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lD(n,s){if(n){if(typeof n=="string")return fy(n,s);var d={}.toString.call(n).slice(8,-1);return d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set"?Array.from(n):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?fy(n,s):void 0}}function fy(n,s){(s==null||s>n.length)&&(s=n.length);for(var d=0,_=Array(s);d<s;d++)_[d]=n[d];return _}function cD(n,s){var d=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(d!=null){var _,x,P,b,c=[],z=!0,U=!1;try{if(P=(d=d.call(n)).next,s!==0)for(;!(z=(_=P.call(d)).done)&&(c.push(_.value),c.length!==s);z=!0);}catch(V){U=!0,x=V}finally{try{if(!z&&d.return!=null&&(b=d.return(),Object(b)!==b))return}finally{if(U)throw x}}return c}}function uD(n){if(Array.isArray(n))return n}function py(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);s&&(_=_.filter(function(x){return Object.getOwnPropertyDescriptor(n,x).enumerable})),d.push.apply(d,_)}return d}function ir(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?py(Object(d),!0).forEach(function(_){Np(n,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):py(Object(d)).forEach(function(_){Object.defineProperty(n,_,Object.getOwnPropertyDescriptor(d,_))})}return n}function Np(n,s,d){return(s=hD(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function hD(n){var s=dD(n,"string");return Du(s)=="symbol"?s:s+""}function dD(n,s){if(Du(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Du(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var Gt={_getMeta:function(){return[pn(arguments.length<=0?void 0:arguments[0])||arguments.length<=0?void 0:arguments[0],Oi(pn(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:arguments.length<=1?void 0:arguments[1])]},_getConfig:function(s,d){var _,x,P;return(_=(s==null||(x=s.instance)===null||x===void 0?void 0:x.$primevue)||(d==null||(P=d.ctx)===null||P===void 0||(P=P.appContext)===null||P===void 0||(P=P.config)===null||P===void 0||(P=P.globalProperties)===null||P===void 0?void 0:P.$primevue))===null||_===void 0?void 0:_.config},_getOptionValue:dm,_getPTValue:function(){var s,d,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,z=function(){var lt=Gt._getOptionValue.apply(Gt,arguments);return mi(lt)||Nd(lt)?{class:lt}:lt},U=((s=_.binding)===null||s===void 0||(s=s.value)===null||s===void 0?void 0:s.ptOptions)||((d=_.$primevueConfig)===null||d===void 0?void 0:d.ptOptions)||{},V=U.mergeSections,H=V===void 0?!0:V,Q=U.mergeProps,G=Q===void 0?!1:Q,se=c?Gt._useDefaultPT(_,_.defaultPT(),z,P,b):void 0,Me=Gt._usePT(_,Gt._getPT(x,_.$name),z,P,ir(ir({},b),{},{global:se||{}})),rt=Gt._getPTDatasets(_,P);return H||!H&&Me?G?Gt._mergeProps(_,G,se,Me,rt):ir(ir(ir({},se),Me),rt):ir(ir({},Me),rt)},_getPTDatasets:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",_="data-pc-";return ir(ir({},d==="root"&&Np({},"".concat(_,"name"),dn(s.$name))),{},Np({},"".concat(_,"section"),dn(d)))},_getPT:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",_=arguments.length>2?arguments[2]:void 0,x=function(b){var c,z=_?_(b):b,U=dn(d);return(c=z==null?void 0:z[U])!==null&&c!==void 0?c:z};return s&&Object.hasOwn(s,"_usept")?{_usept:s._usept,originalValue:x(s.originalValue),value:x(s.value)}:x(s)},_usePT:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1?arguments[1]:void 0,_=arguments.length>2?arguments[2]:void 0,x=arguments.length>3?arguments[3]:void 0,P=arguments.length>4?arguments[4]:void 0,b=function(rt){return _(rt,x,P)};if(d&&Object.hasOwn(d,"_usept")){var c,z=d._usept||((c=s.$primevueConfig)===null||c===void 0?void 0:c.ptOptions)||{},U=z.mergeSections,V=U===void 0?!0:U,H=z.mergeProps,Q=H===void 0?!1:H,G=b(d.originalValue),se=b(d.value);return G===void 0&&se===void 0?void 0:mi(se)?se:mi(G)?G:V||!V&&se?Q?Gt._mergeProps(s,Q,G,se):ir(ir({},G),se):se}return b(d)},_useDefaultPT:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=arguments.length>2?arguments[2]:void 0,x=arguments.length>3?arguments[3]:void 0,P=arguments.length>4?arguments[4]:void 0;return Gt._usePT(s,d,_,x,P)},_loadStyles:function(){var s,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=arguments.length>1?arguments[1]:void 0,x=arguments.length>2?arguments[2]:void 0,P=Gt._getConfig(_,x),b={nonce:P==null||(s=P.csp)===null||s===void 0?void 0:s.nonce};Gt._loadCoreStyles(d,b),Gt._loadThemeStyles(d,b),Gt._loadScopedThemeStyles(d,b),Gt._removeThemeListeners(d),d.$loadStyles=function(){return Gt._loadThemeStyles(d,b)},Gt._themeChangeListener(d.$loadStyles)},_loadCoreStyles:function(){var s,d,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},x=arguments.length>1?arguments[1]:void 0;if(!Cs.isStyleNameLoaded((s=_.$style)===null||s===void 0?void 0:s.name)&&(d=_.$style)!==null&&d!==void 0&&d.name){var P;Nr.loadCSS(x),(P=_.$style)===null||P===void 0||P.loadCSS(x),Cs.setLoadedStyleName(_.$style.name)}},_loadThemeStyles:function(){var s,d,_,x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},P=arguments.length>1?arguments[1]:void 0;if(!(x!=null&&x.isUnstyled()||(x==null||(s=x.theme)===null||s===void 0?void 0:s.call(x))==="none")){if(!gr.isStyleNameLoaded("common")){var b,c,z=((b=x.$style)===null||b===void 0||(c=b.getCommonTheme)===null||c===void 0?void 0:c.call(b))||{},U=z.primitive,V=z.semantic,H=z.global,Q=z.style;Nr.load(U==null?void 0:U.css,ir({name:"primitive-variables"},P)),Nr.load(V==null?void 0:V.css,ir({name:"semantic-variables"},P)),Nr.load(H==null?void 0:H.css,ir({name:"global-variables"},P)),Nr.loadStyle(ir({name:"global-style"},P),Q),gr.setLoadedStyleName("common")}if(!gr.isStyleNameLoaded((d=x.$style)===null||d===void 0?void 0:d.name)&&(_=x.$style)!==null&&_!==void 0&&_.name){var G,se,Me,rt,He=((G=x.$style)===null||G===void 0||(se=G.getDirectiveTheme)===null||se===void 0?void 0:se.call(G))||{},lt=He.css,st=He.style;(Me=x.$style)===null||Me===void 0||Me.load(lt,ir({name:"".concat(x.$style.name,"-variables")},P)),(rt=x.$style)===null||rt===void 0||rt.loadStyle(ir({name:"".concat(x.$style.name,"-style")},P),st),gr.setLoadedStyleName(x.$style.name)}if(!gr.isStyleNameLoaded("layer-order")){var Te,Ye,dt=(Te=x.$style)===null||Te===void 0||(Ye=Te.getLayerOrderThemeCSS)===null||Ye===void 0?void 0:Ye.call(Te);Nr.load(dt,ir({name:"layer-order",first:!0},P)),gr.setLoadedStyleName("layer-order")}}},_loadScopedThemeStyles:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1?arguments[1]:void 0,_=s.preset();if(_&&s.$attrSelector){var x,P,b,c=((x=s.$style)===null||x===void 0||(P=x.getPresetTheme)===null||P===void 0?void 0:P.call(x,_,"[".concat(s.$attrSelector,"]")))||{},z=c.css,U=(b=s.$style)===null||b===void 0?void 0:b.load(z,ir({name:"".concat(s.$attrSelector,"-").concat(s.$style.name)},d));s.scopedStyleEl=U.el}},_themeChangeListener:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};Cs.clearLoadedStyleNames(),Io.on("theme:change",s)},_removeThemeListeners:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Io.off("theme:change",s.$loadStyles)},_hook:function(s,d,_,x,P,b){var c,z,U="on".concat(t2(d)),V=Gt._getConfig(x,P),H=_==null?void 0:_.$instance,Q=Gt._usePT(H,Gt._getPT(x==null||(c=x.value)===null||c===void 0?void 0:c.pt,s),Gt._getOptionValue,"hooks.".concat(U)),G=Gt._useDefaultPT(H,V==null||(z=V.pt)===null||z===void 0||(z=z.directives)===null||z===void 0?void 0:z[s],Gt._getOptionValue,"hooks.".concat(U)),se={el:_,binding:x,vnode:P,prevVnode:b};Q==null||Q(H,se),G==null||G(H,se)},_mergeProps:function(){for(var s=arguments.length>1?arguments[1]:void 0,d=arguments.length,_=new Array(d>2?d-2:0),x=2;x<d;x++)_[x-2]=arguments[x];return hm(s)?s.apply(void 0,_):Ms.apply(void 0,_)},_extend:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=function(c,z,U,V,H){var Q,G,se,Me;z._$instances=z._$instances||{};var rt=Gt._getConfig(U,V),He=z._$instances[s]||{},lt=jd(He)?ir(ir({},d),d==null?void 0:d.methods):{};z._$instances[s]=ir(ir({},He),{},{$name:s,$host:z,$binding:U,$modifiers:U==null?void 0:U.modifiers,$value:U==null?void 0:U.value,$el:He.$el||z||void 0,$style:ir({classes:void 0,inlineStyles:void 0,load:function(){},loadCSS:function(){},loadStyle:function(){}},d==null?void 0:d.style),$primevueConfig:rt,$attrSelector:(Q=z.$pd)===null||Q===void 0||(Q=Q[s])===null||Q===void 0?void 0:Q.attrSelector,defaultPT:function(){return Gt._getPT(rt==null?void 0:rt.pt,void 0,function(Te){var Ye;return Te==null||(Ye=Te.directives)===null||Ye===void 0?void 0:Ye[s]})},isUnstyled:function(){var Te,Ye;return((Te=z._$instances[s])===null||Te===void 0||(Te=Te.$binding)===null||Te===void 0||(Te=Te.value)===null||Te===void 0?void 0:Te.unstyled)!==void 0?(Ye=z._$instances[s])===null||Ye===void 0||(Ye=Ye.$binding)===null||Ye===void 0||(Ye=Ye.value)===null||Ye===void 0?void 0:Ye.unstyled:rt==null?void 0:rt.unstyled},theme:function(){var Te;return(Te=z._$instances[s])===null||Te===void 0||(Te=Te.$primevueConfig)===null||Te===void 0?void 0:Te.theme},preset:function(){var Te;return(Te=z._$instances[s])===null||Te===void 0||(Te=Te.$binding)===null||Te===void 0||(Te=Te.value)===null||Te===void 0?void 0:Te.dt},ptm:function(){var Te,Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Gt._getPTValue(z._$instances[s],(Te=z._$instances[s])===null||Te===void 0||(Te=Te.$binding)===null||Te===void 0||(Te=Te.value)===null||Te===void 0?void 0:Te.pt,Ye,ir({},dt))},ptmo:function(){var Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ye=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",dt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Gt._getPTValue(z._$instances[s],Te,Ye,dt,!1)},cx:function(){var Te,Ye,dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",_t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(Te=z._$instances[s])!==null&&Te!==void 0&&Te.isUnstyled()?void 0:Gt._getOptionValue((Ye=z._$instances[s])===null||Ye===void 0||(Ye=Ye.$style)===null||Ye===void 0?void 0:Ye.classes,dt,ir({},_t))},sx:function(){var Te,Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,_t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return dt?Gt._getOptionValue((Te=z._$instances[s])===null||Te===void 0||(Te=Te.$style)===null||Te===void 0?void 0:Te.inlineStyles,Ye,ir({},_t)):void 0}},lt),z.$instance=z._$instances[s],(G=(se=z.$instance)[c])===null||G===void 0||G.call(se,z,U,V,H),z["$".concat(s)]=z.$instance,Gt._hook(s,c,z,U,V,H),z.$pd||(z.$pd={}),z.$pd[s]=ir(ir({},(Me=z.$pd)===null||Me===void 0?void 0:Me[s]),{},{name:s,instance:z._$instances[s]})},x=function(c){var z,U,V,H=c._$instances[s],Q=H==null?void 0:H.watch,G=function(rt){var He,lt=rt.newValue,st=rt.oldValue;return Q==null||(He=Q.config)===null||He===void 0?void 0:He.call(H,lt,st)},se=function(rt){var He,lt=rt.newValue,st=rt.oldValue;return Q==null||(He=Q["config.ripple"])===null||He===void 0?void 0:He.call(H,lt,st)};H.$watchersCallback={config:G,"config.ripple":se},Q==null||(z=Q.config)===null||z===void 0||z.call(H,H==null?void 0:H.$primevueConfig),Ts.on("config:change",G),Q==null||(U=Q["config.ripple"])===null||U===void 0||U.call(H,H==null||(V=H.$primevueConfig)===null||V===void 0?void 0:V.ripple),Ts.on("config:ripple:change",se)},P=function(c){var z=c._$instances[s].$watchersCallback;z&&(Ts.off("config:change",z.config),Ts.off("config:ripple:change",z["config.ripple"]))};return{created:function(c,z,U,V){c.$pd||(c.$pd={}),c.$pd[s]={name:s,attrSelector:_2("pd")},_("created",c,z,U,V)},beforeMount:function(c,z,U,V){var H;Gt._loadStyles((H=c.$pd[s])===null||H===void 0?void 0:H.instance,z,U),_("beforeMount",c,z,U,V),x(c)},mounted:function(c,z,U,V){var H;Gt._loadStyles((H=c.$pd[s])===null||H===void 0?void 0:H.instance,z,U),_("mounted",c,z,U,V)},beforeUpdate:function(c,z,U,V){_("beforeUpdate",c,z,U,V)},updated:function(c,z,U,V){var H;Gt._loadStyles((H=c.$pd[s])===null||H===void 0?void 0:H.instance,z,U),_("updated",c,z,U,V)},beforeUnmount:function(c,z,U,V){var H;P(c),Gt._removeThemeListeners((H=c.$pd[s])===null||H===void 0?void 0:H.instance),_("beforeUnmount",c,z,U,V)},unmounted:function(c,z,U,V){var H;(H=c.$pd[s])===null||H===void 0||(H=H.instance)===null||H===void 0||(H=H.scopedStyleEl)===null||H===void 0||(H=H.value)===null||H===void 0||H.remove(),_("unmounted",c,z,U,V)}}},extend:function(){var s=Gt._getMeta.apply(Gt,arguments),d=dy(s,2),_=d[0],x=d[1];return ir({extend:function(){var b=Gt._getMeta.apply(Gt,arguments),c=dy(b,2),z=c[0],U=c[1];return Gt.extend(z,ir(ir(ir({},x),x==null?void 0:x.methods),U))}},Gt._extend(_,x))}},fD=Nr.extend({name:"focustrap-directive"}),pD=Gt.extend({style:fD});function Ru(n){"@babel/helpers - typeof";return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Ru(n)}function my(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);s&&(_=_.filter(function(x){return Object.getOwnPropertyDescriptor(n,x).enumerable})),d.push.apply(d,_)}return d}function gy(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?my(Object(d),!0).forEach(function(_){mD(n,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):my(Object(d)).forEach(function(_){Object.defineProperty(n,_,Object.getOwnPropertyDescriptor(d,_))})}return n}function mD(n,s,d){return(s=gD(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function gD(n){var s=_D(n,"string");return Ru(s)=="symbol"?s:s+""}function _D(n,s){if(Ru(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Ru(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var yD=pD.extend("focustrap",{mounted:function(s,d){var _=d.value||{},x=_.disabled;x||(this.createHiddenFocusableElements(s,d),this.bind(s,d),this.autoElementFocus(s,d)),s.setAttribute("data-pd-focustrap",!0),this.$el=s},updated:function(s,d){var _=d.value||{},x=_.disabled;x&&this.unbind(s)},unmounted:function(s){this.unbind(s)},methods:{getComputedSelector:function(s){return':not(.p-hidden-focusable):not([data-p-hidden-focusable="true"])'.concat(s??"")},bind:function(s,d){var _=this,x=d.value||{},P=x.onFocusIn,b=x.onFocusOut;s.$_pfocustrap_mutationobserver=new MutationObserver(function(c){c.forEach(function(z){if(z.type==="childList"&&!s.contains(document.activeElement)){var U=function(H){var Q=q_(H)?q_(H,_.getComputedSelector(s.$_pfocustrap_focusableselector))?H:ru(s,_.getComputedSelector(s.$_pfocustrap_focusableselector)):ru(H);return Rr(Q)?Q:H.nextSibling&&U(H.nextSibling)};lu(U(z.nextSibling))}})}),s.$_pfocustrap_mutationobserver.disconnect(),s.$_pfocustrap_mutationobserver.observe(s,{childList:!0}),s.$_pfocustrap_focusinlistener=function(c){return P&&P(c)},s.$_pfocustrap_focusoutlistener=function(c){return b&&b(c)},s.addEventListener("focusin",s.$_pfocustrap_focusinlistener),s.addEventListener("focusout",s.$_pfocustrap_focusoutlistener)},unbind:function(s){s.$_pfocustrap_mutationobserver&&s.$_pfocustrap_mutationobserver.disconnect(),s.$_pfocustrap_focusinlistener&&s.removeEventListener("focusin",s.$_pfocustrap_focusinlistener)&&(s.$_pfocustrap_focusinlistener=null),s.$_pfocustrap_focusoutlistener&&s.removeEventListener("focusout",s.$_pfocustrap_focusoutlistener)&&(s.$_pfocustrap_focusoutlistener=null)},autoFocus:function(s){this.autoElementFocus(this.$el,{value:gy(gy({},s),{},{autoFocus:!0})})},autoElementFocus:function(s,d){var _=d.value||{},x=_.autoFocusSelector,P=x===void 0?"":x,b=_.firstFocusableSelector,c=b===void 0?"":b,z=_.autoFocus,U=z===void 0?!1:z,V=ru(s,"[autofocus]".concat(this.getComputedSelector(P)));U&&!V&&(V=ru(s,this.getComputedSelector(c))),lu(V)},onFirstHiddenElementFocus:function(s){var d,_=s.currentTarget,x=s.relatedTarget,P=x===_.$_pfocustrap_lasthiddenfocusableelement||!((d=this.$el)!==null&&d!==void 0&&d.contains(x))?ru(_.parentElement,this.getComputedSelector(_.$_pfocustrap_focusableselector)):_.$_pfocustrap_lasthiddenfocusableelement;lu(P)},onLastHiddenElementFocus:function(s){var d,_=s.currentTarget,x=s.relatedTarget,P=x===_.$_pfocustrap_firsthiddenfocusableelement||!((d=this.$el)!==null&&d!==void 0&&d.contains(x))?f2(_.parentElement,this.getComputedSelector(_.$_pfocustrap_focusableselector)):_.$_pfocustrap_firsthiddenfocusableelement;lu(P)},createHiddenFocusableElements:function(s,d){var _=this,x=d.value||{},P=x.tabIndex,b=P===void 0?0:P,c=x.firstFocusableSelector,z=c===void 0?"":c,U=x.lastFocusableSelector,V=U===void 0?"":U,H=function(Me){return H0("span",{class:"p-hidden-accessible p-hidden-focusable",tabIndex:b,role:"presentation","aria-hidden":!0,"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0,onFocus:Me==null?void 0:Me.bind(_)})},Q=H(this.onFirstHiddenElementFocus),G=H(this.onLastHiddenElementFocus);Q.$_pfocustrap_lasthiddenfocusableelement=G,Q.$_pfocustrap_focusableselector=z,Q.setAttribute("data-pc-section","firstfocusableelement"),G.$_pfocustrap_firsthiddenfocusableelement=Q,G.$_pfocustrap_focusableselector=V,G.setAttribute("data-pc-section","lastfocusableelement"),s.prepend(Q),s.append(G)}}}),nd=fm(),gv={name:"Portal",props:{appendTo:{type:[String,Object],default:"body"},disabled:{type:Boolean,default:!1}},data:function(){return{mounted:!1}},mounted:function(){this.mounted=pm()},computed:{inline:function(){return this.disabled||this.appendTo==="self"}}};function vD(n,s,d,_,x,P){return P.inline?yd(n.$slots,"default",{key:0}):x.mounted?(Vo(),Is(Jx,{key:1,to:d.appendTo},[yd(n.$slots,"default")],8,["to"])):Fd("",!0)}gv.render=vD;var bD=({dt:n})=>`
.p-ink {
    display: block;
    position: absolute;
    background: ${n("ripple.background")};
    border-radius: 100%;
    transform: scale(0);
    pointer-events: none;
}

.p-ink-active {
    animation: ripple 0.4s linear;
}

@keyframes ripple {
    100% {
        opacity: 0;
        transform: scale(2.5);
    }
}
`,xD={root:"p-ink"},wD=Nr.extend({name:"ripple-directive",style:bD,classes:xD}),CD=Gt.extend({style:wD});function Lu(n){"@babel/helpers - typeof";return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Lu(n)}function TD(n){return MD(n)||PD(n)||kD(n)||SD()}function SD(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kD(n,s){if(n){if(typeof n=="string")return Vp(n,s);var d={}.toString.call(n).slice(8,-1);return d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set"?Array.from(n):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?Vp(n,s):void 0}}function PD(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function MD(n){if(Array.isArray(n))return Vp(n)}function Vp(n,s){(s==null||s>n.length)&&(s=n.length);for(var d=0,_=Array(s);d<s;d++)_[d]=n[d];return _}function _y(n,s,d){return(s=ID(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function ID(n){var s=ED(n,"string");return Lu(s)=="symbol"?s:s+""}function ED(n,s){if(Lu(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Lu(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var AD=CD.extend("ripple",{watch:{"config.ripple":function(s){s?(this.createRipple(this.$host),this.bindEvents(this.$host),this.$host.setAttribute("data-pd-ripple",!0),this.$host.style.overflow="hidden",this.$host.style.position="relative"):(this.remove(this.$host),this.$host.removeAttribute("data-pd-ripple"))}},unmounted:function(s){this.remove(s)},timeout:void 0,methods:{bindEvents:function(s){s.addEventListener("mousedown",this.onMouseDown.bind(this))},unbindEvents:function(s){s.removeEventListener("mousedown",this.onMouseDown.bind(this))},createRipple:function(s){var d=this.getInk(s);d||(d=H0("span",_y(_y({role:"presentation","aria-hidden":!0,"data-p-ink":!0,"data-p-ink-active":!1,class:!this.isUnstyled()&&this.cx("root"),onAnimationEnd:this.onAnimationEnd.bind(this)},this.$attrSelector,""),"p-bind",this.ptm("root"))),s.appendChild(d),this.$el=d)},remove:function(s){var d=this.getInk(s);d&&(this.$host.style.overflow="",this.$host.style.position="",this.unbindEvents(s),d.removeEventListener("animationend",this.onAnimationEnd),d.remove())},onMouseDown:function(s){var d=this,_=s.currentTarget,x=this.getInk(_);if(!(!x||getComputedStyle(x,null).display==="none")){if(!this.isUnstyled()&&_p(x,"p-ink-active"),x.setAttribute("data-p-ink-active","false"),!Z_(x)&&!G_(x)){var P=Math.max(c2(_),p2(_));x.style.height=P+"px",x.style.width=P+"px"}var b=Op(_),c=s.pageX-b.left+document.body.scrollTop-G_(x)/2,z=s.pageY-b.top+document.body.scrollLeft-Z_(x)/2;x.style.top=z+"px",x.style.left=c+"px",!this.isUnstyled()&&q0(x,"p-ink-active"),x.setAttribute("data-p-ink-active","true"),this.timeout=setTimeout(function(){x&&(!d.isUnstyled()&&_p(x,"p-ink-active"),x.setAttribute("data-p-ink-active","false"))},401)}},onAnimationEnd:function(s){this.timeout&&clearTimeout(this.timeout),!this.isUnstyled()&&_p(s.currentTarget,"p-ink-active"),s.currentTarget.setAttribute("data-p-ink-active","false")},getInk:function(s){return s&&s.children?TD(s.children).find(function(d){return d2(d,"data-pc-name")==="ripple"}):void 0}}});function zD(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"pc",s=r1();return"".concat(n).concat(s.replace("v-","").replaceAll("-","_"))}var yy=Nr.extend({name:"common"});function Bu(n){"@babel/helpers - typeof";return Bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Bu(n)}function DD(n){return vv(n)||RD(n)||yv(n)||_v()}function RD(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function su(n,s){return vv(n)||LD(n,s)||yv(n,s)||_v()}function _v(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yv(n,s){if(n){if(typeof n=="string")return vy(n,s);var d={}.toString.call(n).slice(8,-1);return d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set"?Array.from(n):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?vy(n,s):void 0}}function vy(n,s){(s==null||s>n.length)&&(s=n.length);for(var d=0,_=Array(s);d<s;d++)_[d]=n[d];return _}function LD(n,s){var d=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(d!=null){var _,x,P,b,c=[],z=!0,U=!1;try{if(P=(d=d.call(n)).next,s===0){if(Object(d)!==d)return;z=!1}else for(;!(z=(_=P.call(d)).done)&&(c.push(_.value),c.length!==s);z=!0);}catch(V){U=!0,x=V}finally{try{if(!z&&d.return!=null&&(b=d.return(),Object(b)!==b))return}finally{if(U)throw x}}return c}}function vv(n){if(Array.isArray(n))return n}function by(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);s&&(_=_.filter(function(x){return Object.getOwnPropertyDescriptor(n,x).enumerable})),d.push.apply(d,_)}return d}function tr(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?by(Object(d),!0).forEach(function(_){cu(n,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):by(Object(d)).forEach(function(_){Object.defineProperty(n,_,Object.getOwnPropertyDescriptor(d,_))})}return n}function cu(n,s,d){return(s=BD(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function BD(n){var s=FD(n,"string");return Bu(s)=="symbol"?s:s+""}function FD(n,s){if(Bu(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Bu(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var OD={name:"BaseComponent",props:{pt:{type:Object,default:void 0},ptOptions:{type:Object,default:void 0},unstyled:{type:Boolean,default:void 0},dt:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0}},watch:{isUnstyled:{immediate:!0,handler:function(s){Io.off("theme:change",this._loadCoreStyles),s||(this._loadCoreStyles(),this._themeChangeListener(this._loadCoreStyles))}},dt:{immediate:!0,handler:function(s,d){var _=this;Io.off("theme:change",this._themeScopedListener),s?(this._loadScopedThemeStyles(s),this._themeScopedListener=function(){return _._loadScopedThemeStyles(s)},this._themeChangeListener(this._themeScopedListener)):this._unloadScopedThemeStyles()}}},scopedStyleEl:void 0,rootEl:void 0,uid:void 0,$attrSelector:void 0,beforeCreate:function(){var s,d,_,x,P,b,c,z,U,V,H,Q=(s=this.pt)===null||s===void 0?void 0:s._usept,G=Q?(d=this.pt)===null||d===void 0||(d=d.originalValue)===null||d===void 0?void 0:d[this.$.type.name]:void 0,se=Q?(_=this.pt)===null||_===void 0||(_=_.value)===null||_===void 0?void 0:_[this.$.type.name]:this.pt;(x=se||G)===null||x===void 0||(x=x.hooks)===null||x===void 0||(P=x.onBeforeCreate)===null||P===void 0||P.call(x);var Me=(b=this.$primevueConfig)===null||b===void 0||(b=b.pt)===null||b===void 0?void 0:b._usept,rt=Me?(c=this.$primevue)===null||c===void 0||(c=c.config)===null||c===void 0||(c=c.pt)===null||c===void 0?void 0:c.originalValue:void 0,He=Me?(z=this.$primevue)===null||z===void 0||(z=z.config)===null||z===void 0||(z=z.pt)===null||z===void 0?void 0:z.value:(U=this.$primevue)===null||U===void 0||(U=U.config)===null||U===void 0?void 0:U.pt;(V=He||rt)===null||V===void 0||(V=V[this.$.type.name])===null||V===void 0||(V=V.hooks)===null||V===void 0||(H=V.onBeforeCreate)===null||H===void 0||H.call(V),this.$attrSelector=zD(),this.uid=this.$attrs.id||this.$attrSelector.replace("pc","pv_id_")},created:function(){this._hook("onCreated")},beforeMount:function(){var s;this.rootEl=X0(ga(this.$el)?this.$el:(s=this.$el)===null||s===void 0?void 0:s.parentElement,"[".concat(this.$attrSelector,"]")),this.rootEl&&(this.rootEl.$pc=tr({name:this.$.type.name,attrSelector:this.$attrSelector},this.$params)),this._loadStyles(),this._hook("onBeforeMount")},mounted:function(){this._hook("onMounted")},beforeUpdate:function(){this._hook("onBeforeUpdate")},updated:function(){this._hook("onUpdated")},beforeUnmount:function(){this._hook("onBeforeUnmount")},unmounted:function(){this._removeThemeListeners(),this._unloadScopedThemeStyles(),this._hook("onUnmounted")},methods:{_hook:function(s){if(!this.$options.hostName){var d=this._usePT(this._getPT(this.pt,this.$.type.name),this._getOptionValue,"hooks.".concat(s)),_=this._useDefaultPT(this._getOptionValue,"hooks.".concat(s));d==null||d(),_==null||_()}},_mergeProps:function(s){for(var d=arguments.length,_=new Array(d>1?d-1:0),x=1;x<d;x++)_[x-1]=arguments[x];return hm(s)?s.apply(void 0,_):Ms.apply(void 0,_)},_load:function(){Cs.isStyleNameLoaded("base")||(Nr.loadCSS(this.$styleOptions),this._loadGlobalStyles(),Cs.setLoadedStyleName("base")),this._loadThemeStyles()},_loadStyles:function(){this._load(),this._themeChangeListener(this._load)},_loadCoreStyles:function(){var s,d;!Cs.isStyleNameLoaded((s=this.$style)===null||s===void 0?void 0:s.name)&&(d=this.$style)!==null&&d!==void 0&&d.name&&(yy.loadCSS(this.$styleOptions),this.$options.style&&this.$style.loadCSS(this.$styleOptions),Cs.setLoadedStyleName(this.$style.name))},_loadGlobalStyles:function(){var s=this._useGlobalPT(this._getOptionValue,"global.css",this.$params);Rr(s)&&Nr.load(s,tr({name:"global"},this.$styleOptions))},_loadThemeStyles:function(){var s,d;if(!(this.isUnstyled||this.$theme==="none")){if(!gr.isStyleNameLoaded("common")){var _,x,P=((_=this.$style)===null||_===void 0||(x=_.getCommonTheme)===null||x===void 0?void 0:x.call(_))||{},b=P.primitive,c=P.semantic,z=P.global,U=P.style;Nr.load(b==null?void 0:b.css,tr({name:"primitive-variables"},this.$styleOptions)),Nr.load(c==null?void 0:c.css,tr({name:"semantic-variables"},this.$styleOptions)),Nr.load(z==null?void 0:z.css,tr({name:"global-variables"},this.$styleOptions)),Nr.loadStyle(tr({name:"global-style"},this.$styleOptions),U),gr.setLoadedStyleName("common")}if(!gr.isStyleNameLoaded((s=this.$style)===null||s===void 0?void 0:s.name)&&(d=this.$style)!==null&&d!==void 0&&d.name){var V,H,Q,G,se=((V=this.$style)===null||V===void 0||(H=V.getComponentTheme)===null||H===void 0?void 0:H.call(V))||{},Me=se.css,rt=se.style;(Q=this.$style)===null||Q===void 0||Q.load(Me,tr({name:"".concat(this.$style.name,"-variables")},this.$styleOptions)),(G=this.$style)===null||G===void 0||G.loadStyle(tr({name:"".concat(this.$style.name,"-style")},this.$styleOptions),rt),gr.setLoadedStyleName(this.$style.name)}if(!gr.isStyleNameLoaded("layer-order")){var He,lt,st=(He=this.$style)===null||He===void 0||(lt=He.getLayerOrderThemeCSS)===null||lt===void 0?void 0:lt.call(He);Nr.load(st,tr({name:"layer-order",first:!0},this.$styleOptions)),gr.setLoadedStyleName("layer-order")}}},_loadScopedThemeStyles:function(s){var d,_,x,P=((d=this.$style)===null||d===void 0||(_=d.getPresetTheme)===null||_===void 0?void 0:_.call(d,s,"[".concat(this.$attrSelector,"]")))||{},b=P.css,c=(x=this.$style)===null||x===void 0?void 0:x.load(b,tr({name:"".concat(this.$attrSelector,"-").concat(this.$style.name)},this.$styleOptions));this.scopedStyleEl=c.el},_unloadScopedThemeStyles:function(){var s;(s=this.scopedStyleEl)===null||s===void 0||(s=s.value)===null||s===void 0||s.remove()},_themeChangeListener:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};Cs.clearLoadedStyleNames(),Io.on("theme:change",s)},_removeThemeListeners:function(){Io.off("theme:change",this._loadCoreStyles),Io.off("theme:change",this._load),Io.off("theme:change",this._themeScopedListener)},_getHostInstance:function(s){return s?this.$options.hostName?s.$.type.name===this.$options.hostName?s:this._getHostInstance(s.$parentInstance):s.$parentInstance:void 0},_getPropValue:function(s){var d;return this[s]||((d=this._getHostInstance(this))===null||d===void 0?void 0:d[s])},_getOptionValue:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return dm(s,d,_)},_getPTValue:function(){var s,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,b=/./g.test(_)&&!!x[_.split(".")[0]],c=this._getPropValue("ptOptions")||((s=this.$primevueConfig)===null||s===void 0?void 0:s.ptOptions)||{},z=c.mergeSections,U=z===void 0?!0:z,V=c.mergeProps,H=V===void 0?!1:V,Q=P?b?this._useGlobalPT(this._getPTClassValue,_,x):this._useDefaultPT(this._getPTClassValue,_,x):void 0,G=b?void 0:this._getPTSelf(d,this._getPTClassValue,_,tr(tr({},x),{},{global:Q||{}})),se=this._getPTDatasets(_);return U||!U&&G?H?this._mergeProps(H,Q,G,se):tr(tr(tr({},Q),G),se):tr(tr({},G),se)},_getPTSelf:function(){for(var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length,_=new Array(d>1?d-1:0),x=1;x<d;x++)_[x-1]=arguments[x];return Ms(this._usePT.apply(this,[this._getPT(s,this.$name)].concat(_)),this._usePT.apply(this,[this.$_attrsPT].concat(_)))},_getPTDatasets:function(){var s,d,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",x="data-pc-",P=_==="root"&&Rr((s=this.pt)===null||s===void 0?void 0:s["data-pc-section"]);return _!=="transition"&&tr(tr({},_==="root"&&tr(tr(cu({},"".concat(x,"name"),dn(P?(d=this.pt)===null||d===void 0?void 0:d["data-pc-section"]:this.$.type.name)),P&&cu({},"".concat(x,"extend"),dn(this.$.type.name))),{},cu({},"".concat(this.$attrSelector),""))),{},cu({},"".concat(x,"section"),dn(_)))},_getPTClassValue:function(){var s=this._getOptionValue.apply(this,arguments);return mi(s)||Nd(s)?{class:s}:s},_getPT:function(s){var d=this,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",x=arguments.length>2?arguments[2]:void 0,P=function(c){var z,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,V=x?x(c):c,H=dn(_),Q=dn(d.$name);return(z=U?H!==Q?V==null?void 0:V[H]:void 0:V==null?void 0:V[H])!==null&&z!==void 0?z:V};return s!=null&&s.hasOwnProperty("_usept")?{_usept:s._usept,originalValue:P(s.originalValue),value:P(s.value)}:P(s,!0)},_usePT:function(s,d,_,x){var P=function(Me){return d(Me,_,x)};if(s!=null&&s.hasOwnProperty("_usept")){var b,c=s._usept||((b=this.$primevueConfig)===null||b===void 0?void 0:b.ptOptions)||{},z=c.mergeSections,U=z===void 0?!0:z,V=c.mergeProps,H=V===void 0?!1:V,Q=P(s.originalValue),G=P(s.value);return Q===void 0&&G===void 0?void 0:mi(G)?G:mi(Q)?Q:U||!U&&G?H?this._mergeProps(H,Q,G):tr(tr({},Q),G):G}return P(s)},_useGlobalPT:function(s,d,_){return this._usePT(this.globalPT,s,d,_)},_useDefaultPT:function(s,d,_){return this._usePT(this.defaultPT,s,d,_)},ptm:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._getPTValue(this.pt,s,tr(tr({},this.$params),d))},ptmi:function(){var s,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x=Ms(this.$_attrsWithoutPT,this.ptm(d,_));return x!=null&&x.hasOwnProperty("id")&&((s=x.id)!==null&&s!==void 0||(x.id=this.$id)),x},ptmo:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._getPTValue(s,d,tr({instance:this},_),!1)},cx:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isUnstyled?void 0:this._getOptionValue(this.$style.classes,s,tr(tr({},this.$params),d))},sx:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(d){var x=this._getOptionValue(this.$style.inlineStyles,s,tr(tr({},this.$params),_)),P=this._getOptionValue(yy.inlineStyles,s,tr(tr({},this.$params),_));return[P,x]}}},computed:{globalPT:function(){var s,d=this;return this._getPT((s=this.$primevueConfig)===null||s===void 0?void 0:s.pt,void 0,function(_){return Oi(_,{instance:d})})},defaultPT:function(){var s,d=this;return this._getPT((s=this.$primevueConfig)===null||s===void 0?void 0:s.pt,void 0,function(_){return d._getOptionValue(_,d.$name,tr({},d.$params))||Oi(_,tr({},d.$params))})},isUnstyled:function(){var s;return this.unstyled!==void 0?this.unstyled:(s=this.$primevueConfig)===null||s===void 0?void 0:s.unstyled},$id:function(){return this.$attrs.id||this.uid},$inProps:function(){var s,d=Object.keys(((s=this.$.vnode)===null||s===void 0?void 0:s.props)||{});return Object.fromEntries(Object.entries(this.$props).filter(function(_){var x=su(_,1),P=x[0];return d==null?void 0:d.includes(P)}))},$theme:function(){var s;return(s=this.$primevueConfig)===null||s===void 0?void 0:s.theme},$style:function(){return tr(tr({classes:void 0,inlineStyles:void 0,load:function(){},loadCSS:function(){},loadStyle:function(){}},(this._getHostInstance(this)||{}).$style),this.$options.style)},$styleOptions:function(){var s;return{nonce:(s=this.$primevueConfig)===null||s===void 0||(s=s.csp)===null||s===void 0?void 0:s.nonce}},$primevueConfig:function(){var s;return(s=this.$primevue)===null||s===void 0?void 0:s.config},$name:function(){return this.$options.hostName||this.$.type.name},$params:function(){var s=this._getHostInstance(this)||this.$parent;return{instance:this,props:this.$props,state:this.$data,attrs:this.$attrs,parent:{instance:s,props:s==null?void 0:s.$props,state:s==null?void 0:s.$data,attrs:s==null?void 0:s.$attrs}}},$_attrsPT:function(){return Object.entries(this.$attrs||{}).filter(function(s){var d=su(s,1),_=d[0];return _==null?void 0:_.startsWith("pt:")}).reduce(function(s,d){var _=su(d,2),x=_[0],P=_[1],b=x.split(":"),c=DD(b),z=c.slice(1);return z==null||z.reduce(function(U,V,H,Q){return!U[V]&&(U[V]=H===Q.length-1?P:{}),U[V]},s),s},{})},$_attrsWithoutPT:function(){return Object.entries(this.$attrs||{}).filter(function(s){var d=su(s,1),_=d[0];return!(_!=null&&_.startsWith("pt:"))}).reduce(function(s,d){var _=su(d,2),x=_[0],P=_[1];return s[x]=P,s},{})}}},$D=({dt:n})=>`
.p-popover {
    margin-block-start: ${n("popover.gutter")};
    background: ${n("popover.background")};
    color: ${n("popover.color")};
    border: 1px solid ${n("popover.border.color")};
    border-radius: ${n("popover.border.radius")};
    box-shadow: ${n("popover.shadow")};
}

.p-popover-content {
    padding: ${n("popover.content.padding")};
}

.p-popover-flipped {
    margin-block-start: calc(${n("popover.gutter")} * -1);
    margin-block-end: ${n("popover.gutter")};
}

.p-popover-enter-from {
    opacity: 0;
    transform: scaleY(0.8);
}

.p-popover-leave-to {
    opacity: 0;
}

.p-popover-enter-active {
    transition: transform 0.12s cubic-bezier(0, 0, 0.2, 1), opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
}

.p-popover-leave-active {
    transition: opacity 0.1s linear;
}

.p-popover:after,
.p-popover:before {
    bottom: 100%;
    left: calc(${n("popover.arrow.offset")} + ${n("popover.arrow.left")});
    content: " ";
    height: 0;
    width: 0;
    position: absolute;
    pointer-events: none;
}

.p-popover:after {
    border-width: calc(${n("popover.gutter")} - 2px);
    margin-left: calc(-1 * (${n("popover.gutter")} - 2px));
    border-style: solid;
    border-color: transparent;
    border-bottom-color: ${n("popover.background")};
}

.p-popover:before {
    border-width: ${n("popover.gutter")};
    margin-left: calc(-1 * ${n("popover.gutter")});
    border-style: solid;
    border-color: transparent;
    border-bottom-color: ${n("popover.border.color")};
}

.p-popover-flipped:after,
.p-popover-flipped:before {
    bottom: auto;
    top: 100%;
}

.p-popover.p-popover-flipped:after {
    border-bottom-color: transparent;
    border-top-color: ${n("popover.background")};
}

.p-popover.p-popover-flipped:before {
    border-bottom-color: transparent;
    border-top-color: ${n("popover.border.color")};
}
`,jD={root:"p-popover p-component",content:"p-popover-content"},ND=Nr.extend({name:"popover",style:$D,classes:jD}),VD={name:"BasePopover",extends:OD,props:{dismissable:{type:Boolean,default:!0},appendTo:{type:[String,Object],default:"body"},baseZIndex:{type:Number,default:0},autoZIndex:{type:Boolean,default:!0},breakpoints:{type:Object,default:null},closeOnEscape:{type:Boolean,default:!0}},style:ND,provide:function(){return{$pcPopover:this,$parentInstance:this}}},bv={name:"Popover",extends:VD,inheritAttrs:!1,emits:["show","hide"],data:function(){return{visible:!1}},watch:{dismissable:{immediate:!0,handler:function(s){s?this.bindOutsideClickListener():this.unbindOutsideClickListener()}}},selfClick:!1,target:null,eventTarget:null,outsideClickListener:null,scrollHandler:null,resizeListener:null,container:null,styleElement:null,overlayEventListener:null,documentKeydownListener:null,beforeUnmount:function(){this.dismissable&&this.unbindOutsideClickListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.destroyStyle(),this.unbindResizeListener(),this.target=null,this.container&&this.autoZIndex&&yp.clear(this.container),this.overlayEventListener&&(nd.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null),this.container=null},mounted:function(){this.breakpoints&&this.createStyle()},methods:{toggle:function(s,d){this.visible?this.hide():this.show(s,d)},show:function(s,d){this.visible=!0,this.eventTarget=s.currentTarget,this.target=d||s.currentTarget},hide:function(){this.visible=!1},onContentClick:function(){this.selfClick=!0},onEnter:function(s){var d=this;l2(s,{position:"absolute",top:"0",left:"0"}),this.alignOverlay(),this.dismissable&&this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.autoZIndex&&yp.set("overlay",s,this.baseZIndex+this.$primevue.config.zIndex.overlay),this.overlayEventListener=function(_){d.container.contains(_.target)&&(d.selfClick=!0)},this.focus(),nd.on("overlay-click",this.overlayEventListener),this.$emit("show"),this.closeOnEscape&&this.bindDocumentKeyDownListener()},onLeave:function(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.unbindDocumentKeyDownListener(),nd.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null,this.$emit("hide")},onAfterLeave:function(s){this.autoZIndex&&yp.clear(s)},alignOverlay:function(){a2(this.container,this.target,!1);var s=Op(this.container),d=Op(this.target),_=0;s.left<d.left&&(_=d.left-s.left),this.container.style.setProperty(P2("popover.arrow.left").name,"".concat(_,"px")),s.top<d.top&&(this.container.setAttribute("data-p-popover-flipped","true"),!this.isUnstyled&&q0(this.container,"p-popover-flipped"))},onContentKeydown:function(s){s.code==="Escape"&&this.closeOnEscape&&(this.hide(),lu(this.target))},onButtonKeydown:function(s){switch(s.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":s.preventDefault()}},focus:function(){var s=this.container.querySelector("[autofocus]");s&&s.focus()},onKeyDown:function(s){s.code==="Escape"&&this.closeOnEscape&&(this.visible=!1)},bindDocumentKeyDownListener:function(){this.documentKeydownListener||(this.documentKeydownListener=this.onKeyDown.bind(this),window.document.addEventListener("keydown",this.documentKeydownListener))},unbindDocumentKeyDownListener:function(){this.documentKeydownListener&&(window.document.removeEventListener("keydown",this.documentKeydownListener),this.documentKeydownListener=null)},bindOutsideClickListener:function(){var s=this;!this.outsideClickListener&&pm()&&(this.outsideClickListener=function(d){s.visible&&!s.selfClick&&!s.isTargetClicked(d)&&(s.visible=!1),s.selfClick=!1},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener:function(){var s=this;this.scrollHandler||(this.scrollHandler=new sD(this.target,function(){s.visible&&(s.visible=!1)})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var s=this;this.resizeListener||(this.resizeListener=function(){s.visible&&!g2()&&(s.visible=!1)},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isTargetClicked:function(s){return this.eventTarget&&(this.eventTarget===s.target||this.eventTarget.contains(s.target))},containerRef:function(s){this.container=s},createStyle:function(){if(!this.styleElement&&!this.isUnstyled){var s;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",J0(this.styleElement,"nonce",(s=this.$primevue)===null||s===void 0||(s=s.config)===null||s===void 0||(s=s.csp)===null||s===void 0?void 0:s.nonce),document.head.appendChild(this.styleElement);var d="";for(var _ in this.breakpoints)d+=`
                        @media screen and (max-width: `.concat(_,`) {
                            .p-popover[`).concat(this.$attrSelector,`] {
                                width: `).concat(this.breakpoints[_],` !important;
                            }
                        }
                    `);this.styleElement.innerHTML=d}},destroyStyle:function(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)},onOverlayClick:function(s){nd.emit("overlay-click",{originalEvent:s,target:this.target})}},directives:{focustrap:yD,ripple:AD},components:{Portal:gv}},UD=["aria-modal"];function ZD(n,s,d,_,x,P){var b=p1("Portal"),c=g1("focustrap");return Vo(),Is(b,{appendTo:n.appendTo},{default:gd(function(){return[Eo(dw,Ms({name:"p-popover",onEnter:P.onEnter,onLeave:P.onLeave,onAfterLeave:P.onAfterLeave},n.ptm("transition")),{default:gd(function(){return[x.visible?Yx((Vo(),Ps("div",Ms({key:0,ref:P.containerRef,role:"dialog","aria-modal":x.visible,onClick:s[3]||(s[3]=function(){return P.onOverlayClick&&P.onOverlayClick.apply(P,arguments)}),class:n.cx("root")},n.ptmi("root")),[n.$slots.container?yd(n.$slots,"container",{key:0,closeCallback:P.hide,keydownCallback:function(U){return P.onButtonKeydown(U)}}):(Vo(),Ps("div",Ms({key:1,class:n.cx("content"),onClick:s[0]||(s[0]=function(){return P.onContentClick&&P.onContentClick.apply(P,arguments)}),onMousedown:s[1]||(s[1]=function(){return P.onContentClick&&P.onContentClick.apply(P,arguments)}),onKeydown:s[2]||(s[2]=function(){return P.onContentKeydown&&P.onContentKeydown.apply(P,arguments)})},n.ptm("content")),[yd(n.$slots,"default")],16))],16,UD)),[[c]]):Fd("",!0)]}),_:3},16,["onEnter","onLeave","onAfterLeave"])]}),_:3},8,["appendTo"])}bv.render=ZD;const gm=(n,s)=>{const d=n.__vccOpts||n;for(const[_,x]of s)d[_]=x;return d},GD={class:"layer-icon"},qD=["xlink:href"],WD={class:"layer-title"},HD={__name:"LayerItem",props:{id:{type:String,required:!0},homeMapLayerType:{type:String,required:!0},position:{type:Number,required:!0},title:{type:String,required:!0},icon:{type:String,required:!1},enabled:{type:Boolean,required:!1,default:!1},visible:{type:Boolean,required:!1,default:!1},multiTemporal:{type:Boolean,required:!1,default:!1}},emits:["update:toggleLayer"],setup(n,{emit:s}){const d=n,_=s,x=Mi(d.visible),P=Mi(d.enabled);Fi(()=>d.visible,c=>{x.value=c}),Fi(()=>d.enabled,c=>{P.value=c});const b=()=>{x.value=!x.value,_("update:toggleLayer",{layerId:d.id,visible:x.value})};return(c,z)=>P.value?(Vo(),Ps("div",{key:0,class:Id(["layer-control",{active:n.visible}]),onClick:b},[yo("div",GD,[(Vo(),Ps("svg",null,[yo("use",{"xlink:href":n.icon?`#${n.icon}`:"#icon-layers"},null,8,qD)]))]),yo("div",WD,Hp(n.title),1)],2)):Fd("",!0)}},xy=gm(HD,[["__scopeId","data-v-fe358537"]]),XD={key:0,class:"time-picker"},YD=["disabled"],KD={class:"date-display"},JD=["disabled"],QD={__name:"DateNavigator",setup(n){const s=nv(),d=pi(()=>{const H=s.activeTimeLayer;return H?s.timeLayerDates[H]||[]:[]}),_=pi(()=>{const H=s.activeTimeLayer,Q=H&&s.getLayerById(H);return Q&&Q.dateFormat?Q.dateFormat:{currentTime:"yyyy-MM-dd HH:mm"}}),x=pi(()=>{const H=s.activeTimeLayer;return H&&s.selectedTimeLayerDateIndex[H]||0}),P=pi(()=>d.value[x.value]),b=pi(()=>{if(P.value&&_.value){const{currentTime:H,asPeriod:Q}=_.value;return eD(new Date(P.value),H,Q)}return""}),c=pi(()=>x.value>=d.value.length-1),z=pi(()=>x.value<=0),U=()=>{if(!c.value){const H=x.value+1;s.setSelectedTimeLayerDateIndex(s.activeTimeLayer,H)}},V=()=>{if(!z.value){const H=x.value-1;s.setSelectedTimeLayerDateIndex(s.activeTimeLayer,H)}};return(H,Q)=>d.value.length?(Vo(),Ps("div",XD,[yo("button",{onClick:V,disabled:z.value,class:"nav-button"},"",8,YD),yo("span",KD,Hp(b.value),1),yo("button",{onClick:U,disabled:c.value,class:"nav-button"},"",8,JD)])):Fd("",!0)}},eR=gm(QD,[["__scopeId","data-v-69719b57"]]),tR={class:"basemap-control"},rR={class:"fixed-layer-control"},oR={class:"dynamic-layer-control"},iR={class:"date-navigator-control"},nR={__name:"Map",props:{mapSettingsUrl:{type:String,required:!0},initialBounds:{type:String,required:!1}},setup(n){const s=n,d=nv(),_=Fx(null),x=Mi();let P=Mi([]),b;const c=["admin-boundary-fill","admin-boundary-line","admin-boundary-line-1","weather-warnings","weather-forecast"],z=pi(()=>{const De=d.activeTimeLayer;return De?d.timeLayerDates[De]||[]:[]}),U=pi(()=>{const De=d.activeTimeLayer;return De&&d.selectedTimeLayerDateIndex[De]||0}),V=pi(()=>z.value[U.value]),H=async()=>(await fetch(s.mapSettingsUrl)).json(),Q=async()=>{const De={container:_.value,style:"https://tiles.basemaps.cartocdn.com/gl/voyager-gl-style/style.json",center:[0,0],zoom:4,scrollZoom:!1};if(s.initialBounds)try{const Ge=JSON.parse(s.initialBounds);De.bounds=[[Ge[0],Ge[1]],[Ge[2],Ge[3]]],De.fitBoundsOptions={padding:20}}catch(Ge){console.error("Error parsing initial bounds",Ge)}b=new C5.Map(De),b.on("load",async()=>{const Ge=await H();G(Ge)})},G=De=>{const{boundaryTilesUrl:Ge,showWarningsLayer:et,capGeojsonUrl:Dt,showLocationForecastLayer:ft,locationForecastDateDisplayFormat:wt,homeForecastDataUrl:Et,weatherIconsUrl:sr,forecastClusterConfig:cr,dynamicMapLayers:or}=De;se(Ge),et&&(d.updateLayerState("weather-warnings",!0),Me(Dt)),ft&&(d.updateLayerState("weather-forecast",!0),d.setWeatherForecastLayerDateFormat({currentTime:wt}),rt(Et,sr,cr)),or&&or.length&&or.forEach(qt=>{var br,qr;const Sr=(qr=(br=qt.paramsSelectorConfig)==null?void 0:br.find(bo=>bo.key==="time"))==null?void 0:qr.dateFormat,Mr={...qt,title:qt.name,homeMapLayerType:"dynamic",visible:!1,enabled:!0,icon:qt.icon?`icon-${qt.icon}`:"icon-layers",dateFormat:Sr};Te(Mr)})},se=De=>{b.addSource("admin-boundary-source",{type:"vector",tiles:[De]}),b.addLayer({id:"admin-boundary-fill",type:"fill",source:"admin-boundary-source","source-layer":"default",filter:["==","level",0],paint:{"fill-color":"#fff","fill-opacity":0}}),b.addLayer({id:"admin-boundary-line",type:"line",source:"admin-boundary-source","source-layer":"default",filter:["==","level",0],paint:{"line-color":"#C0FF24","line-width":1,"line-offset":1}}),b.addLayer({id:"admin-boundary-line-1",type:"line",source:"admin-boundary-source","source-layer":"default",filter:["==","level",0],paint:{"line-color":"#000","line-width":1.5}})},Me=De=>{fetch(De).then(Ge=>Ge.json()).then(Ge=>{if(Ge.features.length>0){const et=T5(Ge);b.fitBounds(et,{padding:50}),b.addSource("weather-warnings",{type:"geojson",data:Ge});let Dt;b.getLayer("weather-forecast")&&(Dt="weather-forecast"),b.addLayer({id:"weather-warnings",type:"fill",source:"weather-warnings",paint:{"fill-color":["case",["==",["get","severity"],"Extreme"],"#d72f2a",["==",["get","severity"],"Severe"],"#f89904",["==",["get","severity"],"Moderate"],"#e4e616",["==",["get","severity"],"Minor"],"#53ffff",["==",["get","severity"],"Unknown"],"#3366ff","black"],"fill-opacity":.7,"fill-outline-color":"#000"}},Dt),d.updateLayerVisibility("weather-warnings",!0)}})},rt=(De,Ge,et)=>{b.addSource("weather-forecast",{type:"geojson",data:{type:"FeatureCollection",features:[]},...et}),b.addLayer({id:"weather-forecast",type:"symbol",layout:{"icon-image":["get","condition"],"icon-size":.3,"icon-allow-overlap":!0},source:"weather-forecast"}),fetch(De).then(Dt=>Dt.json()).then(Dt=>{He(Ge),lt(Dt);const{data:ft}=Dt;ft&&ft.length&&d.updateLayerVisibility("weather-forecast",!0)})},He=De=>{fetch(De).then(Ge=>Ge.json()).then(Ge=>{Ge&&Array.isArray(Ge)&&Ge.forEach(et=>{b.loadImage(et.url).then(Dt=>{b.addImage(et.id,Dt.data)})})})},lt=De=>{const{multi_period:Ge,data:et}=De;P.value=et;const Dt=new Date,ft=et.reduce((wt,Et)=>{const sr=new Date(Et.datetime);return Ge&&sr.toDateString()===Dt.toDateString()&&sr.getHours()<Dt.getHours()||wt.push(Et.datetime),wt},[]);d.setActiveTimeLayer("weather-forecast"),d.setSelectedTimeLayerDateIndex("weather-forecast",0),d.setTimeLayerDates("weather-forecast",ft)},st=De=>{const Ge=P.value.find(et=>et.datetime===De);Ge&&b.getSource("weather-forecast").setData(Ge)},Te=De=>{const{layerType:Ge}=De;Ge==="raster_file"&&(De.mapLayerConfig=Yz(De),d.addLayer(De))},Ye=(De,Ge)=>{const et=d.getLayerById(De),{layerType:Dt}=et;Ge?Dt==="raster_file"&&dt(et.id):(b.getLayer(De)&&b.removeLayer(De),b.getSource(De)&&b.removeSource(De))},dt=async De=>{const Ge=d.getLayerById(De),{mapLayerConfig:et}=Ge,{tileJsonUrl:Dt,currentTimeMethod:ft}=Ge,wt=await fetch(Dt).then(Et=>Et.json()).then(Et=>Et.timestamps);if(wt&&wt.length){const Et=Xz(wt,ft),sr=wt.indexOf(Et);d.setSelectedTimeLayerDateIndex(Ge.id,sr),d.setTimeLayerDates(Ge.id,wt);const cr=et.source.id,or=et.layer.id,qt=pv(et.source.tiles,{time:Et});b.getSource(cr)||b.addSource(cr,{type:"raster",tiles:[qt]}),b.getLayer(or)||(b.addLayer({id:or,type:"raster",source:cr}),c.forEach(Sr=>{b.getLayer(Sr)&&b.moveLayer(Sr)}))}},_t=()=>b==null?void 0:b.zoomIn(),nt=()=>b==null?void 0:b.zoomOut(),Je=De=>{x.value.toggle(De)},bt=({layerId:De,visible:Ge})=>{d.updateLayerVisibility(De,Ge);const et=d.getLayerById(De),{homeMapLayerType:Dt}=et;Dt==="fixed"&&b.getLayer(De)&&b.setLayoutProperty(De,"visibility",Ge?"visible":"none"),et.multiTemporal&&(Ge?(d.activeTimeLayer&&(d.updateLayerVisibility(d.activeTimeLayer,!1),b.getLayer(d.activeTimeLayer)&&b.setLayoutProperty(d.activeTimeLayer,"visibility","none"),d.activeTimeLayer!=="weather-forecast"&&(b.getLayer(d.activeTimeLayer)&&b.removeLayer(d.activeTimeLayer),b.getSource(d.activeTimeLayer)&&b.removeSource(d.activeTimeLayer))),d.setActiveTimeLayer(De)):d.setActiveTimeLayer(null)),Dt==="dynamic"&&Ye(De,Ge)},zt=(De,Ge)=>{const{layerType:et,mapLayerConfig:Dt}=De;et==="raster_file"&&Dt&&Kz(b,Dt.source.id,{time:Ge})};return Fi(V,De=>{const Ge=d.activeTimeLayer;if(Ge){const et=d.getLayerById(Ge),{homeMapLayerType:Dt}=et;Dt==="fixed"?Ge==="weather-forecast"&&st(De):zt(et,De)}}),Rd(()=>Q()),sm(()=>b==null?void 0:b.remove()),(De,Ge)=>(Vo(),Ps(No,null,[yo("div",{ref_key:"mapContainer",ref:_,class:"map-container"},null,512),yo("div",{class:"zoom-controls"},[yo("button",{onClick:_t},"+"),yo("button",{onClick:nt},"")]),yo("div",tR,[yo("div",{class:"basemap-icon icon",onClick:Je},Ge[0]||(Ge[0]=[yo("svg",null,[yo("use",{"xlink:href":"#icon-layer-group"})],-1)])),Eo(ad(bv),{ref_key:"basemapChooserRef",ref:x},{default:gd(()=>Ge[1]||(Ge[1]=[L0(" Hello ")])),_:1},512)]),yo("div",rR,[(Vo(!0),Ps(No,null,a_(ad(d).sortedFixedLayers,et=>(Vo(),Is(xy,{key:et.id,title:et.title,enabled:et.enabled,visible:et.visible,"home-map-layer-type":et.homeMapLayerType,position:et.position,id:et.id,icon:et.icon,"onUpdate:toggleLayer":bt},null,8,["title","enabled","visible","home-map-layer-type","position","id","icon"]))),128))]),yo("div",oR,[(Vo(!0),Ps(No,null,a_(ad(d).sortedDynamicLayers,et=>(Vo(),Is(xy,{key:et.id,title:et.title,enabled:et.enabled,visible:et.visible,"home-map-layer-type":et.homeMapLayerType,position:et.position,id:et.id,icon:et.icon,"onUpdate:toggleLayer":bt},null,8,["title","enabled","visible","home-map-layer-type","position","id","icon"]))),128))]),yo("div",iR,[Eo(eR)])],64))}},sR=gm(nR,[["__scopeId","data-v-ff22c1a1"]]),wy={__name:"HomeMap",props:{mapSettingsUrl:{type:String,required:!0},cityDetailUrl:{type:String,required:!1},initialBounds:{type:String,required:!1}},setup(n){return(s,d)=>(Vo(),Is(sR,{initialBounds:n.initialBounds,mapSettingsUrl:n.mapSettingsUrl},null,8,["initialBounds","mapSettingsUrl"]))}},aR=Ow(),sd=document.getElementById("home-map");if(sd){const n=Lw(wy,Ww({dataset:{...sd.dataset},component:wy}));n.use(eC,{theme:{preset:y5}}),n.use(aR),n.use(qw,{rootElement:sd}),n.mount(sd)}
