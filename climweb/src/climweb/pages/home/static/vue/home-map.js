/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function jp(n){const s=Object.create(null);for(const d of n.split(","))s[d]=1;return d=>d in s}const xr={},Il=[],dn=()=>{},Gb=()=>!1,xd=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Np=n=>n.startsWith("onUpdate:"),Eo=Object.assign,Vp=(n,s)=>{const d=n.indexOf(s);d>-1&&n.splice(d,1)},qb=Object.prototype.hasOwnProperty,lr=(n,s)=>qb.call(n,s),Rt=Array.isArray,El=n=>wd(n)==="[object Map]",_y=n=>wd(n)==="[object Set]",Nt=n=>typeof n=="function",Zr=n=>typeof n=="string",Un=n=>typeof n=="symbol",Er=n=>n!==null&&typeof n=="object",yy=n=>(Er(n)||Nt(n))&&Nt(n.then)&&Nt(n.catch),vy=Object.prototype.toString,wd=n=>vy.call(n),Wb=n=>wd(n).slice(8,-1),by=n=>wd(n)==="[object Object]",Up=n=>Zr(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,lu=jp(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Cd=n=>{const s=Object.create(null);return d=>s[d]||(s[d]=n(d))},Hb=/-(\w)/g,Oi=Cd(n=>n.replace(Hb,(s,d)=>d?d.toUpperCase():"")),Xb=/\B([A-Z])/g,ma=Cd(n=>n.replace(Xb,"-$1").toLowerCase()),Sd=Cd(n=>n.charAt(0).toUpperCase()+n.slice(1)),ep=Cd(n=>n?`on${Sd(n)}`:""),Ss=(n,s)=>!Object.is(n,s),tp=(n,...s)=>{for(let d=0;d<n.length;d++)n[d](...s)},xy=(n,s,d,_=!1)=>{Object.defineProperty(n,s,{configurable:!0,enumerable:!1,writable:_,value:d})},Kb=n=>{const s=parseFloat(n);return isNaN(s)?n:s},Yb=n=>{const s=Zr(n)?Number(n):NaN;return isNaN(s)?n:s};let Hg;const Td=()=>Hg||(Hg=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Zp(n){if(Rt(n)){const s={};for(let d=0;d<n.length;d++){const _=n[d],w=Zr(_)?tx(_):Zp(_);if(w)for(const P in w)s[P]=w[P]}return s}else if(Zr(n)||Er(n))return n}const Jb=/;(?![^(]*\))/g,Qb=/:([^]+)/,ex=/\/\*[^]*?\*\//g;function tx(n){const s={};return n.replace(ex,"").split(Jb).forEach(d=>{if(d){const _=d.split(Qb);_.length>1&&(s[_[0].trim()]=_[1].trim())}}),s}function kd(n){let s="";if(Zr(n))s=n;else if(Rt(n))for(let d=0;d<n.length;d++){const _=kd(n[d]);_&&(s+=_+" ")}else if(Er(n))for(const d in n)n[d]&&(s+=d+" ");return s.trim()}const rx="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ox=jp(rx);function wy(n){return!!n||n===""}const Cy=n=>!!(n&&n.__v_isRef===!0),Gp=n=>Zr(n)?n:n==null?"":Rt(n)||Er(n)&&(n.toString===vy||!Nt(n.toString))?Cy(n)?Gp(n.value):JSON.stringify(n,Sy,2):String(n),Sy=(n,s)=>Cy(s)?Sy(n,s.value):El(s)?{[`Map(${s.size})`]:[...s.entries()].reduce((d,[_,w],P)=>(d[rp(_,P)+" =>"]=w,d),{})}:_y(s)?{[`Set(${s.size})`]:[...s.values()].map(d=>rp(d))}:Un(s)?rp(s):Er(s)&&!Rt(s)&&!by(s)?String(s):s,rp=(n,s="")=>{var d;return Un(n)?`Symbol(${(d=n.description)!=null?d:s})`:n};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Qo;class Ty{constructor(s=!1){this.detached=s,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Qo,!s&&Qo&&(this.index=(Qo.scopes||(Qo.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let s,d;if(this.scopes)for(s=0,d=this.scopes.length;s<d;s++)this.scopes[s].pause();for(s=0,d=this.effects.length;s<d;s++)this.effects[s].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let s,d;if(this.scopes)for(s=0,d=this.scopes.length;s<d;s++)this.scopes[s].resume();for(s=0,d=this.effects.length;s<d;s++)this.effects[s].resume()}}run(s){if(this._active){const d=Qo;try{return Qo=this,s()}finally{Qo=d}}}on(){Qo=this}off(){Qo=this.parent}stop(s){if(this._active){this._active=!1;let d,_;for(d=0,_=this.effects.length;d<_;d++)this.effects[d].stop();for(this.effects.length=0,d=0,_=this.cleanups.length;d<_;d++)this.cleanups[d]();if(this.cleanups.length=0,this.scopes){for(d=0,_=this.scopes.length;d<_;d++)this.scopes[d].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!s){const w=this.parent.scopes.pop();w&&w!==this&&(this.parent.scopes[this.index]=w,w.index=this.index)}this.parent=void 0}}}function ky(n){return new Ty(n)}function Py(){return Qo}function ix(n,s=!1){Qo&&Qo.cleanups.push(n)}let Cr;const op=new WeakSet;class My{constructor(s){this.fn=s,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Qo&&Qo.active&&Qo.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,op.has(this)&&(op.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ey(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Xg(this),Ay(this);const s=Cr,d=Hi;Cr=this,Hi=!0;try{return this.fn()}finally{zy(this),Cr=s,Hi=d,this.flags&=-3}}stop(){if(this.flags&1){for(let s=this.deps;s;s=s.nextDep)Hp(s);this.deps=this.depsTail=void 0,Xg(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?op.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){vp(this)&&this.run()}get dirty(){return vp(this)}}let Iy=0,cu,uu;function Ey(n,s=!1){if(n.flags|=8,s){n.next=uu,uu=n;return}n.next=cu,cu=n}function qp(){Iy++}function Wp(){if(--Iy>0)return;if(uu){let s=uu;for(uu=void 0;s;){const d=s.next;s.next=void 0,s.flags&=-9,s=d}}let n;for(;cu;){let s=cu;for(cu=void 0;s;){const d=s.next;if(s.next=void 0,s.flags&=-9,s.flags&1)try{s.trigger()}catch(_){n||(n=_)}s=d}}if(n)throw n}function Ay(n){for(let s=n.deps;s;s=s.nextDep)s.version=-1,s.prevActiveLink=s.dep.activeLink,s.dep.activeLink=s}function zy(n){let s,d=n.depsTail,_=d;for(;_;){const w=_.prevDep;_.version===-1?(_===d&&(d=w),Hp(_),nx(_)):s=_,_.dep.activeLink=_.prevActiveLink,_.prevActiveLink=void 0,_=w}n.deps=s,n.depsTail=d}function vp(n){for(let s=n.deps;s;s=s.nextDep)if(s.dep.version!==s.version||s.dep.computed&&(Ry(s.dep.computed)||s.dep.version!==s.version))return!0;return!!n._dirty}function Ry(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===yu))return;n.globalVersion=yu;const s=n.dep;if(n.flags|=2,s.version>0&&!n.isSSR&&n.deps&&!vp(n)){n.flags&=-3;return}const d=Cr,_=Hi;Cr=n,Hi=!0;try{Ay(n);const w=n.fn(n._value);(s.version===0||Ss(w,n._value))&&(n._value=w,s.version++)}catch(w){throw s.version++,w}finally{Cr=d,Hi=_,zy(n),n.flags&=-3}}function Hp(n,s=!1){const{dep:d,prevSub:_,nextSub:w}=n;if(_&&(_.nextSub=w,n.prevSub=void 0),w&&(w.prevSub=_,n.nextSub=void 0),d.subs===n&&(d.subs=_,!_&&d.computed)){d.computed.flags&=-5;for(let P=d.computed.deps;P;P=P.nextDep)Hp(P,!0)}!s&&!--d.sc&&d.map&&d.map.delete(d.key)}function nx(n){const{prevDep:s,nextDep:d}=n;s&&(s.nextDep=d,n.prevDep=void 0),d&&(d.prevDep=s,n.nextDep=void 0)}let Hi=!0;const Dy=[];function Is(){Dy.push(Hi),Hi=!1}function Es(){const n=Dy.pop();Hi=n===void 0?!0:n}function Xg(n){const{cleanup:s}=n;if(n.cleanup=void 0,s){const d=Cr;Cr=void 0;try{s()}finally{Cr=d}}}let yu=0;class sx{constructor(s,d){this.sub=s,this.dep=d,this.version=d.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Xp{constructor(s){this.computed=s,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(s){if(!Cr||!Hi||Cr===this.computed)return;let d=this.activeLink;if(d===void 0||d.sub!==Cr)d=this.activeLink=new sx(Cr,this),Cr.deps?(d.prevDep=Cr.depsTail,Cr.depsTail.nextDep=d,Cr.depsTail=d):Cr.deps=Cr.depsTail=d,By(d);else if(d.version===-1&&(d.version=this.version,d.nextDep)){const _=d.nextDep;_.prevDep=d.prevDep,d.prevDep&&(d.prevDep.nextDep=_),d.prevDep=Cr.depsTail,d.nextDep=void 0,Cr.depsTail.nextDep=d,Cr.depsTail=d,Cr.deps===d&&(Cr.deps=_)}return d}trigger(s){this.version++,yu++,this.notify(s)}notify(s){qp();try{for(let d=this.subs;d;d=d.prevSub)d.sub.notify()&&d.sub.dep.notify()}finally{Wp()}}}function By(n){if(n.dep.sc++,n.sub.flags&4){const s=n.dep.computed;if(s&&!n.dep.subs){s.flags|=20;for(let _=s.deps;_;_=_.nextDep)By(_)}const d=n.dep.subs;d!==n&&(n.prevSub=d,d&&(d.nextSub=n)),n.dep.subs=n}}const cd=new WeakMap,ua=Symbol(""),bp=Symbol(""),vu=Symbol("");function $o(n,s,d){if(Hi&&Cr){let _=cd.get(n);_||cd.set(n,_=new Map);let w=_.get(d);w||(_.set(d,w=new Xp),w.map=_,w.key=d),w.track()}}function jn(n,s,d,_,w,P){const b=cd.get(n);if(!b){yu++;return}const c=R=>{R&&R.trigger()};if(qp(),s==="clear")b.forEach(c);else{const R=Rt(n),Z=R&&Up(d);if(R&&d==="length"){const V=Number(_);b.forEach((H,K)=>{(K==="length"||K===vu||!Un(K)&&K>=V)&&c(H)})}else switch((d!==void 0||b.has(void 0))&&c(b.get(d)),Z&&c(b.get(vu)),s){case"add":R?Z&&c(b.get("length")):(c(b.get(ua)),El(n)&&c(b.get(bp)));break;case"delete":R||(c(b.get(ua)),El(n)&&c(b.get(bp)));break;case"set":El(n)&&c(b.get(ua));break}}Wp()}function ax(n,s){const d=cd.get(n);return d&&d.get(s)}function Cl(n){const s=rr(n);return s===n?s:($o(s,"iterate",vu),Fi(n)?s:s.map(jo))}function Pd(n){return $o(n=rr(n),"iterate",vu),n}const lx={__proto__:null,[Symbol.iterator](){return ip(this,Symbol.iterator,jo)},concat(...n){return Cl(this).concat(...n.map(s=>Rt(s)?Cl(s):s))},entries(){return ip(this,"entries",n=>(n[1]=jo(n[1]),n))},every(n,s){return Bn(this,"every",n,s,void 0,arguments)},filter(n,s){return Bn(this,"filter",n,s,d=>d.map(jo),arguments)},find(n,s){return Bn(this,"find",n,s,jo,arguments)},findIndex(n,s){return Bn(this,"findIndex",n,s,void 0,arguments)},findLast(n,s){return Bn(this,"findLast",n,s,jo,arguments)},findLastIndex(n,s){return Bn(this,"findLastIndex",n,s,void 0,arguments)},forEach(n,s){return Bn(this,"forEach",n,s,void 0,arguments)},includes(...n){return np(this,"includes",n)},indexOf(...n){return np(this,"indexOf",n)},join(n){return Cl(this).join(n)},lastIndexOf(...n){return np(this,"lastIndexOf",n)},map(n,s){return Bn(this,"map",n,s,void 0,arguments)},pop(){return Qc(this,"pop")},push(...n){return Qc(this,"push",n)},reduce(n,...s){return Kg(this,"reduce",n,s)},reduceRight(n,...s){return Kg(this,"reduceRight",n,s)},shift(){return Qc(this,"shift")},some(n,s){return Bn(this,"some",n,s,void 0,arguments)},splice(...n){return Qc(this,"splice",n)},toReversed(){return Cl(this).toReversed()},toSorted(n){return Cl(this).toSorted(n)},toSpliced(...n){return Cl(this).toSpliced(...n)},unshift(...n){return Qc(this,"unshift",n)},values(){return ip(this,"values",jo)}};function ip(n,s,d){const _=Pd(n),w=_[s]();return _!==n&&!Fi(n)&&(w._next=w.next,w.next=()=>{const P=w._next();return P.value&&(P.value=d(P.value)),P}),w}const cx=Array.prototype;function Bn(n,s,d,_,w,P){const b=Pd(n),c=b!==n&&!Fi(n),R=b[s];if(R!==cx[s]){const H=R.apply(n,P);return c?jo(H):H}let Z=d;b!==n&&(c?Z=function(H,K){return d.call(this,jo(H),K,n)}:d.length>2&&(Z=function(H,K){return d.call(this,H,K,n)}));const V=R.call(b,Z,_);return c&&w?w(V):V}function Kg(n,s,d,_){const w=Pd(n);let P=d;return w!==n&&(Fi(n)?d.length>3&&(P=function(b,c,R){return d.call(this,b,c,R,n)}):P=function(b,c,R){return d.call(this,b,jo(c),R,n)}),w[s](P,..._)}function np(n,s,d){const _=rr(n);$o(_,"iterate",vu);const w=_[s](...d);return(w===-1||w===!1)&&Qp(d[0])?(d[0]=rr(d[0]),_[s](...d)):w}function Qc(n,s,d=[]){Is(),qp();const _=rr(n)[s].apply(n,d);return Wp(),Es(),_}const ux=jp("__proto__,__v_isRef,__isVue"),Ly=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Un));function hx(n){Un(n)||(n=String(n));const s=rr(this);return $o(s,"has",n),s.hasOwnProperty(n)}class Fy{constructor(s=!1,d=!1){this._isReadonly=s,this._isShallow=d}get(s,d,_){if(d==="__v_skip")return s.__v_skip;const w=this._isReadonly,P=this._isShallow;if(d==="__v_isReactive")return!w;if(d==="__v_isReadonly")return w;if(d==="__v_isShallow")return P;if(d==="__v_raw")return _===(w?P?xx:Ny:P?jy:$y).get(s)||Object.getPrototypeOf(s)===Object.getPrototypeOf(_)?s:void 0;const b=Rt(s);if(!w){let R;if(b&&(R=lx[d]))return R;if(d==="hasOwnProperty")return hx}const c=Reflect.get(s,d,eo(s)?s:_);return(Un(d)?Ly.has(d):ux(d))||(w||$o(s,"get",d),P)?c:eo(c)?b&&Up(d)?c:c.value:Er(c)?w?Yp(c):Bu(c):c}}class Oy extends Fy{constructor(s=!1){super(!1,s)}set(s,d,_,w){let P=s[d];if(!this._isShallow){const R=da(P);if(!Fi(_)&&!da(_)&&(P=rr(P),_=rr(_)),!Rt(s)&&eo(P)&&!eo(_))return R?!1:(P.value=_,!0)}const b=Rt(s)&&Up(d)?Number(d)<s.length:lr(s,d),c=Reflect.set(s,d,_,eo(s)?s:w);return s===rr(w)&&(b?Ss(_,P)&&jn(s,"set",d,_):jn(s,"add",d,_)),c}deleteProperty(s,d){const _=lr(s,d);s[d];const w=Reflect.deleteProperty(s,d);return w&&_&&jn(s,"delete",d,void 0),w}has(s,d){const _=Reflect.has(s,d);return(!Un(d)||!Ly.has(d))&&$o(s,"has",d),_}ownKeys(s){return $o(s,"iterate",Rt(s)?"length":ua),Reflect.ownKeys(s)}}class dx extends Fy{constructor(s=!1){super(!0,s)}set(s,d){return!0}deleteProperty(s,d){return!0}}const fx=new Oy,px=new dx,mx=new Oy(!0);const xp=n=>n,Kh=n=>Reflect.getPrototypeOf(n);function gx(n,s,d){return function(..._){const w=this.__v_raw,P=rr(w),b=El(P),c=n==="entries"||n===Symbol.iterator&&b,R=n==="keys"&&b,Z=w[n](..._),V=d?xp:s?wp:jo;return!s&&$o(P,"iterate",R?bp:ua),{next(){const{value:H,done:K}=Z.next();return K?{value:H,done:K}:{value:c?[V(H[0]),V(H[1])]:V(H),done:K}},[Symbol.iterator](){return this}}}}function Yh(n){return function(...s){return n==="delete"?!1:n==="clear"?void 0:this}}function _x(n,s){const d={get(w){const P=this.__v_raw,b=rr(P),c=rr(w);n||(Ss(w,c)&&$o(b,"get",w),$o(b,"get",c));const{has:R}=Kh(b),Z=s?xp:n?wp:jo;if(R.call(b,w))return Z(P.get(w));if(R.call(b,c))return Z(P.get(c));P!==b&&P.get(w)},get size(){const w=this.__v_raw;return!n&&$o(rr(w),"iterate",ua),Reflect.get(w,"size",w)},has(w){const P=this.__v_raw,b=rr(P),c=rr(w);return n||(Ss(w,c)&&$o(b,"has",w),$o(b,"has",c)),w===c?P.has(w):P.has(w)||P.has(c)},forEach(w,P){const b=this,c=b.__v_raw,R=rr(c),Z=s?xp:n?wp:jo;return!n&&$o(R,"iterate",ua),c.forEach((V,H)=>w.call(P,Z(V),Z(H),b))}};return Eo(d,n?{add:Yh("add"),set:Yh("set"),delete:Yh("delete"),clear:Yh("clear")}:{add(w){!s&&!Fi(w)&&!da(w)&&(w=rr(w));const P=rr(this);return Kh(P).has.call(P,w)||(P.add(w),jn(P,"add",w,w)),this},set(w,P){!s&&!Fi(P)&&!da(P)&&(P=rr(P));const b=rr(this),{has:c,get:R}=Kh(b);let Z=c.call(b,w);Z||(w=rr(w),Z=c.call(b,w));const V=R.call(b,w);return b.set(w,P),Z?Ss(P,V)&&jn(b,"set",w,P):jn(b,"add",w,P),this},delete(w){const P=rr(this),{has:b,get:c}=Kh(P);let R=b.call(P,w);R||(w=rr(w),R=b.call(P,w)),c&&c.call(P,w);const Z=P.delete(w);return R&&jn(P,"delete",w,void 0),Z},clear(){const w=rr(this),P=w.size!==0,b=w.clear();return P&&jn(w,"clear",void 0,void 0),b}}),["keys","values","entries",Symbol.iterator].forEach(w=>{d[w]=gx(w,n,s)}),d}function Kp(n,s){const d=_x(n,s);return(_,w,P)=>w==="__v_isReactive"?!n:w==="__v_isReadonly"?n:w==="__v_raw"?_:Reflect.get(lr(d,w)&&w in _?d:_,w,P)}const yx={get:Kp(!1,!1)},vx={get:Kp(!1,!0)},bx={get:Kp(!0,!1)};const $y=new WeakMap,jy=new WeakMap,Ny=new WeakMap,xx=new WeakMap;function wx(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Cx(n){return n.__v_skip||!Object.isExtensible(n)?0:wx(Wb(n))}function Bu(n){return da(n)?n:Jp(n,!1,fx,yx,$y)}function Sx(n){return Jp(n,!1,mx,vx,jy)}function Yp(n){return Jp(n,!0,px,bx,Ny)}function Jp(n,s,d,_,w){if(!Er(n)||n.__v_raw&&!(s&&n.__v_isReactive))return n;const P=w.get(n);if(P)return P;const b=Cx(n);if(b===0)return n;const c=new Proxy(n,b===2?_:d);return w.set(n,c),c}function Ts(n){return da(n)?Ts(n.__v_raw):!!(n&&n.__v_isReactive)}function da(n){return!!(n&&n.__v_isReadonly)}function Fi(n){return!!(n&&n.__v_isShallow)}function Qp(n){return n?!!n.__v_raw:!1}function rr(n){const s=n&&n.__v_raw;return s?rr(s):n}function em(n){return!lr(n,"__v_skip")&&Object.isExtensible(n)&&xy(n,"__v_skip",!0),n}const jo=n=>Er(n)?Bu(n):n,wp=n=>Er(n)?Yp(n):n;function eo(n){return n?n.__v_isRef===!0:!1}function No(n){return Vy(n,!1)}function Tx(n){return Vy(n,!0)}function Vy(n,s){return eo(n)?n:new kx(n,s)}class kx{constructor(s,d){this.dep=new Xp,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=d?s:rr(s),this._value=d?s:jo(s),this.__v_isShallow=d}get value(){return this.dep.track(),this._value}set value(s){const d=this._rawValue,_=this.__v_isShallow||Fi(s)||da(s);s=_?s:rr(s),Ss(s,d)&&(this._rawValue=s,this._value=_?s:jo(s),this.dep.trigger())}}function Cp(n){return eo(n)?n.value:n}const Px={get:(n,s,d)=>s==="__v_raw"?n:Cp(Reflect.get(n,s,d)),set:(n,s,d,_)=>{const w=n[s];return eo(w)&&!eo(d)?(w.value=d,!0):Reflect.set(n,s,d,_)}};function Uy(n){return Ts(n)?n:new Proxy(n,Px)}function Mx(n){const s=Rt(n)?new Array(n.length):{};for(const d in n)s[d]=Ex(n,d);return s}class Ix{constructor(s,d,_){this._object=s,this._key=d,this._defaultValue=_,this.__v_isRef=!0,this._value=void 0}get value(){const s=this._object[this._key];return this._value=s===void 0?this._defaultValue:s}set value(s){this._object[this._key]=s}get dep(){return ax(rr(this._object),this._key)}}function Ex(n,s,d){const _=n[s];return eo(_)?_:new Ix(n,s,d)}class Ax{constructor(s,d,_){this.fn=s,this.setter=d,this._value=void 0,this.dep=new Xp(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=yu-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!d,this.isSSR=_}notify(){if(this.flags|=16,!(this.flags&8)&&Cr!==this)return Ey(this,!0),!0}get value(){const s=this.dep.track();return Ry(this),s&&(s.version=this.dep.version),this._value}set value(s){this.setter&&this.setter(s)}}function zx(n,s,d=!1){let _,w;return Nt(n)?_=n:(_=n.get,w=n.set),new Ax(_,w,d)}const Jh={},ud=new WeakMap;let aa;function Rx(n,s=!1,d=aa){if(d){let _=ud.get(d);_||ud.set(d,_=[]),_.push(n)}}function Dx(n,s,d=xr){const{immediate:_,deep:w,once:P,scheduler:b,augmentJob:c,call:R}=d,Z=ye=>w?ye:Fi(ye)||w===!1||w===0?Nn(ye,1):Nn(ye);let V,H,K,G,fe=!1,Be=!1;if(eo(n)?(H=()=>n.value,fe=Fi(n)):Ts(n)?(H=()=>Z(n),fe=!0):Rt(n)?(Be=!0,fe=n.some(ye=>Ts(ye)||Fi(ye)),H=()=>n.map(ye=>{if(eo(ye))return ye.value;if(Ts(ye))return Z(ye);if(Nt(ye))return R?R(ye,2):ye()})):Nt(n)?s?H=R?()=>R(n,2):n:H=()=>{if(K){Is();try{K()}finally{Es()}}const ye=aa;aa=V;try{return R?R(n,3,[G]):n(G)}finally{aa=ye}}:H=dn,s&&w){const ye=H,Ae=w===!0?1/0:w;H=()=>Nn(ye(),Ae)}const et=Py(),We=()=>{V.stop(),et&&et.active&&Vp(et.effects,V)};if(P&&s){const ye=s;s=(...Ae)=>{ye(...Ae),We()}}let lt=Be?new Array(n.length).fill(Jh):Jh;const st=ye=>{if(!(!(V.flags&1)||!V.dirty&&!ye))if(s){const Ae=V.run();if(w||fe||(Be?Ae.some((Ye,nt)=>Ss(Ye,lt[nt])):Ss(Ae,lt))){K&&K();const Ye=aa;aa=V;try{const nt=[Ae,lt===Jh?void 0:Be&&lt[0]===Jh?[]:lt,G];R?R(s,3,nt):s(...nt),lt=Ae}finally{aa=Ye}}}else V.run()};return c&&c(st),V=new My(H),V.scheduler=b?()=>b(st,!1):st,G=ye=>Rx(ye,!1,V),K=V.onStop=()=>{const ye=ud.get(V);if(ye){if(R)R(ye,4);else for(const Ae of ye)Ae();ud.delete(V)}},s?_?st(!0):lt=V.run():b?b(st.bind(null,!0),!0):V.run(),We.pause=V.pause.bind(V),We.resume=V.resume.bind(V),We.stop=We,We}function Nn(n,s=1/0,d){if(s<=0||!Er(n)||n.__v_skip||(d=d||new Set,d.has(n)))return n;if(d.add(n),s--,eo(n))Nn(n.value,s,d);else if(Rt(n))for(let _=0;_<n.length;_++)Nn(n[_],s,d);else if(_y(n)||El(n))n.forEach(_=>{Nn(_,s,d)});else if(by(n)){for(const _ in n)Nn(n[_],s,d);for(const _ of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,_)&&Nn(n[_],s,d)}return n}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Lu(n,s,d,_){try{return _?n(..._):n()}catch(w){Md(w,s,d)}}function Xi(n,s,d,_){if(Nt(n)){const w=Lu(n,s,d,_);return w&&yy(w)&&w.catch(P=>{Md(P,s,d)}),w}if(Rt(n)){const w=[];for(let P=0;P<n.length;P++)w.push(Xi(n[P],s,d,_));return w}}function Md(n,s,d,_=!0){const w=s?s.vnode:null,{errorHandler:P,throwUnhandledErrorInProduction:b}=s&&s.appContext.config||xr;if(s){let c=s.parent;const R=s.proxy,Z=`https://vuejs.org/error-reference/#runtime-${d}`;for(;c;){const V=c.ec;if(V){for(let H=0;H<V.length;H++)if(V[H](n,R,Z)===!1)return}c=c.parent}if(P){Is(),Lu(P,null,10,[n,R,Z]),Es();return}}Bx(n,d,w,_,b)}function Bx(n,s,d,_=!0,w=!1){if(w)throw n;console.error(n)}const ei=[];let cn=-1;const Al=[];let vs=null,kl=0;const Zy=Promise.resolve();let hd=null;function tm(n){const s=hd||Zy;return n?s.then(this?n.bind(this):n):s}function Lx(n){let s=cn+1,d=ei.length;for(;s<d;){const _=s+d>>>1,w=ei[_],P=bu(w);P<n||P===n&&w.flags&2?s=_+1:d=_}return s}function rm(n){if(!(n.flags&1)){const s=bu(n),d=ei[ei.length-1];!d||!(n.flags&2)&&s>=bu(d)?ei.push(n):ei.splice(Lx(s),0,n),n.flags|=1,Gy()}}function Gy(){hd||(hd=Zy.then(Wy))}function Fx(n){Rt(n)?Al.push(...n):vs&&n.id===-1?vs.splice(kl+1,0,n):n.flags&1||(Al.push(n),n.flags|=1),Gy()}function Yg(n,s,d=cn+1){for(;d<ei.length;d++){const _=ei[d];if(_&&_.flags&2){if(n&&_.id!==n.uid)continue;ei.splice(d,1),d--,_.flags&4&&(_.flags&=-2),_(),_.flags&4||(_.flags&=-2)}}}function qy(n){if(Al.length){const s=[...new Set(Al)].sort((d,_)=>bu(d)-bu(_));if(Al.length=0,vs){vs.push(...s);return}for(vs=s,kl=0;kl<vs.length;kl++){const d=vs[kl];d.flags&4&&(d.flags&=-2),d.flags&8||d(),d.flags&=-2}vs=null,kl=0}}const bu=n=>n.id==null?n.flags&2?-1:1/0:n.id;function Wy(n){try{for(cn=0;cn<ei.length;cn++){const s=ei[cn];s&&!(s.flags&8)&&(s.flags&4&&(s.flags&=-2),Lu(s,s.i,s.i?15:14),s.flags&4||(s.flags&=-2))}}finally{for(;cn<ei.length;cn++){const s=ei[cn];s&&(s.flags&=-2)}cn=-1,ei.length=0,qy(),hd=null,(ei.length||Al.length)&&Wy()}}let _o=null,Hy=null;function dd(n){const s=_o;return _o=n,Hy=n&&n.type.__scopeId||null,s}function fd(n,s=_o,d){if(!s||n._n)return n;const _=(...w)=>{_._d&&h_(-1);const P=dd(s);let b;try{b=n(...w)}finally{dd(P),_._d&&h_(1)}return b};return _._n=!0,_._c=!0,_._d=!0,_}function Ox(n,s){if(_o===null)return n;const d=Bd(_o),_=n.dirs||(n.dirs=[]);for(let w=0;w<s.length;w++){let[P,b,c,R=xr]=s[w];P&&(Nt(P)&&(P={mounted:P,updated:P}),P.deep&&Nn(b),_.push({dir:P,instance:d,value:b,oldValue:void 0,arg:c,modifiers:R}))}return n}function oa(n,s,d,_){const w=n.dirs,P=s&&s.dirs;for(let b=0;b<w.length;b++){const c=w[b];P&&(c.oldValue=P[b].value);let R=c.dir[_];R&&(Is(),Xi(R,d,8,[n.el,c,n,s]),Es())}}const Xy=Symbol("_vte"),Ky=n=>n.__isTeleport,hu=n=>n&&(n.disabled||n.disabled===""),Jg=n=>n&&(n.defer||n.defer===""),Qg=n=>typeof SVGElement<"u"&&n instanceof SVGElement,e_=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,Sp=(n,s)=>{const d=n&&n.to;return Zr(d)?s?s(d):null:d},Yy={name:"Teleport",__isTeleport:!0,process(n,s,d,_,w,P,b,c,R,Z){const{mc:V,pc:H,pbc:K,o:{insert:G,querySelector:fe,createText:Be,createComment:et}}=Z,We=hu(s.props);let{shapeFlag:lt,children:st,dynamicChildren:ye}=s;if(n==null){const Ae=s.el=Be(""),Ye=s.anchor=Be("");G(Ae,d,_),G(Ye,d,_);const nt=(Xe,mt)=>{lt&16&&(w&&w.isCE&&(w.ce._teleportTarget=Xe),V(st,Xe,mt,w,P,b,c,R))},rt=()=>{const Xe=s.target=Sp(s.props,fe),mt=Jy(Xe,s,Be,G);Xe&&(b!=="svg"&&Qg(Xe)?b="svg":b!=="mathml"&&e_(Xe)&&(b="mathml"),We||(nt(Xe,mt),nd(s,!1)))};We&&(nt(d,Ye),nd(s,!0)),Jg(s.props)?Jo(()=>{rt(),s.el.__isMounted=!0},P):rt()}else{if(Jg(s.props)&&!n.el.__isMounted){Jo(()=>{Yy.process(n,s,d,_,w,P,b,c,R,Z),delete n.el.__isMounted},P);return}s.el=n.el,s.targetStart=n.targetStart;const Ae=s.anchor=n.anchor,Ye=s.target=n.target,nt=s.targetAnchor=n.targetAnchor,rt=hu(n.props),Xe=rt?d:Ye,mt=rt?Ae:nt;if(b==="svg"||Qg(Ye)?b="svg":(b==="mathml"||e_(Ye))&&(b="mathml"),ye?(K(n.dynamicChildren,ye,Xe,w,P,b,c),nm(n,s,!0)):R||H(n,s,Xe,mt,w,P,b,c,!1),We)rt?s.props&&n.props&&s.props.to!==n.props.to&&(s.props.to=n.props.to):Qh(s,d,Ae,Z,1);else if((s.props&&s.props.to)!==(n.props&&n.props.to)){const kt=s.target=Sp(s.props,fe);kt&&Qh(s,kt,null,Z,0)}else rt&&Qh(s,Ye,nt,Z,1);nd(s,We)}},remove(n,s,d,{um:_,o:{remove:w}},P){const{shapeFlag:b,children:c,anchor:R,targetStart:Z,targetAnchor:V,target:H,props:K}=n;if(H&&(w(Z),w(V)),P&&w(R),b&16){const G=P||!hu(K);for(let fe=0;fe<c.length;fe++){const Be=c[fe];_(Be,s,d,G,!!Be.dynamicChildren)}}},move:Qh,hydrate:$x};function Qh(n,s,d,{o:{insert:_},m:w},P=2){P===0&&_(n.targetAnchor,s,d);const{el:b,anchor:c,shapeFlag:R,children:Z,props:V}=n,H=P===2;if(H&&_(b,s,d),(!H||hu(V))&&R&16)for(let K=0;K<Z.length;K++)w(Z[K],s,d,2);H&&_(c,s,d)}function $x(n,s,d,_,w,P,{o:{nextSibling:b,parentNode:c,querySelector:R,insert:Z,createText:V}},H){const K=s.target=Sp(s.props,R);if(K){const G=hu(s.props),fe=K._lpa||K.firstChild;if(s.shapeFlag&16)if(G)s.anchor=H(b(n),s,c(n),d,_,w,P),s.targetStart=fe,s.targetAnchor=fe&&b(fe);else{s.anchor=b(n);let Be=fe;for(;Be;){if(Be&&Be.nodeType===8){if(Be.data==="teleport start anchor")s.targetStart=Be;else if(Be.data==="teleport anchor"){s.targetAnchor=Be,K._lpa=s.targetAnchor&&b(s.targetAnchor);break}}Be=b(Be)}s.targetAnchor||Jy(K,s,V,Z),H(fe&&b(fe),s,K,d,_,w,P)}nd(s,G)}return s.anchor&&b(s.anchor)}const jx=Yy;function nd(n,s){const d=n.ctx;if(d&&d.ut){let _,w;for(s?(_=n.el,w=n.anchor):(_=n.targetStart,w=n.targetAnchor);_&&_!==w;)_.nodeType===1&&_.setAttribute("data-v-owner",d.uid),_=_.nextSibling;d.ut()}}function Jy(n,s,d,_){const w=s.targetStart=d(""),P=s.targetAnchor=d("");return w[Xy]=P,n&&(_(w,n),_(P,n)),P}const bs=Symbol("_leaveCb"),ed=Symbol("_enterCb");function Nx(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ad(()=>{n.isMounted=!0}),s0(()=>{n.isUnmounting=!0}),n}const Bi=[Function,Array],Qy={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Bi,onEnter:Bi,onAfterEnter:Bi,onEnterCancelled:Bi,onBeforeLeave:Bi,onLeave:Bi,onAfterLeave:Bi,onLeaveCancelled:Bi,onBeforeAppear:Bi,onAppear:Bi,onAfterAppear:Bi,onAppearCancelled:Bi},e0=n=>{const s=n.subTree;return s.component?e0(s.component):s},Vx={name:"BaseTransition",props:Qy,setup(n,{slots:s}){const d=am(),_=Nx();return()=>{const w=s.default&&o0(s.default(),!0);if(!w||!w.length)return;const P=t0(w),b=rr(n),{mode:c}=b;if(_.isLeaving)return sp(P);const R=t_(P);if(!R)return sp(P);let Z=Tp(R,b,_,d,H=>Z=H);R.type!==ri&&xu(R,Z);let V=d.subTree&&t_(d.subTree);if(V&&V.type!==ri&&!ca(R,V)&&e0(d).type!==ri){let H=Tp(V,b,_,d);if(xu(V,H),c==="out-in"&&R.type!==ri)return _.isLeaving=!0,H.afterLeave=()=>{_.isLeaving=!1,d.job.flags&8||d.update(),delete H.afterLeave,V=void 0},sp(P);c==="in-out"&&R.type!==ri?H.delayLeave=(K,G,fe)=>{const Be=r0(_,V);Be[String(V.key)]=V,K[bs]=()=>{G(),K[bs]=void 0,delete Z.delayedLeave,V=void 0},Z.delayedLeave=()=>{fe(),delete Z.delayedLeave,V=void 0}}:V=void 0}else V&&(V=void 0);return P}}};function t0(n){let s=n[0];if(n.length>1){for(const d of n)if(d.type!==ri){s=d;break}}return s}const Ux=Vx;function r0(n,s){const{leavingVNodes:d}=n;let _=d.get(s.type);return _||(_=Object.create(null),d.set(s.type,_)),_}function Tp(n,s,d,_,w){const{appear:P,mode:b,persisted:c=!1,onBeforeEnter:R,onEnter:Z,onAfterEnter:V,onEnterCancelled:H,onBeforeLeave:K,onLeave:G,onAfterLeave:fe,onLeaveCancelled:Be,onBeforeAppear:et,onAppear:We,onAfterAppear:lt,onAppearCancelled:st}=s,ye=String(n.key),Ae=r0(d,n),Ye=(Xe,mt)=>{Xe&&Xi(Xe,_,9,mt)},nt=(Xe,mt)=>{const kt=mt[1];Ye(Xe,mt),Rt(Xe)?Xe.every(ot=>ot.length<=1)&&kt():Xe.length<=1&&kt()},rt={mode:b,persisted:c,beforeEnter(Xe){let mt=R;if(!d.isMounted)if(P)mt=et||R;else return;Xe[bs]&&Xe[bs](!0);const kt=Ae[ye];kt&&ca(n,kt)&&kt.el[bs]&&kt.el[bs](),Ye(mt,[Xe])},enter(Xe){let mt=Z,kt=V,ot=H;if(!d.isMounted)if(P)mt=We||Z,kt=lt||V,ot=st||H;else return;let At=!1;const Bt=Xe[ed]=gr=>{At||(At=!0,gr?Ye(ot,[Xe]):Ye(kt,[Xe]),rt.delayedLeave&&rt.delayedLeave(),Xe[ed]=void 0)};mt?nt(mt,[Xe,Bt]):Bt()},leave(Xe,mt){const kt=String(n.key);if(Xe[ed]&&Xe[ed](!0),d.isUnmounting)return mt();Ye(K,[Xe]);let ot=!1;const At=Xe[bs]=Bt=>{ot||(ot=!0,mt(),Bt?Ye(Be,[Xe]):Ye(fe,[Xe]),Xe[bs]=void 0,Ae[kt]===n&&delete Ae[kt])};Ae[kt]=n,G?nt(G,[Xe,At]):At()},clone(Xe){const mt=Tp(Xe,s,d,_,w);return w&&w(mt),mt}};return rt}function sp(n){if(Id(n))return n=Ps(n),n.children=null,n}function t_(n){if(!Id(n))return Ky(n.type)&&n.children?t0(n.children):n;const{shapeFlag:s,children:d}=n;if(d){if(s&16)return d[0];if(s&32&&Nt(d.default))return d.default()}}function xu(n,s){n.shapeFlag&6&&n.component?(n.transition=s,xu(n.component.subTree,s)):n.shapeFlag&128?(n.ssContent.transition=s.clone(n.ssContent),n.ssFallback.transition=s.clone(n.ssFallback)):n.transition=s}function o0(n,s=!1,d){let _=[],w=0;for(let P=0;P<n.length;P++){let b=n[P];const c=d==null?b.key:String(d)+String(b.key!=null?b.key:P);b.type===ti?(b.patchFlag&128&&w++,_=_.concat(o0(b.children,s,c))):(s||b.type!==ri)&&_.push(c!=null?Ps(b,{key:c}):b)}if(w>1)for(let P=0;P<_.length;P++)_[P].patchFlag=-2;return _}function Zx(){const n=am();return n?(n.appContext.config.idPrefix||"v")+"-"+n.ids[0]+n.ids[1]++:""}function i0(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function pd(n,s,d,_,w=!1){if(Rt(n)){n.forEach((fe,Be)=>pd(fe,s&&(Rt(s)?s[Be]:s),d,_,w));return}if(zl(_)&&!w){_.shapeFlag&512&&_.type.__asyncResolved&&_.component.subTree.component&&pd(n,s,d,_.component.subTree);return}const P=_.shapeFlag&4?Bd(_.component):_.el,b=w?null:P,{i:c,r:R}=n,Z=s&&s.r,V=c.refs===xr?c.refs={}:c.refs,H=c.setupState,K=rr(H),G=H===xr?()=>!1:fe=>lr(K,fe);if(Z!=null&&Z!==R&&(Zr(Z)?(V[Z]=null,G(Z)&&(H[Z]=null)):eo(Z)&&(Z.value=null)),Nt(R))Lu(R,c,12,[b,V]);else{const fe=Zr(R),Be=eo(R);if(fe||Be){const et=()=>{if(n.f){const We=fe?G(R)?H[R]:V[R]:R.value;w?Rt(We)&&Vp(We,P):Rt(We)?We.includes(P)||We.push(P):fe?(V[R]=[P],G(R)&&(H[R]=V[R])):(R.value=[P],n.k&&(V[n.k]=R.value))}else fe?(V[R]=b,G(R)&&(H[R]=b)):Be&&(R.value=b,n.k&&(V[n.k]=b))};b?(et.id=-1,Jo(et,d)):et()}}}Td().requestIdleCallback;Td().cancelIdleCallback;const zl=n=>!!n.type.__asyncLoader,Id=n=>n.type.__isKeepAlive;function Gx(n,s){n0(n,"a",s)}function qx(n,s){n0(n,"da",s)}function n0(n,s,d=To){const _=n.__wdc||(n.__wdc=()=>{let w=d;for(;w;){if(w.isDeactivated)return;w=w.parent}return n()});if(Ed(s,_,d),d){let w=d.parent;for(;w&&w.parent;)Id(w.parent.vnode)&&Wx(_,s,d,w),w=w.parent}}function Wx(n,s,d,_){const w=Ed(s,n,_,!0);om(()=>{Vp(_[s],w)},d)}function Ed(n,s,d=To,_=!1){if(d){const w=d[n]||(d[n]=[]),P=s.__weh||(s.__weh=(...b)=>{Is();const c=Fu(d),R=Xi(s,d,n,b);return c(),Es(),R});return _?w.unshift(P):w.push(P),P}}const Zn=n=>(s,d=To)=>{(!Su||n==="sp")&&Ed(n,(..._)=>s(..._),d)},Hx=Zn("bm"),Ad=Zn("m"),Xx=Zn("bu"),Kx=Zn("u"),s0=Zn("bum"),om=Zn("um"),Yx=Zn("sp"),Jx=Zn("rtg"),Qx=Zn("rtc");function ew(n,s=To){Ed("ec",n,s)}const a0="components",tw="directives";function rw(n,s){return l0(a0,n,!0,s)||n}const ow=Symbol.for("v-ndc");function iw(n){return l0(tw,n)}function l0(n,s,d=!0,_=!1){const w=_o||To;if(w){const P=w.type;if(n===a0){const c=qw(P,!1);if(c&&(c===s||c===Oi(s)||c===Sd(Oi(s))))return P}const b=r_(w[n]||P[n],s)||r_(w.appContext[n],s);return!b&&_?P:b}}function r_(n,s){return n&&(n[s]||n[Oi(s)]||n[Sd(Oi(s))])}function nw(n,s,d,_){let w;const P=d,b=Rt(n);if(b||Zr(n)){const c=b&&Ts(n);let R=!1;c&&(R=!Fi(n),n=Pd(n)),w=new Array(n.length);for(let Z=0,V=n.length;Z<V;Z++)w[Z]=s(R?jo(n[Z]):n[Z],Z,void 0,P)}else if(typeof n=="number"){w=new Array(n);for(let c=0;c<n;c++)w[c]=s(c+1,c,void 0,P)}else if(Er(n))if(n[Symbol.iterator])w=Array.from(n,(c,R)=>s(c,R,void 0,P));else{const c=Object.keys(n);w=new Array(c.length);for(let R=0,Z=c.length;R<Z;R++){const V=c[R];w[R]=s(n[V],V,R,P)}}else w=[];return w}function md(n,s,d={},_,w){if(_o.ce||_o.parent&&zl(_o.parent)&&_o.parent.ce)return s!=="default"&&(d.name=s),pi(),pa(ti,null,[Io("slot",d,_)],64);let P=n[s];P&&P._c&&(P._d=!1),pi();const b=P&&c0(P(d)),c=d.key||b&&b.key,R=pa(ti,{key:(c&&!Un(c)?c:`_${s}`)+""},b||[],b&&n._===1?64:-2);return R.scopeId&&(R.slotScopeIds=[R.scopeId+"-s"]),P&&P._c&&(P._d=!0),R}function c0(n){return n.some(s=>Cu(s)?!(s.type===ri||s.type===ti&&!c0(s.children)):!0)?n:null}const kp=n=>n?E0(n)?Bd(n):kp(n.parent):null,du=Eo(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>kp(n.parent),$root:n=>kp(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>h0(n),$forceUpdate:n=>n.f||(n.f=()=>{rm(n.update)}),$nextTick:n=>n.n||(n.n=tm.bind(n.proxy)),$watch:n=>Mw.bind(n)}),ap=(n,s)=>n!==xr&&!n.__isScriptSetup&&lr(n,s),sw={get({_:n},s){if(s==="__v_skip")return!0;const{ctx:d,setupState:_,data:w,props:P,accessCache:b,type:c,appContext:R}=n;let Z;if(s[0]!=="$"){const G=b[s];if(G!==void 0)switch(G){case 1:return _[s];case 2:return w[s];case 4:return d[s];case 3:return P[s]}else{if(ap(_,s))return b[s]=1,_[s];if(w!==xr&&lr(w,s))return b[s]=2,w[s];if((Z=n.propsOptions[0])&&lr(Z,s))return b[s]=3,P[s];if(d!==xr&&lr(d,s))return b[s]=4,d[s];Pp&&(b[s]=0)}}const V=du[s];let H,K;if(V)return s==="$attrs"&&$o(n.attrs,"get",""),V(n);if((H=c.__cssModules)&&(H=H[s]))return H;if(d!==xr&&lr(d,s))return b[s]=4,d[s];if(K=R.config.globalProperties,lr(K,s))return K[s]},set({_:n},s,d){const{data:_,setupState:w,ctx:P}=n;return ap(w,s)?(w[s]=d,!0):_!==xr&&lr(_,s)?(_[s]=d,!0):lr(n.props,s)||s[0]==="$"&&s.slice(1)in n?!1:(P[s]=d,!0)},has({_:{data:n,setupState:s,accessCache:d,ctx:_,appContext:w,propsOptions:P}},b){let c;return!!d[b]||n!==xr&&lr(n,b)||ap(s,b)||(c=P[0])&&lr(c,b)||lr(_,b)||lr(du,b)||lr(w.config.globalProperties,b)},defineProperty(n,s,d){return d.get!=null?n._.accessCache[s]=0:lr(d,"value")&&this.set(n,s,d.value,null),Reflect.defineProperty(n,s,d)}};function o_(n){return Rt(n)?n.reduce((s,d)=>(s[d]=null,s),{}):n}let Pp=!0;function aw(n){const s=h0(n),d=n.proxy,_=n.ctx;Pp=!1,s.beforeCreate&&i_(s.beforeCreate,n,"bc");const{data:w,computed:P,methods:b,watch:c,provide:R,inject:Z,created:V,beforeMount:H,mounted:K,beforeUpdate:G,updated:fe,activated:Be,deactivated:et,beforeDestroy:We,beforeUnmount:lt,destroyed:st,unmounted:ye,render:Ae,renderTracked:Ye,renderTriggered:nt,errorCaptured:rt,serverPrefetch:Xe,expose:mt,inheritAttrs:kt,components:ot,directives:At,filters:Bt}=s;if(Z&&lw(Z,_,null),b)for(const Et in b){const Ft=b[Et];Nt(Ft)&&(_[Et]=Ft.bind(d))}if(w){const Et=w.call(d,d);Er(Et)&&(n.data=Bu(Et))}if(Pp=!0,P)for(const Et in P){const Ft=P[Et],Ar=Nt(Ft)?Ft.bind(d,d):Nt(Ft.get)?Ft.get.bind(d,d):dn,zr=!Nt(Ft)&&Nt(Ft.set)?Ft.set.bind(d):dn,_r=$n({get:Ar,set:zr});Object.defineProperty(_,Et,{enumerable:!0,configurable:!0,get:()=>_r.value,set:or=>_r.value=or})}if(c)for(const Et in c)u0(c[Et],_,d,Et);if(R){const Et=Nt(R)?R.call(d):R;Reflect.ownKeys(Et).forEach(Ft=>{pw(Ft,Et[Ft])})}V&&i_(V,n,"c");function vt(Et,Ft){Rt(Ft)?Ft.forEach(Ar=>Et(Ar.bind(d))):Ft&&Et(Ft.bind(d))}if(vt(Hx,H),vt(Ad,K),vt(Xx,G),vt(Kx,fe),vt(Gx,Be),vt(qx,et),vt(ew,rt),vt(Qx,Ye),vt(Jx,nt),vt(s0,lt),vt(om,ye),vt(Yx,Xe),Rt(mt))if(mt.length){const Et=n.exposed||(n.exposed={});mt.forEach(Ft=>{Object.defineProperty(Et,Ft,{get:()=>d[Ft],set:Ar=>d[Ft]=Ar})})}else n.exposed||(n.exposed={});Ae&&n.render===dn&&(n.render=Ae),kt!=null&&(n.inheritAttrs=kt),ot&&(n.components=ot),At&&(n.directives=At),Xe&&i0(n)}function lw(n,s,d=dn){Rt(n)&&(n=Mp(n));for(const _ in n){const w=n[_];let P;Er(w)?"default"in w?P=fu(w.from||_,w.default,!0):P=fu(w.from||_):P=fu(w),eo(P)?Object.defineProperty(s,_,{enumerable:!0,configurable:!0,get:()=>P.value,set:b=>P.value=b}):s[_]=P}}function i_(n,s,d){Xi(Rt(n)?n.map(_=>_.bind(s.proxy)):n.bind(s.proxy),s,d)}function u0(n,s,d,_){let w=_.includes(".")?S0(d,_):()=>d[_];if(Zr(n)){const P=s[n];Nt(P)&&ki(w,P)}else if(Nt(n))ki(w,n.bind(d));else if(Er(n))if(Rt(n))n.forEach(P=>u0(P,s,d,_));else{const P=Nt(n.handler)?n.handler.bind(d):s[n.handler];Nt(P)&&ki(w,P,n)}}function h0(n){const s=n.type,{mixins:d,extends:_}=s,{mixins:w,optionsCache:P,config:{optionMergeStrategies:b}}=n.appContext,c=P.get(s);let R;return c?R=c:!w.length&&!d&&!_?R=s:(R={},w.length&&w.forEach(Z=>gd(R,Z,b,!0)),gd(R,s,b)),Er(s)&&P.set(s,R),R}function gd(n,s,d,_=!1){const{mixins:w,extends:P}=s;P&&gd(n,P,d,!0),w&&w.forEach(b=>gd(n,b,d,!0));for(const b in s)if(!(_&&b==="expose")){const c=cw[b]||d&&d[b];n[b]=c?c(n[b],s[b]):s[b]}return n}const cw={data:n_,props:s_,emits:s_,methods:nu,computed:nu,beforeCreate:Yo,created:Yo,beforeMount:Yo,mounted:Yo,beforeUpdate:Yo,updated:Yo,beforeDestroy:Yo,beforeUnmount:Yo,destroyed:Yo,unmounted:Yo,activated:Yo,deactivated:Yo,errorCaptured:Yo,serverPrefetch:Yo,components:nu,directives:nu,watch:hw,provide:n_,inject:uw};function n_(n,s){return s?n?function(){return Eo(Nt(n)?n.call(this,this):n,Nt(s)?s.call(this,this):s)}:s:n}function uw(n,s){return nu(Mp(n),Mp(s))}function Mp(n){if(Rt(n)){const s={};for(let d=0;d<n.length;d++)s[n[d]]=n[d];return s}return n}function Yo(n,s){return n?[...new Set([].concat(n,s))]:s}function nu(n,s){return n?Eo(Object.create(null),n,s):s}function s_(n,s){return n?Rt(n)&&Rt(s)?[...new Set([...n,...s])]:Eo(Object.create(null),o_(n),o_(s??{})):s}function hw(n,s){if(!n)return s;if(!s)return n;const d=Eo(Object.create(null),n);for(const _ in s)d[_]=Yo(n[_],s[_]);return d}function d0(){return{app:null,config:{isNativeTag:Gb,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let dw=0;function fw(n,s){return function(_,w=null){Nt(_)||(_=Eo({},_)),w!=null&&!Er(w)&&(w=null);const P=d0(),b=new WeakSet,c=[];let R=!1;const Z=P.app={_uid:dw++,_component:_,_props:w,_container:null,_context:P,_instance:null,version:Xw,get config(){return P.config},set config(V){},use(V,...H){return b.has(V)||(V&&Nt(V.install)?(b.add(V),V.install(Z,...H)):Nt(V)&&(b.add(V),V(Z,...H))),Z},mixin(V){return P.mixins.includes(V)||P.mixins.push(V),Z},component(V,H){return H?(P.components[V]=H,Z):P.components[V]},directive(V,H){return H?(P.directives[V]=H,Z):P.directives[V]},mount(V,H,K){if(!R){const G=Z._ceVNode||Io(_,w);return G.appContext=P,K===!0?K="svg":K===!1&&(K=void 0),n(G,V,K),R=!0,Z._container=V,V.__vue_app__=Z,Bd(G.component)}},onUnmount(V){c.push(V)},unmount(){R&&(Xi(c,Z._instance,16),n(null,Z._container),delete Z._container.__vue_app__)},provide(V,H){return P.provides[V]=H,Z},runWithContext(V){const H=ha;ha=Z;try{return V()}finally{ha=H}}};return Z}}let ha=null;function pw(n,s){if(To){let d=To.provides;const _=To.parent&&To.parent.provides;_===d&&(d=To.provides=Object.create(_)),d[n]=s}}function fu(n,s,d=!1){const _=To||_o;if(_||ha){const w=ha?ha._context.provides:_?_.parent==null?_.vnode.appContext&&_.vnode.appContext.provides:_.parent.provides:void 0;if(w&&n in w)return w[n];if(arguments.length>1)return d&&Nt(s)?s.call(_&&_.proxy):s}}function mw(){return!!(To||_o||ha)}const f0={},p0=()=>Object.create(f0),m0=n=>Object.getPrototypeOf(n)===f0;function gw(n,s,d,_=!1){const w={},P=p0();n.propsDefaults=Object.create(null),g0(n,s,w,P);for(const b in n.propsOptions[0])b in w||(w[b]=void 0);d?n.props=_?w:Sx(w):n.type.props?n.props=w:n.props=P,n.attrs=P}function _w(n,s,d,_){const{props:w,attrs:P,vnode:{patchFlag:b}}=n,c=rr(w),[R]=n.propsOptions;let Z=!1;if((_||b>0)&&!(b&16)){if(b&8){const V=n.vnode.dynamicProps;for(let H=0;H<V.length;H++){let K=V[H];if(zd(n.emitsOptions,K))continue;const G=s[K];if(R)if(lr(P,K))G!==P[K]&&(P[K]=G,Z=!0);else{const fe=Oi(K);w[fe]=Ip(R,c,fe,G,n,!1)}else G!==P[K]&&(P[K]=G,Z=!0)}}}else{g0(n,s,w,P)&&(Z=!0);let V;for(const H in c)(!s||!lr(s,H)&&((V=ma(H))===H||!lr(s,V)))&&(R?d&&(d[H]!==void 0||d[V]!==void 0)&&(w[H]=Ip(R,c,H,void 0,n,!0)):delete w[H]);if(P!==c)for(const H in P)(!s||!lr(s,H))&&(delete P[H],Z=!0)}Z&&jn(n.attrs,"set","")}function g0(n,s,d,_){const[w,P]=n.propsOptions;let b=!1,c;if(s)for(let R in s){if(lu(R))continue;const Z=s[R];let V;w&&lr(w,V=Oi(R))?!P||!P.includes(V)?d[V]=Z:(c||(c={}))[V]=Z:zd(n.emitsOptions,R)||(!(R in _)||Z!==_[R])&&(_[R]=Z,b=!0)}if(P){const R=rr(d),Z=c||xr;for(let V=0;V<P.length;V++){const H=P[V];d[H]=Ip(w,R,H,Z[H],n,!lr(Z,H))}}return b}function Ip(n,s,d,_,w,P){const b=n[d];if(b!=null){const c=lr(b,"default");if(c&&_===void 0){const R=b.default;if(b.type!==Function&&!b.skipFactory&&Nt(R)){const{propsDefaults:Z}=w;if(d in Z)_=Z[d];else{const V=Fu(w);_=Z[d]=R.call(null,s),V()}}else _=R;w.ce&&w.ce._setProp(d,_)}b[0]&&(P&&!c?_=!1:b[1]&&(_===""||_===ma(d))&&(_=!0))}return _}const yw=new WeakMap;function _0(n,s,d=!1){const _=d?yw:s.propsCache,w=_.get(n);if(w)return w;const P=n.props,b={},c=[];let R=!1;if(!Nt(n)){const V=H=>{R=!0;const[K,G]=_0(H,s,!0);Eo(b,K),G&&c.push(...G)};!d&&s.mixins.length&&s.mixins.forEach(V),n.extends&&V(n.extends),n.mixins&&n.mixins.forEach(V)}if(!P&&!R)return Er(n)&&_.set(n,Il),Il;if(Rt(P))for(let V=0;V<P.length;V++){const H=Oi(P[V]);a_(H)&&(b[H]=xr)}else if(P)for(const V in P){const H=Oi(V);if(a_(H)){const K=P[V],G=b[H]=Rt(K)||Nt(K)?{type:K}:Eo({},K),fe=G.type;let Be=!1,et=!0;if(Rt(fe))for(let We=0;We<fe.length;++We){const lt=fe[We],st=Nt(lt)&&lt.name;if(st==="Boolean"){Be=!0;break}else st==="String"&&(et=!1)}else Be=Nt(fe)&&fe.name==="Boolean";G[0]=Be,G[1]=et,(Be||lr(G,"default"))&&c.push(H)}}const Z=[b,c];return Er(n)&&_.set(n,Z),Z}function a_(n){return n[0]!=="$"&&!lu(n)}const y0=n=>n[0]==="_"||n==="$stable",im=n=>Rt(n)?n.map(un):[un(n)],vw=(n,s,d)=>{if(s._n)return s;const _=fd((...w)=>im(s(...w)),d);return _._c=!1,_},v0=(n,s,d)=>{const _=n._ctx;for(const w in n){if(y0(w))continue;const P=n[w];if(Nt(P))s[w]=vw(w,P,_);else if(P!=null){const b=im(P);s[w]=()=>b}}},b0=(n,s)=>{const d=im(s);n.slots.default=()=>d},x0=(n,s,d)=>{for(const _ in s)(d||_!=="_")&&(n[_]=s[_])},bw=(n,s,d)=>{const _=n.slots=p0();if(n.vnode.shapeFlag&32){const w=s._;w?(x0(_,s,d),d&&xy(_,"_",w,!0)):v0(s,_)}else s&&b0(n,s)},xw=(n,s,d)=>{const{vnode:_,slots:w}=n;let P=!0,b=xr;if(_.shapeFlag&32){const c=s._;c?d&&c===1?P=!1:x0(w,s,d):(P=!s.$stable,v0(s,w)),b=s}else s&&(b0(n,s),b={default:1});if(P)for(const c in w)!y0(c)&&b[c]==null&&delete w[c]},Jo=Bw;function ww(n){return Cw(n)}function Cw(n,s){const d=Td();d.__VUE__=!0;const{insert:_,remove:w,patchProp:P,createElement:b,createText:c,createComment:R,setText:Z,setElementText:V,parentNode:H,nextSibling:K,setScopeId:G=dn,insertStaticContent:fe}=n,Be=(se,pe,ke,Ge=null,Ne=null,Ve=null,it=void 0,tt=null,Je=!!pe.dynamicChildren)=>{if(se===pe)return;se&&!ca(se,pe)&&(Ge=Ao(se),or(se,Ne,Ve,!0),se=null),pe.patchFlag===-2&&(Je=!1,pe.dynamicChildren=null);const{type:Ue,ref:St,shapeFlag:at}=pe;switch(Ue){case Rd:et(se,pe,ke,Ge);break;case ri:We(se,pe,ke,Ge);break;case cp:se==null&&lt(pe,ke,Ge,it);break;case ti:ot(se,pe,ke,Ge,Ne,Ve,it,tt,Je);break;default:at&1?Ae(se,pe,ke,Ge,Ne,Ve,it,tt,Je):at&6?At(se,pe,ke,Ge,Ne,Ve,it,tt,Je):(at&64||at&128)&&Ue.process(se,pe,ke,Ge,Ne,Ve,it,tt,Je,Uo)}St!=null&&Ne&&pd(St,se&&se.ref,Ve,pe||se,!pe)},et=(se,pe,ke,Ge)=>{if(se==null)_(pe.el=c(pe.children),ke,Ge);else{const Ne=pe.el=se.el;pe.children!==se.children&&Z(Ne,pe.children)}},We=(se,pe,ke,Ge)=>{se==null?_(pe.el=R(pe.children||""),ke,Ge):pe.el=se.el},lt=(se,pe,ke,Ge)=>{[se.el,se.anchor]=fe(se.children,pe,ke,Ge,se.el,se.anchor)},st=({el:se,anchor:pe},ke,Ge)=>{let Ne;for(;se&&se!==pe;)Ne=K(se),_(se,ke,Ge),se=Ne;_(pe,ke,Ge)},ye=({el:se,anchor:pe})=>{let ke;for(;se&&se!==pe;)ke=K(se),w(se),se=ke;w(pe)},Ae=(se,pe,ke,Ge,Ne,Ve,it,tt,Je)=>{pe.type==="svg"?it="svg":pe.type==="math"&&(it="mathml"),se==null?Ye(pe,ke,Ge,Ne,Ve,it,tt,Je):Xe(se,pe,Ne,Ve,it,tt,Je)},Ye=(se,pe,ke,Ge,Ne,Ve,it,tt)=>{let Je,Ue;const{props:St,shapeFlag:at,transition:bt,dirs:It}=se;if(Je=se.el=b(se.type,Ve,St&&St.is,St),at&8?V(Je,se.children):at&16&&rt(se.children,Je,null,Ge,Ne,lp(se,Ve),it,tt),It&&oa(se,null,Ge,"created"),nt(Je,se,se.scopeId,it,Ge),St){for(const qt in St)qt!=="value"&&!lu(qt)&&P(Je,qt,null,St[qt],Ve,Ge);"value"in St&&P(Je,"value",null,St.value,Ve),(Ue=St.onVnodeBeforeMount)&&ln(Ue,Ge,se)}It&&oa(se,null,Ge,"beforeMount");const Ot=Sw(Ne,bt);Ot&&bt.beforeEnter(Je),_(Je,pe,ke),((Ue=St&&St.onVnodeMounted)||Ot||It)&&Jo(()=>{Ue&&ln(Ue,Ge,se),Ot&&bt.enter(Je),It&&oa(se,null,Ge,"mounted")},Ne)},nt=(se,pe,ke,Ge,Ne)=>{if(ke&&G(se,ke),Ge)for(let Ve=0;Ve<Ge.length;Ve++)G(se,Ge[Ve]);if(Ne){let Ve=Ne.subTree;if(pe===Ve||k0(Ve.type)&&(Ve.ssContent===pe||Ve.ssFallback===pe)){const it=Ne.vnode;nt(se,it,it.scopeId,it.slotScopeIds,Ne.parent)}}},rt=(se,pe,ke,Ge,Ne,Ve,it,tt,Je=0)=>{for(let Ue=Je;Ue<se.length;Ue++){const St=se[Ue]=tt?xs(se[Ue]):un(se[Ue]);Be(null,St,pe,ke,Ge,Ne,Ve,it,tt)}},Xe=(se,pe,ke,Ge,Ne,Ve,it)=>{const tt=pe.el=se.el;let{patchFlag:Je,dynamicChildren:Ue,dirs:St}=pe;Je|=se.patchFlag&16;const at=se.props||xr,bt=pe.props||xr;let It;if(ke&&ia(ke,!1),(It=bt.onVnodeBeforeUpdate)&&ln(It,ke,pe,se),St&&oa(pe,se,ke,"beforeUpdate"),ke&&ia(ke,!0),(at.innerHTML&&bt.innerHTML==null||at.textContent&&bt.textContent==null)&&V(tt,""),Ue?mt(se.dynamicChildren,Ue,tt,ke,Ge,lp(pe,Ne),Ve):it||Ft(se,pe,tt,null,ke,Ge,lp(pe,Ne),Ve,!1),Je>0){if(Je&16)kt(tt,at,bt,ke,Ne);else if(Je&2&&at.class!==bt.class&&P(tt,"class",null,bt.class,Ne),Je&4&&P(tt,"style",at.style,bt.style,Ne),Je&8){const Ot=pe.dynamicProps;for(let qt=0;qt<Ot.length;qt++){const Vt=Ot[qt],Dr=at[Vt],Sr=bt[Vt];(Sr!==Dr||Vt==="value")&&P(tt,Vt,Dr,Sr,Ne,ke)}}Je&1&&se.children!==pe.children&&V(tt,pe.children)}else!it&&Ue==null&&kt(tt,at,bt,ke,Ne);((It=bt.onVnodeUpdated)||St)&&Jo(()=>{It&&ln(It,ke,pe,se),St&&oa(pe,se,ke,"updated")},Ge)},mt=(se,pe,ke,Ge,Ne,Ve,it)=>{for(let tt=0;tt<pe.length;tt++){const Je=se[tt],Ue=pe[tt],St=Je.el&&(Je.type===ti||!ca(Je,Ue)||Je.shapeFlag&70)?H(Je.el):ke;Be(Je,Ue,St,null,Ge,Ne,Ve,it,!0)}},kt=(se,pe,ke,Ge,Ne)=>{if(pe!==ke){if(pe!==xr)for(const Ve in pe)!lu(Ve)&&!(Ve in ke)&&P(se,Ve,pe[Ve],null,Ne,Ge);for(const Ve in ke){if(lu(Ve))continue;const it=ke[Ve],tt=pe[Ve];it!==tt&&Ve!=="value"&&P(se,Ve,tt,it,Ne,Ge)}"value"in ke&&P(se,"value",pe.value,ke.value,Ne)}},ot=(se,pe,ke,Ge,Ne,Ve,it,tt,Je)=>{const Ue=pe.el=se?se.el:c(""),St=pe.anchor=se?se.anchor:c("");let{patchFlag:at,dynamicChildren:bt,slotScopeIds:It}=pe;It&&(tt=tt?tt.concat(It):It),se==null?(_(Ue,ke,Ge),_(St,ke,Ge),rt(pe.children||[],ke,St,Ne,Ve,it,tt,Je)):at>0&&at&64&&bt&&se.dynamicChildren?(mt(se.dynamicChildren,bt,ke,Ne,Ve,it,tt),(pe.key!=null||Ne&&pe===Ne.subTree)&&nm(se,pe,!0)):Ft(se,pe,ke,St,Ne,Ve,it,tt,Je)},At=(se,pe,ke,Ge,Ne,Ve,it,tt,Je)=>{pe.slotScopeIds=tt,se==null?pe.shapeFlag&512?Ne.ctx.activate(pe,ke,Ge,it,Je):Bt(pe,ke,Ge,Ne,Ve,it,Je):gr(se,pe,Je)},Bt=(se,pe,ke,Ge,Ne,Ve,it)=>{const tt=se.component=Nw(se,Ge,Ne);if(Id(se)&&(tt.ctx.renderer=Uo),Vw(tt,!1,it),tt.asyncDep){if(Ne&&Ne.registerDep(tt,vt,it),!se.el){const Je=tt.subTree=Io(ri);We(null,Je,pe,ke)}}else vt(tt,se,pe,ke,Ne,Ve,it)},gr=(se,pe,ke)=>{const Ge=pe.component=se.component;if(Rw(se,pe,ke))if(Ge.asyncDep&&!Ge.asyncResolved){Et(Ge,pe,ke);return}else Ge.next=pe,Ge.update();else pe.el=se.el,Ge.vnode=pe},vt=(se,pe,ke,Ge,Ne,Ve,it)=>{const tt=()=>{if(se.isMounted){let{next:at,bu:bt,u:It,parent:Ot,vnode:qt}=se;{const uo=w0(se);if(uo){at&&(at.el=qt.el,Et(se,at,it)),uo.asyncDep.then(()=>{se.isUnmounted||tt()});return}}let Vt=at,Dr;ia(se,!1),at?(at.el=qt.el,Et(se,at,it)):at=qt,bt&&tp(bt),(Dr=at.props&&at.props.onVnodeBeforeUpdate)&&ln(Dr,Ot,at,qt),ia(se,!0);const Sr=c_(se),vo=se.subTree;se.subTree=Sr,Be(vo,Sr,H(vo.el),Ao(vo),se,Ne,Ve),at.el=Sr.el,Vt===null&&Dw(se,Sr.el),It&&Jo(It,Ne),(Dr=at.props&&at.props.onVnodeUpdated)&&Jo(()=>ln(Dr,Ot,at,qt),Ne)}else{let at;const{el:bt,props:It}=pe,{bm:Ot,m:qt,parent:Vt,root:Dr,type:Sr}=se,vo=zl(pe);ia(se,!1),Ot&&tp(Ot),!vo&&(at=It&&It.onVnodeBeforeMount)&&ln(at,Vt,pe),ia(se,!0);{Dr.ce&&Dr.ce._injectChildStyle(Sr);const uo=se.subTree=c_(se);Be(null,uo,ke,Ge,se,Ne,Ve),pe.el=uo.el}if(qt&&Jo(qt,Ne),!vo&&(at=It&&It.onVnodeMounted)){const uo=pe;Jo(()=>ln(at,Vt,uo),Ne)}(pe.shapeFlag&256||Vt&&zl(Vt.vnode)&&Vt.vnode.shapeFlag&256)&&se.a&&Jo(se.a,Ne),se.isMounted=!0,pe=ke=Ge=null}};se.scope.on();const Je=se.effect=new My(tt);se.scope.off();const Ue=se.update=Je.run.bind(Je),St=se.job=Je.runIfDirty.bind(Je);St.i=se,St.id=se.uid,Je.scheduler=()=>rm(St),ia(se,!0),Ue()},Et=(se,pe,ke)=>{pe.component=se;const Ge=se.vnode.props;se.vnode=pe,se.next=null,_w(se,pe.props,Ge,ke),xw(se,pe.children,ke),Is(),Yg(se),Es()},Ft=(se,pe,ke,Ge,Ne,Ve,it,tt,Je=!1)=>{const Ue=se&&se.children,St=se?se.shapeFlag:0,at=pe.children,{patchFlag:bt,shapeFlag:It}=pe;if(bt>0){if(bt&128){zr(Ue,at,ke,Ge,Ne,Ve,it,tt,Je);return}else if(bt&256){Ar(Ue,at,ke,Ge,Ne,Ve,it,tt,Je);return}}It&8?(St&16&&yo(Ue,Ne,Ve),at!==Ue&&V(ke,at)):St&16?It&16?zr(Ue,at,ke,Ge,Ne,Ve,it,tt,Je):yo(Ue,Ne,Ve,!0):(St&8&&V(ke,""),It&16&&rt(at,ke,Ge,Ne,Ve,it,tt,Je))},Ar=(se,pe,ke,Ge,Ne,Ve,it,tt,Je)=>{se=se||Il,pe=pe||Il;const Ue=se.length,St=pe.length,at=Math.min(Ue,St);let bt;for(bt=0;bt<at;bt++){const It=pe[bt]=Je?xs(pe[bt]):un(pe[bt]);Be(se[bt],It,ke,null,Ne,Ve,it,tt,Je)}Ue>St?yo(se,Ne,Ve,!0,!1,at):rt(pe,ke,Ge,Ne,Ve,it,tt,Je,at)},zr=(se,pe,ke,Ge,Ne,Ve,it,tt,Je)=>{let Ue=0;const St=pe.length;let at=se.length-1,bt=St-1;for(;Ue<=at&&Ue<=bt;){const It=se[Ue],Ot=pe[Ue]=Je?xs(pe[Ue]):un(pe[Ue]);if(ca(It,Ot))Be(It,Ot,ke,null,Ne,Ve,it,tt,Je);else break;Ue++}for(;Ue<=at&&Ue<=bt;){const It=se[at],Ot=pe[bt]=Je?xs(pe[bt]):un(pe[bt]);if(ca(It,Ot))Be(It,Ot,ke,null,Ne,Ve,it,tt,Je);else break;at--,bt--}if(Ue>at){if(Ue<=bt){const It=bt+1,Ot=It<St?pe[It].el:Ge;for(;Ue<=bt;)Be(null,pe[Ue]=Je?xs(pe[Ue]):un(pe[Ue]),ke,Ot,Ne,Ve,it,tt,Je),Ue++}}else if(Ue>bt)for(;Ue<=at;)or(se[Ue],Ne,Ve,!0),Ue++;else{const It=Ue,Ot=Ue,qt=new Map;for(Ue=Ot;Ue<=bt;Ue++){const ge=pe[Ue]=Je?xs(pe[Ue]):un(pe[Ue]);ge.key!=null&&qt.set(ge.key,Ue)}let Vt,Dr=0;const Sr=bt-Ot+1;let vo=!1,uo=0;const gi=new Array(Sr);for(Ue=0;Ue<Sr;Ue++)gi[Ue]=0;for(Ue=It;Ue<=at;Ue++){const ge=se[Ue];if(Dr>=Sr){or(ge,Ne,Ve,!0);continue}let A;if(ge.key!=null)A=qt.get(ge.key);else for(Vt=Ot;Vt<=bt;Vt++)if(gi[Vt-Ot]===0&&ca(ge,pe[Vt])){A=Vt;break}A===void 0?or(ge,Ne,Ve,!0):(gi[A-Ot]=Ue+1,A>=uo?uo=A:vo=!0,Be(ge,pe[A],ke,null,Ne,Ve,it,tt,Je),Dr++)}const oi=vo?Tw(gi):Il;for(Vt=oi.length-1,Ue=Sr-1;Ue>=0;Ue--){const ge=Ot+Ue,A=pe[ge],U=ge+1<St?pe[ge+1].el:Ge;gi[Ue]===0?Be(null,A,ke,U,Ne,Ve,it,tt,Je):vo&&(Vt<0||Ue!==oi[Vt]?_r(A,ke,U,2):Vt--)}}},_r=(se,pe,ke,Ge,Ne=null)=>{const{el:Ve,type:it,transition:tt,children:Je,shapeFlag:Ue}=se;if(Ue&6){_r(se.component.subTree,pe,ke,Ge);return}if(Ue&128){se.suspense.move(pe,ke,Ge);return}if(Ue&64){it.move(se,pe,ke,Uo);return}if(it===ti){_(Ve,pe,ke);for(let at=0;at<Je.length;at++)_r(Je[at],pe,ke,Ge);_(se.anchor,pe,ke);return}if(it===cp){st(se,pe,ke);return}if(Ge!==2&&Ue&1&&tt)if(Ge===0)tt.beforeEnter(Ve),_(Ve,pe,ke),Jo(()=>tt.enter(Ve),Ne);else{const{leave:at,delayLeave:bt,afterLeave:It}=tt,Ot=()=>_(Ve,pe,ke),qt=()=>{at(Ve,()=>{Ot(),It&&It()})};bt?bt(Ve,Ot,qt):qt()}else _(Ve,pe,ke)},or=(se,pe,ke,Ge=!1,Ne=!1)=>{const{type:Ve,props:it,ref:tt,children:Je,dynamicChildren:Ue,shapeFlag:St,patchFlag:at,dirs:bt,cacheIndex:It}=se;if(at===-2&&(Ne=!1),tt!=null&&pd(tt,null,ke,se,!0),It!=null&&(pe.renderCache[It]=void 0),St&256){pe.ctx.deactivate(se);return}const Ot=St&1&&bt,qt=!zl(se);let Vt;if(qt&&(Vt=it&&it.onVnodeBeforeUnmount)&&ln(Vt,pe,se),St&6)Rr(se.component,ke,Ge);else{if(St&128){se.suspense.unmount(ke,Ge);return}Ot&&oa(se,null,pe,"beforeUnmount"),St&64?se.type.remove(se,pe,ke,Uo,Ge):Ue&&!Ue.hasOnce&&(Ve!==ti||at>0&&at&64)?yo(Ue,pe,ke,!1,!0):(Ve===ti&&at&384||!Ne&&St&16)&&yo(Je,pe,ke),Ge&&Gr(se)}(qt&&(Vt=it&&it.onVnodeUnmounted)||Ot)&&Jo(()=>{Vt&&ln(Vt,pe,se),Ot&&oa(se,null,pe,"unmounted")},ke)},Gr=se=>{const{type:pe,el:ke,anchor:Ge,transition:Ne}=se;if(pe===ti){Lr(ke,Ge);return}if(pe===cp){ye(se);return}const Ve=()=>{w(ke),Ne&&!Ne.persisted&&Ne.afterLeave&&Ne.afterLeave()};if(se.shapeFlag&1&&Ne&&!Ne.persisted){const{leave:it,delayLeave:tt}=Ne,Je=()=>it(ke,Ve);tt?tt(se.el,Ve,Je):Je()}else Ve()},Lr=(se,pe)=>{let ke;for(;se!==pe;)ke=K(se),w(se),se=ke;w(pe)},Rr=(se,pe,ke)=>{const{bum:Ge,scope:Ne,job:Ve,subTree:it,um:tt,m:Je,a:Ue}=se;l_(Je),l_(Ue),Ge&&tp(Ge),Ne.stop(),Ve&&(Ve.flags|=8,or(it,se,pe,ke)),tt&&Jo(tt,pe),Jo(()=>{se.isUnmounted=!0},pe),pe&&pe.pendingBranch&&!pe.isUnmounted&&se.asyncDep&&!se.asyncResolved&&se.suspenseId===pe.pendingId&&(pe.deps--,pe.deps===0&&pe.resolve())},yo=(se,pe,ke,Ge=!1,Ne=!1,Ve=0)=>{for(let it=Ve;it<se.length;it++)or(se[it],pe,ke,Ge,Ne)},Ao=se=>{if(se.shapeFlag&6)return Ao(se.component.subTree);if(se.shapeFlag&128)return se.suspense.next();const pe=K(se.anchor||se.el),ke=pe&&pe[Xy];return ke?K(ke):pe};let Vo=!1;const to=(se,pe,ke)=>{se==null?pe._vnode&&or(pe._vnode,null,null,!0):Be(pe._vnode||null,se,pe,null,null,null,ke),pe._vnode=se,Vo||(Vo=!0,Yg(),qy(),Vo=!1)},Uo={p:Be,um:or,m:_r,r:Gr,mt:Bt,mc:rt,pc:Ft,pbc:mt,n:Ao,o:n};return{render:to,hydrate:void 0,createApp:fw(to)}}function lp({type:n,props:s},d){return d==="svg"&&n==="foreignObject"||d==="mathml"&&n==="annotation-xml"&&s&&s.encoding&&s.encoding.includes("html")?void 0:d}function ia({effect:n,job:s},d){d?(n.flags|=32,s.flags|=4):(n.flags&=-33,s.flags&=-5)}function Sw(n,s){return(!n||n&&!n.pendingBranch)&&s&&!s.persisted}function nm(n,s,d=!1){const _=n.children,w=s.children;if(Rt(_)&&Rt(w))for(let P=0;P<_.length;P++){const b=_[P];let c=w[P];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=w[P]=xs(w[P]),c.el=b.el),!d&&c.patchFlag!==-2&&nm(b,c)),c.type===Rd&&(c.el=b.el)}}function Tw(n){const s=n.slice(),d=[0];let _,w,P,b,c;const R=n.length;for(_=0;_<R;_++){const Z=n[_];if(Z!==0){if(w=d[d.length-1],n[w]<Z){s[_]=w,d.push(_);continue}for(P=0,b=d.length-1;P<b;)c=P+b>>1,n[d[c]]<Z?P=c+1:b=c;Z<n[d[P]]&&(P>0&&(s[_]=d[P-1]),d[P]=_)}}for(P=d.length,b=d[P-1];P-- >0;)d[P]=b,b=s[b];return d}function w0(n){const s=n.subTree.component;if(s)return s.asyncDep&&!s.asyncResolved?s:w0(s)}function l_(n){if(n)for(let s=0;s<n.length;s++)n[s].flags|=8}const kw=Symbol.for("v-scx"),Pw=()=>fu(kw);function ki(n,s,d){return C0(n,s,d)}function C0(n,s,d=xr){const{immediate:_,deep:w,flush:P,once:b}=d,c=Eo({},d),R=s&&_||!s&&P!=="post";let Z;if(Su){if(P==="sync"){const G=Pw();Z=G.__watcherHandles||(G.__watcherHandles=[])}else if(!R){const G=()=>{};return G.stop=dn,G.resume=dn,G.pause=dn,G}}const V=To;c.call=(G,fe,Be)=>Xi(G,V,fe,Be);let H=!1;P==="post"?c.scheduler=G=>{Jo(G,V&&V.suspense)}:P!=="sync"&&(H=!0,c.scheduler=(G,fe)=>{fe?G():rm(G)}),c.augmentJob=G=>{s&&(G.flags|=4),H&&(G.flags|=2,V&&(G.id=V.uid,G.i=V))};const K=Dx(n,s,c);return Su&&(Z?Z.push(K):R&&K()),K}function Mw(n,s,d){const _=this.proxy,w=Zr(n)?n.includes(".")?S0(_,n):()=>_[n]:n.bind(_,_);let P;Nt(s)?P=s:(P=s.handler,d=s);const b=Fu(this),c=C0(w,P.bind(_),d);return b(),c}function S0(n,s){const d=s.split(".");return()=>{let _=n;for(let w=0;w<d.length&&_;w++)_=_[d[w]];return _}}const Iw=(n,s)=>s==="modelValue"||s==="model-value"?n.modelModifiers:n[`${s}Modifiers`]||n[`${Oi(s)}Modifiers`]||n[`${ma(s)}Modifiers`];function Ew(n,s,...d){if(n.isUnmounted)return;const _=n.vnode.props||xr;let w=d;const P=s.startsWith("update:"),b=P&&Iw(_,s.slice(7));b&&(b.trim&&(w=d.map(V=>Zr(V)?V.trim():V)),b.number&&(w=d.map(Kb)));let c,R=_[c=ep(s)]||_[c=ep(Oi(s))];!R&&P&&(R=_[c=ep(ma(s))]),R&&Xi(R,n,6,w);const Z=_[c+"Once"];if(Z){if(!n.emitted)n.emitted={};else if(n.emitted[c])return;n.emitted[c]=!0,Xi(Z,n,6,w)}}function T0(n,s,d=!1){const _=s.emitsCache,w=_.get(n);if(w!==void 0)return w;const P=n.emits;let b={},c=!1;if(!Nt(n)){const R=Z=>{const V=T0(Z,s,!0);V&&(c=!0,Eo(b,V))};!d&&s.mixins.length&&s.mixins.forEach(R),n.extends&&R(n.extends),n.mixins&&n.mixins.forEach(R)}return!P&&!c?(Er(n)&&_.set(n,null),null):(Rt(P)?P.forEach(R=>b[R]=null):Eo(b,P),Er(n)&&_.set(n,b),b)}function zd(n,s){return!n||!xd(s)?!1:(s=s.slice(2).replace(/Once$/,""),lr(n,s[0].toLowerCase()+s.slice(1))||lr(n,ma(s))||lr(n,s))}function c_(n){const{type:s,vnode:d,proxy:_,withProxy:w,propsOptions:[P],slots:b,attrs:c,emit:R,render:Z,renderCache:V,props:H,data:K,setupState:G,ctx:fe,inheritAttrs:Be}=n,et=dd(n);let We,lt;try{if(d.shapeFlag&4){const ye=w||_,Ae=ye;We=un(Z.call(Ae,ye,V,H,G,K,fe)),lt=c}else{const ye=s;We=un(ye.length>1?ye(H,{attrs:c,slots:b,emit:R}):ye(H,null)),lt=s.props?c:Aw(c)}}catch(ye){pu.length=0,Md(ye,n,1),We=Io(ri)}let st=We;if(lt&&Be!==!1){const ye=Object.keys(lt),{shapeFlag:Ae}=st;ye.length&&Ae&7&&(P&&ye.some(Np)&&(lt=zw(lt,P)),st=Ps(st,lt,!1,!0))}return d.dirs&&(st=Ps(st,null,!1,!0),st.dirs=st.dirs?st.dirs.concat(d.dirs):d.dirs),d.transition&&xu(st,d.transition),We=st,dd(et),We}const Aw=n=>{let s;for(const d in n)(d==="class"||d==="style"||xd(d))&&((s||(s={}))[d]=n[d]);return s},zw=(n,s)=>{const d={};for(const _ in n)(!Np(_)||!(_.slice(9)in s))&&(d[_]=n[_]);return d};function Rw(n,s,d){const{props:_,children:w,component:P}=n,{props:b,children:c,patchFlag:R}=s,Z=P.emitsOptions;if(s.dirs||s.transition)return!0;if(d&&R>=0){if(R&1024)return!0;if(R&16)return _?u_(_,b,Z):!!b;if(R&8){const V=s.dynamicProps;for(let H=0;H<V.length;H++){const K=V[H];if(b[K]!==_[K]&&!zd(Z,K))return!0}}}else return(w||c)&&(!c||!c.$stable)?!0:_===b?!1:_?b?u_(_,b,Z):!0:!!b;return!1}function u_(n,s,d){const _=Object.keys(s);if(_.length!==Object.keys(n).length)return!0;for(let w=0;w<_.length;w++){const P=_[w];if(s[P]!==n[P]&&!zd(d,P))return!0}return!1}function Dw({vnode:n,parent:s},d){for(;s;){const _=s.subTree;if(_.suspense&&_.suspense.activeBranch===n&&(_.el=n.el),_===n)(n=s.vnode).el=d,s=s.parent;else break}}const k0=n=>n.__isSuspense;function Bw(n,s){s&&s.pendingBranch?Rt(n)?s.effects.push(...n):s.effects.push(n):Fx(n)}const ti=Symbol.for("v-fgt"),Rd=Symbol.for("v-txt"),ri=Symbol.for("v-cmt"),cp=Symbol.for("v-stc"),pu=[];let Pi=null;function pi(n=!1){pu.push(Pi=n?null:[])}function Lw(){pu.pop(),Pi=pu[pu.length-1]||null}let wu=1;function h_(n,s=!1){wu+=n,n<0&&Pi&&s&&(Pi.hasOnce=!0)}function P0(n){return n.dynamicChildren=wu>0?Pi||Il:null,Lw(),wu>0&&Pi&&Pi.push(n),n}function fa(n,s,d,_,w,P){return P0(So(n,s,d,_,w,P,!0))}function pa(n,s,d,_,w){return P0(Io(n,s,d,_,w,!0))}function Cu(n){return n?n.__v_isVNode===!0:!1}function ca(n,s){return n.type===s.type&&n.key===s.key}const M0=({key:n})=>n??null,sd=({ref:n,ref_key:s,ref_for:d})=>(typeof n=="number"&&(n=""+n),n!=null?Zr(n)||eo(n)||Nt(n)?{i:_o,r:n,k:s,f:!!d}:n:null);function So(n,s=null,d=null,_=0,w=null,P=n===ti?0:1,b=!1,c=!1){const R={__v_isVNode:!0,__v_skip:!0,type:n,props:s,key:s&&M0(s),ref:s&&sd(s),scopeId:Hy,slotScopeIds:null,children:d,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:P,patchFlag:_,dynamicProps:w,dynamicChildren:null,appContext:null,ctx:_o};return c?(sm(R,d),P&128&&n.normalize(R)):d&&(R.shapeFlag|=Zr(d)?8:16),wu>0&&!b&&Pi&&(R.patchFlag>0||P&6)&&R.patchFlag!==32&&Pi.push(R),R}const Io=Fw;function Fw(n,s=null,d=null,_=0,w=null,P=!1){if((!n||n===ow)&&(n=ri),Cu(n)){const c=Ps(n,s,!0);return d&&sm(c,d),wu>0&&!P&&Pi&&(c.shapeFlag&6?Pi[Pi.indexOf(n)]=c:Pi.push(c)),c.patchFlag=-2,c}if(Ww(n)&&(n=n.__vccOpts),s){s=Ow(s);let{class:c,style:R}=s;c&&!Zr(c)&&(s.class=kd(c)),Er(R)&&(Qp(R)&&!Rt(R)&&(R=Eo({},R)),s.style=Zp(R))}const b=Zr(n)?1:k0(n)?128:Ky(n)?64:Er(n)?4:Nt(n)?2:0;return So(n,s,d,_,w,b,P,!0)}function Ow(n){return n?Qp(n)||m0(n)?Eo({},n):n:null}function Ps(n,s,d=!1,_=!1){const{props:w,ref:P,patchFlag:b,children:c,transition:R}=n,Z=s?ks(w||{},s):w,V={__v_isVNode:!0,__v_skip:!0,type:n.type,props:Z,key:Z&&M0(Z),ref:s&&s.ref?d&&P?Rt(P)?P.concat(sd(s)):[P,sd(s)]:sd(s):P,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:c,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:s&&n.type!==ti?b===-1?16:b|16:b,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:R,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Ps(n.ssContent),ssFallback:n.ssFallback&&Ps(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return R&&_&&xu(V,R.clone(V)),V}function I0(n=" ",s=0){return Io(Rd,null,n,s)}function Dd(n="",s=!1){return s?(pi(),pa(ri,null,n)):Io(ri,null,n)}function un(n){return n==null||typeof n=="boolean"?Io(ri):Rt(n)?Io(ti,null,n.slice()):Cu(n)?xs(n):Io(Rd,null,String(n))}function xs(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Ps(n)}function sm(n,s){let d=0;const{shapeFlag:_}=n;if(s==null)s=null;else if(Rt(s))d=16;else if(typeof s=="object")if(_&65){const w=s.default;w&&(w._c&&(w._d=!1),sm(n,w()),w._c&&(w._d=!0));return}else{d=32;const w=s._;!w&&!m0(s)?s._ctx=_o:w===3&&_o&&(_o.slots._===1?s._=1:(s._=2,n.patchFlag|=1024))}else Nt(s)?(s={default:s,_ctx:_o},d=32):(s=String(s),_&64?(d=16,s=[I0(s)]):d=8);n.children=s,n.shapeFlag|=d}function ks(...n){const s={};for(let d=0;d<n.length;d++){const _=n[d];for(const w in _)if(w==="class")s.class!==_.class&&(s.class=kd([s.class,_.class]));else if(w==="style")s.style=Zp([s.style,_.style]);else if(xd(w)){const P=s[w],b=_[w];b&&P!==b&&!(Rt(P)&&P.includes(b))&&(s[w]=P?[].concat(P,b):b)}else w!==""&&(s[w]=_[w])}return s}function ln(n,s,d,_=null){Xi(n,s,7,[d,_])}const $w=d0();let jw=0;function Nw(n,s,d){const _=n.type,w=(s?s.appContext:n.appContext)||$w,P={uid:jw++,vnode:n,type:_,parent:s,appContext:w,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Ty(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:s?s.provides:Object.create(w.provides),ids:s?s.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:_0(_,w),emitsOptions:T0(_,w),emit:null,emitted:null,propsDefaults:xr,inheritAttrs:_.inheritAttrs,ctx:xr,data:xr,props:xr,attrs:xr,slots:xr,refs:xr,setupState:xr,setupContext:null,suspense:d,suspenseId:d?d.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return P.ctx={_:P},P.root=s?s.root:P,P.emit=Ew.bind(null,P),n.ce&&n.ce(P),P}let To=null;const am=()=>To||_o;let _d,Ep;{const n=Td(),s=(d,_)=>{let w;return(w=n[d])||(w=n[d]=[]),w.push(_),P=>{w.length>1?w.forEach(b=>b(P)):w[0](P)}};_d=s("__VUE_INSTANCE_SETTERS__",d=>To=d),Ep=s("__VUE_SSR_SETTERS__",d=>Su=d)}const Fu=n=>{const s=To;return _d(n),n.scope.on(),()=>{n.scope.off(),_d(s)}},d_=()=>{To&&To.scope.off(),_d(null)};function E0(n){return n.vnode.shapeFlag&4}let Su=!1;function Vw(n,s=!1,d=!1){s&&Ep(s);const{props:_,children:w}=n.vnode,P=E0(n);gw(n,_,P,s),bw(n,w,d);const b=P?Uw(n,s):void 0;return s&&Ep(!1),b}function Uw(n,s){const d=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,sw);const{setup:_}=d;if(_){Is();const w=n.setupContext=_.length>1?Gw(n):null,P=Fu(n),b=Lu(_,n,0,[n.props,w]),c=yy(b);if(Es(),P(),(c||n.sp)&&!zl(n)&&i0(n),c){if(b.then(d_,d_),s)return b.then(R=>{f_(n,R)}).catch(R=>{Md(R,n,0)});n.asyncDep=b}else f_(n,b)}else A0(n)}function f_(n,s,d){Nt(s)?n.type.__ssrInlineRender?n.ssrRender=s:n.render=s:Er(s)&&(n.setupState=Uy(s)),A0(n)}function A0(n,s,d){const _=n.type;n.render||(n.render=_.render||dn);{const w=Fu(n);Is();try{aw(n)}finally{Es(),w()}}}const Zw={get(n,s){return $o(n,"get",""),n[s]}};function Gw(n){const s=d=>{n.exposed=d||{}};return{attrs:new Proxy(n.attrs,Zw),slots:n.slots,emit:n.emit,expose:s}}function Bd(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Uy(em(n.exposed)),{get(s,d){if(d in s)return s[d];if(d in du)return du[d](n)},has(s,d){return d in s||d in du}})):n.proxy}function qw(n,s=!0){return Nt(n)?n.displayName||n.name:n.name||s&&n.__name}function Ww(n){return Nt(n)&&"__vccOpts"in n}const $n=(n,s)=>zx(n,s,Su);function Hw(n,s,d){const _=arguments.length;return _===2?Er(s)&&!Rt(s)?Cu(s)?Io(n,null,[s]):Io(n,s):Io(n,null,s):(_>3?d=Array.prototype.slice.call(arguments,2):_===3&&Cu(d)&&(d=[d]),Io(n,s,d))}const Xw="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ap;const p_=typeof window<"u"&&window.trustedTypes;if(p_)try{Ap=p_.createPolicy("vue",{createHTML:n=>n})}catch{}const z0=Ap?n=>Ap.createHTML(n):n=>n,Kw="http://www.w3.org/2000/svg",Yw="http://www.w3.org/1998/Math/MathML",On=typeof document<"u"?document:null,m_=On&&On.createElement("template"),Jw={insert:(n,s,d)=>{s.insertBefore(n,d||null)},remove:n=>{const s=n.parentNode;s&&s.removeChild(n)},createElement:(n,s,d,_)=>{const w=s==="svg"?On.createElementNS(Kw,n):s==="mathml"?On.createElementNS(Yw,n):d?On.createElement(n,{is:d}):On.createElement(n);return n==="select"&&_&&_.multiple!=null&&w.setAttribute("multiple",_.multiple),w},createText:n=>On.createTextNode(n),createComment:n=>On.createComment(n),setText:(n,s)=>{n.nodeValue=s},setElementText:(n,s)=>{n.textContent=s},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>On.querySelector(n),setScopeId(n,s){n.setAttribute(s,"")},insertStaticContent(n,s,d,_,w,P){const b=d?d.previousSibling:s.lastChild;if(w&&(w===P||w.nextSibling))for(;s.insertBefore(w.cloneNode(!0),d),!(w===P||!(w=w.nextSibling)););else{m_.innerHTML=z0(_==="svg"?`<svg>${n}</svg>`:_==="mathml"?`<math>${n}</math>`:n);const c=m_.content;if(_==="svg"||_==="mathml"){const R=c.firstChild;for(;R.firstChild;)c.appendChild(R.firstChild);c.removeChild(R)}s.insertBefore(c,d)}return[b?b.nextSibling:s.firstChild,d?d.previousSibling:s.lastChild]}},gs="transition",eu="animation",Tu=Symbol("_vtc"),R0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Qw=Eo({},Qy,R0),e1=n=>(n.displayName="Transition",n.props=Qw,n),t1=e1((n,{slots:s})=>Hw(Ux,r1(n),s)),na=(n,s=[])=>{Rt(n)?n.forEach(d=>d(...s)):n&&n(...s)},g_=n=>n?Rt(n)?n.some(s=>s.length>1):n.length>1:!1;function r1(n){const s={};for(const ot in n)ot in R0||(s[ot]=n[ot]);if(n.css===!1)return s;const{name:d="v",type:_,duration:w,enterFromClass:P=`${d}-enter-from`,enterActiveClass:b=`${d}-enter-active`,enterToClass:c=`${d}-enter-to`,appearFromClass:R=P,appearActiveClass:Z=b,appearToClass:V=c,leaveFromClass:H=`${d}-leave-from`,leaveActiveClass:K=`${d}-leave-active`,leaveToClass:G=`${d}-leave-to`}=n,fe=o1(w),Be=fe&&fe[0],et=fe&&fe[1],{onBeforeEnter:We,onEnter:lt,onEnterCancelled:st,onLeave:ye,onLeaveCancelled:Ae,onBeforeAppear:Ye=We,onAppear:nt=lt,onAppearCancelled:rt=st}=s,Xe=(ot,At,Bt,gr)=>{ot._enterCancelled=gr,sa(ot,At?V:c),sa(ot,At?Z:b),Bt&&Bt()},mt=(ot,At)=>{ot._isLeaving=!1,sa(ot,H),sa(ot,G),sa(ot,K),At&&At()},kt=ot=>(At,Bt)=>{const gr=ot?nt:lt,vt=()=>Xe(At,ot,Bt);na(gr,[At,vt]),__(()=>{sa(At,ot?R:P),Ln(At,ot?V:c),g_(gr)||y_(At,_,Be,vt)})};return Eo(s,{onBeforeEnter(ot){na(We,[ot]),Ln(ot,P),Ln(ot,b)},onBeforeAppear(ot){na(Ye,[ot]),Ln(ot,R),Ln(ot,Z)},onEnter:kt(!1),onAppear:kt(!0),onLeave(ot,At){ot._isLeaving=!0;const Bt=()=>mt(ot,At);Ln(ot,H),ot._enterCancelled?(Ln(ot,K),x_()):(x_(),Ln(ot,K)),__(()=>{ot._isLeaving&&(sa(ot,H),Ln(ot,G),g_(ye)||y_(ot,_,et,Bt))}),na(ye,[ot,Bt])},onEnterCancelled(ot){Xe(ot,!1,void 0,!0),na(st,[ot])},onAppearCancelled(ot){Xe(ot,!0,void 0,!0),na(rt,[ot])},onLeaveCancelled(ot){mt(ot),na(Ae,[ot])}})}function o1(n){if(n==null)return null;if(Er(n))return[up(n.enter),up(n.leave)];{const s=up(n);return[s,s]}}function up(n){return Yb(n)}function Ln(n,s){s.split(/\s+/).forEach(d=>d&&n.classList.add(d)),(n[Tu]||(n[Tu]=new Set)).add(s)}function sa(n,s){s.split(/\s+/).forEach(_=>_&&n.classList.remove(_));const d=n[Tu];d&&(d.delete(s),d.size||(n[Tu]=void 0))}function __(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let i1=0;function y_(n,s,d,_){const w=n._endId=++i1,P=()=>{w===n._endId&&_()};if(d!=null)return setTimeout(P,d);const{type:b,timeout:c,propCount:R}=n1(n,s);if(!b)return _();const Z=b+"end";let V=0;const H=()=>{n.removeEventListener(Z,K),P()},K=G=>{G.target===n&&++V>=R&&H()};setTimeout(()=>{V<R&&H()},c+1),n.addEventListener(Z,K)}function n1(n,s){const d=window.getComputedStyle(n),_=fe=>(d[fe]||"").split(", "),w=_(`${gs}Delay`),P=_(`${gs}Duration`),b=v_(w,P),c=_(`${eu}Delay`),R=_(`${eu}Duration`),Z=v_(c,R);let V=null,H=0,K=0;s===gs?b>0&&(V=gs,H=b,K=P.length):s===eu?Z>0&&(V=eu,H=Z,K=R.length):(H=Math.max(b,Z),V=H>0?b>Z?gs:eu:null,K=V?V===gs?P.length:R.length:0);const G=V===gs&&/\b(transform|all)(,|$)/.test(_(`${gs}Property`).toString());return{type:V,timeout:H,propCount:K,hasTransform:G}}function v_(n,s){for(;n.length<s.length;)n=n.concat(n);return Math.max(...s.map((d,_)=>b_(d)+b_(n[_])))}function b_(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function x_(){return document.body.offsetHeight}function s1(n,s,d){const _=n[Tu];_&&(s=(s?[s,..._]:[..._]).join(" ")),s==null?n.removeAttribute("class"):d?n.setAttribute("class",s):n.className=s}const w_=Symbol("_vod"),a1=Symbol("_vsh"),l1=Symbol(""),c1=/(^|;)\s*display\s*:/;function u1(n,s,d){const _=n.style,w=Zr(d);let P=!1;if(d&&!w){if(s)if(Zr(s))for(const b of s.split(";")){const c=b.slice(0,b.indexOf(":")).trim();d[c]==null&&ad(_,c,"")}else for(const b in s)d[b]==null&&ad(_,b,"");for(const b in d)b==="display"&&(P=!0),ad(_,b,d[b])}else if(w){if(s!==d){const b=_[l1];b&&(d+=";"+b),_.cssText=d,P=c1.test(d)}}else s&&n.removeAttribute("style");w_ in n&&(n[w_]=P?_.display:"",n[a1]&&(_.display="none"))}const C_=/\s*!important$/;function ad(n,s,d){if(Rt(d))d.forEach(_=>ad(n,s,_));else if(d==null&&(d=""),s.startsWith("--"))n.setProperty(s,d);else{const _=h1(n,s);C_.test(d)?n.setProperty(ma(_),d.replace(C_,""),"important"):n[_]=d}}const S_=["Webkit","Moz","ms"],hp={};function h1(n,s){const d=hp[s];if(d)return d;let _=Oi(s);if(_!=="filter"&&_ in n)return hp[s]=_;_=Sd(_);for(let w=0;w<S_.length;w++){const P=S_[w]+_;if(P in n)return hp[s]=P}return s}const T_="http://www.w3.org/1999/xlink";function k_(n,s,d,_,w,P=ox(s)){_&&s.startsWith("xlink:")?d==null?n.removeAttributeNS(T_,s.slice(6,s.length)):n.setAttributeNS(T_,s,d):d==null||P&&!wy(d)?n.removeAttribute(s):n.setAttribute(s,P?"":Un(d)?String(d):d)}function P_(n,s,d,_,w){if(s==="innerHTML"||s==="textContent"){d!=null&&(n[s]=s==="innerHTML"?z0(d):d);return}const P=n.tagName;if(s==="value"&&P!=="PROGRESS"&&!P.includes("-")){const c=P==="OPTION"?n.getAttribute("value")||"":n.value,R=d==null?n.type==="checkbox"?"on":"":String(d);(c!==R||!("_value"in n))&&(n.value=R),d==null&&n.removeAttribute(s),n._value=d;return}let b=!1;if(d===""||d==null){const c=typeof n[s];c==="boolean"?d=wy(d):d==null&&c==="string"?(d="",b=!0):c==="number"&&(d=0,b=!0)}try{n[s]=d}catch{}b&&n.removeAttribute(w||s)}function d1(n,s,d,_){n.addEventListener(s,d,_)}function f1(n,s,d,_){n.removeEventListener(s,d,_)}const M_=Symbol("_vei");function p1(n,s,d,_,w=null){const P=n[M_]||(n[M_]={}),b=P[s];if(_&&b)b.value=_;else{const[c,R]=m1(s);if(_){const Z=P[s]=y1(_,w);d1(n,c,Z,R)}else b&&(f1(n,c,b,R),P[s]=void 0)}}const I_=/(?:Once|Passive|Capture)$/;function m1(n){let s;if(I_.test(n)){s={};let _;for(;_=n.match(I_);)n=n.slice(0,n.length-_[0].length),s[_[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):ma(n.slice(2)),s]}let dp=0;const g1=Promise.resolve(),_1=()=>dp||(g1.then(()=>dp=0),dp=Date.now());function y1(n,s){const d=_=>{if(!_._vts)_._vts=Date.now();else if(_._vts<=d.attached)return;Xi(v1(_,d.value),s,5,[_])};return d.value=n,d.attached=_1(),d}function v1(n,s){if(Rt(s)){const d=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{d.call(n),n._stopped=!0},s.map(_=>w=>!w._stopped&&_&&_(w))}else return s}const E_=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,b1=(n,s,d,_,w,P)=>{const b=w==="svg";s==="class"?s1(n,_,b):s==="style"?u1(n,d,_):xd(s)?Np(s)||p1(n,s,d,_,P):(s[0]==="."?(s=s.slice(1),!0):s[0]==="^"?(s=s.slice(1),!1):x1(n,s,_,b))?(P_(n,s,_),!n.tagName.includes("-")&&(s==="value"||s==="checked"||s==="selected")&&k_(n,s,_,b,P,s!=="value")):n._isVueCE&&(/[A-Z]/.test(s)||!Zr(_))?P_(n,Oi(s),_,P,s):(s==="true-value"?n._trueValue=_:s==="false-value"&&(n._falseValue=_),k_(n,s,_,b))};function x1(n,s,d,_){if(_)return!!(s==="innerHTML"||s==="textContent"||s in n&&E_(s)&&Nt(d));if(s==="spellcheck"||s==="draggable"||s==="translate"||s==="form"||s==="list"&&n.tagName==="INPUT"||s==="type"&&n.tagName==="TEXTAREA")return!1;if(s==="width"||s==="height"){const w=n.tagName;if(w==="IMG"||w==="VIDEO"||w==="CANVAS"||w==="SOURCE")return!1}return E_(s)&&Zr(d)?!1:s in n}const w1=Eo({patchProp:b1},Jw);let A_;function C1(){return A_||(A_=ww(w1))}const S1=(...n)=>{const s=C1().createApp(...n),{mount:d}=s;return s.mount=_=>{const w=k1(_);if(!w)return;const P=s._component;!Nt(P)&&!P.render&&!P.template&&(P.template=w.innerHTML),w.nodeType===1&&(w.textContent="");const b=d(w,!1,T1(w));return w instanceof Element&&(w.removeAttribute("v-cloak"),w.setAttribute("data-v-app","")),b},s};function T1(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function k1(n){return Zr(n)?document.querySelector(n):n}/*!
 * pinia v3.0.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let D0;const Ld=n=>D0=n,B0=Symbol();function zp(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var mu;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(mu||(mu={}));function P1(){const n=ky(!0),s=n.run(()=>No({}));let d=[],_=[];const w=em({install(P){Ld(w),w._a=P,P.provide(B0,w),P.config.globalProperties.$pinia=w,_.forEach(b=>d.push(b)),_=[]},use(P){return this._a?d.push(P):_.push(P),this},_p:d,_a:null,_e:n,_s:new Map,state:s});return w}const L0=()=>{};function z_(n,s,d,_=L0){n.push(s);const w=()=>{const P=n.indexOf(s);P>-1&&(n.splice(P,1),_())};return!d&&Py()&&ix(w),w}function Sl(n,...s){n.slice().forEach(d=>{d(...s)})}const M1=n=>n(),R_=Symbol(),fp=Symbol();function Rp(n,s){n instanceof Map&&s instanceof Map?s.forEach((d,_)=>n.set(_,d)):n instanceof Set&&s instanceof Set&&s.forEach(n.add,n);for(const d in s){if(!s.hasOwnProperty(d))continue;const _=s[d],w=n[d];zp(w)&&zp(_)&&n.hasOwnProperty(d)&&!eo(_)&&!Ts(_)?n[d]=Rp(w,_):n[d]=_}return n}const I1=Symbol();function E1(n){return!zp(n)||!n.hasOwnProperty(I1)}const{assign:ys}=Object;function A1(n){return!!(eo(n)&&n.effect)}function z1(n,s,d,_){const{state:w,actions:P,getters:b}=s,c=d.state.value[n];let R;function Z(){c||(d.state.value[n]=w?w():{});const V=Mx(d.state.value[n]);return ys(V,P,Object.keys(b||{}).reduce((H,K)=>(H[K]=em($n(()=>{Ld(d);const G=d._s.get(n);return b[K].call(G,G)})),H),{}))}return R=F0(n,Z,s,d,_,!0),R}function F0(n,s,d={},_,w,P){let b;const c=ys({actions:{}},d),R={deep:!0};let Z,V,H=[],K=[],G;const fe=_.state.value[n];!P&&!fe&&(_.state.value[n]={}),No({});let Be;function et(rt){let Xe;Z=V=!1,typeof rt=="function"?(rt(_.state.value[n]),Xe={type:mu.patchFunction,storeId:n,events:G}):(Rp(_.state.value[n],rt),Xe={type:mu.patchObject,payload:rt,storeId:n,events:G});const mt=Be=Symbol();tm().then(()=>{Be===mt&&(Z=!0)}),V=!0,Sl(H,Xe,_.state.value[n])}const We=P?function(){const{state:Xe}=d,mt=Xe?Xe():{};this.$patch(kt=>{ys(kt,mt)})}:L0;function lt(){b.stop(),H=[],K=[],_._s.delete(n)}const st=(rt,Xe="")=>{if(R_ in rt)return rt[fp]=Xe,rt;const mt=function(){Ld(_);const kt=Array.from(arguments),ot=[],At=[];function Bt(Et){ot.push(Et)}function gr(Et){At.push(Et)}Sl(K,{args:kt,name:mt[fp],store:Ae,after:Bt,onError:gr});let vt;try{vt=rt.apply(this&&this.$id===n?this:Ae,kt)}catch(Et){throw Sl(At,Et),Et}return vt instanceof Promise?vt.then(Et=>(Sl(ot,Et),Et)).catch(Et=>(Sl(At,Et),Promise.reject(Et))):(Sl(ot,vt),vt)};return mt[R_]=!0,mt[fp]=Xe,mt},ye={_p:_,$id:n,$onAction:z_.bind(null,K),$patch:et,$reset:We,$subscribe(rt,Xe={}){const mt=z_(H,rt,Xe.detached,()=>kt()),kt=b.run(()=>ki(()=>_.state.value[n],ot=>{(Xe.flush==="sync"?V:Z)&&rt({storeId:n,type:mu.direct,events:G},ot)},ys({},R,Xe)));return mt},$dispose:lt},Ae=Bu(ye);_._s.set(n,Ae);const nt=(_._a&&_._a.runWithContext||M1)(()=>_._e.run(()=>(b=ky()).run(()=>s({action:st}))));for(const rt in nt){const Xe=nt[rt];if(eo(Xe)&&!A1(Xe)||Ts(Xe))P||(fe&&E1(Xe)&&(eo(Xe)?Xe.value=fe[rt]:Rp(Xe,fe[rt])),_.state.value[n][rt]=Xe);else if(typeof Xe=="function"){const mt=st(Xe,rt);nt[rt]=mt,c.actions[rt]=Xe}}return ys(Ae,nt),ys(rr(Ae),nt),Object.defineProperty(Ae,"$state",{get:()=>_.state.value[n],set:rt=>{et(Xe=>{ys(Xe,rt)})}}),_._p.forEach(rt=>{ys(Ae,b.run(()=>rt({store:Ae,app:_._a,pinia:_,options:c})))}),fe&&P&&d.hydrate&&d.hydrate(Ae.$state,fe),Z=!0,V=!0,Ae}/*! #__NO_SIDE_EFFECTS__ */function R1(n,s,d){let _;const w=typeof s=="function";_=w?d:s;function P(b,c){const R=mw();return b=b||(R?fu(B0,null):null),b&&Ld(b),b=D0,b._s.has(n)||(w?F0(n,s,_,b):z1(n,_,b)),b._s.get(n)}return P.$id=n,P}const D1="csrfToken",D_="djangoSlot",B1={install(n,s){var _;n.config.globalProperties.$djangoSlots={};for(const w of s.rootElement.children)w instanceof HTMLElement&&D_ in w.dataset&&(n.config.globalProperties.$djangoSlots[w.dataset[D_]]=w.outerHTML);n.config.globalProperties.$rootElement=s.rootElement;const d=window.vueProvided||{};Object.keys(d).forEach(w=>{n.provide(w,d[w])}),n.provide(D1,(_=window.document.querySelector("[name=csrfmiddlewaretoken]"))==null?void 0:_.value)}},L1=({dataset:n,component:s})=>(Object.keys(n).forEach(function(_){if(_ in s.props){const w=s.props[_].type;n[_]=w===Date?new w(n[_]):w(n[_])}}),n);var F1=Object.defineProperty,B_=Object.getOwnPropertySymbols,O1=Object.prototype.hasOwnProperty,$1=Object.prototype.propertyIsEnumerable,L_=(n,s,d)=>s in n?F1(n,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):n[s]=d,j1=(n,s)=>{for(var d in s||(s={}))O1.call(s,d)&&L_(n,d,s[d]);if(B_)for(var d of B_(s))$1.call(s,d)&&L_(n,d,s[d]);return n};function Fd(n){return n==null||n===""||Array.isArray(n)&&n.length===0||!(n instanceof Date)&&typeof n=="object"&&Object.keys(n).length===0}function lm(n){return typeof n=="function"&&"call"in n&&"apply"in n}function Ir(n){return!Fd(n)}function fn(n,s=!0){return n instanceof Object&&n.constructor===Object&&(s||Object.keys(n).length!==0)}function O0(n={},s={}){const d=j1({},n);return Object.keys(s).forEach(_=>{const w=_;fn(s[w])&&w in n&&fn(n[w])?d[w]=O0(n[w],s[w]):d[w]=s[w]}),d}function N1(...n){return n.reduce((s,d,_)=>_===0?d:O0(s,d),{})}function Li(n,...s){return lm(n)?n(...s):n}function mi(n,s=!0){return typeof n=="string"&&(s||n!=="")}function hn(n){return mi(n)?n.replace(/(-|_)/g,"").toLowerCase():n}function cm(n,s="",d={}){const _=hn(s).split("."),w=_.shift();if(w){if(fn(n)){const P=Object.keys(n).find(b=>hn(b)===w)||"";return cm(Li(n[P],d),_.join("."),d)}return}return Li(n,d)}function Od(n,s=!0){return Array.isArray(n)&&(s||n.length!==0)}function V1(n){return Ir(n)&&!isNaN(n)}function Vn(n,s){if(s){const d=s.test(n);return s.lastIndex=0,d}return!1}function U1(...n){return N1(...n)}function gu(n){return n&&n.replace(/\/\*(?:(?!\*\/)[\s\S])*\*\/|[\r\n\t]+/g,"").replace(/ {2,}/g," ").replace(/ ([{:}]) /g,"$1").replace(/([;,]) /g,"$1").replace(/ !/g,"!").replace(/: /g,":")}function Z1(n){return mi(n,!1)?n[0].toUpperCase()+n.slice(1):n}function $0(n){return mi(n)?n.replace(/(_)/g,"-").replace(/[A-Z]/g,(s,d)=>d===0?s:"-"+s.toLowerCase()).toLowerCase():n}function F_(n){return mi(n)?n.replace(/[A-Z]/g,(s,d)=>d===0?s:"."+s.toLowerCase()).toLowerCase():n}function um(){const n=new Map;return{on(s,d){let _=n.get(s);return _?_.push(d):_=[d],n.set(s,_),this},off(s,d){const _=n.get(s);return _&&_.splice(_.indexOf(d)>>>0,1),this},emit(s,d){const _=n.get(s);_&&_.forEach(w=>{w(d)})},clear(){n.clear()}}}function G1(n,s){return n?n.classList?n.classList.contains(s):new RegExp("(^| )"+s+"( |$)","gi").test(n.className):!1}function j0(n,s){if(n&&s){const d=_=>{G1(n,_)||(n.classList?n.classList.add(_):n.className+=" "+_)};[s].flat().filter(Boolean).forEach(_=>_.split(" ").forEach(d))}}function pp(n,s){if(n&&s){const d=_=>{n.classList?n.classList.remove(_):n.className=n.className.replace(new RegExp("(^|\\b)"+_.split(" ").join("|")+"(\\b|$)","gi")," ")};[s].flat().filter(Boolean).forEach(_=>_.split(" ").forEach(d))}}function O_(n){for(const s of document==null?void 0:document.styleSheets)try{for(const d of s==null?void 0:s.cssRules)for(const _ of d==null?void 0:d.style)if(n.test(_))return{name:_,value:d.style.getPropertyValue(_).trim()}}catch{}return null}function q1(n){const s={width:0,height:0};return n&&(n.style.visibility="hidden",n.style.display="block",s.width=n.offsetWidth,s.height=n.offsetHeight,n.style.display="none",n.style.visibility="visible"),s}function W1(){const n=window,s=document,d=s.documentElement,_=s.getElementsByTagName("body")[0],w=n.innerWidth||d.clientWidth||_.clientWidth,P=n.innerHeight||d.clientHeight||_.clientHeight;return{width:w,height:P}}function Dp(n){return n?Math.abs(n.scrollLeft):0}function H1(){const n=document.documentElement;return(window.pageXOffset||Dp(n))-(n.clientLeft||0)}function X1(){const n=document.documentElement;return(window.pageYOffset||n.scrollTop)-(n.clientTop||0)}function K1(n,s,d=!0){var _,w,P,b;if(n){const c=n.offsetParent?{width:n.offsetWidth,height:n.offsetHeight}:q1(n),R=c.height,Z=c.width,V=s.offsetHeight,H=s.offsetWidth,K=s.getBoundingClientRect(),G=X1(),fe=H1(),Be=W1();let et,We,lt="top";K.top+V+R>Be.height?(et=K.top+G-R,lt="bottom",et<0&&(et=G)):et=V+K.top+G,K.left+Z>Be.width?We=Math.max(0,K.left+fe+H-Z):We=K.left+fe,n.style.top=et+"px",n.style.insetInlineStart=We+"px",n.style.transformOrigin=lt,d&&(n.style.marginTop=lt==="bottom"?`calc(${(w=(_=O_(/-anchor-gutter$/))==null?void 0:_.value)!=null?w:"2px"} * -1)`:(b=(P=O_(/-anchor-gutter$/))==null?void 0:P.value)!=null?b:"")}}function Y1(n,s){n&&(typeof s=="string"?n.style.cssText=s:Object.entries(s||{}).forEach(([d,_])=>n.style[d]=_))}function J1(n,s){return n instanceof HTMLElement?n.offsetWidth:0}function N0(n){if(n){let s=n.parentNode;return s&&s instanceof ShadowRoot&&s.host&&(s=s.host),s}return null}function Q1(n){return!!(n!==null&&typeof n<"u"&&n.nodeName&&N0(n))}function ga(n){return typeof HTMLElement<"u"?n instanceof HTMLElement:n!==null&&typeof n=="object"&&n.nodeType===1&&typeof n.nodeName=="string"}function yd(n,s={}){if(ga(n)){const d=(_,w)=>{var P,b;const c=(P=n==null?void 0:n.$attrs)!=null&&P[_]?[(b=n==null?void 0:n.$attrs)==null?void 0:b[_]]:[];return[w].flat().reduce((R,Z)=>{if(Z!=null){const V=typeof Z;if(V==="string"||V==="number")R.push(Z);else if(V==="object"){const H=Array.isArray(Z)?d(_,Z):Object.entries(Z).map(([K,G])=>_==="style"&&(G||G===0)?`${K.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${G}`:G?K:void 0);R=H.length?R.concat(H.filter(K=>!!K)):R}}return R},c)};Object.entries(s).forEach(([_,w])=>{if(w!=null){const P=_.match(/^on(.+)/);P?n.addEventListener(P[1].toLowerCase(),w):_==="p-bind"||_==="pBind"?yd(n,w):(w=_==="class"?[...new Set(d("class",w))].join(" ").trim():_==="style"?d("style",w).join(";").trim():w,(n.$attrs=n.$attrs||{})&&(n.$attrs[_]=w),n.setAttribute(_,w))}})}}function V0(n,s={},...d){{const _=document.createElement(n);return yd(_,s),_.append(...d),_}}function e2(n,s){return ga(n)?Array.from(n.querySelectorAll(s)):[]}function U0(n,s){return ga(n)?n.matches(s)?n:n.querySelector(s):null}function su(n,s){n&&document.activeElement!==n&&n.focus(s)}function t2(n,s){if(ga(n)){const d=n.getAttribute(s);return isNaN(d)?d==="true"||d==="false"?d==="true":d:+d}}function Z0(n,s=""){const d=e2(n,`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s}`),_=[];for(const w of d)getComputedStyle(w).display!="none"&&getComputedStyle(w).visibility!="hidden"&&_.push(w);return _}function tu(n,s){const d=Z0(n,s);return d.length>0?d[0]:null}function $_(n){if(n){let s=n.offsetHeight;const d=getComputedStyle(n);return s-=parseFloat(d.paddingTop)+parseFloat(d.paddingBottom)+parseFloat(d.borderTopWidth)+parseFloat(d.borderBottomWidth),s}return 0}function r2(n,s){const d=Z0(n,s);return d.length>0?d[d.length-1]:null}function Bp(n){if(n){const s=n.getBoundingClientRect();return{top:s.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:s.left+(window.pageXOffset||Dp(document.documentElement)||Dp(document.body)||0)}}return{top:"auto",left:"auto"}}function o2(n,s){return n?n.offsetHeight:0}function G0(n,s=[]){const d=N0(n);return d===null?s:G0(d,s.concat([d]))}function i2(n){const s=[];if(n){const d=G0(n),_=/(auto|scroll)/,w=P=>{try{const b=window.getComputedStyle(P,null);return _.test(b.getPropertyValue("overflow"))||_.test(b.getPropertyValue("overflowX"))||_.test(b.getPropertyValue("overflowY"))}catch{return!1}};for(const P of d){const b=P.nodeType===1&&P.dataset.scrollselectors;if(b){const c=b.split(",");for(const R of c){const Z=U0(P,R);Z&&w(Z)&&s.push(Z)}}P.nodeType!==9&&w(P)&&s.push(P)}}return s}function j_(n){if(n){let s=n.offsetWidth;const d=getComputedStyle(n);return s-=parseFloat(d.paddingLeft)+parseFloat(d.paddingRight)+parseFloat(d.borderLeftWidth)+parseFloat(d.borderRightWidth),s}return 0}function hm(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function N_(n,s=""){return ga(n)?n.matches(`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s},
            [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${s}`):!1}function n2(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function q0(n,s="",d){ga(n)&&d!==null&&d!==void 0&&n.setAttribute(s,d)}var td={};function s2(n="pui_id_"){return Object.hasOwn(td,n)||(td[n]=0),td[n]++,`${n}${td[n]}`}function a2(){let n=[];const s=(b,c,R=999)=>{const Z=w(b,c,R),V=Z.value+(Z.key===b?0:R)+1;return n.push({key:b,value:V}),V},d=b=>{n=n.filter(c=>c.value!==b)},_=(b,c)=>w(b).value,w=(b,c,R=0)=>[...n].reverse().find(Z=>!0)||{key:b,value:R},P=b=>b&&parseInt(b.style.zIndex,10)||0;return{get:P,set:(b,c,R)=>{c&&(c.style.zIndex=String(s(b,!0,R)))},clear:b=>{b&&(d(P(b)),b.style.zIndex="")},getCurrent:b=>_(b)}}var mp=a2(),l2=Object.defineProperty,c2=Object.defineProperties,u2=Object.getOwnPropertyDescriptors,vd=Object.getOwnPropertySymbols,W0=Object.prototype.hasOwnProperty,H0=Object.prototype.propertyIsEnumerable,V_=(n,s,d)=>s in n?l2(n,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):n[s]=d,Wi=(n,s)=>{for(var d in s||(s={}))W0.call(s,d)&&V_(n,d,s[d]);if(vd)for(var d of vd(s))H0.call(s,d)&&V_(n,d,s[d]);return n},gp=(n,s)=>c2(n,u2(s)),Fn=(n,s)=>{var d={};for(var _ in n)W0.call(n,_)&&s.indexOf(_)<0&&(d[_]=n[_]);if(n!=null&&vd)for(var _ of vd(n))s.indexOf(_)<0&&H0.call(n,_)&&(d[_]=n[_]);return d},h2=um(),Mo=h2;function U_(n,s){Od(n)?n.push(...s||[]):fn(n)&&Object.assign(n,s)}function d2(n){return fn(n)&&n.hasOwnProperty("$value")&&n.hasOwnProperty("$type")?n.$value:n}function f2(n){return n.replaceAll(/ /g,"").replace(/[^\w]/g,"-")}function Lp(n="",s=""){return f2(`${mi(n,!1)&&mi(s,!1)?`${n}-`:n}${s}`)}function X0(n="",s=""){return`--${Lp(n,s)}`}function p2(n=""){const s=(n.match(/{/g)||[]).length,d=(n.match(/}/g)||[]).length;return(s+d)%2!==0}function K0(n,s="",d="",_=[],w){if(mi(n)){const P=/{([^}]*)}/g,b=n.trim();if(p2(b))return;if(Vn(b,P)){const c=b.replaceAll(P,V=>{const K=V.replace(/{|}/g,"").split(".").filter(G=>!_.some(fe=>Vn(G,fe)));return`var(${X0(d,$0(K.join("-")))}${Ir(w)?`, ${w}`:""})`}),R=/(\d+\s+[\+\-\*\/]\s+\d+)/g,Z=/var\([^)]+\)/g;return Vn(c.replace(Z,"0"),R)?`calc(${c})`:c}return b}else if(V1(n))return n}function m2(n,s,d){mi(s,!1)&&n.push(`${s}:${d};`)}function Pl(n,s){return n?`${n}{${s}}`:""}var g2=n=>{var s;const d=dr.getTheme(),_=Fp(d,n,void 0,"variable"),w=(s=_==null?void 0:_.match(/--[\w-]+/g))==null?void 0:s[0],P=Fp(d,n,void 0,"value");return{name:w,variable:_,value:P}},_u=(...n)=>Fp(dr.getTheme(),...n),Fp=(n={},s,d,_)=>{if(s){const{variable:w,options:P}=dr.defaults||{},{prefix:b,transform:c}=(n==null?void 0:n.options)||P||{},Z=Vn(s,/{([^}]*)}/g)?s:`{${s}}`;return _==="value"||Fd(_)&&c==="strict"?dr.getTokenValue(s):K0(Z,void 0,b,[w.excludedKeyRegex],d)}return""};function _2(n,s={}){const d=dr.defaults.variable,{prefix:_=d.prefix,selector:w=d.selector,excludedKeyRegex:P=d.excludedKeyRegex}=s,b=(Z,V="")=>Object.entries(Z).reduce((H,[K,G])=>{const fe=Vn(K,P)?Lp(V):Lp(V,$0(K)),Be=d2(G);if(fn(Be)){const{variables:et,tokens:We}=b(Be,fe);U_(H.tokens,We),U_(H.variables,et)}else H.tokens.push((_?fe.replace(`${_}-`,""):fe).replaceAll("-",".")),m2(H.variables,X0(fe),K0(Be,fe,_,[P]));return H},{variables:[],tokens:[]}),{variables:c,tokens:R}=b(n,_);return{value:c,tokens:R,declarations:c.join(""),css:Pl(w,c.join(""))}}var qi={regex:{rules:{class:{pattern:/^\.([a-zA-Z][\w-]*)$/,resolve(n){return{type:"class",selector:n,matched:this.pattern.test(n.trim())}}},attr:{pattern:/^\[(.*)\]$/,resolve(n){return{type:"attr",selector:`:root${n}`,matched:this.pattern.test(n.trim())}}},media:{pattern:/^@media (.*)$/,resolve(n){return{type:"media",selector:`${n}{:root{[CSS]}}`,matched:this.pattern.test(n.trim())}}},system:{pattern:/^system$/,resolve(n){return{type:"system",selector:"@media (prefers-color-scheme: dark){:root{[CSS]}}",matched:this.pattern.test(n.trim())}}},custom:{resolve(n){return{type:"custom",selector:n,matched:!0}}}},resolve(n){const s=Object.keys(this.rules).filter(d=>d!=="custom").map(d=>this.rules[d]);return[n].flat().map(d=>{var _;return(_=s.map(w=>w.resolve(d)).find(w=>w.matched))!=null?_:this.rules.custom.resolve(d)})}},_toVariables(n,s){return _2(n,{prefix:s==null?void 0:s.prefix})},getCommon({name:n="",theme:s={},params:d,set:_,defaults:w}){var P,b,c,R,Z,V,H;const{preset:K,options:G}=s;let fe,Be,et,We,lt,st,ye;if(Ir(K)&&G.transform!=="strict"){const{primitive:Ae,semantic:Ye,extend:nt}=K,rt=Ye||{},{colorScheme:Xe}=rt,mt=Fn(rt,["colorScheme"]),kt=nt||{},{colorScheme:ot}=kt,At=Fn(kt,["colorScheme"]),Bt=Xe||{},{dark:gr}=Bt,vt=Fn(Bt,["dark"]),Et=ot||{},{dark:Ft}=Et,Ar=Fn(Et,["dark"]),zr=Ir(Ae)?this._toVariables({primitive:Ae},G):{},_r=Ir(mt)?this._toVariables({semantic:mt},G):{},or=Ir(vt)?this._toVariables({light:vt},G):{},Gr=Ir(gr)?this._toVariables({dark:gr},G):{},Lr=Ir(At)?this._toVariables({semantic:At},G):{},Rr=Ir(Ar)?this._toVariables({light:Ar},G):{},yo=Ir(Ft)?this._toVariables({dark:Ft},G):{},[Ao,Vo]=[(P=zr.declarations)!=null?P:"",zr.tokens],[to,Uo]=[(b=_r.declarations)!=null?b:"",_r.tokens||[]],[qr,se]=[(c=or.declarations)!=null?c:"",or.tokens||[]],[pe,ke]=[(R=Gr.declarations)!=null?R:"",Gr.tokens||[]],[Ge,Ne]=[(Z=Lr.declarations)!=null?Z:"",Lr.tokens||[]],[Ve,it]=[(V=Rr.declarations)!=null?V:"",Rr.tokens||[]],[tt,Je]=[(H=yo.declarations)!=null?H:"",yo.tokens||[]];fe=this.transformCSS(n,Ao,"light","variable",G,_,w),Be=Vo;const Ue=this.transformCSS(n,`${to}${qr}`,"light","variable",G,_,w),St=this.transformCSS(n,`${pe}`,"dark","variable",G,_,w);et=`${Ue}${St}`,We=[...new Set([...Uo,...se,...ke])];const at=this.transformCSS(n,`${Ge}${Ve}color-scheme:light`,"light","variable",G,_,w),bt=this.transformCSS(n,`${tt}color-scheme:dark`,"dark","variable",G,_,w);lt=`${at}${bt}`,st=[...new Set([...Ne,...it,...Je])],ye=Li(K.css,{dt:_u})}return{primitive:{css:fe,tokens:Be},semantic:{css:et,tokens:We},global:{css:lt,tokens:st},style:ye}},getPreset({name:n="",preset:s={},options:d,params:_,set:w,defaults:P,selector:b}){var c,R,Z;let V,H,K;if(Ir(s)&&d.transform!=="strict"){const G=n.replace("-directive",""),fe=s,{colorScheme:Be,extend:et,css:We}=fe,lt=Fn(fe,["colorScheme","extend","css"]),st=et||{},{colorScheme:ye}=st,Ae=Fn(st,["colorScheme"]),Ye=Be||{},{dark:nt}=Ye,rt=Fn(Ye,["dark"]),Xe=ye||{},{dark:mt}=Xe,kt=Fn(Xe,["dark"]),ot=Ir(lt)?this._toVariables({[G]:Wi(Wi({},lt),Ae)},d):{},At=Ir(rt)?this._toVariables({[G]:Wi(Wi({},rt),kt)},d):{},Bt=Ir(nt)?this._toVariables({[G]:Wi(Wi({},nt),mt)},d):{},[gr,vt]=[(c=ot.declarations)!=null?c:"",ot.tokens||[]],[Et,Ft]=[(R=At.declarations)!=null?R:"",At.tokens||[]],[Ar,zr]=[(Z=Bt.declarations)!=null?Z:"",Bt.tokens||[]],_r=this.transformCSS(G,`${gr}${Et}`,"light","variable",d,w,P,b),or=this.transformCSS(G,Ar,"dark","variable",d,w,P,b);V=`${_r}${or}`,H=[...new Set([...vt,...Ft,...zr])],K=Li(We,{dt:_u})}return{css:V,tokens:H,style:K}},getPresetC({name:n="",theme:s={},params:d,set:_,defaults:w}){var P;const{preset:b,options:c}=s,R=(P=b==null?void 0:b.components)==null?void 0:P[n];return this.getPreset({name:n,preset:R,options:c,params:d,set:_,defaults:w})},getPresetD({name:n="",theme:s={},params:d,set:_,defaults:w}){var P,b;const c=n.replace("-directive",""),{preset:R,options:Z}=s,V=((P=R==null?void 0:R.components)==null?void 0:P[c])||((b=R==null?void 0:R.directives)==null?void 0:b[c]);return this.getPreset({name:c,preset:V,options:Z,params:d,set:_,defaults:w})},applyDarkColorScheme(n){return!(n.darkModeSelector==="none"||n.darkModeSelector===!1)},getColorSchemeOption(n,s){var d;return this.applyDarkColorScheme(n)?this.regex.resolve(n.darkModeSelector===!0?s.options.darkModeSelector:(d=n.darkModeSelector)!=null?d:s.options.darkModeSelector):[]},getLayerOrder(n,s={},d,_){const{cssLayer:w}=s;return w?`@layer ${Li(w.order||"primeui",d)}`:""},getCommonStyleSheet({name:n="",theme:s={},params:d,props:_={},set:w,defaults:P}){const b=this.getCommon({name:n,theme:s,params:d,set:w,defaults:P}),c=Object.entries(_).reduce((R,[Z,V])=>R.push(`${Z}="${V}"`)&&R,[]).join(" ");return Object.entries(b||{}).reduce((R,[Z,V])=>{if(V!=null&&V.css){const H=gu(V==null?void 0:V.css),K=`${Z}-variables`;R.push(`<style type="text/css" data-primevue-style-id="${K}" ${c}>${H}</style>`)}return R},[]).join("")},getStyleSheet({name:n="",theme:s={},params:d,props:_={},set:w,defaults:P}){var b;const c={name:n,theme:s,params:d,set:w,defaults:P},R=(b=n.includes("-directive")?this.getPresetD(c):this.getPresetC(c))==null?void 0:b.css,Z=Object.entries(_).reduce((V,[H,K])=>V.push(`${H}="${K}"`)&&V,[]).join(" ");return R?`<style type="text/css" data-primevue-style-id="${n}-variables" ${Z}>${gu(R)}</style>`:""},createTokens(n={},s,d="",_="",w={}){return Object.entries(n).forEach(([P,b])=>{const c=Vn(P,s.variable.excludedKeyRegex)?d:d?`${d}.${F_(P)}`:F_(P),R=_?`${_}.${P}`:P;fn(b)?this.createTokens(b,s,c,R,w):(w[c]||(w[c]={paths:[],computed(Z,V={}){var H,K;return this.paths.length===1?(H=this.paths[0])==null?void 0:H.computed(this.paths[0].scheme,V.binding):Z&&Z!=="none"?(K=this.paths.find(G=>G.scheme===Z))==null?void 0:K.computed(Z,V.binding):this.paths.map(G=>G.computed(G.scheme,V[G.scheme]))}}),w[c].paths.push({path:R,value:b,scheme:R.includes("colorScheme.light")?"light":R.includes("colorScheme.dark")?"dark":"none",computed(Z,V={}){const H=/{([^}]*)}/g;let K=b;if(V.name=this.path,V.binding||(V.binding={}),Vn(b,H)){const fe=b.trim().replaceAll(H,We=>{var lt;const st=We.replace(/{|}/g,""),ye=(lt=w[st])==null?void 0:lt.computed(Z,V);return Od(ye)&&ye.length===2?`light-dark(${ye[0].value},${ye[1].value})`:ye==null?void 0:ye.value}),Be=/(\d+\w*\s+[\+\-\*\/]\s+\d+\w*)/g,et=/var\([^)]+\)/g;K=Vn(fe.replace(et,"0"),Be)?`calc(${fe})`:fe}return Fd(V.binding)&&delete V.binding,{colorScheme:Z,path:this.path,paths:V,value:K.includes("undefined")?void 0:K}}}))}),w},getTokenValue(n,s,d){var _;const P=(R=>R.split(".").filter(V=>!Vn(V.toLowerCase(),d.variable.excludedKeyRegex)).join("."))(s),b=s.includes("colorScheme.light")?"light":s.includes("colorScheme.dark")?"dark":void 0,c=[(_=n[P])==null?void 0:_.computed(b)].flat().filter(R=>R);return c.length===1?c[0].value:c.reduce((R={},Z)=>{const V=Z,{colorScheme:H}=V,K=Fn(V,["colorScheme"]);return R[H]=K,R},void 0)},getSelectorRule(n,s,d,_){return d==="class"||d==="attr"?Pl(Ir(s)?`${n}${s},${n} ${s}`:n,_):Pl(n,Ir(s)?Pl(s,_):_)},transformCSS(n,s,d,_,w={},P,b,c){if(Ir(s)){const{cssLayer:R}=w;if(_!=="style"){const Z=this.getColorSchemeOption(w,b);s=d==="dark"?Z.reduce((V,{type:H,selector:K})=>(Ir(K)&&(V+=K.includes("[CSS]")?K.replace("[CSS]",s):this.getSelectorRule(K,c,H,s)),V),""):Pl(c??":root",s)}if(R){const Z={name:"primeui"};fn(R)&&(Z.name=Li(R.name,{name:n,type:_})),Ir(Z.name)&&(s=Pl(`@layer ${Z.name}`,s),P==null||P.layerNames(Z.name))}return s}return""}},dr={defaults:{variable:{prefix:"p",selector:":root",excludedKeyRegex:/^(primitive|semantic|components|directives|variables|colorscheme|light|dark|common|root|states|extend|css)$/gi},options:{prefix:"p",darkModeSelector:"system",cssLayer:!1}},_theme:void 0,_layerNames:new Set,_loadedStyleNames:new Set,_loadingStyles:new Set,_tokens:{},update(n={}){const{theme:s}=n;s&&(this._theme=gp(Wi({},s),{options:Wi(Wi({},this.defaults.options),s.options)}),this._tokens=qi.createTokens(this.preset,this.defaults),this.clearLoadedStyleNames())},get theme(){return this._theme},get preset(){var n;return((n=this.theme)==null?void 0:n.preset)||{}},get options(){var n;return((n=this.theme)==null?void 0:n.options)||{}},get tokens(){return this._tokens},getTheme(){return this.theme},setTheme(n){this.update({theme:n}),Mo.emit("theme:change",n)},getPreset(){return this.preset},setPreset(n){this._theme=gp(Wi({},this.theme),{preset:n}),this._tokens=qi.createTokens(n,this.defaults),this.clearLoadedStyleNames(),Mo.emit("preset:change",n),Mo.emit("theme:change",this.theme)},getOptions(){return this.options},setOptions(n){this._theme=gp(Wi({},this.theme),{options:n}),this.clearLoadedStyleNames(),Mo.emit("options:change",n),Mo.emit("theme:change",this.theme)},getLayerNames(){return[...this._layerNames]},setLayerNames(n){this._layerNames.add(n)},getLoadedStyleNames(){return this._loadedStyleNames},isStyleNameLoaded(n){return this._loadedStyleNames.has(n)},setLoadedStyleName(n){this._loadedStyleNames.add(n)},deleteLoadedStyleName(n){this._loadedStyleNames.delete(n)},clearLoadedStyleNames(){this._loadedStyleNames.clear()},getTokenValue(n){return qi.getTokenValue(this.tokens,n,this.defaults)},getCommon(n="",s){return qi.getCommon({name:n,theme:this.theme,params:s,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getComponent(n="",s){const d={name:n,theme:this.theme,params:s,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return qi.getPresetC(d)},getDirective(n="",s){const d={name:n,theme:this.theme,params:s,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return qi.getPresetD(d)},getCustomPreset(n="",s,d,_){const w={name:n,preset:s,options:this.options,selector:d,params:_,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return qi.getPreset(w)},getLayerOrderCSS(n=""){return qi.getLayerOrder(n,this.options,{names:this.getLayerNames()},this.defaults)},transformCSS(n="",s,d="style",_){return qi.transformCSS(n,s,_,d,this.options,{layerNames:this.setLayerNames.bind(this)},this.defaults)},getCommonStyleSheet(n="",s,d={}){return qi.getCommonStyleSheet({name:n,theme:this.theme,params:s,props:d,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getStyleSheet(n,s,d={}){return qi.getStyleSheet({name:n,theme:this.theme,params:s,props:d,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},onStyleMounted(n){this._loadingStyles.add(n)},onStyleUpdated(n){this._loadingStyles.add(n)},onStyleLoaded(n,{name:s}){this._loadingStyles.size&&(this._loadingStyles.delete(s),Mo.emit(`theme:${s}:load`,n),!this._loadingStyles.size&&Mo.emit("theme:load"))}},Oo={STARTS_WITH:"startsWith",CONTAINS:"contains",NOT_CONTAINS:"notContains",ENDS_WITH:"endsWith",EQUALS:"equals",NOT_EQUALS:"notEquals",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"lte",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"gte",DATE_IS:"dateIs",DATE_IS_NOT:"dateIsNot",DATE_BEFORE:"dateBefore",DATE_AFTER:"dateAfter"},y2=({dt:n})=>`
*,
::before,
::after {
    box-sizing: border-box;
}

/* Non vue overlay animations */
.p-connected-overlay {
    opacity: 0;
    transform: scaleY(0.8);
    transition: transform 0.12s cubic-bezier(0, 0, 0.2, 1),
        opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
}

.p-connected-overlay-visible {
    opacity: 1;
    transform: scaleY(1);
}

.p-connected-overlay-hidden {
    opacity: 0;
    transform: scaleY(1);
    transition: opacity 0.1s linear;
}

/* Vue based overlay animations */
.p-connected-overlay-enter-from {
    opacity: 0;
    transform: scaleY(0.8);
}

.p-connected-overlay-leave-to {
    opacity: 0;
}

.p-connected-overlay-enter-active {
    transition: transform 0.12s cubic-bezier(0, 0, 0.2, 1),
        opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
}

.p-connected-overlay-leave-active {
    transition: opacity 0.1s linear;
}

/* Toggleable Content */
.p-toggleable-content-enter-from,
.p-toggleable-content-leave-to {
    max-height: 0;
}

.p-toggleable-content-enter-to,
.p-toggleable-content-leave-from {
    max-height: 1000px;
}

.p-toggleable-content-leave-active {
    overflow: hidden;
    transition: max-height 0.45s cubic-bezier(0, 1, 0, 1);
}

.p-toggleable-content-enter-active {
    overflow: hidden;
    transition: max-height 1s ease-in-out;
}

.p-disabled,
.p-disabled * {
    cursor: default;
    pointer-events: none;
    user-select: none;
}

.p-disabled,
.p-component:disabled {
    opacity: ${n("disabled.opacity")};
}

.pi {
    font-size: ${n("icon.size")};
}

.p-icon {
    width: ${n("icon.size")};
    height: ${n("icon.size")};
}

.p-overlay-mask {
    background: ${n("mask.background")};
    color: ${n("mask.color")};
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.p-overlay-mask-enter {
    animation: p-overlay-mask-enter-animation ${n("mask.transition.duration")} forwards;
}

.p-overlay-mask-leave {
    animation: p-overlay-mask-leave-animation ${n("mask.transition.duration")} forwards;
}

@keyframes p-overlay-mask-enter-animation {
    from {
        background: transparent;
    }
    to {
        background: ${n("mask.background")};
    }
}
@keyframes p-overlay-mask-leave-animation {
    from {
        background: ${n("mask.background")};
    }
    to {
        background: transparent;
    }
}
`;function ku(n){"@babel/helpers - typeof";return ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},ku(n)}function Z_(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);s&&(_=_.filter(function(w){return Object.getOwnPropertyDescriptor(n,w).enumerable})),d.push.apply(d,_)}return d}function G_(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?Z_(Object(d),!0).forEach(function(_){v2(n,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):Z_(Object(d)).forEach(function(_){Object.defineProperty(n,_,Object.getOwnPropertyDescriptor(d,_))})}return n}function v2(n,s,d){return(s=b2(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function b2(n){var s=x2(n,"string");return ku(s)=="symbol"?s:s+""}function x2(n,s){if(ku(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(ku(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}function w2(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;am()?Ad(n):s?n():tm(n)}var C2=0;function S2(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=No(!1),_=No(n),w=No(null),P=hm()?window.document:void 0,b=s.document,c=b===void 0?P:b,R=s.immediate,Z=R===void 0?!0:R,V=s.manual,H=V===void 0?!1:V,K=s.name,G=K===void 0?"style_".concat(++C2):K,fe=s.id,Be=fe===void 0?void 0:fe,et=s.media,We=et===void 0?void 0:et,lt=s.nonce,st=lt===void 0?void 0:lt,ye=s.first,Ae=ye===void 0?!1:ye,Ye=s.onMounted,nt=Ye===void 0?void 0:Ye,rt=s.onUpdated,Xe=rt===void 0?void 0:rt,mt=s.onLoad,kt=mt===void 0?void 0:mt,ot=s.props,At=ot===void 0?{}:ot,Bt=function(){},gr=function(Ft){var Ar=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(c){var zr=G_(G_({},At),Ar),_r=zr.name||G,or=zr.id||Be,Gr=zr.nonce||st;w.value=c.querySelector('style[data-primevue-style-id="'.concat(_r,'"]'))||c.getElementById(or)||c.createElement("style"),w.value.isConnected||(_.value=Ft||n,yd(w.value,{type:"text/css",id:or,media:We,nonce:Gr}),Ae?c.head.prepend(w.value):c.head.appendChild(w.value),q0(w.value,"data-primevue-style-id",_r),yd(w.value,zr),w.value.onload=function(Lr){return kt==null?void 0:kt(Lr,{name:_r})},nt==null||nt(_r)),!d.value&&(Bt=ki(_,function(Lr){w.value.textContent=Lr,Xe==null||Xe(_r)},{immediate:!0}),d.value=!0)}},vt=function(){!c||!d.value||(Bt(),Q1(w.value)&&c.head.removeChild(w.value),d.value=!1)};return Z&&!H&&w2(gr),{id:Be,name:G,el:w,css:_,unload:vt,load:gr,isLoaded:Yp(d)}}function Pu(n){"@babel/helpers - typeof";return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Pu(n)}function q_(n,s){return M2(n)||P2(n,s)||k2(n,s)||T2()}function T2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k2(n,s){if(n){if(typeof n=="string")return W_(n,s);var d={}.toString.call(n).slice(8,-1);return d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set"?Array.from(n):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?W_(n,s):void 0}}function W_(n,s){(s==null||s>n.length)&&(s=n.length);for(var d=0,_=Array(s);d<s;d++)_[d]=n[d];return _}function P2(n,s){var d=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(d!=null){var _,w,P,b,c=[],R=!0,Z=!1;try{if(P=(d=d.call(n)).next,s!==0)for(;!(R=(_=P.call(d)).done)&&(c.push(_.value),c.length!==s);R=!0);}catch(V){Z=!0,w=V}finally{try{if(!R&&d.return!=null&&(b=d.return(),Object(b)!==b))return}finally{if(Z)throw w}}return c}}function M2(n){if(Array.isArray(n))return n}function H_(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);s&&(_=_.filter(function(w){return Object.getOwnPropertyDescriptor(n,w).enumerable})),d.push.apply(d,_)}return d}function _p(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?H_(Object(d),!0).forEach(function(_){I2(n,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):H_(Object(d)).forEach(function(_){Object.defineProperty(n,_,Object.getOwnPropertyDescriptor(d,_))})}return n}function I2(n,s,d){return(s=E2(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function E2(n){var s=A2(n,"string");return Pu(s)=="symbol"?s:s+""}function A2(n,s){if(Pu(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Pu(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var z2=function(s){var d=s.dt;return`
.p-hidden-accessible {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    opacity: 0;
    overflow: hidden;
    padding: 0;
    pointer-events: none;
    position: absolute;
    white-space: nowrap;
    width: 1px;
}

.p-overflow-hidden {
    overflow: hidden;
    padding-right: `.concat(d("scrollbar.width"),`;
}
`)},R2={},D2={},jr={name:"base",css:z2,style:y2,classes:R2,inlineStyles:D2,load:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(P){return P},w=_(Li(s,{dt:_u}));return Ir(w)?S2(gu(w),_p({name:this.name},d)):{}},loadCSS:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.load(this.css,s)},loadStyle:function(){var s=this,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.load(this.style,d,function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return dr.transformCSS(d.name||s.name,"".concat(w).concat(_))})},getCommonTheme:function(s){return dr.getCommon(this.name,s)},getComponentTheme:function(s){return dr.getComponent(this.name,s)},getDirectiveTheme:function(s){return dr.getDirective(this.name,s)},getPresetTheme:function(s,d,_){return dr.getCustomPreset(this.name,s,d,_)},getLayerOrderThemeCSS:function(){return dr.getLayerOrderCSS(this.name)},getStyleSheet:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.css){var _=Li(this.css,{dt:_u})||"",w=gu("".concat(_).concat(s)),P=Object.entries(d).reduce(function(b,c){var R=q_(c,2),Z=R[0],V=R[1];return b.push("".concat(Z,'="').concat(V,'"'))&&b},[]).join(" ");return Ir(w)?'<style type="text/css" data-primevue-style-id="'.concat(this.name,'" ').concat(P,">").concat(w,"</style>"):""}return""},getCommonThemeStyleSheet:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return dr.getCommonStyleSheet(this.name,s,d)},getThemeStyleSheet:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=[dr.getStyleSheet(this.name,s,d)];if(this.style){var w=this.name==="base"?"global-style":"".concat(this.name,"-style"),P=Li(this.style,{dt:_u}),b=gu(dr.transformCSS(w,P)),c=Object.entries(d).reduce(function(R,Z){var V=q_(Z,2),H=V[0],K=V[1];return R.push("".concat(H,'="').concat(K,'"'))&&R},[]).join(" ");Ir(b)&&_.push('<style type="text/css" data-primevue-style-id="'.concat(w,'" ').concat(c,">").concat(b,"</style>"))}return _.join("")},extend:function(s){return _p(_p({},this),{},{css:void 0,style:void 0},s)}},Cs=um();function Mu(n){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Mu(n)}function X_(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);s&&(_=_.filter(function(w){return Object.getOwnPropertyDescriptor(n,w).enumerable})),d.push.apply(d,_)}return d}function rd(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?X_(Object(d),!0).forEach(function(_){B2(n,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):X_(Object(d)).forEach(function(_){Object.defineProperty(n,_,Object.getOwnPropertyDescriptor(d,_))})}return n}function B2(n,s,d){return(s=L2(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function L2(n){var s=F2(n,"string");return Mu(s)=="symbol"?s:s+""}function F2(n,s){if(Mu(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Mu(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var O2={ripple:!1,inputStyle:null,inputVariant:null,locale:{startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",completed:"Completed",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",today:"Today",weekHeader:"Wk",firstDayOfWeek:0,showMonthAfterYear:!1,dateFormat:"mm/dd/yy",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyFilterMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",fileChosenMessage:"{0} files",noFileChosenMessage:"No file chosen",emptyMessage:"No available options",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"Page {page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left",listLabel:"Option List"}},filterMatchModeOptions:{text:[Oo.STARTS_WITH,Oo.CONTAINS,Oo.NOT_CONTAINS,Oo.ENDS_WITH,Oo.EQUALS,Oo.NOT_EQUALS],numeric:[Oo.EQUALS,Oo.NOT_EQUALS,Oo.LESS_THAN,Oo.LESS_THAN_OR_EQUAL_TO,Oo.GREATER_THAN,Oo.GREATER_THAN_OR_EQUAL_TO],date:[Oo.DATE_IS,Oo.DATE_IS_NOT,Oo.DATE_BEFORE,Oo.DATE_AFTER]},zIndex:{modal:1100,overlay:1e3,menu:1e3,tooltip:1100},theme:void 0,unstyled:!1,pt:void 0,ptOptions:{mergeSections:!0,mergeProps:!1},csp:{nonce:void 0}},$2=Symbol();function j2(n,s){var d={config:Bu(s)};return n.config.globalProperties.$primevue=d,n.provide($2,d),N2(),V2(n,d),d}var Ml=[];function N2(){Mo.clear(),Ml.forEach(function(n){return n==null?void 0:n()}),Ml=[]}function V2(n,s){var d=No(!1),_=function(){var Z;if(((Z=s.config)===null||Z===void 0?void 0:Z.theme)!=="none"&&!dr.isStyleNameLoaded("common")){var V,H,K=((V=jr.getCommonTheme)===null||V===void 0?void 0:V.call(jr))||{},G=K.primitive,fe=K.semantic,Be=K.global,et=K.style,We={nonce:(H=s.config)===null||H===void 0||(H=H.csp)===null||H===void 0?void 0:H.nonce};jr.load(G==null?void 0:G.css,rd({name:"primitive-variables"},We)),jr.load(fe==null?void 0:fe.css,rd({name:"semantic-variables"},We)),jr.load(Be==null?void 0:Be.css,rd({name:"global-variables"},We)),jr.loadStyle(rd({name:"global-style"},We),et),dr.setLoadedStyleName("common")}};Mo.on("theme:change",function(R){d.value||(n.config.globalProperties.$primevue.config.theme=R,d.value=!0)});var w=ki(s.config,function(R,Z){Cs.emit("config:change",{newValue:R,oldValue:Z})},{immediate:!0,deep:!0}),P=ki(function(){return s.config.ripple},function(R,Z){Cs.emit("config:ripple:change",{newValue:R,oldValue:Z})},{immediate:!0,deep:!0}),b=ki(function(){return s.config.theme},function(R,Z){d.value||dr.setTheme(R),s.config.unstyled||_(),d.value=!1,Cs.emit("config:theme:change",{newValue:R,oldValue:Z})},{immediate:!0,deep:!1}),c=ki(function(){return s.config.unstyled},function(R,Z){!R&&s.config.theme&&_(),Cs.emit("config:unstyled:change",{newValue:R,oldValue:Z})},{immediate:!0,deep:!0});Ml.push(w),Ml.push(P),Ml.push(b),Ml.push(c)}var U2={install:function(s,d){var _=U1(O2,d);j2(s,_)}},Z2={transitionDuration:"{transition.duration}"},G2={borderWidth:"0 0 1px 0",borderColor:"{content.border.color}"},q2={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",padding:"1.125rem",fontWeight:"600",borderRadius:"0",borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",hoverBackground:"{content.background}",activeBackground:"{content.background}",activeHoverBackground:"{content.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},toggleIcon:{color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}"},first:{topBorderRadius:"{content.border.radius}",borderWidth:"0"},last:{bottomBorderRadius:"{content.border.radius}",activeBottomBorderRadius:"0"}},W2={borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",color:"{text.color}",padding:"0 1.125rem 1.125rem 1.125rem"},H2={root:Z2,panel:G2,header:q2,content:W2},X2={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},K2={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},Y2={padding:"{list.padding}",gap:"{list.gap}"},J2={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},Q2={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},eC={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},tC={borderRadius:"{border.radius.sm}"},rC={padding:"{list.option.padding}"},oC={light:{chip:{focusBackground:"{surface.200}",focusColor:"{surface.800}"},dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",focusColor:"{surface.0}"},dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"}}},iC={root:X2,overlay:K2,list:Y2,option:J2,optionGroup:Q2,dropdown:eC,chip:tC,emptyMessage:rC,colorScheme:oC},nC={width:"2rem",height:"2rem",fontSize:"1rem",background:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},sC={size:"1rem"},aC={borderColor:"{content.background}",offset:"-0.75rem"},lC={width:"3rem",height:"3rem",fontSize:"1.5rem",icon:{size:"1.5rem"},group:{offset:"-1rem"}},cC={width:"4rem",height:"4rem",fontSize:"2rem",icon:{size:"2rem"},group:{offset:"-1.5rem"}},uC={root:nC,icon:sC,group:aC,lg:lC,xl:cC},hC={borderRadius:"{border.radius.md}",padding:"0 0.5rem",fontSize:"0.75rem",fontWeight:"700",minWidth:"1.5rem",height:"1.5rem"},dC={size:"0.5rem"},fC={fontSize:"0.625rem",minWidth:"1.25rem",height:"1.25rem"},pC={fontSize:"0.875rem",minWidth:"1.75rem",height:"1.75rem"},mC={fontSize:"1rem",minWidth:"2rem",height:"2rem"},gC={light:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.500}",color:"{surface.0}"},info:{background:"{sky.500}",color:"{surface.0}"},warn:{background:"{orange.500}",color:"{surface.0}"},danger:{background:"{red.500}",color:"{surface.0}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"{green.400}",color:"{green.950}"},info:{background:"{sky.400}",color:"{sky.950}"},warn:{background:"{orange.400}",color:"{orange.950}"},danger:{background:"{red.400}",color:"{red.950}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},_C={root:hC,dot:dC,sm:fC,lg:pC,xl:mC,colorScheme:gC},yC={borderRadius:{none:"0",xs:"2px",sm:"4px",md:"6px",lg:"8px",xl:"12px"},emerald:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b",950:"#022c22"},green:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d",950:"#052e16"},lime:{50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314",950:"#1a2e05"},red:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d",950:"#450a0a"},orange:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12",950:"#431407"},amber:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f",950:"#451a03"},yellow:{50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12",950:"#422006"},teal:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a",950:"#042f2e"},cyan:{50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63",950:"#083344"},sky:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e",950:"#082f49"},blue:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a",950:"#172554"},indigo:{50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81",950:"#1e1b4b"},violet:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95",950:"#2e1065"},purple:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87",950:"#3b0764"},fuchsia:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75",950:"#4a044e"},pink:{50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843",950:"#500724"},rose:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337",950:"#4c0519"},slate:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a",950:"#020617"},gray:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827",950:"#030712"},zinc:{50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b",950:"#09090b"},neutral:{50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717",950:"#0a0a0a"},stone:{50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917",950:"#0c0a09"}},vC={transitionDuration:"0.2s",focusRing:{width:"1px",style:"solid",color:"{primary.color}",offset:"2px",shadow:"none"},disabledOpacity:"0.6",iconSize:"1rem",anchorGutter:"2px",primary:{50:"{emerald.50}",100:"{emerald.100}",200:"{emerald.200}",300:"{emerald.300}",400:"{emerald.400}",500:"{emerald.500}",600:"{emerald.600}",700:"{emerald.700}",800:"{emerald.800}",900:"{emerald.900}",950:"{emerald.950}"},formField:{paddingX:"0.75rem",paddingY:"0.5rem",sm:{fontSize:"0.875rem",paddingX:"0.625rem",paddingY:"0.375rem"},lg:{fontSize:"1.125rem",paddingX:"0.875rem",paddingY:"0.625rem"},borderRadius:"{border.radius.md}",focusRing:{width:"0",style:"none",color:"transparent",offset:"0",shadow:"none"},transitionDuration:"{transition.duration}"},list:{padding:"0.25rem 0.25rem",gap:"2px",header:{padding:"0.5rem 1rem 0.25rem 1rem"},option:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}"},optionGroup:{padding:"0.5rem 0.75rem",fontWeight:"600"}},content:{borderRadius:"{border.radius.md}"},mask:{transitionDuration:"0.15s"},navigation:{list:{padding:"0.25rem 0.25rem",gap:"2px"},item:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}",gap:"0.5rem"},submenuLabel:{padding:"0.5rem 0.75rem",fontWeight:"600"},submenuIcon:{size:"0.875rem"}},overlay:{select:{borderRadius:"{border.radius.md}",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},popover:{borderRadius:"{border.radius.md}",padding:"0.75rem",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},modal:{borderRadius:"{border.radius.xl}",padding:"1.25rem",shadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1)"},navigation:{shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"}},colorScheme:{light:{surface:{0:"#ffffff",50:"{slate.50}",100:"{slate.100}",200:"{slate.200}",300:"{slate.300}",400:"{slate.400}",500:"{slate.500}",600:"{slate.600}",700:"{slate.700}",800:"{slate.800}",900:"{slate.900}",950:"{slate.950}"},primary:{color:"{primary.500}",contrastColor:"#ffffff",hoverColor:"{primary.600}",activeColor:"{primary.700}"},highlight:{background:"{primary.50}",focusBackground:"{primary.100}",color:"{primary.700}",focusColor:"{primary.800}"},mask:{background:"rgba(0,0,0,0.4)",color:"{surface.200}"},formField:{background:"{surface.0}",disabledBackground:"{surface.200}",filledBackground:"{surface.50}",filledHoverBackground:"{surface.50}",filledFocusBackground:"{surface.50}",borderColor:"{surface.300}",hoverBorderColor:"{surface.400}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.400}",color:"{surface.700}",disabledColor:"{surface.500}",placeholderColor:"{surface.500}",invalidPlaceholderColor:"{red.600}",floatLabelColor:"{surface.500}",floatLabelFocusColor:"{primary.600}",floatLabelActiveColor:"{surface.500}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.700}",hoverColor:"{surface.800}",mutedColor:"{surface.500}",hoverMutedColor:"{surface.600}"},content:{background:"{surface.0}",hoverBackground:"{surface.100}",borderColor:"{surface.200}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},popover:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},modal:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.100}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.100}",activeBackground:"{surface.100}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}}},dark:{surface:{0:"#ffffff",50:"{zinc.50}",100:"{zinc.100}",200:"{zinc.200}",300:"{zinc.300}",400:"{zinc.400}",500:"{zinc.500}",600:"{zinc.600}",700:"{zinc.700}",800:"{zinc.800}",900:"{zinc.900}",950:"{zinc.950}"},primary:{color:"{primary.400}",contrastColor:"{surface.900}",hoverColor:"{primary.300}",activeColor:"{primary.200}"},highlight:{background:"color-mix(in srgb, {primary.400}, transparent 84%)",focusBackground:"color-mix(in srgb, {primary.400}, transparent 76%)",color:"rgba(255,255,255,.87)",focusColor:"rgba(255,255,255,.87)"},mask:{background:"rgba(0,0,0,0.6)",color:"{surface.200}"},formField:{background:"{surface.950}",disabledBackground:"{surface.700}",filledBackground:"{surface.800}",filledHoverBackground:"{surface.800}",filledFocusBackground:"{surface.800}",borderColor:"{surface.600}",hoverBorderColor:"{surface.500}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.300}",color:"{surface.0}",disabledColor:"{surface.400}",placeholderColor:"{surface.400}",invalidPlaceholderColor:"{red.400}",floatLabelColor:"{surface.400}",floatLabelFocusColor:"{primary.color}",floatLabelActiveColor:"{surface.400}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.0}",hoverColor:"{surface.0}",mutedColor:"{surface.400}",hoverMutedColor:"{surface.300}"},content:{background:"{surface.900}",hoverBackground:"{surface.800}",borderColor:"{surface.700}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},popover:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},modal:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.800}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.800}",activeBackground:"{surface.800}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}}}}},bC={primitive:yC,semantic:vC},xC={borderRadius:"{content.border.radius}"},wC={root:xC},CC={padding:"1rem",background:"{content.background}",gap:"0.5rem",transitionDuration:"{transition.duration}"},SC={color:"{text.muted.color}",hoverColor:"{text.color}",borderRadius:"{content.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",hoverColor:"{navigation.item.icon.focus.color}"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},TC={color:"{navigation.item.icon.color}"},kC={root:CC,item:SC,separator:TC},PC={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",gap:"0.5rem",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",iconOnlyWidth:"2.5rem",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}",iconOnlyWidth:"2rem"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}",iconOnlyWidth:"3rem"},label:{fontWeight:"500"},raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"},badgeSize:"1rem",transitionDuration:"{form.field.transition.duration}"},MC={light:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",borderColor:"{surface.100}",hoverBorderColor:"{surface.200}",activeBorderColor:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}",focusRing:{color:"{surface.600}",shadow:"none"}},info:{background:"{sky.500}",hoverBackground:"{sky.600}",activeBackground:"{sky.700}",borderColor:"{sky.500}",hoverBorderColor:"{sky.600}",activeBorderColor:"{sky.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{sky.500}",shadow:"none"}},success:{background:"{green.500}",hoverBackground:"{green.600}",activeBackground:"{green.700}",borderColor:"{green.500}",hoverBorderColor:"{green.600}",activeBorderColor:"{green.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{green.500}",shadow:"none"}},warn:{background:"{orange.500}",hoverBackground:"{orange.600}",activeBackground:"{orange.700}",borderColor:"{orange.500}",hoverBorderColor:"{orange.600}",activeBorderColor:"{orange.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{orange.500}",shadow:"none"}},help:{background:"{purple.500}",hoverBackground:"{purple.600}",activeBackground:"{purple.700}",borderColor:"{purple.500}",hoverBorderColor:"{purple.600}",activeBorderColor:"{purple.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{purple.500}",shadow:"none"}},danger:{background:"{red.500}",hoverBackground:"{red.600}",activeBackground:"{red.700}",borderColor:"{red.500}",hoverBorderColor:"{red.600}",activeBorderColor:"{red.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{red.500}",shadow:"none"}},contrast:{background:"{surface.950}",hoverBackground:"{surface.900}",activeBackground:"{surface.800}",borderColor:"{surface.950}",hoverBorderColor:"{surface.900}",activeBorderColor:"{surface.800}",color:"{surface.0}",hoverColor:"{surface.0}",activeColor:"{surface.0}",focusRing:{color:"{surface.950}",shadow:"none"}}},outlined:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",borderColor:"{primary.200}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",borderColor:"{green.200}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",borderColor:"{sky.200}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",borderColor:"{orange.200}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",borderColor:"{purple.200}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",borderColor:"{red.200}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.700}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.700}"}},text:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.700}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}},dark:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",borderColor:"{surface.800}",hoverBorderColor:"{surface.700}",activeBorderColor:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}",focusRing:{color:"{surface.300}",shadow:"none"}},info:{background:"{sky.400}",hoverBackground:"{sky.300}",activeBackground:"{sky.200}",borderColor:"{sky.400}",hoverBorderColor:"{sky.300}",activeBorderColor:"{sky.200}",color:"{sky.950}",hoverColor:"{sky.950}",activeColor:"{sky.950}",focusRing:{color:"{sky.400}",shadow:"none"}},success:{background:"{green.400}",hoverBackground:"{green.300}",activeBackground:"{green.200}",borderColor:"{green.400}",hoverBorderColor:"{green.300}",activeBorderColor:"{green.200}",color:"{green.950}",hoverColor:"{green.950}",activeColor:"{green.950}",focusRing:{color:"{green.400}",shadow:"none"}},warn:{background:"{orange.400}",hoverBackground:"{orange.300}",activeBackground:"{orange.200}",borderColor:"{orange.400}",hoverBorderColor:"{orange.300}",activeBorderColor:"{orange.200}",color:"{orange.950}",hoverColor:"{orange.950}",activeColor:"{orange.950}",focusRing:{color:"{orange.400}",shadow:"none"}},help:{background:"{purple.400}",hoverBackground:"{purple.300}",activeBackground:"{purple.200}",borderColor:"{purple.400}",hoverBorderColor:"{purple.300}",activeBorderColor:"{purple.200}",color:"{purple.950}",hoverColor:"{purple.950}",activeColor:"{purple.950}",focusRing:{color:"{purple.400}",shadow:"none"}},danger:{background:"{red.400}",hoverBackground:"{red.300}",activeBackground:"{red.200}",borderColor:"{red.400}",hoverBorderColor:"{red.300}",activeBorderColor:"{red.200}",color:"{red.950}",hoverColor:"{red.950}",activeColor:"{red.950}",focusRing:{color:"{red.400}",shadow:"none"}},contrast:{background:"{surface.0}",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{surface.0}",hoverBorderColor:"{surface.100}",activeBorderColor:"{surface.200}",color:"{surface.950}",hoverColor:"{surface.950}",activeColor:"{surface.950}",focusRing:{color:"{surface.0}",shadow:"none"}}},outlined:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",borderColor:"{primary.700}",color:"{primary.color}"},secondary:{hoverBackground:"rgba(255,255,255,0.04)",activeBackground:"rgba(255,255,255,0.16)",borderColor:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",borderColor:"{green.700}",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",borderColor:"{sky.700}",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",borderColor:"{orange.700}",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",borderColor:"{purple.700}",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",borderColor:"{red.700}",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.500}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.600}",color:"{surface.0}"}},text:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",color:"{primary.color}"},secondary:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}}},IC={root:PC,colorScheme:MC},EC={background:"{content.background}",borderRadius:"{border.radius.xl}",color:"{content.color}",shadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)"},AC={padding:"1.25rem",gap:"0.5rem"},zC={gap:"0.5rem"},RC={fontSize:"1.25rem",fontWeight:"500"},DC={color:"{text.muted.color}"},BC={root:EC,body:AC,caption:zC,title:RC,subtitle:DC},LC={transitionDuration:"{transition.duration}"},FC={gap:"0.25rem"},OC={padding:"1rem",gap:"0.5rem"},$C={width:"2rem",height:"0.5rem",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},jC={light:{indicator:{background:"{surface.200}",hoverBackground:"{surface.300}",activeBackground:"{primary.color}"}},dark:{indicator:{background:"{surface.700}",hoverBackground:"{surface.600}",activeBackground:"{primary.color}"}}},NC={root:LC,content:FC,indicatorList:OC,indicator:$C,colorScheme:jC},VC={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},UC={width:"2.5rem",color:"{form.field.icon.color}"},ZC={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},GC={padding:"{list.padding}",gap:"{list.gap}",mobileIndent:"1rem"},qC={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",icon:{color:"{list.option.icon.color}",focusColor:"{list.option.icon.focus.color}",size:"0.875rem"}},WC={color:"{form.field.icon.color}"},HC={root:VC,dropdown:UC,overlay:ZC,list:GC,option:qC,clearIcon:WC},XC={borderRadius:"{border.radius.sm}",width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},KC={size:"0.875rem",color:"{form.field.color}",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.75rem"},lg:{size:"1rem"}},YC={root:XC,icon:KC},JC={borderRadius:"16px",paddingX:"0.75rem",paddingY:"0.5rem",gap:"0.5rem",transitionDuration:"{transition.duration}"},QC={width:"2rem",height:"2rem"},eS={size:"1rem"},tS={size:"1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"}},rS={light:{root:{background:"{surface.100}",color:"{surface.800}"},icon:{color:"{surface.800}"},removeIcon:{color:"{surface.800}"}},dark:{root:{background:"{surface.800}",color:"{surface.0}"},icon:{color:"{surface.0}"},removeIcon:{color:"{surface.0}"}}},oS={root:JC,image:QC,icon:eS,removeIcon:tS,colorScheme:rS},iS={transitionDuration:"{transition.duration}"},nS={width:"1.5rem",height:"1.5rem",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},sS={shadow:"{overlay.popover.shadow}",borderRadius:"{overlay.popover.borderRadius}"},aS={light:{panel:{background:"{surface.800}",borderColor:"{surface.900}"},handle:{color:"{surface.0}"}},dark:{panel:{background:"{surface.900}",borderColor:"{surface.700}"},handle:{color:"{surface.0}"}}},lS={root:iS,preview:nS,panel:sS,colorScheme:aS},cS={size:"2rem",color:"{overlay.modal.color}"},uS={gap:"1rem"},hS={icon:cS,content:uS},dS={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},fS={padding:"{overlay.popover.padding}",gap:"1rem"},pS={size:"1.5rem",color:"{overlay.popover.color}"},mS={gap:"0.5rem",padding:"0 {overlay.popover.padding} {overlay.popover.padding} {overlay.popover.padding}"},gS={root:dS,content:fS,icon:pS,footer:mS},_S={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},yS={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},vS={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},bS={mobileIndent:"1rem"},xS={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},wS={borderColor:"{content.border.color}"},CS={root:_S,list:yS,item:vS,submenu:bS,submenuIcon:xS,separator:wS},SS={transitionDuration:"{transition.duration}"},TS={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},kS={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{datatable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},PS={fontWeight:"600"},MS={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},IS={borderColor:"{datatable.border.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},ES={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},AS={fontWeight:"600"},zS={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},RS={color:"{primary.color}"},DS={width:"0.5rem"},BS={width:"1px",color:"{primary.color}"},LS={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},FS={size:"2rem"},OS={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},$S={inlineGap:"0.5rem",overlaySelect:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},overlayPopover:{background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}",gap:"0.5rem"},rule:{borderColor:"{content.border.color}"},constraintList:{padding:"{list.padding}",gap:"{list.gap}"},constraint:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",separator:{borderColor:"{content.border.color}"},padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"}},jS={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},NS={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},VS={light:{root:{borderColor:"{content.border.color}"},row:{stripedBackground:"{surface.50}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},row:{stripedBackground:"{surface.950}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},US={root:SS,header:TS,headerCell:kS,columnTitle:PS,row:MS,bodyCell:IS,footerCell:ES,columnFooter:AS,footer:zS,dropPoint:RS,columnResizer:DS,resizeIndicator:BS,sortIcon:LS,loadingIcon:FS,rowToggleButton:OS,filter:$S,paginatorTop:jS,paginatorBottom:NS,colorScheme:VS},ZS={borderColor:"transparent",borderWidth:"0",borderRadius:"0",padding:"0"},GS={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",borderRadius:"0"},qS={background:"{content.background}",color:"{content.color}",borderColor:"transparent",borderWidth:"0",padding:"0",borderRadius:"0"},WS={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"1px 0 0 0",padding:"0.75rem 1rem",borderRadius:"0"},HS={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},XS={borderColor:"{content.border.color}",borderWidth:"1px 0 0 0"},KS={root:ZS,header:GS,content:qS,footer:WS,paginatorTop:HS,paginatorBottom:XS},YS={transitionDuration:"{transition.duration}"},JS={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}"},QS={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",padding:"0 0 0.5rem 0"},eT={gap:"0.5rem",fontWeight:"500"},tT={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},rT={color:"{form.field.icon.color}"},oT={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},iT={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},nT={borderColor:"{content.border.color}",gap:"{overlay.popover.padding}"},sT={margin:"0.5rem 0 0 0"},aT={padding:"0.25rem",fontWeight:"500",color:"{content.color}"},lT={hoverBackground:"{content.hover.background}",selectedBackground:"{primary.color}",rangeSelectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{primary.contrast.color}",rangeSelectedColor:"{highlight.color}",width:"2rem",height:"2rem",borderRadius:"50%",padding:"0.25rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},cT={margin:"0.5rem 0 0 0"},uT={padding:"0.375rem",borderRadius:"{content.border.radius}"},hT={margin:"0.5rem 0 0 0"},dT={padding:"0.375rem",borderRadius:"{content.border.radius}"},fT={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}"},pT={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}",gap:"0.5rem",buttonGap:"0.25rem"},mT={light:{dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"},today:{background:"{surface.200}",color:"{surface.900}"}},dark:{dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"},today:{background:"{surface.700}",color:"{surface.0}"}}},gT={root:YS,panel:JS,header:QS,title:eT,dropdown:tT,inputIcon:rT,selectMonth:oT,selectYear:iT,group:nT,dayView:sT,weekDay:aT,date:lT,monthView:cT,month:uT,yearView:hT,year:dT,buttonbar:fT,timePicker:pT,colorScheme:mT},_T={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",borderRadius:"{overlay.modal.border.radius}",shadow:"{overlay.modal.shadow}"},yT={padding:"{overlay.modal.padding}",gap:"0.5rem"},vT={fontSize:"1.25rem",fontWeight:"600"},bT={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},xT={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}",gap:"0.5rem"},wT={root:_T,header:yT,title:vT,content:bT,footer:xT},CT={borderColor:"{content.border.color}"},ST={background:"{content.background}",color:"{text.color}"},TT={margin:"1rem 0",padding:"0 1rem",content:{padding:"0 0.5rem"}},kT={margin:"0 1rem",padding:"0.5rem 0",content:{padding:"0.5rem 0"}},PT={root:CT,content:ST,horizontal:TT,vertical:kT},MT={background:"rgba(255, 255, 255, 0.1)",borderColor:"rgba(255, 255, 255, 0.2)",padding:"0.5rem",borderRadius:"{border.radius.xl}"},IT={borderRadius:"{content.border.radius}",padding:"0.5rem",size:"3rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},ET={root:MT,item:IT},AT={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",shadow:"{overlay.modal.shadow}"},zT={padding:"{overlay.modal.padding}"},RT={fontSize:"1.5rem",fontWeight:"600"},DT={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},BT={padding:"{overlay.modal.padding}"},LT={root:AT,header:zT,title:RT,content:DT,footer:BT},FT={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}"},OT={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},$T={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}",padding:"{list.padding}"},jT={focusBackground:"{list.option.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},NT={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},VT={toolbar:FT,toolbarItem:OT,overlay:$T,overlayOption:jT,content:NT},UT={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",padding:"0 1.125rem 1.125rem 1.125rem",transitionDuration:"{transition.duration}"},ZT={background:"{content.background}",hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",borderRadius:"{content.border.radius}",borderWidth:"1px",borderColor:"transparent",padding:"0.5rem 0.75rem",gap:"0.5rem",fontWeight:"600",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},GT={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}"},qT={padding:"0"},WT={root:UT,legend:ZT,toggleIcon:GT,content:qT},HT={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},XT={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"unset",borderWidth:"0",borderRadius:"0",gap:"0.5rem"},KT={highlightBorderColor:"{primary.color}",padding:"0 1.125rem 1.125rem 1.125rem",gap:"1rem"},YT={padding:"1rem",gap:"1rem",borderColor:"{content.border.color}",info:{gap:"0.5rem"}},JT={gap:"0.5rem"},QT={height:"0.25rem"},ek={gap:"0.5rem"},tk={root:HT,header:XT,content:KT,file:YT,fileList:JT,progressbar:QT,basic:ek},rk={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",activeColor:"{form.field.float.label.active.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",positionY:"{form.field.padding.y}",fontWeight:"500",active:{fontSize:"0.75rem",fontWeight:"400"}},ok={active:{top:"-1.25rem"}},ik={input:{paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},active:{top:"{form.field.padding.y}"}},nk={borderRadius:"{border.radius.xs}",active:{background:"{form.field.background}",padding:"0 0.125rem"}},sk={root:rk,over:ok,in:ik,on:nk},ak={borderWidth:"1px",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},lk={background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.100}",hoverColor:"{surface.0}",size:"3rem",gutter:"0.5rem",prev:{borderRadius:"50%"},next:{borderRadius:"50%"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},ck={size:"1.5rem"},uk={background:"{content.background}",padding:"1rem 0.25rem"},hk={size:"2rem",borderRadius:"{content.border.radius}",gutter:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},dk={size:"1rem"},fk={background:"rgba(0, 0, 0, 0.5)",color:"{surface.100}",padding:"1rem"},pk={gap:"0.5rem",padding:"1rem"},mk={width:"1rem",height:"1rem",activeBackground:"{primary.color}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},gk={background:"rgba(0, 0, 0, 0.5)"},_k={background:"rgba(255, 255, 255, 0.4)",hoverBackground:"rgba(255, 255, 255, 0.6)",activeBackground:"rgba(255, 255, 255, 0.9)"},yk={size:"3rem",gutter:"0.5rem",background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.50}",hoverColor:"{surface.0}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},vk={size:"1.5rem"},bk={light:{thumbnailNavButton:{hoverBackground:"{surface.100}",color:"{surface.600}",hoverColor:"{surface.700}"},indicatorButton:{background:"{surface.200}",hoverBackground:"{surface.300}"}},dark:{thumbnailNavButton:{hoverBackground:"{surface.700}",color:"{surface.400}",hoverColor:"{surface.0}"},indicatorButton:{background:"{surface.700}",hoverBackground:"{surface.600}"}}},xk={root:ak,navButton:lk,navIcon:ck,thumbnailsContent:uk,thumbnailNavButton:hk,thumbnailNavButtonIcon:dk,caption:fk,indicatorList:pk,indicatorButton:mk,insetIndicatorList:gk,insetIndicatorButton:_k,closeButton:yk,closeButtonIcon:vk,colorScheme:bk},wk={color:"{form.field.icon.color}"},Ck={icon:wk},Sk={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",top:"{form.field.padding.y}",fontSize:"0.75rem",fontWeight:"400"},Tk={paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},kk={root:Sk,input:Tk},Pk={transitionDuration:"{transition.duration}"},Mk={icon:{size:"1.5rem"},mask:{background:"{mask.background}",color:"{mask.color}"}},Ik={position:{left:"auto",right:"1rem",top:"1rem",bottom:"auto"},blur:"8px",background:"rgba(255,255,255,0.1)",borderColor:"rgba(255,255,255,0.2)",borderWidth:"1px",borderRadius:"30px",padding:".5rem",gap:"0.5rem"},Ek={hoverBackground:"rgba(255,255,255,0.1)",color:"{surface.50}",hoverColor:"{surface.0}",size:"3rem",iconSize:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Ak={root:Pk,preview:Mk,toolbar:Ik,action:Ek},zk={size:"15px",hoverSize:"30px",background:"rgba(255,255,255,0.3)",hoverBackground:"rgba(255,255,255,0.3)",borderColor:"unset",hoverBorderColor:"unset",borderWidth:"0",borderRadius:"50%",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"rgba(255,255,255,0.3)",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Rk={handle:zk},Dk={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",gap:"0.5rem"},Bk={fontWeight:"500"},Lk={size:"1rem"},Fk={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}}},Ok={root:Dk,text:Bk,icon:Lk,colorScheme:Fk},$k={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{transition.duration}"},jk={hoverBackground:"{content.hover.background}",hoverColor:"{content.hover.color}"},Nk={root:$k,display:jk},Vk={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},Uk={borderRadius:"{border.radius.sm}"},Zk={light:{chip:{focusBackground:"{surface.200}",color:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",color:"{surface.0}"}}},Gk={root:Vk,chip:Uk,colorScheme:Zk},qk={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.icon.color}",borderRadius:"{form.field.border.radius}",padding:"0.5rem",minWidth:"2.5rem"},Wk={addon:qk},Hk={transitionDuration:"{transition.duration}"},Xk={width:"2.5rem",borderRadius:"{form.field.border.radius}",verticalPadding:"{form.field.padding.y}"},Kk={light:{button:{background:"transparent",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.500}",activeColor:"{surface.600}"}},dark:{button:{background:"transparent",hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.300}",activeColor:"{surface.200}"}}},Yk={root:Hk,button:Xk,colorScheme:Kk},Jk={gap:"0.5rem"},Qk={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"}},eP={root:Jk,input:Qk},tP={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},rP={root:tP},oP={transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},iP={background:"{primary.color}"},nP={background:"{content.border.color}"},sP={color:"{text.muted.color}"},aP={root:oP,value:iP,range:nP,text:sP},lP={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",borderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",shadow:"{form.field.shadow}",borderRadius:"{form.field.border.radius}",transitionDuration:"{form.field.transition.duration}"},cP={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},uP={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},hP={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},dP={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},fP={padding:"{list.option.padding}"},pP={light:{option:{stripedBackground:"{surface.50}"}},dark:{option:{stripedBackground:"{surface.900}"}}},mP={root:lP,list:cP,option:uP,optionGroup:hP,checkmark:dP,emptyMessage:fP,colorScheme:pP},gP={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",verticalOrientation:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},horizontalOrientation:{padding:"0.5rem 0.75rem",gap:"0.5rem"},transitionDuration:"{transition.duration}"},_P={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},yP={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},vP={padding:"0",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",shadow:"{overlay.navigation.shadow}",gap:"0.5rem"},bP={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},xP={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background.}",color:"{navigation.submenu.label.color}"},wP={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},CP={borderColor:"{content.border.color}"},SP={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},TP={root:gP,baseItem:_P,item:yP,overlay:vP,submenu:bP,submenuLabel:xP,submenuIcon:wP,separator:CP,mobileButton:SP},kP={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},PP={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},MP={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},IP={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background}",color:"{navigation.submenu.label.color}"},EP={borderColor:"{content.border.color}"},AP={root:kP,list:PP,item:MP,submenuLabel:IP,separator:EP},zP={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.5rem 0.75rem",transitionDuration:"{transition.duration}"},RP={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},DP={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},BP={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",mobileIndent:"1rem",icon:{size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"}},LP={borderColor:"{content.border.color}"},FP={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},OP={root:zP,baseItem:RP,item:DP,submenu:BP,separator:LP,mobileButton:FP},$P={borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},jP={padding:"0.5rem 0.75rem",gap:"0.5rem",sm:{padding:"0.375rem 0.625rem"},lg:{padding:"0.625rem 0.875rem"}},NP={fontSize:"1rem",fontWeight:"500",sm:{fontSize:"0.875rem"},lg:{fontSize:"1.125rem"}},VP={size:"1.125rem",sm:{size:"1rem"},lg:{size:"1.25rem"}},UP={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},ZP={size:"1rem",sm:{size:"0.875rem"},lg:{size:"1.125rem"}},GP={root:{borderWidth:"1px"}},qP={content:{padding:"0"}},WP={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}},outlined:{color:"{blue.600}",borderColor:"{blue.600}"},simple:{color:"{blue.600}"}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}},outlined:{color:"{green.600}",borderColor:"{green.600}"},simple:{color:"{green.600}"}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}},outlined:{color:"{yellow.600}",borderColor:"{yellow.600}"},simple:{color:"{yellow.600}"}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}},outlined:{color:"{red.600}",borderColor:"{red.600}"},simple:{color:"{red.600}"}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}},outlined:{color:"{surface.500}",borderColor:"{surface.500}"},simple:{color:"{surface.500}"}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}},outlined:{color:"{surface.950}",borderColor:"{surface.950}"},simple:{color:"{surface.950}"}}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}},outlined:{color:"{blue.500}",borderColor:"{blue.500}"},simple:{color:"{blue.500}"}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}},outlined:{color:"{green.500}",borderColor:"{green.500}"},simple:{color:"{green.500}"}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}},outlined:{color:"{yellow.500}",borderColor:"{yellow.500}"},simple:{color:"{yellow.500}"}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}},outlined:{color:"{red.500}",borderColor:"{red.500}"},simple:{color:"{red.500}"}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}},outlined:{color:"{surface.400}",borderColor:"{surface.400}"},simple:{color:"{surface.400}"}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}},outlined:{color:"{surface.0}",borderColor:"{surface.0}"},simple:{color:"{surface.0}"}}}},HP={root:$P,content:jP,text:NP,icon:VP,closeButton:UP,closeIcon:ZP,outlined:GP,simple:qP,colorScheme:WP},XP={borderRadius:"{content.border.radius}",gap:"1rem"},KP={background:"{content.border.color}",size:"0.5rem"},YP={gap:"0.5rem"},JP={size:"0.5rem"},QP={size:"1rem"},eM={verticalGap:"0.5rem",horizontalGap:"1rem"},tM={root:XP,meters:KP,label:YP,labelMarker:JP,labelIcon:QP,labelList:eM},rM={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},oM={width:"2.5rem",color:"{form.field.icon.color}"},iM={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},nM={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},sM={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",gap:"0.5rem"},aM={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},lM={color:"{form.field.icon.color}"},cM={borderRadius:"{border.radius.sm}"},uM={padding:"{list.option.padding}"},hM={root:rM,dropdown:oM,overlay:iM,list:nM,option:sM,optionGroup:aM,chip:cM,clearIcon:lM,emptyMessage:uM},dM={gap:"1.125rem"},fM={gap:"0.5rem"},pM={root:dM,controls:fM},mM={gutter:"0.75rem",transitionDuration:"{transition.duration}"},gM={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{content.border.color}",color:"{content.color}",selectedColor:"{highlight.color}",hoverColor:"{content.hover.color}",padding:"0.75rem 1rem",toggleablePadding:"0.75rem 1rem 1.25rem 1rem",borderRadius:"{content.border.radius}"},_M={background:"{content.background}",hoverBackground:"{content.hover.background}",borderColor:"{content.border.color}",color:"{text.muted.color}",hoverColor:"{text.color}",size:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},yM={color:"{content.border.color}",borderRadius:"{content.border.radius}",height:"24px"},vM={root:mM,node:gM,nodeToggleButton:_M,connector:yM},bM={outline:{width:"2px",color:"{content.background}"}},xM={root:bM},wM={padding:"0.5rem 1rem",gap:"0.25rem",borderRadius:"{content.border.radius}",background:"{content.background}",color:"{content.color}",transitionDuration:"{transition.duration}"},CM={background:"transparent",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}",width:"2.5rem",height:"2.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},SM={color:"{text.muted.color}"},TM={maxWidth:"2.5rem"},kM={root:wM,navButton:CM,currentPageReport:SM,jumpToPageInput:TM},PM={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},MM={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"{content.border.color}",borderWidth:"0",borderRadius:"0"},IM={padding:"0.375rem 1.125rem"},EM={fontWeight:"600"},AM={padding:"0 1.125rem 1.125rem 1.125rem"},zM={padding:"0 1.125rem 1.125rem 1.125rem"},RM={root:PM,header:MM,toggleableHeader:IM,title:EM,content:AM,footer:zM},DM={gap:"0.5rem",transitionDuration:"{transition.duration}"},BM={background:"{content.background}",borderColor:"{content.border.color}",borderWidth:"1px",color:"{content.color}",padding:"0.25rem 0.25rem",borderRadius:"{content.border.radius}",first:{borderWidth:"1px",topBorderRadius:"{content.border.radius}"},last:{borderWidth:"1px",bottomBorderRadius:"{content.border.radius}"}},LM={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",gap:"0.5rem",padding:"{navigation.item.padding}",borderRadius:"{content.border.radius}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},FM={indent:"1rem"},OM={color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}"},$M={root:DM,panel:BM,item:LM,submenu:FM,submenuIcon:OM},jM={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:".75rem"},NM={color:"{form.field.icon.color}"},VM={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",padding:"{overlay.popover.padding}",shadow:"{overlay.popover.shadow}"},UM={gap:"0.5rem"},ZM={light:{strength:{weakBackground:"{red.500}",mediumBackground:"{amber.500}",strongBackground:"{green.500}"}},dark:{strength:{weakBackground:"{red.400}",mediumBackground:"{amber.400}",strongBackground:"{green.400}"}}},GM={meter:jM,icon:NM,overlay:VM,content:UM,colorScheme:ZM},qM={gap:"1.125rem"},WM={gap:"0.5rem"},HM={root:qM,controls:WM},XM={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},KM={padding:"{overlay.popover.padding}"},YM={root:XM,content:KM},JM={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:"1.25rem"},QM={background:"{primary.color}"},eI={color:"{primary.contrast.color}",fontSize:"0.75rem",fontWeight:"600"},tI={root:JM,value:QM,label:eI},rI={light:{root:{colorOne:"{red.500}",colorTwo:"{blue.500}",colorThree:"{green.500}",colorFour:"{yellow.500}"}},dark:{root:{colorOne:"{red.400}",colorTwo:"{blue.400}",colorThree:"{green.400}",colorFour:"{yellow.400}"}}},oI={colorScheme:rI},iI={width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},nI={size:"0.75rem",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.5rem"},lg:{size:"1rem"}},sI={root:iI,icon:nI},aI={gap:"0.25rem",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},lI={size:"1rem",color:"{text.muted.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"},cI={root:aI,icon:lI},uI={light:{root:{background:"rgba(0,0,0,0.1)"}},dark:{root:{background:"rgba(255,255,255,0.3)"}}},hI={colorScheme:uI},dI={transitionDuration:"{transition.duration}"},fI={size:"9px",borderRadius:"{border.radius.sm}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},pI={light:{bar:{background:"{surface.100}"}},dark:{bar:{background:"{surface.800}"}}},mI={root:dI,bar:fI,colorScheme:pI},gI={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},_I={width:"2.5rem",color:"{form.field.icon.color}"},yI={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},vI={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},bI={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},xI={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},wI={color:"{form.field.icon.color}"},CI={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},SI={padding:"{list.option.padding}"},TI={root:gI,dropdown:_I,overlay:yI,list:vI,option:bI,optionGroup:xI,clearIcon:wI,checkmark:CI,emptyMessage:SI},kI={borderRadius:"{form.field.border.radius}"},PI={light:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}},dark:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}}},MI={root:kI,colorScheme:PI},II={borderRadius:"{content.border.radius}"},EI={light:{root:{background:"{surface.200}",animationBackground:"rgba(255,255,255,0.4)"}},dark:{root:{background:"rgba(255, 255, 255, 0.06)",animationBackground:"rgba(255, 255, 255, 0.04)"}}},AI={root:II,colorScheme:EI},zI={transitionDuration:"{transition.duration}"},RI={background:"{content.border.color}",borderRadius:"{content.border.radius}",size:"3px"},DI={background:"{primary.color}"},BI={width:"20px",height:"20px",borderRadius:"50%",background:"{content.border.color}",hoverBackground:"{content.border.color}",content:{borderRadius:"50%",hoverBackground:"{content.background}",width:"16px",height:"16px",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.08), 0px 1px 1px 0px rgba(0, 0, 0, 0.14)"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},LI={light:{handle:{content:{background:"{surface.0}"}}},dark:{handle:{content:{background:"{surface.950}"}}}},FI={root:zI,track:RI,range:DI,handle:BI,colorScheme:LI},OI={gap:"0.5rem",transitionDuration:"{transition.duration}"},$I={root:OI},jI={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)"},NI={root:jI},VI={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",transitionDuration:"{transition.duration}"},UI={background:"{content.border.color}"},ZI={size:"24px",background:"transparent",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},GI={root:VI,gutter:UI,handle:ZI},qI={transitionDuration:"{transition.duration}"},WI={background:"{content.border.color}",activeBackground:"{primary.color}",margin:"0 0 0 1.625rem",size:"2px"},HI={padding:"0.5rem",gap:"1rem"},XI={padding:"0",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},KI={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},YI={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},JI={padding:"0.875rem 0.5rem 1.125rem 0.5rem"},QI={background:"{content.background}",color:"{content.color}",padding:"0",indent:"1rem"},eE={root:qI,separator:WI,step:HI,stepHeader:XI,stepTitle:KI,stepNumber:YI,steppanels:JI,steppanel:QI},tE={transitionDuration:"{transition.duration}"},rE={background:"{content.border.color}"},oE={borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},iE={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},nE={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},sE={root:tE,separator:rE,itemLink:oE,itemLabel:iE,itemNumber:nE},aE={transitionDuration:"{transition.duration}"},lE={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},cE={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},uE={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},hE={height:"1px",bottom:"-1px",background:"{primary.color}"},dE={root:aE,tablist:lE,item:cE,itemIcon:uE,activeBar:hE},fE={transitionDuration:"{transition.duration}"},pE={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},mE={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},gE={background:"{content.background}",color:"{content.color}",padding:"0.875rem 1.125rem 1.125rem 1.125rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"inset {focus.ring.shadow}"}},_E={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",width:"2.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},yE={height:"1px",bottom:"-1px",background:"{primary.color}"},vE={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},bE={root:fE,tablist:pE,tab:mE,tabpanel:gE,navButton:_E,activeBar:yE,colorScheme:vE},xE={transitionDuration:"{transition.duration}"},wE={background:"{content.background}",borderColor:"{content.border.color}"},CE={borderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},SE={background:"{content.background}",color:"{content.color}"},TE={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}"},kE={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},PE={root:xE,tabList:wE,tab:CE,tabPanel:SE,navButton:TE,colorScheme:kE},ME={fontSize:"0.875rem",fontWeight:"700",padding:"0.25rem 0.5rem",gap:"0.25rem",borderRadius:"{content.border.radius}",roundedBorderRadius:"{border.radius.xl}"},IE={size:"0.75rem"},EE={light:{primary:{background:"{primary.100}",color:"{primary.700}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.100}",color:"{green.700}"},info:{background:"{sky.100}",color:"{sky.700}"},warn:{background:"{orange.100}",color:"{orange.700}"},danger:{background:"{red.100}",color:"{red.700}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"color-mix(in srgb, {primary.500}, transparent 84%)",color:"{primary.300}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",color:"{green.300}"},info:{background:"color-mix(in srgb, {sky.500}, transparent 84%)",color:"{sky.300}"},warn:{background:"color-mix(in srgb, {orange.500}, transparent 84%)",color:"{orange.300}"},danger:{background:"color-mix(in srgb, {red.500}, transparent 84%)",color:"{red.300}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},AE={root:ME,icon:IE,colorScheme:EE},zE={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.color}",height:"18rem",padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{form.field.border.radius}"},RE={gap:"0.25rem"},DE={margin:"2px 0"},BE={root:zE,prompt:RE,commandResponse:DE},LE={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},FE={root:LE},OE={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},$E={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},jE={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},NE={mobileIndent:"1rem"},VE={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},UE={borderColor:"{content.border.color}"},ZE={root:OE,list:$E,item:jE,submenu:NE,submenuIcon:VE,separator:UE},GE={minHeight:"5rem"},qE={eventContent:{padding:"1rem 0"}},WE={eventContent:{padding:"0 1rem"}},HE={size:"1.125rem",borderRadius:"50%",borderWidth:"2px",background:"{content.background}",borderColor:"{content.border.color}",content:{borderRadius:"50%",size:"0.375rem",background:"{primary.color}",insetShadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"}},XE={color:"{content.border.color}",size:"2px"},KE={event:GE,horizontal:qE,vertical:WE,eventMarker:HE,eventConnector:XE},YE={width:"25rem",borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},JE={size:"1.125rem"},QE={padding:"{overlay.popover.padding}",gap:"0.5rem"},eA={gap:"0.5rem"},tA={fontWeight:"500",fontSize:"1rem"},rA={fontWeight:"500",fontSize:"0.875rem"},oA={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},iA={size:"1rem"},nA={light:{blur:"1.5px",info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}}}},dark:{blur:"10px",info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",detailColor:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}}}}},sA={root:YE,icon:JE,content:QE,text:eA,summary:tA,detail:rA,closeButton:oA,closeIcon:iA,colorScheme:nA},aA={padding:"0.25rem",borderRadius:"{content.border.radius}",gap:"0.5rem",fontWeight:"500",disabledBackground:"{form.field.disabled.background}",disabledBorderColor:"{form.field.disabled.background}",disabledColor:"{form.field.disabled.color}",invalidBorderColor:"{form.field.invalid.border.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",padding:"0.25rem"},lg:{fontSize:"{form.field.lg.font.size}",padding:"0.25rem"}},lA={disabledColor:"{form.field.disabled.color}"},cA={padding:"0.25rem 0.75rem",borderRadius:"{content.border.radius}",checkedShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.02), 0px 1px 2px 0px rgba(0, 0, 0, 0.04)",sm:{padding:"0.25rem 0.75rem"},lg:{padding:"0.25rem 0.75rem"}},uA={light:{root:{background:"{surface.100}",checkedBackground:"{surface.100}",hoverBackground:"{surface.100}",borderColor:"{surface.100}",color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}",checkedBorderColor:"{surface.100}"},content:{checkedBackground:"{surface.0}"},icon:{color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}"}},dark:{root:{background:"{surface.950}",checkedBackground:"{surface.950}",hoverBackground:"{surface.950}",borderColor:"{surface.950}",color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}",checkedBorderColor:"{surface.950}"},content:{checkedBackground:"{surface.800}"},icon:{color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}"}}},hA={root:aA,icon:lA,content:cA,colorScheme:uA},dA={width:"2.5rem",height:"1.5rem",borderRadius:"30px",gap:"0.25rem",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},borderWidth:"1px",borderColor:"transparent",hoverBorderColor:"transparent",checkedBorderColor:"transparent",checkedHoverBorderColor:"transparent",invalidBorderColor:"{form.field.invalid.border.color}",transitionDuration:"{form.field.transition.duration}",slideDuration:"0.2s"},fA={borderRadius:"50%",size:"1rem"},pA={light:{root:{background:"{surface.300}",disabledBackground:"{form.field.disabled.background}",hoverBackground:"{surface.400}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.0}",disabledBackground:"{form.field.disabled.color}",hoverBackground:"{surface.0}",checkedBackground:"{surface.0}",checkedHoverBackground:"{surface.0}",color:"{text.muted.color}",hoverColor:"{text.color}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}},dark:{root:{background:"{surface.700}",disabledBackground:"{surface.600}",hoverBackground:"{surface.600}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.400}",disabledBackground:"{surface.900}",hoverBackground:"{surface.300}",checkedBackground:"{surface.900}",checkedHoverBackground:"{surface.900}",color:"{surface.900}",hoverColor:"{surface.800}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}}},mA={root:dA,handle:fA,colorScheme:pA},gA={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.75rem"},_A={root:gA},yA={maxWidth:"12.5rem",gutter:"0.25rem",shadow:"{overlay.popover.shadow}",padding:"0.5rem 0.75rem",borderRadius:"{overlay.popover.border.radius}"},vA={light:{root:{background:"{surface.700}",color:"{surface.0}"}},dark:{root:{background:"{surface.700}",color:"{surface.0}"}}},bA={root:yA,colorScheme:vA},xA={background:"{content.background}",color:"{content.color}",padding:"1rem",gap:"2px",indent:"1rem",transitionDuration:"{transition.duration}"},wA={padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.color}",hoverColor:"{text.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},gap:"0.25rem"},CA={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}"},SA={borderRadius:"50%",size:"1.75rem",hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedHoverColor:"{primary.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},TA={size:"2rem"},kA={margin:"0 0 0.5rem 0"},PA={root:xA,node:wA,nodeIcon:CA,nodeToggleButton:SA,loadingIcon:TA,filter:kA},MA={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},IA={width:"2.5rem",color:"{form.field.icon.color}"},EA={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},AA={padding:"{list.padding}"},zA={padding:"{list.option.padding}"},RA={borderRadius:"{border.radius.sm}"},DA={color:"{form.field.icon.color}"},BA={root:MA,dropdown:IA,overlay:EA,tree:AA,emptyMessage:zA,chip:RA,clearIcon:DA},LA={transitionDuration:"{transition.duration}"},FA={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},OA={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{treetable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},$A={fontWeight:"600"},jA={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},NA={borderColor:"{treetable.border.color}",padding:"0.75rem 1rem",gap:"0.5rem"},VA={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",padding:"0.75rem 1rem"},UA={fontWeight:"600"},ZA={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},GA={width:"0.5rem"},qA={width:"1px",color:"{primary.color}"},WA={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},HA={size:"2rem"},XA={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},KA={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},YA={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},JA={light:{root:{borderColor:"{content.border.color}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},QA={root:LA,header:FA,headerCell:OA,columnTitle:$A,row:jA,bodyCell:NA,footerCell:VA,columnFooter:UA,footer:ZA,columnResizer:GA,resizeIndicator:qA,sortIcon:WA,loadingIcon:HA,nodeToggleButton:XA,paginatorTop:KA,paginatorBottom:YA,colorScheme:JA},e5={mask:{background:"{content.background}",color:"{text.muted.color}"},icon:{size:"2rem"}},t5={loader:e5},r5=Object.defineProperty,o5=Object.defineProperties,i5=Object.getOwnPropertyDescriptors,K_=Object.getOwnPropertySymbols,n5=Object.prototype.hasOwnProperty,s5=Object.prototype.propertyIsEnumerable,Y_=(n,s,d)=>s in n?r5(n,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):n[s]=d,J_,a5=(J_=((n,s)=>{for(var d in s||(s={}))n5.call(s,d)&&Y_(n,d,s[d]);if(K_)for(var d of K_(s))s5.call(s,d)&&Y_(n,d,s[d]);return n})({},bC),o5(J_,i5({components:{accordion:H2,autocomplete:iC,avatar:uC,badge:_C,blockui:wC,breadcrumb:kC,button:IC,card:BC,carousel:NC,cascadeselect:HC,checkbox:YC,chip:oS,colorpicker:lS,confirmdialog:hS,confirmpopup:gS,contextmenu:CS,datatable:US,dataview:KS,datepicker:gT,dialog:wT,divider:PT,dock:ET,drawer:LT,editor:VT,fieldset:WT,fileupload:tk,floatlabel:sk,galleria:xk,iconfield:Ck,iftalabel:kk,image:Ak,imagecompare:Rk,inlinemessage:Ok,inplace:Nk,inputchips:Gk,inputgroup:Wk,inputnumber:Yk,inputotp:eP,inputtext:rP,knob:aP,listbox:mP,megamenu:TP,menu:AP,menubar:OP,message:HP,metergroup:tM,multiselect:hM,orderlist:pM,organizationchart:vM,overlaybadge:xM,paginator:kM,panel:RM,panelmenu:$M,password:GM,picklist:HM,popover:YM,progressbar:tI,progressspinner:oI,radiobutton:sI,rating:cI,ripple:hI,scrollpanel:mI,select:TI,selectbutton:MI,skeleton:AI,slider:FI,speeddial:$I,splitbutton:NI,splitter:GI,stepper:eE,steps:sE,tabmenu:dE,tabs:bE,tabview:PE,tag:AE,terminal:BE,textarea:FE,tieredmenu:ZE,timeline:KE,toast:sA,togglebutton:hA,toggleswitch:mA,toolbar:_A,tooltip:bA,tree:PA,treeselect:BA,treetable:QA,virtualscroller:t5}})));function l5(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ld={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.2.0/LICENSE.txt
 */var c5=ld.exports,Q_;function u5(){return Q_||(Q_=1,function(n,s){(function(d,_){n.exports=_()})(c5,function(){var d={},_={};function w(b,c,R){if(_[b]=R,b==="index"){var Z="var sharedModule = {}; ("+_.shared+")(sharedModule); ("+_.worker+")(sharedModule);",V={};return _.shared(V),_.index(d,V),typeof window<"u"&&d.setWorkerUrl(window.URL.createObjectURL(new Blob([Z],{type:"text/javascript"}))),d}}w("shared",["exports"],function(b){function c(o,t,i,a){return new(i||(i=Promise))(function(h,m){function g(T){try{C(a.next(T))}catch(M){m(M)}}function v(T){try{C(a.throw(T))}catch(M){m(M)}}function C(T){var M;T.done?h(T.value):(M=T.value,M instanceof i?M:new i(function(I){I(M)})).then(g,v)}C((a=a.apply(o,t||[])).next())})}function R(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Z,V;function H(){if(V)return Z;function o(t,i){this.x=t,this.y=i}return V=1,Z=o,o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,i){return this.clone()._rotateAround(t,i)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var i=t.x-this.x,a=t.y-this.y;return i*i+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,i){return Math.atan2(this.x*i-this.y*t,this.x*t+this.y*i)},_matMult:function(t){var i=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var i=Math.cos(t),a=Math.sin(t),h=a*this.x+i*this.y;return this.x=i*this.x-a*this.y,this.y=h,this},_rotateAround:function(t,i){var a=Math.cos(t),h=Math.sin(t),m=i.y+h*(this.x-i.x)+a*(this.y-i.y);return this.x=i.x+a*(this.x-i.x)-h*(this.y-i.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t},Z}typeof SuppressedError=="function"&&SuppressedError;var K,G,fe=R(H()),Be=function(){if(G)return K;function o(t,i,a,h){this.cx=3*t,this.bx=3*(a-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(h-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=a,this.p2y=h}return G=1,K=o,o.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,i){if(i===void 0&&(i=1e-6),t<0)return 0;if(t>1)return 1;for(var a=t,h=0;h<8;h++){var m=this.sampleCurveX(a)-t;if(Math.abs(m)<i)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=m/g}var v=0,C=1;for(a=t,h=0;h<20&&(m=this.sampleCurveX(a),!(Math.abs(m-t)<i));h++)t>m?v=a:C=a,a=.5*(C-v)+v;return a},solve:function(t,i){return this.sampleCurveY(this.solveCurveX(t,i))}},K}(),et=R(Be);let We,lt;function st(){return We==null&&(We=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),We}function ye(){if(lt==null&&(lt=!1,st())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let a=0;a<5*5;a++){const h=4*a;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(a%5,Math.floor(a/5),1,1)}const i=t.getImageData(0,0,5,5).data;for(let a=0;a<5*5*4;a++)if(a%4!=3&&i[a]!==a){lt=!0;break}}}return lt||!1}var Ae,Ye=1e-6,nt=typeof Float32Array<"u"?Float32Array:Array;function rt(){var o=new nt(9);return nt!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function Xe(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function mt(){var o=new nt(3);return nt!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function kt(o,t,i){var a=new nt(3);return a[0]=o,a[1]=t,a[2]=i,a}function ot(o,t,i){var a=t[0],h=t[1],m=t[2],g=t[3];return o[0]=i[0]*a+i[4]*h+i[8]*m+i[12]*g,o[1]=i[1]*a+i[5]*h+i[9]*m+i[13]*g,o[2]=i[2]*a+i[6]*h+i[10]*m+i[14]*g,o[3]=i[3]*a+i[7]*h+i[11]*m+i[15]*g,o}function At(){var o=new nt(4);return nt!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function Bt(){var o=new nt(2);return nt!=Float32Array&&(o[0]=0,o[1]=0),o}function gr(o,t){var i=new nt(2);return i[0]=o,i[1]=t,i}Math.hypot||(Math.hypot=function(){for(var o=0,t=arguments.length;t--;)o+=arguments[t]*arguments[t];return Math.sqrt(o)}),mt(),Ae=new nt(4),nt!=Float32Array&&(Ae[0]=0,Ae[1]=0,Ae[2]=0,Ae[3]=0),mt(),kt(1,0,0),kt(0,1,0),At(),At(),rt(),Bt();const vt=8192;function Et(o,t,i){return t*(vt/(o.tileSize*Math.pow(2,i-o.tileID.overscaledZ)))}function Ft(o,t){return(o%t+t)%t}function Ar(o,t,i){return o*(1-i)+t*i}function zr(o){if(o<=0)return 0;if(o>=1)return 1;const t=o*o,i=t*o;return 4*(o<.5?i:3*(o-t)+i-.75)}function _r(o,t,i,a){const h=new et(o,t,i,a);return m=>h.solve(m)}const or=_r(.25,.1,.25,1);function Gr(o,t,i){return Math.min(i,Math.max(t,o))}function Lr(o,t,i){const a=i-t,h=((o-t)%a+a)%a+t;return h===t?i:h}function Rr(o,...t){for(const i of t)for(const a in i)o[a]=i[a];return o}let yo=1;function Ao(o,t,i){const a={};for(const h in o)a[h]=t.call(this,o[h],h,o);return a}function Vo(o,t,i){const a={};for(const h in o)t.call(this,o[h],h,o)&&(a[h]=o[h]);return a}function to(o){return Array.isArray(o)?o.map(to):typeof o=="object"&&o?Ao(o,to):o}const Uo={};function qr(o){Uo[o]||(typeof console<"u"&&console.warn(o),Uo[o]=!0)}function se(o,t,i){return(i.y-o.y)*(t.x-o.x)>(t.y-o.y)*(i.x-o.x)}function pe(o){return typeof WorkerGlobalScope<"u"&&o!==void 0&&o instanceof WorkerGlobalScope}let ke=null;function Ge(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}const Ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ve(o,t,i,a,h){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(o,{timestamp:0});try{const g=m==null?void 0:m.format;if(!g||!g.startsWith("BGR")&&!g.startsWith("RGB"))throw new Error(`Unrecognized format ${g}`);const v=g.startsWith("BGR"),C=new Uint8ClampedArray(a*h*4);if(yield m.copyTo(C,function(T,M,I,B,F){const O=4*Math.max(1,0),j=(Math.max(0,I)-I)*B*4+O,W=4*B,ee=Math.max(0,M),he=Math.max(0,I);return{rect:{x:ee,y:he,width:Math.min(T.width,M+B)-ee,height:Math.min(T.height,I+F)-he},layout:[{offset:j,stride:W}]}}(o,t,i,a,h)),v)for(let T=0;T<C.length;T+=4){const M=C[T];C[T]=C[T+2],C[T+2]=M}return C}finally{m.close()}})}let it,tt;function Je(o,t,i,a){return o.addEventListener(t,i,a),{unsubscribe:()=>{o.removeEventListener(t,i,a)}}}function Ue(o){return o/Math.PI*180}const St="AbortError";function at(){return new Error(St)}const bt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function It(o){return bt.REGISTERED_PROTOCOLS[o.substring(0,o.indexOf("://"))]}const Ot="global-dispatcher";class qt extends Error{constructor(t,i,a,h){super(`AJAXError: ${i} (${t}): ${a}`),this.status=t,this.statusText=i,this.url=a,this.body=h}}const Vt=()=>pe(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Dr=function(o,t){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){const a=It(o.url);if(a)return a(o,t);if(pe(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,targetMapId:Ot},t)}if(!(/^file:/.test(i=o.url)||/^file:/.test(Vt())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(a,h){return c(this,void 0,void 0,function*(){const m=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,cache:a.cache,referrer:Vt(),signal:h.signal});let g,v;a.type!=="json"||m.headers.has("Accept")||m.headers.set("Accept","application/json");try{g=yield fetch(m)}catch(T){throw new qt(0,T.message,a.url,new Blob)}if(!g.ok){const T=yield g.blob();throw new qt(g.status,g.statusText,a.url,T)}v=a.type==="arrayBuffer"||a.type==="image"?g.arrayBuffer():a.type==="json"?g.json():g.text();const C=yield v;if(h.signal.aborted)throw at();return{data:C,cacheControl:g.headers.get("Cache-Control"),expires:g.headers.get("Expires")}})}(o,t);if(pe(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,mustQueue:!0,targetMapId:Ot},t)}var i;return function(a,h){return new Promise((m,g)=>{var v;const C=new XMLHttpRequest;C.open(a.method||"GET",a.url,!0),a.type!=="arrayBuffer"&&a.type!=="image"||(C.responseType="arraybuffer");for(const T in a.headers)C.setRequestHeader(T,a.headers[T]);a.type==="json"&&(C.responseType="text",!((v=a.headers)===null||v===void 0)&&v.Accept||C.setRequestHeader("Accept","application/json")),C.withCredentials=a.credentials==="include",C.onerror=()=>{g(new Error(C.statusText))},C.onload=()=>{if(!h.signal.aborted)if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){let T=C.response;if(a.type==="json")try{T=JSON.parse(C.response)}catch(M){return void g(M)}m({data:T,cacheControl:C.getResponseHeader("Cache-Control"),expires:C.getResponseHeader("Expires")})}else{const T=new Blob([C.response],{type:C.getResponseHeader("Content-Type")});g(new qt(C.status,C.statusText,a.url,T))}},h.signal.addEventListener("abort",()=>{C.abort(),g(at())}),C.send(a.body)})}(o,t)};function Sr(o){if(!o||o.indexOf("://")<=0||o.indexOf("data:image/")===0||o.indexOf("blob:")===0)return!0;const t=new URL(o),i=window.location;return t.protocol===i.protocol&&t.host===i.host}function vo(o,t,i){i[o]&&i[o].indexOf(t)!==-1||(i[o]=i[o]||[],i[o].push(t))}function uo(o,t,i){if(i&&i[o]){const a=i[o].indexOf(t);a!==-1&&i[o].splice(a,1)}}class gi{constructor(t,i={}){Rr(this,i),this.type=t}}class oi extends gi{constructor(t,i={}){super("error",Rr({error:t},i))}}class ge{on(t,i){return this._listeners=this._listeners||{},vo(t,i,this._listeners),{unsubscribe:()=>{this.off(t,i)}}}off(t,i){return uo(t,i,this._listeners),uo(t,i,this._oneTimeListeners),this}once(t,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},vo(t,i,this._oneTimeListeners),this):new Promise(a=>this.once(t,a))}fire(t,i){typeof t=="string"&&(t=new gi(t,i||{}));const a=t.type;if(this.listens(a)){t.target=this;const h=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const v of h)v.call(this,t);const m=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const v of m)uo(a,v,this._oneTimeListeners),v.call(this,t);const g=this._eventedParent;g&&(Rr(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(t))}else t instanceof oi&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,i){return this._eventedParent=t,this._eventedParentData=i,this}}var A={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const U=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function X(o,t){const i={};for(const a in o)a!=="ref"&&(i[a]=o[a]);return U.forEach(a=>{a in t&&(i[a]=t[a])}),i}function te(o,t){if(Array.isArray(o)){if(!Array.isArray(t)||o.length!==t.length)return!1;for(let i=0;i<o.length;i++)if(!te(o[i],t[i]))return!1;return!0}if(typeof o=="object"&&o!==null&&t!==null){if(typeof t!="object"||Object.keys(o).length!==Object.keys(t).length)return!1;for(const i in o)if(!te(o[i],t[i]))return!1;return!0}return o===t}function le(o,t){o.push(t)}function _e(o,t,i){le(i,{command:"addSource",args:[o,t[o]]})}function Se(o,t,i){le(t,{command:"removeSource",args:[o]}),i[o]=!0}function me(o,t,i,a){Se(o,i,a),_e(o,t,i)}function ze(o,t,i){let a;for(a in o[i])if(Object.prototype.hasOwnProperty.call(o[i],a)&&a!=="data"&&!te(o[i][a],t[i][a]))return!1;for(a in t[i])if(Object.prototype.hasOwnProperty.call(t[i],a)&&a!=="data"&&!te(o[i][a],t[i][a]))return!1;return!0}function Pe(o,t,i,a,h,m){o=o||{},t=t||{};for(const g in o)Object.prototype.hasOwnProperty.call(o,g)&&(te(o[g],t[g])||i.push({command:m,args:[a,g,t[g],h]}));for(const g in t)Object.prototype.hasOwnProperty.call(t,g)&&!Object.prototype.hasOwnProperty.call(o,g)&&(te(o[g],t[g])||i.push({command:m,args:[a,g,t[g],h]}))}function ve(o){return o.id}function Fe(o,t){return o[t.id]=t,o}class be{constructor(t,i,a,h){this.message=(t?`${t}: `:"")+a,h&&(this.identifier=h),i!=null&&i.__line__&&(this.line=i.__line__)}}function Qe(o,...t){for(const i of t)for(const a in i)o[a]=i[a];return o}class gt extends Error{constructor(t,i){super(i),this.message=i,this.key=t}}class zt{constructor(t,i=[]){this.parent=t,this.bindings={};for(const[a,h]of i)this.bindings[a]=h}concat(t){return new zt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Pt={kind:"null"},Le={kind:"number"},dt={kind:"string"},ht={kind:"boolean"},Lt={kind:"color"},Mt={kind:"projectionDefinition"},$t={kind:"object"},xt={kind:"value"},pn={kind:"collator"},Nr={kind:"formatted"},Wr={kind:"padding"},fr={kind:"resolvedImage"},_a={kind:"variableAnchorOffsetCollection"};function zo(o,t){return{kind:"array",itemType:o,N:t}}function sr(o){if(o.kind==="array"){const t=sr(o.itemType);return typeof o.N=="number"?`array<${t}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${t}>`}return o.kind}const Ou=[Pt,Le,dt,ht,Lt,Mt,Nr,$t,zo(xt),Wr,fr,_a];function As(o,t){if(t.kind==="error")return null;if(o.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!As(o.itemType,t.itemType))&&(typeof o.N!="number"||o.N===t.N))return null}else{if(o.kind===t.kind)return null;if(o.kind==="value"){for(const i of Ou)if(!As(i,t))return null}}return`Expected ${sr(o)} but found ${sr(t)} instead.`}function Rl(o,t){return t.some(i=>i.kind===o.kind)}function Yi(o,t){return t.some(i=>i==="null"?o===null:i==="array"?Array.isArray(o):i==="object"?o&&!Array.isArray(o)&&typeof o=="object":i===typeof o)}function Gn(o,t){return o.kind==="array"&&t.kind==="array"?o.itemType.kind===t.itemType.kind&&typeof o.N=="number":o.kind===t.kind}const Dl=.96422,$u=.82521,ju=4/29,qn=6/29,Nu=3*qn*qn,jd=qn*qn*qn,Nd=Math.PI/180,Vd=180/Math.PI;function Bl(o){return(o%=360)<0&&(o+=360),o}function Wn([o,t,i,a]){let h,m;const g=Fl((.2225045*(o=Ll(o))+.7168786*(t=Ll(t))+.0606169*(i=Ll(i)))/1);o===t&&t===i?h=m=g:(h=Fl((.4360747*o+.3850649*t+.1430804*i)/Dl),m=Fl((.0139322*o+.0971045*t+.7141733*i)/$u));const v=116*g-16;return[v<0?0:v,500*(h-g),200*(g-m),a]}function Ll(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function Fl(o){return o>jd?Math.pow(o,1/3):o/Nu+ju}function Hn([o,t,i,a]){let h=(o+16)/116,m=isNaN(t)?h:h+t/500,g=isNaN(i)?h:h-i/200;return h=1*$l(h),m=Dl*$l(m),g=$u*$l(g),[Ol(3.1338561*m-1.6168667*h-.4906146*g),Ol(-.9787684*m+1.9161415*h+.033454*g),Ol(.0719453*m-.2289914*h+1.4052427*g),a]}function Ol(o){return(o=o<=.00304?12.92*o:1.055*Math.pow(o,1/2.4)-.055)<0?0:o>1?1:o}function $l(o){return o>qn?o*o*o:Nu*(o-ju)}function ya(o){return parseInt(o.padEnd(2,o),16)/255}function jl(o,t){return mn(t?o/100:o,0,1)}function mn(o,t,i){return Math.min(Math.max(t,o),i)}function _i(o){return!o.some(Number.isNaN)}const Ht={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Zo(o,t,i){return o+i*(t-o)}function ii(o,t,i){return o.map((a,h)=>Zo(a,t[h],i))}class Xt{constructor(t,i,a,h=1,m=!0){this.r=t,this.g=i,this.b=a,this.a=h,m||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,i,a,h]))}static parse(t){if(t instanceof Xt)return t;if(typeof t!="string")return;const i=function(a){if((a=a.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=Ht[a];if(h){const[g,v,C]=h;return[g/255,v/255,C/255,1]}if(a.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(a)){const g=a.length<6?1:2;let v=1;return[ya(a.slice(v,v+=g)),ya(a.slice(v,v+=g)),ya(a.slice(v,v+=g)),ya(a.slice(v,v+g)||"ff")]}if(a.startsWith("rgb")){const g=a.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[v,C,T,M,I,B,F,O,j,W,ee,he]=g,oe=[M||" ",F||" ",W].join("");if(oe==="  "||oe==="  /"||oe===",,"||oe===",,,"){const L=[T,B,j].join(""),q=L==="%%%"?100:L===""?255:0;if(q){const ie=[mn(+C/q,0,1),mn(+I/q,0,1),mn(+O/q,0,1),ee?jl(+ee,he):1];if(_i(ie))return ie}}return}}const m=a.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[g,v,C,T,M,I,B,F,O]=m,j=[C||" ",M||" ",B].join("");if(j==="  "||j==="  /"||j===",,"||j===",,,"){const W=[+v,mn(+T,0,100),mn(+I,0,100),F?jl(+F,O):1];if(_i(W))return function([ee,he,oe,L]){function q(ie){const we=(ie+ee/30)%12,Oe=he*Math.min(oe,1-oe);return oe-Oe*Math.max(-1,Math.min(we-3,9-we,1))}return ee=Bl(ee),he/=100,oe/=100,[q(0),q(8),q(4),L]}(W)}}}(t);return i?new Xt(...i,!1):void 0}get rgb(){const{r:t,g:i,b:a,a:h}=this,m=h||1/0;return this.overwriteGetter("rgb",[t/m,i/m,a/m,h])}get hcl(){return this.overwriteGetter("hcl",function(t){const[i,a,h,m]=Wn(t),g=Math.sqrt(a*a+h*h);return[Math.round(1e4*g)?Bl(Math.atan2(h,a)*Vd):NaN,g,i,m]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Wn(this.rgb))}overwriteGetter(t,i){return Object.defineProperty(this,t,{value:i}),i}toString(){const[t,i,a,h]=this.rgb;return`rgba(${[t,i,a].map(m=>Math.round(255*m)).join(",")},${h})`}static interpolate(t,i,a,h="rgb"){switch(h){case"rgb":{const[m,g,v,C]=ii(t.rgb,i.rgb,a);return new Xt(m,g,v,C,!1)}case"hcl":{const[m,g,v,C]=t.hcl,[T,M,I,B]=i.hcl;let F,O;if(isNaN(m)||isNaN(T))isNaN(m)?isNaN(T)?F=NaN:(F=T,v!==1&&v!==0||(O=M)):(F=m,I!==1&&I!==0||(O=g));else{let oe=T-m;T>m&&oe>180?oe-=360:T<m&&m-T>180&&(oe+=360),F=m+a*oe}const[j,W,ee,he]=function([oe,L,q,ie]){return oe=isNaN(oe)?0:oe*Nd,Hn([q,Math.cos(oe)*L,Math.sin(oe)*L,ie])}([F,O??Zo(g,M,a),Zo(v,I,a),Zo(C,B,a)]);return new Xt(j,W,ee,he,!1)}case"lab":{const[m,g,v,C]=Hn(ii(t.lab,i.lab,a));return new Xt(m,g,v,C,!1)}}}}Xt.black=new Xt(0,0,0,1),Xt.white=new Xt(1,1,1,1),Xt.transparent=new Xt(0,0,0,0),Xt.red=new Xt(1,0,0,1);class va{constructor(t,i,a){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,i){return this.collator.compare(t,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Nl=["bottom","center","top"];class ni{constructor(t,i,a,h,m,g){this.text=t,this.image=i,this.scale=a,this.fontStack=h,this.textColor=m,this.verticalAlign=g}}class ho{constructor(t){this.sections=t}static fromString(t){return new ho([new ni(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof ho?t:ho.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class ro{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ro)return t;if(typeof t=="number")return new ro([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const i of t)if(typeof i!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new ro(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,i,a){return new ro(ii(t.values,i.values,a))}}class Tr{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Vl=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class oo{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof oo)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let i=0;i<t.length;i+=2){const a=t[i],h=t[i+1];if(typeof a!="string"||!Vl.has(a)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new oo(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,i,a){const h=t.values,m=i.values;if(h.length!==m.length)throw new Tr(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${i.toString()}`);const g=[];for(let v=0;v<h.length;v+=2){if(h[v]!==m[v])throw new Tr(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${h[v]}, to[${v}]: ${m[v]}`);g.push(h[v]);const[C,T]=h[v+1],[M,I]=m[v+1];g.push([Zo(C,M,a),Zo(T,I,a)])}return new oo(g)}}class ko{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new ko({name:t,available:!1}):null}}class Ro{constructor(t,i,a){this.from=t,this.to=i,this.transition=a}static interpolate(t,i,a){return new Ro(t,i,a)}static parse(t){return t instanceof Ro?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Ro(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Ro(t.from,t.to,t.transition):typeof t=="string"?new Ro(t,t,1):void 0}}function ba(o,t,i,a){return typeof o=="number"&&o>=0&&o<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[o,t,i,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[o,t,i,a]:[o,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function yi(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof Ro||o instanceof Xt||o instanceof va||o instanceof ho||o instanceof ro||o instanceof oo||o instanceof ko)return!0;if(Array.isArray(o)){for(const t of o)if(!yi(t))return!1;return!0}if(typeof o=="object"){for(const t in o)if(!yi(o[t]))return!1;return!0}return!1}function Vr(o){if(o===null)return Pt;if(typeof o=="string")return dt;if(typeof o=="boolean")return ht;if(typeof o=="number")return Le;if(o instanceof Xt)return Lt;if(o instanceof Ro)return Mt;if(o instanceof va)return pn;if(o instanceof ho)return Nr;if(o instanceof ro)return Wr;if(o instanceof oo)return _a;if(o instanceof ko)return fr;if(Array.isArray(o)){const t=o.length;let i;for(const a of o){const h=Vr(a);if(i){if(i===h)continue;i=xt;break}i=h}return zo(i||xt,t)}return $t}function Ji(o){const t=typeof o;return o===null?"":t==="string"||t==="number"||t==="boolean"?String(o):o instanceof Xt||o instanceof Ro||o instanceof ho||o instanceof ro||o instanceof oo||o instanceof ko?o.toString():JSON.stringify(o)}class si{constructor(t,i){this.type=t,this.value=i}static parse(t,i){if(t.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!yi(t[1]))return i.error("invalid value");const a=t[1];let h=Vr(a);const m=i.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new si(h,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const zs={string:dt,number:Le,boolean:ht,object:$t};class ai{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let a,h=1;const m=t[0];if(m==="array"){let v,C;if(t.length>2){const T=t[1];if(typeof T!="string"||!(T in zs)||T==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);v=zs[T],h++}else v=xt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);C=t[2],h++}a=zo(v,C)}else{if(!zs[m])throw new Error(`Types doesn't contain name = ${m}`);a=zs[m]}const g=[];for(;h<t.length;h++){const v=i.parse(t[h],h,xt);if(!v)return null;g.push(v)}return new ai(a,g)}evaluate(t){for(let i=0;i<this.args.length;i++){const a=this.args[i].evaluate(t);if(!As(this.type,Vr(a)))return a;if(i===this.args.length-1)throw new Tr(`Expected value to be of type ${sr(this.type)}, but found ${sr(Vr(a))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Ul={"to-boolean":ht,"to-color":Lt,"to-number":Le,"to-string":dt};class vi{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const a=t[0];if(!Ul[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&t.length!==2)return i.error("Expected one argument.");const h=Ul[a],m=[];for(let g=1;g<t.length;g++){const v=i.parse(t[g],g,xt);if(!v)return null;m.push(v)}return new vi(h,m)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let i,a;for(const h of this.args){if(i=h.evaluate(t),a=null,i instanceof Xt)return i;if(typeof i=="string"){const m=t.parseColor(i);if(m)return m}else if(Array.isArray(i)&&(a=i.length<3||i.length>4?`Invalid rgba value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:ba(i[0],i[1],i[2],i[3]),!a))return new Xt(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Tr(a||`Could not parse color from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"padding":{let i;for(const a of this.args){i=a.evaluate(t);const h=ro.parse(i);if(h)return h}throw new Tr(`Could not parse padding from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"variableAnchorOffsetCollection":{let i;for(const a of this.args){i=a.evaluate(t);const h=oo.parse(i);if(h)return h}throw new Tr(`Could not parse variableAnchorOffsetCollection from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"number":{let i=null;for(const a of this.args){if(i=a.evaluate(t),i===null)return 0;const h=Number(i);if(!isNaN(h))return h}throw new Tr(`Could not convert ${JSON.stringify(i)} to number.`)}case"formatted":return ho.fromString(Ji(this.args[0].evaluate(t)));case"resolvedImage":return ko.fromString(Ji(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return Ji(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const yr=["Unknown","Point","LineString","Polygon"];class xa{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?yr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let i=this._parseColorCache[t];return i||(i=this._parseColorCache[t]=Xt.parse(t)),i}}class Gt{constructor(t,i,a=[],h,m=new zt,g=[]){this.registry=t,this.path=a,this.key=a.map(v=>`[${v}]`).join(""),this.scope=m,this.errors=g,this.expectedType=h,this._isConstant=i}parse(t,i,a,h,m={}){return i?this.concat(i,a,h)._parse(t,m):this._parse(t,m)}_parse(t,i){function a(h,m,g){return g==="assert"?new ai(m,[h]):g==="coerce"?new vi(m,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let g=m.parse(t,this);if(!g)return null;if(this.expectedType){const v=this.expectedType,C=g.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||C.kind!=="value")if(v.kind!=="projectionDefinition"||C.kind!=="string"&&C.kind!=="array")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string")if(v.kind!=="padding"||C.kind!=="value"&&C.kind!=="number"&&C.kind!=="array")if(v.kind!=="variableAnchorOffsetCollection"||C.kind!=="value"&&C.kind!=="array"){if(this.checkSubtype(v,C))return null}else g=a(g,v,i.typeAnnotation||"coerce");else g=a(g,v,i.typeAnnotation||"coerce");else g=a(g,v,i.typeAnnotation||"coerce");else g=a(g,v,i.typeAnnotation||"coerce");else g=a(g,v,i.typeAnnotation||"assert")}if(!(g instanceof si)&&g.type.kind!=="resolvedImage"&&this._isConstant(g)){const v=new xa;try{g=new si(g.type,g.evaluate(v))}catch(C){return this.error(C.message),null}}return g}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,i,a){const h=typeof t=="number"?this.path.concat(t):this.path,m=a?this.scope.concat(a):this.scope;return new Gt(this.registry,this._isConstant,h,i||null,m,this.errors)}error(t,...i){const a=`${this.key}${i.map(h=>`[${h}]`).join("")}`;this.errors.push(new gt(a,t))}checkSubtype(t,i){const a=As(t,i);return a&&this.error(a),a}}class Dt{constructor(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const i of this.bindings)t(i[1]);t(this.result)}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const a=[];for(let m=1;m<t.length-1;m+=2){const g=t[m];if(typeof g!="string")return i.error(`Expected string, but found ${typeof g} instead.`,m);if(/[^a-zA-Z0-9_]/.test(g))return i.error("Variable names must contain only alphanumeric characters or '_'.",m);const v=i.parse(t[m+1],m+1);if(!v)return null;a.push([g,v])}const h=i.parse(t[t.length-1],t.length-1,i.expectedType,a);return h?new Dt(a,h):null}outputDefined(){return this.result.outputDefined()}}class Xn{constructor(t,i){this.type=i.type,this.name=t,this.boundExpression=i}static parse(t,i){if(t.length!==2||typeof t[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const a=t[1];return i.scope.has(a)?new Xn(a,i.scope.get(a)):i.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Wt{constructor(t,i,a){this.type=t,this.index=i,this.input=a}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const a=i.parse(t[1],1,Le),h=i.parse(t[2],2,zo(i.expectedType||xt));return a&&h?new Wt(h.type.itemType,a,h):null}evaluate(t){const i=this.index.evaluate(t),a=this.input.evaluate(t);if(i<0)throw new Tr(`Array index out of bounds: ${i} < 0.`);if(i>=a.length)throw new Tr(`Array index out of bounds: ${i} > ${a.length-1}.`);if(i!==Math.floor(i))throw new Tr(`Array index must be an integer, but found ${i} instead.`);return a[i]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Rs{constructor(t,i){this.type=ht,this.needle=t,this.haystack=i}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const a=i.parse(t[1],1,xt),h=i.parse(t[2],2,xt);return a&&h?Rl(a.type,[ht,dt,Le,Pt,xt])?new Rs(a,h):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${sr(a.type)} instead`):null}evaluate(t){const i=this.needle.evaluate(t),a=this.haystack.evaluate(t);if(!a)return!1;if(!Yi(i,["boolean","string","number","null"]))throw new Tr(`Expected first argument to be of type boolean, string, number or null, but found ${sr(Vr(i))} instead.`);if(!Yi(a,["string","array"]))throw new Tr(`Expected second argument to be of type array or string, but found ${sr(Vr(a))} instead.`);return a.indexOf(i)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class li{constructor(t,i,a){this.type=Le,this.needle=t,this.haystack=i,this.fromIndex=a}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const a=i.parse(t[1],1,xt),h=i.parse(t[2],2,xt);if(!a||!h)return null;if(!Rl(a.type,[ht,dt,Le,Pt,xt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${sr(a.type)} instead`);if(t.length===4){const m=i.parse(t[3],3,Le);return m?new li(a,h,m):null}return new li(a,h)}evaluate(t){const i=this.needle.evaluate(t),a=this.haystack.evaluate(t);if(!Yi(i,["boolean","string","number","null"]))throw new Tr(`Expected first argument to be of type boolean, string, number or null, but found ${sr(Vr(i))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(t)),Yi(a,["string"])){const m=a.indexOf(i,h);return m===-1?-1:[...a.slice(0,m)].length}if(Yi(a,["array"]))return a.indexOf(i,h);throw new Tr(`Expected second argument to be of type array or string, but found ${sr(Vr(a))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Ds{constructor(t,i,a,h,m,g){this.inputType=t,this.type=i,this.input=a,this.cases=h,this.outputs=m,this.otherwise=g}static parse(t,i){if(t.length<5)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return i.error("Expected an even number of arguments.");let a,h;i.expectedType&&i.expectedType.kind!=="value"&&(h=i.expectedType);const m={},g=[];for(let T=2;T<t.length-1;T+=2){let M=t[T];const I=t[T+1];Array.isArray(M)||(M=[M]);const B=i.concat(T);if(M.length===0)return B.error("Expected at least one branch label.");for(const O of M){if(typeof O!="number"&&typeof O!="string")return B.error("Branch labels must be numbers or strings.");if(typeof O=="number"&&Math.abs(O)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof O=="number"&&Math.floor(O)!==O)return B.error("Numeric branch labels must be integer values.");if(a){if(B.checkSubtype(a,Vr(O)))return null}else a=Vr(O);if(m[String(O)]!==void 0)return B.error("Branch labels must be unique.");m[String(O)]=g.length}const F=i.parse(I,T,h);if(!F)return null;h=h||F.type,g.push(F)}const v=i.parse(t[1],1,xt);if(!v)return null;const C=i.parse(t[t.length-1],t.length-1,h);return C?v.type.kind!=="value"&&i.concat(1).checkSubtype(a,v.type)?null:new Ds(a,h,v,m,g,C):null}evaluate(t){const i=this.input.evaluate(t);return(Vr(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class wa{constructor(t,i,a){this.type=t,this.branches=i,this.otherwise=a}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return i.error("Expected an odd number of arguments.");let a;i.expectedType&&i.expectedType.kind!=="value"&&(a=i.expectedType);const h=[];for(let g=1;g<t.length-1;g+=2){const v=i.parse(t[g],g,ht);if(!v)return null;const C=i.parse(t[g+1],g+1,a);if(!C)return null;h.push([v,C]),a=a||C.type}const m=i.parse(t[t.length-1],t.length-1,a);if(!m)return null;if(!a)throw new Error("Can't infer output type");return new wa(a,h,m)}evaluate(t){for(const[i,a]of this.branches)if(i.evaluate(t))return a.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[i,a]of this.branches)t(i),t(a);t(this.otherwise)}outputDefined(){return this.branches.every(([t,i])=>i.outputDefined())&&this.otherwise.outputDefined()}}class Bs{constructor(t,i,a,h){this.type=t,this.input=i,this.beginIndex=a,this.endIndex=h}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const a=i.parse(t[1],1,xt),h=i.parse(t[2],2,Le);if(!a||!h)return null;if(!Rl(a.type,[zo(xt),dt,xt]))return i.error(`Expected first argument to be of type array or string, but found ${sr(a.type)} instead`);if(t.length===4){const m=i.parse(t[3],3,Le);return m?new Bs(a.type,a,h,m):null}return new Bs(a.type,a,h)}evaluate(t){const i=this.input.evaluate(t),a=this.beginIndex.evaluate(t);let h;if(this.endIndex&&(h=this.endIndex.evaluate(t)),Yi(i,["string"]))return[...i].slice(a,h).join("");if(Yi(i,["array"]))return i.slice(a,h);throw new Tr(`Expected first argument to be of type array or string, but found ${sr(Vr(i))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Kn(o,t){const i=o.length-1;let a,h,m=0,g=i,v=0;for(;m<=g;)if(v=Math.floor((m+g)/2),a=o[v],h=o[v+1],a<=t){if(v===i||t<h)return v;m=v+1}else{if(!(a>t))throw new Tr("Input is not a number.");g=v-1}return 0}class Yn{constructor(t,i,a){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(const[h,m]of a)this.labels.push(h),this.outputs.push(m)}static parse(t,i){if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");const a=i.parse(t[1],1,Le);if(!a)return null;const h=[];let m=null;i.expectedType&&i.expectedType.kind!=="value"&&(m=i.expectedType);for(let g=1;g<t.length;g+=2){const v=g===1?-1/0:t[g],C=t[g+1],T=g,M=g+1;if(typeof v!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(h.length&&h[h.length-1][0]>=v)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const I=i.parse(C,M,m);if(!I)return null;m=m||I.type,h.push([v,I])}return new Yn(m,a,h)}evaluate(t){const i=this.labels,a=this.outputs;if(i.length===1)return a[0].evaluate(t);const h=this.input.evaluate(t);if(h<=i[0])return a[0].evaluate(t);const m=i.length;return h>=i[m-1]?a[m-1].evaluate(t):a[Kn(i,h)].evaluate(t)}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Ud(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Ca,Zl,Ls=function(){if(Zl)return Ca;function o(t,i,a,h){this.cx=3*t,this.bx=3*(a-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(h-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=a,this.p2y=h}return Zl=1,Ca=o,o.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,i){if(i===void 0&&(i=1e-6),t<0)return 0;if(t>1)return 1;for(var a=t,h=0;h<8;h++){var m=this.sampleCurveX(a)-t;if(Math.abs(m)<i)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=m/g}var v=0,C=1;for(a=t,h=0;h<20&&(m=this.sampleCurveX(a),!(Math.abs(m-t)<i));h++)t>m?v=a:C=a,a=.5*(C-v)+v;return a},solve:function(t,i){return this.sampleCurveY(this.solveCurveX(t,i))}},Ca}(),bo=Ud(Ls);class xo{constructor(t,i,a,h,m){this.type=t,this.operator=i,this.interpolation=a,this.input=h,this.labels=[],this.outputs=[];for(const[g,v]of m)this.labels.push(g),this.outputs.push(v)}static interpolationFactor(t,i,a,h){let m=0;if(t.name==="exponential")m=Sa(i,t.base,a,h);else if(t.name==="linear")m=Sa(i,1,a,h);else if(t.name==="cubic-bezier"){const g=t.controlPoints;m=new bo(g[0],g[1],g[2],g[3]).solve(Sa(i,1,a,h))}return m}static parse(t,i){let[a,h,m,...g]=t;if(!Array.isArray(h)||h.length===0)return i.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const T=h[1];if(typeof T!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:T}}else{if(h[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const T=h.slice(1);if(T.length!==4||T.some(M=>typeof M!="number"||M<0||M>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:T}}}if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(m=i.parse(m,2,Le),!m)return null;const v=[];let C=null;a==="interpolate-hcl"||a==="interpolate-lab"?C=Lt:i.expectedType&&i.expectedType.kind!=="value"&&(C=i.expectedType);for(let T=0;T<g.length;T+=2){const M=g[T],I=g[T+1],B=T+3,F=T+4;if(typeof M!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(v.length&&v[v.length-1][0]>=M)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const O=i.parse(I,F,C);if(!O)return null;C=C||O.type,v.push([M,O])}return Gn(C,Le)||Gn(C,Mt)||Gn(C,Lt)||Gn(C,Wr)||Gn(C,_a)||Gn(C,zo(Le))?new xo(C,a,h,m,v):i.error(`Type ${sr(C)} is not interpolatable.`)}evaluate(t){const i=this.labels,a=this.outputs;if(i.length===1)return a[0].evaluate(t);const h=this.input.evaluate(t);if(h<=i[0])return a[0].evaluate(t);const m=i.length;if(h>=i[m-1])return a[m-1].evaluate(t);const g=Kn(i,h),v=xo.interpolationFactor(this.interpolation,h,i[g],i[g+1]),C=a[g].evaluate(t),T=a[g+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Zo(C,T,v);case"color":return Xt.interpolate(C,T,v);case"padding":return ro.interpolate(C,T,v);case"variableAnchorOffsetCollection":return oo.interpolate(C,T,v);case"array":return ii(C,T,v);case"projectionDefinition":return Ro.interpolate(C,T,v)}case"interpolate-hcl":return Xt.interpolate(C,T,v,"hcl");case"interpolate-lab":return Xt.interpolate(C,T,v,"lab")}}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Sa(o,t,i,a){const h=a-i,m=o-i;return h===0?0:t===1?m/h:(Math.pow(t,m)-1)/(Math.pow(t,h)-1)}const Go={color:Xt.interpolate,number:Zo,padding:ro.interpolate,variableAnchorOffsetCollection:oo.interpolate,array:ii};class Fr{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let a=null;const h=i.expectedType;h&&h.kind!=="value"&&(a=h);const m=[];for(const v of t.slice(1)){const C=i.parse(v,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!C)return null;a=a||C.type,m.push(C)}if(!a)throw new Error("No output type");const g=h&&m.some(v=>As(h,v.type));return new Fr(g?xt:a,m)}evaluate(t){let i,a=null,h=0;for(const m of this.args)if(h++,a=m.evaluate(t),a&&a instanceof ko&&!a.available&&(i||(i=a.name),a=null,h===this.args.length&&(a=i)),a!==null)break;return a}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Gl(o,t){return o==="=="||o==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Ta(o,t,i,a){return a.compare(t,i)===0}function gn(o,t,i){const a=o!=="=="&&o!=="!=";return class Y0{constructor(m,g,v){this.type=ht,this.lhs=m,this.rhs=g,this.collator=v,this.hasUntypedArgument=m.type.kind==="value"||g.type.kind==="value"}static parse(m,g){if(m.length!==3&&m.length!==4)return g.error("Expected two or three arguments.");const v=m[0];let C=g.parse(m[1],1,xt);if(!C)return null;if(!Gl(v,C.type))return g.concat(1).error(`"${v}" comparisons are not supported for type '${sr(C.type)}'.`);let T=g.parse(m[2],2,xt);if(!T)return null;if(!Gl(v,T.type))return g.concat(2).error(`"${v}" comparisons are not supported for type '${sr(T.type)}'.`);if(C.type.kind!==T.type.kind&&C.type.kind!=="value"&&T.type.kind!=="value")return g.error(`Cannot compare types '${sr(C.type)}' and '${sr(T.type)}'.`);a&&(C.type.kind==="value"&&T.type.kind!=="value"?C=new ai(T.type,[C]):C.type.kind!=="value"&&T.type.kind==="value"&&(T=new ai(C.type,[T])));let M=null;if(m.length===4){if(C.type.kind!=="string"&&T.type.kind!=="string"&&C.type.kind!=="value"&&T.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(M=g.parse(m[3],3,pn),!M)return null}return new Y0(C,T,M)}evaluate(m){const g=this.lhs.evaluate(m),v=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const C=Vr(g),T=Vr(v);if(C.kind!==T.kind||C.kind!=="string"&&C.kind!=="number")throw new Tr(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${C.kind}, ${T.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const C=Vr(g),T=Vr(v);if(C.kind!=="string"||T.kind!=="string")return t(m,g,v)}return this.collator?i(m,g,v,this.collator.evaluate(m)):t(m,g,v)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const Zd=gn("==",function(o,t,i){return t===i},Ta),ka=gn("!=",function(o,t,i){return t!==i},function(o,t,i,a){return!Ta(0,t,i,a)}),ql=gn("<",function(o,t,i){return t<i},function(o,t,i,a){return a.compare(t,i)<0}),Gd=gn(">",function(o,t,i){return t>i},function(o,t,i,a){return a.compare(t,i)>0}),Pa=gn("<=",function(o,t,i){return t<=i},function(o,t,i,a){return a.compare(t,i)<=0}),Ma=gn(">=",function(o,t,i){return t>=i},function(o,t,i,a){return a.compare(t,i)>=0});class Do{constructor(t,i,a){this.type=pn,this.locale=a,this.caseSensitive=t,this.diacriticSensitive=i}static parse(t,i){if(t.length!==2)return i.error("Expected one argument.");const a=t[1];if(typeof a!="object"||Array.isArray(a))return i.error("Collator options argument must be an object.");const h=i.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,ht);if(!h)return null;const m=i.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,ht);if(!m)return null;let g=null;return a.locale&&(g=i.parse(a.locale,1,dt),!g)?null:new Do(h,m,g)}evaluate(t){return new va(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Ia{constructor(t,i,a,h,m){this.type=dt,this.number=t,this.locale=i,this.currency=a,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(t,i){if(t.length!==3)return i.error("Expected two arguments.");const a=i.parse(t[1],1,Le);if(!a)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return i.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=i.parse(h.locale,1,dt),!m))return null;let g=null;if(h.currency&&(g=i.parse(h.currency,1,dt),!g))return null;let v=null;if(h["min-fraction-digits"]&&(v=i.parse(h["min-fraction-digits"],1,Le),!v))return null;let C=null;return h["max-fraction-digits"]&&(C=i.parse(h["max-fraction-digits"],1,Le),!C)?null:new Ia(a,m,g,v,C)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class _n{constructor(t){this.type=Nr,this.sections=t}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const a=t[1];if(!Array.isArray(a)&&typeof a=="object")return i.error("First argument must be an image or text section.");const h=[];let m=!1;for(let g=1;g<=t.length-1;++g){const v=t[g];if(m&&typeof v=="object"&&!Array.isArray(v)){m=!1;let C=null;if(v["font-scale"]&&(C=i.parse(v["font-scale"],1,Le),!C))return null;let T=null;if(v["text-font"]&&(T=i.parse(v["text-font"],1,zo(dt)),!T))return null;let M=null;if(v["text-color"]&&(M=i.parse(v["text-color"],1,Lt),!M))return null;let I=null;if(v["vertical-align"]){if(typeof v["vertical-align"]=="string"&&!Nl.includes(v["vertical-align"]))return i.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${v["vertical-align"]}' instead.`);if(I=i.parse(v["vertical-align"],1,dt),!I)return null}const B=h[h.length-1];B.scale=C,B.font=T,B.textColor=M,B.verticalAlign=I}else{const C=i.parse(t[g],1,xt);if(!C)return null;const T=C.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:C,scale:null,font:null,textColor:null,verticalAlign:null})}}return new _n(h)}evaluate(t){return new ho(this.sections.map(i=>{const a=i.content.evaluate(t);return Vr(a)===fr?new ni("",a,null,null,null,i.verticalAlign?i.verticalAlign.evaluate(t):null):new ni(Ji(a),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null,i.verticalAlign?i.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const i of this.sections)t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor),i.verticalAlign&&t(i.verticalAlign)}outputDefined(){return!1}}class Wl{constructor(t){this.type=fr,this.input=t}static parse(t,i){if(t.length!==2)return i.error("Expected two arguments.");const a=i.parse(t[1],1,dt);return a?new Wl(a):i.error("No image name provided.")}evaluate(t){const i=this.input.evaluate(t),a=ko.fromString(i);return a&&t.availableImages&&(a.available=t.availableImages.indexOf(i)>-1),a}eachChild(t){t(this.input)}outputDefined(){return!1}}class Fs{constructor(t){this.type=Le,this.input=t}static parse(t,i){if(t.length!==2)return i.error(`Expected 1 argument, but found ${t.length-1} instead.`);const a=i.parse(t[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${sr(a.type)} instead.`):new Fs(a):null}evaluate(t){const i=this.input.evaluate(t);if(typeof i=="string")return[...i].length;if(Array.isArray(i))return i.length;throw new Tr(`Expected value to be of type string or array, but found ${sr(Vr(i))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Mi=8192;function qd(o,t){const i=(180+o[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(i*h*Mi),Math.round(a*h*Mi)]}function Hl(o,t){const i=Math.pow(2,t.z);return[(h=(o[0]/Mi+t.x)/i,360*h-180),(a=(o[1]/Mi+t.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90)];var a,h}function Os(o,t){o[0]=Math.min(o[0],t[0]),o[1]=Math.min(o[1],t[1]),o[2]=Math.max(o[2],t[0]),o[3]=Math.max(o[3],t[1])}function Qi(o,t){return!(o[0]<=t[0]||o[2]>=t[2]||o[1]<=t[1]||o[3]>=t[3])}function Wd(o,t,i){const a=o[0]-t[0],h=o[1]-t[1],m=o[0]-i[0],g=o[1]-i[1];return a*g-m*h==0&&a*m<=0&&h*g<=0}function $s(o,t,i,a){return(h=[a[0]-i[0],a[1]-i[1]])[0]*(m=[t[0]-o[0],t[1]-o[1]])[1]-h[1]*m[0]!=0&&!(!Gu(o,t,i,a)||!Gu(i,a,o,t));var h,m}function Vu(o,t,i){for(const a of i)for(let h=0;h<a.length-1;++h)if($s(o,t,a[h],a[h+1]))return!0;return!1}function Jn(o,t,i=!1){let a=!1;for(const v of t)for(let C=0;C<v.length-1;C++){if(Wd(o,v[C],v[C+1]))return i;(m=v[C])[1]>(h=o)[1]!=(g=v[C+1])[1]>h[1]&&h[0]<(g[0]-m[0])*(h[1]-m[1])/(g[1]-m[1])+m[0]&&(a=!a)}var h,m,g;return a}function Uu(o,t){for(const i of t)if(Jn(o,i))return!0;return!1}function Zu(o,t){for(const i of o)if(!Jn(i,t))return!1;for(let i=0;i<o.length-1;++i)if(Vu(o[i],o[i+1],t))return!1;return!0}function Hd(o,t){for(const i of t)if(Zu(o,i))return!0;return!1}function Gu(o,t,i,a){const h=a[0]-i[0],m=a[1]-i[1],g=(o[0]-i[0])*m-h*(o[1]-i[1]),v=(t[0]-i[0])*m-h*(t[1]-i[1]);return g>0&&v<0||g<0&&v>0}function Xl(o,t,i){const a=[];for(let h=0;h<o.length;h++){const m=[];for(let g=0;g<o[h].length;g++){const v=qd(o[h][g],i);Os(t,v),m.push(v)}a.push(m)}return a}function qu(o,t,i){const a=[];for(let h=0;h<o.length;h++){const m=Xl(o[h],t,i);a.push(m)}return a}function Kl(o,t,i,a){if(o[0]<i[0]||o[0]>i[2]){const h=.5*a;let m=o[0]-i[0]>h?-a:i[0]-o[0]>h?a:0;m===0&&(m=o[0]-i[2]>h?-a:i[2]-o[0]>h?a:0),o[0]+=m}Os(t,o)}function Yl(o,t,i,a){const h=Math.pow(2,a.z)*Mi,m=[a.x*Mi,a.y*Mi],g=[];for(const v of o)for(const C of v){const T=[C.x+m[0],C.y+m[1]];Kl(T,t,i,h),g.push(T)}return g}function Jl(o,t,i,a){const h=Math.pow(2,a.z)*Mi,m=[a.x*Mi,a.y*Mi],g=[];for(const C of o){const T=[];for(const M of C){const I=[M.x+m[0],M.y+m[1]];Os(t,I),T.push(I)}g.push(T)}if(t[2]-t[0]<=h/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const C of g)for(const T of C)Kl(T,t,i,h)}var v;return g}class yn{constructor(t,i){this.type=ht,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(yi(t[1])){const a=t[1];if(a.type==="FeatureCollection"){const h=[];for(const m of a.features){const{type:g,coordinates:v}=m.geometry;g==="Polygon"&&h.push(v),g==="MultiPolygon"&&h.push(...v)}if(h.length)return new yn(a,{type:"MultiPolygon",coordinates:h})}else if(a.type==="Feature"){const h=a.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new yn(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new yn(a,a)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(a.type==="Polygon"){const v=Xl(a.coordinates,m,g),C=Yl(i.geometry(),h,m,g);if(!Qi(h,m))return!1;for(const T of C)if(!Jn(T,v))return!1}if(a.type==="MultiPolygon"){const v=qu(a.coordinates,m,g),C=Yl(i.geometry(),h,m,g);if(!Qi(h,m))return!1;for(const T of C)if(!Uu(T,v))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(a.type==="Polygon"){const v=Xl(a.coordinates,m,g),C=Jl(i.geometry(),h,m,g);if(!Qi(h,m))return!1;for(const T of C)if(!Zu(T,v))return!1}if(a.type==="MultiPolygon"){const v=qu(a.coordinates,m,g),C=Jl(i.geometry(),h,m,g);if(!Qi(h,m))return!1;for(const T of C)if(!Hd(T,v))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Wu=class{constructor(o=[],t=(i,a)=>i<a?-1:i>a?1:0){if(this.data=o,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:t,compare:i}=this,a=t[o];for(;o>0;){const h=o-1>>1,m=t[h];if(i(a,m)>=0)break;t[o]=m,o=h}t[o]=a}_down(o){const{data:t,compare:i}=this,a=this.length>>1,h=t[o];for(;o<a;){let m=1+(o<<1);const g=m+1;if(g<this.length&&i(t[g],t[m])<0&&(m=g),i(t[m],h)>=0)break;t[o]=t[m],o=m}t[o]=h}};function Hu(o,t,i=0,a=o.length-1,h=Xd){for(;a>i;){if(a-i>600){const C=a-i+1,T=t-i+1,M=Math.log(C),I=.5*Math.exp(2*M/3),B=.5*Math.sqrt(M*I*(C-I)/C)*(T-C/2<0?-1:1);Hu(o,t,Math.max(i,Math.floor(t-T*I/C+B)),Math.min(a,Math.floor(t+(C-T)*I/C+B)),h)}const m=o[t];let g=i,v=a;for(vn(o,i,t),h(o[a],m)>0&&vn(o,i,a);g<v;){for(vn(o,g,v),g++,v--;h(o[g],m)<0;)g++;for(;h(o[v],m)>0;)v--}h(o[i],m)===0?vn(o,i,v):(v++,vn(o,v,a)),v<=t&&(i=v+1),t<=v&&(a=v-1)}}function vn(o,t,i){const a=o[t];o[t]=o[i],o[i]=a}function Xd(o,t){return o<t?-1:o>t?1:0}function Ea(o,t){if(o.length<=1)return[o];const i=[];let a,h;for(const m of o){const g=Xu(m);g!==0&&(m.area=Math.abs(g),h===void 0&&(h=g<0),h===g<0?(a&&i.push(a),a=[m]):a.push(m))}if(a&&i.push(a),t>1)for(let m=0;m<i.length;m++)i[m].length<=t||(Hu(i[m],t,1,i[m].length-1,Kd),i[m]=i[m].slice(0,t));return i}function Kd(o,t){return t.area-o.area}function Xu(o){let t=0;for(let i,a,h=0,m=o.length,g=m-1;h<m;g=h++)i=o[h],a=o[g],t+=(a.x-i.x)*(i.y+a.y);return t}const Ql=1/298.257223563,Ku=Ql*(2-Ql),Yu=Math.PI/180;class Aa{constructor(t){const i=6378.137*Yu*1e3,a=Math.cos(t*Yu),h=1/(1-Ku*(1-a*a)),m=Math.sqrt(h);this.kx=i*m*a,this.ky=i*m*h*(1-Ku)}distance(t,i){const a=this.wrap(t[0]-i[0])*this.kx,h=(t[1]-i[1])*this.ky;return Math.sqrt(a*a+h*h)}pointOnLine(t,i){let a,h,m,g,v=1/0;for(let C=0;C<t.length-1;C++){let T=t[C][0],M=t[C][1],I=this.wrap(t[C+1][0]-T)*this.kx,B=(t[C+1][1]-M)*this.ky,F=0;I===0&&B===0||(F=(this.wrap(i[0]-T)*this.kx*I+(i[1]-M)*this.ky*B)/(I*I+B*B),F>1?(T=t[C+1][0],M=t[C+1][1]):F>0&&(T+=I/this.kx*F,M+=B/this.ky*F)),I=this.wrap(i[0]-T)*this.kx,B=(i[1]-M)*this.ky;const O=I*I+B*B;O<v&&(v=O,a=T,h=M,m=C,g=F)}return{point:[a,h],index:m,t:Math.max(0,Math.min(1,g))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function ec(o,t){return t[0]-o[0]}function za(o){return o[1]-o[0]+1}function $i(o,t){return o[1]>=o[0]&&o[1]<t}function tc(o,t){if(o[0]>o[1])return[null,null];const i=za(o);if(t){if(i===2)return[o,null];const h=Math.floor(i/2);return[[o[0],o[0]+h],[o[0]+h,o[1]]]}if(i===1)return[o,null];const a=Math.floor(i/2)-1;return[[o[0],o[0]+a],[o[0]+a+1,o[1]]]}function Ra(o,t){if(!$i(t,o.length))return[1/0,1/0,-1/0,-1/0];const i=[1/0,1/0,-1/0,-1/0];for(let a=t[0];a<=t[1];++a)Os(i,o[a]);return i}function rc(o){const t=[1/0,1/0,-1/0,-1/0];for(const i of o)for(const a of i)Os(t,a);return t}function Ju(o){return o[0]!==-1/0&&o[1]!==-1/0&&o[2]!==1/0&&o[3]!==1/0}function oc(o,t,i){if(!Ju(o)||!Ju(t))return NaN;let a=0,h=0;return o[2]<t[0]&&(a=t[0]-o[2]),o[0]>t[2]&&(a=o[0]-t[2]),o[1]>t[3]&&(h=o[1]-t[3]),o[3]<t[1]&&(h=t[1]-o[3]),i.distance([0,0],[a,h])}function bn(o,t,i){const a=i.pointOnLine(t,o);return i.distance(o,a.point)}function Yt(o,t,i,a,h){const m=Math.min(bn(o,[i,a],h),bn(t,[i,a],h)),g=Math.min(bn(i,[o,t],h),bn(a,[o,t],h));return Math.min(m,g)}function Yd(o,t,i,a,h){if(!$i(t,o.length)||!$i(a,i.length))return 1/0;let m=1/0;for(let g=t[0];g<t[1];++g){const v=o[g],C=o[g+1];for(let T=a[0];T<a[1];++T){const M=i[T],I=i[T+1];if($s(v,C,M,I))return 0;m=Math.min(m,Yt(v,C,M,I,h))}}return m}function Jd(o,t,i,a,h){if(!$i(t,o.length)||!$i(a,i.length))return NaN;let m=1/0;for(let g=t[0];g<=t[1];++g)for(let v=a[0];v<=a[1];++v)if(m=Math.min(m,h.distance(o[g],i[v])),m===0)return m;return m}function Qd(o,t,i){if(Jn(o,t,!0))return 0;let a=1/0;for(const h of t){const m=h[0],g=h[h.length-1];if(m!==g&&(a=Math.min(a,bn(o,[g,m],i)),a===0))return a;const v=i.pointOnLine(h,o);if(a=Math.min(a,i.distance(o,v.point)),a===0)return a}return a}function ef(o,t,i,a){if(!$i(t,o.length))return NaN;for(let m=t[0];m<=t[1];++m)if(Jn(o[m],i,!0))return 0;let h=1/0;for(let m=t[0];m<t[1];++m){const g=o[m],v=o[m+1];for(const C of i)for(let T=0,M=C.length,I=M-1;T<M;I=T++){const B=C[I],F=C[T];if($s(g,v,B,F))return 0;h=Math.min(h,Yt(g,v,B,F,a))}}return h}function Qu(o,t){for(const i of o)for(const a of i)if(Jn(a,t,!0))return!0;return!1}function tf(o,t,i,a=1/0){const h=rc(o),m=rc(t);if(a!==1/0&&oc(h,m,i)>=a)return a;if(Qi(h,m)){if(Qu(o,t))return 0}else if(Qu(t,o))return 0;let g=1/0;for(const v of o)for(let C=0,T=v.length,M=T-1;C<T;M=C++){const I=v[M],B=v[C];for(const F of t)for(let O=0,j=F.length,W=j-1;O<j;W=O++){const ee=F[W],he=F[O];if($s(I,B,ee,he))return 0;g=Math.min(g,Yt(I,B,ee,he,i))}}return g}function eh(o,t,i,a,h,m){if(!m)return;const g=oc(Ra(a,m),h,i);g<t&&o.push([g,m,[0,0]])}function Da(o,t,i,a,h,m,g){if(!m||!g)return;const v=oc(Ra(a,m),Ra(h,g),i);v<t&&o.push([v,m,g])}function Ba(o,t,i,a,h=1/0){let m=Math.min(a.distance(o[0],i[0][0]),h);if(m===0)return m;const g=new Wu([[0,[0,o.length-1],[0,0]]],ec),v=rc(i);for(;g.length>0;){const C=g.pop();if(C[0]>=m)continue;const T=C[1],M=t?50:100;if(za(T)<=M){if(!$i(T,o.length))return NaN;if(t){const I=ef(o,T,i,a);if(isNaN(I)||I===0)return I;m=Math.min(m,I)}else for(let I=T[0];I<=T[1];++I){const B=Qd(o[I],i,a);if(m=Math.min(m,B),m===0)return 0}}else{const I=tc(T,t);eh(g,m,a,o,v,I[0]),eh(g,m,a,o,v,I[1])}}return m}function La(o,t,i,a,h,m=1/0){let g=Math.min(m,h.distance(o[0],i[0]));if(g===0)return g;const v=new Wu([[0,[0,o.length-1],[0,i.length-1]]],ec);for(;v.length>0;){const C=v.pop();if(C[0]>=g)continue;const T=C[1],M=C[2],I=t?50:100,B=a?50:100;if(za(T)<=I&&za(M)<=B){if(!$i(T,o.length)&&$i(M,i.length))return NaN;let F;if(t&&a)F=Yd(o,T,i,M,h),g=Math.min(g,F);else if(t&&!a){const O=o.slice(T[0],T[1]+1);for(let j=M[0];j<=M[1];++j)if(F=bn(i[j],O,h),g=Math.min(g,F),g===0)return g}else if(!t&&a){const O=i.slice(M[0],M[1]+1);for(let j=T[0];j<=T[1];++j)if(F=bn(o[j],O,h),g=Math.min(g,F),g===0)return g}else F=Jd(o,T,i,M,h),g=Math.min(g,F)}else{const F=tc(T,t),O=tc(M,a);Da(v,g,h,o,i,F[0],O[0]),Da(v,g,h,o,i,F[0],O[1]),Da(v,g,h,o,i,F[1],O[0]),Da(v,g,h,o,i,F[1],O[1])}}return g}function ic(o){return o.type==="MultiPolygon"?o.coordinates.map(t=>({type:"Polygon",coordinates:t})):o.type==="MultiLineString"?o.coordinates.map(t=>({type:"LineString",coordinates:t})):o.type==="MultiPoint"?o.coordinates.map(t=>({type:"Point",coordinates:t})):[o]}class xn{constructor(t,i){this.type=Le,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(yi(t[1])){const a=t[1];if(a.type==="FeatureCollection")return new xn(a,a.features.map(h=>ic(h.geometry)).flat());if(a.type==="Feature")return new xn(a,ic(a.geometry));if("type"in a&&"coordinates"in a)return new xn(a,ic(a))}return i.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,a){const h=i.geometry(),m=h.flat().map(C=>Hl([C.x,C.y],i.canonical));if(h.length===0)return NaN;const g=new Aa(m[0][1]);let v=1/0;for(const C of a){switch(C.type){case"Point":v=Math.min(v,La(m,!1,[C.coordinates],!1,g,v));break;case"LineString":v=Math.min(v,La(m,!1,C.coordinates,!0,g,v));break;case"Polygon":v=Math.min(v,Ba(m,!1,C.coordinates,g,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,a){const h=i.geometry(),m=h.flat().map(C=>Hl([C.x,C.y],i.canonical));if(h.length===0)return NaN;const g=new Aa(m[0][1]);let v=1/0;for(const C of a){switch(C.type){case"Point":v=Math.min(v,La(m,!0,[C.coordinates],!1,g,v));break;case"LineString":v=Math.min(v,La(m,!0,C.coordinates,!0,g,v));break;case"Polygon":v=Math.min(v,Ba(m,!0,C.coordinates,g,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="Polygon")return function(i,a){const h=i.geometry();if(h.length===0||h[0].length===0)return NaN;const m=Ea(h,0).map(C=>C.map(T=>T.map(M=>Hl([M.x,M.y],i.canonical)))),g=new Aa(m[0][0][0][1]);let v=1/0;for(const C of a)for(const T of m){switch(C.type){case"Point":v=Math.min(v,Ba([C.coordinates],!1,T,g,v));break;case"LineString":v=Math.min(v,Ba(C.coordinates,!0,T,g,v));break;case"Polygon":v=Math.min(v,tf(T,C.coordinates,g,v))}if(v===0)return v}return v}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Qn={"==":Zd,"!=":ka,">":Gd,"<":ql,">=":Ma,"<=":Pa,array:ai,at:Wt,boolean:ai,case:wa,coalesce:Fr,collator:Do,format:_n,image:Wl,in:Rs,"index-of":li,interpolate:xo,"interpolate-hcl":xo,"interpolate-lab":xo,length:Fs,let:Dt,literal:si,match:Ds,number:ai,"number-format":Ia,object:ai,slice:Bs,step:Yn,string:ai,"to-boolean":vi,"to-color":vi,"to-number":vi,"to-string":vi,var:Xn,within:yn,distance:xn};class ci{constructor(t,i,a,h){this.name=t,this.type=i,this._evaluate=a,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,i){const a=t[0],h=ci.definitions[a];if(!h)return i.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,g=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=g.filter(([T])=>!Array.isArray(T)||T.length===t.length-1);let C=null;for(const[T,M]of v){C=new Gt(i.registry,Fa,i.path,null,i.scope);const I=[];let B=!1;for(let F=1;F<t.length;F++){const O=t[F],j=Array.isArray(T)?T[F-1]:T.type,W=C.parse(O,1+I.length,j);if(!W){B=!0;break}I.push(W)}if(!B)if(Array.isArray(T)&&T.length!==I.length)C.error(`Expected ${T.length} arguments, but found ${I.length} instead.`);else{for(let F=0;F<I.length;F++){const O=Array.isArray(T)?T[F]:T.type,j=I[F];C.concat(F+1).checkSubtype(O,j.type)}if(C.errors.length===0)return new ci(a,m,M,I)}}if(v.length===1)i.errors.push(...C.errors);else{const T=(v.length?v:g).map(([I])=>{return B=I,Array.isArray(B)?`(${B.map(sr).join(", ")})`:`(${sr(B.type)}...)`;var B}).join(" | "),M=[];for(let I=1;I<t.length;I++){const B=i.parse(t[I],1+M.length);if(!B)return null;M.push(sr(B.type))}i.error(`Expected arguments of type ${T}, but found (${M.join(", ")}) instead.`)}return null}static register(t,i){ci.definitions=i;for(const a in i)t[a]=ci}}function th(o,[t,i,a,h]){t=t.evaluate(o),i=i.evaluate(o),a=a.evaluate(o);const m=h?h.evaluate(o):1,g=ba(t,i,a,m);if(g)throw new Tr(g);return new Xt(t/255,i/255,a/255,m,!1)}function rh(o,t){return o in t}function nc(o,t){const i=t[o];return i===void 0?null:i}function wn(o){return{type:o}}function Fa(o){if(o instanceof Xn)return Fa(o.boundExpression);if(o instanceof ci&&o.name==="error"||o instanceof Do||o instanceof yn||o instanceof xn)return!1;const t=o instanceof vi||o instanceof ai;let i=!0;return o.eachChild(a=>{i=t?i&&Fa(a):i&&a instanceof si}),!!i&&Oa(o)&&$a(o,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Oa(o){if(o instanceof ci&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof yn||o instanceof xn)return!1;let t=!0;return o.eachChild(i=>{t&&!Oa(i)&&(t=!1)}),t}function js(o){if(o instanceof ci&&o.name==="feature-state")return!1;let t=!0;return o.eachChild(i=>{t&&!js(i)&&(t=!1)}),t}function $a(o,t){if(o instanceof ci&&t.indexOf(o.name)>=0)return!1;let i=!0;return o.eachChild(a=>{i&&!$a(a,t)&&(i=!1)}),i}function oh(o){return{result:"success",value:o}}function es(o){return{result:"error",value:o}}function ts(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function ih(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function sc(o){return!!o.expression&&o.expression.interpolated}function Kt(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function ja(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)}function rf(o){return o}function nh(o,t){const i=t.type==="color",a=o.stops&&typeof o.stops[0][0]=="object",h=a||!(a||o.property!==void 0),m=o.type||(sc(t)?"exponential":"interval");if(i||t.type==="padding"){const M=i?Xt.parse:ro.parse;(o=Qe({},o)).stops&&(o.stops=o.stops.map(I=>[I[0],M(I[1])])),o.default=M(o.default?o.default:t.default)}if(o.colorSpace&&(g=o.colorSpace)!=="rgb"&&g!=="hcl"&&g!=="lab")throw new Error(`Unknown color space: "${o.colorSpace}"`);var g;let v,C,T;if(m==="exponential")v=sh;else if(m==="interval")v=nf;else if(m==="categorical"){v=of,C=Object.create(null);for(const M of o.stops)C[M[0]]=M[1];T=typeof o.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);v=ah}if(a){const M={},I=[];for(let O=0;O<o.stops.length;O++){const j=o.stops[O],W=j[0].zoom;M[W]===void 0&&(M[W]={zoom:W,type:o.type,property:o.property,default:o.default,stops:[]},I.push(W)),M[W].stops.push([j[0].value,j[1]])}const B=[];for(const O of I)B.push([M[O].zoom,nh(M[O],t)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:xo.interpolationFactor.bind(void 0,F),zoomStops:B.map(O=>O[0]),evaluate:({zoom:O},j)=>sh({stops:B,base:o.base},t,O).evaluate(O,j)}}if(h){const M=m==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:xo.interpolationFactor.bind(void 0,M),zoomStops:o.stops.map(I=>I[0]),evaluate:({zoom:I})=>v(o,t,I,C,T)}}return{kind:"source",evaluate(M,I){const B=I&&I.properties?I.properties[o.property]:void 0;return B===void 0?Cn(o.default,t.default):v(o,t,B,C,T)}}}function Cn(o,t,i){return o!==void 0?o:t!==void 0?t:i!==void 0?i:void 0}function of(o,t,i,a,h){return Cn(typeof i===h?a[i]:void 0,o.default,t.default)}function nf(o,t,i){if(Kt(i)!=="number")return Cn(o.default,t.default);const a=o.stops.length;if(a===1||i<=o.stops[0][0])return o.stops[0][1];if(i>=o.stops[a-1][0])return o.stops[a-1][1];const h=Kn(o.stops.map(m=>m[0]),i);return o.stops[h][1]}function sh(o,t,i){const a=o.base!==void 0?o.base:1;if(Kt(i)!=="number")return Cn(o.default,t.default);const h=o.stops.length;if(h===1||i<=o.stops[0][0])return o.stops[0][1];if(i>=o.stops[h-1][0])return o.stops[h-1][1];const m=Kn(o.stops.map(M=>M[0]),i),g=function(M,I,B,F){const O=F-B,j=M-B;return O===0?0:I===1?j/O:(Math.pow(I,j)-1)/(Math.pow(I,O)-1)}(i,a,o.stops[m][0],o.stops[m+1][0]),v=o.stops[m][1],C=o.stops[m+1][1],T=Go[t.type]||rf;return typeof v.evaluate=="function"?{evaluate(...M){const I=v.evaluate.apply(void 0,M),B=C.evaluate.apply(void 0,M);if(I!==void 0&&B!==void 0)return T(I,B,g,o.colorSpace)}}:T(v,C,g,o.colorSpace)}function ah(o,t,i){switch(t.type){case"color":i=Xt.parse(i);break;case"formatted":i=ho.fromString(i.toString());break;case"resolvedImage":i=ko.fromString(i.toString());break;case"padding":i=ro.parse(i);break;default:Kt(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0)}return Cn(i,o.default,t.default)}ci.register(Qn,{error:[{kind:"error"},[dt],(o,[t])=>{throw new Tr(t.evaluate(o))}],typeof:[dt,[xt],(o,[t])=>sr(Vr(t.evaluate(o)))],"to-rgba":[zo(Le,4),[Lt],(o,[t])=>{const[i,a,h,m]=t.evaluate(o).rgb;return[255*i,255*a,255*h,m]}],rgb:[Lt,[Le,Le,Le],th],rgba:[Lt,[Le,Le,Le,Le],th],has:{type:ht,overloads:[[[dt],(o,[t])=>rh(t.evaluate(o),o.properties())],[[dt,$t],(o,[t,i])=>rh(t.evaluate(o),i.evaluate(o))]]},get:{type:xt,overloads:[[[dt],(o,[t])=>nc(t.evaluate(o),o.properties())],[[dt,$t],(o,[t,i])=>nc(t.evaluate(o),i.evaluate(o))]]},"feature-state":[xt,[dt],(o,[t])=>nc(t.evaluate(o),o.featureState||{})],properties:[$t,[],o=>o.properties()],"geometry-type":[dt,[],o=>o.geometryType()],id:[xt,[],o=>o.id()],zoom:[Le,[],o=>o.globals.zoom],"heatmap-density":[Le,[],o=>o.globals.heatmapDensity||0],"line-progress":[Le,[],o=>o.globals.lineProgress||0],accumulated:[xt,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[Le,wn(Le),(o,t)=>{let i=0;for(const a of t)i+=a.evaluate(o);return i}],"*":[Le,wn(Le),(o,t)=>{let i=1;for(const a of t)i*=a.evaluate(o);return i}],"-":{type:Le,overloads:[[[Le,Le],(o,[t,i])=>t.evaluate(o)-i.evaluate(o)],[[Le],(o,[t])=>-t.evaluate(o)]]},"/":[Le,[Le,Le],(o,[t,i])=>t.evaluate(o)/i.evaluate(o)],"%":[Le,[Le,Le],(o,[t,i])=>t.evaluate(o)%i.evaluate(o)],ln2:[Le,[],()=>Math.LN2],pi:[Le,[],()=>Math.PI],e:[Le,[],()=>Math.E],"^":[Le,[Le,Le],(o,[t,i])=>Math.pow(t.evaluate(o),i.evaluate(o))],sqrt:[Le,[Le],(o,[t])=>Math.sqrt(t.evaluate(o))],log10:[Le,[Le],(o,[t])=>Math.log(t.evaluate(o))/Math.LN10],ln:[Le,[Le],(o,[t])=>Math.log(t.evaluate(o))],log2:[Le,[Le],(o,[t])=>Math.log(t.evaluate(o))/Math.LN2],sin:[Le,[Le],(o,[t])=>Math.sin(t.evaluate(o))],cos:[Le,[Le],(o,[t])=>Math.cos(t.evaluate(o))],tan:[Le,[Le],(o,[t])=>Math.tan(t.evaluate(o))],asin:[Le,[Le],(o,[t])=>Math.asin(t.evaluate(o))],acos:[Le,[Le],(o,[t])=>Math.acos(t.evaluate(o))],atan:[Le,[Le],(o,[t])=>Math.atan(t.evaluate(o))],min:[Le,wn(Le),(o,t)=>Math.min(...t.map(i=>i.evaluate(o)))],max:[Le,wn(Le),(o,t)=>Math.max(...t.map(i=>i.evaluate(o)))],abs:[Le,[Le],(o,[t])=>Math.abs(t.evaluate(o))],round:[Le,[Le],(o,[t])=>{const i=t.evaluate(o);return i<0?-Math.round(-i):Math.round(i)}],floor:[Le,[Le],(o,[t])=>Math.floor(t.evaluate(o))],ceil:[Le,[Le],(o,[t])=>Math.ceil(t.evaluate(o))],"filter-==":[ht,[dt,xt],(o,[t,i])=>o.properties()[t.value]===i.value],"filter-id-==":[ht,[xt],(o,[t])=>o.id()===t.value],"filter-type-==":[ht,[dt],(o,[t])=>o.geometryType()===t.value],"filter-<":[ht,[dt,xt],(o,[t,i])=>{const a=o.properties()[t.value],h=i.value;return typeof a==typeof h&&a<h}],"filter-id-<":[ht,[xt],(o,[t])=>{const i=o.id(),a=t.value;return typeof i==typeof a&&i<a}],"filter->":[ht,[dt,xt],(o,[t,i])=>{const a=o.properties()[t.value],h=i.value;return typeof a==typeof h&&a>h}],"filter-id->":[ht,[xt],(o,[t])=>{const i=o.id(),a=t.value;return typeof i==typeof a&&i>a}],"filter-<=":[ht,[dt,xt],(o,[t,i])=>{const a=o.properties()[t.value],h=i.value;return typeof a==typeof h&&a<=h}],"filter-id-<=":[ht,[xt],(o,[t])=>{const i=o.id(),a=t.value;return typeof i==typeof a&&i<=a}],"filter->=":[ht,[dt,xt],(o,[t,i])=>{const a=o.properties()[t.value],h=i.value;return typeof a==typeof h&&a>=h}],"filter-id->=":[ht,[xt],(o,[t])=>{const i=o.id(),a=t.value;return typeof i==typeof a&&i>=a}],"filter-has":[ht,[xt],(o,[t])=>t.value in o.properties()],"filter-has-id":[ht,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[ht,[zo(dt)],(o,[t])=>t.value.indexOf(o.geometryType())>=0],"filter-id-in":[ht,[zo(xt)],(o,[t])=>t.value.indexOf(o.id())>=0],"filter-in-small":[ht,[dt,zo(xt)],(o,[t,i])=>i.value.indexOf(o.properties()[t.value])>=0],"filter-in-large":[ht,[dt,zo(xt)],(o,[t,i])=>function(a,h,m,g){for(;m<=g;){const v=m+g>>1;if(h[v]===a)return!0;h[v]>a?g=v-1:m=v+1}return!1}(o.properties()[t.value],i.value,0,i.value.length-1)],all:{type:ht,overloads:[[[ht,ht],(o,[t,i])=>t.evaluate(o)&&i.evaluate(o)],[wn(ht),(o,t)=>{for(const i of t)if(!i.evaluate(o))return!1;return!0}]]},any:{type:ht,overloads:[[[ht,ht],(o,[t,i])=>t.evaluate(o)||i.evaluate(o)],[wn(ht),(o,t)=>{for(const i of t)if(i.evaluate(o))return!0;return!1}]]},"!":[ht,[ht],(o,[t])=>!t.evaluate(o)],"is-supported-script":[ht,[dt],(o,[t])=>{const i=o.globals&&o.globals.isSupportedScript;return!i||i(t.evaluate(o))}],upcase:[dt,[dt],(o,[t])=>t.evaluate(o).toUpperCase()],downcase:[dt,[dt],(o,[t])=>t.evaluate(o).toLowerCase()],concat:[dt,wn(xt),(o,t)=>t.map(i=>Ji(i.evaluate(o))).join("")],"resolved-locale":[dt,[pn],(o,[t])=>t.evaluate(o).resolvedLocale()]});class ac{constructor(t,i){var a;this.expression=t,this._warningHistory={},this._evaluator=new xa,this._defaultValue=i?(a=i).type==="color"&&ja(a.default)?new Xt(0,0,0,0):a.type==="color"?Xt.parse(a.default)||null:a.type==="padding"?ro.parse(a.default)||null:a.type==="variableAnchorOffsetCollection"?oo.parse(a.default)||null:a.type==="projectionDefinition"?Ro.parse(a.default)||null:a.default===void 0?null:a.default:null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(t,i,a,h,m,g){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=a,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)}evaluate(t,i,a,h,m,g){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=a||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new Tr(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function Na(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in Qn}function Sn(o,t){const i=new Gt(Qn,Fa,[],t?function(h){const m={color:Lt,string:dt,number:Le,enum:dt,boolean:ht,formatted:Nr,padding:Wr,projectionDefinition:Mt,resolvedImage:fr,variableAnchorOffsetCollection:_a};return h.type==="array"?zo(m[h.value]||xt,h.length):m[h.type]}(t):void 0),a=i.parse(o,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?oh(new ac(a,t)):es(i.errors)}class Va{constructor(t,i){this.kind=t,this._styleExpression=i,this.isStateDependent=t!=="constant"&&!js(i.expression)}evaluateWithoutErrorHandling(t,i,a,h,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,i,a,h,m,g)}evaluate(t,i,a,h,m,g){return this._styleExpression.evaluate(t,i,a,h,m,g)}}class lc{constructor(t,i,a,h){this.kind=t,this.zoomStops=a,this._styleExpression=i,this.isStateDependent=t!=="camera"&&!js(i.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,i,a,h,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,i,a,h,m,g)}evaluate(t,i,a,h,m,g){return this._styleExpression.evaluate(t,i,a,h,m,g)}interpolationFactor(t,i,a){return this.interpolationType?xo.interpolationFactor(this.interpolationType,t,i,a):0}}function lh(o,t){const i=Sn(o,t);if(i.result==="error")return i;const a=i.value.expression,h=Oa(a);if(!h&&!ts(t))return es([new gt("","data expressions not supported")]);const m=$a(a,["zoom"]);if(!m&&!ih(t))return es([new gt("","zoom expressions not supported")]);const g=Za(a);return g||m?g instanceof gt?es([g]):g instanceof xo&&!sc(t)?es([new gt("",'"interpolate" expressions cannot be used with this property')]):oh(g?new lc(h?"camera":"composite",i.value,g.labels,g instanceof xo?g.interpolation:void 0):new Va(h?"constant":"source",i.value)):es([new gt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ua{constructor(t,i){this._parameters=t,this._specification=i,Qe(this,nh(this._parameters,this._specification))}static deserialize(t){return new Ua(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Za(o){let t=null;if(o instanceof Dt)t=Za(o.result);else if(o instanceof Fr){for(const i of o.args)if(t=Za(i),t)break}else(o instanceof Yn||o instanceof xo)&&o.input instanceof ci&&o.input.name==="zoom"&&(t=o);return t instanceof gt||o.eachChild(i=>{const a=Za(i);a instanceof gt?t=a:!t&&a?t=new gt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&a&&t!==a&&(t=new gt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function cc(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const t of o.slice(1))if(!cc(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const ch={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ga(o){if(o==null)return{filter:()=>!0,needGeometry:!1};cc(o)||(o=Ns(o));const t=Sn(o,ch);if(t.result==="error")throw new Error(t.value.map(i=>`${i.key}: ${i.message}`).join(", "));return{filter:(i,a,h)=>t.value.evaluate(i,a,{},h),needGeometry:uh(o)}}function sf(o,t){return o<t?-1:o>t?1:0}function uh(o){if(!Array.isArray(o))return!1;if(o[0]==="within"||o[0]==="distance")return!0;for(let t=1;t<o.length;t++)if(uh(o[t]))return!0;return!1}function Ns(o){if(!o)return!0;const t=o[0];return o.length<=1?t!=="any":t==="=="?qa(o[1],o[2],"=="):t==="!="?rs(qa(o[1],o[2],"==")):t==="<"||t===">"||t==="<="||t===">="?qa(o[1],o[2],t):t==="any"?(i=o.slice(1),["any"].concat(i.map(Ns))):t==="all"?["all"].concat(o.slice(1).map(Ns)):t==="none"?["all"].concat(o.slice(1).map(Ns).map(rs)):t==="in"?uc(o[1],o.slice(2)):t==="!in"?rs(uc(o[1],o.slice(2))):t==="has"?hc(o[1]):t!=="!has"||rs(hc(o[1]));var i}function qa(o,t,i){switch(o){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,o,t]}}function uc(o,t){if(t.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(i=>typeof i!=typeof t[0])?["filter-in-large",o,["literal",t.sort(sf)]]:["filter-in-small",o,["literal",t]]}}function hc(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function rs(o){return["!",o]}function Vs(o){const t=typeof o;if(t==="number"||t==="boolean"||t==="string"||o==null)return JSON.stringify(o);if(Array.isArray(o)){let h="[";for(const m of o)h+=`${Vs(m)},`;return`${h}]`}const i=Object.keys(o).sort();let a="{";for(let h=0;h<i.length;h++)a+=`${JSON.stringify(i[h])}:${Vs(o[i[h]])},`;return`${a}}`}function dc(o){let t="";for(const i of U)t+=`/${Vs(o[i])}`;return t}function Us(o){const t=o.value;return t?[new be(o.key,t,"constants have been deprecated as of v8")]:[]}function Br(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function Tn(o){if(Array.isArray(o))return o.map(Tn);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const t={};for(const i in o)t[i]=Tn(o[i]);return t}return Br(o)}function ui(o){const t=o.key,i=o.value,a=o.valueSpec||{},h=o.objectElementValidators||{},m=o.style,g=o.styleSpec,v=o.validateSpec;let C=[];const T=Kt(i);if(T!=="object")return[new be(t,i,`object expected, ${T} found`)];for(const M in i){const I=M.split(".")[0],B=a[I]||a["*"];let F;if(h[I])F=h[I];else if(a[I])F=v;else if(h["*"])F=h["*"];else{if(!a["*"]){C.push(new be(t,i[M],`unknown property "${M}"`));continue}F=v}C=C.concat(F({key:(t&&`${t}.`)+M,value:i[M],valueSpec:B,style:m,styleSpec:g,object:i,objectKey:M,validateSpec:v},i))}for(const M in a)h[M]||a[M].required&&a[M].default===void 0&&i[M]===void 0&&C.push(new be(t,i,`missing required property "${M}"`));return C}function fc(o){const t=o.value,i=o.valueSpec,a=o.style,h=o.styleSpec,m=o.key,g=o.arrayElementValidator||o.validateSpec;if(Kt(t)!=="array")return[new be(m,t,`array expected, ${Kt(t)} found`)];if(i.length&&t.length!==i.length)return[new be(m,t,`array length ${i.length} expected, length ${t.length} found`)];if(i["min-length"]&&t.length<i["min-length"])return[new be(m,t,`array length at least ${i["min-length"]} expected, length ${t.length} found`)];let v={type:i.value,values:i.values};h.$version<7&&(v.function=i.function),Kt(i.value)==="object"&&(v=i.value);let C=[];for(let T=0;T<t.length;T++)C=C.concat(g({array:t,arrayIndex:T,value:t[T],valueSpec:v,validateSpec:o.validateSpec,style:a,styleSpec:h,key:`${m}[${T}]`}));return C}function pc(o){const t=o.key,i=o.value,a=o.valueSpec;let h=Kt(i);return h==="number"&&i!=i&&(h="NaN"),h!=="number"?[new be(t,i,`number expected, ${h} found`)]:"minimum"in a&&i<a.minimum?[new be(t,i,`${i} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&i>a.maximum?[new be(t,i,`${i} is greater than the maximum value ${a.maximum}`)]:[]}function hh(o){const t=o.valueSpec,i=Br(o.value.type);let a,h,m,g={};const v=i!=="categorical"&&o.value.property===void 0,C=!v,T=Kt(o.value.stops)==="array"&&Kt(o.value.stops[0])==="array"&&Kt(o.value.stops[0][0])==="object",M=ui({key:o.key,value:o.value,valueSpec:o.styleSpec.function,validateSpec:o.validateSpec,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(F){if(i==="identity")return[new be(F.key,F.value,'identity function may not have a "stops" property')];let O=[];const j=F.value;return O=O.concat(fc({key:F.key,value:j,valueSpec:F.valueSpec,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:I})),Kt(j)==="array"&&j.length===0&&O.push(new be(F.key,j,"array must have at least one stop")),O},default:function(F){return F.validateSpec({key:F.key,value:F.value,valueSpec:t,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec})}}});return i==="identity"&&v&&M.push(new be(o.key,o.value,'missing required property "property"')),i==="identity"||o.value.stops||M.push(new be(o.key,o.value,'missing required property "stops"')),i==="exponential"&&o.valueSpec.expression&&!sc(o.valueSpec)&&M.push(new be(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(C&&!ts(o.valueSpec)?M.push(new be(o.key,o.value,"property functions not supported")):v&&!ih(o.valueSpec)&&M.push(new be(o.key,o.value,"zoom functions not supported"))),i!=="categorical"&&!T||o.value.property!==void 0||M.push(new be(o.key,o.value,'"property" property is required')),M;function I(F){let O=[];const j=F.value,W=F.key;if(Kt(j)!=="array")return[new be(W,j,`array expected, ${Kt(j)} found`)];if(j.length!==2)return[new be(W,j,`array length 2 expected, length ${j.length} found`)];if(T){if(Kt(j[0])!=="object")return[new be(W,j,`object expected, ${Kt(j[0])} found`)];if(j[0].zoom===void 0)return[new be(W,j,"object stop key must have zoom")];if(j[0].value===void 0)return[new be(W,j,"object stop key must have value")];if(m&&m>Br(j[0].zoom))return[new be(W,j[0].zoom,"stop zoom values must appear in ascending order")];Br(j[0].zoom)!==m&&(m=Br(j[0].zoom),h=void 0,g={}),O=O.concat(ui({key:`${W}[0]`,value:j[0],valueSpec:{zoom:{}},validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:pc,value:B}}))}else O=O.concat(B({key:`${W}[0]`,value:j[0],validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec},j));return Na(Tn(j[1]))?O.concat([new be(`${W}[1]`,j[1],"expressions are not allowed in function stops.")]):O.concat(F.validateSpec({key:`${W}[1]`,value:j[1],valueSpec:t,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec}))}function B(F,O){const j=Kt(F.value),W=Br(F.value),ee=F.value!==null?F.value:O;if(a){if(j!==a)return[new be(F.key,ee,`${j} stop domain type must match previous stop domain type ${a}`)]}else a=j;if(j!=="number"&&j!=="string"&&j!=="boolean")return[new be(F.key,ee,"stop domain value must be a number, string, or boolean")];if(j!=="number"&&i!=="categorical"){let he=`number expected, ${j} found`;return ts(t)&&i===void 0&&(he+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new be(F.key,ee,he)]}return i!=="categorical"||j!=="number"||isFinite(W)&&Math.floor(W)===W?i!=="categorical"&&j==="number"&&h!==void 0&&W<h?[new be(F.key,ee,"stop domain values must appear in ascending order")]:(h=W,i==="categorical"&&W in g?[new be(F.key,ee,"stop domain values must be unique")]:(g[W]=!0,[])):[new be(F.key,ee,`integer expected, found ${W}`)]}}function kn(o){const t=(o.expressionContext==="property"?lh:Sn)(Tn(o.value),o.valueSpec);if(t.result==="error")return t.value.map(a=>new be(`${o.key}${a.key}`,o.value,a.message));const i=t.value.expression||t.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!i.outputDefined())return[new be(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!js(i))return[new be(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!js(i))return[new be(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!$a(i,["zoom","feature-state"]))return[new be(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!Oa(i))return[new be(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function os(o){const t=o.key,i=o.value,a=o.valueSpec,h=[];return Array.isArray(a.values)?a.values.indexOf(Br(i))===-1&&h.push(new be(t,i,`expected one of [${a.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(a.values).indexOf(Br(i))===-1&&h.push(new be(t,i,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(i)} found`)),h}function is(o){return cc(Tn(o.value))?kn(Qe({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):dh(o)}function dh(o){const t=o.value,i=o.key;if(Kt(t)!=="array")return[new be(i,t,`array expected, ${Kt(t)} found`)];const a=o.styleSpec;let h,m=[];if(t.length<1)return[new be(i,t,"filter array must have at least 1 element")];switch(m=m.concat(os({key:`${i}[0]`,value:t[0],valueSpec:a.filter_operator,style:o.style,styleSpec:o.styleSpec})),Br(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Br(t[1])==="$type"&&m.push(new be(i,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&m.push(new be(i,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=Kt(t[1]),h!=="string"&&m.push(new be(`${i}[1]`,t[1],`string expected, ${h} found`)));for(let g=2;g<t.length;g++)h=Kt(t[g]),Br(t[1])==="$type"?m=m.concat(os({key:`${i}[${g}]`,value:t[g],valueSpec:a.geometry_type,style:o.style,styleSpec:o.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new be(`${i}[${g}]`,t[g],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let g=1;g<t.length;g++)m=m.concat(dh({key:`${i}[${g}]`,value:t[g],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":h=Kt(t[1]),t.length!==2?m.push(new be(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new be(`${i}[1]`,t[1],`string expected, ${h} found`))}return m}function mc(o,t){const i=o.key,a=o.validateSpec,h=o.style,m=o.styleSpec,g=o.value,v=o.objectKey,C=m[`${t}_${o.layerType}`];if(!C)return[];const T=v.match(/^(.*)-transition$/);if(t==="paint"&&T&&C[T[1]]&&C[T[1]].transition)return a({key:i,value:g,valueSpec:m.transition,style:h,styleSpec:m});const M=o.valueSpec||C[v];if(!M)return[new be(i,g,`unknown property "${v}"`)];let I;if(Kt(g)==="string"&&ts(M)&&!M.tokens&&(I=/^{([^}]+)}$/.exec(g)))return[new be(i,g,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(I[1])} }\`.`)];const B=[];return o.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&B.push(new be(i,g,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&ja(Tn(g))&&Br(g.type)==="identity"&&B.push(new be(i,g,'"text-font" does not support identity functions'))),B.concat(a({key:o.key,value:g,valueSpec:M,style:h,styleSpec:m,expressionContext:"property",propertyType:t,propertyKey:v}))}function gc(o){return mc(o,"paint")}function fh(o){return mc(o,"layout")}function _c(o){let t=[];const i=o.value,a=o.key,h=o.style,m=o.styleSpec;i.type||i.ref||t.push(new be(a,i,'either "type" or "ref" is required'));let g=Br(i.type);const v=Br(i.ref);if(i.id){const C=Br(i.id);for(let T=0;T<o.arrayIndex;T++){const M=h.layers[T];Br(M.id)===C&&t.push(new be(a,i.id,`duplicate layer id "${i.id}", previously used at line ${M.id.__line__}`))}}if("ref"in i){let C;["type","source","source-layer","filter","layout"].forEach(T=>{T in i&&t.push(new be(a,i[T],`"${T}" is prohibited for ref layers`))}),h.layers.forEach(T=>{Br(T.id)===v&&(C=T)}),C?C.ref?t.push(new be(a,i.ref,"ref cannot reference another ref layer")):g=Br(C.type):t.push(new be(a,i.ref,`ref layer "${v}" not found`))}else if(g!=="background")if(i.source){const C=h.sources&&h.sources[i.source],T=C&&Br(C.type);C?T==="vector"&&g==="raster"?t.push(new be(a,i.source,`layer "${i.id}" requires a raster source`)):T!=="raster-dem"&&g==="hillshade"?t.push(new be(a,i.source,`layer "${i.id}" requires a raster-dem source`)):T==="raster"&&g!=="raster"?t.push(new be(a,i.source,`layer "${i.id}" requires a vector source`)):T!=="vector"||i["source-layer"]?T==="raster-dem"&&g!=="hillshade"?t.push(new be(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!i.paint||!i.paint["line-gradient"]||T==="geojson"&&C.lineMetrics||t.push(new be(a,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new be(a,i,`layer "${i.id}" must specify a "source-layer"`)):t.push(new be(a,i.source,`source "${i.source}" not found`))}else t.push(new be(a,i,'missing required property "source"'));return t=t.concat(ui({key:a,value:i,valueSpec:m.layer,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,objectElementValidators:{"*":()=>[],type:()=>o.validateSpec({key:`${a}.type`,value:i.type,valueSpec:m.layer.type,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,object:i,objectKey:"type"}),filter:is,layout:C=>ui({layer:i,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":T=>fh(Qe({layerType:g},T))}}),paint:C=>ui({layer:i,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":T=>gc(Qe({layerType:g},T))}})}})),t}function en(o){const t=o.value,i=o.key,a=Kt(t);return a!=="string"?[new be(i,t,`string expected, ${a} found`)]:[]}const ns={promoteId:function({key:o,value:t}){if(Kt(t)==="string")return en({key:o,value:t});{const i=[];for(const a in t)i.push(...en({key:`${o}.${a}`,value:t[a]}));return i}}};function ph(o){const t=o.value,i=o.key,a=o.styleSpec,h=o.style,m=o.validateSpec;if(!t.type)return[new be(i,t,'"type" is required')];const g=Br(t.type);let v;switch(g){case"vector":case"raster":return v=ui({key:i,value:t,valueSpec:a[`source_${g.replace("-","_")}`],style:o.style,styleSpec:a,objectElementValidators:ns,validateSpec:m}),v;case"raster-dem":return v=function(C){var T;const M=(T=C.sourceName)!==null&&T!==void 0?T:"",I=C.value,B=C.styleSpec,F=B.source_raster_dem,O=C.style;let j=[];const W=Kt(I);if(I===void 0)return j;if(W!=="object")return j.push(new be("source_raster_dem",I,`object expected, ${W} found`)),j;const ee=Br(I.encoding)==="custom",he=["redFactor","greenFactor","blueFactor","baseShift"],oe=C.value.encoding?`"${C.value.encoding}"`:"Default";for(const L in I)!ee&&he.includes(L)?j.push(new be(L,I[L],`In "${M}": "${L}" is only valid when "encoding" is set to "custom". ${oe} encoding found`)):F[L]?j=j.concat(C.validateSpec({key:L,value:I[L],valueSpec:F[L],validateSpec:C.validateSpec,style:O,styleSpec:B})):j.push(new be(L,I[L],`unknown property "${L}"`));return j}({sourceName:i,value:t,style:o.style,styleSpec:a,validateSpec:m}),v;case"geojson":if(v=ui({key:i,value:t,valueSpec:a.source_geojson,style:h,styleSpec:a,validateSpec:m,objectElementValidators:ns}),t.cluster)for(const C in t.clusterProperties){const[T,M]=t.clusterProperties[C],I=typeof T=="string"?[T,["accumulated"],["get",C]]:T;v.push(...kn({key:`${i}.${C}.map`,value:M,expressionContext:"cluster-map"})),v.push(...kn({key:`${i}.${C}.reduce`,value:I,expressionContext:"cluster-reduce"}))}return v;case"video":return ui({key:i,value:t,valueSpec:a.source_video,style:h,validateSpec:m,styleSpec:a});case"image":return ui({key:i,value:t,valueSpec:a.source_image,style:h,validateSpec:m,styleSpec:a});case"canvas":return[new be(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return os({key:`${i}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function mh(o){const t=o.value,i=o.styleSpec,a=i.light,h=o.style;let m=[];const g=Kt(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new be("light",t,`object expected, ${g} found`)]),m;for(const v in t){const C=v.match(/^(.*)-transition$/);m=m.concat(C&&a[C[1]]&&a[C[1]].transition?o.validateSpec({key:v,value:t[v],valueSpec:i.transition,validateSpec:o.validateSpec,style:h,styleSpec:i}):a[v]?o.validateSpec({key:v,value:t[v],valueSpec:a[v],validateSpec:o.validateSpec,style:h,styleSpec:i}):[new be(v,t[v],`unknown property "${v}"`)])}return m}function gh(o){const t=o.value,i=o.styleSpec,a=i.sky,h=o.style,m=Kt(t);if(t===void 0)return[];if(m!=="object")return[new be("sky",t,`object expected, ${m} found`)];let g=[];for(const v in t)g=g.concat(a[v]?o.validateSpec({key:v,value:t[v],valueSpec:a[v],style:h,styleSpec:i}):[new be(v,t[v],`unknown property "${v}"`)]);return g}function _h(o){const t=o.value,i=o.styleSpec,a=i.terrain,h=o.style;let m=[];const g=Kt(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new be("terrain",t,`object expected, ${g} found`)]),m;for(const v in t)m=m.concat(a[v]?o.validateSpec({key:v,value:t[v],valueSpec:a[v],validateSpec:o.validateSpec,style:h,styleSpec:i}):[new be(v,t[v],`unknown property "${v}"`)]);return m}function yh(o){let t=[];const i=o.value,a=o.key;if(Array.isArray(i)){const h=[],m=[];for(const g in i)i[g].id&&h.includes(i[g].id)&&t.push(new be(a,i,`all the sprites' ids must be unique, but ${i[g].id} is duplicated`)),h.push(i[g].id),i[g].url&&m.includes(i[g].url)&&t.push(new be(a,i,`all the sprites' URLs must be unique, but ${i[g].url} is duplicated`)),m.push(i[g].url),t=t.concat(ui({key:`${a}[${g}]`,value:i[g],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:o.validateSpec}));return t}return en({key:a,value:i})}const vh={"*":()=>[],array:fc,boolean:function(o){const t=o.value,i=o.key,a=Kt(t);return a!=="boolean"?[new be(i,t,`boolean expected, ${a} found`)]:[]},number:pc,color:function(o){const t=o.key,i=o.value,a=Kt(i);return a!=="string"?[new be(t,i,`color expected, ${a} found`)]:Xt.parse(String(i))?[]:[new be(t,i,`color expected, "${i}" found`)]},constants:Us,enum:os,filter:is,function:hh,layer:_c,object:ui,source:ph,light:mh,sky:gh,terrain:_h,projection:function(o){const t=o.value,i=o.styleSpec,a=i.projection,h=o.style,m=Kt(t);if(t===void 0)return[];if(m!=="object")return[new be("projection",t,`object expected, ${m} found`)];let g=[];for(const v in t)g=g.concat(a[v]?o.validateSpec({key:v,value:t[v],valueSpec:a[v],style:h,styleSpec:i}):[new be(v,t[v],`unknown property "${v}"`)]);return g},projectionDefinition:function(o){const t=o.key;let i=o.value;i=i instanceof String?i.valueOf():i;const a=Kt(i);return a!=="array"||function(h){return Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"}(i)||function(h){return!!["interpolate","step","literal"].includes(h[0])}(i)?["array","string"].includes(a)?[]:[new be(t,i,`projection expected, invalid type "${a}" found`)]:[new be(t,i,`projection expected, invalid array ${JSON.stringify(i)} found`)]},string:en,formatted:function(o){return en(o).length===0?[]:kn(o)},resolvedImage:function(o){return en(o).length===0?[]:kn(o)},padding:function(o){const t=o.key,i=o.value;if(Kt(i)==="array"){if(i.length<1||i.length>4)return[new be(t,i,`padding requires 1 to 4 values; ${i.length} values found`)];const a={type:"number"};let h=[];for(let m=0;m<i.length;m++)h=h.concat(o.validateSpec({key:`${t}[${m}]`,value:i[m],validateSpec:o.validateSpec,valueSpec:a}));return h}return pc({key:t,value:i,valueSpec:{}})},variableAnchorOffsetCollection:function(o){const t=o.key,i=o.value,a=Kt(i),h=o.styleSpec;if(a!=="array"||i.length<1||i.length%2!=0)return[new be(t,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let g=0;g<i.length;g+=2)m=m.concat(os({key:`${t}[${g}]`,value:i[g],valueSpec:h.layout_symbol["text-anchor"]})),m=m.concat(fc({key:`${t}[${g+1}]`,value:i[g+1],valueSpec:{length:2,value:"number"},validateSpec:o.validateSpec,style:o.style,styleSpec:h}));return m},sprite:yh};function tn(o){const t=o.value,i=o.valueSpec,a=o.styleSpec;return o.validateSpec=tn,i.expression&&ja(Br(t))?hh(o):i.expression&&Na(Tn(t))?kn(o):i.type&&vh[i.type]?vh[i.type](o):ui(Qe({},o,{valueSpec:i.type?a[i.type]:i}))}function ss(o){const t=o.value,i=o.key,a=en(o);return a.length||(t.indexOf("{fontstack}")===-1&&a.push(new be(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&a.push(new be(i,t,'"glyphs" url must include a "{range}" token'))),a}function kr(o,t=A){let i=[];return i=i.concat(tn({key:"",value:o,valueSpec:t.$root,styleSpec:t,style:o,validateSpec:tn,objectElementValidators:{glyphs:ss,"*":()=>[]}})),o.constants&&(i=i.concat(Us({key:"constants",value:o.constants}))),yc(i)}function Bo(o){return function(t){return o({...t,validateSpec:tn})}}function yc(o){return[].concat(o).sort((t,i)=>t.line-i.line)}function Ii(o){return function(...t){return yc(o.apply(this,t))}}kr.source=Ii(Bo(ph)),kr.sprite=Ii(Bo(yh)),kr.glyphs=Ii(Bo(ss)),kr.light=Ii(Bo(mh)),kr.sky=Ii(Bo(gh)),kr.terrain=Ii(Bo(_h)),kr.layer=Ii(Bo(_c)),kr.filter=Ii(Bo(is)),kr.paintProperty=Ii(Bo(gc)),kr.layoutProperty=Ii(Bo(fh));const as=kr,Zs=as.light,bh=as.sky,vc=as.paintProperty,af=as.layoutProperty;function Wa(o,t){let i=!1;if(t&&t.length)for(const a of t)o.fire(new oi(new Error(a.message))),i=!0;return i}class Gs{constructor(t,i,a){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const g=new Int32Array(this.arrayBuffer);t=g[0],this.d=(i=g[1])+2*(a=g[2]);for(let C=0;C<this.d*this.d;C++){const T=g[3+C],M=g[3+C+1];h.push(T===M?null:g.subarray(T,M))}const v=g[3+h.length+1];this.keys=g.subarray(g[3+h.length],v),this.bboxes=g.subarray(v),this.insert=this._insertReadonly}else{this.d=i+2*a;for(let g=0;g<this.d*this.d;g++)h.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=t,this.padding=a,this.scale=i/t,this.uid=0;const m=a/i*t;this.min=-m,this.max=t+m}insert(t,i,a,h,m){this._forEachCell(i,a,h,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,i,a,h,m,g){this.cells[m].push(g)}query(t,i,a,h,m){const g=this.min,v=this.max;if(t<=g&&i<=g&&v<=a&&v<=h&&!m)return Array.prototype.slice.call(this.keys);{const C=[];return this._forEachCell(t,i,a,h,this._queryCell,C,{},m),C}}_queryCell(t,i,a,h,m,g,v,C){const T=this.cells[m];if(T!==null){const M=this.keys,I=this.bboxes;for(let B=0;B<T.length;B++){const F=T[B];if(v[F]===void 0){const O=4*F;(C?C(I[O+0],I[O+1],I[O+2],I[O+3]):t<=I[O+2]&&i<=I[O+3]&&a>=I[O+0]&&h>=I[O+1])?(v[F]=!0,g.push(M[F])):v[F]=!1}}}}_forEachCell(t,i,a,h,m,g,v,C){const T=this._convertToCellCoord(t),M=this._convertToCellCoord(i),I=this._convertToCellCoord(a),B=this._convertToCellCoord(h);for(let F=T;F<=I;F++)for(let O=M;O<=B;O++){const j=this.d*O+F;if((!C||C(this._convertFromCellCoord(F),this._convertFromCellCoord(O),this._convertFromCellCoord(F+1),this._convertFromCellCoord(O+1)))&&m.call(this,t,i,a,h,j,g,v,C))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,i=3+this.cells.length+1+1;let a=0;for(let g=0;g<this.cells.length;g++)a+=this.cells[g].length;const h=new Int32Array(i+a+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let m=i;for(let g=0;g<t.length;g++){const v=t[g];h[3+g]=m,h.set(v,m),m+=v.length}return h[3+t.length]=m,h.set(this.keys,m),m+=this.keys.length,h[3+t.length+1]=m,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer}static serialize(t,i){const a=t.toArrayBuffer();return i&&i.push(a),{buffer:a}}static deserialize(t){return new Gs(t.buffer)}}const qo={};function ct(o,t,i={}){if(qo[o])throw new Error(`${o} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:o,writeable:!1}),qo[o]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}ct("Object",Object),ct("TransferableGridIndex",Gs),ct("Color",Xt),ct("Error",Error),ct("AJAXError",qt),ct("ResolvedImage",ko),ct("StylePropertyFunction",Ua),ct("StyleExpression",ac,{omit:["_evaluator"]}),ct("ZoomDependentExpression",lc),ct("ZoomConstantExpression",Va),ct("CompoundExpression",ci,{omit:["_evaluate"]});for(const o in Qn)Qn[o]._classRegistryKey||ct(`Expression_${o}`,Qn[o]);function ls(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function bc(o){return o.$name||o.constructor._classRegistryKey}function xh(o){return!function(t){if(t===null||typeof t!="object")return!1;const i=bc(t);return!(!i||i==="Object")}(o)&&(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||o instanceof Error||ls(o)||Ge(o)||ArrayBuffer.isView(o)||o instanceof ImageData)}function rn(o,t){if(xh(o))return(ls(o)||Ge(o))&&t&&t.push(o),ArrayBuffer.isView(o)&&t&&t.push(o.buffer),o instanceof ImageData&&t&&t.push(o.data.buffer),o;if(Array.isArray(o)){const m=[];for(const g of o)m.push(rn(g,t));return m}if(typeof o!="object")throw new Error("can't serialize object of type "+typeof o);const i=bc(o);if(!i)throw new Error(`can't serialize object of unregistered class ${o.constructor.name}`);if(!qo[i])throw new Error(`${i} is not registered.`);const{klass:a}=qo[i],h=a.serialize?a.serialize(o,t):{};if(a.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in o){if(!o.hasOwnProperty(m)||qo[i].omit.indexOf(m)>=0)continue;const g=o[m];h[m]=qo[i].shallow.indexOf(m)>=0?g:rn(g,t)}o instanceof Error&&(h.message=o.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(h.$name=i),h}function qs(o){if(xh(o))return o;if(Array.isArray(o))return o.map(qs);if(typeof o!="object")throw new Error("can't deserialize object of type "+typeof o);const t=bc(o)||"Object";if(!qo[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:i}=qo[t];if(!i)throw new Error(`can't deserialize unregistered class ${t}`);if(i.deserialize)return i.deserialize(o);const a=Object.create(i.prototype);for(const h of Object.keys(o)){if(h==="$name")continue;const m=o[h];a[h]=qo[t].shallow.indexOf(h)>=0?m:qs(m)}return a}class Ha{constructor(){this.first=!0}update(t,i){const a=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=i),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=a,!0))}}const jt={"Latin-1 Supplement":o=>o>=128&&o<=255,"Hangul Jamo":o=>o>=4352&&o<=4607,Khmer:o=>o>=6016&&o<=6143,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Kanbun:o=>o>=12688&&o<=12703,"CJK Strokes":o=>o>=12736&&o<=12783,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Hangul Syllables":o=>o>=44032&&o<=55215,"Private Use Area":o=>o>=57344&&o<=63743,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function Xa(o){for(const t of o)if(Cc(t.charCodeAt(0)))return!0;return!1}function wh(o){for(const t of o)if(!xc(t.charCodeAt(0)))return!1;return!0}function Ka(o){const t=o.map(i=>{try{return new RegExp(`\\p{sc=${i}}`,"u").source}catch{return null}}).filter(i=>i);return new RegExp(t.join("|"),"u")}const Ch=Ka(["Arab","Dupl","Mong","Ougr","Syrc"]);function xc(o){return!Ch.test(String.fromCodePoint(o))}const wc=Ka(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Cc(o){return!(o!==746&&o!==747&&(o<4352||!(jt["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||jt["CJK Compatibility"](o)||jt["CJK Strokes"](o)||!(!jt["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||jt["Enclosed CJK Letters and Months"](o)||jt["Ideographic Description Characters"](o)||jt.Kanbun(o)||jt.Katakana(o)&&o!==12540||!(!jt["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!jt["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||jt["Vertical Forms"](o)||jt["Yijing Hexagram Symbols"](o)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(o))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(o))||wc.test(String.fromCodePoint(o)))))}function Sc(o){return!(Cc(o)||function(t){return!!(jt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||jt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||jt["Letterlike Symbols"](t)||jt["Number Forms"](t)||jt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||jt["Control Pictures"](t)&&t!==9251||jt["Optical Character Recognition"](t)||jt["Enclosed Alphanumerics"](t)||jt["Geometric Shapes"](t)||jt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||jt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||jt["CJK Symbols and Punctuation"](t)||jt.Katakana(t)||jt["Private Use Area"](t)||jt["CJK Compatibility Forms"](t)||jt["Small Form Variants"](t)||jt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(o))}const lf=Ka(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Tc(o){return lf.test(String.fromCodePoint(o))}function Sh(o,t){return!(!t&&Tc(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||jt.Khmer(o))}function Th(o){for(const t of o)if(Tc(t.charCodeAt(0)))return!0;return!1}const on=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(o){this.pluginStatus=o.pluginStatus,this.pluginURL=o.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(o){if(on.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=o.applyArabicShaping,this.processBidirectionalText=o.processBidirectionalText,this.processStyledBidirectionalText=o.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(o,t){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(o.pluginStatus!=="loading")return this.setState(o),o;const i=o.pluginURL,a=new Promise(m=>{this.loadScriptResolve=m});t(i);const h=new Promise(m=>setTimeout(()=>m(),this.TIMEOUT));if(yield Promise.race([a,h]),this.isParsed()){const m={pluginStatus:"loaded",pluginURL:i};return this.setState(m),m}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${i}`)})}};class vr{constructor(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ha,this.transition={})}isSupportedScript(t){return function(i,a){for(const h of i)if(!Sh(h.charCodeAt(0),a))return!1;return!0}(t,on.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,i=t-Math.floor(t),a=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*i}}}class Ws{constructor(t,i){this.property=t,this.value=i,this.expression=function(a,h){if(ja(a))return new Ua(a,h);if(Na(a)){const m=lh(a,h);if(m.result==="error")throw new Error(m.value.map(g=>`${g.key}: ${g.message}`).join(", "));return m.value}{let m=a;return h.type==="color"&&typeof a=="string"?m=Xt.parse(a):h.type!=="padding"||typeof a!="number"&&!Array.isArray(a)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(a)?m=oo.parse(a):h.type==="projectionDefinition"&&typeof a=="string"&&(m=Ro.parse(a)):m=ro.parse(a),{kind:"constant",evaluate:()=>m}}}(i===void 0?t.specification.default:i,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,i,a){return this.property.possiblyEvaluate(this,t,i,a)}}class Ya{constructor(t){this.property=t,this.value=new Ws(t,void 0)}transitioned(t,i){return new Pc(this.property,this.value,i,Rr({},t.transition,this.transition),t.now)}untransitioned(){return new Pc(this.property,this.value,null,{},0)}}class kc{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return to(this._values[t].value.value)}setValue(t,i){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Ya(this._values[t].property)),this._values[t].value=new Ws(this._values[t].property,i===null?void 0:to(i))}getTransition(t){return to(this._values[t].transition)}setTransition(t,i){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Ya(this._values[t].property)),this._values[t].transition=to(i)||void 0}serialize(){const t={};for(const i of Object.keys(this._values)){const a=this.getValue(i);a!==void 0&&(t[i]=a);const h=this.getTransition(i);h!==void 0&&(t[`${i}-transition`]=h)}return t}transitioned(t,i){const a=new Hs(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].transitioned(t,i._values[h]);return a}untransitioned(){const t=new Hs(this._properties);for(const i of Object.keys(this._values))t._values[i]=this._values[i].untransitioned();return t}}class Pc{constructor(t,i,a,h,m){this.property=t,this.value=i,this.begin=m+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=a)}possiblyEvaluate(t,i,a){const h=t.now||0,m=this.value.possiblyEvaluate(t,i,a),g=this.prior;if(g){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return g.possiblyEvaluate(t,i,a);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(t,i,a),m,zr(v))}}return m}}class Hs{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,i,a){const h=new Ja(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,i,a);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class cf{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return to(this._values[t].value)}setValue(t,i){this._values[t]=new Ws(this._values[t].property,i===null?void 0:to(i))}serialize(){const t={};for(const i of Object.keys(this._values)){const a=this.getValue(i);a!==void 0&&(t[i]=a)}return t}possiblyEvaluate(t,i,a){const h=new Ja(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,i,a);return h}}class hi{constructor(t,i,a){this.property=t,this.value=i,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,i,a,h){return this.property.evaluate(this.value,this.parameters,t,i,a,h)}}class Ja{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class _t{constructor(t){this.specification=t}possiblyEvaluate(t,i){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(i)}interpolate(t,i,a){const h=Go[this.specification.type];return h?h(t,i,a):t}}class Tt{constructor(t,i){this.specification=t,this.overrides=i}possiblyEvaluate(t,i,a,h){return new hi(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(i,null,{},a,h)}:t.expression,i)}interpolate(t,i,a){if(t.value.kind!=="constant"||i.value.kind!=="constant")return t;if(t.value.value===void 0||i.value.value===void 0)return new hi(this,{kind:"constant",value:void 0},t.parameters);const h=Go[this.specification.type];if(h){const m=h(t.value.value,i.value.value,a);return new hi(this,{kind:"constant",value:m},t.parameters)}return t}evaluate(t,i,a,h,m,g){return t.kind==="constant"?t.value:t.evaluate(i,a,h,m,g)}}class Xs extends Tt{possiblyEvaluate(t,i,a,h){if(t.value===void 0)return new hi(this,{kind:"constant",value:void 0},i);if(t.expression.kind==="constant"){const m=t.expression.evaluate(i,null,{},a,h),g=t.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,v=this._calculate(g,g,g,i);return new hi(this,{kind:"constant",value:v},i)}if(t.expression.kind==="camera"){const m=this._calculate(t.expression.evaluate({zoom:i.zoom-1}),t.expression.evaluate({zoom:i.zoom}),t.expression.evaluate({zoom:i.zoom+1}),i);return new hi(this,{kind:"constant",value:m},i)}return new hi(this,t.expression,i)}evaluate(t,i,a,h,m,g){if(t.kind==="source"){const v=t.evaluate(i,a,h,m,g);return this._calculate(v,v,v,i)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(i.zoom)-1},a,h),t.evaluate({zoom:Math.floor(i.zoom)},a,h),t.evaluate({zoom:Math.floor(i.zoom)+1},a,h),i):t.value}_calculate(t,i,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:i}:{from:a,to:i}}interpolate(t){return t}}class Qa{constructor(t){this.specification=t}possiblyEvaluate(t,i,a,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const m=t.expression.evaluate(i,null,{},a,h);return this._calculate(m,m,m,i)}return this._calculate(t.expression.evaluate(new vr(Math.floor(i.zoom-1),i)),t.expression.evaluate(new vr(Math.floor(i.zoom),i)),t.expression.evaluate(new vr(Math.floor(i.zoom+1),i)),i)}}_calculate(t,i,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:i}:{from:a,to:i}}interpolate(t){return t}}class Mc{constructor(t){this.specification=t}possiblyEvaluate(t,i,a,h){return!!t.expression.evaluate(i,null,{},a,h)}interpolate(){return!1}}class Lo{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in t){const a=t[i];a.specification.overridable&&this.overridableProperties.push(i);const h=this.defaultPropertyValues[i]=new Ws(a,void 0),m=this.defaultTransitionablePropertyValues[i]=new Ya(a);this.defaultTransitioningPropertyValues[i]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=h.possiblyEvaluate({})}}}ct("DataDrivenProperty",Tt),ct("DataConstantProperty",_t),ct("CrossFadedDataDrivenProperty",Xs),ct("CrossFadedProperty",Qa),ct("ColorRampProperty",Mc);const kh="-transition";class Ei extends ge{constructor(t,i){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),i.layout&&(this._unevaluatedLayout=new cf(i.layout)),i.paint)){this._transitionablePaint=new kc(i.paint);for(const a in t.paint)this.setPaintProperty(a,t.paint[a],{validate:!1});for(const a in t.layout)this.setLayoutProperty(a,t.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ja(i.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,i,a={}){i!=null&&this._validate(af,`layers.${this.id}.layout.${t}`,t,i,a)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,i):this.visibility=i)}getPaintProperty(t){return t.endsWith(kh)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,i,a={}){if(i!=null&&this._validate(vc,`layers.${this.id}.paint.${t}`,t,i,a))return!1;if(t.endsWith(kh))return this._transitionablePaint.setTransition(t.slice(0,-11),i||void 0),!1;{const h=this._transitionablePaint._values[t],m=h.property.specification["property-type"]==="cross-faded-data-driven",g=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(t,i),this._handleSpecialPaintPropertyUpdate(t);const C=this._transitionablePaint._values[t].value;return C.isDataDriven()||g||m||this._handleOverridablePaintPropertyUpdate(t,v,C)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,i,a){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,i){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,i)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Vo(t,(i,a)=>!(i===void 0||a==="layout"&&!Object.keys(i).length||a==="paint"&&!Object.keys(i).length))}_validate(t,i,a,h,m={}){return(!m||m.validate!==!1)&&Wa(this,t.call(as,{key:i,layerType:this.type,objectKey:a,value:h,styleSpec:A,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const i=this.paint.get(t);if(i instanceof hi&&ts(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}const uf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ai{constructor(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Pr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,i){return t._trim(),i&&(t.isTransferred=!0,i.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Or(o,t=1){let i=0,a=0;return{members:o.map(h=>{const m=uf[h.type].BYTES_PER_ELEMENT,g=i=Ph(i,Math.max(t,m)),v=h.components||1;return a=Math.max(a,m),i+=m*v,{name:h.name,type:h.type,components:v,offset:g}}),size:Ph(i,Math.max(a,t)),alignment:t}}function Ph(o,t){return Math.ceil(o/t)*t}class cs extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,i)}emplace(t,i,a){const h=2*t;return this.int16[h+0]=i,this.int16[h+1]=a,t}}cs.prototype.bytesPerElement=4,ct("StructArrayLayout2i4",cs);class el extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,a)}emplace(t,i,a,h){const m=3*t;return this.int16[m+0]=i,this.int16[m+1]=a,this.int16[m+2]=h,t}}el.prototype.bytesPerElement=6,ct("StructArrayLayout3i6",el);class Ic extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,i,a,h)}emplace(t,i,a,h,m){const g=4*t;return this.int16[g+0]=i,this.int16[g+1]=a,this.int16[g+2]=h,this.int16[g+3]=m,t}}Ic.prototype.bytesPerElement=8,ct("StructArrayLayout4i8",Ic);class ji extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,a,h,m,g)}emplace(t,i,a,h,m,g,v){const C=6*t;return this.int16[C+0]=i,this.int16[C+1]=a,this.int16[C+2]=h,this.int16[C+3]=m,this.int16[C+4]=g,this.int16[C+5]=v,t}}ji.prototype.bytesPerElement=12,ct("StructArrayLayout2i4i12",ji);class tl extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,a,h,m,g)}emplace(t,i,a,h,m,g,v){const C=4*t,T=8*t;return this.int16[C+0]=i,this.int16[C+1]=a,this.uint8[T+4]=h,this.uint8[T+5]=m,this.uint8[T+6]=g,this.uint8[T+7]=v,t}}tl.prototype.bytesPerElement=8,ct("StructArrayLayout2i4ub8",tl);class Pn extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,i)}emplace(t,i,a){const h=2*t;return this.float32[h+0]=i,this.float32[h+1]=a,t}}Pn.prototype.bytesPerElement=8,ct("StructArrayLayout2f8",Pn);class rl extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g,v,C,T,M){const I=this.length;return this.resize(I+1),this.emplace(I,t,i,a,h,m,g,v,C,T,M)}emplace(t,i,a,h,m,g,v,C,T,M,I){const B=10*t;return this.uint16[B+0]=i,this.uint16[B+1]=a,this.uint16[B+2]=h,this.uint16[B+3]=m,this.uint16[B+4]=g,this.uint16[B+5]=v,this.uint16[B+6]=C,this.uint16[B+7]=T,this.uint16[B+8]=M,this.uint16[B+9]=I,t}}rl.prototype.bytesPerElement=20,ct("StructArrayLayout10ui20",rl);class Ks extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g,v,C,T,M,I,B){const F=this.length;return this.resize(F+1),this.emplace(F,t,i,a,h,m,g,v,C,T,M,I,B)}emplace(t,i,a,h,m,g,v,C,T,M,I,B,F){const O=12*t;return this.int16[O+0]=i,this.int16[O+1]=a,this.int16[O+2]=h,this.int16[O+3]=m,this.uint16[O+4]=g,this.uint16[O+5]=v,this.uint16[O+6]=C,this.uint16[O+7]=T,this.int16[O+8]=M,this.int16[O+9]=I,this.int16[O+10]=B,this.int16[O+11]=F,t}}Ks.prototype.bytesPerElement=24,ct("StructArrayLayout4i4ui4i24",Ks);class Ec extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,a)}emplace(t,i,a,h){const m=3*t;return this.float32[m+0]=i,this.float32[m+1]=a,this.float32[m+2]=h,t}}Ec.prototype.bytesPerElement=12,ct("StructArrayLayout3f12",Ec);class us extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint32[1*t+0]=i,t}}us.prototype.bytesPerElement=4,ct("StructArrayLayout1ul4",us);class Mn extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g,v,C,T){const M=this.length;return this.resize(M+1),this.emplace(M,t,i,a,h,m,g,v,C,T)}emplace(t,i,a,h,m,g,v,C,T,M){const I=10*t,B=5*t;return this.int16[I+0]=i,this.int16[I+1]=a,this.int16[I+2]=h,this.int16[I+3]=m,this.int16[I+4]=g,this.int16[I+5]=v,this.uint32[B+3]=C,this.uint16[I+8]=T,this.uint16[I+9]=M,t}}Mn.prototype.bytesPerElement=20,ct("StructArrayLayout6i1ul2ui20",Mn);class Ac extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,a,h,m,g)}emplace(t,i,a,h,m,g,v){const C=6*t;return this.int16[C+0]=i,this.int16[C+1]=a,this.int16[C+2]=h,this.int16[C+3]=m,this.int16[C+4]=g,this.int16[C+5]=v,t}}Ac.prototype.bytesPerElement=12,ct("StructArrayLayout2i2i2i12",Ac);class ol extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,a,h,m)}emplace(t,i,a,h,m,g){const v=4*t,C=8*t;return this.float32[v+0]=i,this.float32[v+1]=a,this.float32[v+2]=h,this.int16[C+6]=m,this.int16[C+7]=g,t}}ol.prototype.bytesPerElement=16,ct("StructArrayLayout2f1f2i16",ol);class In extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,a,h,m,g)}emplace(t,i,a,h,m,g,v){const C=16*t,T=4*t,M=8*t;return this.uint8[C+0]=i,this.uint8[C+1]=a,this.float32[T+1]=h,this.float32[T+2]=m,this.int16[M+6]=g,this.int16[M+7]=v,t}}In.prototype.bytesPerElement=16,ct("StructArrayLayout2ub2f2i16",In);class il extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,a)}emplace(t,i,a,h){const m=3*t;return this.uint16[m+0]=i,this.uint16[m+1]=a,this.uint16[m+2]=h,t}}il.prototype.bytesPerElement=6,ct("StructArrayLayout3ui6",il);class zc extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g,v,C,T,M,I,B,F,O,j,W,ee){const he=this.length;return this.resize(he+1),this.emplace(he,t,i,a,h,m,g,v,C,T,M,I,B,F,O,j,W,ee)}emplace(t,i,a,h,m,g,v,C,T,M,I,B,F,O,j,W,ee,he){const oe=24*t,L=12*t,q=48*t;return this.int16[oe+0]=i,this.int16[oe+1]=a,this.uint16[oe+2]=h,this.uint16[oe+3]=m,this.uint32[L+2]=g,this.uint32[L+3]=v,this.uint32[L+4]=C,this.uint16[oe+10]=T,this.uint16[oe+11]=M,this.uint16[oe+12]=I,this.float32[L+7]=B,this.float32[L+8]=F,this.uint8[q+36]=O,this.uint8[q+37]=j,this.uint8[q+38]=W,this.uint32[L+10]=ee,this.int16[oe+22]=he,t}}zc.prototype.bytesPerElement=48,ct("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",zc);class nl extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a,h,m,g,v,C,T,M,I,B,F,O,j,W,ee,he,oe,L,q,ie,we,Oe,Te,Me,Ze,je){const qe=this.length;return this.resize(qe+1),this.emplace(qe,t,i,a,h,m,g,v,C,T,M,I,B,F,O,j,W,ee,he,oe,L,q,ie,we,Oe,Te,Me,Ze,je)}emplace(t,i,a,h,m,g,v,C,T,M,I,B,F,O,j,W,ee,he,oe,L,q,ie,we,Oe,Te,Me,Ze,je,qe){const De=32*t,ut=16*t;return this.int16[De+0]=i,this.int16[De+1]=a,this.int16[De+2]=h,this.int16[De+3]=m,this.int16[De+4]=g,this.int16[De+5]=v,this.int16[De+6]=C,this.int16[De+7]=T,this.uint16[De+8]=M,this.uint16[De+9]=I,this.uint16[De+10]=B,this.uint16[De+11]=F,this.uint16[De+12]=O,this.uint16[De+13]=j,this.uint16[De+14]=W,this.uint16[De+15]=ee,this.uint16[De+16]=he,this.uint16[De+17]=oe,this.uint16[De+18]=L,this.uint16[De+19]=q,this.uint16[De+20]=ie,this.uint16[De+21]=we,this.uint16[De+22]=Oe,this.uint32[ut+12]=Te,this.float32[ut+13]=Me,this.float32[ut+14]=Ze,this.uint16[De+30]=je,this.uint16[De+31]=qe,t}}nl.prototype.bytesPerElement=64,ct("StructArrayLayout8i15ui1ul2f2ui64",nl);class sl extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.float32[1*t+0]=i,t}}sl.prototype.bytesPerElement=4,ct("StructArrayLayout1f4",sl);class f extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,a)}emplace(t,i,a,h){const m=3*t;return this.uint16[6*t+0]=i,this.float32[m+1]=a,this.float32[m+2]=h,t}}f.prototype.bytesPerElement=12,ct("StructArrayLayout1ui2f12",f);class e extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,i,a)}emplace(t,i,a,h){const m=4*t;return this.uint32[2*t+0]=i,this.uint16[m+2]=a,this.uint16[m+3]=h,t}}e.prototype.bytesPerElement=8,ct("StructArrayLayout1ul2ui8",e);class r extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,i)}emplace(t,i,a){const h=2*t;return this.uint16[h+0]=i,this.uint16[h+1]=a,t}}r.prototype.bytesPerElement=4,ct("StructArrayLayout2ui4",r);class l extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint16[1*t+0]=i,t}}l.prototype.bytesPerElement=2,ct("StructArrayLayout1ui2",l);class u extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,i,a,h)}emplace(t,i,a,h,m){const g=4*t;return this.float32[g+0]=i,this.float32[g+1]=a,this.float32[g+2]=h,this.float32[g+3]=m,t}}u.prototype.bytesPerElement=16,ct("StructArrayLayout4f16",u);class p extends Ai{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new fe(this.anchorPointX,this.anchorPointY)}}p.prototype.size=20;class y extends Mn{get(t){return new p(this,t)}}ct("CollisionBoxArray",y);class x extends Ai{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}x.prototype.size=48;class S extends zc{get(t){return new x(this,t)}}ct("PlacedSymbolArray",S);class k extends Ai{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}k.prototype.size=64;class E extends nl{get(t){return new k(this,t)}}ct("SymbolInstanceArray",E);class z extends sl{getoffsetX(t){return this.float32[1*t+0]}}ct("GlyphOffsetArray",z);class D extends el{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}ct("SymbolLineVertexArray",D);class $ extends Ai{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}$.prototype.size=12;class N extends f{get(t){return new $(this,t)}}ct("TextAnchorOffsetArray",N);class J extends Ai{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}J.prototype.size=8;class Y extends e{get(t){return new J(this,t)}}ct("FeatureIndexArray",Y);class Q extends cs{}class re extends cs{}class ne extends cs{}class ae extends ji{}class ce extends tl{}class de extends Pn{}class ue extends rl{}class xe extends Ks{}class Ce extends Ec{}class Ee extends us{}class Re extends Ac{}class Ie extends In{}class Ke extends il{}class He extends r{}const $e=Or([{name:"a_pos",components:2,type:"Int16"}],4),{members:ft}=$e;class yt{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,i,a,h){const m=this.segments[this.segments.length-1];return t>yt.MAX_VERTEX_ARRAY_LENGTH&&qr(`Max vertices per segment is ${yt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${yt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!m||m.vertexLength+t>yt.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h?this.createNewSegment(i,a,h):m}createNewSegment(t,i,a){const h={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0,vaos:{}};return a!==void 0&&(h.sortKey=a),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(h),h}getOrCreateLatestSegment(t,i,a){return this.prepareSegment(0,t,i,a)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const i in t.vaos)t.vaos[i].destroy()}static simpleSegment(t,i,a,h){return new yt([{vertexOffset:t,primitiveOffset:i,vertexLength:a,primitiveLength:h,vaos:{},sortKey:0}])}}function Jt(o,t){return 256*(o=Gr(Math.floor(o),0,255))+Gr(Math.floor(t),0,255)}yt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ct("SegmentVector",yt);const cr=Or([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ir,br,pr,er={exports:{}},nr={exports:{}},io={exports:{}},no=function(){if(pr)return er.exports;pr=1;var o=(ir||(ir=1,nr.exports=function(i,a){var h,m,g,v,C,T,M,I;for(m=i.length-(h=3&i.length),g=a,C=3432918353,T=461845907,I=0;I<m;)M=255&i.charCodeAt(I)|(255&i.charCodeAt(++I))<<8|(255&i.charCodeAt(++I))<<16|(255&i.charCodeAt(++I))<<24,++I,g=27492+(65535&(v=5*(65535&(g=(g^=M=(65535&(M=(M=(65535&M)*C+(((M>>>16)*C&65535)<<16)&4294967295)<<15|M>>>17))*T+(((M>>>16)*T&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(M=0,h){case 3:M^=(255&i.charCodeAt(I+2))<<16;case 2:M^=(255&i.charCodeAt(I+1))<<8;case 1:g^=M=(65535&(M=(M=(65535&(M^=255&i.charCodeAt(I)))*C+(((M>>>16)*C&65535)<<16)&4294967295)<<15|M>>>17))*T+(((M>>>16)*T&65535)<<16)&4294967295}return g^=i.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}),nr.exports),t=(br||(br=1,io.exports=function(i,a){for(var h,m=i.length,g=a^m,v=0;m>=4;)h=1540483477*(65535&(h=255&i.charCodeAt(v)|(255&i.charCodeAt(++v))<<8|(255&i.charCodeAt(++v))<<16|(255&i.charCodeAt(++v))<<24))+((1540483477*(h>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),m-=4,++v;switch(m){case 3:g^=(255&i.charCodeAt(v+2))<<16;case 2:g^=(255&i.charCodeAt(v+1))<<8;case 1:g=1540483477*(65535&(g^=255&i.charCodeAt(v)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}),io.exports);return er.exports=o,er.exports.murmur3=o,er.exports.murmur2=t,er.exports}(),Hr=R(no);class fo{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,i,a,h){this.ids.push(nn(t)),this.positions.push(i,a,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const i=nn(t);let a=0,h=this.ids.length-1;for(;a<h;){const g=a+h>>1;this.ids[g]>=i?h=g:a=g+1}const m=[];for(;this.ids[a]===i;)m.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return m}static serialize(t,i){const a=new Float64Array(t.ids),h=new Uint32Array(t.positions);return Ni(a,h,0,a.length-1),i&&i.push(a.buffer,h.buffer),{ids:a,positions:h}}static deserialize(t){const i=new fo;return i.ids=t.ids,i.positions=t.positions,i.indexed=!0,i}}function nn(o){const t=+o;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Hr(String(o))}function Ni(o,t,i,a){for(;i<a;){const h=o[i+a>>1];let m=i-1,g=a+1;for(;;){do m++;while(o[m]<h);do g--;while(o[g]>h);if(m>=g)break;zi(o,m,g),zi(t,3*m,3*g),zi(t,3*m+1,3*g+1),zi(t,3*m+2,3*g+2)}g-i<a-g?(Ni(o,t,i,g),i=g+1):(Ni(o,t,g+1,a),a=g)}}function zi(o,t,i){const a=o[t];o[t]=o[i],o[i]=a}ct("FeaturePositionMap",fo);class di{constructor(t,i){this.gl=t.gl,this.location=i}}class En extends di{constructor(t,i){super(t,i),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Ys extends di{constructor(t,i){super(t,i),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class An extends di{constructor(t,i){super(t,i),this.current=Xt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const fi=new Float32Array(16);function Ri(o){return[Jt(255*o.r,255*o.g),Jt(255*o.b,255*o.a)]}class bi{constructor(t,i,a){this.value=t,this.uniformNames=i.map(h=>`u_${h}`),this.type=a}setUniform(t,i,a){t.set(a.constantOr(this.value))}getBinding(t,i,a){return this.type==="color"?new An(t,i):new En(t,i)}}class Di{constructor(t,i){this.uniformNames=i.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=t.tlbr}setUniform(t,i,a,h){const m=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&t.set(m)}getBinding(t,i,a){return a.substr(0,9)==="u_pattern"?new Ys(t,i):new En(t,i)}}class ur{constructor(t,i,a,h){this.expression=t,this.type=a,this.maxValue=0,this.paintVertexAttributes=i.map(m=>({name:`a_${m}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,i,a,h,m){const g=this.paintVertexArray.length,v=this.expression.evaluate(new vr(0),i,{},h,[],m);this.paintVertexArray.resize(t),this._setPaintValue(g,t,v)}updatePaintArray(t,i,a,h){const m=this.expression.evaluate({zoom:0},a,h);this._setPaintValue(t,i,m)}_setPaintValue(t,i,a){if(this.type==="color"){const h=Ri(a);for(let m=t;m<i;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=t;h<i;h++)this.paintVertexArray.emplace(h,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ar{constructor(t,i,a,h,m,g){this.expression=t,this.uniformNames=i.map(v=>`u_${v}_t`),this.type=a,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=i.map(v=>({name:`a_${v}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,i,a,h,m){const g=this.expression.evaluate(new vr(this.zoom),i,{},h,[],m),v=this.expression.evaluate(new vr(this.zoom+1),i,{},h,[],m),C=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(C,t,g,v)}updatePaintArray(t,i,a,h){const m=this.expression.evaluate({zoom:this.zoom},a,h),g=this.expression.evaluate({zoom:this.zoom+1},a,h);this._setPaintValue(t,i,m,g)}_setPaintValue(t,i,a,h){if(this.type==="color"){const m=Ri(a),g=Ri(h);for(let v=t;v<i;v++)this.paintVertexArray.emplace(v,m[0],m[1],g[0],g[1])}else{for(let m=t;m<i;m++)this.paintVertexArray.emplace(m,a,h);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,i){const a=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,h=Gr(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,i,a){return new En(t,i)}}class Xr{constructor(t,i,a,h,m,g){this.expression=t,this.type=i,this.useIntegerZoom=a,this.zoom=h,this.layerId=g,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(t,i,a){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,i.patterns&&i.patterns[this.layerId],a)}updatePaintArray(t,i,a,h,m){this._setPaintValues(t,i,a.patterns&&a.patterns[this.layerId],m)}_setPaintValues(t,i,a,h){if(!h||!a)return;const{min:m,mid:g,max:v}=a,C=h[m],T=h[g],M=h[v];if(C&&T&&M)for(let I=t;I<i;I++)this.zoomInPaintVertexArray.emplace(I,T.tl[0],T.tl[1],T.br[0],T.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],T.pixelRatio,C.pixelRatio),this.zoomOutPaintVertexArray.emplace(I,T.tl[0],T.tl[1],T.br[0],T.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],T.pixelRatio,M.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,cr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,cr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Kr{constructor(t,i,a){this.binders={},this._buffers=[];const h=[];for(const m in t.paint._values){if(!a(m))continue;const g=t.paint.get(m);if(!(g instanceof hi&&ts(g.property.specification)))continue;const v=hf(m,t.type),C=g.value,T=g.property.specification.type,M=g.property.useIntegerZoom,I=g.property.specification["property-type"],B=I==="cross-faded"||I==="cross-faded-data-driven";if(C.kind==="constant")this.binders[m]=B?new Di(C.value,v):new bi(C.value,v,T),h.push(`/u_${m}`);else if(C.kind==="source"||B){const F=Mh(m,T,"source");this.binders[m]=B?new Xr(C,T,M,i,F,t.id):new ur(C,v,T,F),h.push(`/a_${m}`)}else{const F=Mh(m,T,"composite");this.binders[m]=new ar(C,v,T,M,i,F),h.push(`/z_${m}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const i=this.binders[t];return i instanceof ur||i instanceof ar?i.maxValue:0}populatePaintArrays(t,i,a,h,m){for(const g in this.binders){const v=this.binders[g];(v instanceof ur||v instanceof ar||v instanceof Xr)&&v.populatePaintArray(t,i,a,h,m)}}setConstantPatternPositions(t,i){for(const a in this.binders){const h=this.binders[a];h instanceof Di&&h.setConstantPatternPositions(t,i)}}updatePaintArrays(t,i,a,h,m){let g=!1;for(const v in t){const C=i.getPositions(v);for(const T of C){const M=a.feature(T.index);for(const I in this.binders){const B=this.binders[I];if((B instanceof ur||B instanceof ar||B instanceof Xr)&&B.expression.isStateDependent===!0){const F=h.paint.get(I);B.expression=F.value,B.updatePaintArray(T.start,T.end,M,t[v],m),g=!0}}}}return g}defines(){const t=[];for(const i in this.binders){const a=this.binders[i];(a instanceof bi||a instanceof Di)&&t.push(...a.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof ur||a instanceof ar)for(let h=0;h<a.paintVertexAttributes.length;h++)t.push(a.paintVertexAttributes[h].name);else if(a instanceof Xr)for(let h=0;h<cr.members.length;h++)t.push(cr.members[h].name)}return t}getBinderUniforms(){const t=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof bi||a instanceof Di||a instanceof ar)for(const h of a.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,i){const a=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof bi||m instanceof Di||m instanceof ar){for(const g of m.uniformNames)if(i[g]){const v=m.getBinding(t,i[g],g);a.push({name:g,property:h,binding:v})}}}return a}setUniforms(t,i,a,h){for(const{name:m,property:g,binding:v}of i)this.binders[g].setUniform(v,h,a.get(g),m)}updatePaintBuffers(t){this._buffers=[];for(const i in this.binders){const a=this.binders[i];if(t&&a instanceof Xr){const h=t.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(a instanceof ur||a instanceof ar)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(t){for(const i in this.binders){const a=this.binders[i];(a instanceof ur||a instanceof ar||a instanceof Xr)&&a.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const i=this.binders[t];(i instanceof ur||i instanceof ar||i instanceof Xr)&&i.destroy()}}}class zn{constructor(t,i,a=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new Kr(h,i,a);this.needsUpload=!1,this._featureMap=new fo,this._bufferOffset=0}populatePaintArrays(t,i,a,h,m,g){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(t,i,h,m,g);i.id!==void 0&&this._featureMap.add(i.id,a,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,i,a,h){for(const m of a)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(t,this._featureMap,i,m,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function hf(o,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${t}-`,"").replace(/-/g,"_")]}function Mh(o,t,i){const a={color:{source:Pn,composite:u},number:{source:sl,composite:Pn}},h=function(m){return{"line-pattern":{source:ue,composite:ue},"fill-pattern":{source:ue,composite:ue},"fill-extrusion-pattern":{source:ue,composite:ue}}[m]}(o);return h&&h[i]||a[t][i]}ct("ConstantBinder",bi),ct("CrossFadedConstantBinder",Di),ct("SourceExpressionBinder",ur),ct("CrossFadedCompositeBinder",Xr),ct("CompositeExpressionBinder",ar),ct("ProgramConfiguration",Kr,{omit:["_buffers"]}),ct("ProgramConfigurationSet",zn);const Rc=Math.pow(2,14)-1,Ih=-Rc-1;function Rn(o){const t=vt/o.extent,i=o.loadGeometry();for(let a=0;a<i.length;a++){const h=i[a];for(let m=0;m<h.length;m++){const g=h[m],v=Math.round(g.x*t),C=Math.round(g.y*t);g.x=Gr(v,Ih,Rc),g.y=Gr(C,Ih,Rc),(v<g.x||v>g.x+1||C<g.y||C>g.y+1)&&qr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function Wo(o,t){return{type:o.type,id:o.id,properties:o.properties,geometry:t?Rn(o):[]}}const Dc=-32768;function Eh(o,t,i,a,h){o.emplaceBack(Dc+8*t+a,Dc+8*i+h)}class al{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new re,this.indexArray=new Ke,this.segments=new yt,this.programConfigurations=new zn(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,a){const h=this.layers[0],m=[];let g=null,v=!1,C=h.type==="heatmap";if(h.type==="circle"){const M=h;g=M.layout.get("circle-sort-key"),v=!g.isConstant(),C=C||M.paint.get("circle-pitch-alignment")==="map"}const T=C?i.subdivisionGranularity.circle:1;for(const{feature:M,id:I,index:B,sourceLayerIndex:F}of t){const O=this.layers[0]._featureFilter.needGeometry,j=Wo(M,O);if(!this.layers[0]._featureFilter.filter(new vr(this.zoom),j,a))continue;const W=v?g.evaluate(j,{},a):void 0,ee={id:I,properties:M.properties,type:M.type,sourceLayerIndex:F,index:B,geometry:O?j.geometry:Rn(M),patterns:{},sortKey:W};m.push(ee)}v&&m.sort((M,I)=>M.sortKey-I.sortKey);for(const M of m){const{geometry:I,index:B,sourceLayerIndex:F}=M,O=t[B].feature;this.addFeature(M,I,B,a,T),i.featureIndex.insert(O,I,B,F,this.index)}}update(t,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ft),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,i,a,h,m=1){let g;switch(m){case 1:g=[0,7];break;case 3:g=[0,2,5,7];break;case 5:g=[0,1,3,4,6,7];break;case 7:g=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${m}; valid values are 1, 3, 5, 7.`)}const v=g.length;for(const C of i)for(const T of C){const M=T.x,I=T.y;if(M<0||M>=vt||I<0||I>=vt)continue;const B=this.segments.prepareSegment(v*v,this.layoutVertexArray,this.indexArray,t.sortKey),F=B.vertexLength;for(let O=0;O<v;O++)for(let j=0;j<v;j++)Eh(this.layoutVertexArray,M,I,g[j],g[O]);for(let O=0;O<v-1;O++)for(let j=0;j<v-1;j++){const W=F+O*v+j,ee=F+(O+1)*v+j;this.indexArray.emplaceBack(W,ee+1,W+1),this.indexArray.emplaceBack(W,ee,ee+1)}B.vertexLength+=v*v,B.primitiveLength+=(v-1)*(v-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,{},h)}}function ll(o,t){for(let i=0;i<o.length;i++)if(ul(t,o[i]))return!0;for(let i=0;i<t.length;i++)if(ul(o,t[i]))return!0;return!!df(o,t)}function Ah(o,t,i){return!!ul(o,t)||!!ff(t,o,i)}function cl(o,t){if(o.length===1)return pm(t,o[0]);for(let i=0;i<t.length;i++){const a=t[i];for(let h=0;h<a.length;h++)if(ul(o,a[h]))return!0}for(let i=0;i<o.length;i++)if(pm(t,o[i]))return!0;for(let i=0;i<t.length;i++)if(df(o,t[i]))return!0;return!1}function cv(o,t,i){if(o.length>1){if(df(o,t))return!0;for(let a=0;a<t.length;a++)if(ff(t[a],o,i))return!0}for(let a=0;a<o.length;a++)if(ff(o[a],t,i))return!0;return!1}function df(o,t){if(o.length===0||t.length===0)return!1;for(let i=0;i<o.length-1;i++){const a=o[i],h=o[i+1];for(let m=0;m<t.length-1;m++)if(uv(a,h,t[m],t[m+1]))return!0}return!1}function uv(o,t,i,a){return se(o,i,a)!==se(t,i,a)&&se(o,t,i)!==se(o,t,a)}function ff(o,t,i){const a=i*i;if(t.length===1)return o.distSqr(t[0])<a;for(let h=1;h<t.length;h++)if(fm(o,t[h-1],t[h])<a)return!0;return!1}function fm(o,t,i){const a=t.distSqr(i);if(a===0)return o.distSqr(t);const h=((o.x-t.x)*(i.x-t.x)+(o.y-t.y)*(i.y-t.y))/a;return o.distSqr(h<0?t:h>1?i:i.sub(t)._mult(h)._add(t))}function pm(o,t){let i,a,h,m=!1;for(let g=0;g<o.length;g++){i=o[g];for(let v=0,C=i.length-1;v<i.length;C=v++)a=i[v],h=i[C],a.y>t.y!=h.y>t.y&&t.x<(h.x-a.x)*(t.y-a.y)/(h.y-a.y)+a.x&&(m=!m)}return m}function ul(o,t){let i=!1;for(let a=0,h=o.length-1;a<o.length;h=a++){const m=o[a],g=o[h];m.y>t.y!=g.y>t.y&&t.x<(g.x-m.x)*(t.y-m.y)/(g.y-m.y)+m.x&&(i=!i)}return i}function hv(o,t,i){const a=i[0],h=i[2];if(o.x<a.x&&t.x<a.x||o.x>h.x&&t.x>h.x||o.y<a.y&&t.y<a.y||o.y>h.y&&t.y>h.y)return!1;const m=se(o,t,i[0]);return m!==se(o,t,i[1])||m!==se(o,t,i[2])||m!==se(o,t,i[3])}function Bc(o,t,i){const a=t.paint.get(o).value;return a.kind==="constant"?a.value:i.programConfigurations.get(t.id).getMaxValue(o)}function zh(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function Rh(o,t,i,a,h){if(!t[0]&&!t[1])return o;const m=fe.convert(t)._mult(h);i==="viewport"&&m._rotate(-a);const g=[];for(let v=0;v<o.length;v++)g.push(o[v].sub(m));return g}let mm,gm;ct("CircleBucket",al,{omit:["layers"]});var dv={get paint(){return gm=gm||new Lo({"circle-radius":new Tt(A.paint_circle["circle-radius"]),"circle-color":new Tt(A.paint_circle["circle-color"]),"circle-blur":new Tt(A.paint_circle["circle-blur"]),"circle-opacity":new Tt(A.paint_circle["circle-opacity"]),"circle-translate":new _t(A.paint_circle["circle-translate"]),"circle-translate-anchor":new _t(A.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new _t(A.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new _t(A.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Tt(A.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Tt(A.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Tt(A.paint_circle["circle-stroke-opacity"])})},get layout(){return mm=mm||new Lo({"circle-sort-key":new Tt(A.layout_circle["circle-sort-key"])})}};class fv extends Ei{constructor(t){super(t,dv)}createBucket(t){return new al(t)}queryRadius(t){const i=t;return Bc("circle-radius",this,i)+Bc("circle-stroke-width",this,i)+zh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:i,featureState:a,geometry:h,transform:m,pixelsToTileUnits:g,pixelPosMatrix:v}){const C=Rh(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-m.bearingInRadians,g),T=this.paint.get("circle-radius").evaluate(i,a)+this.paint.get("circle-stroke-width").evaluate(i,a),M=this.paint.get("circle-pitch-alignment")==="map",I=M?C:function(F,O){return F.map(j=>_m(j,O))}(C,v),B=M?T*g:T;for(const F of h)for(const O of F){const j=M?O:_m(O,v);let W=B;const ee=ot([],[O.x,O.y,0,1],v);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?W*=ee[3]/m.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(W*=m.cameraToCenterDistance/ee[3]),Ah(I,j,W))return!0}return!1}}function _m(o,t){const i=ot([],[o.x,o.y,0,1],t);return new fe(i[0]/i[3],i[1]/i[3])}class ym extends al{}let vm;ct("HeatmapBucket",ym,{omit:["layers"]});var pv={get paint(){return vm=vm||new Lo({"heatmap-radius":new Tt(A.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Tt(A.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new _t(A.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mc(A.paint_heatmap["heatmap-color"]),"heatmap-opacity":new _t(A.paint_heatmap["heatmap-opacity"])})}};function pf(o,{width:t,height:i},a,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*i*a)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*i*a}`)}else h=new Uint8Array(t*i*a);return o.width=t,o.height=i,o.data=h,o}function bm(o,{width:t,height:i},a){if(t===o.width&&i===o.height)return;const h=pf({},{width:t,height:i},a);mf(o,h,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,t),height:Math.min(o.height,i)},a),o.width=t,o.height=i,o.data=h.data}function mf(o,t,i,a,h,m){if(h.width===0||h.height===0)return t;if(h.width>o.width||h.height>o.height||i.x>o.width-h.width||i.y>o.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||a.x>t.width-h.width||a.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const g=o.data,v=t.data;if(g===v)throw new Error("srcData equals dstData, so image is already copied");for(let C=0;C<h.height;C++){const T=((i.y+C)*o.width+i.x)*m,M=((a.y+C)*t.width+a.x)*m;for(let I=0;I<h.width*m;I++)v[M+I]=g[T+I]}return t}class Lc{constructor(t,i){pf(this,t,1,i)}resize(t){bm(this,t,1)}clone(){return new Lc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,a,h,m){mf(t,i,a,h,m,1)}}class xi{constructor(t,i){pf(this,t,4,i)}resize(t){bm(this,t,4)}replace(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new xi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,a,h,m){mf(t,i,a,h,m,4)}}function xm(o){const t={},i=o.resolution||256,a=o.clips?o.clips.length:1,h=o.image||new xi({width:i,height:a});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const m=(g,v,C)=>{t[o.evaluationKey]=C;const T=o.expression.evaluate(t);h.data[g+v+0]=Math.floor(255*T.r/T.a),h.data[g+v+1]=Math.floor(255*T.g/T.a),h.data[g+v+2]=Math.floor(255*T.b/T.a),h.data[g+v+3]=Math.floor(255*T.a)};if(o.clips)for(let g=0,v=0;g<a;++g,v+=4*i)for(let C=0,T=0;C<i;C++,T+=4){const M=C/(i-1),{start:I,end:B}=o.clips[g];m(v,T,I*(1-M)+B*M)}else for(let g=0,v=0;g<i;g++,v+=4)m(0,v,g/(i-1));return h}ct("AlphaImage",Lc),ct("RGBAImage",xi);const gf="big-fb";class mv extends Ei{createBucket(t){return new ym(t)}constructor(t){super(t,pv),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=xm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(gf)&&this.heatmapFbos.delete(gf)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let wm;var gv={get paint(){return wm=wm||new Lo({"hillshade-illumination-direction":new _t(A.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new _t(A.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new _t(A.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new _t(A.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new _t(A.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new _t(A.paint_hillshade["hillshade-accent-color"])})}};class _v extends Ei{constructor(t){super(t,gv)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const yv=Or([{name:"a_pos",components:2,type:"Int16"}],4),{members:vv}=yv;function _f(o,t,i){const a=i.patternDependencies;let h=!1;for(const m of t){const g=m.paint.get(`${o}-pattern`);g.isConstant()||(h=!0);const v=g.constantOr(null);v&&(h=!0,a[v.to]=!0,a[v.from]=!0)}return h}function yf(o,t,i,a,h){const m=h.patternDependencies;for(const g of t){const v=g.paint.get(`${o}-pattern`).value;if(v.kind!=="constant"){let C=v.evaluate({zoom:a-1},i,{},h.availableImages),T=v.evaluate({zoom:a},i,{},h.availableImages),M=v.evaluate({zoom:a+1},i,{},h.availableImages);C=C&&C.name?C.name:C,T=T&&T.name?T.name:T,M=M&&M.name?M.name:M,m[C]=!0,m[T]=!0,m[M]=!0,i.patterns[g.id]={min:C,mid:T,max:M}}}return i}function Cm(o,t,i,a,h){let m;if(h===function(g,v,C,T){let M=0;for(let I=v,B=C-T;I<C;I+=T)M+=(g[B]-g[I])*(g[I+1]+g[B+1]),B=I;return M}(o,t,i,a)>0)for(let g=t;g<i;g+=a)m=Pm(g/a|0,o[g],o[g+1],m);else for(let g=i-a;g>=t;g-=a)m=Pm(g/a|0,o[g],o[g+1],m);return m&&hl(m,m.next)&&(jc(m),m=m.next),m}function Js(o,t){if(!o)return o;t||(t=o);let i,a=o;do if(i=!1,a.steiner||!hl(a,a.next)&&$r(a.prev,a,a.next)!==0)a=a.next;else{if(jc(a),a=t=a.prev,a===a.next)break;i=!0}while(i||a!==t);return t}function Fc(o,t,i,a,h,m,g){if(!o)return;!g&&m&&function(C,T,M,I){let B=C;do B.z===0&&(B.z=vf(B.x,B.y,T,M,I)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==C);B.prevZ.nextZ=null,B.prevZ=null,function(F){let O,j=1;do{let W,ee=F;F=null;let he=null;for(O=0;ee;){O++;let oe=ee,L=0;for(let ie=0;ie<j&&(L++,oe=oe.nextZ,oe);ie++);let q=j;for(;L>0||q>0&&oe;)L!==0&&(q===0||!oe||ee.z<=oe.z)?(W=ee,ee=ee.nextZ,L--):(W=oe,oe=oe.nextZ,q--),he?he.nextZ=W:F=W,W.prevZ=he,he=W;ee=oe}he.nextZ=null,j*=2}while(O>1)}(B)}(o,a,h,m);let v=o;for(;o.prev!==o.next;){const C=o.prev,T=o.next;if(m?xv(o,a,h,m):bv(o))t.push(C.i,o.i,T.i),jc(o),o=T.next,v=T.next;else if((o=T)===v){g?g===1?Fc(o=wv(Js(o),t),t,i,a,h,m,2):g===2&&Cv(o,t,i,a,h,m):Fc(Js(o),t,i,a,h,m,1);break}}}function bv(o){const t=o.prev,i=o,a=o.next;if($r(t,i,a)>=0)return!1;const h=t.x,m=i.x,g=a.x,v=t.y,C=i.y,T=a.y,M=Math.min(h,m,g),I=Math.min(v,C,T),B=Math.max(h,m,g),F=Math.max(v,C,T);let O=a.next;for(;O!==t;){if(O.x>=M&&O.x<=B&&O.y>=I&&O.y<=F&&Oc(h,v,m,C,g,T,O.x,O.y)&&$r(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function xv(o,t,i,a){const h=o.prev,m=o,g=o.next;if($r(h,m,g)>=0)return!1;const v=h.x,C=m.x,T=g.x,M=h.y,I=m.y,B=g.y,F=Math.min(v,C,T),O=Math.min(M,I,B),j=Math.max(v,C,T),W=Math.max(M,I,B),ee=vf(F,O,t,i,a),he=vf(j,W,t,i,a);let oe=o.prevZ,L=o.nextZ;for(;oe&&oe.z>=ee&&L&&L.z<=he;){if(oe.x>=F&&oe.x<=j&&oe.y>=O&&oe.y<=W&&oe!==h&&oe!==g&&Oc(v,M,C,I,T,B,oe.x,oe.y)&&$r(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,L.x>=F&&L.x<=j&&L.y>=O&&L.y<=W&&L!==h&&L!==g&&Oc(v,M,C,I,T,B,L.x,L.y)&&$r(L.prev,L,L.next)>=0))return!1;L=L.nextZ}for(;oe&&oe.z>=ee;){if(oe.x>=F&&oe.x<=j&&oe.y>=O&&oe.y<=W&&oe!==h&&oe!==g&&Oc(v,M,C,I,T,B,oe.x,oe.y)&&$r(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;L&&L.z<=he;){if(L.x>=F&&L.x<=j&&L.y>=O&&L.y<=W&&L!==h&&L!==g&&Oc(v,M,C,I,T,B,L.x,L.y)&&$r(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function wv(o,t){let i=o;do{const a=i.prev,h=i.next.next;!hl(a,h)&&Tm(a,i,i.next,h)&&$c(a,h)&&$c(h,a)&&(t.push(a.i,i.i,h.i),jc(i),jc(i.next),i=o=h),i=i.next}while(i!==o);return Js(i)}function Cv(o,t,i,a,h,m){let g=o;do{let v=g.next.next;for(;v!==g.prev;){if(g.i!==v.i&&Mv(g,v)){let C=km(g,v);return g=Js(g,g.next),C=Js(C,C.next),Fc(g,t,i,a,h,m,0),void Fc(C,t,i,a,h,m,0)}v=v.next}g=g.next}while(g!==o)}function Sv(o,t){let i=o.x-t.x;return i===0&&(i=o.y-t.y,i===0)&&(i=(o.next.y-o.y)/(o.next.x-o.x)-(t.next.y-t.y)/(t.next.x-t.x)),i}function Tv(o,t){const i=function(h,m){let g=m;const v=h.x,C=h.y;let T,M=-1/0;if(hl(h,g))return g;do{if(hl(h,g.next))return g.next;if(C<=g.y&&C>=g.next.y&&g.next.y!==g.y){const j=g.x+(C-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(j<=v&&j>M&&(M=j,T=g.x<g.next.x?g:g.next,j===v))return T}g=g.next}while(g!==m);if(!T)return null;const I=T,B=T.x,F=T.y;let O=1/0;g=T;do{if(v>=g.x&&g.x>=B&&v!==g.x&&Sm(C<F?v:M,C,B,F,C<F?M:v,C,g.x,g.y)){const j=Math.abs(C-g.y)/(v-g.x);$c(g,h)&&(j<O||j===O&&(g.x>T.x||g.x===T.x&&kv(T,g)))&&(T=g,O=j)}g=g.next}while(g!==I);return T}(o,t);if(!i)return t;const a=km(i,o);return Js(a,a.next),Js(i,i.next)}function kv(o,t){return $r(o.prev,o,t.prev)<0&&$r(t.next,o,o.next)<0}function vf(o,t,i,a,h){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-i)*h|0)|o<<8))|o<<4))|o<<2))|o<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-a)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Pv(o){let t=o,i=o;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==o);return i}function Sm(o,t,i,a,h,m,g,v){return(h-g)*(t-v)>=(o-g)*(m-v)&&(o-g)*(a-v)>=(i-g)*(t-v)&&(i-g)*(m-v)>=(h-g)*(a-v)}function Oc(o,t,i,a,h,m,g,v){return!(o===g&&t===v)&&Sm(o,t,i,a,h,m,g,v)}function Mv(o,t){return o.next.i!==t.i&&o.prev.i!==t.i&&!function(i,a){let h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==a.i&&h.next.i!==a.i&&Tm(h,h.next,i,a))return!0;h=h.next}while(h!==i);return!1}(o,t)&&($c(o,t)&&$c(t,o)&&function(i,a){let h=i,m=!1;const g=(i.x+a.x)/2,v=(i.y+a.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&g<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==i);return m}(o,t)&&($r(o.prev,o,t.prev)||$r(o,t.prev,t))||hl(o,t)&&$r(o.prev,o,o.next)>0&&$r(t.prev,t,t.next)>0)}function $r(o,t,i){return(t.y-o.y)*(i.x-t.x)-(t.x-o.x)*(i.y-t.y)}function hl(o,t){return o.x===t.x&&o.y===t.y}function Tm(o,t,i,a){const h=Bh($r(o,t,i)),m=Bh($r(o,t,a)),g=Bh($r(i,a,o)),v=Bh($r(i,a,t));return h!==m&&g!==v||!(h!==0||!Dh(o,i,t))||!(m!==0||!Dh(o,a,t))||!(g!==0||!Dh(i,o,a))||!(v!==0||!Dh(i,t,a))}function Dh(o,t,i){return t.x<=Math.max(o.x,i.x)&&t.x>=Math.min(o.x,i.x)&&t.y<=Math.max(o.y,i.y)&&t.y>=Math.min(o.y,i.y)}function Bh(o){return o>0?1:o<0?-1:0}function $c(o,t){return $r(o.prev,o,o.next)<0?$r(o,t,o.next)>=0&&$r(o,o.prev,t)>=0:$r(o,t,o.prev)<0||$r(o,o.next,t)<0}function km(o,t){const i=bf(o.i,o.x,o.y),a=bf(t.i,t.x,t.y),h=o.next,m=t.prev;return o.next=t,t.prev=o,i.next=h,h.prev=i,a.next=i,i.prev=a,m.next=a,a.prev=m,a}function Pm(o,t,i,a){const h=bf(o,t,i);return a?(h.next=a.next,h.prev=a,a.next.prev=h,a.next=h):(h.prev=h,h.next=h),h}function jc(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function bf(o,t,i){return{i:o,x:t,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class dl{constructor(t,i){if(i>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=i}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Lh{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Lh.noSubdivision=new Lh({fill:new dl(0,0),line:new dl(0,0),tile:new dl(0,0),stencil:new dl(0,0),circle:1}),ct("SubdivisionGranularityExpression",dl),ct("SubdivisionGranularitySetting",Lh);const fl=-32768,Nc=32767;class Iv{constructor(t,i){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=vt/t,this._canonical=i}_getKey(t,i){return(t+=32768)<<16|(i+=32768)<<0}_vertexToIndex(t,i){if(t<-32768||i<-32768||t>32767||i>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const a=0|Math.round(t),h=0|Math.round(i),m=this._getKey(a,h);if(this._vertexDictionary.has(m))return this._vertexDictionary.get(m);const g=this._vertexBuffer.length/2;return this._vertexDictionary.set(m,g),this._vertexBuffer.push(a,h),g}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(h,m){const g=[];for(let v=0;v<m.length;v+=3){const C=m[v],T=m[v+1],M=m[v+2],I=h[2*C],B=h[2*C+1];(h[2*T]-I)*(h[2*M+1]-B)-(h[2*T+1]-B)*(h[2*M]-I)>0?(g.push(C),g.push(M),g.push(T)):(g.push(C),g.push(T),g.push(M))}return g}(this._vertexBuffer,t);const i=[],a=t.length;for(let h=0;h<a;h+=3){const m=[t[h+0],t[h+1],t[h+2]],g=[this._vertexBuffer[2*t[h+0]+0],this._vertexBuffer[2*t[h+0]+1],this._vertexBuffer[2*t[h+1]+0],this._vertexBuffer[2*t[h+1]+1],this._vertexBuffer[2*t[h+2]+0],this._vertexBuffer[2*t[h+2]+1]];let v=1/0,C=1/0,T=-1/0,M=-1/0;for(let j=0;j<3;j++){const W=g[2*j],ee=g[2*j+1];v=Math.min(v,W),T=Math.max(T,W),C=Math.min(C,ee),M=Math.max(M,ee)}if(v===T||C===M)continue;const I=Math.floor(v/this._granularityCellSize),B=Math.ceil(T/this._granularityCellSize),F=Math.floor(C/this._granularityCellSize),O=Math.ceil(M/this._granularityCellSize);if(I!==B||F!==O)for(let j=F;j<O;j++){const W=this._scanlineGenerateVertexRingForCellRow(j,g,m);Ev(this._vertexBuffer,W,i)}else i.push(...m)}return i}_scanlineGenerateVertexRingForCellRow(t,i,a){const h=t*this._granularityCellSize,m=h+this._granularityCellSize,g=[];for(let v=0;v<3;v++){const C=i[2*v],T=i[2*v+1],M=i[2*(v+1)%6],I=i[(2*(v+1)+1)%6],B=i[2*(v+2)%6],F=i[(2*(v+2)+1)%6],O=M-C,j=I-T,W=O===0,ee=j===0,he=(h-T)/j,oe=(m-T)/j,L=Math.min(he,oe),q=Math.max(he,oe);if(!ee&&(L>=1||q<=0)||ee&&(T<h||T>m)){I>=h&&I<=m&&g.push(a[(v+1)%3]);continue}!ee&&L>0&&g.push(this._vertexToIndex(C+O*L,T+j*L));const ie=C+O*Math.max(L,0),we=C+O*Math.min(q,1);W||this._generateIntraEdgeVertices(g,C,T,M,I,ie,we),!ee&&q<1&&g.push(this._vertexToIndex(C+O*q,T+j*q)),(ee||I>=h&&I<=m)&&g.push(a[(v+1)%3]),!ee&&(I<=h||I>=m)&&this._generateInterEdgeVertices(g,C,T,M,I,B,F,we,h,m)}return g}_generateIntraEdgeVertices(t,i,a,h,m,g,v){const C=h-i,T=m-a,M=T===0,I=M?Math.min(i,h):Math.min(g,v),B=M?Math.max(i,h):Math.max(g,v),F=Math.floor(I/this._granularityCellSize)+1,O=Math.ceil(B/this._granularityCellSize)-1;if(M?i<h:g<v)for(let j=F;j<=O;j++){const W=j*this._granularityCellSize;t.push(this._vertexToIndex(W,a+T*(W-i)/C))}else for(let j=O;j>=F;j--){const W=j*this._granularityCellSize;t.push(this._vertexToIndex(W,a+T*(W-i)/C))}}_generateInterEdgeVertices(t,i,a,h,m,g,v,C,T,M){const I=m-a,B=g-h,F=v-m,O=(T-m)/F,j=(M-m)/F,W=Math.min(O,j),ee=Math.max(O,j),he=h+B*W;let oe=Math.floor(Math.min(he,C)/this._granularityCellSize)+1,L=Math.ceil(Math.max(he,C)/this._granularityCellSize)-1,q=C<he;const ie=F===0;if(ie&&(v===T||v===M))return;if(ie||W>=1||ee<=0){const Oe=a-v,Te=g+(i-g)*Math.min((T-v)/Oe,(M-v)/Oe);oe=Math.floor(Math.min(Te,C)/this._granularityCellSize)+1,L=Math.ceil(Math.max(Te,C)/this._granularityCellSize)-1,q=C<Te}const we=I>0?M:T;if(q)for(let Oe=oe;Oe<=L;Oe++)t.push(this._vertexToIndex(Oe*this._granularityCellSize,we));else for(let Oe=L;Oe>=oe;Oe--)t.push(this._vertexToIndex(Oe*this._granularityCellSize,we))}_generateOutline(t){const i=[];for(const a of t){const h=Qs(a,this._granularity,!0),m=this._pointArrayToIndices(h),g=[];for(let v=1;v<m.length;v++)g.push(m[v-1]),g.push(m[v]);i.push(g)}return i}_handlePoles(t){let i=!1,a=!1;this._canonical&&(this._canonical.y===0&&(i=!0),this._canonical.y===(1<<this._canonical.z)-1&&(a=!0)),(i||a)&&this._fillPoles(t,i,a)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let i=0;i<t.length;i+=2){const a=t[i+1];a===fl&&(t[i+1]=-32767),a===Nc&&(t[i+1]=32766)}}_generatePoleQuad(t,i,a,h,m,g){h>m!=(g===fl)?(t.push(i),t.push(a),t.push(this._vertexToIndex(h,g)),t.push(a),t.push(this._vertexToIndex(m,g)),t.push(this._vertexToIndex(h,g))):(t.push(a),t.push(i),t.push(this._vertexToIndex(h,g)),t.push(this._vertexToIndex(m,g)),t.push(a),t.push(this._vertexToIndex(h,g)))}_fillPoles(t,i,a){const h=this._vertexBuffer,m=vt,g=t.length;for(let v=2;v<g;v+=3){const C=t[v-2],T=t[v-1],M=t[v],I=h[2*C],B=h[2*C+1],F=h[2*T],O=h[2*T+1],j=h[2*M],W=h[2*M+1];i&&(B===0&&O===0&&this._generatePoleQuad(t,C,T,I,F,fl),O===0&&W===0&&this._generatePoleQuad(t,T,M,F,j,fl),W===0&&B===0&&this._generatePoleQuad(t,M,C,j,I,fl)),a&&(B===m&&O===m&&this._generatePoleQuad(t,C,T,I,F,Nc),O===m&&W===m&&this._generatePoleQuad(t,T,M,F,j,Nc),W===m&&B===m&&this._generatePoleQuad(t,M,C,j,I,Nc))}}_initializeVertices(t){for(let i=0;i<t.length;i+=2)this._vertexToIndex(t[i],t[i+1])}subdividePolygonInternal(t,i){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:a,holeIndices:h}=function(v){const C=[],T=[];for(const M of v)if(M.length!==0){M!==v[0]&&C.push(T.length/2);for(let I=0;I<M.length;I++)T.push(M[I].x),T.push(M[I].y)}return{flattened:T,holeIndices:C}}(t);let m;this._initializeVertices(a);try{const v=function(T,M,I=2){const B=M&&M.length,F=B?M[0]*I:T.length;let O=Cm(T,0,F,I,!0);const j=[];if(!O||O.next===O.prev)return j;let W,ee,he;if(B&&(O=function(oe,L,q,ie){const we=[];for(let Oe=0,Te=L.length;Oe<Te;Oe++){const Me=Cm(oe,L[Oe]*ie,Oe<Te-1?L[Oe+1]*ie:oe.length,ie,!1);Me===Me.next&&(Me.steiner=!0),we.push(Pv(Me))}we.sort(Sv);for(let Oe=0;Oe<we.length;Oe++)q=Tv(we[Oe],q);return q}(T,M,O,I)),T.length>80*I){W=1/0,ee=1/0;let oe=-1/0,L=-1/0;for(let q=I;q<F;q+=I){const ie=T[q],we=T[q+1];ie<W&&(W=ie),we<ee&&(ee=we),ie>oe&&(oe=ie),we>L&&(L=we)}he=Math.max(oe-W,L-ee),he=he!==0?32767/he:0}return Fc(O,j,I,W,ee,he,0),j}(a,h),C=this._convertIndices(a,v);m=this._subdivideTrianglesScanline(C)}catch(v){console.error(v)}let g=[];return i&&(g=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(m),{verticesFlattened:this._vertexBuffer,indicesTriangles:m,indicesLineList:g}}_convertIndices(t,i){const a=[];for(let h=0;h<i.length;h++)a.push(this._vertexToIndex(t[2*i[h]],t[2*i[h]+1]));return a}_pointArrayToIndices(t){const i=[];for(let a=0;a<t.length;a++){const h=t[a];i.push(this._vertexToIndex(h.x,h.y))}return i}}function Mm(o,t,i,a=!0){return new Iv(i,t).subdividePolygonInternal(o,a)}function Qs(o,t,i=!1){if(!o||o.length<1)return[];if(o.length<2)return[];const a=o[0],h=o[o.length-1],m=i&&(a.x!==h.x||a.y!==h.y);if(t<2)return m?[...o,o[0]]:[...o];const g=Math.floor(vt/t),v=[];v.push(new fe(o[0].x,o[0].y));const C=o.length,T=m?C:C-1;for(let M=0;M<T;M++){const I=o[M],B=M<C-1?o[M+1]:o[0],F=I.x,O=I.y,j=B.x,W=B.y,ee=F!==j,he=O!==W;if(!ee&&!he)continue;const oe=j-F,L=W-O,q=Math.abs(oe),ie=Math.abs(L);let we=F,Oe=O;for(;;){const Me=oe>0?(Math.floor(we/g)+1)*g:(Math.ceil(we/g)-1)*g,Ze=L>0?(Math.floor(Oe/g)+1)*g:(Math.ceil(Oe/g)-1)*g,je=Math.abs(we-Me),qe=Math.abs(Oe-Ze),De=Math.abs(we-j),ut=Math.abs(Oe-W),Ct=ee?je/q:Number.POSITIVE_INFINITY,wt=he?qe/ie:Number.POSITIVE_INFINITY;if((De<=je||!ee)&&(ut<=qe||!he))break;if(Ct<wt&&ee||!he){we=Me,Oe+=L*Ct;const pt=new fe(we,Math.round(Oe));v[v.length-1].x===pt.x&&v[v.length-1].y===pt.y||v.push(pt)}else{we+=oe*wt,Oe=Ze;const pt=new fe(Math.round(we),Oe);v[v.length-1].x===pt.x&&v[v.length-1].y===pt.y||v.push(pt)}}const Te=new fe(j,W);v[v.length-1].x===Te.x&&v[v.length-1].y===Te.y||v.push(Te)}return v}function Ev(o,t,i){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let a=0,h=o[2*t[0]];for(let C=1;C<t.length;C++){const T=o[2*t[C]];T<h&&(h=T,a=C)}const m=t.length;let g=a,v=(g+1)%m;for(;;){const C=g-1>=0?g-1:m-1,T=(v+1)%m,M=o[2*t[C]],I=o[2*t[T]],B=o[2*t[g]],F=o[2*t[g]+1],O=o[2*t[v]+1];let j=!1;if(M<I)j=!0;else if(M>I)j=!1;else{const W=O-F,ee=-(o[2*t[v]]-B),he=F<O?1:-1;((M-B)*W+(o[2*t[C]+1]-F)*ee)*he>((I-B)*W+(o[2*t[T]+1]-F)*ee)*he&&(j=!0)}if(j){const W=t[C],ee=t[g],he=t[v];W!==ee&&W!==he&&ee!==he&&i.push(he,ee,W),g--,g<0&&(g=m-1)}else{const W=t[T],ee=t[g],he=t[v];W!==ee&&W!==he&&ee!==he&&i.push(he,ee,W),v++,v>=m&&(v=0)}if(C===T)break}}function Im(o,t,i,a,h,m,g,v,C){const T=h.length/2,M=g&&v&&C;if(T<yt.MAX_VERTEX_ARRAY_LENGTH){const I=t.prepareSegment(T,i,a),B=I.vertexLength;for(let j=0;j<m.length;j+=3)a.emplaceBack(B+m[j],B+m[j+1],B+m[j+2]);let F,O;I.vertexLength+=T,I.primitiveLength+=m.length/3,M&&(O=g.prepareSegment(T,i,v),F=O.vertexLength,O.vertexLength+=T);for(let j=0;j<h.length;j+=2)o(h[j],h[j+1]);if(M)for(let j=0;j<C.length;j++){const W=C[j];for(let ee=1;ee<W.length;ee+=2)v.emplaceBack(F+W[ee-1],F+W[ee]);O.primitiveLength+=W.length/2}}else(function(I,B,F,O,j,W){const ee=[];for(let ie=0;ie<O.length/2;ie++)ee.push(-1);const he={count:0};let oe=0,L=I.getOrCreateLatestSegment(B,F),q=L.vertexLength;for(let ie=2;ie<j.length;ie+=3){const we=j[ie-2],Oe=j[ie-1],Te=j[ie];let Me=ee[we]<oe,Ze=ee[Oe]<oe,je=ee[Te]<oe;L.vertexLength+((Me?1:0)+(Ze?1:0)+(je?1:0))>yt.MAX_VERTEX_ARRAY_LENGTH&&(L=I.createNewSegment(B,F),oe=he.count,Me=!0,Ze=!0,je=!0,q=0);const qe=Vc(ee,O,W,he,we,Me,L),De=Vc(ee,O,W,he,Oe,Ze,L),ut=Vc(ee,O,W,he,Te,je,L);F.emplaceBack(q+qe-oe,q+De-oe,q+ut-oe),L.primitiveLength++}})(t,i,a,h,m,o),M&&function(I,B,F,O,j,W){const ee=[];for(let ie=0;ie<O.length/2;ie++)ee.push(-1);const he={count:0};let oe=0,L=I.getOrCreateLatestSegment(B,F),q=L.vertexLength;for(let ie=0;ie<j.length;ie++){const we=j[ie];for(let Oe=1;Oe<j[ie].length;Oe+=2){const Te=we[Oe-1],Me=we[Oe];let Ze=ee[Te]<oe,je=ee[Me]<oe;L.vertexLength+((Ze?1:0)+(je?1:0))>yt.MAX_VERTEX_ARRAY_LENGTH&&(L=I.createNewSegment(B,F),oe=he.count,Ze=!0,je=!0,q=0);const qe=Vc(ee,O,W,he,Te,Ze,L),De=Vc(ee,O,W,he,Me,je,L);F.emplaceBack(q+qe-oe,q+De-oe),L.primitiveLength++}}}(g,i,v,h,C,o),t.forceNewSegmentOnNextPrepare(),g==null||g.forceNewSegmentOnNextPrepare()}function Vc(o,t,i,a,h,m,g){if(m){const v=a.count;return i(t[2*h],t[2*h+1]),o[h]=a.count,a.count++,g.vertexLength++,v}return o[h]}class xf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ne,this.indexArray=new Ke,this.indexArray2=new He,this.programConfigurations=new zn(t.layers,t.zoom),this.segments=new yt,this.segments2=new yt,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,a){this.hasPattern=_f("fill",this.layers,i);const h=this.layers[0].layout.get("fill-sort-key"),m=!h.isConstant(),g=[];for(const{feature:v,id:C,index:T,sourceLayerIndex:M}of t){const I=this.layers[0]._featureFilter.needGeometry,B=Wo(v,I);if(!this.layers[0]._featureFilter.filter(new vr(this.zoom),B,a))continue;const F=m?h.evaluate(B,{},a,i.availableImages):void 0,O={id:C,properties:v.properties,type:v.type,sourceLayerIndex:M,index:T,geometry:I?B.geometry:Rn(v),patterns:{},sortKey:F};g.push(O)}m&&g.sort((v,C)=>v.sortKey-C.sortKey);for(const v of g){const{geometry:C,index:T,sourceLayerIndex:M}=v;if(this.hasPattern){const I=yf("fill",this.layers,v,this.zoom,i);this.patternFeatures.push(I)}else this.addFeature(v,C,T,a,{},i.subdivisionGranularity);i.featureIndex.insert(t[T].feature,C,T,M,this.index)}}update(t,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,a)}addFeatures(t,i,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,i,a,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,vv),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,i,a,h,m,g){for(const v of Ea(i,500)){const C=Mm(v,h,g.fill.getGranularityForZoomLevel(h.z)),T=this.layoutVertexArray;Im((M,I)=>{T.emplaceBack(M,I)},this.segments,this.layoutVertexArray,this.indexArray,C.verticesFlattened,C.indicesTriangles,this.segments2,this.indexArray2,C.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,m,h)}}let Em,Am;ct("FillBucket",xf,{omit:["layers","patternFeatures"]});var Av={get paint(){return Am=Am||new Lo({"fill-antialias":new _t(A.paint_fill["fill-antialias"]),"fill-opacity":new Tt(A.paint_fill["fill-opacity"]),"fill-color":new Tt(A.paint_fill["fill-color"]),"fill-outline-color":new Tt(A.paint_fill["fill-outline-color"]),"fill-translate":new _t(A.paint_fill["fill-translate"]),"fill-translate-anchor":new _t(A.paint_fill["fill-translate-anchor"]),"fill-pattern":new Xs(A.paint_fill["fill-pattern"])})},get layout(){return Em=Em||new Lo({"fill-sort-key":new Tt(A.layout_fill["fill-sort-key"])})}};class zv extends Ei{constructor(t){super(t,Av)}recalculate(t,i){super.recalculate(t,i);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new xf(t)}queryRadius(){return zh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:i,transform:a,pixelsToTileUnits:h}){return cl(Rh(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-a.bearingInRadians,h),i)}isTileClipped(){return!0}}const Rv=Or([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Dv=Or([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Bv}=Rv;var wf,zm,Cf,Rm,Sf,Dm,Bm,Fh={};function Lm(){if(zm)return wf;zm=1;var o=H();function t(h,m,g,v,C){this.properties={},this.extent=g,this.type=0,this._pbf=h,this._geometry=-1,this._keys=v,this._values=C,h.readFields(i,this,m)}function i(h,m,g){h==1?m.id=g.readVarint():h==2?function(v,C){for(var T=v.readVarint()+v.pos;v.pos<T;){var M=C._keys[v.readVarint()],I=C._values[v.readVarint()];C.properties[M]=I}}(g,m):h==3?m.type=g.readVarint():h==4&&(m._geometry=g.pos)}function a(h){for(var m,g,v=0,C=0,T=h.length,M=T-1;C<T;M=C++)v+=((g=h[M]).x-(m=h[C]).x)*(m.y+g.y);return v}return wf=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var h=this._pbf;h.pos=this._geometry;for(var m,g=h.readVarint()+h.pos,v=1,C=0,T=0,M=0,I=[];h.pos<g;){if(C<=0){var B=h.readVarint();v=7&B,C=B>>3}if(C--,v===1||v===2)T+=h.readSVarint(),M+=h.readSVarint(),v===1&&(m&&I.push(m),m=[]),m.push(new o(T,M));else{if(v!==7)throw new Error("unknown command "+v);m&&m.push(m[0].clone())}}return m&&I.push(m),I},t.prototype.bbox=function(){var h=this._pbf;h.pos=this._geometry;for(var m=h.readVarint()+h.pos,g=1,v=0,C=0,T=0,M=1/0,I=-1/0,B=1/0,F=-1/0;h.pos<m;){if(v<=0){var O=h.readVarint();g=7&O,v=O>>3}if(v--,g===1||g===2)(C+=h.readSVarint())<M&&(M=C),C>I&&(I=C),(T+=h.readSVarint())<B&&(B=T),T>F&&(F=T);else if(g!==7)throw new Error("unknown command "+g)}return[M,B,I,F]},t.prototype.toGeoJSON=function(h,m,g){var v,C,T=this.extent*Math.pow(2,g),M=this.extent*h,I=this.extent*m,B=this.loadGeometry(),F=t.types[this.type];function O(ee){for(var he=0;he<ee.length;he++){var oe=ee[he];ee[he]=[360*(oe.x+M)/T-180,360/Math.PI*Math.atan(Math.exp((180-360*(oe.y+I)/T)*Math.PI/180))-90]}}switch(this.type){case 1:var j=[];for(v=0;v<B.length;v++)j[v]=B[v][0];O(B=j);break;case 2:for(v=0;v<B.length;v++)O(B[v]);break;case 3:for(B=function(ee){var he=ee.length;if(he<=1)return[ee];for(var oe,L,q=[],ie=0;ie<he;ie++){var we=a(ee[ie]);we!==0&&(L===void 0&&(L=we<0),L===we<0?(oe&&q.push(oe),oe=[ee[ie]]):oe.push(ee[ie]))}return oe&&q.push(oe),q}(B),v=0;v<B.length;v++)for(C=0;C<B[v].length;C++)O(B[v][C])}B.length===1?B=B[0]:F="Multi"+F;var W={type:"Feature",geometry:{type:F,coordinates:B},properties:this.properties};return"id"in this&&(W.id=this.id),W},wf}function Fm(){if(Rm)return Cf;Rm=1;var o=Lm();function t(a,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(i,this,h),this.length=this._features.length}function i(a,h,m){a===15?h.version=m.readVarint():a===1?h.name=m.readString():a===5?h.extent=m.readVarint():a===2?h._features.push(m.pos):a===3?h._keys.push(m.readString()):a===4&&h._values.push(function(g){for(var v=null,C=g.readVarint()+g.pos;g.pos<C;){var T=g.readVarint()>>3;v=T===1?g.readString():T===2?g.readFloat():T===3?g.readDouble():T===4?g.readVarint64():T===5?g.readVarint():T===6?g.readSVarint():T===7?g.readBoolean():null}return v}(m))}return Cf=t,t.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var h=this._pbf.readVarint()+this._pbf.pos;return new o(this._pbf,h,this.extent,this._keys,this._values)},Cf}function Om(){return Bm||(Bm=1,Fh.VectorTile=function(){if(Dm)return Sf;Dm=1;var o=Fm();function t(i,a,h){if(i===3){var m=new o(h,h.readVarint()+h.pos);m.length&&(a[m.name]=m)}}return Sf=function(i,a){this.layers=i.readFields(t,{},a)},Sf}(),Fh.VectorTileFeature=Lm(),Fh.VectorTileLayer=Fm()),Fh}var Uc=R(Om());const Lv=Uc.VectorTileFeature.types,Tf=Math.pow(2,13);function Zc(o,t,i,a,h,m,g,v){o.emplaceBack(t,i,2*Math.floor(a*Tf)+g,h*Tf*2,m*Tf*2,Math.round(v))}class kf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ae,this.centroidVertexArray=new Q,this.indexArray=new Ke,this.programConfigurations=new zn(t.layers,t.zoom),this.segments=new yt,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,a){this.features=[],this.hasPattern=_f("fill-extrusion",this.layers,i);for(const{feature:h,id:m,index:g,sourceLayerIndex:v}of t){const C=this.layers[0]._featureFilter.needGeometry,T=Wo(h,C);if(!this.layers[0]._featureFilter.filter(new vr(this.zoom),T,a))continue;const M={id:m,sourceLayerIndex:v,index:g,geometry:C?T.geometry:Rn(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(yf("fill-extrusion",this.layers,M,this.zoom,i)):this.addFeature(M,M.geometry,g,a,{},i.subdivisionGranularity),i.featureIndex.insert(h,M.geometry,g,v,this.index,!0)}}addFeatures(t,i,a){for(const h of this.features){const{geometry:m}=h;this.addFeature(h,m,h.index,i,a,t.subdivisionGranularity)}}update(t,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Bv),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Dv.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,i,a,h,m,g){for(const v of Ea(i,500)){const C={x:0,y:0,sampleCount:0},T=this.layoutVertexArray.length;this.processPolygon(C,h,t,v,g);const M=this.layoutVertexArray.length-T,I=Math.floor(C.x/C.sampleCount),B=Math.floor(C.y/C.sampleCount);for(let F=0;F<M;F++)this.centroidVertexArray.emplaceBack(I,B)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,m,h)}processPolygon(t,i,a,h,m){if(h.length<1||$m(h[0]))return;for(const I of h)I.length!==0&&Fv(t,I);const g={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},v=m.fill.getGranularityForZoomLevel(i.z),C=Lv[a.type]==="Polygon";for(const I of h){if(I.length===0||$m(I))continue;const B=Qs(I,v,C);this._generateSideFaces(B,g)}if(!C)return;const T=Mm(h,i,v,!1),M=this.layoutVertexArray;Im((I,B)=>{Zc(M,I,B,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,T.verticesFlattened,T.indicesTriangles)}_generateSideFaces(t,i){let a=0;for(let h=1;h<t.length;h++){const m=t[h],g=t[h-1];if(Ov(m,g))continue;i.segment.vertexLength+4>yt.MAX_VERTEX_ARRAY_LENGTH&&(i.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const v=m.sub(g)._perp()._unit(),C=g.dist(m);a+C>32768&&(a=0),Zc(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,0,a),Zc(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,1,a),a+=C,Zc(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,0,a),Zc(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,1,a);const T=i.segment.vertexLength;this.indexArray.emplaceBack(T,T+2,T+1),this.indexArray.emplaceBack(T+1,T+2,T+3),i.segment.vertexLength+=4,i.segment.primitiveLength+=2}}}function Fv(o,t){for(let i=0;i<t.length;i++){const a=t[i];i===t.length-1&&t[0].x===a.x&&t[0].y===a.y||(o.x+=a.x,o.y+=a.y,o.sampleCount++)}}function Ov(o,t){return o.x===t.x&&(o.x<0||o.x>vt)||o.y===t.y&&(o.y<0||o.y>vt)}function $m(o){return o.every(t=>t.x<0)||o.every(t=>t.x>vt)||o.every(t=>t.y<0)||o.every(t=>t.y>vt)}let jm;ct("FillExtrusionBucket",kf,{omit:["layers","features"]});var $v={get paint(){return jm=jm||new Lo({"fill-extrusion-opacity":new _t(A["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Tt(A["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new _t(A["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new _t(A["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Xs(A["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Tt(A["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Tt(A["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new _t(A["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class jv extends Ei{constructor(t){super(t,$v)}createBucket(t){return new kf(t)}queryRadius(){return zh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:i,featureState:a,geometry:h,transform:m,pixelsToTileUnits:g,pixelPosMatrix:v}){const C=Rh(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-m.bearingInRadians,g),T=this.paint.get("fill-extrusion-height").evaluate(i,a),M=this.paint.get("fill-extrusion-base").evaluate(i,a),I=function(F,O,j){const W=[];for(const ee of F){const he=[ee.x,ee.y,0,1];ot(he,he,O),W.push(new fe(he[0]/he[3],he[1]/he[3]))}return W}(C,v),B=function(F,O,j,W){const ee=[],he=[],oe=W[8]*O,L=W[9]*O,q=W[10]*O,ie=W[11]*O,we=W[8]*j,Oe=W[9]*j,Te=W[10]*j,Me=W[11]*j;for(const Ze of F){const je=[],qe=[];for(const De of Ze){const ut=De.x,Ct=De.y,wt=W[0]*ut+W[4]*Ct+W[12],pt=W[1]*ut+W[5]*Ct+W[13],Ut=W[2]*ut+W[6]*Ct+W[14],Mr=W[3]*ut+W[7]*Ct+W[15],Jr=Ut+q,Co=Mr+ie,Ci=wt+we,Xo=pt+Oe,po=Ut+Te,wr=Mr+Me,so=new fe((wt+oe)/Co,(pt+L)/Co);so.z=Jr/Co,je.push(so);const mo=new fe(Ci/wr,Xo/wr);mo.z=po/wr,qe.push(mo)}ee.push(je),he.push(qe)}return[ee,he]}(h,M,T,v);return function(F,O,j){let W=1/0;cl(j,O)&&(W=Nm(j,O[0]));for(let ee=0;ee<O.length;ee++){const he=O[ee],oe=F[ee];for(let L=0;L<he.length-1;L++){const q=he[L],ie=[q,he[L+1],oe[L+1],oe[L],q];ll(j,ie)&&(W=Math.min(W,Nm(j,ie)))}}return W!==1/0&&W}(B[0],B[1],I)}}function Gc(o,t){return o.x*t.x+o.y*t.y}function Nm(o,t){if(o.length===1){let i=0;const a=t[i++];let h;for(;!h||a.equals(h);)if(h=t[i++],!h)return 1/0;for(;i<t.length;i++){const m=t[i],g=o[0],v=h.sub(a),C=m.sub(a),T=g.sub(a),M=Gc(v,v),I=Gc(v,C),B=Gc(C,C),F=Gc(T,v),O=Gc(T,C),j=M*B-I*I,W=(B*F-I*O)/j,ee=(M*O-I*F)/j,he=a.z*(1-W-ee)+h.z*W+m.z*ee;if(isFinite(he))return he}return 1/0}{let i=1/0;for(const a of t)i=Math.min(i,a.z);return i}}const Nv=Or([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Vv}=Nv,Uv=Or([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Zv}=Uv,Gv=Uc.VectorTileFeature.types,qv=Math.cos(Math.PI/180*37.5),Vm=Math.pow(2,14)/.5;class Pf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new ce,this.layoutVertexArray2=new de,this.indexArray=new Ke,this.programConfigurations=new zn(t.layers,t.zoom),this.segments=new yt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,a){this.hasPattern=_f("line",this.layers,i);const h=this.layers[0].layout.get("line-sort-key"),m=!h.isConstant(),g=[];for(const{feature:v,id:C,index:T,sourceLayerIndex:M}of t){const I=this.layers[0]._featureFilter.needGeometry,B=Wo(v,I);if(!this.layers[0]._featureFilter.filter(new vr(this.zoom),B,a))continue;const F=m?h.evaluate(B,{},a):void 0,O={id:C,properties:v.properties,type:v.type,sourceLayerIndex:M,index:T,geometry:I?B.geometry:Rn(v),patterns:{},sortKey:F};g.push(O)}m&&g.sort((v,C)=>v.sortKey-C.sortKey);for(const v of g){const{geometry:C,index:T,sourceLayerIndex:M}=v;if(this.hasPattern){const I=yf("line",this.layers,v,this.zoom,i);this.patternFeatures.push(I)}else this.addFeature(v,C,T,a,{},i.subdivisionGranularity);i.featureIndex.insert(t[T].feature,C,T,M,this.index)}}update(t,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,a)}addFeatures(t,i,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,i,a,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Zv)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Vv),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,i,a,h,m,g){const v=this.layers[0].layout,C=v.get("line-join").evaluate(t,{}),T=v.get("line-cap"),M=v.get("line-miter-limit"),I=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const B of i)this.addLine(B,t,C,T,M,I,h,g);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,m,h)}addLine(t,i,a,h,m,g,v,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Qs(t,v?C.line.getGranularityForZoomLevel(v.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let oe=0;oe<t.length-1;oe++)this.totalDistance+=t[oe].dist(t[oe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T=Gv[i.type]==="Polygon";let M=t.length;for(;M>=2&&t[M-1].equals(t[M-2]);)M--;let I=0;for(;I<M-1&&t[I].equals(t[I+1]);)I++;if(M<(T?3:2))return;a==="bevel"&&(m=1.05);const B=this.overscaling<=16?15*vt/(512*this.overscaling):0,F=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let O,j,W,ee,he;this.e1=this.e2=-1,T&&(O=t[M-2],he=t[I].sub(O)._unit()._perp());for(let oe=I;oe<M;oe++){if(W=oe===M-1?T?t[I+1]:void 0:t[oe+1],W&&t[oe].equals(W))continue;he&&(ee=he),O&&(j=O),O=t[oe],he=W?W.sub(O)._unit()._perp():ee,ee=ee||he;let L=ee.add(he);L.x===0&&L.y===0||L._unit();const q=ee.x*he.x+ee.y*he.y,ie=L.x*he.x+L.y*he.y,we=ie!==0?1/ie:1/0,Oe=2*Math.sqrt(2-2*ie),Te=ie<qv&&j&&W,Me=ee.x*he.y-ee.y*he.x>0;if(Te&&oe>I){const qe=O.dist(j);if(qe>2*B){const De=O.sub(O.sub(j)._mult(B/qe)._round());this.updateDistance(j,De),this.addCurrentVertex(De,ee,0,0,F),j=De}}const Ze=j&&W;let je=Ze?a:T?"butt":h;if(Ze&&je==="round"&&(we<g?je="miter":we<=2&&(je="fakeround")),je==="miter"&&we>m&&(je="bevel"),je==="bevel"&&(we>2&&(je="flipbevel"),we<m&&(je="miter")),j&&this.updateDistance(j,O),je==="miter")L._mult(we),this.addCurrentVertex(O,L,0,0,F);else if(je==="flipbevel"){if(we>100)L=he.mult(-1);else{const qe=we*ee.add(he).mag()/ee.sub(he).mag();L._perp()._mult(qe*(Me?-1:1))}this.addCurrentVertex(O,L,0,0,F),this.addCurrentVertex(O,L.mult(-1),0,0,F)}else if(je==="bevel"||je==="fakeround"){const qe=-Math.sqrt(we*we-1),De=Me?qe:0,ut=Me?0:qe;if(j&&this.addCurrentVertex(O,ee,De,ut,F),je==="fakeround"){const Ct=Math.round(180*Oe/Math.PI/20);for(let wt=1;wt<Ct;wt++){let pt=wt/Ct;if(pt!==.5){const Mr=pt-.5;pt+=pt*Mr*(pt-1)*((1.0904+q*(q*(3.55645-1.43519*q)-3.2452))*Mr*Mr+(.848013+q*(.215638*q-1.06021)))}const Ut=he.sub(ee)._mult(pt)._add(ee)._unit()._mult(Me?-1:1);this.addHalfVertex(O,Ut.x,Ut.y,!1,Me,0,F)}}W&&this.addCurrentVertex(O,he,-De,-ut,F)}else if(je==="butt")this.addCurrentVertex(O,L,0,0,F);else if(je==="square"){const qe=j?1:-1;this.addCurrentVertex(O,L,qe,qe,F)}else je==="round"&&(j&&(this.addCurrentVertex(O,ee,0,0,F),this.addCurrentVertex(O,ee,1,1,F,!0)),W&&(this.addCurrentVertex(O,he,-1,-1,F,!0),this.addCurrentVertex(O,he,0,0,F)));if(Te&&oe<M-1){const qe=O.dist(W);if(qe>2*B){const De=O.add(W.sub(O)._mult(B/qe)._round());this.updateDistance(O,De),this.addCurrentVertex(De,he,0,0,F),O=De}}}}addCurrentVertex(t,i,a,h,m,g=!1){const v=i.y*h-i.x,C=-i.y-i.x*h;this.addHalfVertex(t,i.x+i.y*a,i.y-i.x*a,g,!1,a,m),this.addHalfVertex(t,v,C,g,!0,-h,m),this.distance>Vm/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,i,a,h,m,g))}addHalfVertex({x:t,y:i},a,h,m,g,v,C){const T=.5*(this.lineClips?this.scaledDistance*(Vm-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(i<<1)+(g?1:0),Math.round(63*a)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&T)<<2,T>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const M=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,M,this.e2),C.primitiveLength++),g?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,i){this.distance+=t.dist(i),this.updateScaledDistance()}}let Um,Zm;ct("LineBucket",Pf,{omit:["layers","patternFeatures"]});var Gm={get paint(){return Zm=Zm||new Lo({"line-opacity":new Tt(A.paint_line["line-opacity"]),"line-color":new Tt(A.paint_line["line-color"]),"line-translate":new _t(A.paint_line["line-translate"]),"line-translate-anchor":new _t(A.paint_line["line-translate-anchor"]),"line-width":new Tt(A.paint_line["line-width"]),"line-gap-width":new Tt(A.paint_line["line-gap-width"]),"line-offset":new Tt(A.paint_line["line-offset"]),"line-blur":new Tt(A.paint_line["line-blur"]),"line-dasharray":new Qa(A.paint_line["line-dasharray"]),"line-pattern":new Xs(A.paint_line["line-pattern"]),"line-gradient":new Mc(A.paint_line["line-gradient"])})},get layout(){return Um=Um||new Lo({"line-cap":new _t(A.layout_line["line-cap"]),"line-join":new Tt(A.layout_line["line-join"]),"line-miter-limit":new _t(A.layout_line["line-miter-limit"]),"line-round-limit":new _t(A.layout_line["line-round-limit"]),"line-sort-key":new Tt(A.layout_line["line-sort-key"])})}};class Wv extends Tt{possiblyEvaluate(t,i){return i=new vr(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(t,i)}evaluate(t,i,a,h){return i=Rr({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(t,i,a,h)}}let Oh;class Hv extends Ei{constructor(t){super(t,Gm),this.gradientVersion=0,Oh||(Oh=new Wv(Gm.paint.properties["line-width"].specification),Oh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const i=this.gradientExpression();this.stepInterpolant=!!function(a){return a._styleExpression!==void 0}(i)&&i._styleExpression.expression instanceof Yn,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,i){super.recalculate(t,i),this.paint._values["line-floorwidth"]=Oh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Pf(t)}queryRadius(t){const i=t,a=qm(Bc("line-width",this,i),Bc("line-gap-width",this,i)),h=Bc("line-offset",this,i);return a/2+Math.abs(h)+zh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:i,featureState:a,geometry:h,transform:m,pixelsToTileUnits:g}){const v=Rh(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-m.bearingInRadians,g),C=g/2*qm(this.paint.get("line-width").evaluate(i,a),this.paint.get("line-gap-width").evaluate(i,a)),T=this.paint.get("line-offset").evaluate(i,a);return T&&(h=function(M,I){const B=[];for(let F=0;F<M.length;F++){const O=M[F],j=[];for(let W=0;W<O.length;W++){const ee=O[W-1],he=O[W],oe=O[W+1],L=W===0?new fe(0,0):he.sub(ee)._unit()._perp(),q=W===O.length-1?new fe(0,0):oe.sub(he)._unit()._perp(),ie=L._add(q)._unit(),we=ie.x*q.x+ie.y*q.y;we!==0&&ie._mult(1/we),j.push(ie._mult(I)._add(he))}B.push(j)}return B}(h,T*g)),function(M,I,B){for(let F=0;F<I.length;F++){const O=I[F];if(M.length>=3){for(let j=0;j<O.length;j++)if(ul(M,O[j]))return!0}if(cv(M,O,B))return!0}return!1}(v,h,C)}isTileClipped(){return!0}}function qm(o,t){return t>0?t+2*o:o}const Xv=Or([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Kv=Or([{name:"a_projected_pos",components:3,type:"Float32"}],4);Or([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Yv=Or([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Or([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Wm=Or([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Jv=Or([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Qv(o,t,i){return o.sections.forEach(a=>{a.text=function(h,m,g){const v=m.layout.get("text-transform").evaluate(g,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),on.applyArabicShaping&&(h=on.applyArabicShaping(h)),h}(a.text,t,i)}),o}Or([{name:"triangle",components:3,type:"Uint16"}]),Or([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Or([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Or([{type:"Float32",name:"offsetX"}]),Or([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Or([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const qc={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Hm,Mf,Xm,Yr=24,If={};function eb(){return Hm||(Hm=1,If.read=function(o,t,i,a,h){var m,g,v=8*h-a-1,C=(1<<v)-1,T=C>>1,M=-7,I=i?h-1:0,B=i?-1:1,F=o[t+I];for(I+=B,m=F&(1<<-M)-1,F>>=-M,M+=v;M>0;m=256*m+o[t+I],I+=B,M-=8);for(g=m&(1<<-M)-1,m>>=-M,M+=a;M>0;g=256*g+o[t+I],I+=B,M-=8);if(m===0)m=1-T;else{if(m===C)return g?NaN:1/0*(F?-1:1);g+=Math.pow(2,a),m-=T}return(F?-1:1)*g*Math.pow(2,m-a)},If.write=function(o,t,i,a,h,m){var g,v,C,T=8*m-h-1,M=(1<<T)-1,I=M>>1,B=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=a?0:m-1,O=a?1:-1,j=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,g=M):(g=Math.floor(Math.log(t)/Math.LN2),t*(C=Math.pow(2,-g))<1&&(g--,C*=2),(t+=g+I>=1?B/C:B*Math.pow(2,1-I))*C>=2&&(g++,C/=2),g+I>=M?(v=0,g=M):g+I>=1?(v=(t*C-1)*Math.pow(2,h),g+=I):(v=t*Math.pow(2,I-1)*Math.pow(2,h),g=0));h>=8;o[i+F]=255&v,F+=O,v/=256,h-=8);for(g=g<<h|v,T+=h;T>0;o[i+F]=255&g,F+=O,g/=256,T-=8);o[i+F-O]|=128*j}),If}function Km(){if(Xm)return Mf;Xm=1,Mf=t;var o=eb();function t(L){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(L)?L:new Uint8Array(L||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var i=4294967296,a=1/i,h=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function m(L){return L.type===t.Bytes?L.readVarint()+L.pos:L.pos+1}function g(L,q,ie){return ie?4294967296*q+(L>>>0):4294967296*(q>>>0)+(L>>>0)}function v(L,q,ie){var we=q<=16383?1:q<=2097151?2:q<=268435455?3:Math.floor(Math.log(q)/(7*Math.LN2));ie.realloc(we);for(var Oe=ie.pos-1;Oe>=L;Oe--)ie.buf[Oe+we]=ie.buf[Oe]}function C(L,q){for(var ie=0;ie<L.length;ie++)q.writeVarint(L[ie])}function T(L,q){for(var ie=0;ie<L.length;ie++)q.writeSVarint(L[ie])}function M(L,q){for(var ie=0;ie<L.length;ie++)q.writeFloat(L[ie])}function I(L,q){for(var ie=0;ie<L.length;ie++)q.writeDouble(L[ie])}function B(L,q){for(var ie=0;ie<L.length;ie++)q.writeBoolean(L[ie])}function F(L,q){for(var ie=0;ie<L.length;ie++)q.writeFixed32(L[ie])}function O(L,q){for(var ie=0;ie<L.length;ie++)q.writeSFixed32(L[ie])}function j(L,q){for(var ie=0;ie<L.length;ie++)q.writeFixed64(L[ie])}function W(L,q){for(var ie=0;ie<L.length;ie++)q.writeSFixed64(L[ie])}function ee(L,q){return(L[q]|L[q+1]<<8|L[q+2]<<16)+16777216*L[q+3]}function he(L,q,ie){L[ie]=q,L[ie+1]=q>>>8,L[ie+2]=q>>>16,L[ie+3]=q>>>24}function oe(L,q){return(L[q]|L[q+1]<<8|L[q+2]<<16)+(L[q+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(L,q,ie){for(ie=ie||this.length;this.pos<ie;){var we=this.readVarint(),Oe=we>>3,Te=this.pos;this.type=7&we,L(Oe,q,this),this.pos===Te&&this.skip(we)}return q},readMessage:function(L,q){return this.readFields(L,q,this.readVarint()+this.pos)},readFixed32:function(){var L=ee(this.buf,this.pos);return this.pos+=4,L},readSFixed32:function(){var L=oe(this.buf,this.pos);return this.pos+=4,L},readFixed64:function(){var L=ee(this.buf,this.pos)+ee(this.buf,this.pos+4)*i;return this.pos+=8,L},readSFixed64:function(){var L=ee(this.buf,this.pos)+oe(this.buf,this.pos+4)*i;return this.pos+=8,L},readFloat:function(){var L=o.read(this.buf,this.pos,!0,23,4);return this.pos+=4,L},readDouble:function(){var L=o.read(this.buf,this.pos,!0,52,8);return this.pos+=8,L},readVarint:function(L){var q,ie,we=this.buf;return q=127&(ie=we[this.pos++]),ie<128?q:(q|=(127&(ie=we[this.pos++]))<<7,ie<128?q:(q|=(127&(ie=we[this.pos++]))<<14,ie<128?q:(q|=(127&(ie=we[this.pos++]))<<21,ie<128?q:function(Oe,Te,Me){var Ze,je,qe=Me.buf;if(Ze=(112&(je=qe[Me.pos++]))>>4,je<128||(Ze|=(127&(je=qe[Me.pos++]))<<3,je<128)||(Ze|=(127&(je=qe[Me.pos++]))<<10,je<128)||(Ze|=(127&(je=qe[Me.pos++]))<<17,je<128)||(Ze|=(127&(je=qe[Me.pos++]))<<24,je<128)||(Ze|=(1&(je=qe[Me.pos++]))<<31,je<128))return g(Oe,Ze,Te);throw new Error("Expected varint not more than 10 bytes")}(q|=(15&(ie=we[this.pos]))<<28,L,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var L=this.readVarint();return L%2==1?(L+1)/-2:L/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var L=this.readVarint()+this.pos,q=this.pos;return this.pos=L,L-q>=12&&h?function(ie,we,Oe){return h.decode(ie.subarray(we,Oe))}(this.buf,q,L):function(ie,we,Oe){for(var Te="",Me=we;Me<Oe;){var Ze,je,qe,De=ie[Me],ut=null,Ct=De>239?4:De>223?3:De>191?2:1;if(Me+Ct>Oe)break;Ct===1?De<128&&(ut=De):Ct===2?(192&(Ze=ie[Me+1]))==128&&(ut=(31&De)<<6|63&Ze)<=127&&(ut=null):Ct===3?(je=ie[Me+2],(192&(Ze=ie[Me+1]))==128&&(192&je)==128&&((ut=(15&De)<<12|(63&Ze)<<6|63&je)<=2047||ut>=55296&&ut<=57343)&&(ut=null)):Ct===4&&(je=ie[Me+2],qe=ie[Me+3],(192&(Ze=ie[Me+1]))==128&&(192&je)==128&&(192&qe)==128&&((ut=(15&De)<<18|(63&Ze)<<12|(63&je)<<6|63&qe)<=65535||ut>=1114112)&&(ut=null)),ut===null?(ut=65533,Ct=1):ut>65535&&(ut-=65536,Te+=String.fromCharCode(ut>>>10&1023|55296),ut=56320|1023&ut),Te+=String.fromCharCode(ut),Me+=Ct}return Te}(this.buf,q,L)},readBytes:function(){var L=this.readVarint()+this.pos,q=this.buf.subarray(this.pos,L);return this.pos=L,q},readPackedVarint:function(L,q){if(this.type!==t.Bytes)return L.push(this.readVarint(q));var ie=m(this);for(L=L||[];this.pos<ie;)L.push(this.readVarint(q));return L},readPackedSVarint:function(L){if(this.type!==t.Bytes)return L.push(this.readSVarint());var q=m(this);for(L=L||[];this.pos<q;)L.push(this.readSVarint());return L},readPackedBoolean:function(L){if(this.type!==t.Bytes)return L.push(this.readBoolean());var q=m(this);for(L=L||[];this.pos<q;)L.push(this.readBoolean());return L},readPackedFloat:function(L){if(this.type!==t.Bytes)return L.push(this.readFloat());var q=m(this);for(L=L||[];this.pos<q;)L.push(this.readFloat());return L},readPackedDouble:function(L){if(this.type!==t.Bytes)return L.push(this.readDouble());var q=m(this);for(L=L||[];this.pos<q;)L.push(this.readDouble());return L},readPackedFixed32:function(L){if(this.type!==t.Bytes)return L.push(this.readFixed32());var q=m(this);for(L=L||[];this.pos<q;)L.push(this.readFixed32());return L},readPackedSFixed32:function(L){if(this.type!==t.Bytes)return L.push(this.readSFixed32());var q=m(this);for(L=L||[];this.pos<q;)L.push(this.readSFixed32());return L},readPackedFixed64:function(L){if(this.type!==t.Bytes)return L.push(this.readFixed64());var q=m(this);for(L=L||[];this.pos<q;)L.push(this.readFixed64());return L},readPackedSFixed64:function(L){if(this.type!==t.Bytes)return L.push(this.readSFixed64());var q=m(this);for(L=L||[];this.pos<q;)L.push(this.readSFixed64());return L},skip:function(L){var q=7&L;if(q===t.Varint)for(;this.buf[this.pos++]>127;);else if(q===t.Bytes)this.pos=this.readVarint()+this.pos;else if(q===t.Fixed32)this.pos+=4;else{if(q!==t.Fixed64)throw new Error("Unimplemented type: "+q);this.pos+=8}},writeTag:function(L,q){this.writeVarint(L<<3|q)},realloc:function(L){for(var q=this.length||16;q<this.pos+L;)q*=2;if(q!==this.length){var ie=new Uint8Array(q);ie.set(this.buf),this.buf=ie,this.length=q}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(L){this.realloc(4),he(this.buf,L,this.pos),this.pos+=4},writeSFixed32:function(L){this.realloc(4),he(this.buf,L,this.pos),this.pos+=4},writeFixed64:function(L){this.realloc(8),he(this.buf,-1&L,this.pos),he(this.buf,Math.floor(L*a),this.pos+4),this.pos+=8},writeSFixed64:function(L){this.realloc(8),he(this.buf,-1&L,this.pos),he(this.buf,Math.floor(L*a),this.pos+4),this.pos+=8},writeVarint:function(L){(L=+L||0)>268435455||L<0?function(q,ie){var we,Oe;if(q>=0?(we=q%4294967296|0,Oe=q/4294967296|0):(Oe=~(-q/4294967296),4294967295^(we=~(-q%4294967296))?we=we+1|0:(we=0,Oe=Oe+1|0)),q>=18446744073709552e3||q<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ie.realloc(10),function(Te,Me,Ze){Ze.buf[Ze.pos++]=127&Te|128,Te>>>=7,Ze.buf[Ze.pos++]=127&Te|128,Te>>>=7,Ze.buf[Ze.pos++]=127&Te|128,Te>>>=7,Ze.buf[Ze.pos++]=127&Te|128,Ze.buf[Ze.pos]=127&(Te>>>=7)}(we,0,ie),function(Te,Me){var Ze=(7&Te)<<4;Me.buf[Me.pos++]|=Ze|((Te>>>=3)?128:0),Te&&(Me.buf[Me.pos++]=127&Te|((Te>>>=7)?128:0),Te&&(Me.buf[Me.pos++]=127&Te|((Te>>>=7)?128:0),Te&&(Me.buf[Me.pos++]=127&Te|((Te>>>=7)?128:0),Te&&(Me.buf[Me.pos++]=127&Te|((Te>>>=7)?128:0),Te&&(Me.buf[Me.pos++]=127&Te)))))}(Oe,ie)}(L,this):(this.realloc(4),this.buf[this.pos++]=127&L|(L>127?128:0),L<=127||(this.buf[this.pos++]=127&(L>>>=7)|(L>127?128:0),L<=127||(this.buf[this.pos++]=127&(L>>>=7)|(L>127?128:0),L<=127||(this.buf[this.pos++]=L>>>7&127))))},writeSVarint:function(L){this.writeVarint(L<0?2*-L-1:2*L)},writeBoolean:function(L){this.writeVarint(!!L)},writeString:function(L){L=String(L),this.realloc(4*L.length),this.pos++;var q=this.pos;this.pos=function(we,Oe,Te){for(var Me,Ze,je=0;je<Oe.length;je++){if((Me=Oe.charCodeAt(je))>55295&&Me<57344){if(!Ze){Me>56319||je+1===Oe.length?(we[Te++]=239,we[Te++]=191,we[Te++]=189):Ze=Me;continue}if(Me<56320){we[Te++]=239,we[Te++]=191,we[Te++]=189,Ze=Me;continue}Me=Ze-55296<<10|Me-56320|65536,Ze=null}else Ze&&(we[Te++]=239,we[Te++]=191,we[Te++]=189,Ze=null);Me<128?we[Te++]=Me:(Me<2048?we[Te++]=Me>>6|192:(Me<65536?we[Te++]=Me>>12|224:(we[Te++]=Me>>18|240,we[Te++]=Me>>12&63|128),we[Te++]=Me>>6&63|128),we[Te++]=63&Me|128)}return Te}(this.buf,L,this.pos);var ie=this.pos-q;ie>=128&&v(q,ie,this),this.pos=q-1,this.writeVarint(ie),this.pos+=ie},writeFloat:function(L){this.realloc(4),o.write(this.buf,L,this.pos,!0,23,4),this.pos+=4},writeDouble:function(L){this.realloc(8),o.write(this.buf,L,this.pos,!0,52,8),this.pos+=8},writeBytes:function(L){var q=L.length;this.writeVarint(q),this.realloc(q);for(var ie=0;ie<q;ie++)this.buf[this.pos++]=L[ie]},writeRawMessage:function(L,q){this.pos++;var ie=this.pos;L(q,this);var we=this.pos-ie;we>=128&&v(ie,we,this),this.pos=ie-1,this.writeVarint(we),this.pos+=we},writeMessage:function(L,q,ie){this.writeTag(L,t.Bytes),this.writeRawMessage(q,ie)},writePackedVarint:function(L,q){q.length&&this.writeMessage(L,C,q)},writePackedSVarint:function(L,q){q.length&&this.writeMessage(L,T,q)},writePackedBoolean:function(L,q){q.length&&this.writeMessage(L,B,q)},writePackedFloat:function(L,q){q.length&&this.writeMessage(L,M,q)},writePackedDouble:function(L,q){q.length&&this.writeMessage(L,I,q)},writePackedFixed32:function(L,q){q.length&&this.writeMessage(L,F,q)},writePackedSFixed32:function(L,q){q.length&&this.writeMessage(L,O,q)},writePackedFixed64:function(L,q){q.length&&this.writeMessage(L,j,q)},writePackedSFixed64:function(L,q){q.length&&this.writeMessage(L,W,q)},writeBytesField:function(L,q){this.writeTag(L,t.Bytes),this.writeBytes(q)},writeFixed32Field:function(L,q){this.writeTag(L,t.Fixed32),this.writeFixed32(q)},writeSFixed32Field:function(L,q){this.writeTag(L,t.Fixed32),this.writeSFixed32(q)},writeFixed64Field:function(L,q){this.writeTag(L,t.Fixed64),this.writeFixed64(q)},writeSFixed64Field:function(L,q){this.writeTag(L,t.Fixed64),this.writeSFixed64(q)},writeVarintField:function(L,q){this.writeTag(L,t.Varint),this.writeVarint(q)},writeSVarintField:function(L,q){this.writeTag(L,t.Varint),this.writeSVarint(q)},writeStringField:function(L,q){this.writeTag(L,t.Bytes),this.writeString(q)},writeFloatField:function(L,q){this.writeTag(L,t.Fixed32),this.writeFloat(q)},writeDoubleField:function(L,q){this.writeTag(L,t.Fixed64),this.writeDouble(q)},writeBooleanField:function(L,q){this.writeVarintField(L,!!q)}},Mf}var Ef=R(Km());const Af=3;function tb(o,t,i){o===1&&i.readMessage(rb,t)}function rb(o,t,i){if(o===3){const{id:a,bitmap:h,width:m,height:g,left:v,top:C,advance:T}=i.readMessage(ob,{});t.push({id:a,bitmap:new Lc({width:m+2*Af,height:g+2*Af},h),metrics:{width:m,height:g,left:v,top:C,advance:T}})}}function ob(o,t,i){o===1?t.id=i.readVarint():o===2?t.bitmap=i.readBytes():o===3?t.width=i.readVarint():o===4?t.height=i.readVarint():o===5?t.left=i.readSVarint():o===6?t.top=i.readSVarint():o===7&&(t.advance=i.readVarint())}const ib=Af;function Ym(o){let t=0,i=0;for(const g of o)t+=g.w*g.h,i=Math.max(i,g.w);o.sort((g,v)=>v.h-g.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let h=0,m=0;for(const g of o)for(let v=a.length-1;v>=0;v--){const C=a[v];if(!(g.w>C.w||g.h>C.h)){if(g.x=C.x,g.y=C.y,m=Math.max(m,g.y+g.h),h=Math.max(h,g.x+g.w),g.w===C.w&&g.h===C.h){const T=a.pop();v<a.length&&(a[v]=T)}else g.h===C.h?(C.x+=g.w,C.w-=g.w):g.w===C.w?(C.y+=g.h,C.h-=g.h):(a.push({x:C.x+g.w,y:C.y,w:C.w-g.w,h:g.h}),C.y+=g.h,C.h-=g.h);break}}return{w:h,h:m,fill:t/(h*m)||0}}const Ho=1;class zf{constructor(t,{pixelRatio:i,version:a,stretchX:h,stretchY:m,content:g,textFitWidth:v,textFitHeight:C}){this.paddedRect=t,this.pixelRatio=i,this.stretchX=h,this.stretchY=m,this.content=g,this.version=a,this.textFitWidth=v,this.textFitHeight=C}get tl(){return[this.paddedRect.x+Ho,this.paddedRect.y+Ho]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ho,this.paddedRect.y+this.paddedRect.h-Ho]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Ho)/this.pixelRatio,(this.paddedRect.h-2*Ho)/this.pixelRatio]}}class Jm{constructor(t,i){const a={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,a,m),this.addImages(i,h,m);const{w:g,h:v}=Ym(m),C=new xi({width:g||1,height:v||1});for(const T in t){const M=t[T],I=a[T].paddedRect;xi.copy(M.data,C,{x:0,y:0},{x:I.x+Ho,y:I.y+Ho},M.data)}for(const T in i){const M=i[T],I=h[T].paddedRect,B=I.x+Ho,F=I.y+Ho,O=M.data.width,j=M.data.height;xi.copy(M.data,C,{x:0,y:0},{x:B,y:F},M.data),xi.copy(M.data,C,{x:0,y:j-1},{x:B,y:F-1},{width:O,height:1}),xi.copy(M.data,C,{x:0,y:0},{x:B,y:F+j},{width:O,height:1}),xi.copy(M.data,C,{x:O-1,y:0},{x:B-1,y:F},{width:1,height:j}),xi.copy(M.data,C,{x:0,y:0},{x:B+O,y:F},{width:1,height:j})}this.image=C,this.iconPositions=a,this.patternPositions=h}addImages(t,i,a){for(const h in t){const m=t[h],g={x:0,y:0,w:m.data.width+2*Ho,h:m.data.height+2*Ho};a.push(g),i[h]=new zf(g,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,i){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in t.updatedImages)this.patchUpdatedImage(this.iconPositions[a],t.getImage(a),i),this.patchUpdatedImage(this.patternPositions[a],t.getImage(a),i)}patchUpdatedImage(t,i,a){if(!t||!i||t.version===i.version)return;t.version=i.version;const[h,m]=t.tl;a.update(i.data,void 0,{x:h,y:m})}}var hs;ct("ImagePosition",zf),ct("ImageAtlas",Jm),b.ag=void 0,(hs=b.ag||(b.ag={}))[hs.none=0]="none",hs[hs.horizontal=1]="horizontal",hs[hs.vertical=2]="vertical",hs[hs.horizontalOnly=3]="horizontalOnly";const $h=-17;class Wc{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,i,a){const h=new Wc;return h.scale=t||1,h.fontStack=i,h.verticalAlign=a||"bottom",h}static forImage(t,i){const a=new Wc;return a.imageName=t,a.verticalAlign=i||"bottom",a}}class pl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,i){const a=new pl;for(let h=0;h<t.sections.length;h++){const m=t.sections[h];m.image?a.addImageSection(m):a.addTextSection(m,i)}return a}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let i="";for(let a=0;a<t.length;a++){const h=t.charCodeAt(a+1)||null,m=t.charCodeAt(a-1)||null;i+=h&&Sc(h)&&!qc[t[a+1]]||m&&Sc(m)&&!qc[t[a-1]]||!qc[t[a]]?t[a]:qc[t[a]]}return i}(this.text)}trim(){let t=0;for(let a=0;a<this.text.length&&Nh[this.text.charCodeAt(a)];a++)t++;let i=this.text.length;for(let a=this.text.length-1;a>=0&&a>=t&&Nh[this.text.charCodeAt(a)];a--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)}substring(t,i){const a=new pl;return a.text=this.text.substring(t,i),a.sectionIndex=this.sectionIndex.slice(t,i),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,i)=>Math.max(t,this.sections[i].scale),0)}getMaxImageSize(t){let i=0,a=0;for(let h=0;h<this.length();h++){const m=this.getSection(h);if(m.imageName){const g=t[m.imageName];if(!g)continue;const v=g.displaySize;i=Math.max(i,v[0]),a=Math.max(a,v[1])}}return{maxImageWidth:i,maxImageHeight:a}}addTextSection(t,i){this.text+=t.text,this.sections.push(Wc.forText(t.scale,t.fontStack||i,t.verticalAlign));const a=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(a)}addImageSection(t){const i=t.image?t.image.name:"";if(i.length===0)return void qr("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(Wc.forImage(i,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):qr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function jh(o,t,i,a,h,m,g,v,C,T,M,I,B,F,O){const j=pl.fromFeature(o,h);let W;I===b.ag.vertical&&j.verticalizePunctuation();const{processBidirectionalText:ee,processStyledBidirectionalText:he}=on;if(ee&&j.sections.length===1){W=[];const q=ee(j.toString(),Rf(j,T,m,t,a,F));for(const ie of q){const we=new pl;we.text=ie,we.sections=j.sections;for(let Oe=0;Oe<ie.length;Oe++)we.sectionIndex.push(0);W.push(we)}}else if(he){W=[];const q=he(j.text,j.sectionIndex,Rf(j,T,m,t,a,F));for(const ie of q){const we=new pl;we.text=ie[0],we.sectionIndex=ie[1],we.sections=j.sections,W.push(we)}}else W=function(q,ie){const we=[],Oe=q.text;let Te=0;for(const Me of ie)we.push(q.substring(Te,Me)),Te=Me;return Te<Oe.length&&we.push(q.substring(Te,Oe.length)),we}(j,Rf(j,T,m,t,a,F));const oe=[],L={positionedLines:oe,text:j.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:I,iconsInText:!1,verticalizable:!1};return function(q,ie,we,Oe,Te,Me,Ze,je,qe,De,ut,Ct){let wt=0,pt=0,Ut=0,Mr=0;const Jr=je==="right"?1:je==="left"?0:.5,Co=Yr/Ct;let Ci=0;for(const wr of Te){wr.trim();const so=wr.getMaxScale(),mo={positionedGlyphs:[],lineOffset:0};q.positionedLines[Ci]=mo;const go=mo.positionedGlyphs;let Fo=0;if(!wr.length()){pt+=Me,++Ci;continue}const Si=lb(Oe,wr,Co);for(let Ko=0;Ko<wr.length();Ko++){const Qr=wr.getSection(Ko),lo=wr.getSectionIndex(Ko),co=wr.getCharCode(Ko),Ur=cb(qe,ut,co);let mr;if(Qr.imageName){if(q.iconsInText=!0,Qr.scale=Qr.scale*Co,mr=hb(Qr,Ur,so,Si,Oe),!mr)continue;Fo=Math.max(Fo,mr.imageOffset)}else if(mr=ub(Qr,co,Ur,Si,ie,we),!mr)continue;const{rect:Vi,metrics:yl,baselineOffset:Ui}=mr;go.push({glyph:co,imageName:Qr.imageName,x:wt,y:pt+Ui+$h,vertical:Ur,scale:Qr.scale,fontStack:Qr.fontStack,sectionIndex:lo,metrics:yl,rect:Vi}),Ur?(q.verticalizable=!0,wt+=(Qr.imageName?yl.advance:Yr)*Qr.scale+De):wt+=yl.advance*Qr.scale+De}go.length!==0&&(Ut=Math.max(wt-De,Ut),db(go,0,go.length-1,Jr)),wt=0,mo.lineOffset=Math.max(Fo,(so-1)*Yr);const ao=Me*so+Fo;pt+=ao,Mr=Math.max(ao,Mr),++Ci}const{horizontalAlign:Xo,verticalAlign:po}=Df(Ze);(function(wr,so,mo,go,Fo,Si,ao,Ko,Qr){const lo=(so-mo)*Fo;let co=0;co=Si!==ao?-Ko*go-$h:-go*Qr*ao+.5*ao;for(const Ur of wr)for(const mr of Ur.positionedGlyphs)mr.x+=lo,mr.y+=co})(q.positionedLines,Jr,Xo,po,Ut,Mr,Me,pt,Te.length),q.top+=-po*pt,q.bottom=q.top+pt,q.left+=-Xo*Ut,q.right=q.left+Ut}(L,t,i,a,W,g,v,C,I,T,B,O),!function(q){for(const ie of q)if(ie.positionedGlyphs.length!==0)return!1;return!0}(oe)&&L}const Nh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},nb={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},sb={40:!0};function Qm(o,t,i,a,h,m){if(t.imageName){const g=a[t.imageName];return g?g.displaySize[0]*t.scale*Yr/m+h:0}{const g=i[t.fontStack],v=g&&g[o];return v?v.metrics.advance*t.scale+h:0}}function eg(o,t,i,a){const h=Math.pow(o-t,2);return a?o<t?h/2:2*h:h+Math.abs(i)*i}function ab(o,t,i){let a=0;return o===10&&(a-=1e4),i&&(a+=150),o!==40&&o!==65288||(a+=50),t!==41&&t!==65289||(a+=50),a}function tg(o,t,i,a,h,m){let g=null,v=eg(t,i,h,m);for(const C of a){const T=eg(t-C.x,i,h,m)+C.badness;T<=v&&(g=C,v=T)}return{index:o,x:t,priorBreak:g,badness:v}}function rg(o){return o?rg(o.priorBreak).concat(o.index):[]}function Rf(o,t,i,a,h,m){if(!o)return[];const g=[],v=function(I,B,F,O,j,W){let ee=0;for(let he=0;he<I.length();he++){const oe=I.getSection(he);ee+=Qm(I.getCharCode(he),oe,O,j,B,W)}return ee/Math.max(1,Math.ceil(ee/F))}(o,t,i,a,h,m),C=o.text.indexOf("")>=0;let T=0;for(let I=0;I<o.length();I++){const B=o.getSection(I),F=o.getCharCode(I);if(Nh[F]||(T+=Qm(F,B,a,h,t,m)),I<o.length()-1){const O=!((M=F)<11904)&&(!!jt["CJK Compatibility Forms"](M)||!!jt["CJK Compatibility"](M)||!!jt["CJK Strokes"](M)||!!jt["CJK Symbols and Punctuation"](M)||!!jt["Enclosed CJK Letters and Months"](M)||!!jt["Halfwidth and Fullwidth Forms"](M)||!!jt["Ideographic Description Characters"](M)||!!jt["Vertical Forms"](M)||wc.test(String.fromCodePoint(M)));(nb[F]||O||B.imageName||I!==o.length()-2&&sb[o.getCharCode(I+1)])&&g.push(tg(I+1,T,v,g,ab(F,o.getCharCode(I+1),O&&C),!1))}}var M;return rg(tg(o.length(),T,v,g,0,!0))}function Df(o){let t=.5,i=.5;switch(o){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function lb(o,t,i){const a=t.getMaxScale()*Yr,{maxImageWidth:h,maxImageHeight:m}=t.getMaxImageSize(o),g=Math.max(a,m*i);return{verticalLineContentWidth:Math.max(a,h*i),horizontalLineContentHeight:g}}function og(o){switch(o){case"top":return 0;case"center":return .5;default:return 1}}function cb(o,t,i){return!(o===b.ag.horizontal||!t&&!Cc(i)||t&&(Nh[i]||(a=i,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(a)))));var a}function ub(o,t,i,a,h,m){const g=m[o.fontStack],v=function(T,M,I,B){if(T&&T.rect)return T;const F=M[I.fontStack],O=F&&F[B];return O?{rect:null,metrics:O.metrics}:null}(g&&g[t],h,o,t);if(v===null)return null;let C;if(i)C=a.verticalLineContentWidth-o.scale*Yr;else{const T=og(o.verticalAlign);C=(a.horizontalLineContentHeight-o.scale*Yr)*T}return{rect:v.rect,metrics:v.metrics,baselineOffset:C}}function hb(o,t,i,a,h){const m=h[o.imageName];if(!m)return null;const g=m.paddedRect,v=m.displaySize,C={width:v[0],height:v[1],left:Ho,top:-3,advance:t?v[1]:v[0]};let T;if(t)T=a.verticalLineContentWidth-v[1]*o.scale;else{const M=og(o.verticalAlign);T=(a.horizontalLineContentHeight-v[1]*o.scale)*M}return{rect:g,metrics:C,baselineOffset:T,imageOffset:(t?v[0]:v[1])*o.scale-Yr*i}}function db(o,t,i,a){if(a===0)return;const h=o[i],m=(o[i].x+h.metrics.advance*h.scale)*a;for(let g=t;g<=i;g++)o[g].x-=m}function fb(o,t,i){const{horizontalAlign:a,verticalAlign:h}=Df(i),m=t[0]-o.displaySize[0]*a,g=t[1]-o.displaySize[1]*h;return{image:o,top:g,bottom:g+o.displaySize[1],left:m,right:m+o.displaySize[0]}}function ig(o){var t,i;let a=o.left,h=o.top,m=o.right-a,g=o.bottom-h;const v=(t=o.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",C=(i=o.image.textFitHeight)!==null&&i!==void 0?i:"stretchOrShrink",T=(o.image.content[2]-o.image.content[0])/(o.image.content[3]-o.image.content[1]);if(C==="proportional"){if(v==="stretchOnly"&&m/g<T||v==="proportional"){const M=Math.ceil(g*T);a*=M/m,m=M}}else if(v==="proportional"&&C==="stretchOnly"&&T!==0&&m/g>T){const M=Math.ceil(m/T);h*=M/g,g=M}return{x1:a,y1:h,x2:a+m,y2:h+g}}function ng(o,t,i,a,h,m){const g=o.image;let v;if(g.content){const W=g.content,ee=g.pixelRatio||1;v=[W[0]/ee,W[1]/ee,g.displaySize[0]-W[2]/ee,g.displaySize[1]-W[3]/ee]}const C=t.left*m,T=t.right*m;let M,I,B,F;i==="width"||i==="both"?(F=h[0]+C-a[3],I=h[0]+T+a[1]):(F=h[0]+(C+T-g.displaySize[0])/2,I=F+g.displaySize[0]);const O=t.top*m,j=t.bottom*m;return i==="height"||i==="both"?(M=h[1]+O-a[0],B=h[1]+j+a[2]):(M=h[1]+(O+j-g.displaySize[1])/2,B=M+g.displaySize[1]),{image:g,top:M,right:I,bottom:B,left:F,collisionPadding:v}}const Hc=255,sn=128,ds=Hc*sn;function sg(o,t){const{expression:i}=t;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new vr(o+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:h}=i;let m=0;for(;m<a.length&&a[m]<=o;)m++;m=Math.max(0,m-1);let g=m;for(;g<a.length&&a[g]<o+1;)g++;g=Math.min(a.length-1,g);const v=a[m],C=a[g];return i.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:C,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:C,minSize:i.evaluate(new vr(v)),maxSize:i.evaluate(new vr(C)),interpolationType:h}}}function Bf(o,t,i){let a="never";const h=o.get(t);return h?a=h:o.get(i)&&(a="always"),a}const pb=Uc.VectorTileFeature.types,mb=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Vh(o,t,i,a,h,m,g,v,C,T,M,I,B){const F=v?Math.min(ds,Math.round(v[0])):0,O=v?Math.min(ds,Math.round(v[1])):0;o.emplaceBack(t,i,Math.round(32*a),Math.round(32*h),m,g,(F<<1)+(C?1:0),O,16*T,16*M,256*I,256*B)}function Lf(o,t,i){o.emplaceBack(t.x,t.y,i),o.emplaceBack(t.x,t.y,i),o.emplaceBack(t.x,t.y,i),o.emplaceBack(t.x,t.y,i)}function gb(o){for(const t of o.sections)if(Th(t.text))return!0;return!1}class Ff{constructor(t){this.layoutVertexArray=new xe,this.indexArray=new Ke,this.programConfigurations=t,this.segments=new yt,this.dynamicLayoutVertexArray=new Ce,this.opacityVertexArray=new Ee,this.hasVisibleVertices=!1,this.placedSymbolArray=new S}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,i,a,h){this.isEmpty()||(a&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xv.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Kv.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,mb,!0),this.opacityVertexBuffer.itemSize=1),(a||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ct("SymbolBuffers",Ff);class Of{constructor(t,i,a){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new a,this.segments=new yt,this.collisionVertexArray=new Ie}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Yv.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ct("CollisionBuffers",Of);class ml{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(g=>g.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=sg(this.zoom,i["text-size"]),this.iconSizeData=sg(this.zoom,i["icon-size"]);const a=this.layers[0].layout,h=a.get("symbol-sort-key"),m=a.get("symbol-z-order");this.canOverlap=Bf(a,"text-overlap","text-allow-overlap")!=="never"||Bf(a,"icon-overlap","icon-allow-overlap")!=="never"||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(g=>b.ag[g])),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=t.sourceID}createArrays(){this.text=new Ff(new zn(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Ff(new zn(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new z,this.lineVertexArray=new D,this.symbolInstances=new E,this.textAnchorOffsets=new N}calculateGlyphDependencies(t,i,a,h,m){for(let g=0;g<t.length;g++)if(i[t.charCodeAt(g)]=!0,(a||h)&&m){const v=qc[t.charAt(g)];v&&(i[v.charCodeAt(0)]=!0)}}populate(t,i,a){const h=this.layers[0],m=h.layout,g=m.get("text-font"),v=m.get("text-field"),C=m.get("icon-image"),T=(v.value.kind!=="constant"||v.value.value instanceof ho&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),M=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,I=m.get("symbol-sort-key");if(this.features=[],!T&&!M)return;const B=i.iconDependencies,F=i.glyphDependencies,O=i.availableImages,j=new vr(this.zoom);for(const{feature:W,id:ee,index:he,sourceLayerIndex:oe}of t){const L=h._featureFilter.needGeometry,q=Wo(W,L);if(!h._featureFilter.filter(j,q,a))continue;let ie,we;if(L||(q.geometry=Rn(W)),T){const Te=h.getValueAndResolveTokens("text-field",q,a,O),Me=ho.factory(Te),Ze=this.hasRTLText=this.hasRTLText||gb(Me);(!Ze||on.getRTLTextPluginStatus()==="unavailable"||Ze&&on.isParsed())&&(ie=Qv(Me,h,q))}if(M){const Te=h.getValueAndResolveTokens("icon-image",q,a,O);we=Te instanceof ko?Te:ko.fromString(Te)}if(!ie&&!we)continue;const Oe=this.sortFeaturesByKey?I.evaluate(q,{},a):void 0;if(this.features.push({id:ee,text:ie,icon:we,index:he,sourceLayerIndex:oe,geometry:q.geometry,properties:W.properties,type:pb[W.type],sortKey:Oe}),we&&(B[we.name]=!0),ie){const Te=g.evaluate(q,{},a).join(","),Me=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(b.ag.vertical)>=0;for(const Ze of ie.sections)if(Ze.image)B[Ze.image.name]=!0;else{const je=Xa(ie.toString()),qe=Ze.fontStack||Te,De=F[qe]=F[qe]||{};this.calculateGlyphDependencies(Ze.text,De,Me,this.allowVerticalPlacement,je)}}}m.get("symbol-placement")==="line"&&(this.features=function(W){const ee={},he={},oe=[];let L=0;function q(Te){oe.push(W[Te]),L++}function ie(Te,Me,Ze){const je=he[Te];return delete he[Te],he[Me]=je,oe[je].geometry[0].pop(),oe[je].geometry[0]=oe[je].geometry[0].concat(Ze[0]),je}function we(Te,Me,Ze){const je=ee[Me];return delete ee[Me],ee[Te]=je,oe[je].geometry[0].shift(),oe[je].geometry[0]=Ze[0].concat(oe[je].geometry[0]),je}function Oe(Te,Me,Ze){const je=Ze?Me[0][Me[0].length-1]:Me[0][0];return`${Te}:${je.x}:${je.y}`}for(let Te=0;Te<W.length;Te++){const Me=W[Te],Ze=Me.geometry,je=Me.text?Me.text.toString():null;if(!je){q(Te);continue}const qe=Oe(je,Ze),De=Oe(je,Ze,!0);if(qe in he&&De in ee&&he[qe]!==ee[De]){const ut=we(qe,De,Ze),Ct=ie(qe,De,oe[ut].geometry);delete ee[qe],delete he[De],he[Oe(je,oe[Ct].geometry,!0)]=Ct,oe[ut].geometry=null}else qe in he?ie(qe,De,Ze):De in ee?we(qe,De,Ze):(q(Te),ee[qe]=L-1,he[De]=L-1)}return oe.filter(Te=>Te.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((W,ee)=>W.sortKey-ee.sortKey)}update(t,i,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,i,this.layers,a),this.icon.programConfigurations.updatePaintArrays(t,i,this.layers,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,i){const a=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(i[t.segment+1]),m=t.dist(i[t.segment]);const g={};for(let v=t.segment+1;v<i.length;v++)g[v]={x:i[v].x,y:i[v].y,tileUnitDistanceFromAnchor:h},v<i.length-1&&(h+=i[v+1].dist(i[v]));for(let v=t.segment||0;v>=0;v--)g[v]={x:i[v].x,y:i[v].y,tileUnitDistanceFromAnchor:m},v>0&&(m+=i[v-1].dist(i[v]));for(let v=0;v<i.length;v++){const C=g[v];this.lineVertexArray.emplaceBack(C.x,C.y,C.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(t,i,a,h,m,g,v,C,T,M,I,B){const F=t.indexArray,O=t.layoutVertexArray,j=t.segments.prepareSegment(4*i.length,O,F,this.canOverlap?g.sortKey:void 0),W=this.glyphOffsetArray.length,ee=j.vertexLength,he=this.allowVerticalPlacement&&v===b.ag.vertical?Math.PI/2:0,oe=g.text&&g.text.sections;for(let L=0;L<i.length;L++){const{tl:q,tr:ie,bl:we,br:Oe,tex:Te,pixelOffsetTL:Me,pixelOffsetBR:Ze,minFontScaleX:je,minFontScaleY:qe,glyphOffset:De,isSDF:ut,sectionIndex:Ct}=i[L],wt=j.vertexLength,pt=De[1];Vh(O,C.x,C.y,q.x,pt+q.y,Te.x,Te.y,a,ut,Me.x,Me.y,je,qe),Vh(O,C.x,C.y,ie.x,pt+ie.y,Te.x+Te.w,Te.y,a,ut,Ze.x,Me.y,je,qe),Vh(O,C.x,C.y,we.x,pt+we.y,Te.x,Te.y+Te.h,a,ut,Me.x,Ze.y,je,qe),Vh(O,C.x,C.y,Oe.x,pt+Oe.y,Te.x+Te.w,Te.y+Te.h,a,ut,Ze.x,Ze.y,je,qe),Lf(t.dynamicLayoutVertexArray,C,he),F.emplaceBack(wt,wt+2,wt+1),F.emplaceBack(wt+1,wt+2,wt+3),j.vertexLength+=4,j.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(De[0]),L!==i.length-1&&Ct===i[L+1].sectionIndex||t.programConfigurations.populatePaintArrays(O.length,g,g.index,{},B,oe&&oe[Ct])}t.placedSymbolArray.emplaceBack(C.x,C.y,W,this.glyphOffsetArray.length-W,ee,T,M,C.segment,a?a[0]:0,a?a[1]:0,h[0],h[1],v,0,!1,0,I)}_addCollisionDebugVertex(t,i,a,h,m,g){return i.emplaceBack(0,0),t.emplaceBack(a.x,a.y,h,m,Math.round(g.x),Math.round(g.y))}addCollisionDebugVertices(t,i,a,h,m,g,v){const C=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),T=C.vertexLength,M=m.layoutVertexArray,I=m.collisionVertexArray,B=v.anchorX,F=v.anchorY;this._addCollisionDebugVertex(M,I,g,B,F,new fe(t,i)),this._addCollisionDebugVertex(M,I,g,B,F,new fe(a,i)),this._addCollisionDebugVertex(M,I,g,B,F,new fe(a,h)),this._addCollisionDebugVertex(M,I,g,B,F,new fe(t,h)),C.vertexLength+=4;const O=m.indexArray;O.emplaceBack(T,T+1),O.emplaceBack(T+1,T+2),O.emplaceBack(T+2,T+3),O.emplaceBack(T+3,T),C.primitiveLength+=4}addDebugCollisionBoxes(t,i,a,h){for(let m=t;m<i;m++){const g=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,h?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,a)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Of(Re,Wm.members,He),this.iconCollisionBox=new Of(Re,Wm.members,He);for(let t=0;t<this.symbolInstances.length;t++){const i=this.symbolInstances.get(t);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}}_deserializeCollisionBoxesForSymbol(t,i,a,h,m,g,v,C,T){const M={};for(let I=i;I<a;I++){const B=t.get(I);M.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.textFeatureIndex=B.featureIndex;break}for(let I=h;I<m;I++){const B=t.get(I);M.verticalTextBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.verticalTextFeatureIndex=B.featureIndex;break}for(let I=g;I<v;I++){const B=t.get(I);M.iconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.iconFeatureIndex=B.featureIndex;break}for(let I=C;I<T;I++){const B=t.get(I);M.verticalIconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.verticalIconFeatureIndex=B.featureIndex;break}return M}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const a=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,i){const a=t.placedSymbolArray.get(i),h=a.vertexStartIndex+4*a.numGlyphs;for(let m=a.vertexStartIndex;m<h;m+=4)t.indexArray.emplaceBack(m,m+2,m+1),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(t),a=Math.cos(t),h=[],m=[],g=[];for(let v=0;v<this.symbolInstances.length;++v){g.push(v);const C=this.symbolInstances.get(v);h.push(0|Math.round(i*C.anchorX+a*C.anchorY)),m.push(C.featureIndex)}return g.sort((v,C)=>h[v]-h[C]||m[C]-m[v]),g}addToSortKeyRanges(t,i){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===i?a.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const a=this.symbolInstances.get(i);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((h,m,g)=>{h>=0&&g.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ag,lg;ct("SymbolBucket",ml,{omit:["layers","collisionBoxArray","features","compareText"]}),ml.MAX_GLYPHS=65535,ml.addDynamicAttributes=Lf;var $f={get paint(){return lg=lg||new Lo({"icon-opacity":new Tt(A.paint_symbol["icon-opacity"]),"icon-color":new Tt(A.paint_symbol["icon-color"]),"icon-halo-color":new Tt(A.paint_symbol["icon-halo-color"]),"icon-halo-width":new Tt(A.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Tt(A.paint_symbol["icon-halo-blur"]),"icon-translate":new _t(A.paint_symbol["icon-translate"]),"icon-translate-anchor":new _t(A.paint_symbol["icon-translate-anchor"]),"text-opacity":new Tt(A.paint_symbol["text-opacity"]),"text-color":new Tt(A.paint_symbol["text-color"],{runtimeType:Lt,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new Tt(A.paint_symbol["text-halo-color"]),"text-halo-width":new Tt(A.paint_symbol["text-halo-width"]),"text-halo-blur":new Tt(A.paint_symbol["text-halo-blur"]),"text-translate":new _t(A.paint_symbol["text-translate"]),"text-translate-anchor":new _t(A.paint_symbol["text-translate-anchor"])})},get layout(){return ag=ag||new Lo({"symbol-placement":new _t(A.layout_symbol["symbol-placement"]),"symbol-spacing":new _t(A.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new _t(A.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Tt(A.layout_symbol["symbol-sort-key"]),"symbol-z-order":new _t(A.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new _t(A.layout_symbol["icon-allow-overlap"]),"icon-overlap":new _t(A.layout_symbol["icon-overlap"]),"icon-ignore-placement":new _t(A.layout_symbol["icon-ignore-placement"]),"icon-optional":new _t(A.layout_symbol["icon-optional"]),"icon-rotation-alignment":new _t(A.layout_symbol["icon-rotation-alignment"]),"icon-size":new Tt(A.layout_symbol["icon-size"]),"icon-text-fit":new _t(A.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new _t(A.layout_symbol["icon-text-fit-padding"]),"icon-image":new Tt(A.layout_symbol["icon-image"]),"icon-rotate":new Tt(A.layout_symbol["icon-rotate"]),"icon-padding":new Tt(A.layout_symbol["icon-padding"]),"icon-keep-upright":new _t(A.layout_symbol["icon-keep-upright"]),"icon-offset":new Tt(A.layout_symbol["icon-offset"]),"icon-anchor":new Tt(A.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new _t(A.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new _t(A.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new _t(A.layout_symbol["text-rotation-alignment"]),"text-field":new Tt(A.layout_symbol["text-field"]),"text-font":new Tt(A.layout_symbol["text-font"]),"text-size":new Tt(A.layout_symbol["text-size"]),"text-max-width":new Tt(A.layout_symbol["text-max-width"]),"text-line-height":new _t(A.layout_symbol["text-line-height"]),"text-letter-spacing":new Tt(A.layout_symbol["text-letter-spacing"]),"text-justify":new Tt(A.layout_symbol["text-justify"]),"text-radial-offset":new Tt(A.layout_symbol["text-radial-offset"]),"text-variable-anchor":new _t(A.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Tt(A.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Tt(A.layout_symbol["text-anchor"]),"text-max-angle":new _t(A.layout_symbol["text-max-angle"]),"text-writing-mode":new _t(A.layout_symbol["text-writing-mode"]),"text-rotate":new Tt(A.layout_symbol["text-rotate"]),"text-padding":new _t(A.layout_symbol["text-padding"]),"text-keep-upright":new _t(A.layout_symbol["text-keep-upright"]),"text-transform":new Tt(A.layout_symbol["text-transform"]),"text-offset":new Tt(A.layout_symbol["text-offset"]),"text-allow-overlap":new _t(A.layout_symbol["text-allow-overlap"]),"text-overlap":new _t(A.layout_symbol["text-overlap"]),"text-ignore-placement":new _t(A.layout_symbol["text-ignore-placement"]),"text-optional":new _t(A.layout_symbol["text-optional"])})}};class cg{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Pt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ct("FormatSectionOverride",cg,{omit:["defaultValue"]});class Uh extends Ei{constructor(t){super(t,$f)}recalculate(t,i){if(super.recalculate(t,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const a=this.layout.get("text-writing-mode");if(a){const h=[];for(const m of a)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,i,a,h){const m=this.layout.get(t).evaluate(i,{},a,h),g=this._unevaluatedLayout._values[t];return g.isDataDriven()||Na(g.value)||!m?m:function(v,C){return C.replace(/{([^{}]+)}/g,(T,M)=>v&&M in v?String(v[M]):"")}(i.properties,m)}createBucket(t){return new ml(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of $f.paint.overridableProperties){if(!Uh.hasPaintOverride(this.layout,t))continue;const i=this.paint.get(t),a=new cg(i),h=new ac(a,i.property.specification);let m=null;m=i.value.kind==="constant"||i.value.kind==="source"?new Va("source",h):new lc("composite",h,i.value.zoomStops),this.paint._values[t]=new hi(i.property,m,i.parameters)}}_handleOverridablePaintPropertyUpdate(t,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven())&&Uh.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,i){const a=t.get("text-field"),h=$f.paint.properties[i];let m=!1;const g=v=>{for(const C of v)if(h.overrides&&h.overrides.hasOverride(C))return void(m=!0)};if(a.value.kind==="constant"&&a.value.value instanceof ho)g(a.value.value.sections);else if(a.value.kind==="source"){const v=T=>{m||(T instanceof si&&Vr(T.value)===Nr?g(T.value.sections):T instanceof _n?g(T.sections):T.eachChild(v))},C=a.value;C._styleExpression&&v(C._styleExpression.expression)}return m}}let ug;var _b={get paint(){return ug=ug||new Lo({"background-color":new _t(A.paint_background["background-color"]),"background-pattern":new Qa(A.paint_background["background-pattern"]),"background-opacity":new _t(A.paint_background["background-opacity"])})}};class yb extends Ei{constructor(t){super(t,_b)}}let hg;var vb={get paint(){return hg=hg||new Lo({"raster-opacity":new _t(A.paint_raster["raster-opacity"]),"raster-hue-rotate":new _t(A.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new _t(A.paint_raster["raster-brightness-min"]),"raster-brightness-max":new _t(A.paint_raster["raster-brightness-max"]),"raster-saturation":new _t(A.paint_raster["raster-saturation"]),"raster-contrast":new _t(A.paint_raster["raster-contrast"]),"raster-resampling":new _t(A.paint_raster["raster-resampling"]),"raster-fade-duration":new _t(A.paint_raster["raster-fade-duration"])})}};class bb extends Ei{constructor(t){super(t,vb)}}class xb extends Ei{constructor(t){super(t,{}),this.onAdd=i=>{this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},this.onRemove=i=>{this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class wb{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Cb={once:!0},jf=63710088e-1;class fs{constructor(t,i){if(isNaN(t)||isNaN(i))throw new Error(`Invalid LngLat object: (${t}, ${i})`);if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new fs(Lr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const i=Math.PI/180,a=this.lat*i,h=t.lat*i,m=Math.sin(a)*Math.sin(h)+Math.cos(a)*Math.cos(h)*Math.cos((t.lng-this.lng)*i);return jf*Math.acos(Math.min(m,1))}static convert(t){if(t instanceof fs)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new fs(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new fs(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const dg=2*Math.PI*jf;function fg(o){return dg*Math.cos(o*Math.PI/180)}function pg(o){return(180+o)/360}function mg(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function gg(o,t){return o/fg(t)}function Nf(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function _g(o,t){return o*fg(Nf(t))}class Xc{constructor(t,i,a=0){this.x=+t,this.y=+i,this.z=+a}static fromLngLat(t,i=0){const a=fs.convert(t);return new Xc(pg(a.lng),mg(a.lat),gg(i,a.lat))}toLngLat(){return new fs(360*this.x-180,Nf(this.y))}toAltitude(){return _g(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/dg*(t=Nf(this.y),1/Math.cos(t*Math.PI/180));var t}}function yg(o,t,i){var a=2*Math.PI*6378137/256/Math.pow(2,i);return[o*a-2*Math.PI*6378137/2,t*a-2*Math.PI*6378137/2]}class Vf{constructor(t,i,a){if(!function(h,m,g){return!(h<0||h>25||g<0||g>=Math.pow(2,h)||m<0||m>=Math.pow(2,h))}(t,i,a))throw new Error(`x=${i}, y=${a}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=i,this.y=a,this.key=gl(0,t,t,i,a)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,i,a){const h=(g=this.y,v=this.z,C=yg(256*(m=this.x),256*(g=Math.pow(2,v)-g-1),v),T=yg(256*(m+1),256*(g+1),v),C[0]+","+C[1]+","+T[0]+","+T[1]);var m,g,v,C,T;const M=function(I,B,F){let O,j="";for(let W=I;W>0;W--)O=1<<W-1,j+=(B&O?1:0)+(F&O?2:0);return j}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,i>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const i=this.z-t.z;return i>0&&t.x===this.x>>i&&t.y===this.y>>i}getTilePoint(t){const i=Math.pow(2,this.z);return new fe((t.x*i-this.x)*vt,(t.y*i-this.y)*vt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class vg{constructor(t,i){this.wrap=t,this.canonical=i,this.key=gl(t,i.z,i.z,i.x,i.y)}}class wi{constructor(t,i,a,h,m){if(this.terrainRttPosMatrix32f=null,t<a)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${a}`);this.overscaledZ=t,this.wrap=i,this.canonical=new Vf(a,+h,+m),this.key=gl(i,t,a,h,m)}clone(){return new wi(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-t;return t>this.canonical.z?new wi(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new wi(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(t,i){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?gl(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y):gl(this.wrap*+i,t,t,this.canonical.x>>a,this.canonical.y>>a)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const i=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i}children(t){if(this.overscaledZ>=t)return[new wi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,a=2*this.canonical.x,h=2*this.canonical.y;return[new wi(i,this.wrap,i,a,h),new wi(i,this.wrap,i,a+1,h),new wi(i,this.wrap,i,a,h+1),new wi(i,this.wrap,i,a+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new wi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new wi(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new vg(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Xc(t.x-this.wrap,t.y))}}function gl(o,t,i,a,h){(o*=2)<0&&(o=-1*o-1);const m=1<<i;return(m*m*o+m*h+a).toString(36)+i.toString(36)+t.toString(36)}ct("CanonicalTileID",Vf),ct("OverscaledTileID",wi,{omit:["terrainRttPosMatrix32f"]});class bg{constructor(t,i,a,h=1,m=1,g=1,v=0){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(a&&!["mapbox","terrarium","custom"].includes(a))return void qr(`"${a}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=i.height;const C=this.dim=i.height-2;switch(this.data=new Uint32Array(i.data.buffer),a){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=m,this.blueFactor=g,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let T=0;T<C;T++)this.data[this._idx(-1,T)]=this.data[this._idx(0,T)],this.data[this._idx(C,T)]=this.data[this._idx(C-1,T)],this.data[this._idx(T,-1)]=this.data[this._idx(T,0)],this.data[this._idx(T,C)]=this.data[this._idx(T,C-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(C,-1)]=this.data[this._idx(C-1,0)],this.data[this._idx(-1,C)]=this.data[this._idx(0,C-1)],this.data[this._idx(C,C)]=this.data[this._idx(C-1,C-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let T=0;T<C;T++)for(let M=0;M<C;M++){const I=this.get(T,M);I>this.max&&(this.max=I),I<this.min&&(this.min=I)}}get(t,i){const a=new Uint8Array(this.data.buffer),h=4*this._idx(t,i);return this.unpack(a[h],a[h+1],a[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)}unpack(t,i,a){return t*this.redFactor+i*this.greenFactor+a*this.blueFactor-this.baseShift}getPixels(){return new xi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,i,a){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=i*this.dim,m=i*this.dim+this.dim,g=a*this.dim,v=a*this.dim+this.dim;switch(i){case-1:h=m-1;break;case 1:m=h+1}switch(a){case-1:g=v-1;break;case 1:v=g+1}const C=-i*this.dim,T=-a*this.dim;for(let M=g;M<v;M++)for(let I=h;I<m;I++)this.data[this._idx(I,M)]=t.data[this._idx(I+C,M+T)]}}ct("DEMData",bg);class xg{constructor(t){this._stringToNumber={},this._numberToString=[];for(let i=0;i<t.length;i++){const a=t[i];this._stringToNumber[a]=i,this._numberToString[i]=a}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class wg{constructor(t,i,a,h,m){this.type="Feature",this._vectorTileFeature=t,t._z=i,t._x=a,t._y=h,this.properties=t.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&(t[i]=this[i]);return t}}class Cg{constructor(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Gs(vt,16,0),this.grid3D=new Gs(vt,16,0),this.featureIndexArray=new Y,this.promoteId=i}insert(t,i,a,h,m,g){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,h,m);const C=g?this.grid3D:this.grid;for(let T=0;T<i.length;T++){const M=i[T],I=[1/0,1/0,-1/0,-1/0];for(let B=0;B<M.length;B++){const F=M[B];I[0]=Math.min(I[0],F.x),I[1]=Math.min(I[1],F.y),I[2]=Math.max(I[2],F.x),I[3]=Math.max(I[3],F.y)}I[0]<vt&&I[1]<vt&&I[2]>=0&&I[3]>=0&&C.insert(v,I[0],I[1],I[2],I[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Uc.VectorTile(new Ef(this.rawTileData)).layers,this.sourceLayerCoder=new xg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,i,a,h){this.loadVTLayers();const m=t.params,g=vt/t.tileSize/t.scale,v=Ga(m.filter),C=t.queryGeometry,T=t.queryPadding*g,M=Tg(C),I=this.grid.query(M.minX-T,M.minY-T,M.maxX+T,M.maxY+T),B=Tg(t.cameraQueryGeometry),F=this.grid3D.query(B.minX-T,B.minY-T,B.maxX+T,B.maxY+T,(W,ee,he,oe)=>function(L,q,ie,we,Oe){for(const Me of L)if(q<=Me.x&&ie<=Me.y&&we>=Me.x&&Oe>=Me.y)return!0;const Te=[new fe(q,ie),new fe(q,Oe),new fe(we,Oe),new fe(we,ie)];if(L.length>2){for(const Me of Te)if(ul(L,Me))return!0}for(let Me=0;Me<L.length-1;Me++)if(hv(L[Me],L[Me+1],Te))return!0;return!1}(t.cameraQueryGeometry,W-T,ee-T,he+T,oe+T));for(const W of F)I.push(W);I.sort(Sb);const O={};let j;for(let W=0;W<I.length;W++){const ee=I[W];if(ee===j)continue;j=ee;const he=this.featureIndexArray.get(ee);let oe=null;this.loadMatchingFeature(O,he.bucketIndex,he.sourceLayerIndex,he.featureIndex,v,m.layers,m.availableImages,i,a,h,(L,q,ie)=>(oe||(oe=Rn(L)),q.queryIntersectsFeature({queryGeometry:C,feature:L,featureState:ie,geometry:oe,zoom:this.z,transform:t.transform,pixelsToTileUnits:g,pixelPosMatrix:t.pixelPosMatrix})))}return O}loadMatchingFeature(t,i,a,h,m,g,v,C,T,M,I){const B=this.bucketLayerIDs[i];if(g&&!B.some(W=>g.has(W)))return;const F=this.sourceLayerCoder.decode(a),O=this.vtLayers[F].feature(h);if(m.needGeometry){const W=Wo(O,!0);if(!m.filter(new vr(this.tileID.overscaledZ),W,this.tileID.canonical))return}else if(!m.filter(new vr(this.tileID.overscaledZ),O))return;const j=this.getId(O,F);for(let W=0;W<B.length;W++){const ee=B[W];if(g&&!g.has(ee))continue;const he=C[ee];if(!he)continue;let oe={};j&&M&&(oe=M.getState(he.sourceLayer||"_geojsonTileLayer",j));const L=Rr({},T[ee]);L.paint=Sg(L.paint,he.paint,O,oe,v),L.layout=Sg(L.layout,he.layout,O,oe,v);const q=!I||I(O,he,oe);if(!q)continue;const ie=new wg(O,this.z,this.x,this.y,j);ie.layer=L;let we=t[ee];we===void 0&&(we=t[ee]=[]),we.push({featureIndex:h,feature:ie,intersectionZ:q})}}lookupSymbolFeatures(t,i,a,h,m,g,v,C){const T={};this.loadVTLayers();const M=Ga(m);for(const I of t)this.loadMatchingFeature(T,a,h,I,M,g,v,C,i);return T}hasLayer(t){for(const i of this.bucketLayerIDs)for(const a of i)if(t===a)return!0;return!1}getId(t,i){var a;let h=t.id;return this.promoteId&&(h=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof h=="boolean"&&(h=Number(h)),h===void 0&&(!((a=t.properties)===null||a===void 0)&&a.cluster)&&this.promoteId&&(h=Number(t.properties.cluster_id))),h}}function Sg(o,t,i,a,h){return Ao(o,(m,g)=>{const v=t instanceof Ja?t.get(g):null;return v&&v.evaluate?v.evaluate(i,a,h):v})}function Tg(o){let t=1/0,i=1/0,a=-1/0,h=-1/0;for(const m of o)t=Math.min(t,m.x),i=Math.min(i,m.y),a=Math.max(a,m.x),h=Math.max(h,m.y);return{minX:t,minY:i,maxX:a,maxY:h}}function Sb(o,t){return t-o}function kg(o,t,i,a,h){const m=[];for(let g=0;g<o.length;g++){const v=o[g];let C;for(let T=0;T<v.length-1;T++){let M=v[T],I=v[T+1];M.x<t&&I.x<t||(M.x<t?M=new fe(t,M.y+(t-M.x)/(I.x-M.x)*(I.y-M.y))._round():I.x<t&&(I=new fe(t,M.y+(t-M.x)/(I.x-M.x)*(I.y-M.y))._round()),M.y<i&&I.y<i||(M.y<i?M=new fe(M.x+(i-M.y)/(I.y-M.y)*(I.x-M.x),i)._round():I.y<i&&(I=new fe(M.x+(i-M.y)/(I.y-M.y)*(I.x-M.x),i)._round()),M.x>=a&&I.x>=a||(M.x>=a?M=new fe(a,M.y+(a-M.x)/(I.x-M.x)*(I.y-M.y))._round():I.x>=a&&(I=new fe(a,M.y+(a-M.x)/(I.x-M.x)*(I.y-M.y))._round()),M.y>=h&&I.y>=h||(M.y>=h?M=new fe(M.x+(h-M.y)/(I.y-M.y)*(I.x-M.x),h)._round():I.y>=h&&(I=new fe(M.x+(h-M.y)/(I.y-M.y)*(I.x-M.x),h)._round()),C&&M.equals(C[C.length-1])||(C=[M],m.push(C)),C.push(I)))))}}return m}ct("FeatureIndex",Cg,{omit:["rawTileData","sourceLayerCoder"]});class ps extends fe{constructor(t,i,a,h){super(t,i),this.angle=a,h!==void 0&&(this.segment=h)}clone(){return new ps(this.x,this.y,this.angle,this.segment)}}function Pg(o,t,i,a,h){if(t.segment===void 0||i===0)return!0;let m=t,g=t.segment+1,v=0;for(;v>-i/2;){if(g--,g<0)return!1;v-=o[g].dist(m),m=o[g]}v+=o[g].dist(o[g+1]),g++;const C=[];let T=0;for(;v<i/2;){const M=o[g],I=o[g+1];if(!I)return!1;let B=o[g-1].angleTo(M)-M.angleTo(I);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:v,angleDelta:B}),T+=B;v-C[0].distance>a;)T-=C.shift().angleDelta;if(T>h)return!1;g++,v+=M.dist(I)}return!0}function Mg(o){let t=0;for(let i=0;i<o.length-1;i++)t+=o[i].dist(o[i+1]);return t}function Ig(o,t,i){return o?.6*t*i:0}function Eg(o,t){return Math.max(o?o.right-o.left:0,t?t.right-t.left:0)}function Tb(o,t,i,a,h,m){const g=Ig(i,h,m),v=Eg(i,a)*m;let C=0;const T=Mg(o)/2;for(let M=0;M<o.length-1;M++){const I=o[M],B=o[M+1],F=I.dist(B);if(C+F>T){const O=(T-C)/F,j=Go.number(I.x,B.x,O),W=Go.number(I.y,B.y,O),ee=new ps(j,W,B.angleTo(I),M);return ee._round(),!g||Pg(o,ee,v,g,t)?ee:void 0}C+=F}}function kb(o,t,i,a,h,m,g,v,C){const T=Ig(a,m,g),M=Eg(a,h),I=M*g,B=o[0].x===0||o[0].x===C||o[0].y===0||o[0].y===C;return t-I<t/4&&(t=I+t/4),Ag(o,B?t/2*v%t:(M/2+2*m)*g*v%t,t,T,i,I,B,!1,C)}function Ag(o,t,i,a,h,m,g,v,C){const T=m/2,M=Mg(o);let I=0,B=t-i,F=[];for(let O=0;O<o.length-1;O++){const j=o[O],W=o[O+1],ee=j.dist(W),he=W.angleTo(j);for(;B+i<I+ee;){B+=i;const oe=(B-I)/ee,L=Go.number(j.x,W.x,oe),q=Go.number(j.y,W.y,oe);if(L>=0&&L<C&&q>=0&&q<C&&B-T>=0&&B+T<=M){const ie=new ps(L,q,he,O);ie._round(),a&&!Pg(o,ie,m,a,h)||F.push(ie)}}I+=ee}return v||F.length||g||(F=Ag(o,I/2,i,a,h,m,g,!0,C)),F}ct("Anchor",ps);const Kc=Ho;function zg(o,t,i,a){const h=[],m=o.image,g=m.pixelRatio,v=m.paddedRect.w-2*Kc,C=m.paddedRect.h-2*Kc;let T={x1:o.left,y1:o.top,x2:o.right,y2:o.bottom};const M=m.stretchX||[[0,v]],I=m.stretchY||[[0,C]],B=(De,ut)=>De+ut[1]-ut[0],F=M.reduce(B,0),O=I.reduce(B,0),j=v-F,W=C-O;let ee=0,he=F,oe=0,L=O,q=0,ie=j,we=0,Oe=W;if(m.content&&a){const De=m.content,ut=De[2]-De[0],Ct=De[3]-De[1];(m.textFitWidth||m.textFitHeight)&&(T=ig(o)),ee=Zh(M,0,De[0]),oe=Zh(I,0,De[1]),he=Zh(M,De[0],De[2]),L=Zh(I,De[1],De[3]),q=De[0]-ee,we=De[1]-oe,ie=ut-he,Oe=Ct-L}const Te=T.x1,Me=T.y1,Ze=T.x2-Te,je=T.y2-Me,qe=(De,ut,Ct,wt)=>{const pt=Gh(De.stretch-ee,he,Ze,Te),Ut=qh(De.fixed-q,ie,De.stretch,F),Mr=Gh(ut.stretch-oe,L,je,Me),Jr=qh(ut.fixed-we,Oe,ut.stretch,O),Co=Gh(Ct.stretch-ee,he,Ze,Te),Ci=qh(Ct.fixed-q,ie,Ct.stretch,F),Xo=Gh(wt.stretch-oe,L,je,Me),po=qh(wt.fixed-we,Oe,wt.stretch,O),wr=new fe(pt,Mr),so=new fe(Co,Mr),mo=new fe(Co,Xo),go=new fe(pt,Xo),Fo=new fe(Ut/g,Jr/g),Si=new fe(Ci/g,po/g),ao=t*Math.PI/180;if(ao){const lo=Math.sin(ao),co=Math.cos(ao),Ur=[co,-lo,lo,co];wr._matMult(Ur),so._matMult(Ur),go._matMult(Ur),mo._matMult(Ur)}const Ko=De.stretch+De.fixed,Qr=ut.stretch+ut.fixed;return{tl:wr,tr:so,bl:go,br:mo,tex:{x:m.paddedRect.x+Kc+Ko,y:m.paddedRect.y+Kc+Qr,w:Ct.stretch+Ct.fixed-Ko,h:wt.stretch+wt.fixed-Qr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Fo,pixelOffsetBR:Si,minFontScaleX:ie/g/Ze,minFontScaleY:Oe/g/je,isSDF:i}};if(a&&(m.stretchX||m.stretchY)){const De=Rg(M,j,F),ut=Rg(I,W,O);for(let Ct=0;Ct<De.length-1;Ct++){const wt=De[Ct],pt=De[Ct+1];for(let Ut=0;Ut<ut.length-1;Ut++)h.push(qe(wt,ut[Ut],pt,ut[Ut+1]))}}else h.push(qe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:C+1}));return h}function Zh(o,t,i){let a=0;for(const h of o)a+=Math.max(t,Math.min(i,h[1]))-Math.max(t,Math.min(i,h[0]));return a}function Rg(o,t,i){const a=[{fixed:-1,stretch:0}];for(const[h,m]of o){const g=a[a.length-1];a.push({fixed:h-g.stretch,stretch:g.stretch}),a.push({fixed:h-g.stretch,stretch:g.stretch+(m-h)})}return a.push({fixed:t+Kc,stretch:i}),a}function Gh(o,t,i,a){return o/t*i+a}function qh(o,t,i,a){return o-t*i/a}class Wh{constructor(t,i,a,h,m,g,v,C,T,M){var I;if(this.boxStartIndex=t.length,T){let B=g.top,F=g.bottom;const O=g.collisionPadding;O&&(B-=O[1],F+=O[3]);let j=F-B;j>0&&(j=Math.max(10,j),this.circleDiameter=j)}else{const B=!((I=g.image)===null||I===void 0)&&I.content&&(g.image.textFitWidth||g.image.textFitHeight)?ig(g):{x1:g.left,y1:g.top,x2:g.right,y2:g.bottom};B.y1=B.y1*v-C[0],B.y2=B.y2*v+C[2],B.x1=B.x1*v-C[3],B.x2=B.x2*v+C[1];const F=g.collisionPadding;if(F&&(B.x1-=F[0]*v,B.y1-=F[1]*v,B.x2+=F[2]*v,B.y2+=F[3]*v),M){const O=new fe(B.x1,B.y1),j=new fe(B.x2,B.y1),W=new fe(B.x1,B.y2),ee=new fe(B.x2,B.y2),he=M*Math.PI/180;O._rotate(he),j._rotate(he),W._rotate(he),ee._rotate(he),B.x1=Math.min(O.x,j.x,W.x,ee.x),B.x2=Math.max(O.x,j.x,W.x,ee.x),B.y1=Math.min(O.y,j.y,W.y,ee.y),B.y2=Math.max(O.y,j.y,W.y,ee.y)}t.emplaceBack(i.x,i.y,B.x1,B.y1,B.x2,B.y2,a,h,m)}this.boxEndIndex=t.length}}class Pb{constructor(t=[],i=(a,h)=>a<h?-1:a>h?1:0){if(this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:i,compare:a}=this,h=i[t];for(;t>0;){const m=t-1>>1,g=i[m];if(a(h,g)>=0)break;i[t]=g,t=m}i[t]=h}_down(t){const{data:i,compare:a}=this,h=this.length>>1,m=i[t];for(;t<h;){let g=1+(t<<1);const v=g+1;if(v<this.length&&a(i[v],i[g])<0&&(g=v),a(i[g],m)>=0)break;i[t]=i[g],t=g}i[t]=m}}function Mb(o,t=1,i=!1){let a=1/0,h=1/0,m=-1/0,g=-1/0;const v=o[0];for(let F=0;F<v.length;F++){const O=v[F];(!F||O.x<a)&&(a=O.x),(!F||O.y<h)&&(h=O.y),(!F||O.x>m)&&(m=O.x),(!F||O.y>g)&&(g=O.y)}const C=Math.min(m-a,g-h);let T=C/2;const M=new Pb([],Ib);if(C===0)return new fe(a,h);for(let F=a;F<m;F+=C)for(let O=h;O<g;O+=C)M.push(new _l(F+T,O+T,T,o));let I=function(F){let O=0,j=0,W=0;const ee=F[0];for(let he=0,oe=ee.length,L=oe-1;he<oe;L=he++){const q=ee[he],ie=ee[L],we=q.x*ie.y-ie.x*q.y;j+=(q.x+ie.x)*we,W+=(q.y+ie.y)*we,O+=3*we}return new _l(j/O,W/O,0,F)}(o),B=M.length;for(;M.length;){const F=M.pop();(F.d>I.d||!I.d)&&(I=F,i&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,B)),F.max-I.d<=t||(T=F.h/2,M.push(new _l(F.p.x-T,F.p.y-T,T,o)),M.push(new _l(F.p.x+T,F.p.y-T,T,o)),M.push(new _l(F.p.x-T,F.p.y+T,T,o)),M.push(new _l(F.p.x+T,F.p.y+T,T,o)),B+=4)}return i&&(console.log(`num probes: ${B}`),console.log(`best distance: ${I.d}`)),I.p}function Ib(o,t){return t.max-o.max}function _l(o,t,i,a){this.p=new fe(o,t),this.h=i,this.d=function(h,m){let g=!1,v=1/0;for(let C=0;C<m.length;C++){const T=m[C];for(let M=0,I=T.length,B=I-1;M<I;B=M++){const F=T[M],O=T[B];F.y>h.y!=O.y>h.y&&h.x<(O.x-F.x)*(h.y-F.y)/(O.y-F.y)+F.x&&(g=!g),v=Math.min(v,fm(h,F,O))}}return(g?1:-1)*Math.sqrt(v)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}var wo;b.ax=void 0,(wo=b.ax||(b.ax={}))[wo.center=1]="center",wo[wo.left=2]="left",wo[wo.right=3]="right",wo[wo.top=4]="top",wo[wo.bottom=5]="bottom",wo[wo["top-left"]=6]="top-left",wo[wo["top-right"]=7]="top-right",wo[wo["bottom-left"]=8]="bottom-left",wo[wo["bottom-right"]=9]="bottom-right";const ms=7,Uf=Number.POSITIVE_INFINITY;function Dg(o,t){return t[1]!==Uf?function(i,a,h){let m=0,g=0;switch(a=Math.abs(a),h=Math.abs(h),i){case"top-right":case"top-left":case"top":g=h-ms;break;case"bottom-right":case"bottom-left":case"bottom":g=-h+ms}switch(i){case"top-right":case"bottom-right":case"right":m=-a;break;case"top-left":case"bottom-left":case"left":m=a}return[m,g]}(o,t[0],t[1]):function(i,a){let h=0,m=0;a<0&&(a=0);const g=a/Math.SQRT2;switch(i){case"top-right":case"top-left":m=g-ms;break;case"bottom-right":case"bottom-left":m=-g+ms;break;case"bottom":m=-a+ms;break;case"top":m=a-ms}switch(i){case"top-right":case"bottom-right":h=-g;break;case"top-left":case"bottom-left":h=g;break;case"left":h=a;break;case"right":h=-a}return[h,m]}(o,t[0])}function Bg(o,t,i){var a;const h=o.layout,m=(a=h.get("text-variable-anchor-offset"))===null||a===void 0?void 0:a.evaluate(t,{},i);if(m){const v=m.values,C=[];for(let T=0;T<v.length;T+=2){const M=C[T]=v[T],I=v[T+1].map(B=>B*Yr);M.startsWith("top")?I[1]-=ms:M.startsWith("bottom")&&(I[1]+=ms),C[T+1]=I}return new oo(C)}const g=h.get("text-variable-anchor");if(g){let v;v=o._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},i)*Yr,Uf]:h.get("text-offset").evaluate(t,{},i).map(T=>T*Yr);const C=[];for(const T of g)C.push(T,Dg(T,v));return new oo(C)}return null}function Zf(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Eb(o,t,i,a,h,m,g,v,C,T,M,I){let B=m.textMaxSize.evaluate(t,{});B===void 0&&(B=g);const F=o.layers[0].layout,O=F.get("icon-offset").evaluate(t,{},M),j=Fg(i.horizontal),W=g/24,ee=o.tilePixelRatio*W,he=o.tilePixelRatio*B/24,oe=o.tilePixelRatio*v,L=o.tilePixelRatio*F.get("symbol-spacing"),q=F.get("text-padding")*o.tilePixelRatio,ie=function(Ct,wt,pt,Ut=1){const Mr=Ct.get("icon-padding").evaluate(wt,{},pt),Jr=Mr&&Mr.values;return[Jr[0]*Ut,Jr[1]*Ut,Jr[2]*Ut,Jr[3]*Ut]}(F,t,M,o.tilePixelRatio),we=F.get("text-max-angle")/180*Math.PI,Oe=F.get("text-rotation-alignment")!=="viewport"&&F.get("symbol-placement")!=="point",Te=F.get("icon-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",Me=F.get("symbol-placement"),Ze=L/2,je=F.get("icon-text-fit");let qe;a&&je!=="none"&&(o.allowVerticalPlacement&&i.vertical&&(qe=ng(a,i.vertical,je,F.get("icon-text-fit-padding"),O,W)),j&&(a=ng(a,j,je,F.get("icon-text-fit-padding"),O,W)));const De=M?I.line.getGranularityForZoomLevel(M.z):1,ut=(Ct,wt)=>{wt.x<0||wt.x>=vt||wt.y<0||wt.y>=vt||function(pt,Ut,Mr,Jr,Co,Ci,Xo,po,wr,so,mo,go,Fo,Si,ao,Ko,Qr,lo,co,Ur,mr,Vi,yl,Ui,Rb){const vl=pt.addToLineVertexArray(Ut,Mr);let ea,bl,xl,wl,Ng=0,Vg=0,Ug=0,Zg=0,Jf=-1,Qf=-1;const Dn={};let Gg=Hr("");if(pt.allowVerticalPlacement&&Jr.vertical){const Po=po.layout.get("text-rotate").evaluate(mr,{},Ui)+90;xl=new Wh(wr,Ut,so,mo,go,Jr.vertical,Fo,Si,ao,Po),Xo&&(wl=new Wh(wr,Ut,so,mo,go,Xo,Qr,lo,ao,Po))}if(Co){const Po=po.layout.get("icon-rotate").evaluate(mr,{}),Ti=po.layout.get("icon-text-fit")!=="none",ta=zg(Co,Po,yl,Ti),Gi=Xo?zg(Xo,Po,yl,Ti):void 0;bl=new Wh(wr,Ut,so,mo,go,Co,Qr,lo,!1,Po),Ng=4*ta.length;const ra=pt.iconSizeData;let an=null;ra.kind==="source"?(an=[sn*po.layout.get("icon-size").evaluate(mr,{})],an[0]>ds&&qr(`${pt.layerIds[0]}: Value for "icon-size" is >= ${Hc}. Reduce your "icon-size".`)):ra.kind==="composite"&&(an=[sn*Vi.compositeIconSizes[0].evaluate(mr,{},Ui),sn*Vi.compositeIconSizes[1].evaluate(mr,{},Ui)],(an[0]>ds||an[1]>ds)&&qr(`${pt.layerIds[0]}: Value for "icon-size" is >= ${Hc}. Reduce your "icon-size".`)),pt.addSymbols(pt.icon,ta,an,Ur,co,mr,b.ag.none,Ut,vl.lineStartIndex,vl.lineLength,-1,Ui),Jf=pt.icon.placedSymbolArray.length-1,Gi&&(Vg=4*Gi.length,pt.addSymbols(pt.icon,Gi,an,Ur,co,mr,b.ag.vertical,Ut,vl.lineStartIndex,vl.lineLength,-1,Ui),Qf=pt.icon.placedSymbolArray.length-1)}const qg=Object.keys(Jr.horizontal);for(const Po of qg){const Ti=Jr.horizontal[Po];if(!ea){Gg=Hr(Ti.text);const Gi=po.layout.get("text-rotate").evaluate(mr,{},Ui);ea=new Wh(wr,Ut,so,mo,go,Ti,Fo,Si,ao,Gi)}const ta=Ti.positionedLines.length===1;if(Ug+=Lg(pt,Ut,Ti,Ci,po,ao,mr,Ko,vl,Jr.vertical?b.ag.horizontal:b.ag.horizontalOnly,ta?qg:[Po],Dn,Jf,Vi,Ui),ta)break}Jr.vertical&&(Zg+=Lg(pt,Ut,Jr.vertical,Ci,po,ao,mr,Ko,vl,b.ag.vertical,["vertical"],Dn,Qf,Vi,Ui));const Db=ea?ea.boxStartIndex:pt.collisionBoxArray.length,Bb=ea?ea.boxEndIndex:pt.collisionBoxArray.length,Lb=xl?xl.boxStartIndex:pt.collisionBoxArray.length,Fb=xl?xl.boxEndIndex:pt.collisionBoxArray.length,Ob=bl?bl.boxStartIndex:pt.collisionBoxArray.length,$b=bl?bl.boxEndIndex:pt.collisionBoxArray.length,jb=wl?wl.boxStartIndex:pt.collisionBoxArray.length,Nb=wl?wl.boxEndIndex:pt.collisionBoxArray.length;let Zi=-1;const Xh=(Po,Ti)=>Po&&Po.circleDiameter?Math.max(Po.circleDiameter,Ti):Ti;Zi=Xh(ea,Zi),Zi=Xh(xl,Zi),Zi=Xh(bl,Zi),Zi=Xh(wl,Zi);const Wg=Zi>-1?1:0;Wg&&(Zi*=Rb/Yr),pt.glyphOffsetArray.length>=ml.MAX_GLYPHS&&qr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),mr.sortKey!==void 0&&pt.addToSortKeyRanges(pt.symbolInstances.length,mr.sortKey);const Vb=Bg(po,mr,Ui),[Ub,Zb]=function(Po,Ti){const ta=Po.length,Gi=Ti==null?void 0:Ti.values;if((Gi==null?void 0:Gi.length)>0)for(let ra=0;ra<Gi.length;ra+=2){const an=Gi[ra+1];Po.emplaceBack(b.ax[Gi[ra]],an[0],an[1])}return[ta,Po.length]}(pt.textAnchorOffsets,Vb);pt.symbolInstances.emplaceBack(Ut.x,Ut.y,Dn.right>=0?Dn.right:-1,Dn.center>=0?Dn.center:-1,Dn.left>=0?Dn.left:-1,Dn.vertical||-1,Jf,Qf,Gg,Db,Bb,Lb,Fb,Ob,$b,jb,Nb,so,Ug,Zg,Ng,Vg,Wg,0,Fo,Zi,Ub,Zb)}(o,wt,Ct,i,a,h,qe,o.layers[0],o.collisionBoxArray,t.index,t.sourceLayerIndex,o.index,ee,[q,q,q,q],Oe,C,oe,ie,Te,O,t,m,T,M,g)};if(Me==="line")for(const Ct of kg(t.geometry,0,0,vt,vt)){const wt=Qs(Ct,De),pt=kb(wt,L,we,i.vertical||j,a,24,he,o.overscaling,vt);for(const Ut of pt)j&&Ab(o,j.text,Ze,Ut)||ut(wt,Ut)}else if(Me==="line-center"){for(const Ct of t.geometry)if(Ct.length>1){const wt=Qs(Ct,De),pt=Tb(wt,we,i.vertical||j,a,24,he);pt&&ut(wt,pt)}}else if(t.type==="Polygon")for(const Ct of Ea(t.geometry,0)){const wt=Mb(Ct,16);ut(Qs(Ct[0],De,!0),new ps(wt.x,wt.y,0))}else if(t.type==="LineString")for(const Ct of t.geometry){const wt=Qs(Ct,De);ut(wt,new ps(wt[0].x,wt[0].y,0))}else if(t.type==="Point")for(const Ct of t.geometry)for(const wt of Ct)ut([wt],new ps(wt.x,wt.y,0))}function Lg(o,t,i,a,h,m,g,v,C,T,M,I,B,F,O){const j=function(he,oe,L,q,ie,we,Oe,Te){const Me=q.layout.get("text-rotate").evaluate(we,{})*Math.PI/180,Ze=[];for(const je of oe.positionedLines)for(const qe of je.positionedGlyphs){if(!qe.rect)continue;const De=qe.rect||{};let ut=ib+1,Ct=!0,wt=1,pt=0;const Ut=(ie||Te)&&qe.vertical,Mr=qe.metrics.advance*qe.scale/2;if(Te&&oe.verticalizable&&(pt=je.lineOffset/2-(qe.imageName?-(Yr-qe.metrics.width*qe.scale)/2:(qe.scale-1)*Yr)),qe.imageName){const lo=Oe[qe.imageName];Ct=lo.sdf,wt=lo.pixelRatio,ut=Ho/wt}const Jr=ie?[qe.x+Mr,qe.y]:[0,0];let Co=ie?[0,0]:[qe.x+Mr+L[0],qe.y+L[1]-pt],Ci=[0,0];Ut&&(Ci=Co,Co=[0,0]);const Xo=qe.metrics.isDoubleResolution?2:1,po=(qe.metrics.left-ut)*qe.scale-Mr+Co[0],wr=(-qe.metrics.top-ut)*qe.scale+Co[1],so=po+De.w/Xo*qe.scale/wt,mo=wr+De.h/Xo*qe.scale/wt,go=new fe(po,wr),Fo=new fe(so,wr),Si=new fe(po,mo),ao=new fe(so,mo);if(Ut){const lo=new fe(-Mr,Mr-$h),co=-Math.PI/2,Ur=Yr/2-Mr,mr=new fe(5-$h-Ur,-(qe.imageName?Ur:0)),Vi=new fe(...Ci);go._rotateAround(co,lo)._add(mr)._add(Vi),Fo._rotateAround(co,lo)._add(mr)._add(Vi),Si._rotateAround(co,lo)._add(mr)._add(Vi),ao._rotateAround(co,lo)._add(mr)._add(Vi)}if(Me){const lo=Math.sin(Me),co=Math.cos(Me),Ur=[co,-lo,lo,co];go._matMult(Ur),Fo._matMult(Ur),Si._matMult(Ur),ao._matMult(Ur)}const Ko=new fe(0,0),Qr=new fe(0,0);Ze.push({tl:go,tr:Fo,bl:Si,br:ao,tex:De,writingMode:oe.writingMode,glyphOffset:Jr,sectionIndex:qe.sectionIndex,isSDF:Ct,pixelOffsetTL:Ko,pixelOffsetBR:Qr,minFontScaleX:0,minFontScaleY:0})}return Ze}(0,i,v,h,m,g,a,o.allowVerticalPlacement),W=o.textSizeData;let ee=null;W.kind==="source"?(ee=[sn*h.layout.get("text-size").evaluate(g,{})],ee[0]>ds&&qr(`${o.layerIds[0]}: Value for "text-size" is >= ${Hc}. Reduce your "text-size".`)):W.kind==="composite"&&(ee=[sn*F.compositeTextSizes[0].evaluate(g,{},O),sn*F.compositeTextSizes[1].evaluate(g,{},O)],(ee[0]>ds||ee[1]>ds)&&qr(`${o.layerIds[0]}: Value for "text-size" is >= ${Hc}. Reduce your "text-size".`)),o.addSymbols(o.text,j,ee,v,m,g,T,t,C.lineStartIndex,C.lineLength,B,O);for(const he of M)I[he]=o.text.placedSymbolArray.length-1;return 4*j.length}function Fg(o){for(const t in o)return o[t];return null}function Ab(o,t,i,a){const h=o.compareText;if(t in h){const m=h[t];for(let g=m.length-1;g>=0;g--)if(a.dist(m[g])<i)return!0}else h[t]=[];return h[t].push(a),!1}const Og=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Gf{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,a]=new Uint8Array(t,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=a>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=Og[15&a];if(!m)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(t,2,1),[v]=new Uint32Array(t,4,1);return new Gf(v,g,m,t)}constructor(t,i=64,a=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=a,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=Og.indexOf(this.ArrayType),g=2*t*this.ArrayType.BYTES_PER_ELEMENT,v=t*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-v%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${a}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+C,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+g+v+C),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+C,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t)}add(t,i){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=t,this.coords[this._pos++]=i,a}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return qf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,i,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:g,nodeSize:v}=this,C=[0,m.length-1,0],T=[];for(;C.length;){const M=C.pop()||0,I=C.pop()||0,B=C.pop()||0;if(I-B<=v){for(let W=B;W<=I;W++){const ee=g[2*W],he=g[2*W+1];ee>=t&&ee<=a&&he>=i&&he<=h&&T.push(m[W])}continue}const F=B+I>>1,O=g[2*F],j=g[2*F+1];O>=t&&O<=a&&j>=i&&j<=h&&T.push(m[F]),(M===0?t<=O:i<=j)&&(C.push(B),C.push(F-1),C.push(1-M)),(M===0?a>=O:h>=j)&&(C.push(F+1),C.push(I),C.push(1-M))}return T}within(t,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:g}=this,v=[0,h.length-1,0],C=[],T=a*a;for(;v.length;){const M=v.pop()||0,I=v.pop()||0,B=v.pop()||0;if(I-B<=g){for(let W=B;W<=I;W++)jg(m[2*W],m[2*W+1],t,i)<=T&&C.push(h[W]);continue}const F=B+I>>1,O=m[2*F],j=m[2*F+1];jg(O,j,t,i)<=T&&C.push(h[F]),(M===0?t-a<=O:i-a<=j)&&(v.push(B),v.push(F-1),v.push(1-M)),(M===0?t+a>=O:i+a>=j)&&(v.push(F+1),v.push(I),v.push(1-M))}return C}}function qf(o,t,i,a,h,m){if(h-a<=i)return;const g=a+h>>1;$g(o,t,g,a,h,m),qf(o,t,i,a,g-1,1-m),qf(o,t,i,g+1,h,1-m)}function $g(o,t,i,a,h,m){for(;h>a;){if(h-a>600){const T=h-a+1,M=i-a+1,I=Math.log(T),B=.5*Math.exp(2*I/3),F=.5*Math.sqrt(I*B*(T-B)/T)*(M-T/2<0?-1:1);$g(o,t,i,Math.max(a,Math.floor(i-M*B/T+F)),Math.min(h,Math.floor(i+(T-M)*B/T+F)),m)}const g=t[2*i+m];let v=a,C=h;for(Yc(o,t,a,i),t[2*h+m]>g&&Yc(o,t,a,h);v<C;){for(Yc(o,t,v,C),v++,C--;t[2*v+m]<g;)v++;for(;t[2*C+m]>g;)C--}t[2*a+m]===g?Yc(o,t,a,C):(C++,Yc(o,t,C,h)),C<=i&&(a=C+1),i<=C&&(h=C-1)}}function Yc(o,t,i,a){Wf(o,i,a),Wf(t,2*i,2*a),Wf(t,2*i+1,2*a+1)}function Wf(o,t,i){const a=o[t];o[t]=o[i],o[i]=a}function jg(o,t,i,a){const h=o-i,m=t-a;return h*h+m*m}var Hf;b.cg=void 0,(Hf=b.cg||(b.cg={})).create="create",Hf.load="load",Hf.fullLoad="fullLoad";let Hh=null,Jc=[];const Xf=1e3/60,Kf="loadTime",Yf="fullLoadTime",zb={mark(o){performance.mark(o)},frame(o){const t=o;Hh!=null&&Jc.push(t-Hh),Hh=t},clearMetrics(){Hh=null,Jc=[],performance.clearMeasures(Kf),performance.clearMeasures(Yf);for(const o in b.cg)performance.clearMarks(b.cg[o])},getPerformanceMetrics(){performance.measure(Kf,b.cg.create,b.cg.load),performance.measure(Yf,b.cg.create,b.cg.fullLoad);const o=performance.getEntriesByName(Kf)[0].duration,t=performance.getEntriesByName(Yf)[0].duration,i=Jc.length,a=1/(Jc.reduce((m,g)=>m+g,0)/i/1e3),h=Jc.filter(m=>m>Xf).reduce((m,g)=>m+(g-Xf)/Xf,0);return{loadTime:o,fullLoadTime:t,fps:a,percentDroppedFrames:h/(i+h)*100,totalFrames:i}}};b.$=Xc,b.A=nt,b.B=Go,b.C=vr,b.D=_t,b.E=ge,b.F=bh,b.G=function(o){if(ke==null){const t=o.navigator?o.navigator.userAgent:null;ke=!!o.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ke},b.H=class{constructor(o,t){this.target=o,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new wb(()=>this.process()),this.subscription=Je(this.target,"message",i=>this.receive(i),!1),this.globalScope=pe(self)?o:window}registerMessageHandler(o,t){this.messageHandlers[o]=t}sendAsync(o,t){return new Promise((i,a)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10),m=t?Je(t.signal,"abort",()=>{m==null||m.unsubscribe(),delete this.resolveRejects[h];const C={id:h,type:"<cancel>",origin:location.origin,targetMapId:o.targetMapId,sourceMapId:this.mapId};this.target.postMessage(C)},Cb):null;this.resolveRejects[h]={resolve:C=>{m==null||m.unsubscribe(),i(C)},reject:C=>{m==null||m.unsubscribe(),a(C)}};const g=[],v=Object.assign(Object.assign({},o),{id:h,sourceMapId:this.mapId,origin:location.origin,data:rn(o.data,g)});this.target.postMessage(v,{transfer:g})})}receive(o){const t=o.data,i=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[i];const a=this.abortControllers[i];return delete this.abortControllers[i],void(a&&a.abort())}if(pe(self)||t.mustQueue)return this.tasks[i]=t,this.taskQueue.push(i),void this.invoker.trigger();this.processTask(i,t)}}process(){if(this.taskQueue.length===0)return;const o=this.taskQueue.shift(),t=this.tasks[o];delete this.tasks[o],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(o,t)}processTask(o,t){return c(this,void 0,void 0,function*(){if(t.type==="<response>"){const h=this.resolveRejects[o];return delete this.resolveRejects[o],h?void(t.error?h.reject(qs(t.error)):h.resolve(qs(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(o,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const i=qs(t.data),a=new AbortController;this.abortControllers[o]=a;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,i,a);this.completeTask(o,null,h)}catch(h){this.completeTask(o,h)}})}completeTask(o,t,i){const a=[];delete this.abortControllers[o];const h={id:o,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?rn(t):null,data:rn(i,a)};this.target.postMessage(h,{transfer:a})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},b.I=zf,b.J=Ot,b.K=function(){var o=new nt(16);return nt!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},b.L=function(o,t,i){var a,h,m,g,v,C,T,M,I,B,F,O,j=i[0],W=i[1],ee=i[2];return t===o?(o[12]=t[0]*j+t[4]*W+t[8]*ee+t[12],o[13]=t[1]*j+t[5]*W+t[9]*ee+t[13],o[14]=t[2]*j+t[6]*W+t[10]*ee+t[14],o[15]=t[3]*j+t[7]*W+t[11]*ee+t[15]):(h=t[1],m=t[2],g=t[3],v=t[4],C=t[5],T=t[6],M=t[7],I=t[8],B=t[9],F=t[10],O=t[11],o[0]=a=t[0],o[1]=h,o[2]=m,o[3]=g,o[4]=v,o[5]=C,o[6]=T,o[7]=M,o[8]=I,o[9]=B,o[10]=F,o[11]=O,o[12]=a*j+v*W+I*ee+t[12],o[13]=h*j+C*W+B*ee+t[13],o[14]=m*j+T*W+F*ee+t[14],o[15]=g*j+M*W+O*ee+t[15]),o},b.M=function(o,t,i){var a=i[0],h=i[1],m=i[2];return o[0]=t[0]*a,o[1]=t[1]*a,o[2]=t[2]*a,o[3]=t[3]*a,o[4]=t[4]*h,o[5]=t[5]*h,o[6]=t[6]*h,o[7]=t[7]*h,o[8]=t[8]*m,o[9]=t[9]*m,o[10]=t[10]*m,o[11]=t[11]*m,o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},b.N=function(o,t,i){var a=t[0],h=t[1],m=t[2],g=t[3],v=t[4],C=t[5],T=t[6],M=t[7],I=t[8],B=t[9],F=t[10],O=t[11],j=t[12],W=t[13],ee=t[14],he=t[15],oe=i[0],L=i[1],q=i[2],ie=i[3];return o[0]=oe*a+L*v+q*I+ie*j,o[1]=oe*h+L*C+q*B+ie*W,o[2]=oe*m+L*T+q*F+ie*ee,o[3]=oe*g+L*M+q*O+ie*he,o[4]=(oe=i[4])*a+(L=i[5])*v+(q=i[6])*I+(ie=i[7])*j,o[5]=oe*h+L*C+q*B+ie*W,o[6]=oe*m+L*T+q*F+ie*ee,o[7]=oe*g+L*M+q*O+ie*he,o[8]=(oe=i[8])*a+(L=i[9])*v+(q=i[10])*I+(ie=i[11])*j,o[9]=oe*h+L*C+q*B+ie*W,o[10]=oe*m+L*T+q*F+ie*ee,o[11]=oe*g+L*M+q*O+ie*he,o[12]=(oe=i[12])*a+(L=i[13])*v+(q=i[14])*I+(ie=i[15])*j,o[13]=oe*h+L*C+q*B+ie*W,o[14]=oe*m+L*T+q*F+ie*ee,o[15]=oe*g+L*M+q*O+ie*he,o},b.O=function(o,t){const i={};for(let a=0;a<t.length;a++){const h=t[a];h in o&&(i[h]=o[h])}return i},b.P=fe,b.Q=fs,b.R=xi,b.S=mg,b.T=kc,b.U=pg,b.V=st,b.W=ye,b.X=Ve,b.Y=wi,b.Z=vt,b._=c,b.a=bt,b.a$=function(){const o=new Float32Array(16);return Xe(o),o},b.a0=Vf,b.a1=o=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(i=>{t.onloadstart=()=>{i(t)};for(const a of o){const h=window.document.createElement("source");Sr(a)||(t.crossOrigin="Anonymous"),h.src=a,t.appendChild(h)}})},b.a2=be,b.a3=function(){return yo++},b.a4=y,b.a5=ml,b.a6=Ga,b.a7=Wo,b.a8=wg,b.a9=function(o){const t={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,a,h,m)=>{const g=h||m;return t[a]=!g||g.toLowerCase(),""}),t["max-age"]){const i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t},b.aA=Df,b.aB=Gf,b.aC=Or,b.aD=Lh,b.aE=Q,b.aF=yt,b.aG=Ke,b.aH=function(o){return Math.pow(2,o)},b.aI=85.051129,b.aJ=gg,b.aK=Lr,b.aL=Ue,b.aM=_g,b.aN=function(o,t,i){return o[0]=t[0]*i,o[1]=t[1]*i,o[2]=t[2]*i,o},b.aO=function(o,t,i){return o[0]=t[0]+i[0],o[1]=t[1]+i[1],o[2]=t[2]+i[2],o},b.aP=function(o){var t=new nt(3);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t},b.aQ=function(o,t,i){return o[0]=t[0]*i[0],o[1]=t[1]*i[1],o[2]=t[2]*i[2],o[3]=t[3]*i[3],o},b.aR=function(o,t,i){return o[0]=t[0]-i[0],o[1]=t[1]-i[1],o[2]=t[2]-i[2],o},b.aS=function(o,t){var i=t[0],a=t[1],h=t[2],m=i*i+a*a+h*h;return m>0&&(m=1/Math.sqrt(m)),o[0]=t[0]*m,o[1]=t[1]*m,o[2]=t[2]*m,o},b.aT=function(o,t,i){var a=t[0],h=t[1],m=t[2],g=i[0],v=i[1],C=i[2];return o[0]=h*C-m*v,o[1]=m*g-a*C,o[2]=a*v-h*g,o},b.aU=function(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]},b.aV=vg,b.aW=gl,b.aX=function(o,t,i,a,h){var m,g=1/Math.tan(t/2);return o[0]=g/i,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=g,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,h!=null&&h!==1/0?(o[10]=(h+a)*(m=1/(a-h)),o[14]=2*h*a*m):(o[10]=-1,o[14]=-2*a),o},b.aY=function(o){var t=new nt(16);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],t},b.aZ=function(o,t,i){var a=Math.sin(i),h=Math.cos(i),m=t[0],g=t[1],v=t[2],C=t[3],T=t[4],M=t[5],I=t[6],B=t[7];return t!==o&&(o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=m*h+T*a,o[1]=g*h+M*a,o[2]=v*h+I*a,o[3]=C*h+B*a,o[4]=T*h-m*a,o[5]=M*h-g*a,o[6]=I*h-v*a,o[7]=B*h-C*a,o},b.a_=function(o,t,i){var a=Math.sin(i),h=Math.cos(i),m=t[4],g=t[5],v=t[6],C=t[7],T=t[8],M=t[9],I=t[10],B=t[11];return t!==o&&(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[4]=m*h+T*a,o[5]=g*h+M*a,o[6]=v*h+I*a,o[7]=C*h+B*a,o[8]=T*h-m*a,o[9]=M*h-g*a,o[10]=I*h-v*a,o[11]=B*h-C*a,o},b.aa=function(o){return Math.log(o)/Math.LN2},b.ab=function(o){var t=o[0],i=o[1];return t*t+i*i},b.ac=function(o){return o*Math.PI/180},b.ad=Gr,b.ae=function(o,t){const i=[];for(const a in o)a in t||i.push(a);return i},b.af=function(o,t){let i=0,a=0;if(o.kind==="constant")a=o.layoutSize;else if(o.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:g}=o,v=h?Gr(xo.interpolationFactor(h,t,m,g),0,1):0;o.kind==="camera"?a=Go.number(o.minSize,o.maxSize,v):i=v}return{uSizeT:i,uSize:a}},b.ah=function(o,{uSize:t,uSizeT:i},{lowerSize:a,upperSize:h}){return o.kind==="source"?a/sn:o.kind==="composite"?Go.number(a/sn,h/sn,i):t},b.ai=function(o,t){var i=t[0],a=t[1],h=t[2],m=t[3],g=t[4],v=t[5],C=t[6],T=t[7],M=t[8],I=t[9],B=t[10],F=t[11],O=t[12],j=t[13],W=t[14],ee=t[15],he=i*v-a*g,oe=i*C-h*g,L=i*T-m*g,q=a*C-h*v,ie=a*T-m*v,we=h*T-m*C,Oe=M*j-I*O,Te=M*W-B*O,Me=M*ee-F*O,Ze=I*W-B*j,je=I*ee-F*j,qe=B*ee-F*W,De=he*qe-oe*je+L*Ze+q*Me-ie*Te+we*Oe;return De?(o[0]=(v*qe-C*je+T*Ze)*(De=1/De),o[1]=(h*je-a*qe-m*Ze)*De,o[2]=(j*we-W*ie+ee*q)*De,o[3]=(B*ie-I*we-F*q)*De,o[4]=(C*Me-g*qe-T*Te)*De,o[5]=(i*qe-h*Me+m*Te)*De,o[6]=(W*L-O*we-ee*oe)*De,o[7]=(M*we-B*L+F*oe)*De,o[8]=(g*je-v*Me+T*Oe)*De,o[9]=(a*Me-i*je-m*Oe)*De,o[10]=(O*ie-j*L+ee*he)*De,o[11]=(I*L-M*ie-F*he)*De,o[12]=(v*Te-g*Ze-C*Oe)*De,o[13]=(i*Ze-a*Te+h*Oe)*De,o[14]=(j*oe-O*q-W*he)*De,o[15]=(M*q-I*oe+B*he)*De,o):null},b.aj=Bt,b.ak=function(o){return Math.hypot(o[0],o[1])},b.al=function(o){return o[0]=0,o[1]=0,o},b.am=function(o,t,i){return o[0]=t[0]*i,o[1]=t[1]*i,o},b.an=Lf,b.ao=ot,b.ap=function(o,t,i,a){const h=t.y-o.y,m=t.x-o.x,g=a.y-i.y,v=a.x-i.x,C=g*m-v*h;if(C===0)return null;const T=(v*(o.y-i.y)-g*(o.x-i.x))/C;return new fe(o.x+T*m,o.y+T*h)},b.aq=kg,b.ar=ll,b.as=Xe,b.at=function(o){let t=1/0,i=1/0,a=-1/0,h=-1/0;for(const m of o)t=Math.min(t,m.x),i=Math.min(i,m.y),a=Math.max(a,m.x),h=Math.max(h,m.y);return[t,i,a,h]},b.au=Yr,b.av=Et,b.aw=function(o,t,i,a,h=!1){if(!i[0]&&!i[1])return[0,0];const m=h?a==="map"?-o.bearingInRadians:0:a==="viewport"?o.bearingInRadians:0;if(m){const g=Math.sin(m),v=Math.cos(m);i=[i[0]*v-i[1]*g,i[0]*g+i[1]*v]}return[h?i[0]:Et(t,i[0],o.zoom),h?i[1]:Et(t,i[1],o.zoom)]},b.ay=Bf,b.az=Zf,b.b=Ge,b.b$=o=>o.type==="circle",b.b0=function(){const o=new Float64Array(16);return Xe(o),o},b.b1=function(){return new Float64Array(16)},b.b2=function(o,t,i){const a=new Float64Array(4);return function(h,m,g,v){var C=.5*Math.PI/180;m*=C,g*=C,v*=C;var T=Math.sin(m),M=Math.cos(m),I=Math.sin(g),B=Math.cos(g),F=Math.sin(v),O=Math.cos(v);h[0]=T*B*O-M*I*F,h[1]=M*I*O+T*B*F,h[2]=M*B*F-T*I*O,h[3]=M*B*O+T*I*F}(a,o,t-90,i),a},b.b3=function(o,t,i,a){var h,m,g,v,C,T=t[0],M=t[1],I=t[2],B=t[3],F=i[0],O=i[1],j=i[2],W=i[3];return(m=T*F+M*O+I*j+B*W)<0&&(m=-m,F=-F,O=-O,j=-j,W=-W),1-m>Ye?(h=Math.acos(m),g=Math.sin(h),v=Math.sin((1-a)*h)/g,C=Math.sin(a*h)/g):(v=1-a,C=a),o[0]=v*T+C*F,o[1]=v*M+C*O,o[2]=v*I+C*j,o[3]=v*B+C*W,o},b.b4=function(o){const t=new Float64Array(9);var i,a,h,m,g,v,C,T,M,I,B,F,O,j,W,ee,he,oe;I=(h=(a=o)[0])*(C=h+h),B=(m=a[1])*C,O=(g=a[2])*C,j=g*(T=m+m),ee=(v=a[3])*C,he=v*T,oe=v*(M=g+g),(i=t)[0]=1-(F=m*T)-(W=g*M),i[3]=B-oe,i[6]=O+he,i[1]=B+oe,i[4]=1-I-W,i[7]=j-ee,i[2]=O-he,i[5]=j+ee,i[8]=1-I-F;const L=Ue(-Math.asin(Gr(t[2],-1,1)));let q,ie;return Math.hypot(t[5],t[8])<.001?(q=0,ie=-Ue(Math.atan2(t[3],t[4]))):(q=Ue(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),ie=Ue(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:q,pitch:L+90,bearing:ie}},b.b5=function(o,t){return o.roll==t.roll&&o.pitch==t.pitch&&o.bearing==t.bearing},b.b6=Xt,b.b7=En,b.b8=fl,b.b9=Nc,b.bA=function(o){const t=[],i=o.id;return i===void 0&&t.push({message:`layers.${i}: missing required property "id"`}),o.render===void 0&&t.push({message:`layers.${i}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},b.bB=function o(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(let a=0;a<t.length;a++)if(!o(t[a],i[a]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(const a in t)if(!o(t[a],i[a]))return!1;return!0}return t===i},b.bC=Ao,b.bD=Vo,b.bE=class extends di{constructor(o,t){super(o,t),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},b.bF=An,b.bG=class extends di{constructor(o,t){super(o,t),this.current=fi}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let t=1;t<16;t++)if(o[t]!==this.current[t]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},b.bH=Ys,b.bI=class extends di{constructor(o,t){super(o,t),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},b.bJ=class extends di{constructor(o,t){super(o,t),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},b.bK=rt,b.bL=function(o,t){var i=Math.sin(t),a=Math.cos(t);return o[0]=a,o[1]=i,o[2]=0,o[3]=-i,o[4]=a,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},b.bM=function(o,t,i){var a=t[0],h=t[1],m=t[2];return o[0]=a*i[0]+h*i[3]+m*i[6],o[1]=a*i[1]+h*i[4]+m*i[7],o[2]=a*i[2]+h*i[5]+m*i[8],o},b.bN=function(o,t,i,a,h,m,g){var v=1/(t-i),C=1/(a-h),T=1/(m-g);return o[0]=-2*v,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*C,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*T,o[11]=0,o[12]=(t+i)*v,o[13]=(h+a)*C,o[14]=(g+m)*T,o[15]=1,o},b.bO=class extends ol{},b.bP=Jv,b.bQ=class extends il{},b.bR=gf,b.bS=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},b.bT=xm,b.bU=function(o,t,i){var a=t[0],h=t[1],m=t[2],g=i[3]*a+i[7]*h+i[11]*m+i[15];return o[0]=(i[0]*a+i[4]*h+i[8]*m+i[12])/(g=g||1),o[1]=(i[1]*a+i[5]*h+i[9]*m+i[13])/g,o[2]=(i[2]*a+i[6]*h+i[10]*m+i[14])/g,o},b.bV=class extends Ic{},b.bW=class extends l{},b.bX=function(o,t){return o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]&&o[3]===t[3]&&o[4]===t[4]&&o[5]===t[5]&&o[6]===t[6]&&o[7]===t[7]&&o[8]===t[8]&&o[9]===t[9]&&o[10]===t[10]&&o[11]===t[11]&&o[12]===t[12]&&o[13]===t[13]&&o[14]===t[14]&&o[15]===t[15]},b.bY=function(o,t){var i=o[0],a=o[1],h=o[2],m=o[3],g=o[4],v=o[5],C=o[6],T=o[7],M=o[8],I=o[9],B=o[10],F=o[11],O=o[12],j=o[13],W=o[14],ee=o[15],he=t[0],oe=t[1],L=t[2],q=t[3],ie=t[4],we=t[5],Oe=t[6],Te=t[7],Me=t[8],Ze=t[9],je=t[10],qe=t[11],De=t[12],ut=t[13],Ct=t[14],wt=t[15];return Math.abs(i-he)<=Ye*Math.max(1,Math.abs(i),Math.abs(he))&&Math.abs(a-oe)<=Ye*Math.max(1,Math.abs(a),Math.abs(oe))&&Math.abs(h-L)<=Ye*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(m-q)<=Ye*Math.max(1,Math.abs(m),Math.abs(q))&&Math.abs(g-ie)<=Ye*Math.max(1,Math.abs(g),Math.abs(ie))&&Math.abs(v-we)<=Ye*Math.max(1,Math.abs(v),Math.abs(we))&&Math.abs(C-Oe)<=Ye*Math.max(1,Math.abs(C),Math.abs(Oe))&&Math.abs(T-Te)<=Ye*Math.max(1,Math.abs(T),Math.abs(Te))&&Math.abs(M-Me)<=Ye*Math.max(1,Math.abs(M),Math.abs(Me))&&Math.abs(I-Ze)<=Ye*Math.max(1,Math.abs(I),Math.abs(Ze))&&Math.abs(B-je)<=Ye*Math.max(1,Math.abs(B),Math.abs(je))&&Math.abs(F-qe)<=Ye*Math.max(1,Math.abs(F),Math.abs(qe))&&Math.abs(O-De)<=Ye*Math.max(1,Math.abs(O),Math.abs(De))&&Math.abs(j-ut)<=Ye*Math.max(1,Math.abs(j),Math.abs(ut))&&Math.abs(W-Ct)<=Ye*Math.max(1,Math.abs(W),Math.abs(Ct))&&Math.abs(ee-wt)<=Ye*Math.max(1,Math.abs(ee),Math.abs(wt))},b.bZ=function(o,t){return o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},b.b_=o=>o.type==="symbol",b.ba=dl,b.bb=Ar,b.bc=zr,b.bd=Ro,b.be=function(o,t,i,a,h){return Ar(a,h,Gr((o-t)/(i-t),0,1))},b.bf=Ft,b.bg=function(){return new Float64Array(4)},b.bh=function(){return new Float64Array(3)},b.bi=function(o,t,i,a){var h=[],m=[];return h[0]=t[0]-i[0],h[1]=t[1]-i[1],h[2]=t[2]-i[2],m[0]=h[0]*Math.cos(a)-h[1]*Math.sin(a),m[1]=h[0]*Math.sin(a)+h[1]*Math.cos(a),m[2]=h[2],o[0]=m[0]+i[0],o[1]=m[1]+i[1],o[2]=m[2]+i[2],o},b.bj=function(o,t,i,a){var h=[],m=[];return h[0]=t[0]-i[0],h[1]=t[1]-i[1],h[2]=t[2]-i[2],m[0]=h[0],m[1]=h[1]*Math.cos(a)-h[2]*Math.sin(a),m[2]=h[1]*Math.sin(a)+h[2]*Math.cos(a),o[0]=m[0]+i[0],o[1]=m[1]+i[1],o[2]=m[2]+i[2],o},b.bk=function(o,t,i,a){var h=[],m=[];return h[0]=t[0]-i[0],h[1]=t[1]-i[1],h[2]=t[2]-i[2],m[0]=h[2]*Math.sin(a)+h[0]*Math.cos(a),m[1]=h[1],m[2]=h[2]*Math.cos(a)-h[0]*Math.sin(a),o[0]=m[0]+i[0],o[1]=m[1]+i[1],o[2]=m[2]+i[2],o},b.bl=function(o,t,i){var a=Math.sin(i),h=Math.cos(i),m=t[0],g=t[1],v=t[2],C=t[3],T=t[8],M=t[9],I=t[10],B=t[11];return t!==o&&(o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=m*h-T*a,o[1]=g*h-M*a,o[2]=v*h-I*a,o[3]=C*h-B*a,o[8]=m*a+T*h,o[9]=g*a+M*h,o[10]=v*a+I*h,o[11]=C*a+B*h,o},b.bm=function(o,t){const i=Ft(o,360),a=Ft(t,360),h=a-i,m=a>i?h-360:h+360;return Math.abs(h)<Math.abs(m)?h:m},b.bn=function(o){return o[0]=0,o[1]=0,o[2]=0,o},b.bo=function(o,t,i,a){const h=Math.sqrt(o*o+t*t),m=Math.sqrt(i*i+a*a);o/=h,t/=h,i/=m,a/=m;const g=Math.acos(o*i+t*a);return-t*i+o*a>0?g:-g},b.bp=function(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]+o[3]},b.bq=jf,b.br=function(o,t){const i=Ft(o,2*Math.PI),a=Ft(t,2*Math.PI);return Math.min(Math.abs(i-a),Math.abs(i-a+2*Math.PI),Math.abs(i-a-2*Math.PI))},b.bs=function(o){return Math.hypot(o[0],o[1],o[2])},b.bt=function(){const o={},t=A.$version;for(const i in A.$root){const a=A.$root[i];if(a.required){let h=null;h=i==="version"?t:a.type==="array"?[]:{},h!=null&&(o[i]=h)}}return o},b.bu=Ha,b.bv=Vt,b.bw=function(o){o=o.slice();const t=Object.create(null);for(let i=0;i<o.length;i++)t[o[i].id]=o[i];for(let i=0;i<o.length;i++)"ref"in o[i]&&(o[i]=X(o[i],t[o[i].ref]));return o},b.bx=function(o){if(o.type==="custom")return new xb(o);switch(o.type){case"background":return new yb(o);case"circle":return new fv(o);case"fill":return new zv(o);case"fill-extrusion":return new jv(o);case"heatmap":return new mv(o);case"hillshade":return new _v(o);case"line":return new Hv(o);case"raster":return new bb(o);case"symbol":return new Uh(o)}},b.by=to,b.bz=function(o,t){if(!o)return[{command:"setStyle",args:[t]}];let i=[];try{if(!te(o.version,t.version))return[{command:"setStyle",args:[t]}];te(o.center,t.center)||i.push({command:"setCenter",args:[t.center]}),te(o.centerAltitude,t.centerAltitude)||i.push({command:"setCenterAltitude",args:[t.centerAltitude]}),te(o.zoom,t.zoom)||i.push({command:"setZoom",args:[t.zoom]}),te(o.bearing,t.bearing)||i.push({command:"setBearing",args:[t.bearing]}),te(o.pitch,t.pitch)||i.push({command:"setPitch",args:[t.pitch]}),te(o.roll,t.roll)||i.push({command:"setRoll",args:[t.roll]}),te(o.sprite,t.sprite)||i.push({command:"setSprite",args:[t.sprite]}),te(o.glyphs,t.glyphs)||i.push({command:"setGlyphs",args:[t.glyphs]}),te(o.transition,t.transition)||i.push({command:"setTransition",args:[t.transition]}),te(o.light,t.light)||i.push({command:"setLight",args:[t.light]}),te(o.terrain,t.terrain)||i.push({command:"setTerrain",args:[t.terrain]}),te(o.sky,t.sky)||i.push({command:"setSky",args:[t.sky]}),te(o.projection,t.projection)||i.push({command:"setProjection",args:[t.projection]});const a={},h=[];(function(g,v,C,T){let M;for(M in v=v||{},g=g||{})Object.prototype.hasOwnProperty.call(g,M)&&(Object.prototype.hasOwnProperty.call(v,M)||Se(M,C,T));for(M in v)Object.prototype.hasOwnProperty.call(v,M)&&(Object.prototype.hasOwnProperty.call(g,M)?te(g[M],v[M])||(g[M].type==="geojson"&&v[M].type==="geojson"&&ze(g,v,M)?le(C,{command:"setGeoJSONSourceData",args:[M,v[M].data]}):me(M,v,C,T)):_e(M,v,C))})(o.sources,t.sources,h,a);const m=[];o.layers&&o.layers.forEach(g=>{"source"in g&&a[g.source]?i.push({command:"removeLayer",args:[g.id]}):m.push(g)}),i=i.concat(h),function(g,v,C){v=v||[];const T=(g=g||[]).map(ve),M=v.map(ve),I=g.reduce(Fe,{}),B=v.reduce(Fe,{}),F=T.slice(),O=Object.create(null);let j,W,ee,he,oe;for(let L=0,q=0;L<T.length;L++)j=T[L],Object.prototype.hasOwnProperty.call(B,j)?q++:(le(C,{command:"removeLayer",args:[j]}),F.splice(F.indexOf(j,q),1));for(let L=0,q=0;L<M.length;L++)j=M[M.length-1-L],F[F.length-1-L]!==j&&(Object.prototype.hasOwnProperty.call(I,j)?(le(C,{command:"removeLayer",args:[j]}),F.splice(F.lastIndexOf(j,F.length-q),1)):q++,he=F[F.length-L],le(C,{command:"addLayer",args:[B[j],he]}),F.splice(F.length-L,0,j),O[j]=!0);for(let L=0;L<M.length;L++)if(j=M[L],W=I[j],ee=B[j],!O[j]&&!te(W,ee))if(te(W.source,ee.source)&&te(W["source-layer"],ee["source-layer"])&&te(W.type,ee.type)){for(oe in Pe(W.layout,ee.layout,C,j,null,"setLayoutProperty"),Pe(W.paint,ee.paint,C,j,null,"setPaintProperty"),te(W.filter,ee.filter)||le(C,{command:"setFilter",args:[j,ee.filter]}),te(W.minzoom,ee.minzoom)&&te(W.maxzoom,ee.maxzoom)||le(C,{command:"setLayerZoomRange",args:[j,ee.minzoom,ee.maxzoom]}),W)Object.prototype.hasOwnProperty.call(W,oe)&&oe!=="layout"&&oe!=="paint"&&oe!=="filter"&&oe!=="metadata"&&oe!=="minzoom"&&oe!=="maxzoom"&&(oe.indexOf("paint.")===0?Pe(W[oe],ee[oe],C,j,oe.slice(6),"setPaintProperty"):te(W[oe],ee[oe])||le(C,{command:"setLayerProperty",args:[j,oe,ee[oe]]}));for(oe in ee)Object.prototype.hasOwnProperty.call(ee,oe)&&!Object.prototype.hasOwnProperty.call(W,oe)&&oe!=="layout"&&oe!=="paint"&&oe!=="filter"&&oe!=="metadata"&&oe!=="minzoom"&&oe!=="maxzoom"&&(oe.indexOf("paint.")===0?Pe(W[oe],ee[oe],C,j,oe.slice(6),"setPaintProperty"):te(W[oe],ee[oe])||le(C,{command:"setLayerProperty",args:[j,oe,ee[oe]]}))}else le(C,{command:"removeLayer",args:[j]}),he=F[F.lastIndexOf(j)+1],le(C,{command:"addLayer",args:[ee,he]})}(m,t.layers,i)}catch(a){console.warn("Unable to compute style diff:",a),i=[{command:"setStyle",args:[t]}]}return i},b.c=at,b.c0=o=>o.type==="heatmap",b.c1=o=>o.type==="line",b.c2=o=>o.type==="fill",b.c3=o=>o.type==="fill-extrusion",b.c4=o=>o.type==="hillshade",b.c5=o=>o.type==="raster",b.c6=o=>o.type==="background",b.c7=o=>o.type==="custom",b.c8=_r,b.c9=function(o,t,i){const a=gr(t.x-i.x,t.y-i.y),h=gr(o.x-i.x,o.y-i.y);var m,g;return Ue(Math.atan2(a[0]*h[1]-a[1]*h[0],(m=a)[0]*(g=h)[0]+m[1]*g[1]))},b.cA=H,b.cB=Om,b.cC=Km,b.cD=Sn,b.cE=on,b.ca=or,b.cb=function(o,t,i){var a=t[0],h=t[1];return o[0]=i[0]*a+i[4]*h+i[12],o[1]=i[1]*a+i[5]*h+i[13],o},b.cc=function(o,t){const{x:i,y:a}=Xc.fromLngLat(t);return!(o<0||o>25||a<0||a>=1||i<0||i>=1)},b.cd=function(o,t){return o[0]=t[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=t[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=t[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},b.ce=class extends el{},b.cf=zb,b.ch=function(o){return o.message===St},b.ci=qt,b.cj=function(o,t){bt.REGISTERED_PROTOCOLS[o]=t},b.ck=function(o){delete bt.REGISTERED_PROTOCOLS[o]},b.cl=function(o,t){const i={};for(let h=0;h<o.length;h++){const m=t&&t[o[h].id]||dc(o[h]);t&&(t[o[h].id]=m);let g=i[m];g||(g=i[m]=[]),g.push(o[h])}const a=[];for(const h in i)a.push(i[h]);return a},b.cm=ct,b.cn=xg,b.co=Cg,b.cp=Jm,b.cq=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=vt/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;const t=o.bucket.layers[0],i=t.layout,a=t._unevaluatedLayout._values,h={layoutIconSize:a["icon-size"].possiblyEvaluate(new vr(o.bucket.zoom+1),o.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new vr(o.bucket.zoom+1),o.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new vr(18))};if(o.bucket.textSizeData.kind==="composite"){const{minZoom:T,maxZoom:M}=o.bucket.textSizeData;h.compositeTextSizes=[a["text-size"].possiblyEvaluate(new vr(T),o.canonical),a["text-size"].possiblyEvaluate(new vr(M),o.canonical)]}if(o.bucket.iconSizeData.kind==="composite"){const{minZoom:T,maxZoom:M}=o.bucket.iconSizeData;h.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new vr(T),o.canonical),a["icon-size"].possiblyEvaluate(new vr(M),o.canonical)]}const m=i.get("text-line-height")*Yr,g=i.get("text-rotation-alignment")!=="viewport"&&i.get("symbol-placement")!=="point",v=i.get("text-keep-upright"),C=i.get("text-size");for(const T of o.bucket.features){const M=i.get("text-font").evaluate(T,{},o.canonical).join(","),I=C.evaluate(T,{},o.canonical),B=h.layoutTextSize.evaluate(T,{},o.canonical),F=h.layoutIconSize.evaluate(T,{},o.canonical),O={horizontal:{},vertical:void 0},j=T.text;let W,ee=[0,0];if(j){const L=j.toString(),q=i.get("text-letter-spacing").evaluate(T,{},o.canonical)*Yr,ie=wh(L)?q:0,we=i.get("text-anchor").evaluate(T,{},o.canonical),Oe=Bg(t,T,o.canonical);if(!Oe){const je=i.get("text-radial-offset").evaluate(T,{},o.canonical);ee=je?Dg(we,[je*Yr,Uf]):i.get("text-offset").evaluate(T,{},o.canonical).map(qe=>qe*Yr)}let Te=g?"center":i.get("text-justify").evaluate(T,{},o.canonical);const Me=i.get("symbol-placement")==="point"?i.get("text-max-width").evaluate(T,{},o.canonical)*Yr:1/0,Ze=()=>{o.bucket.allowVerticalPlacement&&Xa(L)&&(O.vertical=jh(j,o.glyphMap,o.glyphPositions,o.imagePositions,M,Me,m,we,"left",ie,ee,b.ag.vertical,!0,B,I))};if(!g&&Oe){const je=new Set;if(Te==="auto")for(let De=0;De<Oe.values.length;De+=2)je.add(Zf(Oe.values[De]));else je.add(Te);let qe=!1;for(const De of je)if(!O.horizontal[De])if(qe)O.horizontal[De]=O.horizontal[0];else{const ut=jh(j,o.glyphMap,o.glyphPositions,o.imagePositions,M,Me,m,"center",De,ie,ee,b.ag.horizontal,!1,B,I);ut&&(O.horizontal[De]=ut,qe=ut.positionedLines.length===1)}Ze()}else{Te==="auto"&&(Te=Zf(we));const je=jh(j,o.glyphMap,o.glyphPositions,o.imagePositions,M,Me,m,we,Te,ie,ee,b.ag.horizontal,!1,B,I);je&&(O.horizontal[Te]=je),Ze(),Xa(L)&&g&&v&&(O.vertical=jh(j,o.glyphMap,o.glyphPositions,o.imagePositions,M,Me,m,we,Te,ie,ee,b.ag.vertical,!1,B,I))}}let he=!1;if(T.icon&&T.icon.name){const L=o.imageMap[T.icon.name];L&&(W=fb(o.imagePositions[T.icon.name],i.get("icon-offset").evaluate(T,{},o.canonical),i.get("icon-anchor").evaluate(T,{},o.canonical)),he=!!L.sdf,o.bucket.sdfIcons===void 0?o.bucket.sdfIcons=he:o.bucket.sdfIcons!==he&&qr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(L.pixelRatio!==o.bucket.pixelRatio||i.get("icon-rotate").constantOr(1)!==0)&&(o.bucket.iconsNeedLinear=!0))}const oe=Fg(O.horizontal)||O.vertical;o.bucket.iconsInText=!!oe&&oe.iconsInText,(oe||W)&&Eb(o.bucket,T,O,W,o.imageMap,h,B,F,ee,he,o.canonical,o.subdivisionGranularity)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},b.cr=Pf,b.cs=xf,b.ct=kf,b.cu=Uc,b.cv=Ef,b.cw=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return o.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},b.cx=function(o,t,i,a,h){return c(this,void 0,void 0,function*(){if(ye())try{return yield Ve(o,t,i,a,h)}catch{}return function(m,g,v,C,T){const M=m.width,I=m.height;it&&tt||(it=new OffscreenCanvas(M,I),tt=it.getContext("2d",{willReadFrequently:!0})),it.width=M,it.height=I,tt.drawImage(m,0,0,M,I);const B=tt.getImageData(g,v,C,T);return tt.clearRect(0,0,M,I),B.data}(o,t,i,a,h)})},b.cy=bg,b.cz=R,b.d=Sr,b.e=Rr,b.f=o=>c(void 0,void 0,void 0,function*(){if(o.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(o)],{type:"image/png"});try{return createImageBitmap(t)}catch(i){throw new Error(`Could not load image because of ${i.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),b.g=It,b.h=o=>new Promise((t,i)=>{const a=new Image;a.onload=()=>{t(a),URL.revokeObjectURL(a.src),a.onload=null,window.requestAnimationFrame(()=>{a.src=Ne})},a.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(o)],{type:"image/png"});a.src=o.byteLength?URL.createObjectURL(h):Ne}),b.i=pe,b.j=(o,t)=>Dr(Rr(o,{type:"json"}),t),b.k=oi,b.l=gi,b.m=Dr,b.n=(o,t)=>Dr(Rr(o,{type:"arrayBuffer"}),t),b.o=function(o){return new Ef(o).readFields(tb,[])},b.p=Ym,b.q=Lc,b.r=Lo,b.s=Je,b.t=Zs,b.u=jt,b.v=A,b.w=qr,b.x=Wa,b.y=as,b.z=function([o,t,i]){return t+=90,t*=Math.PI/180,i*=Math.PI/180,{x:o*Math.cos(t)*Math.sin(i),y:o*Math.sin(t)*Math.sin(i),z:o*Math.cos(i)}}}),w("worker",["./shared"],function(b){class c{constructor(A){this.keyCache={},A&&this.replace(A)}replace(A){this._layerConfigs={},this._layers={},this.update(A,[])}update(A,U){for(const te of A){this._layerConfigs[te.id]=te;const le=this._layers[te.id]=b.bx(te);le._featureFilter=b.a6(le.filter),this.keyCache[te.id]&&delete this.keyCache[te.id]}for(const te of U)delete this.keyCache[te],delete this._layerConfigs[te],delete this._layers[te];this.familiesBySource={};const X=b.cl(Object.values(this._layerConfigs),this.keyCache);for(const te of X){const le=te.map(ve=>this._layers[ve.id]),_e=le[0];if(_e.visibility==="none")continue;const Se=_e.source||"";let me=this.familiesBySource[Se];me||(me=this.familiesBySource[Se]={});const ze=_e.sourceLayer||"_geojsonTileLayer";let Pe=me[ze];Pe||(Pe=me[ze]=[]),Pe.push(le)}}}class R{constructor(A){const U={},X=[];for(const Se in A){const me=A[Se],ze=U[Se]={};for(const Pe in me){const ve=me[+Pe];if(!ve||ve.bitmap.width===0||ve.bitmap.height===0)continue;const Fe={x:0,y:0,w:ve.bitmap.width+2,h:ve.bitmap.height+2};X.push(Fe),ze[Pe]={rect:Fe,metrics:ve.metrics}}}const{w:te,h:le}=b.p(X),_e=new b.q({width:te||1,height:le||1});for(const Se in A){const me=A[Se];for(const ze in me){const Pe=me[+ze];if(!Pe||Pe.bitmap.width===0||Pe.bitmap.height===0)continue;const ve=U[Se][ze].rect;b.q.copy(Pe.bitmap,_e,{x:0,y:0},{x:ve.x+1,y:ve.y+1},Pe.bitmap)}}this.image=_e,this.positions=U}}b.cm("GlyphAtlas",R);class Z{constructor(A){this.tileID=new b.Y(A.tileID.overscaledZ,A.tileID.wrap,A.tileID.canonical.z,A.tileID.canonical.x,A.tileID.canonical.y),this.uid=A.uid,this.zoom=A.zoom,this.pixelRatio=A.pixelRatio,this.tileSize=A.tileSize,this.source=A.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=A.showCollisionBoxes,this.collectResourceTiming=!!A.collectResourceTiming,this.returnDependencies=!!A.returnDependencies,this.promoteId=A.promoteId,this.inFlightDependencies=[]}parse(A,U,X,te,le){return b._(this,void 0,void 0,function*(){this.status="parsing",this.data=A,this.collisionBoxArray=new b.a4;const _e=new b.cn(Object.keys(A.layers).sort()),Se=new b.co(this.tileID,this.promoteId);Se.bucketLayerIDs=[];const me={},ze={featureIndex:Se,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:X,subdivisionGranularity:le},Pe=U.familiesBySource[this.source];for(const Mt in Pe){const $t=A.layers[Mt];if(!$t)continue;$t.version===1&&b.w(`Vector tile source "${this.source}" layer "${Mt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xt=_e.encode(Mt),pn=[];for(let Nr=0;Nr<$t.length;Nr++){const Wr=$t.feature(Nr),fr=Se.getId(Wr,Mt);pn.push({feature:Wr,id:fr,index:Nr,sourceLayerIndex:xt})}for(const Nr of Pe[Mt]){const Wr=Nr[0];Wr.source!==this.source&&b.w(`layer.source = ${Wr.source} does not equal this.source = ${this.source}`),Wr.minzoom&&this.zoom<Math.floor(Wr.minzoom)||Wr.maxzoom&&this.zoom>=Wr.maxzoom||Wr.visibility!=="none"&&(V(Nr,this.zoom,X),(me[Wr.id]=Wr.createBucket({index:Se.bucketLayerIDs.length,layers:Nr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xt,sourceID:this.source})).populate(pn,ze,this.tileID.canonical),Se.bucketLayerIDs.push(Nr.map(fr=>fr.id)))}}const ve=b.bC(ze.glyphDependencies,Mt=>Object.keys(Mt).map(Number));this.inFlightDependencies.forEach(Mt=>Mt==null?void 0:Mt.abort()),this.inFlightDependencies=[];let Fe=Promise.resolve({});if(Object.keys(ve).length){const Mt=new AbortController;this.inFlightDependencies.push(Mt),Fe=te.sendAsync({type:"GG",data:{stacks:ve,source:this.source,tileID:this.tileID,type:"glyphs"}},Mt)}const be=Object.keys(ze.iconDependencies);let Qe=Promise.resolve({});if(be.length){const Mt=new AbortController;this.inFlightDependencies.push(Mt),Qe=te.sendAsync({type:"GI",data:{icons:be,source:this.source,tileID:this.tileID,type:"icons"}},Mt)}const gt=Object.keys(ze.patternDependencies);let zt=Promise.resolve({});if(gt.length){const Mt=new AbortController;this.inFlightDependencies.push(Mt),zt=te.sendAsync({type:"GI",data:{icons:gt,source:this.source,tileID:this.tileID,type:"patterns"}},Mt)}const[Pt,Le,dt]=yield Promise.all([Fe,Qe,zt]),ht=new R(Pt),Lt=new b.cp(Le,dt);for(const Mt in me){const $t=me[Mt];$t instanceof b.a5?(V($t.layers,this.zoom,X),b.cq({bucket:$t,glyphMap:Pt,glyphPositions:ht.positions,imageMap:Le,imagePositions:Lt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ze.subdivisionGranularity})):$t.hasPattern&&($t instanceof b.cr||$t instanceof b.cs||$t instanceof b.ct)&&(V($t.layers,this.zoom,X),$t.addFeatures(ze,this.tileID.canonical,Lt.patternPositions))}return this.status="done",{buckets:Object.values(me).filter(Mt=>!Mt.isEmpty()),featureIndex:Se,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ht.image,imageAtlas:Lt,glyphMap:this.returnDependencies?Pt:null,iconMap:this.returnDependencies?Le:null,glyphPositions:this.returnDependencies?ht.positions:null}})}}function V(ge,A,U){const X=new b.C(A);for(const te of ge)te.recalculate(X,U)}class H{constructor(A,U,X){this.actor=A,this.layerIndex=U,this.availableImages=X,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(A,U){return b._(this,void 0,void 0,function*(){const X=yield b.n(A.request,U);try{return{vectorTile:new b.cu.VectorTile(new b.cv(X.data)),rawData:X.data,cacheControl:X.cacheControl,expires:X.expires}}catch(te){const le=new Uint8Array(X.data);let _e=`Unable to parse the tile at ${A.request.url}, `;throw _e+=le[0]===31&&le[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${te.message}`,new Error(_e)}})}loadTile(A){return b._(this,void 0,void 0,function*(){const U=A.uid,X=!!(A&&A.request&&A.request.collectResourceTiming)&&new b.cw(A.request),te=new Z(A);this.loading[U]=te;const le=new AbortController;te.abort=le;try{const _e=yield this.loadVectorTile(A,le);if(delete this.loading[U],!_e)return null;const Se=_e.rawData,me={};_e.expires&&(me.expires=_e.expires),_e.cacheControl&&(me.cacheControl=_e.cacheControl);const ze={};if(X){const ve=X.finish();ve&&(ze.resourceTiming=JSON.parse(JSON.stringify(ve)))}te.vectorTile=_e.vectorTile;const Pe=te.parse(_e.vectorTile,this.layerIndex,this.availableImages,this.actor,A.subdivisionGranularity);this.loaded[U]=te,this.fetching[U]={rawTileData:Se,cacheControl:me,resourceTiming:ze};try{const ve=yield Pe;return b.e({rawTileData:Se.slice(0)},ve,me,ze)}finally{delete this.fetching[U]}}catch(_e){throw delete this.loading[U],te.status="done",this.loaded[U]=te,_e}})}reloadTile(A){return b._(this,void 0,void 0,function*(){const U=A.uid;if(!this.loaded||!this.loaded[U])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const X=this.loaded[U];if(X.showCollisionBoxes=A.showCollisionBoxes,X.status==="parsing"){const te=yield X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,A.subdivisionGranularity);let le;if(this.fetching[U]){const{rawTileData:_e,cacheControl:Se,resourceTiming:me}=this.fetching[U];delete this.fetching[U],le=b.e({rawTileData:_e.slice(0)},te,Se,me)}else le=te;return le}if(X.status==="done"&&X.vectorTile)return X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,A.subdivisionGranularity)})}abortTile(A){return b._(this,void 0,void 0,function*(){const U=this.loading,X=A.uid;U&&U[X]&&U[X].abort&&(U[X].abort.abort(),delete U[X])})}removeTile(A){return b._(this,void 0,void 0,function*(){this.loaded&&this.loaded[A.uid]&&delete this.loaded[A.uid]})}}class K{constructor(){this.loaded={}}loadTile(A){return b._(this,void 0,void 0,function*(){const{uid:U,encoding:X,rawImageData:te,redFactor:le,greenFactor:_e,blueFactor:Se,baseShift:me}=A,ze=te.width+2,Pe=te.height+2,ve=b.b(te)?new b.R({width:ze,height:Pe},yield b.cx(te,-1,-1,ze,Pe)):te,Fe=new b.cy(U,ve,X,le,_e,Se,me);return this.loaded=this.loaded||{},this.loaded[U]=Fe,Fe})}removeTile(A){const U=this.loaded,X=A.uid;U&&U[X]&&delete U[X]}}var G,fe,Be=function(){if(fe)return G;function ge(U,X){if(U.length!==0){A(U[0],X);for(var te=1;te<U.length;te++)A(U[te],!X)}}function A(U,X){for(var te=0,le=0,_e=0,Se=U.length,me=Se-1;_e<Se;me=_e++){var ze=(U[_e][0]-U[me][0])*(U[me][1]+U[_e][1]),Pe=te+ze;le+=Math.abs(te)>=Math.abs(ze)?te-Pe+ze:ze-Pe+te,te=Pe}te+le>=0!=!!X&&U.reverse()}return fe=1,G=function U(X,te){var le,_e=X&&X.type;if(_e==="FeatureCollection")for(le=0;le<X.features.length;le++)U(X.features[le],te);else if(_e==="GeometryCollection")for(le=0;le<X.geometries.length;le++)U(X.geometries[le],te);else if(_e==="Feature")U(X.geometry,te);else if(_e==="Polygon")ge(X.coordinates,te);else if(_e==="MultiPolygon")for(le=0;le<X.coordinates.length;le++)ge(X.coordinates[le],te);return X}}(),et=b.cz(Be);const We=b.cu.VectorTileFeature.prototype.toGeoJSON;class lt{constructor(A){this._feature=A,this.extent=b.Z,this.type=A.type,this.properties=A.tags,"id"in A&&!isNaN(A.id)&&(this.id=parseInt(A.id,10))}loadGeometry(){if(this._feature.type===1){const A=[];for(const U of this._feature.geometry)A.push([new b.P(U[0],U[1])]);return A}{const A=[];for(const U of this._feature.geometry){const X=[];for(const te of U)X.push(new b.P(te[0],te[1]));A.push(X)}return A}}toGeoJSON(A,U,X){return We.call(this,A,U,X)}}class st{constructor(A){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=b.Z,this.length=A.length,this._features=A}feature(A){return new lt(this._features[A])}}var ye,Ae,Ye,nt={exports:{}},rt=function(){if(Ye)return nt.exports;Ye=1;var ge=b.cC(),A=function(){if(Ae)return ye;Ae=1;var Pe=b.cA(),ve=b.cB().VectorTileFeature;function Fe(Qe,gt){this.options=gt||{},this.features=Qe,this.length=Qe.length}function be(Qe,gt){this.id=typeof Qe.id=="number"?Qe.id:void 0,this.type=Qe.type,this.rawGeometry=Qe.type===1?[Qe.geometry]:Qe.geometry,this.properties=Qe.tags,this.extent=gt||4096}return ye=Fe,Fe.prototype.feature=function(Qe){return new be(this.features[Qe],this.options.extent)},be.prototype.loadGeometry=function(){var Qe=this.rawGeometry;this.geometry=[];for(var gt=0;gt<Qe.length;gt++){for(var zt=Qe[gt],Pt=[],Le=0;Le<zt.length;Le++)Pt.push(new Pe(zt[Le][0],zt[Le][1]));this.geometry.push(Pt)}return this.geometry},be.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Qe=this.geometry,gt=1/0,zt=-1/0,Pt=1/0,Le=-1/0,dt=0;dt<Qe.length;dt++)for(var ht=Qe[dt],Lt=0;Lt<ht.length;Lt++){var Mt=ht[Lt];gt=Math.min(gt,Mt.x),zt=Math.max(zt,Mt.x),Pt=Math.min(Pt,Mt.y),Le=Math.max(Le,Mt.y)}return[gt,Pt,zt,Le]},be.prototype.toGeoJSON=ve.prototype.toGeoJSON,ye}();function U(Pe){var ve=new ge;return function(Fe,be){for(var Qe in Fe.layers)be.writeMessage(3,X,Fe.layers[Qe])}(Pe,ve),ve.finish()}function X(Pe,ve){var Fe;ve.writeVarintField(15,Pe.version||1),ve.writeStringField(1,Pe.name||""),ve.writeVarintField(5,Pe.extent||4096);var be={keys:[],values:[],keycache:{},valuecache:{}};for(Fe=0;Fe<Pe.length;Fe++)be.feature=Pe.feature(Fe),ve.writeMessage(2,te,be);var Qe=be.keys;for(Fe=0;Fe<Qe.length;Fe++)ve.writeStringField(3,Qe[Fe]);var gt=be.values;for(Fe=0;Fe<gt.length;Fe++)ve.writeMessage(4,ze,gt[Fe])}function te(Pe,ve){var Fe=Pe.feature;Fe.id!==void 0&&ve.writeVarintField(1,Fe.id),ve.writeMessage(2,le,Pe),ve.writeVarintField(3,Fe.type),ve.writeMessage(4,me,Fe)}function le(Pe,ve){var Fe=Pe.feature,be=Pe.keys,Qe=Pe.values,gt=Pe.keycache,zt=Pe.valuecache;for(var Pt in Fe.properties){var Le=Fe.properties[Pt],dt=gt[Pt];if(Le!==null){dt===void 0&&(be.push(Pt),gt[Pt]=dt=be.length-1),ve.writeVarint(dt);var ht=typeof Le;ht!=="string"&&ht!=="boolean"&&ht!=="number"&&(Le=JSON.stringify(Le));var Lt=ht+":"+Le,Mt=zt[Lt];Mt===void 0&&(Qe.push(Le),zt[Lt]=Mt=Qe.length-1),ve.writeVarint(Mt)}}}function _e(Pe,ve){return(ve<<3)+(7&Pe)}function Se(Pe){return Pe<<1^Pe>>31}function me(Pe,ve){for(var Fe=Pe.loadGeometry(),be=Pe.type,Qe=0,gt=0,zt=Fe.length,Pt=0;Pt<zt;Pt++){var Le=Fe[Pt],dt=1;be===1&&(dt=Le.length),ve.writeVarint(_e(1,dt));for(var ht=be===3?Le.length-1:Le.length,Lt=0;Lt<ht;Lt++){Lt===1&&be!==1&&ve.writeVarint(_e(2,ht-1));var Mt=Le[Lt].x-Qe,$t=Le[Lt].y-gt;ve.writeVarint(Se(Mt)),ve.writeVarint(Se($t)),Qe+=Mt,gt+=$t}be===3&&ve.writeVarint(_e(7,1))}}function ze(Pe,ve){var Fe=typeof Pe;Fe==="string"?ve.writeStringField(1,Pe):Fe==="boolean"?ve.writeBooleanField(7,Pe):Fe==="number"&&(Pe%1!=0?ve.writeDoubleField(3,Pe):Pe<0?ve.writeSVarintField(6,Pe):ve.writeVarintField(5,Pe))}return nt.exports=U,nt.exports.fromVectorTileJs=U,nt.exports.fromGeojsonVt=function(Pe,ve){ve=ve||{};var Fe={};for(var be in Pe)Fe[be]=new A(Pe[be].features,ve),Fe[be].name=be,Fe[be].version=ve.version,Fe[be].extent=ve.extent;return U({layers:Fe})},nt.exports.GeoJSONWrapper=A,nt.exports}(),Xe=b.cz(rt);const mt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ge=>ge},kt=Math.fround||(ot=new Float32Array(1),ge=>(ot[0]=+ge,ot[0]));var ot;const At=3,Bt=5,gr=6;class vt{constructor(A){this.options=Object.assign(Object.create(mt),A),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(A){const{log:U,minZoom:X,maxZoom:te}=this.options;U&&console.time("total time");const le=`prepare ${A.length} points`;U&&console.time(le),this.points=A;const _e=[];for(let me=0;me<A.length;me++){const ze=A[me];if(!ze.geometry)continue;const[Pe,ve]=ze.geometry.coordinates,Fe=kt(Ar(Pe)),be=kt(zr(ve));_e.push(Fe,be,1/0,me,-1,1),this.options.reduce&&_e.push(0)}let Se=this.trees[te+1]=this._createTree(_e);U&&console.timeEnd(le);for(let me=te;me>=X;me--){const ze=+Date.now();Se=this.trees[me]=this._createTree(this._cluster(Se,me)),U&&console.log("z%d: %d clusters in %dms",me,Se.numItems,+Date.now()-ze)}return U&&console.timeEnd("total time"),this}getClusters(A,U){let X=((A[0]+180)%360+360)%360-180;const te=Math.max(-90,Math.min(90,A[1]));let le=A[2]===180?180:((A[2]+180)%360+360)%360-180;const _e=Math.max(-90,Math.min(90,A[3]));if(A[2]-A[0]>=360)X=-180,le=180;else if(X>le){const ve=this.getClusters([X,te,180,_e],U),Fe=this.getClusters([-180,te,le,_e],U);return ve.concat(Fe)}const Se=this.trees[this._limitZoom(U)],me=Se.range(Ar(X),zr(_e),Ar(le),zr(te)),ze=Se.data,Pe=[];for(const ve of me){const Fe=this.stride*ve;Pe.push(ze[Fe+Bt]>1?Et(ze,Fe,this.clusterProps):this.points[ze[Fe+At]])}return Pe}getChildren(A){const U=this._getOriginId(A),X=this._getOriginZoom(A),te="No cluster with the specified id.",le=this.trees[X];if(!le)throw new Error(te);const _e=le.data;if(U*this.stride>=_e.length)throw new Error(te);const Se=this.options.radius/(this.options.extent*Math.pow(2,X-1)),me=le.within(_e[U*this.stride],_e[U*this.stride+1],Se),ze=[];for(const Pe of me){const ve=Pe*this.stride;_e[ve+4]===A&&ze.push(_e[ve+Bt]>1?Et(_e,ve,this.clusterProps):this.points[_e[ve+At]])}if(ze.length===0)throw new Error(te);return ze}getLeaves(A,U,X){const te=[];return this._appendLeaves(te,A,U=U||10,X=X||0,0),te}getTile(A,U,X){const te=this.trees[this._limitZoom(A)],le=Math.pow(2,A),{extent:_e,radius:Se}=this.options,me=Se/_e,ze=(X-me)/le,Pe=(X+1+me)/le,ve={features:[]};return this._addTileFeatures(te.range((U-me)/le,ze,(U+1+me)/le,Pe),te.data,U,X,le,ve),U===0&&this._addTileFeatures(te.range(1-me/le,ze,1,Pe),te.data,le,X,le,ve),U===le-1&&this._addTileFeatures(te.range(0,ze,me/le,Pe),te.data,-1,X,le,ve),ve.features.length?ve:null}getClusterExpansionZoom(A){let U=this._getOriginZoom(A)-1;for(;U<=this.options.maxZoom;){const X=this.getChildren(A);if(U++,X.length!==1)break;A=X[0].properties.cluster_id}return U}_appendLeaves(A,U,X,te,le){const _e=this.getChildren(U);for(const Se of _e){const me=Se.properties;if(me&&me.cluster?le+me.point_count<=te?le+=me.point_count:le=this._appendLeaves(A,me.cluster_id,X,te,le):le<te?le++:A.push(Se),A.length===X)break}return le}_createTree(A){const U=new b.aB(A.length/this.stride|0,this.options.nodeSize,Float32Array);for(let X=0;X<A.length;X+=this.stride)U.add(A[X],A[X+1]);return U.finish(),U.data=A,U}_addTileFeatures(A,U,X,te,le,_e){for(const Se of A){const me=Se*this.stride,ze=U[me+Bt]>1;let Pe,ve,Fe;if(ze)Pe=Ft(U,me,this.clusterProps),ve=U[me],Fe=U[me+1];else{const gt=this.points[U[me+At]];Pe=gt.properties;const[zt,Pt]=gt.geometry.coordinates;ve=Ar(zt),Fe=zr(Pt)}const be={type:1,geometry:[[Math.round(this.options.extent*(ve*le-X)),Math.round(this.options.extent*(Fe*le-te))]],tags:Pe};let Qe;Qe=ze||this.options.generateId?U[me+At]:this.points[U[me+At]].id,Qe!==void 0&&(be.id=Qe),_e.features.push(be)}}_limitZoom(A){return Math.max(this.options.minZoom,Math.min(Math.floor(+A),this.options.maxZoom+1))}_cluster(A,U){const{radius:X,extent:te,reduce:le,minPoints:_e}=this.options,Se=X/(te*Math.pow(2,U)),me=A.data,ze=[],Pe=this.stride;for(let ve=0;ve<me.length;ve+=Pe){if(me[ve+2]<=U)continue;me[ve+2]=U;const Fe=me[ve],be=me[ve+1],Qe=A.within(me[ve],me[ve+1],Se),gt=me[ve+Bt];let zt=gt;for(const Pt of Qe){const Le=Pt*Pe;me[Le+2]>U&&(zt+=me[Le+Bt])}if(zt>gt&&zt>=_e){let Pt,Le=Fe*gt,dt=be*gt,ht=-1;const Lt=((ve/Pe|0)<<5)+(U+1)+this.points.length;for(const Mt of Qe){const $t=Mt*Pe;if(me[$t+2]<=U)continue;me[$t+2]=U;const xt=me[$t+Bt];Le+=me[$t]*xt,dt+=me[$t+1]*xt,me[$t+4]=Lt,le&&(Pt||(Pt=this._map(me,ve,!0),ht=this.clusterProps.length,this.clusterProps.push(Pt)),le(Pt,this._map(me,$t)))}me[ve+4]=Lt,ze.push(Le/zt,dt/zt,1/0,Lt,-1,zt),le&&ze.push(ht)}else{for(let Pt=0;Pt<Pe;Pt++)ze.push(me[ve+Pt]);if(zt>1)for(const Pt of Qe){const Le=Pt*Pe;if(!(me[Le+2]<=U)){me[Le+2]=U;for(let dt=0;dt<Pe;dt++)ze.push(me[Le+dt])}}}}return ze}_getOriginId(A){return A-this.points.length>>5}_getOriginZoom(A){return(A-this.points.length)%32}_map(A,U,X){if(A[U+Bt]>1){const _e=this.clusterProps[A[U+gr]];return X?Object.assign({},_e):_e}const te=this.points[A[U+At]].properties,le=this.options.map(te);return X&&le===te?Object.assign({},le):le}}function Et(ge,A,U){return{type:"Feature",id:ge[A+At],properties:Ft(ge,A,U),geometry:{type:"Point",coordinates:[(X=ge[A],360*(X-.5)),_r(ge[A+1])]}};var X}function Ft(ge,A,U){const X=ge[A+Bt],te=X>=1e4?`${Math.round(X/1e3)}k`:X>=1e3?Math.round(X/100)/10+"k":X,le=ge[A+gr],_e=le===-1?{}:Object.assign({},U[le]);return Object.assign(_e,{cluster:!0,cluster_id:ge[A+At],point_count:X,point_count_abbreviated:te})}function Ar(ge){return ge/360+.5}function zr(ge){const A=Math.sin(ge*Math.PI/180),U=.5-.25*Math.log((1+A)/(1-A))/Math.PI;return U<0?0:U>1?1:U}function _r(ge){const A=(180-360*ge)*Math.PI/180;return 360*Math.atan(Math.exp(A))/Math.PI-90}function or(ge,A,U,X){let te=X;const le=A+(U-A>>1);let _e,Se=U-A;const me=ge[A],ze=ge[A+1],Pe=ge[U],ve=ge[U+1];for(let Fe=A+3;Fe<U;Fe+=3){const be=Gr(ge[Fe],ge[Fe+1],me,ze,Pe,ve);if(be>te)_e=Fe,te=be;else if(be===te){const Qe=Math.abs(Fe-le);Qe<Se&&(_e=Fe,Se=Qe)}}te>X&&(_e-A>3&&or(ge,A,_e,X),ge[_e+2]=te,U-_e>3&&or(ge,_e,U,X))}function Gr(ge,A,U,X,te,le){let _e=te-U,Se=le-X;if(_e!==0||Se!==0){const me=((ge-U)*_e+(A-X)*Se)/(_e*_e+Se*Se);me>1?(U=te,X=le):me>0&&(U+=_e*me,X+=Se*me)}return _e=ge-U,Se=A-X,_e*_e+Se*Se}function Lr(ge,A,U,X){const te={id:ge??null,type:A,geometry:U,tags:X,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(A==="Point"||A==="MultiPoint"||A==="LineString")Rr(te,U);else if(A==="Polygon")Rr(te,U[0]);else if(A==="MultiLineString")for(const le of U)Rr(te,le);else if(A==="MultiPolygon")for(const le of U)Rr(te,le[0]);return te}function Rr(ge,A){for(let U=0;U<A.length;U+=3)ge.minX=Math.min(ge.minX,A[U]),ge.minY=Math.min(ge.minY,A[U+1]),ge.maxX=Math.max(ge.maxX,A[U]),ge.maxY=Math.max(ge.maxY,A[U+1])}function yo(ge,A,U,X){if(!A.geometry)return;const te=A.geometry.coordinates;if(te&&te.length===0)return;const le=A.geometry.type,_e=Math.pow(U.tolerance/((1<<U.maxZoom)*U.extent),2);let Se=[],me=A.id;if(U.promoteId?me=A.properties[U.promoteId]:U.generateId&&(me=X||0),le==="Point")Ao(te,Se);else if(le==="MultiPoint")for(const ze of te)Ao(ze,Se);else if(le==="LineString")Vo(te,Se,_e,!1);else if(le==="MultiLineString"){if(U.lineMetrics){for(const ze of te)Se=[],Vo(ze,Se,_e,!1),ge.push(Lr(me,"LineString",Se,A.properties));return}to(te,Se,_e,!1)}else if(le==="Polygon")to(te,Se,_e,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(const ze of A.geometry.geometries)yo(ge,{id:me,geometry:ze,properties:A.properties},U,X);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ze of te){const Pe=[];to(ze,Pe,_e,!0),Se.push(Pe)}}ge.push(Lr(me,le,Se,A.properties))}function Ao(ge,A){A.push(Uo(ge[0]),qr(ge[1]),0)}function Vo(ge,A,U,X){let te,le,_e=0;for(let me=0;me<ge.length;me++){const ze=Uo(ge[me][0]),Pe=qr(ge[me][1]);A.push(ze,Pe,0),me>0&&(_e+=X?(te*Pe-ze*le)/2:Math.sqrt(Math.pow(ze-te,2)+Math.pow(Pe-le,2))),te=ze,le=Pe}const Se=A.length-3;A[2]=1,or(A,0,Se,U),A[Se+2]=1,A.size=Math.abs(_e),A.start=0,A.end=A.size}function to(ge,A,U,X){for(let te=0;te<ge.length;te++){const le=[];Vo(ge[te],le,U,X),A.push(le)}}function Uo(ge){return ge/360+.5}function qr(ge){const A=Math.sin(ge*Math.PI/180),U=.5-.25*Math.log((1+A)/(1-A))/Math.PI;return U<0?0:U>1?1:U}function se(ge,A,U,X,te,le,_e,Se){if(X/=A,le>=(U/=A)&&_e<X)return ge;if(_e<U||le>=X)return null;const me=[];for(const ze of ge){const Pe=ze.geometry;let ve=ze.type;const Fe=te===0?ze.minX:ze.minY,be=te===0?ze.maxX:ze.maxY;if(Fe>=U&&be<X){me.push(ze);continue}if(be<U||Fe>=X)continue;let Qe=[];if(ve==="Point"||ve==="MultiPoint")pe(Pe,Qe,U,X,te);else if(ve==="LineString")ke(Pe,Qe,U,X,te,!1,Se.lineMetrics);else if(ve==="MultiLineString")Ne(Pe,Qe,U,X,te,!1);else if(ve==="Polygon")Ne(Pe,Qe,U,X,te,!0);else if(ve==="MultiPolygon")for(const gt of Pe){const zt=[];Ne(gt,zt,U,X,te,!0),zt.length&&Qe.push(zt)}if(Qe.length){if(Se.lineMetrics&&ve==="LineString"){for(const gt of Qe)me.push(Lr(ze.id,ve,gt,ze.tags));continue}ve!=="LineString"&&ve!=="MultiLineString"||(Qe.length===1?(ve="LineString",Qe=Qe[0]):ve="MultiLineString"),ve!=="Point"&&ve!=="MultiPoint"||(ve=Qe.length===3?"Point":"MultiPoint"),me.push(Lr(ze.id,ve,Qe,ze.tags))}}return me.length?me:null}function pe(ge,A,U,X,te){for(let le=0;le<ge.length;le+=3){const _e=ge[le+te];_e>=U&&_e<=X&&Ve(A,ge[le],ge[le+1],ge[le+2])}}function ke(ge,A,U,X,te,le,_e){let Se=Ge(ge);const me=te===0?it:tt;let ze,Pe,ve=ge.start;for(let zt=0;zt<ge.length-3;zt+=3){const Pt=ge[zt],Le=ge[zt+1],dt=ge[zt+2],ht=ge[zt+3],Lt=ge[zt+4],Mt=te===0?Pt:Le,$t=te===0?ht:Lt;let xt=!1;_e&&(ze=Math.sqrt(Math.pow(Pt-ht,2)+Math.pow(Le-Lt,2))),Mt<U?$t>U&&(Pe=me(Se,Pt,Le,ht,Lt,U),_e&&(Se.start=ve+ze*Pe)):Mt>X?$t<X&&(Pe=me(Se,Pt,Le,ht,Lt,X),_e&&(Se.start=ve+ze*Pe)):Ve(Se,Pt,Le,dt),$t<U&&Mt>=U&&(Pe=me(Se,Pt,Le,ht,Lt,U),xt=!0),$t>X&&Mt<=X&&(Pe=me(Se,Pt,Le,ht,Lt,X),xt=!0),!le&&xt&&(_e&&(Se.end=ve+ze*Pe),A.push(Se),Se=Ge(ge)),_e&&(ve+=ze)}let Fe=ge.length-3;const be=ge[Fe],Qe=ge[Fe+1],gt=te===0?be:Qe;gt>=U&&gt<=X&&Ve(Se,be,Qe,ge[Fe+2]),Fe=Se.length-3,le&&Fe>=3&&(Se[Fe]!==Se[0]||Se[Fe+1]!==Se[1])&&Ve(Se,Se[0],Se[1],Se[2]),Se.length&&A.push(Se)}function Ge(ge){const A=[];return A.size=ge.size,A.start=ge.start,A.end=ge.end,A}function Ne(ge,A,U,X,te,le){for(const _e of ge)ke(_e,A,U,X,te,le,!1)}function Ve(ge,A,U,X){ge.push(A,U,X)}function it(ge,A,U,X,te,le){const _e=(le-A)/(X-A);return Ve(ge,le,U+(te-U)*_e,1),_e}function tt(ge,A,U,X,te,le){const _e=(le-U)/(te-U);return Ve(ge,A+(X-A)*_e,le,1),_e}function Je(ge,A){const U=[];for(let X=0;X<ge.length;X++){const te=ge[X],le=te.type;let _e;if(le==="Point"||le==="MultiPoint"||le==="LineString")_e=Ue(te.geometry,A);else if(le==="MultiLineString"||le==="Polygon"){_e=[];for(const Se of te.geometry)_e.push(Ue(Se,A))}else if(le==="MultiPolygon"){_e=[];for(const Se of te.geometry){const me=[];for(const ze of Se)me.push(Ue(ze,A));_e.push(me)}}U.push(Lr(te.id,le,_e,te.tags))}return U}function Ue(ge,A){const U=[];U.size=ge.size,ge.start!==void 0&&(U.start=ge.start,U.end=ge.end);for(let X=0;X<ge.length;X+=3)U.push(ge[X]+A,ge[X+1],ge[X+2]);return U}function St(ge,A){if(ge.transformed)return ge;const U=1<<ge.z,X=ge.x,te=ge.y;for(const le of ge.features){const _e=le.geometry,Se=le.type;if(le.geometry=[],Se===1)for(let me=0;me<_e.length;me+=2)le.geometry.push(at(_e[me],_e[me+1],A,U,X,te));else for(let me=0;me<_e.length;me++){const ze=[];for(let Pe=0;Pe<_e[me].length;Pe+=2)ze.push(at(_e[me][Pe],_e[me][Pe+1],A,U,X,te));le.geometry.push(ze)}}return ge.transformed=!0,ge}function at(ge,A,U,X,te,le){return[Math.round(U*(ge*X-te)),Math.round(U*(A*X-le))]}function bt(ge,A,U,X,te){const le=A===te.maxZoom?0:te.tolerance/((1<<A)*te.extent),_e={features:[],numPoints:0,numSimplified:0,numFeatures:ge.length,source:null,x:U,y:X,z:A,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Se of ge)It(_e,Se,le,te);return _e}function It(ge,A,U,X){const te=A.geometry,le=A.type,_e=[];if(ge.minX=Math.min(ge.minX,A.minX),ge.minY=Math.min(ge.minY,A.minY),ge.maxX=Math.max(ge.maxX,A.maxX),ge.maxY=Math.max(ge.maxY,A.maxY),le==="Point"||le==="MultiPoint")for(let Se=0;Se<te.length;Se+=3)_e.push(te[Se],te[Se+1]),ge.numPoints++,ge.numSimplified++;else if(le==="LineString")Ot(_e,te,ge,U,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(let Se=0;Se<te.length;Se++)Ot(_e,te[Se],ge,U,le==="Polygon",Se===0);else if(le==="MultiPolygon")for(let Se=0;Se<te.length;Se++){const me=te[Se];for(let ze=0;ze<me.length;ze++)Ot(_e,me[ze],ge,U,!0,ze===0)}if(_e.length){let Se=A.tags||null;if(le==="LineString"&&X.lineMetrics){Se={};for(const ze in A.tags)Se[ze]=A.tags[ze];Se.mapbox_clip_start=te.start/te.size,Se.mapbox_clip_end=te.end/te.size}const me={geometry:_e,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:Se};A.id!==null&&(me.id=A.id),ge.features.push(me)}}function Ot(ge,A,U,X,te,le){const _e=X*X;if(X>0&&A.size<(te?_e:X))return void(U.numPoints+=A.length/3);const Se=[];for(let me=0;me<A.length;me+=3)(X===0||A[me+2]>_e)&&(U.numSimplified++,Se.push(A[me],A[me+1])),U.numPoints++;te&&function(me,ze){let Pe=0;for(let ve=0,Fe=me.length,be=Fe-2;ve<Fe;be=ve,ve+=2)Pe+=(me[ve]-me[be])*(me[ve+1]+me[be+1]);if(Pe>0===ze)for(let ve=0,Fe=me.length;ve<Fe/2;ve+=2){const be=me[ve],Qe=me[ve+1];me[ve]=me[Fe-2-ve],me[ve+1]=me[Fe-1-ve],me[Fe-2-ve]=be,me[Fe-1-ve]=Qe}}(Se,le),ge.push(Se)}const qt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Vt{constructor(A,U){const X=(U=this.options=function(le,_e){for(const Se in _e)le[Se]=_e[Se];return le}(Object.create(qt),U)).debug;if(X&&console.time("preprocess data"),U.maxZoom<0||U.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(U.promoteId&&U.generateId)throw new Error("promoteId and generateId cannot be used together.");let te=function(le,_e){const Se=[];if(le.type==="FeatureCollection")for(let me=0;me<le.features.length;me++)yo(Se,le.features[me],_e,me);else yo(Se,le.type==="Feature"?le:{geometry:le},_e);return Se}(A,U);this.tiles={},this.tileCoords=[],X&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",U.indexMaxZoom,U.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),te=function(le,_e){const Se=_e.buffer/_e.extent;let me=le;const ze=se(le,1,-1-Se,Se,0,-1,2,_e),Pe=se(le,1,1-Se,2+Se,0,-1,2,_e);return(ze||Pe)&&(me=se(le,1,-Se,1+Se,0,-1,2,_e)||[],ze&&(me=Je(ze,1).concat(me)),Pe&&(me=me.concat(Je(Pe,-1)))),me}(te,U),te.length&&this.splitTile(te,0,0,0),X&&(te.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(A,U,X,te,le,_e,Se){const me=[A,U,X,te],ze=this.options,Pe=ze.debug;for(;me.length;){te=me.pop(),X=me.pop(),U=me.pop(),A=me.pop();const ve=1<<U,Fe=Dr(U,X,te);let be=this.tiles[Fe];if(!be&&(Pe>1&&console.time("creation"),be=this.tiles[Fe]=bt(A,U,X,te,ze),this.tileCoords.push({z:U,x:X,y:te}),Pe)){Pe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",U,X,te,be.numFeatures,be.numPoints,be.numSimplified),console.timeEnd("creation"));const xt=`z${U}`;this.stats[xt]=(this.stats[xt]||0)+1,this.total++}if(be.source=A,le==null){if(U===ze.indexMaxZoom||be.numPoints<=ze.indexMaxPoints)continue}else{if(U===ze.maxZoom||U===le)continue;if(le!=null){const xt=le-U;if(X!==_e>>xt||te!==Se>>xt)continue}}if(be.source=null,A.length===0)continue;Pe>1&&console.time("clipping");const Qe=.5*ze.buffer/ze.extent,gt=.5-Qe,zt=.5+Qe,Pt=1+Qe;let Le=null,dt=null,ht=null,Lt=null,Mt=se(A,ve,X-Qe,X+zt,0,be.minX,be.maxX,ze),$t=se(A,ve,X+gt,X+Pt,0,be.minX,be.maxX,ze);A=null,Mt&&(Le=se(Mt,ve,te-Qe,te+zt,1,be.minY,be.maxY,ze),dt=se(Mt,ve,te+gt,te+Pt,1,be.minY,be.maxY,ze),Mt=null),$t&&(ht=se($t,ve,te-Qe,te+zt,1,be.minY,be.maxY,ze),Lt=se($t,ve,te+gt,te+Pt,1,be.minY,be.maxY,ze),$t=null),Pe>1&&console.timeEnd("clipping"),me.push(Le||[],U+1,2*X,2*te),me.push(dt||[],U+1,2*X,2*te+1),me.push(ht||[],U+1,2*X+1,2*te),me.push(Lt||[],U+1,2*X+1,2*te+1)}}getTile(A,U,X){A=+A,U=+U,X=+X;const te=this.options,{extent:le,debug:_e}=te;if(A<0||A>24)return null;const Se=1<<A,me=Dr(A,U=U+Se&Se-1,X);if(this.tiles[me])return St(this.tiles[me],le);_e>1&&console.log("drilling down to z%d-%d-%d",A,U,X);let ze,Pe=A,ve=U,Fe=X;for(;!ze&&Pe>0;)Pe--,ve>>=1,Fe>>=1,ze=this.tiles[Dr(Pe,ve,Fe)];return ze&&ze.source?(_e>1&&(console.log("found parent tile z%d-%d-%d",Pe,ve,Fe),console.time("drilling down")),this.splitTile(ze.source,Pe,ve,Fe,A,U,X),_e>1&&console.timeEnd("drilling down"),this.tiles[me]?St(this.tiles[me],le):null):null}}function Dr(ge,A,U){return 32*((1<<ge)*U+A)+ge}function Sr(ge,A){return A?ge.properties[A]:ge.id}function vo(ge,A){if(ge==null)return!0;if(ge.type==="Feature")return Sr(ge,A)!=null;if(ge.type==="FeatureCollection"){const U=new Set;for(const X of ge.features){const te=Sr(X,A);if(te==null||U.has(te))return!1;U.add(te)}return!0}return!1}function uo(ge,A){const U=new Map;if(ge!=null)if(ge.type==="Feature")U.set(Sr(ge,A),ge);else for(const X of ge.features)U.set(Sr(X,A),X);return U}class gi extends H{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(A,U){return b._(this,void 0,void 0,function*(){const X=A.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const te=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!te)return null;const le=new st(te.features);let _e=Xe(le);return _e.byteOffset===0&&_e.byteLength===_e.buffer.byteLength||(_e=new Uint8Array(_e)),{vectorTile:le,rawData:_e.buffer}})}loadData(A){return b._(this,void 0,void 0,function*(){var U;(U=this._pendingRequest)===null||U===void 0||U.abort();const X=!!(A&&A.request&&A.request.collectResourceTiming)&&new b.cw(A.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(A,this._pendingRequest),this._geoJSONIndex=A.cluster?new vt(function({superclusterOptions:_e,clusterProperties:Se}){if(!Se||!_e)return _e;const me={},ze={},Pe={accumulated:null,zoom:0},ve={properties:null},Fe=Object.keys(Se);for(const be of Fe){const[Qe,gt]=Se[be],zt=b.cD(gt),Pt=b.cD(typeof Qe=="string"?[Qe,["accumulated"],["get",be]]:Qe);me[be]=zt.value,ze[be]=Pt.value}return _e.map=be=>{ve.properties=be;const Qe={};for(const gt of Fe)Qe[gt]=me[gt].evaluate(Pe,ve);return Qe},_e.reduce=(be,Qe)=>{ve.properties=Qe;for(const gt of Fe)Pe.accumulated=be[gt],be[gt]=ze[gt].evaluate(Pe,ve)},_e}(A)).load((yield this._pendingData).features):(te=yield this._pendingData,new Vt(te,A.geojsonVtOptions)),this.loaded={};const le={};if(X){const _e=X.finish();_e&&(le.resourceTiming={},le.resourceTiming[A.source]=JSON.parse(JSON.stringify(_e)))}return le}catch(le){if(delete this._pendingRequest,b.ch(le))return{abandoned:!0};throw le}var te})}getData(){return b._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(A){const U=this.loaded;return U&&U[A.uid]?super.reloadTile(A):this.loadTile(A)}loadAndProcessGeoJSON(A,U){return b._(this,void 0,void 0,function*(){let X=yield this.loadGeoJSON(A,U);if(delete this._pendingRequest,typeof X!="object")throw new Error(`Input data given to '${A.source}' is not a valid GeoJSON object.`);if(et(X,!0),A.filter){const te=b.cD(A.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(te.result==="error")throw new Error(te.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));X={type:"FeatureCollection",features:X.features.filter(_e=>te.value.evaluate({zoom:0},_e))}}return X})}loadGeoJSON(A,U){return b._(this,void 0,void 0,function*(){const{promoteId:X}=A;if(A.request){const te=yield b.j(A.request,U);return this._dataUpdateable=vo(te.data,X)?uo(te.data,X):void 0,te.data}if(typeof A.data=="string")try{const te=JSON.parse(A.data);return this._dataUpdateable=vo(te,X)?uo(te,X):void 0,te}catch{throw new Error(`Input data given to '${A.source}' is not a valid GeoJSON object.`)}if(!A.dataDiff)throw new Error(`Input data given to '${A.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${A.source}`);return function(te,le,_e){var Se,me,ze,Pe;if(le.removeAll&&te.clear(),le.remove)for(const ve of le.remove)te.delete(ve);if(le.add)for(const ve of le.add){const Fe=Sr(ve,_e);Fe!=null&&te.set(Fe,ve)}if(le.update)for(const ve of le.update){let Fe=te.get(ve.id);if(Fe==null)continue;const be=!ve.removeAllProperties&&(((Se=ve.removeProperties)===null||Se===void 0?void 0:Se.length)>0||((me=ve.addOrUpdateProperties)===null||me===void 0?void 0:me.length)>0);if((ve.newGeometry||ve.removeAllProperties||be)&&(Fe=Object.assign({},Fe),te.set(ve.id,Fe),be&&(Fe.properties=Object.assign({},Fe.properties))),ve.newGeometry&&(Fe.geometry=ve.newGeometry),ve.removeAllProperties)Fe.properties={};else if(((ze=ve.removeProperties)===null||ze===void 0?void 0:ze.length)>0)for(const Qe of ve.removeProperties)Object.prototype.hasOwnProperty.call(Fe.properties,Qe)&&delete Fe.properties[Qe];if(((Pe=ve.addOrUpdateProperties)===null||Pe===void 0?void 0:Pe.length)>0)for(const{key:Qe,value:gt}of ve.addOrUpdateProperties)Fe.properties[Qe]=gt}}(this._dataUpdateable,A.dataDiff,X),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(A){return b._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(A){return this._geoJSONIndex.getClusterExpansionZoom(A.clusterId)}getClusterChildren(A){return this._geoJSONIndex.getChildren(A.clusterId)}getClusterLeaves(A){return this._geoJSONIndex.getLeaves(A.clusterId,A.limit,A.offset)}}class oi{constructor(A){this.self=A,this.actor=new b.H(A),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(U,X)=>{if(this.externalWorkerSourceTypes[U])throw new Error(`Worker source with name "${U}" already registered.`);this.externalWorkerSourceTypes[U]=X},this.self.addProtocol=b.cj,this.self.removeProtocol=b.ck,this.self.registerRTLTextPlugin=U=>{b.cE.setMethods(U)},this.actor.registerMessageHandler("LDT",(U,X)=>this._getDEMWorkerSource(U,X.source).loadTile(X)),this.actor.registerMessageHandler("RDT",(U,X)=>b._(this,void 0,void 0,function*(){this._getDEMWorkerSource(U,X.source).removeTile(X)})),this.actor.registerMessageHandler("GCEZ",(U,X)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(U,X.type,X.source).getClusterExpansionZoom(X)})),this.actor.registerMessageHandler("GCC",(U,X)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(U,X.type,X.source).getClusterChildren(X)})),this.actor.registerMessageHandler("GCL",(U,X)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(U,X.type,X.source).getClusterLeaves(X)})),this.actor.registerMessageHandler("LD",(U,X)=>this._getWorkerSource(U,X.type,X.source).loadData(X)),this.actor.registerMessageHandler("GD",(U,X)=>this._getWorkerSource(U,X.type,X.source).getData()),this.actor.registerMessageHandler("LT",(U,X)=>this._getWorkerSource(U,X.type,X.source).loadTile(X)),this.actor.registerMessageHandler("RT",(U,X)=>this._getWorkerSource(U,X.type,X.source).reloadTile(X)),this.actor.registerMessageHandler("AT",(U,X)=>this._getWorkerSource(U,X.type,X.source).abortTile(X)),this.actor.registerMessageHandler("RMT",(U,X)=>this._getWorkerSource(U,X.type,X.source).removeTile(X)),this.actor.registerMessageHandler("RS",(U,X)=>b._(this,void 0,void 0,function*(){if(!this.workerSources[U]||!this.workerSources[U][X.type]||!this.workerSources[U][X.type][X.source])return;const te=this.workerSources[U][X.type][X.source];delete this.workerSources[U][X.type][X.source],te.removeSource!==void 0&&te.removeSource(X)})),this.actor.registerMessageHandler("RM",U=>b._(this,void 0,void 0,function*(){delete this.layerIndexes[U],delete this.availableImages[U],delete this.workerSources[U],delete this.demWorkerSources[U]})),this.actor.registerMessageHandler("SR",(U,X)=>b._(this,void 0,void 0,function*(){this.referrer=X})),this.actor.registerMessageHandler("SRPS",(U,X)=>this._syncRTLPluginState(U,X)),this.actor.registerMessageHandler("IS",(U,X)=>b._(this,void 0,void 0,function*(){this.self.importScripts(X)})),this.actor.registerMessageHandler("SI",(U,X)=>this._setImages(U,X)),this.actor.registerMessageHandler("UL",(U,X)=>b._(this,void 0,void 0,function*(){this._getLayerIndex(U).update(X.layers,X.removedIds)})),this.actor.registerMessageHandler("SL",(U,X)=>b._(this,void 0,void 0,function*(){this._getLayerIndex(U).replace(X)}))}_setImages(A,U){return b._(this,void 0,void 0,function*(){this.availableImages[A]=U;for(const X in this.workerSources[A]){const te=this.workerSources[A][X];for(const le in te)te[le].availableImages=U}})}_syncRTLPluginState(A,U){return b._(this,void 0,void 0,function*(){return yield b.cE.syncState(U,this.self.importScripts)})}_getAvailableImages(A){let U=this.availableImages[A];return U||(U=[]),U}_getLayerIndex(A){let U=this.layerIndexes[A];return U||(U=this.layerIndexes[A]=new c),U}_getWorkerSource(A,U,X){if(this.workerSources[A]||(this.workerSources[A]={}),this.workerSources[A][U]||(this.workerSources[A][U]={}),!this.workerSources[A][U][X]){const te={sendAsync:(le,_e)=>(le.targetMapId=A,this.actor.sendAsync(le,_e))};switch(U){case"vector":this.workerSources[A][U][X]=new H(te,this._getLayerIndex(A),this._getAvailableImages(A));break;case"geojson":this.workerSources[A][U][X]=new gi(te,this._getLayerIndex(A),this._getAvailableImages(A));break;default:this.workerSources[A][U][X]=new this.externalWorkerSourceTypes[U](te,this._getLayerIndex(A),this._getAvailableImages(A))}}return this.workerSources[A][U][X]}_getDEMWorkerSource(A,U){return this.demWorkerSources[A]||(this.demWorkerSources[A]={}),this.demWorkerSources[A][U]||(this.demWorkerSources[A][U]=new K),this.demWorkerSources[A][U]}}return b.i(self)&&(self.worker=new oi(self)),oi}),w("index",["exports","./shared"],function(b,c){var R="5.2.0";function Z(){var f=new c.A(4);return c.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}let V,H;const K={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f,e,r){const l=requestAnimationFrame(p=>{u(),e(p)}),{unsubscribe:u}=c.s(f.signal,"abort",()=>{u(),cancelAnimationFrame(l),r(c.c())},!1)},frameAsync(f){return new Promise((e,r)=>{this.frame(f,e,r)})},getImageData(f,e=0){return this.getImageCanvasContext(f).getImageData(-e,-e,f.width+2*e,f.height+2*e)},getImageCanvasContext(f){const e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=f.width,e.height=f.height,r.drawImage(f,0,0,f.width,f.height),r},resolveURL:f=>(V||(V=document.createElement("a")),V.href=f,V.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(H==null&&(H=matchMedia("(prefers-reduced-motion: reduce)")),H.matches)}};class G{static testProp(e){if(!G.docStyle)return e[0];for(let r=0;r<e.length;r++)if(e[r]in G.docStyle)return e[r];return e[0]}static create(e,r,l){const u=window.document.createElement(e);return r!==void 0&&(u.className=r),l&&l.appendChild(u),u}static createNS(e,r){return window.document.createElementNS(e,r)}static disableDrag(){G.docStyle&&G.selectProp&&(G.userSelect=G.docStyle[G.selectProp],G.docStyle[G.selectProp]="none")}static enableDrag(){G.docStyle&&G.selectProp&&(G.docStyle[G.selectProp]=G.userSelect)}static setTransform(e,r){e.style[G.transformProp]=r}static addEventListener(e,r,l,u={}){e.addEventListener(r,l,"passive"in u?u:u.capture)}static removeEventListener(e,r,l,u={}){e.removeEventListener(r,l,"passive"in u?u:u.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",G.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",G.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",G.suppressClickInternal,!0)},0)}static getScale(e){const r=e.getBoundingClientRect();return{x:r.width/e.offsetWidth||1,y:r.height/e.offsetHeight||1,boundingClientRect:r}}static getPoint(e,r,l){const u=r.boundingClientRect;return new c.P((l.clientX-u.left)/r.x-e.clientLeft,(l.clientY-u.top)/r.y-e.clientTop)}static mousePos(e,r){const l=G.getScale(e);return G.getPoint(e,l,r)}static touchPos(e,r){const l=[],u=G.getScale(e);for(let p=0;p<r.length;p++)l.push(G.getPoint(e,u,r[p]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const r=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=r.querySelectorAll("script");for(const u of l)u.remove();return G.clean(r),r.innerHTML}static isPossiblyDangerous(e,r){const l=r.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const r=e.children;for(const l of r)G.removeAttributes(l),G.clean(l)}static removeAttributes(e){for(const{name:r,value:l}of e.attributes)G.isPossiblyDangerous(r,l)&&e.removeAttribute(r)}}G.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,G.selectProp=G.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),G.transformProp=G.testProp(["transform","WebkitTransform"]);const fe={supported:!1,testSupport:function(f){!We&&et&&(lt?st(f):Be=f)}};let Be,et,We=!1,lt=!1;function st(f){const e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,et),f.isContextLost())return;fe.supported=!0}catch{}f.deleteTexture(e),We=!0}var ye;typeof document<"u"&&(et=document.createElement("img"),et.onload=()=>{Be&&st(Be),Be=null,lt=!0},et.onerror=()=>{We=!0,Be=null},et.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(f){let e,r,l,u;f.resetRequestQueue=()=>{e=[],r=0,l=0,u={}},f.addThrottleControl=S=>{const k=l++;return u[k]=S,k},f.removeThrottleControl=S=>{delete u[S],y()},f.getImage=(S,k,E=!0)=>new Promise((z,D)=>{fe.supported&&(S.headers||(S.headers={}),S.headers.accept="image/webp,*/*"),c.e(S,{type:"image"}),e.push({abortController:k,requestParameters:S,supportImageRefresh:E,state:"queued",onError:$=>{D($)},onSuccess:$=>{z($)}}),y()});const p=S=>c._(this,void 0,void 0,function*(){S.state="running";const{requestParameters:k,supportImageRefresh:E,onError:z,onSuccess:D,abortController:$}=S,N=E===!1&&!c.i(self)&&!c.g(k.url)&&(!k.headers||Object.keys(k.headers).reduce((Q,re)=>Q&&re==="accept",!0));r++;const J=N?x(k,$):c.m(k,$);try{const Q=yield J;delete S.abortController,S.state="completed",Q.data instanceof HTMLImageElement||c.b(Q.data)?D(Q):Q.data&&D({data:yield(Y=Q.data,typeof createImageBitmap=="function"?c.f(Y):c.h(Y)),cacheControl:Q.cacheControl,expires:Q.expires})}catch(Q){delete S.abortController,z(Q)}finally{r--,y()}var Y}),y=()=>{const S=(()=>{for(const k of Object.keys(u))if(u[k]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=r;k<S&&e.length>0;k++){const E=e.shift();E.abortController.signal.aborted?k--:p(E)}},x=(S,k)=>new Promise((E,z)=>{const D=new Image,$=S.url,N=S.credentials;N&&N==="include"?D.crossOrigin="use-credentials":(N&&N==="same-origin"||!c.d($))&&(D.crossOrigin="anonymous"),k.signal.addEventListener("abort",()=>{D.src="",z(c.c())}),D.fetchPriority="high",D.onload=()=>{D.onerror=D.onload=null,E({data:D})},D.onerror=()=>{D.onerror=D.onload=null,k.signal.aborted||z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},D.src=$})}(ye||(ye={})),ye.resetRequestQueue();class Ae{constructor(e){this._transformRequestFn=e}transformRequest(e,r){return this._transformRequestFn&&this._transformRequestFn(e,r)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Ye(f){const e=[];if(typeof f=="string")e.push({id:"default",url:f});else if(f&&f.length>0){const r=[];for(const{id:l,url:u}of f){const p=`${l}${u}`;r.indexOf(p)===-1&&(r.push(p),e.push({id:l,url:u}))}}return e}function nt(f,e,r){try{const l=new URL(f);return l.pathname+=`${e}${r}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${f}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class rt{constructor(e,r,l,u){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(r,u)}update(e,r,l){const{width:u,height:p}=e,y=!(this.size&&this.size[0]===u&&this.size[1]===p||l),{context:x}=this,{gl:S}=x;if(this.useMipmap=!!(r&&r.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!r||r.premultiply!==!1)),y)this.size=[u,p],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,e):S.texImage2D(S.TEXTURE_2D,0,this.format,u,p,0,this.format,S.UNSIGNED_BYTE,e.data);else{const{x:k,y:E}=l||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?S.texSubImage2D(S.TEXTURE_2D,0,k,E,S.RGBA,S.UNSIGNED_BYTE,e):S.texSubImage2D(S.TEXTURE_2D,0,k,E,u,p,S.RGBA,S.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)}bind(e,r,l){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),l!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=p.LINEAR),e!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,l||e),this.filter=e),r!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,r),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Xe(f){const{userImage:e}=f;return!!(e&&e.render&&e.render())&&(f.data.replace(new Uint8Array(e.data.buffer)),!0)}class mt extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:r,promiseResolve:l}of this.requestors)l(this._getImagesForIds(r));this.requestors=[]}}getImage(e){const r=this.images[e];if(r&&!r.data&&r.spriteData){const l=r.spriteData;r.data=new c.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),r.spriteData=null}return r}addImage(e,r){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,r)&&(this.images[e]=r)}_validate(e,r){let l=!0;const u=r.data||r.spriteData;return this._validateStretch(r.stretchX,u&&u.width)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(r.stretchY,u&&u.height)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(r.content,r)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,r){if(!e)return!0;let l=0;for(const u of e){if(u[0]<l||u[1]<u[0]||r<u[1])return!1;l=u[1]}return!0}_validateContent(e,r){if(!e)return!0;if(e.length!==4)return!1;const l=r.spriteData,u=l&&l.width||r.data.width,p=l&&l.height||r.data.height;return!(e[0]<0||u<e[0]||e[1]<0||p<e[1]||e[2]<0||u<e[2]||e[3]<0||p<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,r,l=!0){const u=this.getImage(e);if(l&&(u.data.width!==r.data.width||u.data.height!==r.data.height))throw new Error(`size mismatch between old image (${u.data.width}x${u.data.height}) and new image (${r.data.width}x${r.data.height}).`);r.version=u.version+1,this.images[e]=r,this.updatedImages[e]=!0}removeImage(e){const r=this.images[e];delete this.images[e],delete this.patterns[e],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((r,l)=>{let u=!0;if(!this.isLoaded())for(const p of e)this.images[p]||(u=!1);this.isLoaded()||u?r(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:r})})}_getImagesForIds(e){const r={};for(const l of e){let u=this.getImage(l);u||(this.fire(new c.l("styleimagemissing",{id:l})),u=this.getImage(l)),u?r[l]={data:u.data.clone(),pixelRatio:u.pixelRatio,sdf:u.sdf,version:u.version,stretchX:u.stretchX,stretchY:u.stretchY,content:u.content,textFitWidth:u.textFitWidth,textFitHeight:u.textFitHeight,hasRenderCallback:!!(u.userImage&&u.userImage.render)}:c.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:e,height:r}=this.atlasImage;return{width:e,height:r}}getPattern(e){const r=this.patterns[e],l=this.getImage(e);if(!l)return null;if(r&&r.position.version===l.version)return r.position;if(r)r.position.version=l.version;else{const u={w:l.data.width+2,h:l.data.height+2,x:0,y:0},p=new c.I(u,l);this.patterns[e]={bin:u,position:p}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new rt(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const p in this.patterns)e.push(this.patterns[p].bin);const{w:r,h:l}=c.p(e),u=this.atlasImage;u.resize({width:r||1,height:l||1});for(const p in this.patterns){const{bin:y}=this.patterns[p],x=y.x+1,S=y.y+1,k=this.getImage(p).data,E=k.width,z=k.height;c.R.copy(k,u,{x:0,y:0},{x,y:S},{width:E,height:z}),c.R.copy(k,u,{x:0,y:z-1},{x,y:S-1},{width:E,height:1}),c.R.copy(k,u,{x:0,y:0},{x,y:S+z},{width:E,height:1}),c.R.copy(k,u,{x:E-1,y:0},{x:x-1,y:S},{width:1,height:z}),c.R.copy(k,u,{x:0,y:0},{x:x+E,y:S},{width:1,height:z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const l=this.getImage(r);l||c.w(`Image with ID: "${r}" was not found`),Xe(l)&&this.updateImage(r,l)}}}const kt=1e20;function ot(f,e,r,l,u,p,y,x,S){for(let k=e;k<e+l;k++)At(f,r*p+k,p,u,y,x,S);for(let k=r;k<r+u;k++)At(f,k*p+e,1,l,y,x,S)}function At(f,e,r,l,u,p,y){p[0]=0,y[0]=-1e20,y[1]=kt,u[0]=f[e];for(let x=1,S=0,k=0;x<l;x++){u[x]=f[e+x*r];const E=x*x;do{const z=p[S];k=(u[x]-u[z]+E-z*z)/(x-z)/2}while(k<=y[S]&&--S>-1);S++,p[S]=x,y[S]=k,y[S+1]=kt}for(let x=0,S=0;x<l;x++){for(;y[S+1]<x;)S++;const k=p[S],E=x-k;f[e+x*r]=u[k]+E*E}}class Bt{constructor(e,r){this.requestManager=e,this.localIdeographFontFamily=r,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,function*(){const r=[];for(const p in e)for(const y of e[p])r.push(this._getAndCacheGlyphsPromise(p,y));const l=yield Promise.all(r),u={};for(const{stack:p,id:y,glyph:x}of l)u[p]||(u[p]={}),u[p][y]=x&&{id:x.id,bitmap:x.bitmap.clone(),metrics:x.metrics};return u})}_getAndCacheGlyphsPromise(e,r){return c._(this,void 0,void 0,function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let u=l.glyphs[r];if(u!==void 0)return{stack:e,id:r,glyph:u};if(u=this._tinySDF(l,e,r),u)return l.glyphs[r]=u,{stack:e,id:r,glyph:u};const p=Math.floor(r/256);if(256*p>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[p])return{stack:e,id:r,glyph:u};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[p]){const x=Bt.loadGlyphRange(e,p,this.url,this.requestManager);l.requests[p]=x}const y=yield l.requests[p];for(const x in y)this._doesCharSupportLocalGlyph(+x)||(l.glyphs[+x]=y[+x]);return l.ranges[p]=!0,{stack:e,id:r,glyph:y[r]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||c.u["CJK Unified Ideographs"](e)||c.u["Hangul Syllables"](e)||c.u.Hiragana(e)||c.u.Katakana(e)||c.u["CJK Symbols and Punctuation"](e)||c.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,r,l){const u=this.localIdeographFontFamily;if(!u||!this._doesCharSupportLocalGlyph(l))return;let p=e.tinySDF;if(!p){let x="400";/bold/i.test(r)?x="900":/medium/i.test(r)?x="500":/light/i.test(r)&&(x="200"),p=e.tinySDF=new Bt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:u,fontWeight:x})}const y=p.draw(String.fromCharCode(l));return{id:l,bitmap:new c.q({width:y.width||60,height:y.height||60},y.data),metrics:{width:y.glyphWidth/2||24,height:y.glyphHeight/2||24,left:y.glyphLeft/2+.5||0,top:y.glyphTop/2-27.5||-8,advance:y.glyphAdvance/2||24,isDoubleResolution:!0}}}}Bt.loadGlyphRange=function(f,e,r,l){return c._(this,void 0,void 0,function*(){const u=256*e,p=u+255,y=l.transformRequest(r.replace("{fontstack}",f).replace("{range}",`${u}-${p}`),"Glyphs"),x=yield c.n(y,new AbortController);if(!x||!x.data)throw new Error(`Could not load glyph range. range: ${e}, ${u}-${p}`);const S={};for(const k of c.o(x.data))S[k.id]=k;return S})},Bt.TinySDF=class{constructor({fontSize:f=24,buffer:e=3,radius:r=8,cutoff:l=.25,fontFamily:u="sans-serif",fontWeight:p="normal",fontStyle:y="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=r;const x=this.size=f+4*e,S=this._createCanvas(x),k=this.ctx=S.getContext("2d",{willReadFrequently:!0});k.font=`${y} ${p} ${f}px ${u}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(f){const e=document.createElement("canvas");return e.width=e.height=f,e}draw(f){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:l,actualBoundingBoxLeft:u,actualBoundingBoxRight:p}=this.ctx.measureText(f),y=Math.ceil(r),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-u))),S=Math.min(this.size-this.buffer,y+Math.ceil(l)),k=x+2*this.buffer,E=S+2*this.buffer,z=Math.max(k*E,0),D=new Uint8ClampedArray(z),$={data:D,width:k,height:E,glyphWidth:x,glyphHeight:S,glyphTop:y,glyphLeft:0,glyphAdvance:e};if(x===0||S===0)return $;const{ctx:N,buffer:J,gridInner:Y,gridOuter:Q}=this;N.clearRect(J,J,x,S),N.fillText(f,J,J+y);const re=N.getImageData(J,J,x,S);Q.fill(kt,0,z),Y.fill(0,0,z);for(let ne=0;ne<S;ne++)for(let ae=0;ae<x;ae++){const ce=re.data[4*(ne*x+ae)+3]/255;if(ce===0)continue;const de=(ne+J)*k+ae+J;if(ce===1)Q[de]=0,Y[de]=kt;else{const ue=.5-ce;Q[de]=ue>0?ue*ue:0,Y[de]=ue<0?ue*ue:0}}ot(Q,0,0,k,E,k,this.f,this.v,this.z),ot(Y,J,J,x,S,k,this.f,this.v,this.z);for(let ne=0;ne<z;ne++){const ae=Math.sqrt(Q[ne])-Math.sqrt(Y[ne]);D[ne]=Math.round(255-255*(ae/this.radius+this.cutoff))}return $}};class gr{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,r){return c.z(e.expression.evaluate(r))}interpolate(e,r,l){return{x:c.B.number(e.x,r.x,l),y:c.B.number(e.y,r.y,l),z:c.B.number(e.z,r.z,l)}}}let vt;class Et extends c.E{constructor(e){super(),vt=vt||new c.r({anchor:new c.D(c.v.light.anchor),position:new gr,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(vt),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(c.t,e,r))for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,l){return(!l||l.validate!==!1)&&c.x(this,e.call(c.y,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const Ft=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class Ar extends c.E{constructor(e){super(),this._transitionable=new c.T(Ft),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.C(0))}setSky(e,r={}){if(!this._validate(c.F,e,r)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,l={}){return(l==null?void 0:l.validate)!==!1&&c.x(this,e.call(c.y,c.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class zr{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,r){const l=e.join(",")+String(r);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,r)),this.dashEntry[l]}getDashRanges(e,r,l){const u=[];let p=e.length%2==1?-e[e.length-1]*l:0,y=e[0]*l,x=!0;u.push({left:p,right:y,isDash:x,zeroLength:e[0]===0});let S=e[0];for(let k=1;k<e.length;k++){x=!x;const E=e[k];p=S*l,S+=E,y=S*l,u.push({left:p,right:y,isDash:x,zeroLength:E===0})}return u}addRoundDash(e,r,l){const u=r/2;for(let p=-l;p<=l;p++){const y=this.width*(this.nextRow+l+p);let x=0,S=e[x];for(let k=0;k<this.width;k++){k/S.right>1&&(S=e[++x]);const E=Math.abs(k-S.left),z=Math.abs(k-S.right),D=Math.min(E,z);let $;const N=p/l*(u+1);if(S.isDash){const J=u-Math.abs(N);$=Math.sqrt(D*D+J*J)}else $=u-Math.sqrt(D*D+N*N);this.data[y+k]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(e){for(let x=e.length-1;x>=0;--x){const S=e[x],k=e[x+1];S.zeroLength?e.splice(x,1):k&&k.isDash===S.isDash&&(k.left=S.left,e.splice(x,1))}const r=e[0],l=e[e.length-1];r.isDash===l.isDash&&(r.left=l.left-this.width,l.right=r.right+this.width);const u=this.width*this.nextRow;let p=0,y=e[p];for(let x=0;x<this.width;x++){x/y.right>1&&(y=e[++p]);const S=Math.abs(x-y.left),k=Math.abs(x-y.right),E=Math.min(S,k);this.data[u+x]=Math.max(0,Math.min(255,(y.isDash?E:-E)+128))}}addDash(e,r){const l=r?7:0,u=2*l+1;if(this.nextRow+u>this.height)return c.w("LineAtlas out of space"),null;let p=0;for(let x=0;x<e.length;x++)p+=e[x];if(p!==0){const x=this.width/p,S=this.getDashRanges(e,this.width,x);r?this.addRoundDash(S,x,l):this.addRegularDash(S)}const y={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:p};return this.nextRow+=u,this.dirty=!0,y}bind(e){const r=e.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}}const _r="maplibre_preloaded_worker_pool";class or{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<or.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[_r]}numActive(){return Object.keys(this.active).length}}const Gr=Math.floor(K.hardwareConcurrency/2);let Lr,Rr;function yo(){return Lr||(Lr=new or),Lr}or.workerCount=c.G(globalThis)?Math.max(Math.min(Gr,3),1):1;class Ao{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;const l=this.workerPool.acquire(r);for(let u=0;u<l.length;u++){const p=new c.H(l[u],r);p.name=`Worker ${u}`,this.actors.push(p)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,r){const l=[];for(const u of this.actors)l.push(u.sendAsync({type:e,data:r}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(r=>{r.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,r){for(const l of this.actors)l.registerMessageHandler(e,r)}}function Vo(){return Rr||(Rr=new Ao(yo(),c.J),Rr.registerMessageHandler("GR",(f,e,r)=>c.m(e,r))),Rr}function to(f,e){const r=c.K();return c.L(r,r,[1,1,0]),c.M(r,r,[.5*f.width,.5*f.height,1]),f.calculatePosMatrix?c.N(r,r,f.calculatePosMatrix(e.toUnwrapped())):r}function Uo(f,e,r,l,u,p){var y;const x=function(z,D,$){if(z)for(const N of z){const J=D[N];if(J&&J.source===$&&J.type==="fill-extrusion")return!0}else for(const N in D){const J=D[N];if(J.source===$&&J.type==="fill-extrusion")return!0}return!1}((y=u==null?void 0:u.layers)!==null&&y!==void 0?y:null,e,f.id),S=p.maxPitchScaleFactor(),k=f.tilesIn(l,S,x);k.sort(qr);const E=[];for(const z of k)E.push({wrappedTileID:z.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(e,r,f._state,z.queryGeometry,z.cameraQueryGeometry,z.scale,u,p,S,to(f.transform,z.tileID))});return function(z,D){for(const $ in z)for(const N of z[$])se(N,D);return z}(function(z){const D={},$={};for(const N of z){const J=N.queryResults,Y=N.wrappedTileID,Q=$[Y]=$[Y]||{};for(const re in J){const ne=J[re],ae=Q[re]=Q[re]||{},ce=D[re]=D[re]||[];for(const de of ne)ae[de.featureIndex]||(ae[de.featureIndex]=!0,ce.push(de))}}return D}(E),f)}function qr(f,e){const r=f.tileID,l=e.tileID;return r.overscaledZ-l.overscaledZ||r.canonical.y-l.canonical.y||r.wrap-l.wrap||r.canonical.x-l.canonical.x}function se(f,e){const r=f.feature,l=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=l}function pe(f,e,r){return c._(this,void 0,void 0,function*(){let l=f;if(f.url?l=(yield c.j(e.transformRequest(f.url,"Source"),r)).data:yield K.frameAsync(r),!l)return null;const u=c.O(c.e(l,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(u.vectorLayerIds=l.vector_layers.map(p=>p.id)),u})}class ke{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.Q?new c.Q(e.lng,e.lat):c.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.Q?new c.Q(e.lng,e.lat):c.Q.convert(e),this}extend(e){const r=this._sw,l=this._ne;let u,p;if(e instanceof c.Q)u=e,p=e;else{if(!(e instanceof ke))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ke.convert(e)):this.extend(c.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.Q.convert(e)):this;if(u=e._sw,p=e._ne,!u||!p)return this}return r||l?(r.lng=Math.min(u.lng,r.lng),r.lat=Math.min(u.lat,r.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new c.Q(u.lng,u.lat),this._ne=new c.Q(p.lng,p.lat)),this}getCenter(){return new c.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.Q(this.getWest(),this.getNorth())}getSouthEast(){return new c.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:l}=c.Q.convert(e);let u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&u}static convert(e){return e instanceof ke?e:e&&new ke(e)}static fromLngLat(e,r=0){const l=360*r/40075017,u=l/Math.cos(Math.PI/180*e.lat);return new ke(new c.Q(e.lng-u,e.lat-l),new c.Q(e.lng+u,e.lat+l))}adjustAntiMeridian(){const e=new c.Q(this._sw.lng,this._sw.lat),r=new c.Q(this._ne.lng,this._ne.lat);return new ke(e,e.lng>r.lng?new c.Q(r.lng+360,r.lat):r)}}class Ge{constructor(e,r,l){this.bounds=ke.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),l=Math.floor(c.U(this.bounds.getWest())*r),u=Math.floor(c.S(this.bounds.getNorth())*r),p=Math.ceil(c.U(this.bounds.getEast())*r),y=Math.ceil(c.S(this.bounds.getSouth())*r);return e.x>=l&&e.x<p&&e.y>=u&&e.y<y}}class Ne extends c.E{constructor(e,r,l,u){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.O(r,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield pe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new Ge(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new c.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(r,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let u="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((p,y)=>{e.reloadPromise={resolve:p,reject:y}})}else e.actor=this.dispatcher.getActor(),u="LT";e.abortController=new AbortController;try{const p=yield e.actor.sendAsync({type:u,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,p)}catch(p){if(delete e.abortController,e.aborted)return;if(p&&p.status!==404)throw p;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,r){if(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ve extends c.E{constructor(e,r,l,u){super(),this.id=e,this.dispatcher=l,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},r),c.e(this,c.O(r,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield pe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(c.e(this,r),r.bounds&&(this.tileBounds=new Ge(r.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(r){this._tileJSONRequest=null,this.fire(new c.k(r))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield ye.getImage(this.map._requestManager.transformRequest(r,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const u=this.map.painter.context,p=u.gl,y=l.data;e.texture=this.map.painter.getTileTexture(y.width),e.texture?e.texture.update(y,{useMipmap:!0}):(e.texture=new rt(u,y,p.RGBA,{useMipmap:!0}),e.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE,p.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class it extends Ve{constructor(e,r,l,u){super(e,r,l,u),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return c._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const u=yield ye.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){const p=u.data;this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const y=c.b(p)&&c.V()?p:yield this.readImageNow(p),x={type:this.type,uid:e.uid,source:this.id,rawImageData:y,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const S=yield e.actor.sendAsync({type:"LDT",data:x});e.dem=S,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}readImageNow(e){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.W()){const r=e.width+2,l=e.height+2;try{return new c.R({width:r,height:l},yield c.X(e,-1,-1,r,l))}catch{}}return K.getImageData(e,1)})}_getNeighboringTiles(e){const r=e.canonical,l=Math.pow(2,r.z),u=(r.x-1+l)%l,p=r.x===0?e.wrap-1:e.wrap,y=(r.x+1+l)%l,x=r.x+1===l?e.wrap+1:e.wrap,S={};return S[new c.Y(e.overscaledZ,p,r.z,u,r.y).key]={backfilled:!1},S[new c.Y(e.overscaledZ,x,r.z,y,r.y).key]={backfilled:!1},r.y>0&&(S[new c.Y(e.overscaledZ,p,r.z,u,r.y-1).key]={backfilled:!1},S[new c.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},S[new c.Y(e.overscaledZ,x,r.z,y,r.y-1).key]={backfilled:!1}),r.y+1<l&&(S[new c.Y(e.overscaledZ,p,r.z,u,r.y+1).key]={backfilled:!1},S[new c.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},S[new c.Y(e.overscaledZ,x,r.z,y,r.y+1).key]={backfilled:!1}),S}unloadTile(e){return c._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class tt extends c.E{constructor(e,r,l,u){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(u),this._data=r.data,this._options=c.e({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,r.clusterMaxZoom!==void 0&&this.maxzoom<=r.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(r.buffer!==void 0?r.buffer:128),tolerance:this._pixelsToTileUnits(r.tolerance!==void 0?r.tolerance:.375),extent:c.Z,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:c.Z,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(c.Z/this.tileSize)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return c._(this,void 0,void 0,function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,r,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:r,offset:l}})}_updateWorkerData(e){return c._(this,void 0,void 0,function*(){const r=c.e({type:this.type},this.workerOptions);e?r.dataDiff=e:typeof this._data=="string"?(r.request=this.map._requestManager.transformRequest(K.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.l("dataloading",{dataType:"source"}));try{const l=yield this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||l.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));let u=null;l.resourceTiming&&l.resourceTiming[this.id]&&(u=l.resourceTiming[this.id].slice(0));const p={dataType:"source"};this._collectResourceTiming&&u&&u.length>0&&c.e(p,{resourceTiming:u}),this.fire(new c.l("data",Object.assign(Object.assign({},p),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},p),{sourceDataType:"content"})))}catch(l){if(this._pendingLoads--,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(l))}})}loaded(){return this._pendingLoads===0}loadTile(e){return c._(this,void 0,void 0,function*(){const r=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const u=yield this.actor.sendAsync({type:r,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(u,this.map.painter,r==="RT")})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Je extends c.E{constructor(e,r,l,u){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(u),this.options=r}load(e){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const r=yield ye.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,r&&r.data&&(this.image=r.data,e&&(this.coordinates=e),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,this.fire(new c.k(r))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const r=e.map(c.$.fromLngLat);var l;return this.tileID=function(u){let p=1/0,y=1/0,x=-1/0,S=-1/0;for(const D of u)p=Math.min(p,D.x),y=Math.min(y,D.y),x=Math.max(x,D.x),S=Math.max(S,D.y);const k=Math.max(x-p,S-y),E=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),z=Math.pow(2,E);return new c.a0(E,Math.floor((p+x)/2*z),Math.floor((y+S)/2*z))}(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map(u=>this.tileID.getTilePoint(u)._round()),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,r=e.gl;this.texture||(this.texture=new rt(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const p=this.tiles[u];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Ue extends Je{constructor(e,r,l,u){super(e,r,l,u),this.roundZoom=!0,this.type="video",this.options=r}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const r of e.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{const r=yield c.a1(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new c.k(r))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new c.k(new c.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new rt(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const p=this.tiles[u];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class St extends Je{constructor(e,r,l,u){super(e,r,l,u),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(p=>!Array.isArray(p)||p.length!==2||p.some(y=>typeof y!="number"))||this.fire(new c.k(new c.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a2(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new c.k(new c.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,l=r.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new rt(r,this.canvas,l.RGBA,{premultiply:!0});let u=!1;for(const p in this.tiles){const y=this.tiles[p];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,u=!0)}u&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const at={},bt=f=>{switch(f){case"geojson":return tt;case"image":return Je;case"raster":return Ve;case"raster-dem":return it;case"vector":return Ne;case"video":return Ue;case"canvas":return St}return at[f]},It="RTLPluginLoaded";class Ot extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Vo()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(r=>{throw this.status="error",r})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,function*(r,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=K.resolveURL(r),!this.url)throw new Error(`requested url ${r} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(It))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let qt=null;function Vt(){return qt||(qt=new Ot),qt}class Dr{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a3(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const r=e+this.timeAdded;r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,p){const y={};if(!p)return y;for(const x of u){const S=x.layerIds.map(k=>p.getLayer(k)).filter(Boolean);if(S.length!==0){x.layers=S,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(k=>S.filter(E=>E.id===k)[0]));for(const k of S)y[k.id]=x}}return y}(e.buckets,r==null?void 0:r.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const p=this.buckets[u];if(p instanceof c.a5){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const p=this.buckets[u];if(p instanceof c.a5&&p.hasRTLText){this.hasRTLText=!0,Vt().lazyLoad();break}}this.queryPadding=0;for(const u in this.buckets){const p=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(u).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a4}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const u=this.buckets[l];u.uploadPending()&&u.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new rt(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new rt(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,l,u,p,y,x,S,k,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:p,scale:y,tileSize:this.tileSize,pixelPosMatrix:E,transform:S,params:x,queryPadding:this.queryPadding*k},e,r,l):{}}querySourceFeatures(e,r){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const u=l.loadVTLayers(),p=r&&r.sourceLayer?r.sourceLayer:"",y=u._geojsonTileLayer||u[p];if(!y)return;const x=c.a6(r&&r.filter),{z:S,x:k,y:E}=this.tileID.canonical,z={z:S,x:k,y:E};for(let D=0;D<y.length;D++){const $=y.feature(D);if(x.needGeometry){const Y=c.a7($,!0);if(!x.filter(new c.C(this.tileID.overscaledZ),Y,this.tileID.canonical))continue}else if(!x.filter(new c.C(this.tileID.overscaledZ),$))continue;const N=l.getId($,p),J=new c.a8($,S,k,E,N);J.tile=z,e.push(J)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const l=c.a9(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let u=!1;if(this.expirationTime>l)u=!1;else if(r)if(this.expirationTime<r)u=!0;else{const p=this.expirationTime-r;p?this.expirationTime=l+Math.max(p,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const u in this.buckets){if(!r.style.hasLayer(u))continue;const p=this.buckets[u],y=p.layers[0].sourceLayer||"_geojsonTileLayer",x=l[y],S=e[y];if(!x||!S||Object.keys(S).length===0)continue;p.update(S,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=r&&r.style&&r.style.getLayer(u);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(p)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<K.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=K.now()+e}setDependencies(e,r){const l={};for(const u of r)l[u]=!0;this.dependencies[e]=l}hasDependency(e,r){for(const l of e){const u=this.dependencies[l];if(u){for(const p of r)if(u[p])return!0}}return!1}}class Sr{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,l){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const p={value:r,timeout:void 0};if(l!==void 0&&(p.timeout=setTimeout(()=>{this.remove(e,p)},l)),this.data[u].push(p),this.order.push(u),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const l=e.wrapped().key,u=r===void 0?0:this.data[l].indexOf(r),p=this.data[l][u];return this.data[l].splice(u,1),p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(p.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const l in this.data)for(const u of this.data[l])e(u.value)||r.push(u);for(const l of r)this.remove(l.value.tileID,l)}}class vo{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,l){const u=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},c.e(this.stateChanges[e][u],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const p in this.state[e])p!==u&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const p in this.state[e][u])l[p]||(this.deletedStates[e][u][p]=null)}else for(const p in l)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][p]===null&&delete this.deletedStates[e][u][p]}removeFeatureState(e,r,l){if(this.deletedStates[e]===null)return;const u=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&r!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][l]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(l in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][l]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,r){const l=String(r),u=c.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const p=this.deletedStates[e][r];if(p===null)return{};for(const y in p)delete u[y]}return u}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const l={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const p={};for(const y in this.stateChanges[u])this.state[u][y]||(this.state[u][y]={}),c.e(this.state[u][y],this.stateChanges[u][y]),p[y]=this.state[u][y];l[u]=p}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const p={};if(this.deletedStates[u]===null)for(const y in this.state[u])p[y]={},this.state[u][y]={};else for(const y in this.deletedStates[u]){if(this.deletedStates[u][y]===null)this.state[u][y]={};else for(const x of Object.keys(this.deletedStates[u][y]))delete this.state[u][y][x];p[y]=this.state[u][y]}l[u]=l[u]||{},c.e(l[u],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const u in e)e[u].setFeatureState(l,r)}}function uo(f,e,r){const l=e.intersectsFrustum(f);if(!r)return l;const u=e.intersectsPlane(r);return l===0||u===0?0:l===2&&u===2?2:1}function gi(f,e,r,l,u){let p=f;const y=Math.atan(e/r),x=Math.hypot(e,r);return p=f+c.aa(l/x/Math.max(.5,Math.cos(c.ac(u/2)))),p+=1*c.aa(Math.cos(y))/2,p+=c.ad(f-p,-0,0),p}function oi(f,e){const r=(e.roundZoom?Math.round:Math.floor)(f.zoom+c.aa(f.tileSize/e.tileSize));return Math.max(0,r)}function ge(f,e){const r=f.getCameraFrustum(),l=f.getClippingPlane(),u=f.screenPointToMercatorCoordinate(f.getCameraPoint()),p=c.$.fromLngLat(f.center,f.elevation);u.z=p.z+Math.cos(f.pitchInRadians)*f.cameraToCenterDistance/f.worldSize;const y=f.getCoveringTilesDetailsProvider(),x=y.allowVariableZoom(f,e),S=oi(f,e),k=e.minzoom||0,E=e.maxzoom!==void 0?e.maxzoom:f.maxZoom,z=Math.min(Math.max(0,S),E),D=Math.pow(2,z),$=[D*u.x,D*u.y,0],N=[D*p.x,D*p.y,0],J=Math.hypot(p.x-u.x,p.y-u.y),Y=Math.abs(p.z-u.z),Q=Math.hypot(J,Y),re=ce=>({zoom:0,x:0,y:0,wrap:ce,fullyVisible:!1}),ne=[],ae=[];if(f.renderWorldCopies&&y.allowWorldCopies())for(let ce=1;ce<=3;ce++)ne.push(re(-ce)),ne.push(re(ce));for(ne.push(re(0));ne.length>0;){const ce=ne.pop(),de=ce.x,ue=ce.y;let xe=ce.fullyVisible;const Ce={x:de,y:ue,z:ce.zoom},Ee=y.getTileAABB(Ce,ce.wrap,f.elevation,e);if(!xe){const He=uo(r,Ee,l);if(He===0)continue;xe=He===2}const Re=y.distanceToTile2d(u.x,u.y,Ce,Ee);let Ie=S;x&&(Ie=(e.calculateTileZoom||gi)(f.zoom+c.aa(f.tileSize/e.tileSize),Re,Y,Q,f.fov)),Ie=(e.roundZoom?Math.round:Math.floor)(Ie),Ie=Math.max(0,Ie);const Ke=Math.min(Ie,E);if(ce.wrap=y.getWrap(p,Ce,ce.wrap),ce.zoom>=Ke){if(ce.zoom<k)continue;const He=z-ce.zoom,$e=$[0]-.5-(de<<He),ft=$[1]-.5-(ue<<He),yt=e.reparseOverscaled?Math.max(ce.zoom,Ie):ce.zoom;ae.push({tileID:new c.Y(ce.zoom===E?yt:ce.zoom,ce.wrap,ce.zoom,de,ue),distanceSq:c.ab([N[0]-.5-de,N[1]-.5-ue]),tileDistanceToCamera:Math.sqrt($e*$e+ft*ft)})}else for(let He=0;He<4;He++)ne.push({zoom:ce.zoom+1,x:(de<<1)+He%2,y:(ue<<1)+(He>>1),wrap:ce.wrap,fullyVisible:xe})}return ae.sort((ce,de)=>ce.distanceSq-de.distanceSq).map(ce=>ce.tileID)}class A extends c.E{constructor(e,r,l){super(),this.id=e,this.dispatcher=l,this.on("data",u=>this._dataHandler(u)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((u,p,y,x)=>{const S=new(bt(p.type))(u,p,y,x);if(S.id!==u)throw new Error(`Expected Source id to be ${u} instead of ${S.id}`);return S})(e,r,l,this),this._tiles={},this._cache=new Sr(0,u=>this._unloadTile(u)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new vo,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,r,l){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,l)}catch(u){e.state="errored",u.status!==404?this._source.fire(new c.k(u,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const l=this._tiles[r];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(U).map(e=>e.key)}getRenderableIds(e){const r=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&r.push(this._tiles[l]);return e?r.sort((l,u)=>{const p=l.tileID,y=u.tileID,x=new c.P(p.canonical.x,p.canonical.y)._rotate(-this.transform.bearingInRadians),S=new c.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians);return p.overscaledZ-y.overscaledZ||S.y-x.y||S.x-x.x}).map(l=>l.tileID.key):r.map(l=>l.tileID).sort(U).map(l=>l.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)(e||this._tiles[r].state!=="errored")&&this._reloadTile(r,"reloading")}}_reloadTile(e,r){return c._(this,void 0,void 0,function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=r),yield this._loadTile(l,e,r))})}_tileLoaded(e,r,l){e.timeAdded=K.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const r=this.getRenderableIds();for(let u=0;u<r.length;u++){const p=r[u];if(e.neighboringTiles&&e.neighboringTiles[p]){const y=this.getTileByID(p);l(e,y),l(y,e)}}function l(u,p){u.needsHillshadePrepare=!0,u.needsTerrainPrepare=!0;let y=p.tileID.canonical.x-u.tileID.canonical.x;const x=p.tileID.canonical.y-u.tileID.canonical.y,S=Math.pow(2,u.tileID.canonical.z),k=p.tileID.key;y===0&&x===0||Math.abs(x)>1||(Math.abs(y)>1&&(Math.abs(y+S)===1?y+=S:Math.abs(y-S)===1&&(y-=S)),p.dem&&u.dem&&(u.dem.backfillBorder(p.dem,y,x),u.neighboringTiles&&u.neighboringTiles[k]&&(u.neighboringTiles[k].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,l,u){for(const p in this._tiles){let y=this._tiles[p];if(u[p]||!y.hasData()||y.tileID.overscaledZ<=r||y.tileID.overscaledZ>l)continue;let x=y.tileID;for(;y&&y.tileID.overscaledZ>r+1;){const k=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[k.key],y&&y.hasData()&&(x=k)}let S=x;for(;S.overscaledZ>r;)if(S=S.scaledTo(S.overscaledZ-1),e[S.key]||e[S.canonical.key]){u[x.key]=x;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=r?l:null}for(let l=e.overscaledZ-1;l>=r;l--){const u=e.scaledTo(l),p=this._getLoadedTile(u);if(p)return p}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const r=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,u=Math.floor(r*l*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),p=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,u):u;this._cache.setMaxSize(p)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const l={};for(const u in this._tiles){const p=this._tiles[u];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+r),l[p.tileID.key]=p}this._tiles=l;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(u,this._tiles[u])}}_updateCoveredAndRetainedTiles(e,r,l,u,p,y){const x={},S={},k=Object.keys(e),E=K.now();for(const z of k){const D=e[z],$=this._tiles[z];if(!$||$.fadeEndTime!==0&&$.fadeEndTime<=E)continue;const N=this.findLoadedParent(D,r),J=this.findLoadedSibling(D),Y=N||J||null;Y&&(this._addTile(Y.tileID),x[Y.tileID.key]=Y.tileID),S[z]=D}this._retainLoadedChildren(S,u,l,e);for(const z in x)e[z]||(this._coveredTiles[z]=!0,e[z]=x[z]);if(y){const z={},D={};for(const $ of p)this._tiles[$.key].hasData()?z[$.key]=$:D[$.key]=$;for(const $ in D){const N=D[$].children(this._source.maxzoom);this._tiles[N[0].key]&&this._tiles[N[1].key]&&this._tiles[N[2].key]&&this._tiles[N[3].key]&&(z[N[0].key]=e[N[0].key]=N[0],z[N[1].key]=e[N[1].key]=N[1],z[N[2].key]=e[N[2].key]=N[2],z[N[3].key]=e[N[3].key]=N[3],delete D[$])}for(const $ in D){const N=D[$],J=this.findLoadedParent(N,this._source.minzoom),Y=this.findLoadedSibling(N),Q=J||Y||null;if(Q){z[Q.tileID.key]=e[Q.tileID.key]=Q.tileID;for(const re in z)z[re].isChildOf(Q.tileID)&&delete z[re]}}for(const $ in this._tiles)z[$]||(this._coveredTiles[$]=!0)}}update(e,r){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(E=>new c.Y(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y)):(l=ge(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter(E=>this._source.hasTile(E)))):l=[];const u=oi(e,this._source),p=Math.max(u-A.maxOverzooming,this._source.minzoom),y=Math.max(u+A.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const E={};for(const z of l)if(z.canonical.z>this._source.minzoom){const D=z.scaledTo(z.canonical.z-1);E[D.key]=D;const $=z.scaledTo(Math.max(this._source.minzoom,Math.min(z.canonical.z,5)));E[$.key]=$}l=l.concat(Object.values(E))}const x=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,x&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const S=this._updateRetainedTiles(l,u);X(this._source.type)&&this._updateCoveredAndRetainedTiles(S,p,y,u,l,r);for(const E in S)this._tiles[E].clearFadeHold();const k=c.ae(this._tiles,S);for(const E of k){const z=this._tiles[E];z.hasSymbolBuckets&&!z.holdingForFade()?z.setHoldDuration(this.map._fadeDuration):z.hasSymbolBuckets&&!z.symbolFadeFinished()||this._removeTile(E)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,r){var l;const u={},p={},y=Math.max(r-A.maxOverzooming,this._source.minzoom),x=Math.max(r+A.maxUnderzooming,this._source.minzoom),S={};for(const k of e){const E=this._addTile(k);u[k.key]=k,E.hasData()||r<this._source.maxzoom&&(S[k.key]=k)}this._retainLoadedChildren(S,r,x,u);for(const k of e){let E=this._tiles[k.key];if(E.hasData())continue;if(r+1>this._source.maxzoom){const D=k.children(this._source.maxzoom)[0],$=this.getTile(D);if($&&$.hasData()){u[D.key]=D;continue}}else{const D=k.children(this._source.maxzoom);if(u[D[0].key]&&u[D[1].key]&&u[D[2].key]&&u[D[3].key])continue}let z=E.wasRequested();for(let D=k.overscaledZ-1;D>=y;--D){const $=k.scaledTo(D);if(p[$.key])break;if(p[$.key]=!0,E=this.getTile($),!E&&z&&(E=this._addTile($)),E){const N=E.hasData();if((N||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||z)&&(u[$.key]=$),z=E.wasRequested(),N)break}}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let l,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){l=this._loadedParentTiles[u.key];break}r.push(u.key);const p=u.scaledTo(u.overscaledZ-1);if(l=this._getLoadedTile(p),l)break;u=p}for(const p of r)this._loadedParentTiles[p]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const r=this._tiles[e].tileID,l=this._getLoadedTile(r);this._loadedSiblingTiles[r.key]=l}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const l=r;return r||(r=new Dr(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,l||this._source.fire(new c.l("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=r.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(e){const r=e.sourceDataType;e.dataType==="source"&&r==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&r==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,l){const u=[],p=this.transform;if(!p)return u;const y=l?p.getCameraQueryGeometry(e):e,x=e.map(N=>p.screenPointToMercatorCoordinate(N,this.terrain)),S=y.map(N=>p.screenPointToMercatorCoordinate(N,this.terrain)),k=this.getIds();let E=1/0,z=1/0,D=-1/0,$=-1/0;for(const N of S)E=Math.min(E,N.x),z=Math.min(z,N.y),D=Math.max(D,N.x),$=Math.max($,N.y);for(let N=0;N<k.length;N++){const J=this._tiles[k[N]];if(J.holdingForFade())continue;const Y=J.tileID,Q=Math.pow(2,p.zoom-J.tileID.overscaledZ),re=r*J.queryPadding*c.Z/J.tileSize/Q,ne=[Y.getTilePoint(new c.$(E,z)),Y.getTilePoint(new c.$(D,$))];if(ne[0].x-re<c.Z&&ne[0].y-re<c.Z&&ne[1].x+re>=0&&ne[1].y+re>=0){const ae=x.map(de=>Y.getTilePoint(de)),ce=S.map(de=>Y.getTilePoint(de));u.push({tile:J,tileID:Y,queryGeometry:ae,cameraQueryGeometry:ce,scale:Q})}}return u}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);return this.transform&&this.transform.populateCache(r),r}hasTransition(){if(this._source.hasTransition())return!0;if(X(this._source.type)){const e=K.now();for(const r in this._tiles)if(this._tiles[r].fadeEndTime>=e)return!0}return!1}setFeatureState(e,r,l){this._state.updateState(e=e||"_geojsonTileLayer",r,l)}removeFeatureState(e,r,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,l)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,l){const u=this._tiles[e];u&&u.setDependencies(r,l)}reloadTilesForDependencies(e,r){for(const l in this._tiles)this._tiles[l].hasDependency(e,r)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(e,r))}}function U(f,e){const r=Math.abs(2*f.wrap)-+(f.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return f.overscaledZ-e.overscaledZ||l-r||e.canonical.y-f.canonical.y||e.canonical.x-f.canonical.x}function X(f){return f==="raster"||f==="image"||f==="video"}A.maxOverzooming=10,A.maxUnderzooming=3;class te{constructor(e,r){this.reset(e,r)}reset(e,r){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ad(e,0,1);let r=1,l=this._distances[r];const u=e*this.paddedLength+this.padding;for(;l<u&&r<this._distances.length;)l=this._distances[++r];const p=r-1,y=this._distances[p],x=l-y,S=x>0?(u-y)/x:0;return this.points[p].mult(1-S).add(this.points[r].mult(S))}}function le(f,e){let r=!0;return f==="always"||f!=="never"&&e!=="never"||(r=!1),r}class _e{constructor(e,r,l){const u=this.boxCells=[],p=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(r/l);for(let y=0;y<this.xCellCount*this.yCellCount;y++)u.push([]),p.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,r,l,u,p){this._forEachCell(r,l,u,p,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(p)}insertCircle(e,r,l,u){this._forEachCell(r-u,l-u,r+u,l+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(r),this.circles.push(l),this.circles.push(u)}_insertBoxCell(e,r,l,u,p,y){this.boxCells[p].push(y)}_insertCircleCell(e,r,l,u,p,y){this.circleCells[p].push(y)}_query(e,r,l,u,p,y,x){if(l<0||e>this.width||u<0||r>this.height)return[];const S=[];if(e<=0&&r<=0&&this.width<=l&&this.height<=u){if(p)return[{key:null,x1:e,y1:r,x2:l,y2:u}];for(let k=0;k<this.boxKeys.length;k++)S.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const E=this.circles[3*k],z=this.circles[3*k+1],D=this.circles[3*k+2];S.push({key:this.circleKeys[k],x1:E-D,y1:z-D,x2:E+D,y2:z+D})}}else this._forEachCell(e,r,l,u,this._queryCell,S,{hitTest:p,overlapMode:y,seenUids:{box:{},circle:{}}},x);return S}query(e,r,l,u){return this._query(e,r,l,u,!1,null)}hitTest(e,r,l,u,p,y){return this._query(e,r,l,u,!0,p,y).length>0}hitTestCircle(e,r,l,u,p){const y=e-l,x=e+l,S=r-l,k=r+l;if(x<0||y>this.width||k<0||S>this.height)return!1;const E=[];return this._forEachCell(y,S,x,k,this._queryCellCircle,E,{hitTest:!0,overlapMode:u,circle:{x:e,y:r,radius:l},seenUids:{box:{},circle:{}}},p),E.length>0}_queryCell(e,r,l,u,p,y,x,S){const{seenUids:k,hitTest:E,overlapMode:z}=x,D=this.boxCells[p];if(D!==null){const N=this.bboxes;for(const J of D)if(!k.box[J]){k.box[J]=!0;const Y=4*J,Q=this.boxKeys[J];if(e<=N[Y+2]&&r<=N[Y+3]&&l>=N[Y+0]&&u>=N[Y+1]&&(!S||S(Q))&&(!E||!le(z,Q.overlapMode))&&(y.push({key:Q,x1:N[Y],y1:N[Y+1],x2:N[Y+2],y2:N[Y+3]}),E))return!0}}const $=this.circleCells[p];if($!==null){const N=this.circles;for(const J of $)if(!k.circle[J]){k.circle[J]=!0;const Y=3*J,Q=this.circleKeys[J];if(this._circleAndRectCollide(N[Y],N[Y+1],N[Y+2],e,r,l,u)&&(!S||S(Q))&&(!E||!le(z,Q.overlapMode))){const re=N[Y],ne=N[Y+1],ae=N[Y+2];if(y.push({key:Q,x1:re-ae,y1:ne-ae,x2:re+ae,y2:ne+ae}),E)return!0}}}return!1}_queryCellCircle(e,r,l,u,p,y,x,S){const{circle:k,seenUids:E,overlapMode:z}=x,D=this.boxCells[p];if(D!==null){const N=this.bboxes;for(const J of D)if(!E.box[J]){E.box[J]=!0;const Y=4*J,Q=this.boxKeys[J];if(this._circleAndRectCollide(k.x,k.y,k.radius,N[Y+0],N[Y+1],N[Y+2],N[Y+3])&&(!S||S(Q))&&!le(z,Q.overlapMode))return y.push(!0),!0}}const $=this.circleCells[p];if($!==null){const N=this.circles;for(const J of $)if(!E.circle[J]){E.circle[J]=!0;const Y=3*J,Q=this.circleKeys[J];if(this._circlesCollide(N[Y],N[Y+1],N[Y+2],k.x,k.y,k.radius)&&(!S||S(Q))&&!le(z,Q.overlapMode))return y.push(!0),!0}}}_forEachCell(e,r,l,u,p,y,x,S){const k=this._convertToXCellCoord(e),E=this._convertToYCellCoord(r),z=this._convertToXCellCoord(l),D=this._convertToYCellCoord(u);for(let $=k;$<=z;$++)for(let N=E;N<=D;N++)if(p.call(this,e,r,l,u,this.xCellCount*N+$,y,x,S))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,r,l,u,p,y){const x=u-e,S=p-r,k=l+y;return k*k>x*x+S*S}_circleAndRectCollide(e,r,l,u,p,y,x){const S=(y-u)/2,k=Math.abs(e-(u+S));if(k>S+l)return!1;const E=(x-p)/2,z=Math.abs(r-(p+E));if(z>E+l)return!1;if(k<=S||z<=E)return!0;const D=k-S,$=z-E;return D*D+$*$<=l*l}}function Se(f,e,r){const l=c.K();if(!f){const{vecSouth:z,vecEast:D}=ze(e),$=Z();$[0]=D[0],$[1]=D[1],$[2]=z[0],$[3]=z[1],u=$,(E=(y=(p=$)[0])*(k=p[3])-(S=p[2])*(x=p[1]))&&(u[0]=k*(E=1/E),u[1]=-x*E,u[2]=-S*E,u[3]=y*E),l[0]=$[0],l[1]=$[1],l[4]=$[2],l[5]=$[3]}var u,p,y,x,S,k,E;return c.M(l,l,[1/r,1/r,1]),l}function me(f,e,r,l){if(f){const u=c.K();if(!e){const{vecSouth:p,vecEast:y}=ze(r);u[0]=y[0],u[1]=y[1],u[4]=p[0],u[5]=p[1]}return c.M(u,u,[l,l,1]),u}return r.pixelsToClipSpaceMatrix}function ze(f){const e=Math.cos(f.rollInRadians),r=Math.sin(f.rollInRadians),l=Math.cos(f.pitchInRadians),u=Math.cos(f.bearingInRadians),p=Math.sin(f.bearingInRadians),y=c.aj();y[0]=-u*l*r-p*e,y[1]=-p*l*r+u*e;const x=c.ak(y);x<1e-9?c.al(y):c.am(y,y,1/x);const S=c.aj();S[0]=u*l*e-p*r,S[1]=p*l*e+u*r;const k=c.ak(S);return k<1e-9?c.al(S):c.am(S,S,1/k),{vecEast:S,vecSouth:y}}function Pe(f,e,r,l){let u;l?(u=[f,e,l(f,e),1],c.ao(u,u,r)):(u=[f,e,0,1],Wr(u,u,r));const p=u[3];return{point:new c.P(u[0]/p,u[1]/p),signedDistanceFromCamera:p,isOccluded:!1}}function ve(f,e){return .5+f/e*.5}function Fe(f,e){return f.x>=-e[0]&&f.x<=e[0]&&f.y>=-e[1]&&f.y<=e[1]}function be(f,e,r,l,u,p,y,x,S,k,E,z,D){const $=r?f.textSizeData:f.iconSizeData,N=c.af($,e.transform.zoom),J=[256/e.width*2+1,256/e.height*2+1],Y=r?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;Y.clear();const Q=f.lineVertexArray,re=r?f.text.placedSymbolArray:f.icon.placedSymbolArray,ne=e.transform.width/e.transform.height;let ae=!1;for(let ce=0;ce<re.length;ce++){const de=re.get(ce);if(de.hidden||de.writingMode===c.ag.vertical&&!ae){Nr(de.numGlyphs,Y);continue}ae=!1;const ue=new c.P(de.anchorX,de.anchorY),xe={getElevation:D,pitchedLabelPlaneMatrix:l,lineVertexArray:Q,pitchWithMap:p,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:ue,unwrappedTileID:S,width:k,height:E,translation:z},Ce=Lt(de.anchorX,de.anchorY,xe);if(!Fe(Ce.point,J)){Nr(de.numGlyphs,Y);continue}const Ee=ve(e.transform.cameraToCenterDistance,Ce.signedDistanceFromCamera),Re=c.ah($,N,de),Ie=p?Re*e.transform.getPitchedTextCorrection(de.anchorX,de.anchorY,S)/Ee:Re*Ee,Ke=zt({projectionContext:xe,pitchedLabelPlaneMatrixInverse:u,symbol:de,fontSize:Ie,flip:!1,keepUpright:y,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:Y,aspectRatio:ne,rotateToLine:x});ae=Ke.useVertical,(Ke.notEnoughRoom||ae||Ke.needsFlipping&&zt({projectionContext:xe,pitchedLabelPlaneMatrixInverse:u,symbol:de,fontSize:Ie,flip:!0,keepUpright:y,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:Y,aspectRatio:ne,rotateToLine:x}).notEnoughRoom)&&Nr(de.numGlyphs,Y)}r?f.text.dynamicLayoutVertexBuffer.updateData(Y):f.icon.dynamicLayoutVertexBuffer.updateData(Y)}function Qe(f,e,r,l,u,p,y,x){const S=p.glyphStartIndex+p.numGlyphs,k=p.lineStartIndex,E=p.lineStartIndex+p.lineLength,z=e.getoffsetX(p.glyphStartIndex),D=e.getoffsetX(S-1),$=xt(f*z,r,l,u,p.segment,k,E,x,y);if(!$)return null;const N=xt(f*D,r,l,u,p.segment,k,E,x,y);return N?x.projectionCache.anyProjectionOccluded?null:{first:$,last:N}:null}function gt(f,e,r,l){return f===c.ag.horizontal&&Math.abs(r.y-e.y)>Math.abs(r.x-e.x)*l?{useVertical:!0}:(f===c.ag.vertical?e.y<r.y:e.x>r.x)?{needsFlipping:!0}:null}function zt(f){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:r,symbol:l,fontSize:u,flip:p,keepUpright:y,glyphOffsetArray:x,dynamicLayoutVertexArray:S,aspectRatio:k,rotateToLine:E}=f,z=u/24,D=l.lineOffsetX*z,$=l.lineOffsetY*z;let N;if(l.numGlyphs>1){const J=l.glyphStartIndex+l.numGlyphs,Y=l.lineStartIndex,Q=l.lineStartIndex+l.lineLength,re=Qe(z,x,D,$,p,l,E,e);if(!re)return{notEnoughRoom:!0};const ne=ht(re.first.point.x,re.first.point.y,e,r),ae=ht(re.last.point.x,re.last.point.y,e,r);if(y&&!p){const ce=gt(l.writingMode,ne,ae,k);if(ce)return ce}N=[re.first];for(let ce=l.glyphStartIndex+1;ce<J-1;ce++)N.push(xt(z*x.getoffsetX(ce),D,$,p,l.segment,Y,Q,e,E));N.push(re.last)}else{if(y&&!p){const Y=dt(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,Q=l.lineStartIndex+l.segment+1,re=new c.P(e.lineVertexArray.getx(Q),e.lineVertexArray.gety(Q)),ne=dt(re.x,re.y,e),ae=ne.signedDistanceFromCamera>0?ne.point:Pt(e.tileAnchorPoint,re,Y,1,e),ce=ht(Y.x,Y.y,e,r),de=ht(ae.x,ae.y,e,r),ue=gt(l.writingMode,ce,de,k);if(ue)return ue}const J=xt(z*x.getoffsetX(l.glyphStartIndex),D,$,p,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,E);if(!J||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};N=[J]}for(const J of N)c.an(S,J.point,J.angle);return{}}function Pt(f,e,r,l,u){const p=f.add(f.sub(e)._unit()),y=dt(p.x,p.y,u).point,x=r.sub(y);return r.add(x._mult(l/x.mag()))}function Le(f,e,r){const l=e.projectionCache;if(l.projections[f])return l.projections[f];const u=new c.P(e.lineVertexArray.getx(f),e.lineVertexArray.gety(f)),p=dt(u.x,u.y,e);if(p.signedDistanceFromCamera>0)return l.projections[f]=p.point,l.anyProjectionOccluded=l.anyProjectionOccluded||p.isOccluded,p.point;const y=f-r.direction;return Pt(r.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(y),e.lineVertexArray.gety(y)),u,r.previousVertex,r.absOffsetX-r.distanceFromAnchor+1,e)}function dt(f,e,r){const l=f+r.translation[0],u=e+r.translation[1];let p;return r.pitchWithMap?(p=Pe(l,u,r.pitchedLabelPlaneMatrix,r.getElevation),p.isOccluded=!1):(p=r.transform.projectTileCoordinates(l,u,r.unwrappedTileID,r.getElevation),p.point.x=(.5*p.point.x+.5)*r.width,p.point.y=(.5*-p.point.y+.5)*r.height),p}function ht(f,e,r,l){if(r.pitchWithMap){const u=[f,e,0,1];return c.ao(u,u,l),r.transform.projectTileCoordinates(u[0]/u[3],u[1]/u[3],r.unwrappedTileID,r.getElevation).point}return{x:f/r.width*2-1,y:e/r.height*2-1}}function Lt(f,e,r){return r.transform.projectTileCoordinates(f,e,r.unwrappedTileID,r.getElevation)}function Mt(f,e,r){return f._unit()._perp()._mult(e*r)}function $t(f,e,r,l,u,p,y,x,S){if(x.projectionCache.offsets[f])return x.projectionCache.offsets[f];const k=r.add(e);if(f+S.direction<l||f+S.direction>=u)return x.projectionCache.offsets[f]=k,k;const E=Le(f+S.direction,x,S),z=Mt(E.sub(r),y,S.direction),D=r.add(z),$=E.add(z);return x.projectionCache.offsets[f]=c.ap(p,k,D,$)||k,x.projectionCache.offsets[f]}function xt(f,e,r,l,u,p,y,x,S){const k=l?f-e:f+e;let E=k>0?1:-1,z=0;l&&(E*=-1,z=Math.PI),E<0&&(z+=Math.PI);let D,$=E>0?p+u:p+u+1;x.projectionCache.cachedAnchorPoint?D=x.projectionCache.cachedAnchorPoint:(D=dt(x.tileAnchorPoint.x,x.tileAnchorPoint.y,x).point,x.projectionCache.cachedAnchorPoint=D);let N,J,Y=D,Q=D,re=0,ne=0;const ae=Math.abs(k),ce=[];let de;for(;re+ne<=ae;){if($+=E,$<p||$>=y)return null;re+=ne,Q=Y,J=N;const Ce={absOffsetX:ae,direction:E,distanceFromAnchor:re,previousVertex:Q};if(Y=Le($,x,Ce),r===0)ce.push(Q),de=Y.sub(Q);else{let Ee;const Re=Y.sub(Q);Ee=Re.mag()===0?Mt(Le($+E,x,Ce).sub(Y),r,E):Mt(Re,r,E),J||(J=Q.add(Ee)),N=$t($,Ee,Y,p,y,J,r,x,Ce),ce.push(J),de=N.sub(J)}ne=de.mag()}const ue=de._mult((ae-re)/ne)._add(J||Q),xe=z+Math.atan2(Y.y-Q.y,Y.x-Q.x);return ce.push(ue),{point:ue,angle:S?xe:0,path:ce}}const pn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Nr(f,e){for(let r=0;r<f;r++){const l=e.length;e.resize(l+4),e.float32.set(pn,3*l)}}function Wr(f,e,r){const l=e[0],u=e[1];return f[0]=r[0]*l+r[4]*u+r[12],f[1]=r[1]*l+r[5]*u+r[13],f[3]=r[3]*l+r[7]*u+r[15],f}const fr=100;class _a{constructor(e,r=new _e(e.width+200,e.height+200,25),l=new _e(e.width+200,e.height+200,25)){this.transform=e,this.grid=r,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+fr,this.screenBottomBoundary=e.height+fr,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,r,l,u,p,y,x,S,k,E,z,D){const $=this.projectAndGetPerspectiveRatio(e.anchorPointX+S[0],e.anchorPointY+S[1],p,E,D),N=l*$.perspectiveRatio;let J;if(y||x)J=this._projectCollisionBox(e,N,u,p,y,x,S,$,E,z,D);else{const de=$.x+(z?z.x*N:0),ue=$.y+(z?z.y*N:0);J={allPointsOccluded:!1,box:[de+e.x1*N,ue+e.y1*N,de+e.x2*N,ue+e.y2*N]}}const[Y,Q,re,ne]=J.box,ae=y?J.allPointsOccluded:$.isOccluded;let ce=ae;return ce||(ce=$.perspectiveRatio<this.perspectiveRatioCutoff),ce||(ce=!this.isInsideGrid(Y,Q,re,ne)),ce||r!=="always"&&this.grid.hitTest(Y,Q,re,ne,r,k)?{box:[Y,Q,re,ne],placeable:!1,offscreen:!1,occluded:ae}:{box:[Y,Q,re,ne],placeable:!0,offscreen:this.isOffscreen(Y,Q,re,ne),occluded:ae}}placeCollisionCircles(e,r,l,u,p,y,x,S,k,E,z,D,$,N){const J=[],Y=new c.P(r.anchorX,r.anchorY),Q=this.getPerspectiveRatio(Y.x,Y.y,y,N),re=(k?p*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,y)/Q:p*Q)/c.au,ne={getElevation:N,pitchedLabelPlaneMatrix:x,lineVertexArray:l,pitchWithMap:k,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Y,unwrappedTileID:y,width:this.transform.width,height:this.transform.height,translation:$},ae=Qe(re,u,r.lineOffsetX*re,r.lineOffsetY*re,!1,r,!1,ne);let ce=!1,de=!1,ue=!0;if(ae){const xe=.5*z*Q+D,Ce=new c.P(-100,-100),Ee=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Re=new te,Ie=ae.first,Ke=ae.last;let He=[];for(let yt=Ie.path.length-1;yt>=1;yt--)He.push(Ie.path[yt]);for(let yt=1;yt<Ke.path.length;yt++)He.push(Ke.path[yt]);const $e=2.5*xe;if(k){const yt=this.projectPathToScreenSpace(He,ne);He=yt.some(Jt=>Jt.signedDistanceFromCamera<=0)?[]:yt.map(Jt=>Jt.point)}let ft=[];if(He.length>0){const yt=He[0].clone(),Jt=He[0].clone();for(let cr=1;cr<He.length;cr++)yt.x=Math.min(yt.x,He[cr].x),yt.y=Math.min(yt.y,He[cr].y),Jt.x=Math.max(Jt.x,He[cr].x),Jt.y=Math.max(Jt.y,He[cr].y);ft=yt.x>=Ce.x&&Jt.x<=Ee.x&&yt.y>=Ce.y&&Jt.y<=Ee.y?[He]:Jt.x<Ce.x||yt.x>Ee.x||Jt.y<Ce.y||yt.y>Ee.y?[]:c.aq([He],Ce.x,Ce.y,Ee.x,Ee.y)}for(const yt of ft){Re.reset(yt,.25*xe);let Jt=0;Jt=Re.length<=.5*xe?1:Math.ceil(Re.paddedLength/$e)+1;for(let cr=0;cr<Jt;cr++){const ir=cr/Math.max(Jt-1,1),br=Re.lerp(ir),pr=br.x+fr,er=br.y+fr;J.push(pr,er,xe,0);const nr=pr-xe,io=er-xe,no=pr+xe,Hr=er+xe;if(ue=ue&&this.isOffscreen(nr,io,no,Hr),de=de||this.isInsideGrid(nr,io,no,Hr),e!=="always"&&this.grid.hitTestCircle(pr,er,xe,e,E)&&(ce=!0,!S))return{circles:[],offscreen:!1,collisionDetected:ce}}}}return{circles:!S&&ce||!de||Q<this.perspectiveRatioCutoff?[]:J,offscreen:ue,collisionDetected:ce}}projectPathToScreenSpace(e,r){const l=function(u,p){const y=c.K();return c.ai(y,p.pitchedLabelPlaneMatrix),u.map(x=>{const S=Pe(x.x,x.y,y,p.getElevation),k=p.transform.projectTileCoordinates(S.point.x,S.point.y,p.unwrappedTileID,p.getElevation);return k.point.x=(.5*k.point.x+.5)*p.width,k.point.y=(.5*-k.point.y+.5)*p.height,k})}(e,r);return function(u){let p=0,y=0,x=0,S=0;for(let k=0;k<u.length;k++)u[k].isOccluded?(x=k+1,S=0):(S++,S>y&&(y=S,p=x));return u.slice(p,p+y)}(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[];let l=1/0,u=1/0,p=-1/0,y=-1/0;for(const E of e){const z=new c.P(E.x+fr,E.y+fr);l=Math.min(l,z.x),u=Math.min(u,z.y),p=Math.max(p,z.x),y=Math.max(y,z.y),r.push(z)}const x=this.grid.query(l,u,p,y).concat(this.ignoredGrid.query(l,u,p,y)),S={},k={};for(const E of x){const z=E.key;if(S[z.bucketInstanceId]===void 0&&(S[z.bucketInstanceId]={}),S[z.bucketInstanceId][z.featureIndex])continue;const D=[new c.P(E.x1,E.y1),new c.P(E.x2,E.y1),new c.P(E.x2,E.y2),new c.P(E.x1,E.y2)];c.ar(r,D)&&(S[z.bucketInstanceId][z.featureIndex]=!0,k[z.bucketInstanceId]===void 0&&(k[z.bucketInstanceId]=[]),k[z.bucketInstanceId].push(z.featureIndex))}return k}insertCollisionBox(e,r,l,u,p,y){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:u,featureIndex:p,collisionGroupID:y,overlapMode:r},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,r,l,u,p,y){const x=l?this.ignoredGrid:this.grid,S={bucketInstanceId:u,featureIndex:p,collisionGroupID:y,overlapMode:r};for(let k=0;k<e.length;k+=4)x.insertCircle(S,e[k],e[k+1],e[k+2])}projectAndGetPerspectiveRatio(e,r,l,u,p){if(p){let y;u?(y=[e,r,u(e,r),1],c.ao(y,y,p)):(y=[e,r,0,1],Wr(y,y,p));const x=y[3];return{x:(y[0]/x+1)/2*this.transform.width+fr,y:(-y[1]/x+1)/2*this.transform.height+fr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/x*.5,isOccluded:!1,signedDistanceFromCamera:x}}{const y=this.transform.projectTileCoordinates(e,r,l,u);return{x:(y.point.x+1)/2*this.transform.width+fr,y:(1-y.point.y)/2*this.transform.height+fr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5,isOccluded:y.isOccluded,signedDistanceFromCamera:y.signedDistanceFromCamera}}}getPerspectiveRatio(e,r,l,u){const p=this.transform.projectTileCoordinates(e,r,l,u);return .5+this.transform.cameraToCenterDistance/p.signedDistanceFromCamera*.5}isOffscreen(e,r,l,u){return l<fr||e>=this.screenRightBoundary||u<fr||r>this.screenBottomBoundary}isInsideGrid(e,r,l,u){return l>=0&&e<this.gridRightBoundary&&u>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const e=c.as([]);return c.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,r,l,u,p,y,x,S,k,E,z){let D=1,$=0,N=0,J=1;const Y=e.anchorPointX+x[0],Q=e.anchorPointY+x[1];if(y&&!p){const He=this.projectAndGetPerspectiveRatio(Y+1,Q,u,k,z),$e=He.x-S.x,ft=Math.atan((He.y-S.y)/$e)+($e<0?Math.PI:0),yt=Math.sin(ft),Jt=Math.cos(ft);D=Jt,$=yt,N=-yt,J=Jt}else if(!y&&p){const He=ze(this.transform);D=He.vecEast[0],$=He.vecEast[1],N=He.vecSouth[0],J=He.vecSouth[1]}let re=S.x,ne=S.y,ae=r;p&&(re=Y,ne=Q,ae=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),ae*=this.transform.getPitchedTextCorrection(Y,Q,u),E||(ae*=c.ad(.5+S.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),E&&(re+=D*E.x*ae+N*E.y*ae,ne+=$*E.x*ae+J*E.y*ae);const ce=e.x1*ae,de=e.x2*ae,ue=(ce+de)/2,xe=e.y1*ae,Ce=e.y2*ae,Ee=(xe+Ce)/2,Re=[{offsetX:ce,offsetY:xe},{offsetX:ue,offsetY:xe},{offsetX:de,offsetY:xe},{offsetX:de,offsetY:Ee},{offsetX:de,offsetY:Ce},{offsetX:ue,offsetY:Ce},{offsetX:ce,offsetY:Ce},{offsetX:ce,offsetY:Ee}];let Ie=[];for(const{offsetX:He,offsetY:$e}of Re)Ie.push(new c.P(re+D*He+N*$e,ne+$*He+J*$e));let Ke=!1;if(p){const He=Ie.map($e=>this.projectAndGetPerspectiveRatio($e.x,$e.y,u,k,z));Ke=He.some($e=>!$e.isOccluded),Ie=He.map($e=>new c.P($e.x,$e.y))}else Ke=!0;return{box:c.at(Ie),allPointsOccluded:!Ke}}}class zo{constructor(e,r,l,u){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?r:-r))):u&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class sr{constructor(e,r,l,u,p){this.text=new zo(e?e.text:null,r,l,p),this.icon=new zo(e?e.icon:null,r,u,p)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ou{constructor(e,r,l){this.text=e,this.icon=r,this.skipFade=l}}class As{constructor(e,r,l,u,p){this.bucketInstanceId=e,this.featureIndex=r,this.sourceLayerIndex=l,this.bucketIndex=u,this.tileID=p}}class Rl{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const r=++this.maxGroupID;this.collisionGroups[e]={ID:r,predicate:l=>l.collisionGroupID===r}}return this.collisionGroups[e]}}function Yi(f,e,r,l,u){const{horizontalAlign:p,verticalAlign:y}=c.aA(f);return new c.P(-(p-.5)*e+l[0]*u,-(y-.5)*r+l[1]*u)}class Gn{constructor(e,r,l,u,p){this.transform=e.clone(),this.terrain=r,this.collisionIndex=new _a(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Rl(u),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=p,p&&(p.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const r=this.terrain;return r?(l,u)=>r.getElevation(e,l,u):null}getBucketParts(e,r,l,u){const p=l.getBucket(r),y=l.latestFeatureIndex;if(!p||!y||r.id!==p.layerIds[0])return;const x=l.collisionBoxArray,S=p.layers[0].layout,k=p.layers[0].paint,E=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),z=l.tileSize/c.Z,D=l.tileID.toUnwrapped(),$=S.get("text-rotation-alignment")==="map",N=c.av(l,1,this.transform.zoom),J=c.aw(this.collisionIndex.transform,l,k.get("text-translate"),k.get("text-translate-anchor")),Y=c.aw(this.collisionIndex.transform,l,k.get("icon-translate"),k.get("icon-translate-anchor")),Q=Se($,this.transform,N);this.retainedQueryData[p.bucketInstanceId]=new As(p.bucketInstanceId,y,p.sourceLayerIndex,p.index,l.tileID);const re={bucket:p,layout:S,translationText:J,translationIcon:Y,unwrappedTileID:D,pitchedLabelPlaneMatrix:Q,scale:E,textPixelRatio:z,holdingForFade:l.holdingForFade(),collisionBoxArray:x,partiallyEvaluatedTextSize:c.af(p.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(p.sourceID)};if(u)for(const ne of p.sortKeyRanges){const{sortKey:ae,symbolInstanceStart:ce,symbolInstanceEnd:de}=ne;e.push({sortKey:ae,symbolInstanceStart:ce,symbolInstanceEnd:de,parameters:re})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:p.symbolInstances.length,parameters:re})}attemptAnchorPlacement(e,r,l,u,p,y,x,S,k,E,z,D,$,N,J,Y,Q,re,ne,ae){const ce=c.ax[e.textAnchor],de=[e.textOffset0,e.textOffset1],ue=Yi(ce,l,u,de,p),xe=this.collisionIndex.placeCollisionBox(r,D,S,k,E,x,y,Y,z.predicate,ne,ue,ae);if((!re||this.collisionIndex.placeCollisionBox(re,D,S,k,E,x,y,Q,z.predicate,ne,ue,ae).placeable)&&xe.placeable){let Ce;if(this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&(Ce=this.prevPlacement.variableOffsets[$.crossTileID].anchor),$.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[$.crossTileID]={textOffset:de,width:l,height:u,anchor:ce,textBoxScale:p,prevAnchor:Ce},this.markUsedJustification(N,ce,$,J),N.allowVerticalPlacement&&(this.markUsedOrientation(N,J,$),this.placedOrientations[$.crossTileID]=J),{shift:ue,placedGlyphBoxes:xe}}}placeLayerBucketPart(e,r,l){const{bucket:u,layout:p,translationText:y,translationIcon:x,unwrappedTileID:S,pitchedLabelPlaneMatrix:k,textPixelRatio:E,holdingForFade:z,collisionBoxArray:D,partiallyEvaluatedTextSize:$,collisionGroup:N}=e.parameters,J=p.get("text-optional"),Y=p.get("icon-optional"),Q=c.ay(p,"text-overlap","text-allow-overlap"),re=Q==="always",ne=c.ay(p,"icon-overlap","icon-allow-overlap"),ae=ne==="always",ce=p.get("text-rotation-alignment")==="map",de=p.get("text-pitch-alignment")==="map",ue=p.get("icon-text-fit")!=="none",xe=p.get("symbol-z-order")==="viewport-y",Ce=re&&(ae||!u.hasIconData()||Y),Ee=ae&&(re||!u.hasTextData()||J);!u.collisionArrays&&D&&u.deserializeCollisionBoxes(D);const Re=this.retainedQueryData[u.bucketInstanceId].tileID,Ie=this._getTerrainElevationFunc(Re),Ke=this.transform.getFastPathSimpleProjectionMatrix(Re),He=($e,ft,yt)=>{var Jt,cr;if(r[$e.crossTileID])return;if(z)return void(this.placements[$e.crossTileID]=new Ou(!1,!1,!1));let ir=!1,br=!1,pr=!0,er=null,nr={box:null,placeable:!1,offscreen:null,occluded:!1},io={placeable:!1},no=null,Hr=null,fo=null,nn=0,Ni=0,zi=0;ft.textFeatureIndex?nn=ft.textFeatureIndex:$e.useRuntimeCollisionCircles&&(nn=$e.featureIndex),ft.verticalTextFeatureIndex&&(Ni=ft.verticalTextFeatureIndex);const di=ft.textBox;if(di){const fi=ur=>{let ar=c.ag.horizontal;if(u.allowVerticalPlacement&&!ur&&this.prevPlacement){const Xr=this.prevPlacement.placedOrientations[$e.crossTileID];Xr&&(this.placedOrientations[$e.crossTileID]=Xr,ar=Xr,this.markUsedOrientation(u,ar,$e))}return ar},Ri=(ur,ar)=>{if(u.allowVerticalPlacement&&$e.numVerticalGlyphVertices>0&&ft.verticalTextBox){for(const Xr of u.writingModes)if(Xr===c.ag.vertical?(nr=ar(),io=nr):nr=ur(),nr&&nr.placeable)break}else nr=ur()},bi=$e.textAnchorOffsetStartIndex,Di=$e.textAnchorOffsetEndIndex;if(Di===bi){const ur=(ar,Xr)=>{const Kr=this.collisionIndex.placeCollisionBox(ar,Q,E,Re,S,de,ce,y,N.predicate,Ie,void 0,Ke);return Kr&&Kr.placeable&&(this.markUsedOrientation(u,Xr,$e),this.placedOrientations[$e.crossTileID]=Xr),Kr};Ri(()=>ur(di,c.ag.horizontal),()=>{const ar=ft.verticalTextBox;return u.allowVerticalPlacement&&$e.numVerticalGlyphVertices>0&&ar?ur(ar,c.ag.vertical):{box:null,offscreen:null}}),fi(nr&&nr.placeable)}else{let ur=c.ax[(cr=(Jt=this.prevPlacement)===null||Jt===void 0?void 0:Jt.variableOffsets[$e.crossTileID])===null||cr===void 0?void 0:cr.anchor];const ar=(Kr,zn,hf)=>{const Mh=Kr.x2-Kr.x1,Rc=Kr.y2-Kr.y1,Ih=$e.textBoxScale,Rn=ue&&ne==="never"?zn:null;let Wo=null,Dc=Q==="never"?1:2,Eh="never";ur&&Dc++;for(let al=0;al<Dc;al++){for(let ll=bi;ll<Di;ll++){const Ah=u.textAnchorOffsets.get(ll);if(ur&&Ah.textAnchor!==ur)continue;const cl=this.attemptAnchorPlacement(Ah,Kr,Mh,Rc,Ih,ce,de,E,Re,S,N,Eh,$e,u,hf,y,x,Rn,Ie);if(cl&&(Wo=cl.placedGlyphBoxes,Wo&&Wo.placeable))return ir=!0,er=cl.shift,Wo}ur?ur=null:Eh=Q}return l&&!Wo&&(Wo={box:this.collisionIndex.placeCollisionBox(di,"always",E,Re,S,de,ce,y,N.predicate,Ie,void 0,Ke).box,offscreen:!1,placeable:!1,occluded:!1}),Wo};Ri(()=>ar(di,ft.iconBox,c.ag.horizontal),()=>{const Kr=ft.verticalTextBox;return u.allowVerticalPlacement&&(!nr||!nr.placeable)&&$e.numVerticalGlyphVertices>0&&Kr?ar(Kr,ft.verticalIconBox,c.ag.vertical):{box:null,occluded:!0,offscreen:null}}),nr&&(ir=nr.placeable,pr=nr.offscreen);const Xr=fi(nr&&nr.placeable);if(!ir&&this.prevPlacement){const Kr=this.prevPlacement.variableOffsets[$e.crossTileID];Kr&&(this.variableOffsets[$e.crossTileID]=Kr,this.markUsedJustification(u,Kr.anchor,$e,Xr))}}}if(no=nr,ir=no&&no.placeable,pr=no&&no.offscreen,$e.useRuntimeCollisionCircles){const fi=u.text.placedSymbolArray.get($e.centerJustifiedTextSymbolIndex),Ri=c.ah(u.textSizeData,$,fi),bi=p.get("text-padding");Hr=this.collisionIndex.placeCollisionCircles(Q,fi,u.lineVertexArray,u.glyphOffsetArray,Ri,S,k,l,de,N.predicate,$e.collisionCircleDiameter,bi,y,Ie),Hr.circles.length&&Hr.collisionDetected&&!l&&c.w("Collisions detected, but collision boxes are not shown"),ir=re||Hr.circles.length>0&&!Hr.collisionDetected,pr=pr&&Hr.offscreen}if(ft.iconFeatureIndex&&(zi=ft.iconFeatureIndex),ft.iconBox){const fi=Ri=>this.collisionIndex.placeCollisionBox(Ri,ne,E,Re,S,de,ce,x,N.predicate,Ie,ue&&er?er:void 0,Ke);io&&io.placeable&&ft.verticalIconBox?(fo=fi(ft.verticalIconBox),br=fo.placeable):(fo=fi(ft.iconBox),br=fo.placeable),pr=pr&&fo.offscreen}const En=J||$e.numHorizontalGlyphVertices===0&&$e.numVerticalGlyphVertices===0,Ys=Y||$e.numIconVertices===0;En||Ys?Ys?En||(br=br&&ir):ir=br&&ir:br=ir=br&&ir;const An=br&&fo.placeable;if(ir&&no.placeable&&this.collisionIndex.insertCollisionBox(no.box,Q,p.get("text-ignore-placement"),u.bucketInstanceId,io&&io.placeable&&Ni?Ni:nn,N.ID),An&&this.collisionIndex.insertCollisionBox(fo.box,ne,p.get("icon-ignore-placement"),u.bucketInstanceId,zi,N.ID),Hr&&ir&&this.collisionIndex.insertCollisionCircles(Hr.circles,Q,p.get("text-ignore-placement"),u.bucketInstanceId,nn,N.ID),l&&this.storeCollisionData(u.bucketInstanceId,yt,ft,no,fo,Hr),$e.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(u.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[$e.crossTileID]=new Ou((ir||Ce)&&!(no!=null&&no.occluded),(br||Ee)&&!(fo!=null&&fo.occluded),pr||u.justReloaded),r[$e.crossTileID]=!0};if(xe){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const $e=u.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let ft=$e.length-1;ft>=0;--ft){const yt=$e[ft];He(u.symbolInstances.get(yt),u.collisionArrays[yt],yt)}}else for(let $e=e.symbolInstanceStart;$e<e.symbolInstanceEnd;$e++)He(u.symbolInstances.get($e),u.collisionArrays[$e],$e);u.justReloaded=!1}storeCollisionData(e,r,l,u,p,y){if(l.textBox||l.iconBox){let x,S;this.collisionBoxArrays.has(e)?x=this.collisionBoxArrays.get(e):(x=new Map,this.collisionBoxArrays.set(e,x)),x.has(r)?S=x.get(r):(S={text:null,icon:null},x.set(r,S)),l.textBox&&(S.text=u.box),l.iconBox&&(S.icon=p.box)}if(y){let x=this.collisionCircleArrays[e];x===void 0&&(x=this.collisionCircleArrays[e]=[]);for(let S=0;S<y.circles.length;S+=4)x.push(y.circles[S+0]-fr),x.push(y.circles[S+1]-fr),x.push(y.circles[S+2]),x.push(y.collisionDetected?1:0)}}markUsedJustification(e,r,l,u){let p;p=u===c.ag.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[c.az(r)];const y=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const x of y)x>=0&&(e.text.placedSymbolArray.get(x).crossTileID=p>=0&&x!==p?0:l.crossTileID)}markUsedOrientation(e,r,l){const u=r===c.ag.horizontal||r===c.ag.horizontalOnly?r:0,p=r===c.ag.vertical?r:0,y=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const x of y)e.text.placedSymbolArray.get(x).placedOrientation=u;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=p)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let l=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const u=r?r.symbolFadeChange(e):1,p=r?r.opacities:{},y=r?r.variableOffsets:{},x=r?r.placedOrientations:{};for(const S in this.placements){const k=this.placements[S],E=p[S];E?(this.opacities[S]=new sr(E,u,k.text,k.icon),l=l||k.text!==E.text.placed||k.icon!==E.icon.placed):(this.opacities[S]=new sr(null,u,k.text,k.icon,k.skipFade),l=l||k.text||k.icon)}for(const S in p){const k=p[S];if(!this.opacities[S]){const E=new sr(k,u,!1,!1);E.isHidden()||(this.opacities[S]=E,l=l||k.text.placed||k.icon.placed)}}for(const S in y)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=y[S]);for(const S in x)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=x[S]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:e)}updateLayerOpacities(e,r){const l={};for(const u of r){const p=u.getBucket(e);p&&u.latestFeatureIndex&&e.id===p.layerIds[0]&&this.updateBucketOpacities(p,u.tileID,l,u.collisionBoxArray)}}updateBucketOpacities(e,r,l,u){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const p=e.layers[0],y=p.layout,x=new sr(null,0,!1,!1,!0),S=y.get("text-allow-overlap"),k=y.get("icon-allow-overlap"),E=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),z=y.get("text-rotation-alignment")==="map",D=y.get("text-pitch-alignment")==="map",$=y.get("icon-text-fit")!=="none",N=new sr(null,0,S&&(k||!e.hasIconData()||y.get("icon-optional")),k&&(S||!e.hasTextData()||y.get("text-optional")),!0);!e.collisionArrays&&u&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(u);const J=(Q,re,ne)=>{for(let ae=0;ae<re/4;ae++)Q.opacityVertexArray.emplaceBack(ne);Q.hasVisibleVertices=Q.hasVisibleVertices||ne!==Wn},Y=this.collisionBoxArrays.get(e.bucketInstanceId);for(let Q=0;Q<e.symbolInstances.length;Q++){const re=e.symbolInstances.get(Q),{numHorizontalGlyphVertices:ne,numVerticalGlyphVertices:ae,crossTileID:ce}=re;let de=this.opacities[ce];l[ce]?de=x:de||(de=N,this.opacities[ce]=de),l[ce]=!0;const ue=re.numIconVertices>0,xe=this.placedOrientations[re.crossTileID],Ce=xe===c.ag.vertical,Ee=xe===c.ag.horizontal||xe===c.ag.horizontalOnly;if(ne>0||ae>0){const Ie=Bl(de.text);J(e.text,ne,Ce?Wn:Ie),J(e.text,ae,Ee?Wn:Ie);const Ke=de.text.isHidden();[re.rightJustifiedTextSymbolIndex,re.centerJustifiedTextSymbolIndex,re.leftJustifiedTextSymbolIndex].forEach(ft=>{ft>=0&&(e.text.placedSymbolArray.get(ft).hidden=Ke||Ce?1:0)}),re.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(re.verticalPlacedTextSymbolIndex).hidden=Ke||Ee?1:0);const He=this.variableOffsets[re.crossTileID];He&&this.markUsedJustification(e,He.anchor,re,xe);const $e=this.placedOrientations[re.crossTileID];$e&&(this.markUsedJustification(e,"left",re,$e),this.markUsedOrientation(e,$e,re))}if(ue){const Ie=Bl(de.icon),Ke=!($&&re.verticalPlacedIconSymbolIndex&&Ce);re.placedIconSymbolIndex>=0&&(J(e.icon,re.numIconVertices,Ke?Ie:Wn),e.icon.placedSymbolArray.get(re.placedIconSymbolIndex).hidden=de.icon.isHidden()),re.verticalPlacedIconSymbolIndex>=0&&(J(e.icon,re.numVerticalIconVertices,Ke?Wn:Ie),e.icon.placedSymbolArray.get(re.verticalPlacedIconSymbolIndex).hidden=de.icon.isHidden())}const Re=Y&&Y.has(Q)?Y.get(Q):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ie=e.collisionArrays[Q];if(Ie){let Ke=new c.P(0,0);if(Ie.textBox||Ie.verticalTextBox){let He=!0;if(E){const $e=this.variableOffsets[ce];$e?(Ke=Yi($e.anchor,$e.width,$e.height,$e.textOffset,$e.textBoxScale),z&&Ke._rotate(D?-this.transform.bearingInRadians:this.transform.bearingInRadians)):He=!1}if(Ie.textBox||Ie.verticalTextBox){let $e;Ie.textBox&&($e=Ce),Ie.verticalTextBox&&($e=Ee),Dl(e.textCollisionBox.collisionVertexArray,de.text.placed,!He||$e,Re.text,Ke.x,Ke.y)}}if(Ie.iconBox||Ie.verticalIconBox){const He=!!(!Ee&&Ie.verticalIconBox);let $e;Ie.iconBox&&($e=He),Ie.verticalIconBox&&($e=!He),Dl(e.iconCollisionBox.collisionVertexArray,de.icon.placed,$e,Re.icon,$?Ke.x:0,$?Ke.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,r){const l=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function Dl(f,e,r,l,u,p){l&&l.length!==0||(l=[0,0,0,0]);const y=l[0]-fr,x=l[1]-fr,S=l[2]-fr,k=l[3]-fr;f.emplaceBack(e?1:0,r?1:0,u||0,p||0,y,x),f.emplaceBack(e?1:0,r?1:0,u||0,p||0,S,x),f.emplaceBack(e?1:0,r?1:0,u||0,p||0,S,k),f.emplaceBack(e?1:0,r?1:0,u||0,p||0,y,k)}const $u=Math.pow(2,25),ju=Math.pow(2,24),qn=Math.pow(2,17),Nu=Math.pow(2,16),jd=Math.pow(2,9),Nd=Math.pow(2,8),Vd=Math.pow(2,1);function Bl(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const e=f.placed?1:0,r=Math.floor(127*f.opacity);return r*$u+e*ju+r*qn+e*Nu+r*jd+e*Nd+r*Vd+e}const Wn=0;class Ll{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,r,l,u,p){const y=this._bucketParts;for(;this._currentTileIndex<e.length;)if(r.getBucketParts(y,u,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,p())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,y.sort((x,S)=>x.sortKey-S.sortKey));this._currentPartIndex<y.length;)if(r.placeLayerBucketPart(y[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,p())return!0;return!1}}class Fl{constructor(e,r,l,u,p,y,x,S){this.placement=new Gn(e,r,y,x,S),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=u,this._showCollisionBoxes=p,this._done=!1}isDone(){return this._done}continuePlacement(e,r,l){const u=K.now(),p=()=>!this._forceFullPlacement&&K.now()-u>2;for(;this._currentPlacementIndex>=0;){const y=r[e[this._currentPlacementIndex]],x=this.placement.collisionIndex.transform.zoom;if(y.type==="symbol"&&(!y.minzoom||y.minzoom<=x)&&(!y.maxzoom||y.maxzoom>x)){if(this._inProgressLayer||(this._inProgressLayer=new Ll(y)),this._inProgressLayer.continuePlacement(l[y.source],this.placement,this._showCollisionBoxes,y,p))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Hn=512/c.Z/2;class Ol{constructor(e,r,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const u=new Map;for(let p=0;p<r.length;p++){const y=r.get(p),x=y.key,S=u.get(x);S?S.push(y):u.set(x,[y])}for(const[p,y]of u){const x={positions:y.map(S=>({x:Math.floor(S.anchorX*Hn),y:Math.floor(S.anchorY*Hn)})),crossTileIDs:y.map(S=>S.crossTileID)};if(x.positions.length>128){const S=new c.aB(x.positions.length,16,Uint16Array);for(const{x:k,y:E}of x.positions)S.add(k,E);S.finish(),delete x.positions,x.index=S}this._symbolsByKey[p]=x}}getScaledCoordinates(e,r){const{x:l,y:u,z:p}=this.tileID.canonical,{x:y,y:x,z:S}=r.canonical,k=Hn/Math.pow(2,S-p),E=(x*c.Z+e.anchorY)*k,z=u*c.Z*Hn;return{x:Math.floor((y*c.Z+e.anchorX)*k-l*c.Z*Hn),y:Math.floor(E-z)}}findMatches(e,r,l){const u=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let p=0;p<e.length;p++){const y=e.get(p);if(y.crossTileID)continue;const x=this._symbolsByKey[y.key];if(!x)continue;const S=this.getScaledCoordinates(y,r);if(x.index){const k=x.index.range(S.x-u,S.y-u,S.x+u,S.y+u).sort();for(const E of k){const z=x.crossTileIDs[E];if(!l[z]){l[z]=!0,y.crossTileID=z;break}}}else if(x.positions)for(let k=0;k<x.positions.length;k++){const E=x.positions[k],z=x.crossTileIDs[k];if(Math.abs(E.x-S.x)<=u&&Math.abs(E.y-S.y)<=u&&!l[z]){l[z]=!0,y.crossTileID=z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class $l{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ya{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const r=Math.round((e-this.lng)/360);if(r!==0)for(const l in this.indexes){const u=this.indexes[l],p={};for(const y in u){const x=u[y];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+r),p[x.tileID.key]=x}this.indexes[l]=p}this.lng=e}addBucket(e,r,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let p=0;p<r.symbolInstances.length;p++)r.symbolInstances.get(p).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const u=this.usedCrossTileIDs[e.overscaledZ];for(const p in this.indexes){const y=this.indexes[p];if(Number(p)>e.overscaledZ)for(const x in y){const S=y[x];S.tileID.isChildOf(e)&&S.findMatches(r.symbolInstances,e,u)}else{const x=y[e.scaledTo(Number(p)).key];x&&x.findMatches(r.symbolInstances,e,u)}}for(let p=0;p<r.symbolInstances.length;p++){const y=r.symbolInstances.get(p);y.crossTileID||(y.crossTileID=l.generate(),u[y.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Ol(e,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(e,r){for(const l of r.getCrossTileIDsLists())for(const u of l)delete this.usedCrossTileIDs[e][u]}removeStaleBuckets(e){let r=!1;for(const l in this.indexes){const u=this.indexes[l];for(const p in u)e[u[p].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,u[p]),delete u[p],r=!0)}return r}}class jl{constructor(){this.layerIndexes={},this.crossTileIDs=new $l,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,r,l){let u=this.layerIndexes[e.id];u===void 0&&(u=this.layerIndexes[e.id]=new ya);let p=!1;const y={};u.handleWrapJump(l);for(const x of r){const S=x.getBucket(e);S&&e.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(x.tileID,S,this.crossTileIDs)&&(p=!0),y[S.bucketInstanceId]=!0)}return u.removeStaleBuckets(y)&&(p=!0),p}pruneUnusedLayers(e){const r={};e.forEach(l=>{r[l]=!0});for(const l in this.layerIndexes)r[l]||delete this.layerIndexes[l]}}var mn="void main() {fragColor=vec4(1.0);}";const _i={prelude:Ht(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Ht("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Ht("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Ht(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Ht(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ht(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ht(mn,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Ht(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Ht(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ht("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ht("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ht("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Ht(mn,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Ht(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Ht(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Ht(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ht(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ht(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ht(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Ht(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ht(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ht(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ht(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Ht(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ht(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ht(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ht("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ht("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ht("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Ht("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Ht(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Ht("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ht(f,e){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),u=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),p=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=p?p.concat(u):u,x={};return{fragmentSource:f=f.replace(r,(S,k,E,z,D)=>(x[D]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${D}
in ${E} ${z} ${D};
#else
uniform ${E} ${z} u_${D};
#endif
`:`
#ifdef HAS_UNIFORM_u_${D}
    ${E} ${z} ${D} = u_${D};
#endif
`)),vertexSource:e=e.replace(r,(S,k,E,z,D)=>{const $=z==="float"?"vec2":"vec4",N=D.match(/color/)?"color":$;return x[D]?k==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
in ${E} ${$} a_${D};
out ${E} ${z} ${D};
#else
uniform ${E} ${z} u_${D};
#endif
`:N==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = a_${D};
#else
    ${E} ${z} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = unpack_mix_${N}(a_${D}, u_${D}_t);
#else
    ${E} ${z} ${D} = u_${D};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
in ${E} ${$} a_${D};
#else
uniform ${E} ${z} u_${D};
#endif
`:N==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${E} ${z} ${D} = a_${D};
#else
    ${E} ${z} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${E} ${z} ${D} = unpack_mix_${N}(a_${D}, u_${D}_t);
#else
    ${E} ${z} ${D} = u_${D};
#endif
`}),staticAttributes:l,staticUniforms:y}}class Zo{constructor(e,r,l){this.vertexBuffer=e,this.indexBuffer=r,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ii=c.aC([{name:"a_pos",type:"Int16",components:2}]);const Xt="#define PROJECTION_MERCATOR",va="mercator";class Nl{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return va}get shaderDefine(){return Xt}get shaderPreludeCode(){return _i.projectionMercator}get vertexShaderPreludeCode(){return _i.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aD.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,r,l,u,p){if(this._cachedMesh)return this._cachedMesh;const y=new c.aE;y.emplaceBack(0,0),y.emplaceBack(c.Z,0),y.emplaceBack(0,c.Z),y.emplaceBack(c.Z,c.Z);const x=e.createVertexBuffer(y,ii.members),S=c.aF.simpleSegment(0,0,4,2),k=new c.aG;k.emplaceBack(1,0,2),k.emplaceBack(1,2,3);const E=e.createIndexBuffer(k);return this._cachedMesh=new Zo(x,E,S),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function ni(f,e){const r=c.ad(e.lat,-85.051129,c.aI);return new c.P(c.U(e.lng)*f,c.S(r)*f)}function ho(f,e){return new c.$(e.x/f,e.y/f).toLngLat()}function ro(f){return f.cameraToCenterDistance*Math.min(.85*Math.tan(c.ac(90-f.pitch)),Math.tan(c.ac(89.25-f.pitch)))}function Tr(f,e){const r=f.canonical,l=e/c.aH(r.z),u=r.x+Math.pow(2,r.z)*f.wrap,p=c.as(new Float64Array(16));return c.L(p,p,[u*l,r.y*l,0]),c.M(p,p,[l/c.Z,l/c.Z,1]),p}function Vl(f,e,r,l,u){const p=c.$.fromLngLat(f,e),y=u*c.aJ(1,f.lat),x=y*Math.cos(c.ac(r)),S=Math.sqrt(y*y-x*x),k=S*Math.sin(c.ac(-l)),E=S*Math.cos(c.ac(-l));return new c.$(p.x+k,p.y+E,p.z+x)}class oo{constructor(e=0,r=0,l=0,u=0){if(isNaN(e)||e<0||isNaN(r)||r<0||isNaN(l)||l<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=l,this.right=u}interpolate(e,r,l){return r.top!=null&&e.top!=null&&(this.top=c.B.number(e.top,r.top,l)),r.bottom!=null&&e.bottom!=null&&(this.bottom=c.B.number(e.bottom,r.bottom,l)),r.left!=null&&e.left!=null&&(this.left=c.B.number(e.left,r.left,l)),r.right!=null&&e.right!=null&&(this.right=c.B.number(e.right,r.right,l)),this}getCenter(e,r){const l=c.ad((this.left+e-this.right)/2,0,e),u=c.ad((this.top+r-this.bottom)/2,0,r);return new c.P(l,u)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new oo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ko(f,e){if(!f.renderWorldCopies||f.lngRange)return;const r=e.lng-f.center.lng;e.lng+=r>180?-360:r<-180?360:0}function Ro(f){return Math.max(0,Math.floor(f))}class ba{constructor(e,r,l,u,p,y){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=y===void 0||!!y,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=u??0,this._maxPitch=p??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ro(this._zoom),this._scale=c.aH(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new oo,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,r,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Ro(this._zoom),this._scale=c.aH(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new oo(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,r&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const r=c.aK(e,-180,180)*Math.PI/180;var l,u,p,y,x,S,k,E,z;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=Z(),l=this._rotationMatrix,p=-this._bearingInRadians,y=(u=this._rotationMatrix)[0],x=u[1],S=u[2],k=u[3],E=Math.sin(p),z=Math.cos(p),l[0]=y*z+S*E,l[1]=x*z+k*E,l[2]=y*-E+S*z,l[3]=x*-E+k*z)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const r=c.ad(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const r=e/180*Math.PI;this._rollInRadians!==r&&(this._unmodified=!1,this._rollInRadians=r,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aL(this._fovInRadians)}setFov(e){e=c.ad(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.ac(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const r=this.getConstrained(this._center,e).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=c.aH(r),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,r){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=r,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,r,l){this._unmodified=!1,this._edgeInsets.interpolate(e,r,l),this._constrain(),this._calcMatrices()}resize(e,r,l=!0){this._width=e,this._height=r,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new ke([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,c.aI])}getConstrained(e,r){return this._callbacks.getConstrained(e,r)}getCameraQueryGeometry(e,r){if(r.length===1)return[r[0],e];{let l=e.x,u=e.y,p=e.x,y=e.y;for(const x of r)l=Math.min(l,x.x),u=Math.min(u,x.y),p=Math.max(p,x.x),y=Math.max(y,x.y);return[new c.P(l,u),new c.P(p,u),new c.P(p,y),new c.P(l,y),new c.P(l,u)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:r,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(r),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.as(new Float64Array(16));c.M(e,e,[this._width/2,-this._height/2,1]),c.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.as(new Float64Array(16)),c.M(e,e,[1,-1,1]),c.L(e,e,[-1,-1,0]),c.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,r,l,u){const p=l!==void 0?l:this.bearing,y=u=u!==void 0?u:this.pitch,x=c.$.fromLngLat(e,r),S=-Math.cos(c.ac(y)),k=Math.sin(c.ac(y)),E=k*Math.sin(c.ac(p)),z=-k*Math.cos(c.ac(p));let D=this.elevation;const $=r-D;let N;S*$>=0||Math.abs(S)<.1?(N=1e4,D=r+N*S):N=-$/S;let J,Y,Q=c.aM(1,x.y),re=0;do{if(re+=1,re>10)break;Y=N/Q,J=new c.$(x.x+E*Y,x.y+z*Y),Q=1/J.meterInMercatorCoordinateUnits()}while(Math.abs(N-Y*Q)>1e-12);return{center:J.toLngLat(),elevation:D,zoom:c.aa(this.height/2/Math.tan(this.fovInRadians/2)/Y/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const r=c.aJ(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/r,u=c.$.fromLngLat(this.center,this.elevation),p=Vl(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const y=this.calculateCenterFromCameraLngLatAlt(p.toLngLat(),c.aM(p.z,u.y),this.bearing,this.pitch);this._elevation=y.elevation,this._center=y.center,this.setZoom(y.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.aJ(1,this.center.lat)*this.worldSize;return Vl(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const r=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/r,e.canonical.y/r,1/r/c.Z,1/r/c.Z]}}class yi{constructor(e,r){this.min=e,this.max=r,this.center=c.aN([],c.aO([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],l=c.aP(this.min),u=c.aP(this.max);for(let p=0;p<r.length;p++)l[p]=r[p]?this.min[p]:this.center[p],u[p]=r[p]?this.center[p]:this.max[p];return u[2]=this.max[2],new yi(l,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let r=!0;for(let l=0;l<e.planes.length;l++){const u=this.intersectsPlane(e.planes[l]);if(u===0)return 0;u===1&&(r=!1)}return r?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let r=e[3],l=e[3];for(let u=0;u<3;u++)e[u]>0?(r+=e[u]*this.min[u],l+=e[u]*this.max[u]):(l+=e[u]*this.min[u],r+=e[u]*this.max[u]);return r>=0?2:l<0?0:1}}class Vr{distanceToTile2d(e,r,l,u){const p=u.distanceX([e,r]),y=u.distanceY([e,r]);return Math.hypot(p,y)}getWrap(e,r,l){return l}getTileAABB(e,r,l,u){var p,y;let x=l,S=l;if(u.terrain){const E=new c.Y(e.z,r,e.z,e.x,e.y),z=u.terrain.getMinMaxElevation(E);x=(p=z.minElevation)!==null&&p!==void 0?p:l,S=(y=z.maxElevation)!==null&&y!==void 0?y:l}const k=1<<e.z;return new yi([r+e.x/k,e.y/k,x],[r+(e.x+1)/k,(e.y+1)/k,S])}allowVariableZoom(e,r){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,u=c.ad(78.5-l/2,0,60);return!!r.terrain||e.pitch>u}allowWorldCopies(){return!0}recalculateCache(){}}class Ji{constructor(e,r,l){this.points=e,this.planes=r,this.aabb=l}static fromInvProjectionMatrix(e,r=1,l=0){const u=Math.pow(2,l),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const E=1/(k=c.ao([],k,e))[3]/r*u;return c.aQ(k,k,[E,E,1/k[3],E])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const E=c.aR([],p[k[0]],p[k[1]]),z=c.aR([],p[k[2]],p[k[1]]),D=c.aS([],c.aT([],E,z)),$=-c.aU(D,p[k[1]]);return D.concat($)}),x=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],S=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const k of p)for(let E=0;E<3;E++)x[E]=Math.min(x[E],k[E]),S[E]=Math.max(S[E],k[E]);return new Ji(p,y,new yi(x,S))}}class si{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,l=!0){this._helper.resize(e,r,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,r){}constructor(e,r,l,u,p){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new ba({calcMatrices:()=>{this._calcMatrices()},getConstrained:(y,x)=>this.getConstrained(y,x)},e,r,l,u,p),this._coveringTilesDetailsProvider=new Vr}clone(){const e=new si;return e.apply(this),e}apply(e,r,l){this._helper.apply(e,r,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const r=[new c.aV(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new c.P(0,0)),u=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),p=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),y=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),x=Math.floor(Math.min(l.x,u.x,p.x,y.x)),S=Math.floor(Math.max(l.x,u.x,p.x,y.x)),k=1;for(let E=x-k;E<=S+k;E++)E!==0&&r.push(new c.aV(E,e))}return r}getCameraFrustum(){return Ji.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const r=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(r,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,r){const l=c.aJ(this.elevation,this.center.lat),u=this.screenPointToMercatorCoordinateAtZ(r,l),p=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),y=c.$.fromLngLat(e),x=new c.$(y.x-(u.x-p.x),y.y-(u.y-p.y));this.setCenter(x==null?void 0:x.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,r){return r?this.coordinatePoint(c.$.fromLngLat(e),r.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.$.fromLngLat(e))}screenPointToLocation(e,r){var l;return(l=this.screenPointToMercatorCoordinate(e,r))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,r){if(r){const l=r.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,r){const l=r||0,u=[e.x,e.y,0,1],p=[e.x,e.y,1,1];c.ao(u,u,this._pixelMatrixInverse),c.ao(p,p,this._pixelMatrixInverse);const y=u[3],x=p[3],S=u[1]/y,k=p[1]/x,E=u[2]/y,z=p[2]/x,D=E===z?0:(l-E)/(z-E);return new c.$(c.B.number(u[0]/y,p[0]/x,D)/this.worldSize,c.B.number(S,k,D)/this.worldSize,l)}coordinatePoint(e,r=0,l=this._pixelMatrix){const u=[e.x*this.worldSize,e.y*this.worldSize,r,1];return c.ao(u,u,l),new c.P(u[0]/u[3],u[1]/u[3])}getBounds(){const e=Math.max(0,this._helper._height/2-ro(this));return new ke().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,r){return r?r.pointCoordinate(e)!=null:e.y>this.height/2-ro(this)}calculatePosMatrix(e,r=!1,l){var u;const p=(u=e.key)!==null&&u!==void 0?u:c.aW(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),y=r?this._alignedPosMatrixCache:this._posMatrixCache;if(y.has(p)){const k=y.get(p);return l?k.f32:k.f64}const x=Tr(e,this.worldSize);c.N(x,r?this._alignedProjMatrix:this._viewProjMatrix,x);const S={f64:x,f32:new Float32Array(x)};return y.set(p,S),l?S.f32:S.f64}calculateFogMatrix(e){const r=e.key,l=this._fogMatrixCacheF32;if(l.has(r))return l.get(r);const u=Tr(e,this.worldSize);return c.N(u,this._fogMatrix,u),l.set(r,new Float32Array(u)),l.get(r)}getConstrained(e,r){r=c.ad(+r,this.minZoom,this.maxZoom);const l={center:new c.Q(e.lng,e.lat),zoom:r};let u=this._helper._lngRange;this._helper._renderWorldCopies||u!==null||(u=[-179.9999999999,180-1e-10]);const p=this.tileSize*c.aH(l.zoom);let y=0,x=p,S=0,k=p,E=0,z=0;const{x:D,y:$}=this.size;if(this._helper._latRange){const ne=this._helper._latRange;y=c.S(ne[1])*p,x=c.S(ne[0])*p,x-y<$&&(E=$/(x-y))}u&&(S=c.aK(c.U(u[0])*p,0,p),k=c.aK(c.U(u[1])*p,0,p),k<S&&(k+=p),k-S<D&&(z=D/(k-S)));const{x:N,y:J}=ni(p,e);let Y,Q;const re=Math.max(z||0,E||0);if(re){const ne=new c.P(z?(k+S)/2:N,E?(x+y)/2:J);return l.center=ho(p,ne).wrap(),l.zoom+=c.aa(re),l}if(this._helper._latRange){const ne=$/2;J-ne<y&&(Q=y+ne),J+ne>x&&(Q=x-ne)}if(u){const ne=(S+k)/2;let ae=N;this._helper._renderWorldCopies&&(ae=c.aK(N,ne-p/2,ne+p/2));const ce=D/2;ae-ce<S&&(Y=S+ce),ae+ce>k&&(Y=k-ce)}if(Y!==void 0||Q!==void 0){const ne=new c.P(Y??N,Q??J);l.center=ho(p,ne).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,r,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,u)}_calculateNearFarZIfNeeded(e,r,l){if(!this._helper.autoCalculateNearFarZ)return;const u=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),p=e-u*this._helper._pixelPerMeter/Math.cos(r),y=u<0?p:e,x=Math.PI/2+this.pitchInRadians,S=c.ac(this.fov)*(Math.abs(Math.cos(c.ac(this.roll)))*this.height+Math.abs(Math.sin(c.ac(this.roll)))*this.width)/this.height*(.5+l.y/this.height),k=Math.sin(S)*y/Math.sin(c.ad(Math.PI-x-S,.01,Math.PI-.01)),E=ro(this),z=Math.atan(E/this._helper.cameraToCenterDistance),D=c.ac(.75),$=z>D?2*z*(.5+l.y/(2*E)):D,N=Math.sin($)*y/Math.sin(c.ad(Math.PI-x-$,.01,Math.PI-.01)),J=Math.min(k,N);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*J+y),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,r=ni(this.worldSize,this.center),l=r.x,u=r.y;this._helper._pixelPerMeter=c.aJ(1,this.center.lat)*this.worldSize;const p=c.ac(Math.min(this.pitch,89.25)),y=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(p));let x;this._calculateNearFarZIfNeeded(y,p,e),x=new Float64Array(16),c.aX(x,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.ai(this._invProjMatrix,x),x[8]=2*-e.x/this._helper._width,x[9]=2*e.y/this._helper._height,this._projectionMatrix=c.aY(x),c.M(x,x,[1,-1,1]),c.L(x,x,[0,0,-this._helper.cameraToCenterDistance]),c.aZ(x,x,-this.rollInRadians),c.a_(x,x,this.pitchInRadians),c.aZ(x,x,-this.bearingInRadians),c.L(x,x,[-l,-u,0]),this._mercatorMatrix=c.M([],x,[this.worldSize,this.worldSize,this.worldSize]),c.M(x,x,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,x),c.L(x,x,[0,0,-this.elevation]),this._viewProjMatrix=x,this._invViewProjMatrix=c.ai([],x);const S=[0,0,-1,1];c.ao(S,S,this._invViewProjMatrix),this._cameraPosition=[S[0]/S[3],S[1]/S[3],S[2]/S[3]],this._fogMatrix=new Float64Array(16),c.aX(this._fogMatrix,this.fovInRadians,this.width/this.height,y,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.aZ(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.a_(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.aZ(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.L(this._fogMatrix,this._fogMatrix,[-l,-u,0]),c.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,x);const k=this._helper._width%2/2,E=this._helper._height%2/2,z=Math.cos(this.bearingInRadians),D=Math.sin(-this.bearingInRadians),$=l-Math.round(l)+z*k+D*E,N=u-Math.round(u)+z*E+D*k,J=new Float64Array(x);if(c.L(J,J,[$>.5?$-1:$,N>.5?N-1:N,0]),this._alignedProjMatrix=J,x=c.ai(new Float64Array(16),this._pixelMatrix),!x)throw new Error("failed to invert matrix");this._pixelMatrixInverse=x,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.ao(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.aJ(1,this.center.lat)*this.worldSize;return Vl(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,r){const l=c.$.fromLngLat(e),u=[l.x*this.worldSize,l.y*this.worldSize,r,1];return c.ao(u,u,this._viewProjMatrix),u[2]/u[3]}getProjectionData(e){const{overscaledTileID:r,aligned:l,applyTerrainMatrix:u}=e,p=this._helper.getMercatorTileCoordinates(r),y=r?this.calculatePosMatrix(r,l,!0):null;let x;return x=r&&r.terrainRttPosMatrix32f&&u?r.terrainRttPosMatrix32f:y||c.a$(),{mainMatrix:x,tileMercatorCoords:p,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:x}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,r,l){return 1}transformLightDirection(e){return c.aP(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,r,l,u){const p=this.calculatePosMatrix(l);let y;u?(y=[e,r,u(e,r),1],c.ao(y,y,p)):(y=[e,r,0,1],Wr(y,y,p));const x=y[3];return{point:new c.P(y[0]/x,y[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}populateCache(e){for(const r of e)this.calculatePosMatrix(r)}getMatrixForModel(e,r){const l=c.$.fromLngLat(e,r),u=l.meterInMercatorCoordinateUnits(),p=c.b0();return c.L(p,p,[l.x,l.y,l.z]),c.aZ(p,p,Math.PI),c.a_(p,p,Math.PI/2),c.M(p,p,[-u,u,u]),p}getProjectionDataForCustomLayer(e=!0){const r=new c.Y(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:e}),u=Tr(r,this.worldSize);c.N(u,this._viewProjMatrix,u),l.tileMercatorCoords=[0,0,1,1];const p=[c.Z,c.Z,this.worldSize/this._helper.pixelsPerMeter],y=c.b1();return c.M(y,u,p),l.fallbackMatrix=y,l.mainMatrix=y,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function zs(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function ai(f){if(f.useSlerp)if(f.k<1){const e=c.b2(f.startEulerAngles.roll,f.startEulerAngles.pitch,f.startEulerAngles.bearing),r=c.b2(f.endEulerAngles.roll,f.endEulerAngles.pitch,f.endEulerAngles.bearing),l=new Float64Array(4);c.b3(l,e,r,f.k);const u=c.b4(l);f.tr.setRoll(u.roll),f.tr.setPitch(u.pitch),f.tr.setBearing(u.bearing)}else f.tr.setRoll(f.endEulerAngles.roll),f.tr.setPitch(f.endEulerAngles.pitch),f.tr.setBearing(f.endEulerAngles.bearing);else f.tr.setRoll(c.B.number(f.startEulerAngles.roll,f.endEulerAngles.roll,f.k)),f.tr.setPitch(c.B.number(f.startEulerAngles.pitch,f.endEulerAngles.pitch,f.k)),f.tr.setBearing(c.B.number(f.startEulerAngles.bearing,f.endEulerAngles.bearing,f.k))}function Ul(f,e,r,l,u){const p=u.padding,y=ni(u.worldSize,r.getNorthWest()),x=ni(u.worldSize,r.getNorthEast()),S=ni(u.worldSize,r.getSouthEast()),k=ni(u.worldSize,r.getSouthWest()),E=c.ac(-l),z=y.rotate(E),D=x.rotate(E),$=S.rotate(E),N=k.rotate(E),J=new c.P(Math.max(z.x,D.x,N.x,$.x),Math.max(z.y,D.y,N.y,$.y)),Y=new c.P(Math.min(z.x,D.x,N.x,$.x),Math.min(z.y,D.y,N.y,$.y)),Q=J.sub(Y),re=(u.width-(p.left+p.right+e.left+e.right))/Q.x,ne=(u.height-(p.top+p.bottom+e.top+e.bottom))/Q.y;if(ne<0||re<0)return void zs();const ae=Math.min(c.aa(u.scale*Math.min(re,ne)),f.maxZoom),ce=c.P.convert(f.offset),de=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.ac(l)),ue=ce.add(de).mult(u.scale/c.aH(ae));return{center:ho(u.worldSize,y.add(S).div(2).sub(ue)),zoom:ae,bearing:l}}class vi{get useGlobeControls(){return!1}handlePanInertia(e,r){return{easingOffset:e,easingCenter:r.center}}handleMapControlsRollPitchBearingZoom(e,r){e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta),e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta)}handleMapControlsPan(e,r,l){e.around.distSqr(r.centerPoint)<.01||r.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,r,l,u,p){return Ul(e,r,l,u,p)}handleJumpToCenterZoom(e,r){e.zoom!==(r.zoom!==void 0?+r.zoom:e.zoom)&&e.setZoom(+r.zoom),r.center!==void 0&&e.setCenter(c.Q.convert(r.center))}handleEaseTo(e,r){const l=e.zoom,u=e.padding,p={roll:e.roll,pitch:e.pitch,bearing:e.bearing},y={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},x=r.zoom!==void 0,S=!e.isPaddingEqual(r.padding);let k=!1;const E=x?+r.zoom:e.zoom;let z=e.centerPoint.add(r.offsetAsPoint);const D=e.screenPointToLocation(z),{center:$,zoom:N}=e.getConstrained(c.Q.convert(r.center||D),E??l);ko(e,$);const J=ni(e.worldSize,D),Y=ni(e.worldSize,$).sub(J),Q=c.aH(N-l);return k=N!==l,{easeFunc:re=>{if(k&&e.setZoom(c.B.number(l,N,re)),c.b5(p,y)||ai({startEulerAngles:p,endEulerAngles:y,tr:e,k:re,useSlerp:p.roll!=y.roll}),S&&(e.interpolatePadding(u,r.padding,re),z=e.centerPoint.add(r.offsetAsPoint)),r.around)e.setLocationAtPoint(r.around,r.aroundPoint);else{const ne=c.aH(e.zoom-l),ae=N>l?Math.min(2,Q):Math.max(.5,Q),ce=Math.pow(ae,1-re),de=ho(e.worldSize,J.add(Y.mult(re*ce)).mult(ne));e.setLocationAtPoint(e.renderWorldCopies?de.wrap():de,z)}},isZooming:k,elevationCenter:$}}handleFlyTo(e,r){const l=r.zoom!==void 0,u=e.zoom,p=e.getConstrained(c.Q.convert(r.center||r.locationAtOffset),l?+r.zoom:u),y=p.center,x=p.zoom;ko(e,y);const S=ni(e.worldSize,r.locationAtOffset),k=ni(e.worldSize,y).sub(S),E=k.mag(),z=c.aH(x-u);let D;if(r.minZoom!==void 0){const $=Math.min(+r.minZoom,u,x),N=e.getConstrained(y,$).zoom;D=c.aH(N-u)}return{easeFunc:($,N,J,Y)=>{e.setZoom($===1?x:u+c.aa(N));const Q=$===1?y:ho(e.worldSize,S.add(k.mult(J)).mult(N));e.setLocationAtPoint(e.renderWorldCopies?Q.wrap():Q,Y)},scaleOfZoom:z,targetCenter:y,scaleOfMinZoom:D,pixelPathLength:E}}}class yr{constructor(e,r,l){this.blendFunction=e,this.blendColor=r,this.mask=l}}yr.Replace=[1,0],yr.disabled=new yr(yr.Replace,c.b6.transparent,[!1,!1,!1,!1]),yr.unblended=new yr(yr.Replace,c.b6.transparent,[!0,!0,!0,!0]),yr.alphaBlended=new yr([1,771],c.b6.transparent,[!0,!0,!0,!0]);const xa=2305;class Gt{constructor(e,r,l){this.enable=e,this.mode=r,this.frontFace=l}}Gt.disabled=new Gt(!1,1029,xa),Gt.backCCW=new Gt(!0,1029,xa),Gt.frontCCW=new Gt(!0,1028,xa);class Dt{constructor(e,r,l){this.func=e,this.mask=r,this.range=l}}Dt.ReadOnly=!1,Dt.ReadWrite=!0,Dt.disabled=new Dt(519,Dt.ReadOnly,[0,1]);const Xn=7680;class Wt{constructor(e,r,l,u,p,y){this.test=e,this.ref=r,this.mask=l,this.fail=u,this.depthFail=p,this.pass=y}}Wt.disabled=new Wt({func:519,mask:0},0,0,Xn,Xn,Xn);const Rs=new WeakMap;function li(f){var e;if(Rs.has(f))return Rs.get(f);{const r=(e=f.getParameter(f.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Rs.set(f,r),r}}class Ds{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const r=e.context,l=r.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const u=new c.aE;u.emplaceBack(-1,-1),u.emplaceBack(2,-1),u.emplaceBack(-1,2);const p=new c.aG;p.emplaceBack(0,1,2),this._fullscreenTriangle=new Zo(r.createVertexBuffer(u,ii.members),r.createIndexBuffer(p),c.aF.simpleSegment(0,0,u.length,p.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(l.TEXTURE1);const y=l.createTexture();l.bindTexture(l.TEXTURE_2D,y),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(y),li(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,r){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,r),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,r=e.gl;e.activeTexture.set(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,r){const l=this._cachedRenderContext.context,u=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:c.b6.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,u.TRIANGLES,Dt.disabled,Wt.disabled,yr.unblended,Gt.disabled,((p,y)=>({u_input:p,u_output_expected:y}))(e,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&li(u)){u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.readBuffer(u.COLOR_ATTACHMENT0),u.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),u.bindBuffer(u.PIXEL_PACK_BUFFER,null);const p=u.fenceSync(u.SYNC_GPU_COMMANDS_COMPLETE,0);u.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:p}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&li(e)){const r=e.clientWaitSync(this._readbackQueue.sync,0,0);if(r===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Ds._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let r=0;return r+=e[0]/256,r+=e[1]/65536,r+=e[2]/16777216,e[3]<127&&(r=-r),r/128}}const wa=c.Z/128;function Bs(f,e){const r=f.granularity!==void 0?Math.max(f.granularity,1):1,l=r+(f.generateBorders?2:0),u=r+(f.extendToNorthPole||f.generateBorders?1:0)+(f.extendToSouthPole||f.generateBorders?1:0),p=l+1,y=u+1,x=f.generateBorders?-1:0,S=f.generateBorders||f.extendToNorthPole?-1:0,k=r+(f.generateBorders?1:0),E=r+(f.generateBorders||f.extendToSouthPole?1:0),z=p*y,D=l*u*6,$=p*y>65536;if($&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const N=$||e==="32bit",J=new Int16Array(2*z);let Y=0;for(let ne=S;ne<=E;ne++)for(let ae=x;ae<=k;ae++){let ce=ae/r*c.Z;ae===-1&&(ce=-64),ae===r+1&&(ce=c.Z+wa);let de=ne/r*c.Z;ne===-1&&(de=f.extendToNorthPole?c.b8:-64),ne===r+1&&(de=f.extendToSouthPole?c.b9:c.Z+wa),J[Y++]=ce,J[Y++]=de}const Q=N?new Uint32Array(D):new Uint16Array(D);let re=0;for(let ne=0;ne<u;ne++)for(let ae=0;ae<l;ae++){const ce=ae+1+ne*p,de=ae+(ne+1)*p,ue=ae+1+(ne+1)*p;Q[re++]=ae+ne*p,Q[re++]=de,Q[re++]=ce,Q[re++]=ce,Q[re++]=de,Q[re++]=ue}return{vertices:J.buffer.slice(0),indices:Q.buffer.slice(0),uses32bitIndices:N}}const Kn=new c.aD({fill:new c.ba(128,2),line:new c.ba(512,0),tile:new c.ba(128,32),stencil:new c.ba(128,1),circle:3});class Yn{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return _i.projectionGlobe}get vertexShaderPreludeCode(){return _i.projectionMercator.vertexSource}get subdivisionGranularity(){return Kn}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Ds(e));const r=c.S(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,u=this._errorMeasurement.updateErrorLoop(r,l),p=K.now();u!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=u,this._errorMeasurementLastChangeTime=p);const y=Math.min(Math.max((p-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bb(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bc(y))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,r,l,u,p){const y=(p==="stencil"?Kn.stencil:Kn.tile).getGranularityForZoomLevel(r.z);return this._getMesh(e,{granularity:y,generateBorders:l,extendToNorthPole:r.y===0&&u,extendToSouthPole:r.y===(1<<r.z)-1&&u})}_getMesh(e,r){const l=this._getMeshKey(r);if(l in this._tileMeshCache)return this._tileMeshCache[l];const u=function(p,y){const x=Bs(y,"16bit"),S=c.aE.deserialize({arrayBuffer:x.vertices,length:x.vertices.byteLength/2/2}),k=c.aG.deserialize({arrayBuffer:x.indices,length:x.indices.byteLength/2/3});return new Zo(p.createVertexBuffer(S,ii.members),p.createIndexBuffer(k),c.aF.simpleSegment(0,0,S.length,k.length))}(e,r);return this._tileMeshCache[l]=u,u}recalculate(e){}hasTransition(){const e=K.now();let r=!1;return r=r||(e-this._errorMeasurementLastChangeTime)/1e3<.7,r=r||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,r}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Ud=new c.r({type:new c.D(c.v.projection.type)});class Ca extends c.E{constructor(e){super(),this._transitionable=new c.T(Ud),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.C(0)),this._mercatorProjection=new Nl,this._verticalPerspectiveProjection=new Yn}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.bd){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,r,l,u,p){return this.currentProjection.getMeshFromTileID(e,r,l,u,p)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Zl(f){const e=xo(f.worldSize,f.center.lat);return 2*Math.PI*e}function Ls(f,e,r,l,u){const p=1/(1<<u),y=e/c.Z*p+l*p,x=c.bf((f/c.Z*p+r*p)*Math.PI*2+Math.PI,2*Math.PI),S=2*Math.atan(Math.exp(Math.PI-y*Math.PI*2))-.5*Math.PI,k=Math.cos(S),E=new Float64Array(3);return E[0]=Math.sin(x)*k,E[1]=Math.sin(S),E[2]=Math.cos(x)*k,E}function bo(f){return function(e,r){const l=Math.cos(r),u=new Float64Array(3);return u[0]=Math.sin(e)*l,u[1]=Math.sin(r),u[2]=Math.cos(e)*l,u}(f.lng*Math.PI/180,f.lat*Math.PI/180)}function xo(f,e){return f/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Sa(f){const e=Math.asin(f[1])/Math.PI*180,r=Math.sqrt(f[0]*f[0]+f[2]*f[2]);if(r>1e-6){const l=f[0]/r,u=Math.acos(f[2]/r),p=(l>0?u:-u)/Math.PI*180;return new c.Q(c.aK(p,-180,180),e)}return new c.Q(0,e)}function Go(f){return Math.cos(f*Math.PI/180)}function Fr(f,e){const r=Go(f),l=Go(e);return c.aa(l/r)}function Gl(f,e){const r=f.rotate(e.bearingInRadians),l=e.zoom+Fr(e.center.lat,0),u=c.bb(1/Go(e.center.lat),1/Go(Math.min(Math.abs(e.center.lat),60)),c.be(l,7,3,0,1)),p=360/Zl({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.Q(e.center.lng-r.x*p*u,c.ad(e.center.lat+r.y*p,-85.051129,c.aI))}function Ta(f){const e=.5*f,r=Math.sin(e),l=Math.cos(e);return Math.log(r+l)-Math.log(l-r)}function gn(f,e,r,l){const u=f.lat+r*l;if(Math.abs(r)>1){const p=(Math.sign(f.lat+r)!==Math.sign(f.lat)?-Math.abs(f.lat):Math.abs(f.lat))*Math.PI/180,y=Math.abs(f.lat+r)*Math.PI/180,x=Ta(p+l*(y-p)),S=Ta(p),k=Ta(y);return new c.Q(f.lng+e*((x-S)/(k-S)),u)}return new c.Q(f.lng+e*l,u)}class Zd{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,r,l,u){const p=`${e.z}_${e.x}_${e.y}`,y=this._cache.get(p);if(y)return y;const x=this._cachePrevious.get(p);if(x)return this._cache.set(p,x),x;const S=this._aabbFactory(e,r,l,u);return this._cache.set(p,S),this._hadAnyChanges=!0,S}}function ka(f,e,r){const l=f-e;return l<0?-l:Math.max(0,l-r)}function ql(f,e,r,l,u){const p=f-r;let y;return y=p<0?Math.min(-p,1+p-u):p>1?Math.min(Math.max(p-u,0),1-p):0,Math.max(y,ka(e,l,u))}class Gd{constructor(){this._aabbCache=new Zd(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,r,l,u){const p=1<<l.z,y=1/p,x=l.x/p,S=l.y/p;let k=2;return k=Math.min(k,ql(e,r,x,S,y)),k=Math.min(k,ql(e,r,x+.5,-S-y,y)),k=Math.min(k,ql(e,r,x+.5,2-S-y,y)),k}getWrap(e,r,l){const u=1<<r.z,p=1/u,y=r.x/u,x=ka(e.x,y,p),S=ka(e.x,y-1,p),k=ka(e.x,y+1,p),E=Math.min(x,S,k);return E===k?1:E===S?-1:0}allowVariableZoom(e,r){return oi(e,r)>4}allowWorldCopies(){return!1}getTileAABB(e,r,l,u){return this._aabbCache.getTileAABB(e,r,l,u)}_computeTileAABB(e,r,l,u){if(e.z<=0)return new yi([-1,-1,-1],[1,1,1]);if(e.z===1)return new yi([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const p=[Ls(0,0,e.x,e.y,e.z),Ls(c.Z,0,e.x,e.y,e.z),Ls(c.Z,c.Z,e.x,e.y,e.z),Ls(0,c.Z,e.x,e.y,e.z)],y=[1,1,1],x=[-1,-1,-1];for(const S of p)for(let k=0;k<3;k++)y[k]=Math.min(y[k],S[k]),x[k]=Math.max(x[k],S[k]);if(e.y===0||e.y===(1<<e.z)-1){const S=[0,e.y===0?1:-1,0];for(let k=0;k<3;k++)y[k]=Math.min(y[k],S[k]),x[k]=Math.max(x[k],S[k])}return new yi(y,x)}}}class Pa{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r){this._helper.resize(e,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=c.bg(),this._projectionMatrix=c.b0(),this._globeViewProjMatrix32f=c.a$(),this._globeViewProjMatrixNoCorrection=c.b0(),this._globeViewProjMatrixNoCorrectionInverted=c.b0(),this._globeProjMatrixInverted=c.b0(),this._cameraPosition=c.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new ba({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._coveringTilesDetailsProvider=new Gd}clone(){const e=new Pa;return e.apply(this),e}apply(e,r){this._globeLatitudeErrorCorrectionRadians=r||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:r,applyGlobeMatrix:l}=e,u=this._helper.getMercatorTileCoordinates(r);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:u,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const r=this.pitchInRadians,l=this.cameraToCenterDistance/e,u=Math.sin(r)*l,p=Math.cos(r)*l+1,y=1/Math.sqrt(u*u+p*p)*1;let x=-u,S=p;const k=Math.sqrt(x*x+S*S);x/=k,S/=k;const E=[0,x,S];return c.bi(E,E,[0,0,0],-this.bearingInRadians),c.bj(E,E,[0,0,0],-1*this.center.lat*Math.PI/180),c.bk(E,E,[0,0,0],this.center.lng*Math.PI/180),c.aN(E,E,.25),[...E,.25*-y]}isLocationOccluded(e){return!this.isSurfacePointVisible(bo(e))}transformLightDirection(e){const r=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,u=Math.cos(l),p=[Math.sin(r)*u,Math.sin(l),Math.cos(r)*u],y=[p[2],0,-p[0]],x=[0,0,0];c.aT(x,y,p),c.aS(y,y),c.aS(x,x);const S=[0,0,0];return c.aS(S,[y[0]*e[0]+x[0]*e[1]+p[0]*e[2],y[1]*e[0]+x[1]*e[1]+p[1]*e[2],y[2]*e[0]+x[2]*e[1]+p[2]*e[2]]),S}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,r,l){const u=function(x,S,k){const E=1/(1<<k.z);return new c.$(x/c.Z*E+k.x*E,S/c.Z*E+k.y*E)}(e,r,l.canonical),p=(y=u.y,[c.bf(u.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-y*Math.PI*2))-.5*Math.PI]);var y;return this.getCircleRadiusCorrection()/Math.cos(p[1])}projectTileCoordinates(e,r,l,u){const p=l.canonical,y=Ls(e,r,p.x,p.y,p.z),x=1+(u?u(e,r):0)/c.bq,S=[y[0]*x,y[1]*x,y[2]*x,1];c.ao(S,S,this._globeViewProjMatrixNoCorrection);const k=this._cachedClippingPlane,E=k[0]*y[0]+k[1]*y[1]+k[2]*y[2]+k[3]<0;return{point:new c.P(S[0]/S[3],S[1]/S[3]),signedDistanceFromCamera:S[3],isOccluded:E}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=xo(this.worldSize,this.center.lat),r=c.b1(),l=c.b1();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.aX(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const u=this.centerOffset;r[8]=2*-u.x/this._helper._width,r[9]=2*u.y/this._helper._height,this._projectionMatrix=c.aY(r),this._globeProjMatrixInverted=c.b1(),c.ai(this._globeProjMatrixInverted,r),c.L(r,r,[0,0,-this.cameraToCenterDistance]),c.aZ(r,r,this.rollInRadians),c.a_(r,r,-this.pitchInRadians),c.aZ(r,r,this.bearingInRadians),c.L(r,r,[0,0,-e]);const p=c.bh();p[0]=e,p[1]=e,p[2]=e,c.a_(l,r,this.center.lat*Math.PI/180),c.bl(l,l,-this.center.lng*Math.PI/180),c.M(l,l,p),this._globeViewProjMatrixNoCorrection=l,c.a_(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bl(r,r,-this.center.lng*Math.PI/180),c.M(r,r,p),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=c.b1(),c.ai(this._globeViewProjMatrixNoCorrectionInverted,l);const y=c.bh();this._cameraPosition=c.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bi(this._cameraPosition,this._cameraPosition,y,-this.rollInRadians),c.bj(this._cameraPosition,this._cameraPosition,y,this.pitchInRadians),c.bi(this._cameraPosition,this._cameraPosition,y,-this.bearingInRadians),c.aO(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bj(this._cameraPosition,this._cameraPosition,y,-this.center.lat*Math.PI/180),c.bk(this._cameraPosition,this._cameraPosition,y,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const x=c.aY(this._globeViewProjMatrixNoCorrectionInverted);c.M(x,x,[1,1,-1]),this._cachedFrustum=Ji.fromInvProjectionMatrix(x)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const r=c.b1();return c.as(r),r}getVisibleUnwrappedCoordinates(e){return[new c.aV(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=bo(e);c.aN(l,l,1+r/c.bq);const u=c.bg();return c.ao(u,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),u[2]/u[3]}populateCache(e){}getBounds(){const e=.5*this.width,r=.5*this.height,l=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,r),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,r)],u=[];for(const z of l)u.push(this.unprojectScreenPoint(z));let p=0,y=0,x=0,S=0;const k=this.center;for(const z of u){const D=c.bm(k.lng,z.lng),$=c.bm(k.lat,z.lat);D<y&&(y=D),D>p&&(p=D),$<S&&(S=$),$>x&&(x=$)}const E=[k.lng+y,k.lat+S,k.lng+p,k.lat+x];return this.isSurfacePointOnScreen([0,1,0])&&(E[3]=90,E[0]=-180,E[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(E[1]=-90,E[0]=-180,E[2]=180),new ke(E)}getConstrained(e,r){const l=c.ad(e.lat,-85.051129,c.aI),u=c.ad(+r,this.minZoom+Fr(0,l),this.maxZoom);return{center:new c.Q(e.lng,l),zoom:u}}calculateCenterFromCameraLngLatAlt(e,r,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,u)}setLocationAtPoint(e,r){const l=bo(this.unprojectScreenPoint(r)),u=bo(e),p=c.bh();c.bn(p);const y=c.bh();c.bk(y,l,p,-this.center.lng*Math.PI/180),c.bj(y,y,p,this.center.lat*Math.PI/180);const x=u[0]*u[0]+u[2]*u[2],S=y[0]*y[0];if(x<S)return;const k=Math.sqrt(x-S),E=-k,z=c.bo(u[0],u[2],y[0],k),D=c.bo(u[0],u[2],y[0],E),$=c.bh();c.bk($,u,p,-z);const N=c.bo($[1],$[2],y[1],y[2]),J=c.bh();c.bk(J,u,p,-D);const Y=c.bo(J[1],J[2],y[1],y[2]),Q=.5*Math.PI,re=N>=-Q&&N<=Q,ne=Y>=-Q&&Y<=Q;let ae,ce;if(re&&ne){const Ce=this.center.lng*Math.PI/180,Ee=this.center.lat*Math.PI/180;c.br(z,Ce)+c.br(N,Ee)<c.br(D,Ce)+c.br(Y,Ee)?(ae=z,ce=N):(ae=D,ce=Y)}else if(re)ae=z,ce=N;else{if(!ne)return;ae=D,ce=Y}const de=ae/Math.PI*180,ue=ce/Math.PI*180,xe=this.center.lat;this.setCenter(new c.Q(de,c.ad(ue,-90,90))),this.setZoom(this.zoom+Fr(xe,this.center.lat))}locationToScreenPoint(e,r){const l=bo(e);if(r){const u=r.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aN(l,l,1+u/c.bq)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const r=c.bg();return c.ao(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new c.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,r){if(r){const l=r.pointCoordinate(e);if(l)return l}return c.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,r){var l;return(l=this.screenPointToMercatorCoordinate(e,r))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,r){const l=this._cameraPosition,u=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,u)}getRayDirectionFromPixel(e){const r=c.bg();r[0]=e.x/this.width*2-1,r[1]=-1*(e.y/this.height*2-1),r[2]=1,r[3]=1,c.ao(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const l=c.bh();l[0]=r[0]-this._cameraPosition[0],l[1]=r[1]-this._cameraPosition[1],l[2]=r[2]-this._cameraPosition[2];const u=c.bh();return c.aS(u,l),u}isSurfacePointVisible(e){const r=this._cachedClippingPlane;return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const r=c.bg();return c.ao(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(e,r){const l=c.aU(e,r),u=c.bh(),p=c.bh();c.aN(p,r,l),c.aR(u,e,p);const y=1-c.aU(u,u);if(y<0)return null;const x=c.aU(e,e)-1,S=-l+(l<0?1:-1)*Math.sqrt(y),k=x/S,E=S;return{tMin:Math.min(k,E),tMax:Math.max(k,E)}}unprojectScreenPoint(e){const r=this._cameraPosition,l=this.getRayDirectionFromPixel(e),u=this.rayPlanetIntersection(r,l);if(u){const k=c.bh();c.aO(k,r,[l[0]*u.tMin,l[1]*u.tMin,l[2]*u.tMin]);const E=c.bh();return c.aS(E,k),Sa(E)}const p=this._cachedClippingPlane[0]*l[0]+this._cachedClippingPlane[1]*l[1]+this._cachedClippingPlane[2]*l[2],y=-c.bp(this._cachedClippingPlane,r)/p,x=c.bh();if(y>0)c.aO(x,r,[l[0]*y,l[1]*y,l[2]*y]);else{const k=c.bh();c.aO(k,r,[2*l[0],2*l[1],2*l[2]]);const E=c.bp(this._cachedClippingPlane,k);c.aR(x,k,[this._cachedClippingPlane[0]*E,this._cachedClippingPlane[1]*E,this._cachedClippingPlane[2]*E])}const S=c.bh();return c.aS(S,x),Sa(S)}getMatrixForModel(e,r){const l=c.Q.convert(e),u=1/c.bq,p=c.b0();return c.bl(p,p,l.lng/180*Math.PI),c.a_(p,p,-l.lat/180*Math.PI),c.L(p,p,[0,0,1+r/c.bq]),c.a_(p,p,.5*Math.PI),c.M(p,p,[u,u,u]),p}getProjectionDataForCustomLayer(e=!0){const r=this.getProjectionData({overscaledTileID:new c.Y(0,0,0,0,0),applyGlobeMatrix:e});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(e){}}class Ma{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,l=!0){this._helper.resize(e,r,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,r){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=r,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new ba({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._globeness=1,this._mercatorTransform=new si,this._verticalPerspectiveTransform=new Pa}clone(){const e=new Ma;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const r=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:r.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:r.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.bb(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bb(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,r,l){const u=this._mercatorTransform.getPitchedTextCorrection(e,r,l),p=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,r,l);return c.bb(u,p,this._globeness)}projectTileCoordinates(e,r,l,u){return this.currentTransform.projectTileCoordinates(e,r,l,u)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){return this.currentTransform.lngLatToCameraDepth(e,r)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,r){return this.currentTransform.getConstrained(e,r)}calculateCenterFromCameraLngLatAlt(e,r,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,u)}setLocationAtPoint(e,r){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,r),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,r),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,r){return this.currentTransform.locationToScreenPoint(e,r)}screenPointToMercatorCoordinate(e,r){return this.currentTransform.screenPointToMercatorCoordinate(e,r)}screenPointToLocation(e,r){return this.currentTransform.screenPointToLocation(e,r)}isPointOnMapSurface(e,r){return this.currentTransform.isPointOnMapSurface(e,r)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,r){return this.currentTransform.getMatrixForModel(e,r)}getProjectionDataForCustomLayer(e=!0){const r=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return r;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=r.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Do{get useGlobeControls(){return!0}handlePanInertia(e,r){const l=Gl(e,r);return Math.abs(l.lng-r.center.lng)>180&&(l.lng=r.center.lng+179.5*Math.sign(l.lng-r.center.lng)),{easingCenter:l,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,r){const l=e.around,u=r.screenPointToLocation(l);e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta);const p=r.zoom;e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta);const y=r.zoom-p;if(y===0)return;const x=c.bm(r.center.lng,u.lng),S=x/(Math.abs(x/180)+1),k=c.bm(r.center.lat,u.lat),E=r.getRayDirectionFromPixel(l),z=r.cameraPosition,D=-1*c.aU(z,E),$=c.bh();c.aO($,z,[E[0]*D,E[1]*D,E[2]*D]);const N=c.bs($)-1,J=Math.exp(.5*-Math.max(N-.3,0)),Y=xo(r.worldSize,r.center.lat)/Math.min(r.width,r.height),Q=c.be(Y,.9,.5,1,.25),re=(1-c.aH(-y))*Math.min(J,Q),ne=r.center.lat,ae=r.zoom,ce=new c.Q(r.center.lng+S*re,c.ad(r.center.lat+k*re,-85.051129,c.aI));r.setLocationAtPoint(u,l);const de=r.center,ue=c.be(Math.abs(x),45,85,0,1),xe=c.be(Y,.75,.35,0,1),Ce=Math.pow(Math.max(ue,xe),.25),Ee=c.bm(de.lng,ce.lng),Re=c.bm(de.lat,ce.lat);r.setCenter(new c.Q(de.lng+Ee*Ce,de.lat+Re*Ce).wrap()),r.setZoom(ae+Fr(ne,r.center.lat))}handleMapControlsPan(e,r,l){if(!e.panDelta)return;const u=r.center.lat,p=r.zoom;r.setCenter(Gl(e.panDelta,r).wrap()),r.setZoom(p+Fr(u,r.center.lat))}cameraForBoxAndBearing(e,r,l,u,p){const y=Ul(e,r,l,u,p),x=r.left/p.width*2-1,S=(p.width-r.right)/p.width*2-1,k=r.top/p.height*-2+1,E=(p.height-r.bottom)/p.height*-2+1,z=c.bm(l.getWest(),l.getEast())<0,D=z?l.getEast():l.getWest(),$=z?l.getWest():l.getEast(),N=Math.max(l.getNorth(),l.getSouth()),J=Math.min(l.getNorth(),l.getSouth()),Y=D+.5*c.bm(D,$),Q=N+.5*c.bm(N,J),re=p.clone();re.setCenter(y.center),re.setBearing(y.bearing),re.setPitch(0),re.setRoll(0),re.setZoom(y.zoom);const ne=re.modelViewProjectionMatrix,ae=[bo(l.getNorthWest()),bo(l.getNorthEast()),bo(l.getSouthWest()),bo(l.getSouthEast()),bo(new c.Q($,Q)),bo(new c.Q(D,Q)),bo(new c.Q(Y,N)),bo(new c.Q(Y,J))],ce=bo(y.center);let de=Number.POSITIVE_INFINITY;for(const ue of ae)x<0&&(de=Do.getLesserNonNegativeNonNull(de,Do.solveVectorScale(ue,ce,ne,"x",x))),S>0&&(de=Do.getLesserNonNegativeNonNull(de,Do.solveVectorScale(ue,ce,ne,"x",S))),k>0&&(de=Do.getLesserNonNegativeNonNull(de,Do.solveVectorScale(ue,ce,ne,"y",k))),E<0&&(de=Do.getLesserNonNegativeNonNull(de,Do.solveVectorScale(ue,ce,ne,"y",E)));if(Number.isFinite(de)&&de!==0)return y.zoom=re.zoom+c.aa(de),y;zs()}handleJumpToCenterZoom(e,r){const l=e.center.lat,u=e.getConstrained(r.center?c.Q.convert(r.center):e.center,e.zoom).center;e.setCenter(u.wrap());const p=r.zoom!==void 0?+r.zoom:e.zoom+Fr(l,u.lat);e.zoom!==p&&e.setZoom(p)}handleEaseTo(e,r){const l=e.zoom,u=e.center,p=e.padding,y={roll:e.roll,pitch:e.pitch,bearing:e.bearing},x={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},S=r.zoom!==void 0,k=!e.isPaddingEqual(r.padding);let E=!1;const z=r.center?c.Q.convert(r.center):u,D=e.getConstrained(z,l).center;ko(e,D);const $=e.clone();$.setCenter(D),$.setZoom(S?+r.zoom:l+Fr(u.lat,z.lat)),$.setBearing(r.bearing);const N=new c.P(c.ad(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),c.ad(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));$.setLocationAtPoint(D,N);const J=(r.offset&&r.offsetAsPoint.mag())>0?$.center:D,Y=S?+r.zoom:l+Fr(u.lat,J.lat),Q=l+Fr(u.lat,0),re=Y+Fr(J.lat,0),ne=c.bm(u.lng,J.lng),ae=c.bm(u.lat,J.lat),ce=c.aH(re-Q);return E=Y!==l,{easeFunc:de=>{if(c.b5(y,x)||ai({startEulerAngles:y,endEulerAngles:x,tr:e,k:de,useSlerp:y.roll!=x.roll}),k&&e.interpolatePadding(p,r.padding,de),r.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(r.around,r.aroundPoint);else{const ue=re>Q?Math.min(2,ce):Math.max(.5,ce),xe=Math.pow(ue,1-de),Ce=gn(u,ne,ae,de*xe);e.setCenter(Ce.wrap())}if(E){const ue=c.B.number(Q,re,de)+Fr(0,e.center.lat);e.setZoom(ue)}},isZooming:E,elevationCenter:J}}handleFlyTo(e,r){const l=r.zoom!==void 0,u=e.center,p=e.zoom,y=e.padding,x=!e.isPaddingEqual(r.padding),S=e.getConstrained(c.Q.convert(r.center||r.locationAtOffset),p).center,k=l?+r.zoom:e.zoom+Fr(e.center.lat,S.lat),E=e.clone();E.setCenter(S),E.setZoom(k),E.setBearing(r.bearing);const z=new c.P(c.ad(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),c.ad(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));E.setLocationAtPoint(S,z);const D=E.center;ko(e,D);const $=function(ae,ce,de){const ue=bo(ce),xe=bo(de),Ce=c.aU(ue,xe),Ee=Math.acos(Ce),Re=Zl(ae);return Ee/(2*Math.PI)*Re}(e,u,D),N=p+Fr(u.lat,0),J=k+Fr(D.lat,0),Y=c.aH(J-N);let Q;if(typeof r.minZoom=="number"){const ae=+r.minZoom+Fr(D.lat,0),ce=Math.min(ae,N,J)+Fr(0,D.lat),de=e.getConstrained(D,ce).zoom+Fr(D.lat,0);Q=c.aH(de-N)}const re=c.bm(u.lng,D.lng),ne=c.bm(u.lat,D.lat);return{easeFunc:(ae,ce,de,ue)=>{const xe=gn(u,re,ne,de);x&&e.interpolatePadding(y,r.padding,ae);const Ce=ae===1?D:xe;e.setCenter(Ce.wrap());const Ee=N+c.aa(ce);e.setZoom(ae===1?k:Ee+Fr(0,Ce.lat))},scaleOfZoom:Y,targetCenter:D,scaleOfMinZoom:Q,pixelPathLength:$}}static solveVectorScale(e,r,l,u,p){const y=u==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],x=[l[3],l[7],l[11],l[15]],S=e[0]*y[0]+e[1]*y[1]+e[2]*y[2],k=e[0]*x[0]+e[1]*x[1]+e[2]*x[2],E=r[0]*y[0]+r[1]*y[1]+r[2]*y[2],z=r[0]*x[0]+r[1]*x[1]+r[2]*x[2];return E+p*k===S+p*z||x[3]*(S-E)+y[3]*(z-k)+S*z==E*k?null:(E+y[3]-p*z-p*x[3])/(E-S-p*z+p*k)}static getLesserNonNegativeNonNull(e,r){return r!==null&&r>=0&&r<e?r:e}}class Ia{constructor(e){this._globe=e,this._mercatorCameraHelper=new vi,this._verticalPerspectiveCameraHelper=new Do}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,r){return this.currentHelper.handlePanInertia(e,r)}handleMapControlsRollPitchBearingZoom(e,r){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,r)}handleMapControlsPan(e,r,l){this.currentHelper.handleMapControlsPan(e,r,l)}cameraForBoxAndBearing(e,r,l,u,p){return this.currentHelper.cameraForBoxAndBearing(e,r,l,u,p)}handleJumpToCenterZoom(e,r){this.currentHelper.handleJumpToCenterZoom(e,r)}handleEaseTo(e,r){return this.currentHelper.handleEaseTo(e,r)}handleFlyTo(e,r){return this.currentHelper.handleFlyTo(e,r)}}const _n=(f,e)=>c.x(f,e&&e.filter(r=>r.identifier!=="source.canvas")),Wl=c.bt();class Fs extends c.E{constructor(e,r={}){super(),this._rtlPluginLoaded=()=>{for(const l in this.sourceCaches){const u=this.sourceCaches[l].getSource().type;u!=="vector"&&u!=="geojson"||this.sourceCaches[l].reload()}},this.map=e,this.dispatcher=new Ao(yo(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(l,u)=>this.getGlyphs(l,u)),this.dispatcher.registerMessageHandler("GI",(l,u)=>this.getImages(l,u)),this.imageManager=new mt,this.imageManager.setEventedParent(this),this.glyphManager=new Bt(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new zr(256,512),this.crossTileSymbolIndex=new jl,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bu,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.bv()),Vt().on(It,this._rtlPluginLoaded),this.on("data",l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const u=this.sourceCaches[l.sourceId];if(!u)return;const p=u.getSource();if(p&&p.vectorLayerIds)for(const y in this._layers){const x=this._layers[y];x.source===p.id&&this._validateLayer(x)}})}loadURL(e,r={},l){this.fire(new c.l("dataloading",{dataType:"style"})),r.validate=typeof r.validate!="boolean"||r.validate;const u=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const p=this._loadStyleRequest;c.j(u,this._loadStyleRequest).then(y=>{this._loadStyleRequest=null,this._load(y.data,r,l)}).catch(y=>{this._loadStyleRequest=null,y&&!p.signal.aborted&&this.fire(new c.k(y))})}loadJSON(e,r={},l){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,K.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(e,r,l)}).catch(()=>{})}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(Wl,{validate:!1})}_load(e,r,l){var u,p;const y=r.transformStyle?r.transformStyle(l,e):e;if(!r.validate||!_n(this,c.y(y))){this._loaded=!0,this.stylesheet=y;for(const x in y.sources)this.addSource(x,y.sources[x],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new Et(this.stylesheet.light),this._setProjectionInternal(((u=this.stylesheet.projection)===null||u===void 0?void 0:u.type)||"mercator"),this.sky=new Ar(this.stylesheet.sky),this.map.setTerrain((p=this.stylesheet.terrain)!==null&&p!==void 0?p:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){const e=c.bw(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(r=>r.id),this._layers={},this._serializedLayers=null;for(const r of e){const l=c.bx(r);l.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=l}}_loadSprite(e,r=!1,l=void 0){let u;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(p,y,x,S){return c._(this,void 0,void 0,function*(){const k=Ye(p),E=x>1?"@2x":"",z={},D={};for(const{id:$,url:N}of k){const J=y.transformRequest(nt(N,E,".json"),"SpriteJSON");z[$]=c.j(J,S);const Y=y.transformRequest(nt(N,E,".png"),"SpriteImage");D[$]=ye.getImage(Y,S)}return yield Promise.all([...Object.values(z),...Object.values(D)]),function($,N){return c._(this,void 0,void 0,function*(){const J={};for(const Y in $){J[Y]={};const Q=K.getImageCanvasContext((yield N[Y]).data),re=(yield $[Y]).data;for(const ne in re){const{width:ae,height:ce,x:de,y:ue,sdf:xe,pixelRatio:Ce,stretchX:Ee,stretchY:Re,content:Ie,textFitWidth:Ke,textFitHeight:He}=re[ne];J[Y][ne]={data:null,pixelRatio:Ce,sdf:xe,stretchX:Ee,stretchY:Re,content:Ie,textFitWidth:Ke,textFitHeight:He,spriteData:{width:ae,height:ce,x:de,y:ue,context:Q}}}}return J})}(z,D)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(p=>{if(this._spriteRequest=null,p)for(const y in p){this._spritesImagesIds[y]=[];const x=this._spritesImagesIds[y]?this._spritesImagesIds[y].filter(S=>!(S in p)):[];for(const S of x)this.imageManager.removeImage(S),this._changedImages[S]=!0;for(const S in p[y]){const k=y==="default"?S:`${y}:${S}`;this._spritesImagesIds[y].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,p[y][S],!1):this.imageManager.addImage(k,p[y][S]),r&&(this._changedImages[k]=!0)}}}).catch(p=>{this._spriteRequest=null,u=p,this.fire(new c.k(u))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),l&&l(u)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(e){const r=this.sourceCaches[e.source];if(!r)return;const l=e.sourceLayer;if(!l)return;const u=r.getSource();(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(l)===-1)&&this.fire(new c.k(new Error(`Source layer "${l}" does not exist on source "${u.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,r=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(r?c.by(l):l);const u=[];for(const p of e)if(l[p]){const y=r?c.by(l[p]):l[p];u.push(y)}return u}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const r=Object.keys(this._layers);for(const l of r){const u=this._layers[l];u.type!=="custom"&&(e[l]=u.serialize())}return e}hasTransitions(){var e,r,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((r=this.sky)===null||r===void 0)&&r.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const u in this.sourceCaches)if(this.sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const r=this._changed;if(r){const u=Object.keys(this._updatedLayers),p=Object.keys(this._removedLayers);(u.length||p.length)&&this._updateWorkerLayers(u,p);for(const y in this._updatedSources){const x=this._updatedSources[y];if(x==="reload")this._reloadSource(y);else{if(x!=="clear")throw new Error(`Invalid action ${x}`);this._clearSource(y)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const y in this._updatedPaintProps)this._layers[y].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const u in this.sourceCaches){const p=this.sourceCaches[u];l[u]=p.used,p.used=!1}for(const u of this._order){const p=this._layers[u];p.recalculate(e,this._availableImages),!p.isHidden(e.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}for(const u in l){const p=this.sourceCaches[u];!!l[u]!=!!p.used&&p.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:u}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,r&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var l;this._checkLoaded();const u=this.serialize();if(e=r.transformStyle?r.transformStyle(u,e):e,((l=r.validate)===null||l===void 0||l)&&_n(this,c.y(e)))return!1;(e=c.by(e)).layers=c.bw(e.layers);const p=c.bz(u,e),y=this._getOperationsToPerform(p);if(y.unimplemented.length>0)throw new Error(`Unimplemented: ${y.unimplemented.join(", ")}.`);if(y.operations.length===0)return!1;for(const x of y.operations)x();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const r=[],l=[];for(const u of e)switch(u.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":r.push(()=>this.addLayer.apply(this,u.args));break;case"removeLayer":r.push(()=>this.removeLayer.apply(this,u.args));break;case"setPaintProperty":r.push(()=>this.setPaintProperty.apply(this,u.args));break;case"setLayoutProperty":r.push(()=>this.setLayoutProperty.apply(this,u.args));break;case"setFilter":r.push(()=>this.setFilter.apply(this,u.args));break;case"addSource":r.push(()=>this.addSource.apply(this,u.args));break;case"removeSource":r.push(()=>this.removeSource.apply(this,u.args));break;case"setLayerZoomRange":r.push(()=>this.setLayerZoomRange.apply(this,u.args));break;case"setLight":r.push(()=>this.setLight.apply(this,u.args));break;case"setGeoJSONSourceData":r.push(()=>this.setGeoJSONSourceData.apply(this,u.args));break;case"setGlyphs":r.push(()=>this.setGlyphs.apply(this,u.args));break;case"setSprite":r.push(()=>this.setSprite.apply(this,u.args));break;case"setTerrain":r.push(()=>this.map.setTerrain.apply(this,u.args));break;case"setSky":r.push(()=>this.setSky.apply(this,u.args));break;case"setProjection":this.setProjection.apply(this,u.args);break;case"setTransition":r.push(()=>{});break;default:l.push(u.command)}return{operations:r,unimplemented:l}}addImage(e,r){if(this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,r){this.imageManager.updateImage(e,r)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(c.y.source,`sources.${e}`,r,null,l))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const u=this.sourceCaches[e]=new A(e,r,this.dispatcher);u.style=this,u.setEventedParent(this,()=>({isSourceLoaded:u.loaded(),source:u.serialize(),sourceId:e})),u.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new c.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,r){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(r),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,l={}){this._checkLoaded();const u=e.id;if(this.getLayer(u))return void this.fire(new c.k(new Error(`Layer "${u}" already exists on this map.`)));let p;if(e.type==="custom"){if(_n(this,c.bA(e)))return;p=c.bx(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(u,e.source),e=c.by(e),e=c.e(e,{source:u})),this._validate(c.y.layer,`layers.${u}`,e,{arrayIndex:-1},l))return;p=c.bx(e),this._validateLayer(p),p.setEventedParent(this,{layer:{id:u}})}const y=r?this._order.indexOf(r):this._order.length;if(r&&y===-1)this.fire(new c.k(new Error(`Cannot add layer "${u}" before non-existing layer "${r}".`)));else{if(this._order.splice(y,0,u),this._layerOrderChanged=!0,this._layers[u]=p,this._removedLayers[u]&&p.source&&p.type!=="custom"){const x=this._removedLayers[u];delete this._removedLayers[u],x.type!==p.type?this._updatedSources[p.source]="clear":(this._updatedSources[p.source]="reload",this.sourceCaches[p.source].pause())}this._updateLayer(p),p.onAdd&&p.onAdd(this.map)}}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;const l=this._order.indexOf(e);this._order.splice(l,1);const u=r?this._order.indexOf(r):this._order.length;r&&u===-1?this.fire(new c.k(new Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(u,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const r=this._layers[e];if(!r)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${e}".`)));r.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,l){this._checkLoaded();const u=this.getLayer(e);u?u.minzoom===r&&u.maxzoom===l||(r!=null&&(u.minzoom=r),l!=null&&(u.maxzoom=l),this._updateLayer(u)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r,l={}){this._checkLoaded();const u=this.getLayer(e);if(u){if(!c.bB(u.filter,r))return r==null?(u.filter=void 0,void this._updateLayer(u)):void(this._validate(c.y.filter,`layers.${u.id}.filter`,r,null,l)||(u.filter=c.by(r),this._updateLayer(u)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.by(this.getLayer(e).filter)}setLayoutProperty(e,r,l,u={}){this._checkLoaded();const p=this.getLayer(e);p?c.bB(p.getLayoutProperty(r),l)||(p.setLayoutProperty(r,l,u),this._updateLayer(p)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){const l=this.getLayer(e);if(l)return l.getLayoutProperty(r);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,l,u={}){this._checkLoaded();const p=this.getLayer(e);p?c.bB(p.getPaintProperty(r),l)||(p.setPaintProperty(r,l,u)&&this._updateLayer(p),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,r){return this.getLayer(e).getPaintProperty(r)}setFeatureState(e,r){this._checkLoaded();const l=e.source,u=e.sourceLayer,p=this.sourceCaches[l];if(p===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const y=p.getSource().type;y==="geojson"&&u?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):y!=="vector"||u?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),p.setFeatureState(u,e.id,r)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();const l=e.source,u=this.sourceCaches[l];if(u===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const p=u.getSource().type,y=p==="vector"?e.sourceLayer:void 0;p!=="vector"||y?r&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):u.removeFeatureState(y,e.id,r):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const r=e.source,l=e.sourceLayer,u=this.sourceCaches[r];if(u!==void 0)return u.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),u.getFeatureState(l,e.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bC(this.sourceCaches,p=>p.serialize()),r=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,u=this.stylesheet;return c.bD({version:u.version,name:u.name,metadata:u.metadata,light:u.light,sky:u.sky,center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,sprite:u.sprite,glyphs:u.glyphs,transition:u.transition,projection:u.projection,sources:e,layers:r,terrain:l},p=>p!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const r=y=>this._layers[y].type==="fill-extrusion",l={},u=[];for(let y=this._order.length-1;y>=0;y--){const x=this._order[y];if(r(x)){l[x]=y;for(const S of e){const k=S[x];if(k)for(const E of k)u.push(E)}}}u.sort((y,x)=>x.intersectionZ-y.intersectionZ);const p=[];for(let y=this._order.length-1;y>=0;y--){const x=this._order[y];if(r(x))for(let S=u.length-1;S>=0;S--){const k=u[S].feature;if(l[k.layer.id]<y)break;p.push(k),u.pop()}else for(const S of e){const k=S[x];if(k)for(const E of k)p.push(E.feature)}}return p}queryRenderedFeatures(e,r,l){r&&r.filter&&this._validate(c.y.filter,"queryRenderedFeatures.filter",r.filter,null,r);const u={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const k of r.layers){const E=this._layers[k];if(!E)return this.fire(new c.k(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];u[E.source]=!0}}const p=[];r.availableImages=this._availableImages;const y=this._serializedAllLayers(),x=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,S=Object.assign(Object.assign({},r),{layers:x});for(const k in this.sourceCaches)r.layers&&!u[k]||p.push(Uo(this.sourceCaches[k],this._layers,y,e,S,l));return this.placement&&p.push(function(k,E,z,D,$,N,J){const Y={},Q=N.queryRenderedSymbols(D),re=[];for(const ne of Object.keys(Q).map(Number))re.push(J[ne]);re.sort(qr);for(const ne of re){const ae=ne.featureIndex.lookupSymbolFeatures(Q[ne.bucketInstanceId],E,ne.bucketIndex,ne.sourceLayerIndex,$.filter,$.layers,$.availableImages,k);for(const ce in ae){const de=Y[ce]=Y[ce]||[],ue=ae[ce];ue.sort((xe,Ce)=>{const Ee=ne.featureSortOrder;if(Ee){const Re=Ee.indexOf(xe.featureIndex);return Ee.indexOf(Ce.featureIndex)-Re}return Ce.featureIndex-xe.featureIndex});for(const xe of ue)de.push(xe)}}return function(ne,ae,ce){for(const de in ne)for(const ue of ne[de])se(ue,ce[ae[de].source]);return ne}(Y,k,z)}(this._layers,y,this.sourceCaches,e,S,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(p)}querySourceFeatures(e,r){r&&r.filter&&this._validate(c.y.filter,"querySourceFeatures.filter",r.filter,null,r);const l=this.sourceCaches[e];return l?function(u,p){const y=u.getRenderableIds().map(k=>u.getTileByID(k)),x=[],S={};for(let k=0;k<y.length;k++){const E=y[k],z=E.tileID.canonical.key;S[z]||(S[z]=!0,E.querySourceFeatures(x,p))}return x}(l,r):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();const l=this.light.getLight();let u=!1;for(const y in e)if(!c.bB(e[y],l[y])){u=!0;break}if(!u)return;const p={now:K.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(p)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,r={}){this._checkLoaded();const l=this.getSky();let u=!1;if(!e&&!l)return;if(e&&!l)u=!0;else if(!e&&l)u=!0;else for(const y in e)if(!c.bB(e[y],l[y])){u=!0;break}if(!u)return;const p={now:K.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(p)}_setProjectionInternal(e){const r=function(l){if(Array.isArray(l)){const u=new Ca({type:l});return{projection:u,transform:new Ma,cameraHelper:new Ia(u)}}switch(l){case"mercator":return{projection:new Nl,transform:new si,cameraHelper:new vi};case"globe":{const u=new Ca({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:u,transform:new Ma,cameraHelper:new Ia(u)}}case"vertical-perspective":return{projection:new Yn,transform:new Pa,cameraHelper:new Do};default:return c.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new Nl,transform:new si,cameraHelper:new vi}}}(e);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,r,l,u,p={}){return(!p||p.validate!==!1)&&_n(this,e.call(c.y,c.e({key:r,style:this.serialize(),value:l,styleSpec:c.v},u)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Vt().off(It,this._rtlPluginLoaded);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const l=this.sourceCaches[r];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const r in this.sourceCaches)this.sourceCaches[r].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,r,l,u,p=!1){let y=!1,x=!1;const S={};for(const k of this._order){const E=this._layers[k];if(E.type!=="symbol")continue;if(!S[E.source]){const D=this.sourceCaches[E.source];S[E.source]=D.getRenderableIds(!0).map($=>D.getTileByID($)).sort(($,N)=>N.tileID.overscaledZ-$.tileID.overscaledZ||($.tileID.isLessThan(N.tileID)?-1:1))}const z=this.crossTileSymbolIndex.addLayer(E,S[E.source],e.center.lng);y=y||z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((p=p||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(K.now(),e.zoom))&&(this.pauseablePlacement=new Fl(e,this.map.terrain,this._order,p,r,l,u,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(K.now()),x=!0),y&&this.pauseablePlacement.placement.setStale()),x||y)for(const k of this._order){const E=this._layers[k];E.type==="symbol"&&this.placement.updateLayerOpacities(E,S[E.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(K.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,r){return c._(this,void 0,void 0,function*(){const l=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const u=this.sourceCaches[r.source];return u&&u.setDependencies(r.tileID.key,r.type,r.icons),l})}getGlyphs(e,r){return c._(this,void 0,void 0,function*(){const l=yield this.glyphManager.getGlyphs(r.stacks),u=this.sourceCaches[r.source];return u&&u.setDependencies(r.tileID.key,r.type,[""]),l})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),e&&this._validate(c.y.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r,l={},u){this._checkLoaded();const p=[{id:e,url:r}],y=[...Ye(this.stylesheet.sprite),...p];this._validate(c.y.sprite,"sprite",y,null,l)||(this.stylesheet.sprite=y,this._loadSprite(p,!0,u))}removeSprite(e){this._checkLoaded();const r=Ye(this.stylesheet.sprite);if(r.find(l=>l.id===e)){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;r.splice(r.findIndex(l=>l.id===e),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Ye(this.stylesheet.sprite)}setSprite(e,r={},l){this._checkLoaded(),e&&this._validate(c.y.sprite,"sprite",e,null,r)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var Mi=c.aC([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class qd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,r,l,u,p,y,x,S,k){this.context=e;let E=this.boundPaintVertexBuffers.length!==u.length;for(let z=0;!E&&z<u.length;z++)this.boundPaintVertexBuffers[z]!==u[z]&&(E=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==l||E||this.boundIndexBuffer!==p||this.boundVertexOffset!==y||this.boundDynamicVertexBuffer!==x||this.boundDynamicVertexBuffer2!==S||this.boundDynamicVertexBuffer3!==k?this.freshBind(r,l,u,p,y,x,S,k):(e.bindVertexArray.set(this.vao),x&&x.bind(),p&&p.dynamicDraw&&p.bind(),S&&S.bind(),k&&k.bind())}freshBind(e,r,l,u,p,y,x,S){const k=e.numAttributes,E=this.context,z=E.gl;this.vao&&this.destroy(),this.vao=E.createVertexArray(),E.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=u,this.boundVertexOffset=p,this.boundDynamicVertexBuffer=y,this.boundDynamicVertexBuffer2=x,this.boundDynamicVertexBuffer3=S,r.enableAttributes(z,e);for(const D of l)D.enableAttributes(z,e);y&&y.enableAttributes(z,e),x&&x.enableAttributes(z,e),S&&S.enableAttributes(z,e),r.bind(),r.setVertexAttribPointers(z,e,p);for(const D of l)D.bind(),D.setVertexAttribPointers(z,e,p);y&&(y.bind(),y.setVertexAttribPointers(z,e,p)),u&&u.bind(),x&&(x.bind(),x.setVertexAttribPointers(z,e,p)),S&&(S.bind(),S.setVertexAttribPointers(z,e,p)),E.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Hl=(f,e,r,l,u)=>({u_texture:0,u_ele_delta:f,u_fog_matrix:e,u_fog_color:r?r.properties.get("fog-color"):c.b6.white,u_fog_ground_blend:r?r.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:u?0:r?r.calculateFogBlendOpacity(l):0,u_horizon_color:r?r.properties.get("horizon-color"):c.b6.white,u_horizon_fog_blend:r?r.properties.get("horizon-fog-blend"):1,u_is_globe_mode:u?1:0}),Os={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Qi(f){const e=[];for(let r=0;r<f.length;r++){if(f[r]===null)continue;const l=f[r].split(" ");e.push(l.pop())}return e}class Wd{constructor(e,r,l,u,p,y,x,S){const k=e.gl;this.program=k.createProgram();const E=Qi(r.staticAttributes),z=l?l.getBinderAttributes():[],D=E.concat(z),$=_i.prelude.staticUniforms?Qi(_i.prelude.staticUniforms):[],N=x.staticUniforms?Qi(x.staticUniforms):[],J=r.staticUniforms?Qi(r.staticUniforms):[],Y=l?l.getBinderUniforms():[],Q=$.concat(N).concat(J).concat(Y),re=[];for(const Ce of Q)re.indexOf(Ce)<0&&re.push(Ce);const ne=l?l.defines():[];li(k)&&ne.unshift("#version 300 es"),p&&ne.push("#define OVERDRAW_INSPECTOR;"),y&&ne.push("#define TERRAIN3D;"),S&&ne.push(S);let ae=ne.concat(_i.prelude.fragmentSource,x.fragmentSource,r.fragmentSource).join(`
`),ce=ne.concat(_i.prelude.vertexSource,x.vertexSource,r.vertexSource).join(`
`);li(k)||(ae=function(Ce){return Ce.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(ae),ce=function(Ce){return Ce.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(ce));const de=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(de,ae),k.compileShader(de),!k.getShaderParameter(de,k.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${k.getShaderInfoLog(de)}`);k.attachShader(this.program,de);const ue=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(ue,ce),k.compileShader(ue),!k.getShaderParameter(ue,k.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${k.getShaderInfoLog(ue)}`);k.attachShader(this.program,ue),this.attributes={};const xe={};this.numAttributes=D.length;for(let Ce=0;Ce<this.numAttributes;Ce++)D[Ce]&&(k.bindAttribLocation(this.program,Ce,D[Ce]),this.attributes[D[Ce]]=Ce);if(k.linkProgram(this.program),!k.getProgramParameter(this.program,k.LINK_STATUS))throw new Error(`Program failed to link: ${k.getProgramInfoLog(this.program)}`);k.deleteShader(ue),k.deleteShader(de);for(let Ce=0;Ce<re.length;Ce++){const Ee=re[Ce];if(Ee&&!xe[Ee]){const Re=k.getUniformLocation(this.program,Ee);Re&&(xe[Ee]=Re)}}this.fixedUniforms=u(e,xe),this.terrainUniforms=((Ce,Ee)=>({u_depth:new c.bE(Ce,Ee.u_depth),u_terrain:new c.bE(Ce,Ee.u_terrain),u_terrain_dim:new c.b7(Ce,Ee.u_terrain_dim),u_terrain_matrix:new c.bG(Ce,Ee.u_terrain_matrix),u_terrain_unpack:new c.bH(Ce,Ee.u_terrain_unpack),u_terrain_exaggeration:new c.b7(Ce,Ee.u_terrain_exaggeration)}))(e,xe),this.projectionUniforms=((Ce,Ee)=>({u_projection_matrix:new c.bG(Ce,Ee.u_projection_matrix),u_projection_tile_mercator_coords:new c.bH(Ce,Ee.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bH(Ce,Ee.u_projection_clipping_plane),u_projection_transition:new c.b7(Ce,Ee.u_projection_transition),u_projection_fallback_matrix:new c.bG(Ce,Ee.u_projection_fallback_matrix)}))(e,xe),this.binderUniforms=l?l.getUniforms(e,xe):[]}draw(e,r,l,u,p,y,x,S,k,E,z,D,$,N,J,Y,Q,re,ne){const ae=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(u),e.setColorMode(p),e.setCullFace(y),S){e.activeTexture.set(ae.TEXTURE2),ae.bindTexture(ae.TEXTURE_2D,S.depthTexture),e.activeTexture.set(ae.TEXTURE3),ae.bindTexture(ae.TEXTURE_2D,S.texture);for(const de in this.terrainUniforms)this.terrainUniforms[de].set(S[de])}if(k)for(const de in k)this.projectionUniforms[Os[de]].set(k[de]);if(x)for(const de in this.fixedUniforms)this.fixedUniforms[de].set(x[de]);Y&&Y.setUniforms(e,this.binderUniforms,N,{zoom:J});let ce=0;switch(r){case ae.LINES:ce=2;break;case ae.TRIANGLES:ce=3;break;case ae.LINE_STRIP:ce=1}for(const de of $.get()){const ue=de.vaos||(de.vaos={});(ue[E]||(ue[E]=new qd)).bind(e,this,z,Y?Y.getPaintVertexBuffers():[],D,de.vertexOffset,Q,re,ne),ae.drawElements(r,de.primitiveLength*ce,ae.UNSIGNED_SHORT,de.primitiveOffset*ce*2)}}}function $s(f,e,r){const l=1/c.av(r,1,e.transform.tileZoom),u=Math.pow(2,r.tileID.overscaledZ),p=r.tileSize*Math.pow(2,e.transform.tileZoom)/u,y=p*(r.tileID.canonical.x+r.tileID.wrap*u),x=p*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[l,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[y>>16,x>>16],u_pixel_coord_lower:[65535&y,65535&x]}}const Vu=(f,e,r,l)=>{const u=f.style.light,p=u.properties.get("position"),y=[p.x,p.y,p.z],x=c.bK();u.properties.get("anchor")==="viewport"&&c.bL(x,f.transform.bearingInRadians),c.bM(y,y,x);const S=f.transform.transformLightDirection(y),k=u.properties.get("color");return{u_lightpos:y,u_lightpos_globe:S,u_lightintensity:u.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+e,u_opacity:r,u_fill_translate:l}},Jn=(f,e,r,l,u,p,y)=>c.e(Vu(f,e,r,l),$s(p,f,y),{u_height_factor:-Math.pow(2,u.overscaledZ)/y.tileSize/8}),Uu=(f,e,r,l)=>c.e($s(e,f,r),{u_fill_translate:l}),Zu=(f,e)=>({u_world:f,u_fill_translate:e}),Hd=(f,e,r,l,u)=>c.e(Uu(f,e,r,u),{u_world:l}),Gu=(f,e,r,l,u)=>{const p=f.transform;let y,x,S=0;if(r.paint.get("circle-pitch-alignment")==="map"){const k=c.av(e,1,p.zoom);y=!0,x=[k,k],S=k/(c.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*u}else y=!1,x=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+y,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:x,u_globe_extrude_scale:S,u_translate:l}},Xl=f=>({u_pixel_extrude_scale:[1/f.width,1/f.height]}),qu=f=>({u_viewport_size:[f.width,f.height]}),Kl=(f,e=1)=>({u_color:f,u_overlay:0,u_overlay_scale:e}),Yl=(f,e,r,l)=>{const u=c.av(f,1,e)/(c.Z*Math.pow(2,f.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:c.av(f,1,e),u_intensity:r,u_globe_extrude_scale:u}},Jl=(f,e,r,l)=>{const u=c.K();c.bN(u,0,f.width,f.height,0,0,1);const p=f.context.gl;return{u_matrix:u,u_world:[p.drawingBufferWidth,p.drawingBufferHeight],u_image:r,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},yn=(f,e,r)=>{const l=r.paint.get("hillshade-shadow-color"),u=r.paint.get("hillshade-highlight-color"),p=r.paint.get("hillshade-accent-color");let y=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);return r.paint.get("hillshade-illumination-anchor")==="viewport"&&(y+=f.transform.bearingInRadians),{u_image:0,u_latrange:Hu(0,e.tileID),u_light:[r.paint.get("hillshade-exaggeration"),y],u_shadow:l,u_highlight:u,u_accent:p}},Wu=(f,e)=>{const r=e.stride,l=c.K();return c.bN(l,0,c.Z,-8192,0,0,1),c.L(l,l,[0,-8192,0]),{u_matrix:l,u_image:1,u_dimension:[r,r],u_zoom:f.overscaledZ,u_unpack:e.getUnpackVector()}};function Hu(f,e){const r=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new c.$(0,l/r).toLngLat().lat,new c.$(0,(l+1)/r).toLngLat().lat]}const vn=(f,e,r,l)=>{const u=f.transform;return{u_translation:Ql(f,e,r),u_ratio:l/c.av(e,1,u.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},Xd=(f,e,r,l,u)=>c.e(vn(f,e,r,l),{u_image:0,u_image_height:u}),Ea=(f,e,r,l,u)=>{const p=f.transform,y=Xu(e,p);return{u_translation:Ql(f,e,r),u_texsize:e.imageAtlasTexture.size,u_ratio:l/c.av(e,1,p.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[y,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},Kd=(f,e,r,l,u,p)=>{const y=f.lineAtlas,x=Xu(e,f.transform),S=r.layout.get("line-cap")==="round",k=y.getDash(u.from,S),E=y.getDash(u.to,S),z=k.width*p.fromScale,D=E.width*p.toScale;return c.e(vn(f,e,r,l),{u_patternscale_a:[x/z,-k.height/2],u_patternscale_b:[x/D,-E.height/2],u_sdfgamma:y.width/(256*Math.min(z,D)*f.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:E.y,u_mix:p.t})};function Xu(f,e){return 1/c.av(f,1,e.tileZoom)}function Ql(f,e,r){return c.aw(f.transform,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const Ku=(f,e,r,l,u)=>{return{u_tl_parent:f,u_scale_parent:e,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(y=l.paint.get("raster-saturation"),y>0?1-1/(1.001-y):-y),u_contrast_factor:(p=l.paint.get("raster-contrast"),p>0?1/(1-p):1+p),u_spin_weights:Yu(l.paint.get("raster-hue-rotate")),u_coords_top:[u[0].x,u[0].y,u[1].x,u[1].y],u_coords_bottom:[u[3].x,u[3].y,u[2].x,u[2].y]};var p,y};function Yu(f){f*=Math.PI/180;const e=Math.sin(f),r=Math.cos(f);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}const Aa=(f,e,r,l,u,p,y,x,S,k,E,z,D)=>{const $=y.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:$.cameraToCenterDistance,u_pitch:$.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:$.width/$.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_label_plane_matrix:x,u_coord_matrix:S,u_is_text:+E,u_pitch_with_map:+l,u_is_along_line:u,u_is_variable_anchor:p,u_texsize:z,u_texture:0,u_translation:k,u_pitched_scale:D}},ec=(f,e,r,l,u,p,y,x,S,k,E,z,D,$)=>{const N=y.transform;return c.e(Aa(f,e,r,l,u,p,y,x,S,k,E,z,$),{u_gamma_scale:l?Math.cos(N.pitch*Math.PI/180)*N.cameraToCenterDistance:1,u_device_pixel_ratio:y.pixelRatio,u_is_halo:1})},za=(f,e,r,l,u,p,y,x,S,k,E,z,D)=>c.e(ec(f,e,r,l,u,p,y,x,S,k,!0,E,0,D),{u_texsize_icon:z,u_texture_icon:1}),$i=(f,e)=>({u_opacity:f,u_color:e}),tc=(f,e,r,l,u)=>c.e(function(p,y,x,S){const k=x.imageManager.getPattern(p.from.toString()),E=x.imageManager.getPattern(p.to.toString()),{width:z,height:D}=x.imageManager.getPixelSize(),$=Math.pow(2,S.tileID.overscaledZ),N=S.tileSize*Math.pow(2,x.transform.tileZoom)/$,J=N*(S.tileID.canonical.x+S.tileID.wrap*$),Y=N*S.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:E.tl,u_pattern_br_b:E.br,u_texsize:[z,D],u_mix:y.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:E.displaySize,u_scale_a:y.fromScale,u_scale_b:y.toScale,u_tile_units_to_pixels:1/c.av(S,1,x.transform.tileZoom),u_pixel_coord_upper:[J>>16,Y>>16],u_pixel_coord_lower:[65535&J,65535&Y]}}(r,u,e,l),{u_opacity:f}),Ra=(f,e)=>{},rc={fillExtrusion:(f,e)=>({u_lightpos:new c.bI(f,e.u_lightpos),u_lightpos_globe:new c.bI(f,e.u_lightpos_globe),u_lightintensity:new c.b7(f,e.u_lightintensity),u_lightcolor:new c.bI(f,e.u_lightcolor),u_vertical_gradient:new c.b7(f,e.u_vertical_gradient),u_opacity:new c.b7(f,e.u_opacity),u_fill_translate:new c.bJ(f,e.u_fill_translate)}),fillExtrusionPattern:(f,e)=>({u_lightpos:new c.bI(f,e.u_lightpos),u_lightpos_globe:new c.bI(f,e.u_lightpos_globe),u_lightintensity:new c.b7(f,e.u_lightintensity),u_lightcolor:new c.bI(f,e.u_lightcolor),u_vertical_gradient:new c.b7(f,e.u_vertical_gradient),u_height_factor:new c.b7(f,e.u_height_factor),u_opacity:new c.b7(f,e.u_opacity),u_fill_translate:new c.bJ(f,e.u_fill_translate),u_image:new c.bE(f,e.u_image),u_texsize:new c.bJ(f,e.u_texsize),u_pixel_coord_upper:new c.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bJ(f,e.u_pixel_coord_lower),u_scale:new c.bI(f,e.u_scale),u_fade:new c.b7(f,e.u_fade)}),fill:(f,e)=>({u_fill_translate:new c.bJ(f,e.u_fill_translate)}),fillPattern:(f,e)=>({u_image:new c.bE(f,e.u_image),u_texsize:new c.bJ(f,e.u_texsize),u_pixel_coord_upper:new c.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bJ(f,e.u_pixel_coord_lower),u_scale:new c.bI(f,e.u_scale),u_fade:new c.b7(f,e.u_fade),u_fill_translate:new c.bJ(f,e.u_fill_translate)}),fillOutline:(f,e)=>({u_world:new c.bJ(f,e.u_world),u_fill_translate:new c.bJ(f,e.u_fill_translate)}),fillOutlinePattern:(f,e)=>({u_world:new c.bJ(f,e.u_world),u_image:new c.bE(f,e.u_image),u_texsize:new c.bJ(f,e.u_texsize),u_pixel_coord_upper:new c.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bJ(f,e.u_pixel_coord_lower),u_scale:new c.bI(f,e.u_scale),u_fade:new c.b7(f,e.u_fade),u_fill_translate:new c.bJ(f,e.u_fill_translate)}),circle:(f,e)=>({u_camera_to_center_distance:new c.b7(f,e.u_camera_to_center_distance),u_scale_with_map:new c.bE(f,e.u_scale_with_map),u_pitch_with_map:new c.bE(f,e.u_pitch_with_map),u_extrude_scale:new c.bJ(f,e.u_extrude_scale),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.b7(f,e.u_globe_extrude_scale),u_translate:new c.bJ(f,e.u_translate)}),collisionBox:(f,e)=>({u_pixel_extrude_scale:new c.bJ(f,e.u_pixel_extrude_scale)}),collisionCircle:(f,e)=>({u_viewport_size:new c.bJ(f,e.u_viewport_size)}),debug:(f,e)=>({u_color:new c.bF(f,e.u_color),u_overlay:new c.bE(f,e.u_overlay),u_overlay_scale:new c.b7(f,e.u_overlay_scale)}),depth:Ra,clippingMask:Ra,heatmap:(f,e)=>({u_extrude_scale:new c.b7(f,e.u_extrude_scale),u_intensity:new c.b7(f,e.u_intensity),u_globe_extrude_scale:new c.b7(f,e.u_globe_extrude_scale)}),heatmapTexture:(f,e)=>({u_matrix:new c.bG(f,e.u_matrix),u_world:new c.bJ(f,e.u_world),u_image:new c.bE(f,e.u_image),u_color_ramp:new c.bE(f,e.u_color_ramp),u_opacity:new c.b7(f,e.u_opacity)}),hillshade:(f,e)=>({u_image:new c.bE(f,e.u_image),u_latrange:new c.bJ(f,e.u_latrange),u_light:new c.bJ(f,e.u_light),u_shadow:new c.bF(f,e.u_shadow),u_highlight:new c.bF(f,e.u_highlight),u_accent:new c.bF(f,e.u_accent)}),hillshadePrepare:(f,e)=>({u_matrix:new c.bG(f,e.u_matrix),u_image:new c.bE(f,e.u_image),u_dimension:new c.bJ(f,e.u_dimension),u_zoom:new c.b7(f,e.u_zoom),u_unpack:new c.bH(f,e.u_unpack)}),line:(f,e)=>({u_translation:new c.bJ(f,e.u_translation),u_ratio:new c.b7(f,e.u_ratio),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bJ(f,e.u_units_to_pixels)}),lineGradient:(f,e)=>({u_translation:new c.bJ(f,e.u_translation),u_ratio:new c.b7(f,e.u_ratio),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bJ(f,e.u_units_to_pixels),u_image:new c.bE(f,e.u_image),u_image_height:new c.b7(f,e.u_image_height)}),linePattern:(f,e)=>({u_translation:new c.bJ(f,e.u_translation),u_texsize:new c.bJ(f,e.u_texsize),u_ratio:new c.b7(f,e.u_ratio),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_image:new c.bE(f,e.u_image),u_units_to_pixels:new c.bJ(f,e.u_units_to_pixels),u_scale:new c.bI(f,e.u_scale),u_fade:new c.b7(f,e.u_fade)}),lineSDF:(f,e)=>({u_translation:new c.bJ(f,e.u_translation),u_ratio:new c.b7(f,e.u_ratio),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bJ(f,e.u_units_to_pixels),u_patternscale_a:new c.bJ(f,e.u_patternscale_a),u_patternscale_b:new c.bJ(f,e.u_patternscale_b),u_sdfgamma:new c.b7(f,e.u_sdfgamma),u_image:new c.bE(f,e.u_image),u_tex_y_a:new c.b7(f,e.u_tex_y_a),u_tex_y_b:new c.b7(f,e.u_tex_y_b),u_mix:new c.b7(f,e.u_mix)}),raster:(f,e)=>({u_tl_parent:new c.bJ(f,e.u_tl_parent),u_scale_parent:new c.b7(f,e.u_scale_parent),u_buffer_scale:new c.b7(f,e.u_buffer_scale),u_fade_t:new c.b7(f,e.u_fade_t),u_opacity:new c.b7(f,e.u_opacity),u_image0:new c.bE(f,e.u_image0),u_image1:new c.bE(f,e.u_image1),u_brightness_low:new c.b7(f,e.u_brightness_low),u_brightness_high:new c.b7(f,e.u_brightness_high),u_saturation_factor:new c.b7(f,e.u_saturation_factor),u_contrast_factor:new c.b7(f,e.u_contrast_factor),u_spin_weights:new c.bI(f,e.u_spin_weights),u_coords_top:new c.bH(f,e.u_coords_top),u_coords_bottom:new c.bH(f,e.u_coords_bottom)}),symbolIcon:(f,e)=>({u_is_size_zoom_constant:new c.bE(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bE(f,e.u_is_size_feature_constant),u_size_t:new c.b7(f,e.u_size_t),u_size:new c.b7(f,e.u_size),u_camera_to_center_distance:new c.b7(f,e.u_camera_to_center_distance),u_pitch:new c.b7(f,e.u_pitch),u_rotate_symbol:new c.bE(f,e.u_rotate_symbol),u_aspect_ratio:new c.b7(f,e.u_aspect_ratio),u_fade_change:new c.b7(f,e.u_fade_change),u_label_plane_matrix:new c.bG(f,e.u_label_plane_matrix),u_coord_matrix:new c.bG(f,e.u_coord_matrix),u_is_text:new c.bE(f,e.u_is_text),u_pitch_with_map:new c.bE(f,e.u_pitch_with_map),u_is_along_line:new c.bE(f,e.u_is_along_line),u_is_variable_anchor:new c.bE(f,e.u_is_variable_anchor),u_texsize:new c.bJ(f,e.u_texsize),u_texture:new c.bE(f,e.u_texture),u_translation:new c.bJ(f,e.u_translation),u_pitched_scale:new c.b7(f,e.u_pitched_scale)}),symbolSDF:(f,e)=>({u_is_size_zoom_constant:new c.bE(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bE(f,e.u_is_size_feature_constant),u_size_t:new c.b7(f,e.u_size_t),u_size:new c.b7(f,e.u_size),u_camera_to_center_distance:new c.b7(f,e.u_camera_to_center_distance),u_pitch:new c.b7(f,e.u_pitch),u_rotate_symbol:new c.bE(f,e.u_rotate_symbol),u_aspect_ratio:new c.b7(f,e.u_aspect_ratio),u_fade_change:new c.b7(f,e.u_fade_change),u_label_plane_matrix:new c.bG(f,e.u_label_plane_matrix),u_coord_matrix:new c.bG(f,e.u_coord_matrix),u_is_text:new c.bE(f,e.u_is_text),u_pitch_with_map:new c.bE(f,e.u_pitch_with_map),u_is_along_line:new c.bE(f,e.u_is_along_line),u_is_variable_anchor:new c.bE(f,e.u_is_variable_anchor),u_texsize:new c.bJ(f,e.u_texsize),u_texture:new c.bE(f,e.u_texture),u_gamma_scale:new c.b7(f,e.u_gamma_scale),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_is_halo:new c.bE(f,e.u_is_halo),u_translation:new c.bJ(f,e.u_translation),u_pitched_scale:new c.b7(f,e.u_pitched_scale)}),symbolTextAndIcon:(f,e)=>({u_is_size_zoom_constant:new c.bE(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bE(f,e.u_is_size_feature_constant),u_size_t:new c.b7(f,e.u_size_t),u_size:new c.b7(f,e.u_size),u_camera_to_center_distance:new c.b7(f,e.u_camera_to_center_distance),u_pitch:new c.b7(f,e.u_pitch),u_rotate_symbol:new c.bE(f,e.u_rotate_symbol),u_aspect_ratio:new c.b7(f,e.u_aspect_ratio),u_fade_change:new c.b7(f,e.u_fade_change),u_label_plane_matrix:new c.bG(f,e.u_label_plane_matrix),u_coord_matrix:new c.bG(f,e.u_coord_matrix),u_is_text:new c.bE(f,e.u_is_text),u_pitch_with_map:new c.bE(f,e.u_pitch_with_map),u_is_along_line:new c.bE(f,e.u_is_along_line),u_is_variable_anchor:new c.bE(f,e.u_is_variable_anchor),u_texsize:new c.bJ(f,e.u_texsize),u_texsize_icon:new c.bJ(f,e.u_texsize_icon),u_texture:new c.bE(f,e.u_texture),u_texture_icon:new c.bE(f,e.u_texture_icon),u_gamma_scale:new c.b7(f,e.u_gamma_scale),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_is_halo:new c.bE(f,e.u_is_halo),u_translation:new c.bJ(f,e.u_translation),u_pitched_scale:new c.b7(f,e.u_pitched_scale)}),background:(f,e)=>({u_opacity:new c.b7(f,e.u_opacity),u_color:new c.bF(f,e.u_color)}),backgroundPattern:(f,e)=>({u_opacity:new c.b7(f,e.u_opacity),u_image:new c.bE(f,e.u_image),u_pattern_tl_a:new c.bJ(f,e.u_pattern_tl_a),u_pattern_br_a:new c.bJ(f,e.u_pattern_br_a),u_pattern_tl_b:new c.bJ(f,e.u_pattern_tl_b),u_pattern_br_b:new c.bJ(f,e.u_pattern_br_b),u_texsize:new c.bJ(f,e.u_texsize),u_mix:new c.b7(f,e.u_mix),u_pattern_size_a:new c.bJ(f,e.u_pattern_size_a),u_pattern_size_b:new c.bJ(f,e.u_pattern_size_b),u_scale_a:new c.b7(f,e.u_scale_a),u_scale_b:new c.b7(f,e.u_scale_b),u_pixel_coord_upper:new c.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bJ(f,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.b7(f,e.u_tile_units_to_pixels)}),terrain:(f,e)=>({u_texture:new c.bE(f,e.u_texture),u_ele_delta:new c.b7(f,e.u_ele_delta),u_fog_matrix:new c.bG(f,e.u_fog_matrix),u_fog_color:new c.bF(f,e.u_fog_color),u_fog_ground_blend:new c.b7(f,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.b7(f,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bF(f,e.u_horizon_color),u_horizon_fog_blend:new c.b7(f,e.u_horizon_fog_blend),u_is_globe_mode:new c.b7(f,e.u_is_globe_mode)}),terrainDepth:(f,e)=>({u_ele_delta:new c.b7(f,e.u_ele_delta)}),terrainCoords:(f,e)=>({u_texture:new c.bE(f,e.u_texture),u_terrain_coords_id:new c.b7(f,e.u_terrain_coords_id),u_ele_delta:new c.b7(f,e.u_ele_delta)}),projectionErrorMeasurement:(f,e)=>({u_input:new c.b7(f,e.u_input),u_output_expected:new c.b7(f,e.u_output_expected)}),atmosphere:(f,e)=>({u_sun_pos:new c.bI(f,e.u_sun_pos),u_atmosphere_blend:new c.b7(f,e.u_atmosphere_blend),u_globe_position:new c.bI(f,e.u_globe_position),u_globe_radius:new c.b7(f,e.u_globe_radius),u_inv_proj_matrix:new c.bG(f,e.u_inv_proj_matrix)}),sky:(f,e)=>({u_sky_color:new c.bF(f,e.u_sky_color),u_horizon_color:new c.bF(f,e.u_horizon_color),u_horizon:new c.bJ(f,e.u_horizon),u_horizon_normal:new c.bJ(f,e.u_horizon_normal),u_sky_horizon_blend:new c.b7(f,e.u_sky_horizon_blend),u_sky_blend:new c.b7(f,e.u_sky_blend)})};class Ju{constructor(e,r,l){this.context=e;const u=e.gl;this.buffer=u.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const r=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const oc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class bn{constructor(e,r,l,u){this.length=r.length,this.attributes=l,this.itemSize=r.bytesPerElement,this.dynamicDraw=u,this.context=e;const p=e.gl;this.buffer=p.createBuffer(),e.bindVertexBuffer.set(this.buffer),p.bufferData(p.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,r){for(let l=0;l<this.attributes.length;l++){const u=r.attributes[this.attributes[l].name];u!==void 0&&e.enableVertexAttribArray(u)}}setVertexAttribPointers(e,r,l){for(let u=0;u<this.attributes.length;u++){const p=this.attributes[u],y=r.attributes[p.name];y!==void 0&&e.vertexAttribPointer(y,p.components,e[oc[p.type]],!1,this.itemSize,p.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Yt{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Yd extends Yt{getDefault(){return c.b6.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Jd extends Yt{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Qd extends Yt{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class ef extends Yt{getDefault(){return[!0,!0,!0,!0]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Qu extends Yt{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class tf extends Yt{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class eh extends Yt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const r=this.current;(e.func!==r.func||e.ref!==r.ref||e.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Da extends Yt{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Ba extends Yt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=e,this.dirty=!1}}class La extends Yt{getDefault(){return[0,1]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class ic extends Yt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=e,this.dirty=!1}}class xn extends Yt{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Qn extends Yt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.BLEND):r.disable(r.BLEND),this.current=e,this.dirty=!1}}class ci extends Yt{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class th extends Yt{getDefault(){return c.b6.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class rh extends Yt{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class nc extends Yt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=e,this.dirty=!1}}class wn extends Yt{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Fa extends Yt{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Oa extends Yt{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class js extends Yt{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class $a extends Yt{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class oh extends Yt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class es extends Yt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ts extends Yt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class ih extends Yt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class sc extends Yt{getDefault(){return null}set(e){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Kt extends Yt{getDefault(){return null}set(e){var r;if(e===this.current&&!this.dirty)return;const l=this.gl;li(l)?l.bindVertexArray(e):(r=l.getExtension("OES_vertex_array_object"))===null||r===void 0||r.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class ja extends Yt{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class rf extends Yt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class nh extends Yt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Cn extends Yt{constructor(e,r){super(e),this.context=e,this.parent=r}getDefault(){return null}}class of extends Cn{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class nf extends Cn{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class sh extends Cn{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const ah="Framebuffer is not complete";class ac{constructor(e,r,l,u,p){this.context=e,this.width=r,this.height=l;const y=e.gl,x=this.framebuffer=y.createFramebuffer();if(this.colorAttachment=new of(e,x),u)this.depthAttachment=p?new sh(e,x):new nf(e,x);else if(p)throw new Error("Stencil cannot be set without depth");if(y.checkFramebufferStatus(y.FRAMEBUFFER)!==y.FRAMEBUFFER_COMPLETE)throw new Error(ah)}destroy(){const e=this.context.gl,r=this.colorAttachment.get();if(r&&e.deleteTexture(r),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class Na{constructor(e){var r,l;if(this.gl=e,this.clearColor=new Yd(this),this.clearDepth=new Jd(this),this.clearStencil=new Qd(this),this.colorMask=new ef(this),this.depthMask=new Qu(this),this.stencilMask=new tf(this),this.stencilFunc=new eh(this),this.stencilOp=new Da(this),this.stencilTest=new Ba(this),this.depthRange=new La(this),this.depthTest=new ic(this),this.depthFunc=new xn(this),this.blend=new Qn(this),this.blendFunc=new ci(this),this.blendColor=new th(this),this.blendEquation=new rh(this),this.cullFace=new nc(this),this.cullFaceSide=new wn(this),this.frontFace=new Fa(this),this.program=new Oa(this),this.activeTexture=new js(this),this.viewport=new $a(this),this.bindFramebuffer=new oh(this),this.bindRenderbuffer=new es(this),this.bindTexture=new ts(this),this.bindVertexBuffer=new ih(this),this.bindElementBuffer=new sc(this),this.bindVertexArray=new Kt(this),this.pixelStoreUnpack=new ja(this),this.pixelStoreUnpackPremultiplyAlpha=new rf(this),this.pixelStoreUnpackFlipY=new nh(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),li(e)){this.HALF_FLOAT=e.HALF_FLOAT;const u=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=e.RGBA16F)!==null&&r!==void 0?r:u==null?void 0:u.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:u==null?void 0:u.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const u=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=u==null?void 0:u.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r){return new Ju(this,e,r)}createVertexBuffer(e,r,l){return new bn(this,e,r,l)}createRenderbuffer(e,r,l){const u=this.gl,p=u.createRenderbuffer();return this.bindRenderbuffer.set(p),u.renderbufferStorage(u.RENDERBUFFER,e,r,l),this.bindRenderbuffer.set(null),p}createFramebuffer(e,r,l,u){return new ac(this,e,r,l,u)}clear({color:e,depth:r,stencil:l}){const u=this.gl;let p=0;e&&(p|=u.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),r!==void 0&&(p|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),l!==void 0&&(p|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),u.clear(p)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bB(e.blendFunction,yr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return li(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var r;return li(this.gl)?this.gl.deleteVertexArray(e):(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Sn;function Va(f,e,r,l,u){const p=f.context,y=f.transform,x=p.gl,S=f.useProgram("collisionBox"),k=[];let E=0,z=0;for(let Q=0;Q<l.length;Q++){const re=l[Q],ne=e.getTile(re).getBucket(r);if(!ne)continue;const ae=u?ne.textCollisionBox:ne.iconCollisionBox,ce=ne.collisionCircleArray;ce.length>0&&(k.push({circleArray:ce,circleOffset:z,coord:re}),E+=ce.length/4,z=E),ae&&S.draw(p,x.LINES,Dt.disabled,Wt.disabled,f.colorModeForRenderPass(),Gt.disabled,Xl(f.transform),f.style.map.terrain&&f.style.map.terrain.getTerrainData(re),y.getProjectionData({overscaledTileID:re,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),r.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,null,f.transform.zoom,null,null,ae.collisionVertexBuffer)}if(!u||!k.length)return;const D=f.useProgram("collisionCircle"),$=new c.bO;$.resize(4*E),$._trim();let N=0;for(const Q of k)for(let re=0;re<Q.circleArray.length/4;re++){const ne=4*re,ae=Q.circleArray[ne+0],ce=Q.circleArray[ne+1],de=Q.circleArray[ne+2],ue=Q.circleArray[ne+3];$.emplace(N++,ae,ce,de,ue,0),$.emplace(N++,ae,ce,de,ue,1),$.emplace(N++,ae,ce,de,ue,2),$.emplace(N++,ae,ce,de,ue,3)}(!Sn||Sn.length<2*E)&&(Sn=function(Q){const re=2*Q,ne=new c.bQ;ne.resize(re),ne._trim();for(let ae=0;ae<re;ae++){const ce=6*ae;ne.uint16[ce+0]=4*ae+0,ne.uint16[ce+1]=4*ae+1,ne.uint16[ce+2]=4*ae+2,ne.uint16[ce+3]=4*ae+2,ne.uint16[ce+4]=4*ae+3,ne.uint16[ce+5]=4*ae+0}return ne}(E));const J=p.createIndexBuffer(Sn,!0),Y=p.createVertexBuffer($,c.bP.members,!0);for(const Q of k){const re=qu(f.transform);D.draw(p,x.TRIANGLES,Dt.disabled,Wt.disabled,f.colorModeForRenderPass(),Gt.disabled,re,f.style.map.terrain&&f.style.map.terrain.getTerrainData(Q.coord),null,r.id,Y,J,c.aF.simpleSegment(0,2*Q.circleOffset,Q.circleArray.length,Q.circleArray.length/2),null,f.transform.zoom,null,null,null)}Y.destroy(),J.destroy()}const lc=c.as(new Float32Array(16));function lh(f,e,r,l,u,p){const{horizontalAlign:y,verticalAlign:x}=c.aA(f);return new c.P((-(y-.5)*e/u+l[0])*p,(-(x-.5)*r/u+l[1])*p)}function Ua(f,e,r,l,u,p){const y=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let x=l.mult(p);r||(x=x.rotate(-u));const S=y.add(x);return Pe(S.x,S.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(r){const x=dt(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(f),S=Math.atan(x.y/x.x)+(x.x<0?Math.PI:0);return f.add(l.rotate(S))}return f.add(l)}function Za(f,e,r,l,u,p,y,x,S,k,E,z){const D=f.text.placedSymbolArray,$=f.text.dynamicLayoutVertexArray,N=f.icon.dynamicLayoutVertexArray,J={};$.clear();for(let Y=0;Y<D.length;Y++){const Q=D.get(Y),re=Q.hidden||!Q.crossTileID||f.allowVerticalPlacement&&!Q.placedOrientation?null:l[Q.crossTileID];if(re){const ne=new c.P(Q.anchorX,Q.anchorY),ae={getElevation:z,width:u.width,height:u.height,pitchedLabelPlaneMatrix:p,pitchWithMap:r,transform:u,tileAnchorPoint:ne,translation:k,unwrappedTileID:E},ce=r?Lt(ne.x,ne.y,ae):dt(ne.x,ne.y,ae),de=ve(u.cameraToCenterDistance,ce.signedDistanceFromCamera);let ue=c.ah(f.textSizeData,x,Q)*de/c.au;r&&(ue*=f.tilePixelRatio/y);const{width:xe,height:Ce,anchor:Ee,textOffset:Re,textBoxScale:Ie}=re,Ke=lh(Ee,xe,Ce,Re,Ie,ue),He=u.getPitchedTextCorrection(ne.x+k[0],ne.y+k[1],E),$e=Ua(ce.point,ae,e,Ke,-u.bearingInRadians,He),ft=f.allowVerticalPlacement&&Q.placedOrientation===c.ag.vertical?Math.PI/2:0;for(let yt=0;yt<Q.numGlyphs;yt++)c.an($,$e,ft);S&&Q.associatedIconIndex>=0&&(J[Q.associatedIconIndex]={shiftedAnchor:$e,angle:ft})}else Nr(Q.numGlyphs,$)}if(S){N.clear();const Y=f.icon.placedSymbolArray;for(let Q=0;Q<Y.length;Q++){const re=Y.get(Q);if(re.hidden)Nr(re.numGlyphs,N);else{const ne=J[Q];if(ne)for(let ae=0;ae<re.numGlyphs;ae++)c.an(N,ne.shiftedAnchor,ne.angle);else Nr(re.numGlyphs,N)}}f.icon.dynamicLayoutVertexBuffer.updateData(N)}f.text.dynamicLayoutVertexBuffer.updateData($)}function cc(f,e,r){return r.iconsInText&&e?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function ch(f,e,r,l,u,p,y,x,S,k,E,z,D){const $=f.context,N=$.gl,J=f.transform,Y=x==="map",Q=S==="map",re=x!=="viewport"&&r.layout.get("symbol-placement")!=="point",ne=Y&&!Q&&!re,ae=!r.layout.get("symbol-sort-key").isConstant();let ce=!1;const de=f.getDepthModeForSublayer(0,Dt.ReadOnly),ue=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),xe=[],Ce=J.getCircleRadiusCorrection();for(const Ee of l){const Re=e.getTile(Ee),Ie=Re.getBucket(r);if(!Ie)continue;const Ke=u?Ie.text:Ie.icon;if(!Ke||!Ke.segments.get().length||!Ke.hasVisibleVertices)continue;const He=Ke.programConfigurations.get(r.id),$e=u||Ie.sdfIcons,ft=u?Ie.textSizeData:Ie.iconSizeData,yt=Q||J.pitch!==0,Jt=f.useProgram(cc($e,u,Ie),He),cr=c.af(ft,J.zoom),ir=f.style.map.terrain&&f.style.map.terrain.getTerrainData(Ee);let br,pr,er,nr,io=[0,0],no=null;if(u)pr=Re.glyphAtlasTexture,er=N.LINEAR,br=Re.glyphAtlasTexture.size,Ie.iconsInText&&(io=Re.imageAtlasTexture.size,no=Re.imageAtlasTexture,nr=yt||f.options.rotating||f.options.zooming||ft.kind==="composite"||ft.kind==="camera"?N.LINEAR:N.NEAREST);else{const ur=r.layout.get("icon-size").constantOr(0)!==1||Ie.iconsNeedLinear;pr=Re.imageAtlasTexture,er=$e||f.options.rotating||f.options.zooming||ur||yt?N.LINEAR:N.NEAREST,br=Re.imageAtlasTexture.size}const Hr=c.av(Re,1,f.transform.zoom),fo=Se(Y,f.transform,Hr),nn=c.K();c.ai(nn,fo);const Ni=me(Q,Y,f.transform,Hr),zi=c.aw(J,Re,p,y),di=J.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!D,applyTerrainMatrix:!0}),En=ue&&Ie.hasTextData(),Ys=r.layout.get("icon-text-fit")!=="none"&&En&&Ie.hasIconData();if(re){const ur=f.style.map.terrain?(Xr,Kr)=>f.style.map.terrain.getElevation(Ee,Xr,Kr):null,ar=r.layout.get("text-rotation-alignment")==="map";be(Ie,f,u,fo,nn,Q,k,ar,Ee.toUnwrapped(),J.width,J.height,zi,ur)}const An=u&&ue||Ys,fi=re||An?lc:Q?fo:f.transform.clipSpaceToPixelsMatrix,Ri=$e&&r.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let bi;bi=$e?Ie.iconsInText?za(ft.kind,cr,ne,Q,re,An,f,fi,Ni,zi,br,io,Ce):ec(ft.kind,cr,ne,Q,re,An,f,fi,Ni,zi,u,br,0,Ce):Aa(ft.kind,cr,ne,Q,re,An,f,fi,Ni,zi,u,br,Ce);const Di={program:Jt,buffers:Ke,uniformValues:bi,projectionData:di,atlasTexture:pr,atlasTextureIcon:no,atlasInterpolation:er,atlasInterpolationIcon:nr,isSDF:$e,hasHalo:Ri};if(ae&&Ie.canOverlap){ce=!0;const ur=Ke.segments.get();for(const ar of ur)xe.push({segments:new c.aF([ar]),sortKey:ar.sortKey,state:Di,terrainData:ir})}else xe.push({segments:Ke.segments,sortKey:0,state:Di,terrainData:ir})}ce&&xe.sort((Ee,Re)=>Ee.sortKey-Re.sortKey);for(const Ee of xe){const Re=Ee.state;if($.activeTexture.set(N.TEXTURE0),Re.atlasTexture.bind(Re.atlasInterpolation,N.CLAMP_TO_EDGE),Re.atlasTextureIcon&&($.activeTexture.set(N.TEXTURE1),Re.atlasTextureIcon&&Re.atlasTextureIcon.bind(Re.atlasInterpolationIcon,N.CLAMP_TO_EDGE)),Re.isSDF){const Ie=Re.uniformValues;Re.hasHalo&&(Ie.u_is_halo=1,Ga(Re.buffers,Ee.segments,r,f,Re.program,de,E,z,Ie,Re.projectionData,Ee.terrainData)),Ie.u_is_halo=0}Ga(Re.buffers,Ee.segments,r,f,Re.program,de,E,z,Re.uniformValues,Re.projectionData,Ee.terrainData)}}function Ga(f,e,r,l,u,p,y,x,S,k,E){const z=l.context;u.draw(z,z.gl.TRIANGLES,p,y,x,Gt.backCCW,S,E,k,r.id,f.layoutVertexBuffer,f.indexBuffer,e,r.paint,l.transform.zoom,f.programConfigurations.get(r.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function sf(f,e,r,l,u){const p=f.context,y=p.gl,x=Wt.disabled,S=new yr([y.ONE,y.ONE],c.b6.transparent,[!0,!0,!0,!0]),k=e.getBucket(r);if(!k)return;const E=l.key;let z=r.heatmapFbos.get(E);z||(z=Ns(p,e.tileSize,e.tileSize),r.heatmapFbos.set(E,z)),p.bindFramebuffer.set(z.framebuffer),p.viewport.set([0,0,e.tileSize,e.tileSize]),p.clear({color:c.b6.transparent});const D=k.programConfigurations.get(r.id),$=f.useProgram("heatmap",D,!u),N=f.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),J=f.style.map.terrain.getTerrainData(l);$.draw(p,y.TRIANGLES,Dt.disabled,x,S,Gt.disabled,Yl(e,f.transform.zoom,r.paint.get("heatmap-intensity"),1),J,N,r.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,r.paint,f.transform.zoom,D)}function uh(f,e,r,l,u){const p=f.context,y=p.gl,x=f.transform;p.setColorMode(f.colorModeForRenderPass());const S=qa(p,e),k=r.key,E=e.heatmapFbos.get(k);if(!E)return;p.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,E.colorAttachment.get()),p.activeTexture.set(y.TEXTURE1),S.bind(y.LINEAR,y.CLAMP_TO_EDGE);const z=x.getProjectionData({overscaledTileID:r,applyTerrainMatrix:u,applyGlobeMatrix:!l});f.useProgram("heatmapTexture").draw(p,y.TRIANGLES,Dt.disabled,Wt.disabled,f.colorModeForRenderPass(),Gt.disabled,Jl(f,e,0,1),null,z,e.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,e.paint,x.zoom),E.destroy(),e.heatmapFbos.delete(k)}function Ns(f,e,r){var l,u;const p=f.gl,y=p.createTexture();p.bindTexture(p.TEXTURE_2D,y),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR);const x=(l=f.HALF_FLOAT)!==null&&l!==void 0?l:p.UNSIGNED_BYTE,S=(u=f.RGBA16F)!==null&&u!==void 0?u:p.RGBA;p.texImage2D(p.TEXTURE_2D,0,S,e,r,0,p.RGBA,x,null);const k=f.createFramebuffer(e,r,!1,!1);return k.colorAttachment.set(y),k}function qa(f,e){return e.colorRampTexture||(e.colorRampTexture=new rt(f,e.colorRamp,f.gl.RGBA)),e.colorRampTexture}function uc(f,e,r,l,u){if(!r||!l||!l.imageAtlas)return;const p=l.imageAtlas.patternPositions;let y=p[r.to.toString()],x=p[r.from.toString()];if(!y&&x&&(y=x),!x&&y&&(x=y),!y||!x){const S=u.getPaintProperty(e);y=p[S],x=p[S]}y&&x&&f.setConstantPatternPositions(y,x)}function hc(f,e,r,l,u,p,y,x){const S=f.context.gl,k="fill-pattern",E=r.paint.get(k),z=E&&E.constantOr(1),D=r.getCrossfadeParameters();let $,N,J,Y,Q;const re=f.transform,ne=r.paint.get("fill-translate"),ae=r.paint.get("fill-translate-anchor");y?(N=z&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=S.LINES):(N=z?"fillPattern":"fill",$=S.TRIANGLES);const ce=E.constantOr(null);for(const de of l){const ue=e.getTile(de);if(z&&!ue.patternsLoaded())continue;const xe=ue.getBucket(r);if(!xe)continue;const Ce=xe.programConfigurations.get(r.id),Ee=f.useProgram(N,Ce),Re=f.style.map.terrain&&f.style.map.terrain.getTerrainData(de);z&&(f.context.activeTexture.set(S.TEXTURE0),ue.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),Ce.updatePaintBuffers(D)),uc(Ce,k,ce,ue,r);const Ie=re.getProjectionData({overscaledTileID:de,applyGlobeMatrix:!x,applyTerrainMatrix:!0}),Ke=c.aw(re,ue,ne,ae);if(y){Y=xe.indexBuffer2,Q=xe.segments2;const $e=[S.drawingBufferWidth,S.drawingBufferHeight];J=N==="fillOutlinePattern"&&z?Hd(f,D,ue,$e,Ke):Zu($e,Ke)}else Y=xe.indexBuffer,Q=xe.segments,J=z?Uu(f,D,ue,Ke):{u_fill_translate:Ke};let He;if(f.renderPass==="translucent"&&x){const[$e]=f.getStencilConfigForOverlapAndUpdateStencilID(l);He=$e[de.overscaledZ]}else He=f.stencilModeForClipping(de);Ee.draw(f.context,$,u,He,p,Gt.backCCW,J,Re,Ie,r.id,xe.layoutVertexBuffer,Y,Q,r.paint,f.transform.zoom,Ce)}}function rs(f,e,r,l,u,p,y,x){const S=f.context,k=S.gl,E="fill-extrusion-pattern",z=r.paint.get(E),D=z.constantOr(1),$=r.getCrossfadeParameters(),N=r.paint.get("fill-extrusion-opacity"),J=z.constantOr(null),Y=f.transform;for(const Q of l){const re=e.getTile(Q),ne=re.getBucket(r);if(!ne)continue;const ae=f.style.map.terrain&&f.style.map.terrain.getTerrainData(Q),ce=ne.programConfigurations.get(r.id),de=f.useProgram(D?"fillExtrusionPattern":"fillExtrusion",ce);D&&(f.context.activeTexture.set(k.TEXTURE0),re.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ce.updatePaintBuffers($));const ue=Y.getProjectionData({overscaledTileID:Q,applyGlobeMatrix:!x,applyTerrainMatrix:!0});uc(ce,E,J,re,r);const xe=c.aw(Y,re,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),Ce=r.paint.get("fill-extrusion-vertical-gradient"),Ee=D?Jn(f,Ce,N,xe,Q,$,re):Vu(f,Ce,N,xe);de.draw(S,S.gl.TRIANGLES,u,p,y,Gt.backCCW,Ee,ae,ue,r.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,r.paint,f.transform.zoom,ce,f.style.map.terrain&&ne.centroidVertexBuffer)}}function Vs(f,e,r,l,u,p,y,x,S){var k;const E=f.style.projection,z=f.context,D=f.transform,$=z.gl,N=f.useProgram("hillshade"),J=!f.options.moving;for(const Y of l){const Q=e.getTile(Y),re=Q.fbo;if(!re)continue;const ne=E.getMeshFromTileID(z,Y.canonical,x,!0,"raster"),ae=(k=f.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(Y);z.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,re.colorAttachment.get());const ce=D.getProjectionData({overscaledTileID:Y,aligned:J,applyGlobeMatrix:!S,applyTerrainMatrix:!0});N.draw(z,$.TRIANGLES,p,u[Y.overscaledZ],y,Gt.backCCW,yn(f,Q,r),ae,ce,r.id,ne.vertexBuffer,ne.indexBuffer,ne.segments)}}const dc=[new c.P(0,0),new c.P(c.Z,0),new c.P(c.Z,c.Z),new c.P(0,c.Z)];function Us(f,e,r,l,u,p,y,x,S=!1,k=!1){const E=l[l.length-1].overscaledZ,z=f.context,D=z.gl,$=f.useProgram("raster"),N=f.transform,J=f.style.projection,Y=f.colorModeForRenderPass(),Q=!f.options.moving;for(const re of l){const ne=f.getDepthModeForSublayer(re.overscaledZ-E,r.paint.get("raster-opacity")===1?Dt.ReadWrite:Dt.ReadOnly,D.LESS),ae=e.getTile(re);ae.registerFadeDuration(r.paint.get("raster-fade-duration"));const ce=e.findLoadedParent(re,0),de=e.findLoadedSibling(re),ue=Br(ae,ce||de||null,e,r,f.transform,f.style.map.terrain);let xe,Ce;const Ee=r.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;z.activeTexture.set(D.TEXTURE0),ae.texture.bind(Ee,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),z.activeTexture.set(D.TEXTURE1),ce?(ce.texture.bind(Ee,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),xe=Math.pow(2,ce.tileID.overscaledZ-ae.tileID.overscaledZ),Ce=[ae.tileID.canonical.x*xe%1,ae.tileID.canonical.y*xe%1]):ae.texture.bind(Ee,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),ae.texture.useMipmap&&z.extTextureFilterAnisotropic&&f.transform.pitch>20&&D.texParameterf(D.TEXTURE_2D,z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,z.extTextureFilterAnisotropicMax);const Re=f.style.map.terrain&&f.style.map.terrain.getTerrainData(re),Ie=N.getProjectionData({overscaledTileID:re,aligned:Q,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),Ke=Ku(Ce||[0,0],xe||1,ue,r,x),He=J.getMeshFromTileID(z,re.canonical,p,y,"raster");$.draw(z,D.TRIANGLES,ne,u?u[re.overscaledZ]:Wt.disabled,Y,S?Gt.frontCCW:Gt.backCCW,Ke,Re,Ie,r.id,He.vertexBuffer,He.indexBuffer,He.segments)}}function Br(f,e,r,l,u,p){const y=l.paint.get("raster-fade-duration");if(!p&&y>0){const x=K.now(),S=(x-f.timeAdded)/y,k=e?(x-e.timeAdded)/y:-1,E=r.getSource(),z=oi(u,{tileSize:E.tileSize,roundZoom:E.roundZoom}),D=!e||Math.abs(e.tileID.overscaledZ-z)>Math.abs(f.tileID.overscaledZ-z),$=D&&f.refreshedUponExpiration?1:c.ad(D?S:1-k,0,1);return f.refreshedUponExpiration&&S>=1&&(f.refreshedUponExpiration=!1),e?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}const Tn=new c.b6(1,0,0,1),ui=new c.b6(0,1,0,1),fc=new c.b6(0,0,1,1),pc=new c.b6(1,0,1,1),hh=new c.b6(0,1,1,1);function kn(f,e,r,l){is(f,0,e+r/2,f.transform.width,r,l)}function os(f,e,r,l){is(f,e-r/2,0,r,f.transform.height,l)}function is(f,e,r,l,u,p){const y=f.context,x=y.gl;x.enable(x.SCISSOR_TEST),x.scissor(e*f.pixelRatio,r*f.pixelRatio,l*f.pixelRatio,u*f.pixelRatio),y.clear({color:p}),x.disable(x.SCISSOR_TEST)}function dh(f,e,r){const l=f.context,u=l.gl,p=f.useProgram("debug"),y=Dt.disabled,x=Wt.disabled,S=f.colorModeForRenderPass(),k="$debug",E=f.style.map.terrain&&f.style.map.terrain.getTerrainData(r);l.activeTexture.set(u.TEXTURE0);const z=e.getTileByID(r.key).latestRawTileData,D=Math.floor((z&&z.byteLength||0)/1024),$=e.getTile(r).tileSize,N=512/Math.min($,512)*(r.overscaledZ/f.transform.zoom)*.5;let J=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(J+=` => ${r.overscaledZ}`),function(Q,re){Q.initDebugOverlayCanvas();const ne=Q.debugOverlayCanvas,ae=Q.context.gl,ce=Q.debugOverlayCanvas.getContext("2d");ce.clearRect(0,0,ne.width,ne.height),ce.shadowColor="white",ce.shadowBlur=2,ce.lineWidth=1.5,ce.strokeStyle="white",ce.textBaseline="top",ce.font="bold 36px Open Sans, sans-serif",ce.fillText(re,5,5),ce.strokeText(re,5,5),Q.debugOverlayTexture.update(ne),Q.debugOverlayTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE)}(f,`${J} ${D}kB`);const Y=f.transform.getProjectionData({overscaledTileID:r,applyGlobeMatrix:!0,applyTerrainMatrix:!0});p.draw(l,u.TRIANGLES,y,x,yr.alphaBlended,Gt.disabled,Kl(c.b6.transparent,N),null,Y,k,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),p.draw(l,u.LINE_STRIP,y,x,S,Gt.disabled,Kl(c.b6.red),E,Y,k,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function mc(f,e,r,l){const{isRenderingGlobe:u}=l,p=f.context,y=p.gl,x=f.transform,S=f.colorModeForRenderPass(),k=f.getDepthModeFor3D(),E=f.useProgram("terrain");p.bindFramebuffer.set(null),p.viewport.set([0,0,f.width,f.height]);for(const z of r){const D=e.getTerrainMesh(z.tileID),$=f.renderToTexture.getTexture(z),N=e.getTerrainData(z.tileID);p.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,$.texture);const J=e.getMeshFrameDelta(x.zoom),Y=x.calculateFogMatrix(z.tileID.toUnwrapped()),Q=Hl(J,Y,f.style.sky,x.pitch,u),re=x.getProjectionData({overscaledTileID:z.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});E.draw(p,y.TRIANGLES,k,Wt.disabled,S,Gt.backCCW,Q,N,re,"terrain",D.vertexBuffer,D.indexBuffer,D.segments)}}function gc(f,e){if(!e.mesh){const r=new c.aE;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(1,1),r.emplaceBack(-1,1);const l=new c.aG;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new Zo(f.createVertexBuffer(r,ii.members),f.createIndexBuffer(l),c.aF.simpleSegment(0,0,r.length,l.length))}return e.mesh}class fh{constructor(e,r){this.context=new Na(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.as(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=A.maxUnderzooming+A.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new jl}resize(e,r,l){if(this.width=Math.floor(e*l),this.height=Math.floor(r*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const u of this.style._order)this.style._layers[u].resize()}setup(){const e=this.context,r=new c.aE;r.emplaceBack(0,0),r.emplaceBack(c.Z,0),r.emplaceBack(0,c.Z),r.emplaceBack(c.Z,c.Z),this.tileExtentBuffer=e.createVertexBuffer(r,ii.members),this.tileExtentSegments=c.aF.simpleSegment(0,0,4,2);const l=new c.aE;l.emplaceBack(0,0),l.emplaceBack(c.Z,0),l.emplaceBack(0,c.Z),l.emplaceBack(c.Z,c.Z),this.debugBuffer=e.createVertexBuffer(l,ii.members),this.debugSegments=c.aF.simpleSegment(0,0,4,5);const u=new c.bV;u.emplaceBack(0,0,0,0),u.emplaceBack(c.Z,0,c.Z,0),u.emplaceBack(0,c.Z,0,c.Z),u.emplaceBack(c.Z,c.Z,c.Z,c.Z),this.rasterBoundsBuffer=e.createVertexBuffer(u,Mi.members),this.rasterBoundsSegments=c.aF.simpleSegment(0,0,4,2);const p=new c.aE;p.emplaceBack(0,0),p.emplaceBack(c.Z,0),p.emplaceBack(0,c.Z),p.emplaceBack(c.Z,c.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(p,ii.members),this.rasterBoundsSegmentsPosOnly=c.aF.simpleSegment(0,0,4,5);const y=new c.aE;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(y,ii.members),this.viewportSegments=c.aF.simpleSegment(0,0,4,2);const x=new c.bW;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(x);const S=new c.aG;S.emplaceBack(1,0,2),S.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(S);const k=this.context.gl;this.stencilClearMode=new Wt({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.tileExtentMesh=new Zo(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=c.K();c.bN(l,0,this.width,this.height,0,0,1),c.M(l,l,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const u={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,r.TRIANGLES,Dt.disabled,this.stencilClearMode,yr.disabled,Gt.disabled,null,null,u,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,r,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!r||!r.length)return;this.currentStencilSource=e.source,this.nextStencilID+r.length>256&&this.clearStencil();const u=this.context;u.setColorMode(yr.disabled),u.setDepthMode(Dt.disabled);const p={};for(const y of r)p[y.key]=this.nextStencilID++;this._renderTileMasks(p,r,l,!0),this._renderTileMasks(p,r,l,!1),this._tileClippingMaskIDs=p}_renderTileMasks(e,r,l,u){const p=this.context,y=p.gl,x=this.style.projection,S=this.transform,k=this.useProgram("clippingMask");for(const E of r){const z=e[E.key],D=this.style.map.terrain&&this.style.map.terrain.getTerrainData(E),$=x.getMeshFromTileID(this.context,E.canonical,u,!0,"stencil"),N=S.getProjectionData({overscaledTileID:E,applyGlobeMatrix:!0,applyTerrainMatrix:!0});k.draw(p,y.TRIANGLES,Dt.disabled,new Wt({func:y.ALWAYS,mask:0},z,255,y.KEEP,y.KEEP,y.REPLACE),yr.disabled,l?Gt.disabled:Gt.backCCW,null,D,N,"$clipping",$.vertexBuffer,$.indexBuffer,$.segments)}}_renderTilesDepthBuffer(){const e=this.context,r=e.gl,l=this.style.projection,u=this.transform,p=this.useProgram("depth"),y=this.getDepthModeFor3D(),x=ge(u,{tileSize:u.tileSize});for(const S of x){const k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(S),E=l.getMeshFromTileID(this.context,S.canonical,!0,!0,"raster"),z=u.getProjectionData({overscaledTileID:S,applyGlobeMatrix:!0,applyTerrainMatrix:!0});p.draw(e,r.TRIANGLES,y,Wt.disabled,yr.disabled,Gt.backCCW,null,k,z,"$clipping",E.vertexBuffer,E.indexBuffer,E.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,r=this.context.gl;return new Wt({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){const r=this.context.gl;return new Wt({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const r=this.context.gl,l=e.sort((y,x)=>x.overscaledZ-y.overscaledZ),u=l[l.length-1].overscaledZ,p=l[0].overscaledZ-u+1;if(p>1){this.currentStencilSource=void 0,this.nextStencilID+p>256&&this.clearStencil();const y={};for(let x=0;x<p;x++)y[x+u]=new Wt({func:r.GEQUAL,mask:255},x+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=p,[y,l]}return[{[u]:Wt.disabled},l]}stencilConfigForOverlapTwoPass(e){const r=this.context.gl,l=e.sort((y,x)=>x.overscaledZ-y.overscaledZ),u=l[l.length-1].overscaledZ,p=l[0].overscaledZ-u+1;if(this.clearStencil(),p>1){const y={},x={};for(let S=0;S<p;S++)y[S+u]=new Wt({func:r.GREATER,mask:255},p+1+S,255,r.KEEP,r.KEEP,r.REPLACE),x[S+u]=new Wt({func:r.GREATER,mask:255},1+S,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID=2*p+1,[y,x,l]}return this.nextStencilID=3,[{[u]:new Wt({func:r.GREATER,mask:255},2,255,r.KEEP,r.KEEP,r.REPLACE)},{[u]:new Wt({func:r.GREATER,mask:255},1,255,r.KEEP,r.KEEP,r.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new yr([e.CONSTANT_COLOR,e.ONE],new c.b6(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?yr.unblended:yr.alphaBlended}getDepthModeForSublayer(e,r,l){if(!this.opaquePassEnabledForLayer())return Dt.disabled;const u=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Dt(l||this.context.gl.LEQUAL,r,[u,u])}getDepthModeFor3D(){return new Dt(this.context.gl.LEQUAL,Dt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){var l,u;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(K.now()),this.imageManager.beginFrame();const p=this.style._order,y=this.style.sourceCaches,x={},S={},k={},E={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const D in y){const $=y[D];$.used&&$.prepare(this.context),x[D]=$.getVisibleCoordinates(!1),S[D]=x[D].slice().reverse(),k[D]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let D=0;D<p.length;D++)if(this.style._layers[p[D]].is3D()){this.opaquePassCutoff=D;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const D of p){const $=this.style._layers[D];if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const N=S[$.source];($.type==="custom"||N.length)&&this.renderLayer(this,y[$.source],$,N,E)}if((u=this.style.projection)===null||u===void 0||u.updateGPUdependent({context:this.context,useProgram:D=>this.useProgram(D)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?c.b6.black:c.b6.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(D,$){const N=D.context,J=N.gl,Y=((de,ue,xe)=>{const Ce=Math.cos(ue.rollInRadians),Ee=Math.sin(ue.rollInRadians),Re=ro(ue),Ie=ue.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:de.properties.get("sky-color"),u_horizon_color:de.properties.get("horizon-color"),u_horizon:[(ue.width/2-Re*Ee)*xe,(ue.height/2+Re*Ce)*xe],u_horizon_normal:[-Ee,Ce],u_sky_horizon_blend:de.properties.get("sky-horizon-blend")*ue.height/2*xe,u_sky_blend:Ie}})($,D.style.map.transform,D.pixelRatio),Q=new Dt(J.LEQUAL,Dt.ReadWrite,[0,1]),re=Wt.disabled,ne=D.colorModeForRenderPass(),ae=D.useProgram("sky"),ce=gc(N,$);ae.draw(N,J.TRIANGLES,Q,re,ne,Gt.disabled,Y,null,void 0,"sky",ce.vertexBuffer,ce.indexBuffer,ce.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const D=this.style._layers[p[this.currentLayer]],$=y[D.source],N=x[D.source];this._renderTileClippingMasks(D,N,!1),this.renderLayer(this,$,D,N,E)}this.renderPass="translucent";let z=!1;for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const D=this.style._layers[p[this.currentLayer]],$=y[D.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(D,E))continue;this.opaquePassEnabledForLayer()||z||(z=!0,E.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const N=(D.type==="symbol"?k:S)[D.source];this._renderTileClippingMasks(D,x[D.source],!1),this.renderLayer(this,$,D,N,E)}if(E.isRenderingGlobe&&function(D,$,N){const J=D.context,Y=J.gl,Q=D.useProgram("atmosphere"),re=new Dt(Y.LEQUAL,Dt.ReadOnly,[0,1]),ne=D.transform,ae=function(Ie,Ke){const He=Ie.properties.get("position"),$e=[-He.x,-He.y,-He.z],ft=c.as(new Float64Array(16));return Ie.properties.get("anchor")==="map"&&(c.aZ(ft,ft,Ke.rollInRadians),c.a_(ft,ft,-Ke.pitchInRadians),c.aZ(ft,ft,Ke.bearingInRadians),c.a_(ft,ft,Ke.center.lat*Math.PI/180),c.bl(ft,ft,-Ke.center.lng*Math.PI/180)),c.bU($e,$e,ft),$e}(N,D.transform),ce=ne.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),de=$.properties.get("atmosphere-blend")*ce.projectionTransition;if(de===0)return;const ue=xo(ne.worldSize,ne.center.lat),xe=ne.inverseProjectionMatrix,Ce=new Float64Array(4);Ce[3]=1,c.ao(Ce,Ce,ne.modelViewProjectionMatrix),Ce[0]/=Ce[3],Ce[1]/=Ce[3],Ce[2]/=Ce[3],Ce[3]=1,c.ao(Ce,Ce,xe),Ce[0]/=Ce[3],Ce[1]/=Ce[3],Ce[2]/=Ce[3],Ce[3]=1;const Ee=((Ie,Ke,He,$e,ft)=>({u_sun_pos:Ie,u_atmosphere_blend:Ke,u_globe_position:He,u_globe_radius:$e,u_inv_proj_matrix:ft}))(ae,de,[Ce[0],Ce[1],Ce[2]],ue,xe),Re=gc(J,$);Q.draw(J,Y.TRIANGLES,re,Wt.disabled,yr.alphaBlended,Gt.disabled,Ee,null,null,"atmosphere",Re.vertexBuffer,Re.indexBuffer,Re.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const D=function($,N){let J=null;const Y=Object.values($._layers).flatMap(ae=>ae.source&&!ae.isHidden(N)?[$.sourceCaches[ae.source]]:[]),Q=Y.filter(ae=>ae.getSource().type==="vector"),re=Y.filter(ae=>ae.getSource().type!=="vector"),ne=ae=>{(!J||J.getSource().maxzoom<ae.getSource().maxzoom)&&(J=ae)};return Q.forEach(ae=>ne(ae)),J||re.forEach(ae=>ne(ae)),J}(this.style,this.transform.zoom);D&&function($,N,J){for(let Y=0;Y<J.length;Y++)dh($,N,J[Y])}(this,D,D.getVisibleCoordinates())}this.options.showPadding&&function(D){const $=D.transform.padding;kn(D,D.transform.height-($.top||0),3,Tn),kn(D,$.bottom||0,3,ui),os(D,$.left||0,3,fc),os(D,D.transform.width-($.right||0),3,pc);const N=D.transform.centerPoint;(function(J,Y,Q,re){is(J,Y-1,Q-10,2,20,re),is(J,Y-10,Q-1,20,2,re)})(D,N.x,D.transform.height-N.y,hh)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let u=this.terrainFacilitator.dirty;u||(u=e?!c.bX(r,l):!c.bY(r,l)),u||(u=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),u&&(c.bZ(r,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(p,y){const x=p.context,S=x.gl,k=p.transform,E=yr.unblended,z=new Dt(S.LEQUAL,Dt.ReadWrite,[0,1]),D=y.sourceCache.getRenderableTiles(),$=p.useProgram("terrainDepth");x.bindFramebuffer.set(y.getFramebuffer("depth").framebuffer),x.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),x.clear({color:c.b6.transparent,depth:1});for(const N of D){const J=y.getTerrainMesh(N.tileID),Y=y.getTerrainData(N.tileID),Q=k.getProjectionData({overscaledTileID:N.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),re={u_ele_delta:y.getMeshFrameDelta(k.zoom)};$.draw(x,S.TRIANGLES,z,Wt.disabled,E,Gt.backCCW,re,Y,Q,"terrain",J.vertexBuffer,J.indexBuffer,J.segments)}x.bindFramebuffer.set(null),x.viewport.set([0,0,p.width,p.height])}(this,this.style.map.terrain),function(p,y){const x=p.context,S=x.gl,k=p.transform,E=yr.unblended,z=new Dt(S.LEQUAL,Dt.ReadWrite,[0,1]),D=y.getCoordsTexture(),$=y.sourceCache.getRenderableTiles(),N=p.useProgram("terrainCoords");x.bindFramebuffer.set(y.getFramebuffer("coords").framebuffer),x.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),x.clear({color:c.b6.transparent,depth:1}),y.coordsIndex=[];for(const J of $){const Y=y.getTerrainMesh(J.tileID),Q=y.getTerrainData(J.tileID);x.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,D.texture);const re={u_terrain_coords_id:(255-y.coordsIndex.length)/255,u_texture:0,u_ele_delta:y.getMeshFrameDelta(k.zoom)},ne=k.getProjectionData({overscaledTileID:J.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});N.draw(x,S.TRIANGLES,z,Wt.disabled,E,Gt.backCCW,re,Q,ne,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments),y.coordsIndex.push(J.tileID.key)}x.bindFramebuffer.set(null),x.viewport.set([0,0,p.width,p.height])}(this,this.style.map.terrain))}renderLayer(e,r,l,u,p){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(u||[]).length)&&(this.id=l.id,c.b_(l)?function(y,x,S,k,E,z){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:D}=z,$=Wt.disabled,N=y.colorModeForRenderPass();(S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(J,Y,Q,re,ne,ae,ce,de,ue){const xe=Y.transform,Ce=Y.style.map.terrain,Ee=ne==="map",Re=ae==="map";for(const Ie of J){const Ke=re.getTile(Ie),He=Ke.getBucket(Q);if(!He||!He.text||!He.text.segments.get().length)continue;const $e=c.af(He.textSizeData,xe.zoom),ft=c.av(Ke,1,Y.transform.zoom),yt=Se(Ee,Y.transform,ft),Jt=Q.layout.get("icon-text-fit")!=="none"&&He.hasIconData();if($e){const cr=Math.pow(2,xe.zoom-Ke.tileID.overscaledZ),ir=Ce?(br,pr)=>Ce.getElevation(Ie,br,pr):null;Za(He,Ee,Re,ue,xe,yt,cr,$e,Jt,c.aw(xe,Ke,ce,de),Ie.toUnwrapped(),ir)}}}(k,y,S,x,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),E),S.paint.get("icon-opacity").constantOr(1)!==0&&ch(y,x,S,k,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),$,N,D),S.paint.get("text-opacity").constantOr(1)!==0&&ch(y,x,S,k,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),$,N,D),x.map.showCollisionBoxes&&(Va(y,x,S,k,!0),Va(y,x,S,k,!1))}(e,r,l,u,this.style.placement.variableOffsets,p):c.b$(l)?function(y,x,S,k,E){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:z}=E,D=S.paint.get("circle-opacity"),$=S.paint.get("circle-stroke-width"),N=S.paint.get("circle-stroke-opacity"),J=!S.layout.get("circle-sort-key").isConstant();if(D.constantOr(1)===0&&($.constantOr(1)===0||N.constantOr(1)===0))return;const Y=y.context,Q=Y.gl,re=y.transform,ne=y.getDepthModeForSublayer(0,Dt.ReadOnly),ae=Wt.disabled,ce=y.colorModeForRenderPass(),de=[],ue=re.getCircleRadiusCorrection();for(let xe=0;xe<k.length;xe++){const Ce=k[xe],Ee=x.getTile(Ce),Re=Ee.getBucket(S);if(!Re)continue;const Ie=S.paint.get("circle-translate"),Ke=S.paint.get("circle-translate-anchor"),He=c.aw(re,Ee,Ie,Ke),$e=Re.programConfigurations.get(S.id),ft=y.useProgram("circle",$e),yt=Re.layoutVertexBuffer,Jt=Re.indexBuffer,cr=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ce),ir={programConfiguration:$e,program:ft,layoutVertexBuffer:yt,indexBuffer:Jt,uniformValues:Gu(y,Ee,S,He,ue),terrainData:cr,projectionData:re.getProjectionData({overscaledTileID:Ce,applyGlobeMatrix:!z,applyTerrainMatrix:!0})};if(J){const br=Re.segments.get();for(const pr of br)de.push({segments:new c.aF([pr]),sortKey:pr.sortKey,state:ir})}else de.push({segments:Re.segments,sortKey:0,state:ir})}J&&de.sort((xe,Ce)=>xe.sortKey-Ce.sortKey);for(const xe of de){const{programConfiguration:Ce,program:Ee,layoutVertexBuffer:Re,indexBuffer:Ie,uniformValues:Ke,terrainData:He,projectionData:$e}=xe.state;Ee.draw(Y,Q.TRIANGLES,ne,ae,ce,Gt.backCCW,Ke,He,$e,S.id,Re,Ie,xe.segments,S.paint,y.transform.zoom,Ce)}}(e,r,l,u,p):c.c0(l)?function(y,x,S,k,E){if(S.paint.get("heatmap-opacity")===0)return;const z=y.context,{isRenderingToTexture:D,isRenderingGlobe:$}=E;if(y.style.map.terrain){for(const N of k){const J=x.getTile(N);x.hasRenderableParent(N)||(y.renderPass==="offscreen"?sf(y,J,S,N,$):y.renderPass==="translucent"&&uh(y,S,N,D,$))}z.viewport.set([0,0,y.width,y.height])}else y.renderPass==="offscreen"?function(N,J,Y,Q){const re=N.context,ne=re.gl,ae=N.transform,ce=Wt.disabled,de=new yr([ne.ONE,ne.ONE],c.b6.transparent,[!0,!0,!0,!0]);(function(ue,xe,Ce){const Ee=ue.gl;ue.activeTexture.set(Ee.TEXTURE1),ue.viewport.set([0,0,xe.width/4,xe.height/4]);let Re=Ce.heatmapFbos.get(c.bR);Re?(Ee.bindTexture(Ee.TEXTURE_2D,Re.colorAttachment.get()),ue.bindFramebuffer.set(Re.framebuffer)):(Re=Ns(ue,xe.width/4,xe.height/4),Ce.heatmapFbos.set(c.bR,Re))})(re,N,Y),re.clear({color:c.b6.transparent});for(let ue=0;ue<Q.length;ue++){const xe=Q[ue];if(J.hasRenderableParent(xe))continue;const Ce=J.getTile(xe),Ee=Ce.getBucket(Y);if(!Ee)continue;const Re=Ee.programConfigurations.get(Y.id),Ie=N.useProgram("heatmap",Re),Ke=ae.getProjectionData({overscaledTileID:xe,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),He=ae.getCircleRadiusCorrection();Ie.draw(re,ne.TRIANGLES,Dt.disabled,ce,de,Gt.backCCW,Yl(Ce,ae.zoom,Y.paint.get("heatmap-intensity"),He),null,Ke,Y.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,Y.paint,ae.zoom,Re)}re.viewport.set([0,0,N.width,N.height])}(y,x,S,k):y.renderPass==="translucent"&&function(N,J){const Y=N.context,Q=Y.gl;Y.setColorMode(N.colorModeForRenderPass());const re=J.heatmapFbos.get(c.bR);re&&(Y.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_2D,re.colorAttachment.get()),Y.activeTexture.set(Q.TEXTURE1),qa(Y,J).bind(Q.LINEAR,Q.CLAMP_TO_EDGE),N.useProgram("heatmapTexture").draw(Y,Q.TRIANGLES,Dt.disabled,Wt.disabled,N.colorModeForRenderPass(),Gt.disabled,Jl(N,J,0,1),null,null,J.id,N.viewportBuffer,N.quadTriangleIndexBuffer,N.viewportSegments,J.paint,N.transform.zoom))}(y,S)}(e,r,l,u,p):c.c1(l)?function(y,x,S,k,E){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:z}=E,D=S.paint.get("line-opacity"),$=S.paint.get("line-width");if(D.constantOr(1)===0||$.constantOr(1)===0)return;const N=y.getDepthModeForSublayer(0,Dt.ReadOnly),J=y.colorModeForRenderPass(),Y=S.paint.get("line-dasharray"),Q=S.paint.get("line-pattern"),re=Q.constantOr(1),ne=S.paint.get("line-gradient"),ae=S.getCrossfadeParameters(),ce=re?"linePattern":Y?"lineSDF":ne?"lineGradient":"line",de=y.context,ue=de.gl,xe=y.transform;let Ce=!0;for(const Ee of k){const Re=x.getTile(Ee);if(re&&!Re.patternsLoaded())continue;const Ie=Re.getBucket(S);if(!Ie)continue;const Ke=Ie.programConfigurations.get(S.id),He=y.context.program.get(),$e=y.useProgram(ce,Ke),ft=Ce||$e.program!==He,yt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ee),Jt=Q.constantOr(null);if(Jt&&Re.imageAtlas){const er=Re.imageAtlas,nr=er.patternPositions[Jt.to.toString()],io=er.patternPositions[Jt.from.toString()];nr&&io&&Ke.setConstantPatternPositions(nr,io)}const cr=xe.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),ir=xe.getPixelScale(),br=re?Ea(y,Re,S,ir,ae):Y?Kd(y,Re,S,ir,Y,ae):ne?Xd(y,Re,S,ir,Ie.lineClipsArray.length):vn(y,Re,S,ir);if(re)de.activeTexture.set(ue.TEXTURE0),Re.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),Ke.updatePaintBuffers(ae);else if(Y&&(ft||y.lineAtlas.dirty))de.activeTexture.set(ue.TEXTURE0),y.lineAtlas.bind(de);else if(ne){const er=Ie.gradients[S.id];let nr=er.texture;if(S.gradientVersion!==er.version){let io=256;if(S.stepInterpolant){const no=x.getSource().maxzoom,Hr=Ee.canonical.z===no?Math.ceil(1<<y.transform.maxZoom-Ee.canonical.z):1;io=c.ad(c.bS(Ie.maxLineLength/c.Z*1024*Hr),256,de.maxTextureSize)}er.gradient=c.bT({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:io,image:er.gradient||void 0,clips:Ie.lineClipsArray}),er.texture?er.texture.update(er.gradient):er.texture=new rt(de,er.gradient,ue.RGBA),er.version=S.gradientVersion,nr=er.texture}de.activeTexture.set(ue.TEXTURE0),nr.bind(S.stepInterpolant?ue.NEAREST:ue.LINEAR,ue.CLAMP_TO_EDGE)}let pr;if(z){const[er]=y.getStencilConfigForOverlapAndUpdateStencilID(k);pr=er[Ee.overscaledZ]}else pr=y.stencilModeForClipping(Ee);$e.draw(de,ue.TRIANGLES,N,pr,J,Gt.disabled,br,yt,cr,S.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,S.paint,y.transform.zoom,Ke,Ie.layoutVertexBuffer2),Ce=!1}}(e,r,l,u,p):c.c2(l)?function(y,x,S,k,E){const z=S.paint.get("fill-color"),D=S.paint.get("fill-opacity");if(D.constantOr(1)===0)return;const{isRenderingToTexture:$}=E,N=y.colorModeForRenderPass(),J=S.paint.get("fill-pattern"),Y=y.opaquePassEnabledForLayer()&&!J.constantOr(1)&&z.constantOr(c.b6.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===Y){const Q=y.getDepthModeForSublayer(1,y.renderPass==="opaque"?Dt.ReadWrite:Dt.ReadOnly);hc(y,x,S,k,Q,N,!1,$)}if(y.renderPass==="translucent"&&S.paint.get("fill-antialias")){const Q=y.getDepthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,Dt.ReadOnly);hc(y,x,S,k,Q,N,!0,$)}}(e,r,l,u,p):c.c3(l)?function(y,x,S,k,E){const z=S.paint.get("fill-extrusion-opacity");if(z===0)return;const{isRenderingToTexture:D}=E;if(y.renderPass==="translucent"){const $=new Dt(y.context.gl.LEQUAL,Dt.ReadWrite,y.depthRangeFor3D);if(z!==1||S.paint.get("fill-extrusion-pattern").constantOr(1))rs(y,x,S,k,$,Wt.disabled,yr.disabled,D),rs(y,x,S,k,$,y.stencilModeFor3D(),y.colorModeForRenderPass(),D);else{const N=y.colorModeForRenderPass();rs(y,x,S,k,$,Wt.disabled,N,D)}}}(e,r,l,u,p):c.c4(l)?function(y,x,S,k,E){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const{isRenderingToTexture:z}=E,D=y.context,$=y.style.projection.useSubdivision,N=y.getDepthModeForSublayer(0,Dt.ReadOnly),J=y.colorModeForRenderPass();if(y.renderPass==="offscreen")(function(Y,Q,re,ne,ae,ce,de){const ue=Y.context,xe=ue.gl;for(const Ce of re){const Ee=Q.getTile(Ce),Re=Ee.dem;if(!Re||!Re.data||!Ee.needsHillshadePrepare)continue;const Ie=Re.dim,Ke=Re.stride,He=Re.getPixels();if(ue.activeTexture.set(xe.TEXTURE1),ue.pixelStoreUnpackPremultiplyAlpha.set(!1),Ee.demTexture=Ee.demTexture||Y.getTileTexture(Ke),Ee.demTexture){const ft=Ee.demTexture;ft.update(He,{premultiply:!1}),ft.bind(xe.NEAREST,xe.CLAMP_TO_EDGE)}else Ee.demTexture=new rt(ue,He,xe.RGBA,{premultiply:!1}),Ee.demTexture.bind(xe.NEAREST,xe.CLAMP_TO_EDGE);ue.activeTexture.set(xe.TEXTURE0);let $e=Ee.fbo;if(!$e){const ft=new rt(ue,{width:Ie,height:Ie,data:null},xe.RGBA);ft.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),$e=Ee.fbo=ue.createFramebuffer(Ie,Ie,!0,!1),$e.colorAttachment.set(ft.texture)}ue.bindFramebuffer.set($e.framebuffer),ue.viewport.set([0,0,Ie,Ie]),Y.useProgram("hillshadePrepare").draw(ue,xe.TRIANGLES,ae,ce,de,Gt.disabled,Wu(Ee.tileID,Re),null,null,ne.id,Y.rasterBoundsBuffer,Y.quadTriangleIndexBuffer,Y.rasterBoundsSegments),Ee.needsHillshadePrepare=!1}})(y,x,k,S,N,Wt.disabled,J),D.viewport.set([0,0,y.width,y.height]);else if(y.renderPass==="translucent")if($){const[Y,Q,re]=y.stencilConfigForOverlapTwoPass(k);Vs(y,x,S,re,Y,N,J,!1,z),Vs(y,x,S,re,Q,N,J,!0,z)}else{const[Y,Q]=y.getStencilConfigForOverlapAndUpdateStencilID(k);Vs(y,x,S,Q,Y,N,J,!1,z)}}(e,r,l,u,p):c.c5(l)?function(y,x,S,k,E){if(y.renderPass!=="translucent"||S.paint.get("raster-opacity")===0||!k.length)return;const{isRenderingToTexture:z}=E,D=x.getSource(),$=y.style.projection.useSubdivision;if(D instanceof Je)Us(y,x,S,k,null,!1,!1,D.tileCoords,D.flippedWindingOrder,z);else if($){const[N,J,Y]=y.stencilConfigForOverlapTwoPass(k);Us(y,x,S,Y,N,!1,!0,dc,!1,z),Us(y,x,S,Y,J,!0,!0,dc,!1,z)}else{const[N,J]=y.getStencilConfigForOverlapAndUpdateStencilID(k);Us(y,x,S,J,N,!1,!0,dc,!1,z)}}(e,r,l,u,p):c.c6(l)?function(y,x,S,k,E){const z=S.paint.get("background-color"),D=S.paint.get("background-opacity");if(D===0)return;const{isRenderingToTexture:$}=E,N=y.context,J=N.gl,Y=y.style.projection,Q=y.transform,re=Q.tileSize,ne=S.paint.get("background-pattern");if(y.isPatternMissing(ne))return;const ae=!ne&&z.a===1&&D===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==ae)return;const ce=Wt.disabled,de=y.getDepthModeForSublayer(0,ae==="opaque"?Dt.ReadWrite:Dt.ReadOnly),ue=y.colorModeForRenderPass(),xe=y.useProgram(ne?"backgroundPattern":"background"),Ce=k||ge(Q,{tileSize:re,terrain:y.style.map.terrain});ne&&(N.activeTexture.set(J.TEXTURE0),y.imageManager.bind(y.context));const Ee=S.getCrossfadeParameters();for(const Re of Ce){const Ie=Q.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),Ke=ne?tc(D,y,ne,{tileID:Re,tileSize:re},Ee):$i(D,z),He=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Re),$e=Y.getMeshFromTileID(N,Re.canonical,!1,!0,"raster");xe.draw(N,J.TRIANGLES,de,ce,ue,Gt.backCCW,Ke,He,Ie,S.id,$e.vertexBuffer,$e.indexBuffer,$e.segments)}}(e,0,l,u,p):c.c7(l)&&function(y,x,S,k){const{isRenderingGlobe:E}=k,z=y.context,D=S.implementation,$=y.style.projection,N=y.transform,J=N.getProjectionDataForCustomLayer(E),Y={farZ:N.farZ,nearZ:N.nearZ,fov:N.fov*Math.PI/180,modelViewProjectionMatrix:N.modelViewProjectionMatrix,projectionMatrix:N.projectionMatrix,shaderData:{variantName:$.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${$.shaderPreludeCode.vertexSource}`,define:$.shaderDefine},defaultProjectionData:J},Q=D.renderingMode?D.renderingMode:"2d";if(y.renderPass==="offscreen"){const re=D.prerender;re&&(y.setCustomLayerDefaults(),z.setColorMode(y.colorModeForRenderPass()),re.call(D,z.gl,Y),z.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),z.setColorMode(y.colorModeForRenderPass()),z.setStencilMode(Wt.disabled);const re=Q==="3d"?y.getDepthModeFor3D():y.getDepthModeForSublayer(0,Dt.ReadOnly);z.setDepthMode(re),D.render(z.gl,Y),z.setDirty(),y.setBaseState(),z.bindFramebuffer.set(null)}}(e,0,l,p))}saveTileTexture(e){const r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const r=this._tileTextures[e];return r&&r.length>0?r.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const r=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!r||!l}useProgram(e,r,l=!1){this.cache=this.cache||{};const u=!!this.style.map.terrain,p=this.style.projection,y=e+(r?r.cacheKey:"")+`/${l?va:p.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(u?"/terrain":"");return this.cache[y]||(this.cache[y]=new Wd(this.context,_i[e],r,rc[e],this._showOverdrawInspector,u,l?_i.projectionMercator:p.shaderPreludeCode,l?Xt:p.shaderDefine)),this.cache[y]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new rt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:r}=this.context.gl;return this.width!==e||this.height!==r}}function _c(f,e){let r,l=!1,u=null,p=null;const y=()=>{u=null,l&&(f.apply(p,r),u=setTimeout(y,e),l=!1)};return(...x)=>(l=!0,p=this,r=x,u||y(),u)}class en{constructor(e){this._getCurrentHash=()=>{const r=window.location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(u=>u.split("=")).forEach(u=>{u[0]===this._hashName&&(l=u)}),(l&&l[1]||"").split("/")}return r.split("/")},this._onHashChange=()=>{const r=this._getCurrentHash();if(!this._isValidHash(r))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:l,pitch:+(r[4]||0)}),!0},this._updateHashUnthrottled=()=>{const r=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,r)},this._removeHash=()=>{const r=this._getCurrentHash();if(r.length===0)return;const l=r.join("/");let u=l;u.split("&").length>0&&(u=u.split("&")[0]),this._hashName&&(u=`${this._hashName}=${l}`);let p=window.location.hash.replace(u,"");p.startsWith("#&")?p=p.slice(0,1)+p.slice(2):p==="#"&&(p="");let y=window.location.href.replace(/(#.+)?$/,p);y=y.replace("&&","&"),window.history.replaceState(window.history.state,null,y)},this._updateHash=_c(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const r=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,u=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),p=Math.pow(10,u),y=Math.round(r.lng*p)/p,x=Math.round(r.lat*p)/p,S=this._map.getBearing(),k=this._map.getPitch();let E="";if(E+=e?`/${y}/${x}/${l}`:`${l}/${x}/${y}`,(S||k)&&(E+="/"+Math.round(10*S)/10),k&&(E+=`/${Math.round(k)}`),this._hashName){const z=this._hashName;let D=!1;const $=window.location.hash.slice(1).split("&").map(N=>{const J=N.split("=")[0];return J===z?(D=!0,`${J}=${E}`):N}).filter(N=>N);return D||$.push(`${z}=${E}`),`#${$.join("&")}`}return`#${E}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.Q(+e[2],+e[1])}catch{return!1}const r=+e[0],l=+(e[3]||0),u=+(e[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&l>=-180&&l<=180&&u>=this._map.getMinPitch()&&u<=this._map.getMaxPitch()}}const ns={linearity:.3,easing:c.c8(0,0,.3,1)},ph=c.e({deceleration:2500,maxSpeed:1400},ns),mh=c.e({deceleration:20,maxSpeed:1400},ns),gh=c.e({deceleration:1e3,maxSpeed:360},ns),_h=c.e({deceleration:1e3,maxSpeed:90},ns),yh=c.e({deceleration:1e3,maxSpeed:360},ns);class vh{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:K.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,r=K.now();for(;e.length>0&&r-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:p}of this._inertiaBuffer)r.zoom+=p.zoomDelta||0,r.bearing+=p.bearingDelta||0,r.pitch+=p.pitchDelta||0,r.roll+=p.rollDelta||0,p.panDelta&&r.pan._add(p.panDelta),p.around&&(r.around=p.around),p.pinchAround&&(r.pinchAround=p.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(r.pan.mag()){const p=ss(r.pan.mag(),l,c.e({},ph,e||{})),y=r.pan.mult(p.amount/r.pan.mag()),x=this._map.cameraHelper.handlePanInertia(y,this._map.transform);u.center=x.easingCenter,u.offset=x.easingOffset,tn(u,p)}if(r.zoom){const p=ss(r.zoom,l,mh);u.zoom=this._map.transform.zoom+p.amount,tn(u,p)}if(r.bearing){const p=ss(r.bearing,l,gh);u.bearing=this._map.transform.bearing+c.ad(p.amount,-179,179),tn(u,p)}if(r.pitch){const p=ss(r.pitch,l,_h);u.pitch=this._map.transform.pitch+p.amount,tn(u,p)}if(r.roll){const p=ss(r.roll,l,yh);u.roll=this._map.transform.roll+c.ad(p.amount,-179,179),tn(u,p)}if(u.zoom||u.bearing){const p=r.pinchAround===void 0?r.around:r.pinchAround;u.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),c.e(u,{noMoveStart:!0})}}function tn(f,e){(!f.duration||f.duration<e.duration)&&(f.duration=e.duration,f.easing=e.easing)}function ss(f,e,r){const{maxSpeed:l,linearity:u,deceleration:p}=r,y=c.ad(f*u/(e/1e3),-l,l),x=Math.abs(y)/(p*u);return{easing:r.easing,duration:1e3*x,amount:y*(x/2)}}class kr extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l,u={}){const p=G.mousePos(r.getCanvas(),l),y=r.unproject(p);super(e,c.e({point:p,lngLat:y,originalEvent:l},u)),this._defaultPrevented=!1,this.target=r}}class Bo extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l){const u=e==="touchend"?l.changedTouches:l.touches,p=G.touchPos(r.getCanvasContainer(),u),y=p.map(S=>r.unproject(S)),x=p.reduce((S,k,E,z)=>S.add(k.div(z.length)),new c.P(0,0));super(e,{points:p,point:x,lngLats:y,lngLat:r.unproject(x),originalEvent:l}),this._defaultPrevented=!1}}class yc extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class Ii{constructor(e,r){this._map=e,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new yc(e.type,this._map,e))}mousedown(e,r){return this._mousedownPos=r,this._firePreventable(new kr(e.type,this._map,e))}mouseup(e){this._map.fire(new kr(e.type,this._map,e))}click(e,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new kr(e.type,this._map,e))}dblclick(e){return this._firePreventable(new kr(e.type,this._map,e))}mouseover(e){this._map.fire(new kr(e.type,this._map,e))}mouseout(e){this._map.fire(new kr(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Bo(e.type,this._map,e))}touchmove(e){this._map.fire(new Bo(e.type,this._map,e))}touchend(e){this._map.fire(new Bo(e.type,this._map,e))}touchcancel(e){this._map.fire(new Bo(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class as{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new kr(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new kr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new kr(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zs{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class bh{constructor(e,r){this._map=e,this._tr=new Zs(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,r){this.isEnabled()&&e.shiftKey&&e.button===0&&(G.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(e,r){if(!this._active)return;const l=r;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const u=this._startPos;this._lastPos=l,this._box||(this._box=G.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const p=Math.min(u.x,l.x),y=Math.max(u.x,l.x),x=Math.min(u.y,l.y),S=Math.max(u.y,l.y);G.setTransform(this._box,`translate(${p}px,${x}px)`),this._box.style.width=y-p+"px",this._box.style.height=S-x+"px"}mouseupWindow(e,r){if(!this._active||e.button!==0)return;const l=this._startPos,u=r;if(this.reset(),G.suppressClick(),l.x!==u.x||l.y!==u.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:e})),{cameraAnimation:p=>p.fitScreenCoordinates(l,u,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(G.remove(this._box),this._box=null),G.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new c.l(e,{originalEvent:r}))}}function vc(f,e){if(f.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${e.length}`);const r={};for(let l=0;l<f.length;l++)r[f[l].identifier]=e[l];return r}class af{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=function(u){const p=new c.P(0,0);for(const y of u)p._add(y);return p.div(u.length)}(r),this.touches=vc(l,r)))}touchmove(e,r,l){if(this.aborted||!this.centroid)return;const u=vc(l,r);for(const p in this.touches){const y=u[p];(!y||y.dist(this.touches[p])>30)&&(this.aborted=!0)}}touchend(e,r,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class Wa{constructor(e){this.singleTap=new af(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,r,l){this.singleTap.touchstart(e,r,l)}touchmove(e,r,l){this.singleTap.touchmove(e,r,l)}touchend(e,r,l){const u=this.singleTap.touchend(e,r,l);if(u){const p=e.timeStamp-this.lastTime<500,y=!this.lastTap||this.lastTap.dist(u)<30;if(p&&y||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class Gs{constructor(e){this._tr=new Zs(e),this._zoomIn=new Wa({numTouches:1,numTaps:2}),this._zoomOut=new Wa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,r,l){this._zoomIn.touchstart(e,r,l),this._zoomOut.touchstart(e,r,l)}touchmove(e,r,l){this._zoomIn.touchmove(e,r,l),this._zoomOut.touchmove(e,r,l)}touchend(e,r,l){const u=this._zoomIn.touchend(e,r,l),p=this._zoomOut.touchend(e,r,l),y=this._tr;return u?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:y.zoom+1,around:y.unproject(u)},{originalEvent:e})}):p?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:y.zoom-1,around:y.unproject(p)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qo{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const r=this._moveFunction(...e);if(r.bearingDelta||r.pitchDelta||r.rollDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(e,r){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(r)?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,r){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const u=Array.isArray(r)?r[0]:r;return!this._moved&&u.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=u,this._move(l,u))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&G.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const ct={0:1,2:2};class ls{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const r=G.mouseButton(e);this._eventButton=r}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(r,l){const u=ct[l];return r.buttons===void 0||(r.buttons&u)!==u}(e,this._eventButton)}isValidEndEvent(e){return G.mouseButton(e)===this._eventButton}}class bc{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class xh{constructor(e=new ls({checkCorrectEvent:()=>!0}),r=new bc){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=r}_executeRelevantHandler(e,r,l){return e instanceof MouseEvent?r(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.startMove(r),r=>this.oneFingerTouchMoveStateManager.startMove(r))}endMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.endMove(r),r=>this.oneFingerTouchMoveStateManager.endMove(r))}isValidStartEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidStartEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidStartEvent(r))}isValidMoveEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidMoveEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(r))}isValidEndEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidEndEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidEndEvent(r))}}const rn=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=e=>{e.preventDefault()}};class qs{constructor(e,r){this._clickTolerance=e.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,r,l){return this._calculateTransform(e,r,l)}touchmove(e,r,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,r,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,r,l){this._calculateTransform(e,r,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,l){l.length>0&&(this._active=!0);const u=vc(l,r),p=new c.P(0,0),y=new c.P(0,0);let x=0;for(const k in u){const E=u[k],z=this._touches[k];z&&(p._add(E),y._add(E.sub(z)),x++,u[k]=E)}if(this._touches=u,this._shouldBePrevented(x)||!y.mag())return;const S=y.div(x);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:p.div(x),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ha{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,r,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([r[0],r[1]]))}touchmove(e,r,l){if(!this._firstTwoTouches)return;e.preventDefault();const[u,p]=this._firstTwoTouches,y=jt(l,r,u),x=jt(l,r,p);if(!y||!x)return;const S=this._aroundCenter?null:y.add(x).div(2);return this._move([y,x],S,e)}touchend(e,r,l){if(!this._firstTwoTouches)return;const[u,p]=this._firstTwoTouches,y=jt(l,r,u),x=jt(l,r,p);y&&x||(this._active&&G.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function jt(f,e,r){for(let l=0;l<f.length;l++)if(f[l].identifier===r)return e[l]}function Xa(f,e){return Math.log(f/e)/Math.LN2}class wh extends Ha{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,r){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Xa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Xa(this._distance,l),pinchAround:r}}}function Ka(f,e){return 180*f.angleWith(e)/Math.PI}class Ch extends Ha{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,r,l){const u=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ka(this._vector,u),pinchAround:r}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const r=25/(Math.PI*this._minDiameter)*360,l=Ka(e,this._startVector);return Math.abs(l)<r}}function xc(f){return Math.abs(f.y)>Math.abs(f.x)}class wc extends Ha{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,r,l){super.touchstart(e,r,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,xc(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,r,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const u=e[0].sub(this._lastPoints[0]),p=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(u,p,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(u.y+p.y)/2*-.5}):void 0}gestureBeginsVertically(e,r,l){if(this._valid!==void 0)return this._valid;const u=e.mag()>=2,p=r.mag()>=2;if(!u&&!p)return;if(!u||!p)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const y=e.y>0==r.y>0;return xc(e)&&xc(r)&&y}}const Cc={panStep:100,bearingStep:15,pitchStep:10};class Sc{constructor(e){this._tr=new Zs(e);const r=Cc;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let r=0,l=0,u=0,p=0,y=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),p=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),p=1);break;case 38:e.shiftKey?u=1:(e.preventDefault(),y=-1);break;case 40:e.shiftKey?u=-1:(e.preventDefault(),y=1);break;default:return}return this._rotationDisabled&&(l=0,u=0),{cameraAnimation:x=>{const S=this._tr;x.easeTo({duration:300,easeId:"keyboardHandler",easing:lf,zoom:r?Math.round(S.zoom)+r*(e.shiftKey?2:1):S.zoom,bearing:S.bearing+l*this._bearingStep,pitch:S.pitch+u*this._pitchStep,offset:[-p*this._panStep,-y*this._panStep],center:S.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function lf(f){return f*(2-f)}const Tc=4.000244140625;class Sh{constructor(e,r){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new Zs(e),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let r=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=K.now(),u=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,r!==0&&r%Tc==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(u*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=G.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(c.Q.convert(l.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const x=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=x),typeof this._targetZoom=="number"&&(this._targetZoom+=x)}if(this._delta!==0){const x=this._type==="wheel"&&Math.abs(this._delta)>Tc?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*x)));this._delta<0&&S!==0&&(S=1/S);const k=typeof this._targetZoom!="number"?e.scale:c.aH(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,c.aa(k*S))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,u=this._easing;let p,y=!1;if(this._type==="wheel"&&l&&u){const x=K.now()-this._lastWheelEventTime,S=Math.min((x+5)/200,1),k=u(S);p=c.B.number(l,r,k),S<1?this._frameId||(this._frameId=!0):y=!0}else p=r,y=!0;return this._active=!0,y&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=p,{noInertia:!0,needsRenderFrame:!y,zoomDelta:p-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=c.ca;if(this._prevEase){const l=this._prevEase,u=(K.now()-l.start)/l.duration,p=l.easing(u+.01)-l.easing(u),y=.27/Math.sqrt(p*p+1e-4)*.01,x=Math.sqrt(.0729-y*y);r=c.c8(y,x,.25,1)}return this._prevEase={start:K.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Th{constructor(e,r){this._clickZoom=e,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class on{constructor(e){this._tr=new Zs(e),this.reset()}reset(){this._active=!1}dblclick(e,r){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vr{constructor(){this._tap=new Wa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,r,l){if(!this._swipePoint)if(this._tapTime){const u=r[0],p=e.timeStamp-this._tapTime<500,y=this._tapPoint.dist(u)<30;p&&y?l.length>0&&(this._swipePoint=u,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,r,l)}touchmove(e,r,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const u=r[0],p=u.y-this._swipePoint.y;return this._swipePoint=u,e.preventDefault(),this._active=!0,{zoomDelta:p/128}}}else this._tap.touchmove(e,r,l)}touchend(e,r,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const u=this._tap.touchend(e,r,l);u&&(this._tapTime=e.timeStamp,this._tapPoint=u)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ws{constructor(e,r,l){this._el=e,this._mousePan=r,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ya{constructor(e,r,l,u){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=r,this._mousePitch=l,this._mouseRoll=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class kc{constructor(e,r,l,u){this._el=e,this._touchZoom=r,this._touchRotate=l,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Pc{constructor(e,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=G.create("div","maplibregl-cooperative-gesture-screen",e);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),u=document.createElement("div");u.className="maplibregl-desktop-message",u.textContent=r,this._container.appendChild(u);const p=document.createElement("div");p.className="maplibregl-mobile-message",p.textContent=l,this._container.appendChild(p),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(G.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,r){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:e,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Hs=f=>f.zoom||f.drag||f.roll||f.pitch||f.rotate;class cf extends c.l{}function hi(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta||f.rollDelta}class Ja{constructor(e,r){this.handleWindowEvent=u=>{this.handleEvent(u,`${u.type}Window`)},this.handleEvent=(u,p)=>{if(u.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const y=u.type==="renderFrame"?void 0:u,x={needsRenderFrame:!1},S={},k={},E=u.touches,z=E?this._getMapTouches(E):void 0,D=z?G.touchPos(this._map.getCanvas(),z):G.mousePos(this._map.getCanvas(),u);for(const{handlerName:J,handler:Y,allowed:Q}of this._handlers){if(!Y.isEnabled())continue;let re;this._blockedByActive(k,Q,J)?Y.reset():Y[p||u.type]&&(re=Y[p||u.type](u,D,z),this.mergeHandlerResult(x,S,re,J,y),re&&re.needsRenderFrame&&this._triggerRenderFrame()),(re||Y.isActive())&&(k[J]=Y)}const $={};for(const J in this._previousActiveHandlers)k[J]||($[J]=y);this._previousActiveHandlers=k,(Object.keys($).length||hi(x))&&(this._changes.push([x,S,$]),this._triggerRenderFrame()),(Object.keys(k).length||hi(x))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=x;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new vh(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[u,p,y]of this._listeners)G.addEventListener(u,p,u===document?this.handleWindowEvent:this.handleEvent,y)}destroy(){for(const[e,r,l]of this._listeners)G.removeEventListener(e,r,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const r=this._map,l=r.getCanvasContainer();this._add("mapEvent",new Ii(r,e));const u=r.boxZoom=new bh(r,e);this._add("boxZoom",u),e.interactive&&e.boxZoom&&u.enable();const p=r.cooperativeGestures=new Pc(r,e.cooperativeGestures);this._add("cooperativeGestures",p),e.cooperativeGestures&&p.enable();const y=new Gs(r),x=new on(r);r.doubleClickZoom=new Th(x,y),this._add("tapZoom",y),this._add("clickZoom",x),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();const S=new vr;this._add("tapDragZoom",S);const k=r.touchPitch=new wc(r);this._add("touchPitch",k),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);const E=()=>r.project(r.getCenter()),z=function({enable:ae,clickTolerance:ce,aroundCenter:de=!0,minPixelCenterThreshold:ue=100,rotateDegreesPerPixelMoved:xe=.8},Ce){const Ee=new ls({checkCorrectEvent:Re=>G.mouseButton(Re)===0&&Re.ctrlKey||G.mouseButton(Re)===2&&!Re.ctrlKey});return new qo({clickTolerance:ce,move:(Re,Ie)=>{const Ke=Ce();if(de&&Math.abs(Ke.y-Re.y)>ue)return{bearingDelta:c.c9(new c.P(Re.x,Ie.y),Ie,Ke)};let He=(Ie.x-Re.x)*xe;return de&&Ie.y<Ke.y&&(He=-He),{bearingDelta:He}},moveStateManager:Ee,enable:ae,assignEvents:rn})}(e,E),D=function({enable:ae,clickTolerance:ce,pitchDegreesPerPixelMoved:de=-.5}){const ue=new ls({checkCorrectEvent:xe=>G.mouseButton(xe)===0&&xe.ctrlKey||G.mouseButton(xe)===2});return new qo({clickTolerance:ce,move:(xe,Ce)=>({pitchDelta:(Ce.y-xe.y)*de}),moveStateManager:ue,enable:ae,assignEvents:rn})}(e),$=function({enable:ae,clickTolerance:ce,rollDegreesPerPixelMoved:de=.3},ue){const xe=new ls({checkCorrectEvent:Ce=>G.mouseButton(Ce)===2&&Ce.ctrlKey});return new qo({clickTolerance:ce,move:(Ce,Ee)=>{const Re=ue();let Ie=(Ee.x-Ce.x)*de;return Ee.y<Re.y&&(Ie=-Ie),{rollDelta:Ie}},moveStateManager:xe,enable:ae,assignEvents:rn})}(e,E);r.dragRotate=new Ya(e,z,D,$),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",D,["mouseRotate","mouseRoll"]),this._add("mouseRoll",$,["mousePitch"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();const N=function({enable:ae,clickTolerance:ce}){const de=new ls({checkCorrectEvent:ue=>G.mouseButton(ue)===0&&!ue.ctrlKey});return new qo({clickTolerance:ce,move:(ue,xe)=>({around:xe,panDelta:xe.sub(ue)}),activateOnStart:!0,moveStateManager:de,enable:ae,assignEvents:rn})}(e),J=new qs(e,r);r.dragPan=new Ws(l,N,J),this._add("mousePan",N),this._add("touchPan",J,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);const Y=new Ch,Q=new wh;r.touchZoomRotate=new kc(l,Q,Y,S),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",Q,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate);const re=r.scrollZoom=new Sh(r,()=>this._triggerRenderFrame());this._add("scrollZoom",re,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);const ne=r.keyboard=new Sc(r);this._add("keyboard",ne),e.interactive&&e.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new as(r))}_add(e,r,l){this._handlers.push({handlerName:e,handler:r,allowed:l}),this._handlersById[e]=r}stop(e){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Hs(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,r,l){for(const u in e)if(u!==l&&(!r||r.indexOf(u)<0))return!0;return!1}_getMapTouches(e){const r=[];for(const l of e)this._el.contains(l.target)&&r.push(l);return r}mergeHandlerResult(e,r,l,u,p){if(!l)return;c.e(e,l);const y={handlerName:u,originalEvent:l.originalEvent||p};l.zoomDelta!==void 0&&(r.zoom=y),l.panDelta!==void 0&&(r.drag=y),l.rollDelta!==void 0&&(r.roll=y),l.pitchDelta!==void 0&&(r.pitch=y),l.bearingDelta!==void 0&&(r.rotate=y)}_applyChanges(){const e={},r={},l={};for(const[u,p,y]of this._changes)u.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(u.panDelta)),u.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+u.pitchDelta),u.rollDelta&&(e.rollDelta=(e.rollDelta||0)+u.rollDelta),u.around!==void 0&&(e.around=u.around),u.pinchAround!==void 0&&(e.pinchAround=u.pinchAround),u.noInertia&&(e.noInertia=u.noInertia),c.e(r,p),c.e(l,y);this._updateMapTransform(e,r,l),this._changes=[]}_updateMapTransform(e,r,l){const u=this._map,p=u._getTransformForUpdate(),y=u.terrain;if(!(hi(e)||y&&this._terrainMovement))return this._fireEvents(r,l,!0);u._stop(!0);let{panDelta:x,zoomDelta:S,bearingDelta:k,pitchDelta:E,rollDelta:z,around:D,pinchAround:$}=e;$!==void 0&&(D=$),D=D||u.transform.centerPoint,y&&!p.isPointOnMapSurface(D)&&(D=p.centerPoint);const N={panDelta:x,zoomDelta:S,rollDelta:z,pitchDelta:E,bearingDelta:k,around:D};this._map.cameraHelper.useGlobeControls&&!p.isPointOnMapSurface(D)&&(D=p.centerPoint);const J=D.distSqr(p.centerPoint)<.01?p.center:p.screenPointToLocation(x?D.sub(x):D);y?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(N,p),this._terrainMovement||!r.drag&&!r.zoom?r.drag&&this._terrainMovement?p.setCenter(p.screenPointToLocation(p.centerPoint.sub(x))):this._map.cameraHelper.handleMapControlsPan(N,p,J):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(N,p,J))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(N,p),this._map.cameraHelper.handleMapControlsPan(N,p,J)),u._applyUpdatedTransform(p),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,l,!0)}_fireEvents(e,r,l){const u=Hs(this._eventsInProgress),p=Hs(e),y={};for(const z in e){const{originalEvent:D}=e[z];this._eventsInProgress[z]||(y[`${z}start`]=D),this._eventsInProgress[z]=e[z]}!u&&p&&this._fireEvent("movestart",p.originalEvent);for(const z in y)this._fireEvent(z,y[z]);p&&this._fireEvent("move",p.originalEvent);for(const z in e){const{originalEvent:D}=e[z];this._fireEvent(z,D)}const x={};let S;for(const z in this._eventsInProgress){const{handlerName:D,originalEvent:$}=this._eventsInProgress[z];this._handlersById[D].isActive()||(delete this._eventsInProgress[z],S=r[D]||$,x[`${z}end`]=S)}for(const z in x)this._fireEvent(z,x[z]);const k=Hs(this._eventsInProgress),E=(u||p)&&!k;if(E&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const z=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&z.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(z)}if(l&&E){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),D=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;!z||!z.essential&&K.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:S})),D(this._map.getBearing())&&this._map.resetNorth()):(D(z.bearing||this._map.getBearing())&&(z.bearing=0),z.freezeElevation=!0,this._map.easeTo(z,{originalEvent:S})),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new c.l(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new cf("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class _t extends c.E{constructor(e,r,l){super(),this._renderFrameCallback=()=>{const u=Math.min((K.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=r,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,r){e.apply(this.transform),this.transform=e,this.cameraHelper=r}getCenter(){return new c.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,r){return this.jumpTo({center:e},r)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,r){return this.jumpTo({elevation:e},r),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,r,l){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},r),l)}panTo(e,r,l){return this.easeTo(c.e({center:e},r),l)}getZoom(){return this.transform.zoom}setZoom(e,r){return this.jumpTo({zoom:e},r),this}zoomTo(e,r,l){return this.easeTo(c.e({zoom:e},r),l)}zoomIn(e,r){return this.zoomTo(this.getZoom()+1,e,r),this}zoomOut(e,r){return this.zoomTo(this.getZoom()-1,e,r),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,r){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.l("movestart",r)).fire(new c.l("move",r)).fire(new c.l("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(e,r){return this.jumpTo({bearing:e},r),this}getPadding(){return this.transform.padding}setPadding(e,r){return this.jumpTo({padding:e},r),this}rotateTo(e,r,l){return this.easeTo(c.e({bearing:e},r),l)}resetNorth(e,r){return this.rotateTo(0,c.e({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),r),this}snapToNorth(e,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,r):this}getPitch(){return this.transform.pitch}setPitch(e,r){return this.jumpTo({pitch:e},r),this}getRoll(){return this.transform.roll}setRoll(e,r){return this.jumpTo({roll:e},r),this}cameraForBounds(e,r){e=ke.convert(e).adjustAntiMeridian();const l=r&&r.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,r)}_cameraForBoxAndBearing(e,r,l,u){const p={top:0,bottom:0,right:0,left:0};if(typeof(u=c.e({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=="number"){const k=u.padding;u.padding={top:k,bottom:k,right:k,left:k}}const y=c.e(p,u.padding);u.padding=y;const x=this.transform,S=new ke(e,r);return this.cameraHelper.cameraForBoxAndBearing(u,y,S,l,x)}fitBounds(e,r,l){return this._fitInternal(this.cameraForBounds(e,r),r,l)}fitScreenCoordinates(e,r,l,u,p){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(r)),l,u),u,p)}_fitInternal(e,r,l){return e?(delete(r=c.e(e,r)).padding,r.linear?this.easeTo(r,l):this.flyTo(r,l)):this}jumpTo(e,r){this.stop();const l=this._getTransformForUpdate();let u=!1,p=!1,y=!1;const x=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const S=l.zoom!==x;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(u=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(p=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(y=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new c.l("movestart",r)).fire(new c.l("move",r)),S&&this.fire(new c.l("zoomstart",r)).fire(new c.l("zoom",r)).fire(new c.l("zoomend",r)),u&&this.fire(new c.l("rotatestart",r)).fire(new c.l("rotate",r)).fire(new c.l("rotateend",r)),p&&this.fire(new c.l("pitchstart",r)).fire(new c.l("pitch",r)).fire(new c.l("pitchend",r)),y&&this.fire(new c.l("rollstart",r)).fire(new c.l("roll",r)).fire(new c.l("rollend",r)),this.fire(new c.l("moveend",r))}calculateCameraOptionsFromTo(e,r,l,u=0){const p=c.$.fromLngLat(e,r),y=c.$.fromLngLat(l,u),x=y.x-p.x,S=y.y-p.y,k=y.z-p.z,E=Math.hypot(x,S,k);if(E===0)throw new Error("Can't calculate camera options with same From and To");const z=Math.hypot(x,S),D=c.aa(this.transform.cameraToCenterDistance/E/this.transform.tileSize),$=180*Math.atan2(x,-S)/Math.PI;let N=180*Math.acos(z/E)/Math.PI;return N=k<0?90-N:90+N,{center:y.toLngLat(),elevation:u,zoom:D,pitch:N,bearing:$}}calculateCameraOptionsFromCameraLngLatAltRotation(e,r,l,u,p){const y=this.transform.calculateCenterFromCameraLngLatAlt(e,r,l,u);return{center:y.center,elevation:y.elevation,zoom:y.zoom,bearing:l,pitch:u,roll:p}}easeTo(e,r){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.ca},e)).animate===!1||!e.essential&&K.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),u=this.getBearing(),p=l.pitch,y=l.roll,x="bearing"in e?this._normalizeBearing(e.bearing,u):u,S="pitch"in e?+e.pitch:p,k="roll"in e?this._normalizeBearing(e.roll,y):y,E="padding"in e?e.padding:l.padding,z=c.P.convert(e.offset);let D,$;e.around&&(D=c.Q.convert(e.around),$=l.locationToScreenPoint(D));const N={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},J=this.cameraHelper.handleEaseTo(l,{bearing:x,pitch:S,roll:k,padding:E,around:D,aroundPoint:$,offsetAsPoint:z,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||u!==x,this._pitching=this._pitching||S!==p,this._rolling=this._rolling||k!==y,this._padding=!l.isPaddingEqual(E),this._zooming=this._zooming||J.isZooming,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,N),this.terrain&&this._prepareElevation(J.elevationCenter),this._ease(Y=>{J.easeFunc(Y),this.terrain&&!e.freezeElevation&&this._updateElevation(Y),this._applyUpdatedTransform(l),this._fireMoveEvents(r)},Y=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,Y)},e),this}_prepareEase(e,r,l={}){this._moving=!0,r||l.moving||this.fire(new c.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new c.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new c.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new c.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new c.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(r-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=r}this.transform.setElevation(c.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const r=e.getCameraLngLat(),l=e.getCameraAltitude(),u=this.terrain?this.terrain.getElevationForLngLatZoom(r,e.zoom):0;if(l<u){const p=this.calculateCameraOptionsFromTo(r,u,e.center,e.elevation);return{pitch:p.pitch,zoom:p.zoom}}return{}}_applyUpdatedTransform(e){const r=[];if(r.push(u=>this._elevateCameraIfInsideTerrain(u)),this.transformCameraUpdate&&r.push(u=>this.transformCameraUpdate(u)),!r.length)return;const l=e.clone();for(const u of r){const p=l.clone(),{center:y,zoom:x,roll:S,pitch:k,bearing:E,elevation:z}=u(p);y&&p.setCenter(y),z!==void 0&&p.setElevation(z),x!==void 0&&p.setZoom(x),S!==void 0&&p.setRoll(S),k!==void 0&&p.setPitch(k),E!==void 0&&p.setBearing(E),l.apply(p)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new c.l("move",e)),this._zooming&&this.fire(new c.l("zoom",e)),this._rotating&&this.fire(new c.l("rotate",e)),this._pitching&&this.fire(new c.l("pitch",e)),this._rolling&&this.fire(new c.l("roll",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const l=this._zooming,u=this._rotating,p=this._pitching,y=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new c.l("zoomend",e)),u&&this.fire(new c.l("rotateend",e)),p&&this.fire(new c.l("pitchend",e)),y&&this.fire(new c.l("rollend",e)),this.fire(new c.l("moveend",e))}flyTo(e,r){if(!e.essential&&K.prefersReducedMotion){const Ie=c.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ie,r)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.ca},e);const l=this._getTransformForUpdate(),u=l.bearing,p=l.pitch,y=l.roll,x=l.padding,S="bearing"in e?this._normalizeBearing(e.bearing,u):u,k="pitch"in e?+e.pitch:p,E="roll"in e?this._normalizeBearing(e.roll,y):y,z="padding"in e?e.padding:l.padding,D=c.P.convert(e.offset);let $=l.centerPoint.add(D);const N=l.screenPointToLocation($),J=this.cameraHelper.handleFlyTo(l,{bearing:S,pitch:k,roll:E,padding:z,locationAtOffset:N,offsetAsPoint:D,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let Y=e.curve;const Q=Math.max(l.width,l.height),re=Q/J.scaleOfZoom,ne=J.pixelPathLength;typeof J.scaleOfMinZoom=="number"&&(Y=Math.sqrt(Q/J.scaleOfMinZoom/ne*2));const ae=Y*Y;function ce(Ie){const Ke=(re*re-Q*Q+(Ie?-1:1)*ae*ae*ne*ne)/(2*(Ie?re:Q)*ae*ne);return Math.log(Math.sqrt(Ke*Ke+1)-Ke)}function de(Ie){return(Math.exp(Ie)-Math.exp(-Ie))/2}function ue(Ie){return(Math.exp(Ie)+Math.exp(-Ie))/2}const xe=ce(!1);let Ce=function(Ie){return ue(xe)/ue(xe+Y*Ie)},Ee=function(Ie){return Q*((ue(xe)*(de(Ke=xe+Y*Ie)/ue(Ke))-de(xe))/ae)/ne;var Ke},Re=(ce(!0)-xe)/Y;if(Math.abs(ne)<2e-6||!isFinite(Re)){if(Math.abs(Q-re)<1e-6)return this.easeTo(e,r);const Ie=re<Q?-1:1;Re=Math.abs(Math.log(re/Q))/Y,Ee=()=>0,Ce=Ke=>Math.exp(Ie*Y*Ke)}return e.duration="duration"in e?+e.duration:1e3*Re/("screenSpeed"in e?+e.screenSpeed/Y:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=u!==S,this._pitching=k!==p,this._rolling=E!==y,this._padding=!l.isPaddingEqual(z),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(J.targetCenter),this._ease(Ie=>{const Ke=Ie*Re,He=1/Ce(Ke),$e=Ee(Ke);this._rotating&&l.setBearing(c.B.number(u,S,Ie)),this._pitching&&l.setPitch(c.B.number(p,k,Ie)),this._rolling&&l.setRoll(c.B.number(y,E,Ie)),this._padding&&(l.interpolatePadding(x,z,Ie),$=l.centerPoint.add(D)),J.easeFunc(Ie,He,$e,$),this.terrain&&!e.freezeElevation&&this._updateElevation(Ie),this._applyUpdatedTransform(l),this._fireMoveEvents(r)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,r){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,r)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,r,l){l.animate===!1||l.duration===0?(e(1),r()):(this._easeStart=K.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=c.aK(e,-180,180);const l=Math.abs(e-r);return Math.abs(e-360-r)<l&&(e-=360),Math.abs(e+360-r)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.Q.convert(e),this.transform.tileZoom):null}}const Tt={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Xs{constructor(e=Tt){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=r=>{!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=G.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=G.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=G.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(e,r){const l=this._map._getUIString(`AttributionControl.${r}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(u=>typeof u!="string"?"":u)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const r=this._map.style.sourceCaches;for(const u in r){const p=r[u];if(p.used||p.usedForTerrain){const y=p.getSource();y.attribution&&e.indexOf(y.attribution)<0&&e.push(y.attribution)}}e=e.filter(u=>String(u).trim()),e.sort((u,p)=>u.length-p.length),e=e.filter((u,p)=>{for(let y=p+1;y<e.length;y++)if(e[y].indexOf(u)>=0)return!1;return!0});const l=e.join(" | ");l!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=G.sanitize(l),e.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Qa{constructor(e={}){this._updateCompact=()=>{const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=G.create("div","maplibregl-ctrl");const r=G.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){G.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Mc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const r=++this._id;return this._queue.push({callback:e,id:r,cancelled:!1}),r}remove(e){const r=this._currentlyRunning,l=r?this._queue.concat(r):this._queue;for(const u of l)if(u.id===e)return void(u.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const r=this._currentlyRunning=this._queue;this._queue=[];for(const l of r)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Lo=c.aC([{name:"a_pos3d",type:"Int16",components:3}]);class kh extends c.E{constructor(e){super(),this._lastTilesetChange=K.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];const l={};for(const u of ge(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[u.key]=!0,this._renderableTilesKeys.push(u.key),this._tiles[u.key]||(u.terrainRttPosMatrix32f=new Float64Array(16),c.bN(u.terrainRttPosMatrix32f,0,c.Z,c.Z,0,0,1),this._tiles[u.key]=new Dr(u,this.tileSize),this._lastTilesetChange=K.now());for(const u in this._tiles)l[u]||delete this._tiles[u]}freeRtt(e){for(const r in this._tiles){const l=this._tiles[r];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const r={};for(const l of this._renderableTilesKeys){const u=this._tiles[l].tileID,p=e.clone(),y=c.b1();if(u.canonical.equals(e.canonical))c.bN(y,0,c.Z,c.Z,0,0,1);else if(u.canonical.isChildOf(e.canonical)){const x=u.canonical.z-e.canonical.z,S=u.canonical.x-(u.canonical.x>>x<<x),k=u.canonical.y-(u.canonical.y>>x<<x),E=c.Z>>x;c.bN(y,0,E,E,0,0,1),c.L(y,y,[-S*E,-k*E,0])}else{if(!e.canonical.isChildOf(u.canonical))continue;{const x=e.canonical.z-u.canonical.z,S=e.canonical.x-(e.canonical.x>>x<<x),k=e.canonical.y-(e.canonical.y>>x<<x),E=c.Z>>x;c.bN(y,0,c.Z,c.Z,0,0,1),c.L(y,y,[S*E,k*E,0]),c.M(y,y,[1/2**x,1/2**x,0])}}p.terrainRttPosMatrix32f=new Float32Array(y),r[l]=p}return r}getSourceTile(e,r){const l=this.sourceCache._source;let u=e.overscaledZ-this.deltaZoom;if(u>l.maxzoom&&(u=l.maxzoom),u<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(u).key);let p=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!p||!p.dem)&&r)for(;u>=l.minzoom&&(!p||!p.dem);)p=this.sourceCache.getTileByID(e.scaledTo(u--).key);return p}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}}class Ei{constructor(e,r,l){this._meshCache={},this.painter=e,this.sourceCache=new kh(r),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,l,u=c.Z){var p;if(!(r>=0&&r<u&&l>=0&&l<u))return 0;const y=this.getTerrainData(e),x=(p=y.tile)===null||p===void 0?void 0:p.dem;if(!x)return 0;const S=c.cb([],[r/u*c.Z,l/u*c.Z],y.u_terrain_matrix),k=[S[0]*x.dim,S[1]*x.dim],E=Math.floor(k[0]),z=Math.floor(k[1]),D=k[0]-E,$=k[1]-z;return x.get(E,z)*(1-D)*(1-$)+x.get(E+1,z)*D*(1-$)+x.get(E,z+1)*(1-D)*$+x.get(E+1,z+1)*D*$}getElevationForLngLatZoom(e,r){if(!c.cc(r,e.wrap()))return 0;const{tileID:l,mercatorX:u,mercatorY:p}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(l,u%c.Z,p%c.Z,c.Z)}getElevation(e,r,l,u=c.Z){return this.getDEMElevation(e,r,l,u)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const u=this.painter.context,p=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new rt(u,p,u.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new rt(u,new c.R({width:1,height:1}),u.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.as([])}const r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const u=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new rt(u,r.dem.getPixels(),u.gl.RGBA,{premultiply:!1}),r.demTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const l=r&&r+r.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const u=this.sourceCache.sourceCache._source.maxzoom;let p=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=u?p=e.canonical.z-u:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const y=e.canonical.x-(e.canonical.x>>p<<p),x=e.canonical.y-(e.canonical.y>>p<<p),S=c.cd(new Float64Array(16),[1/(c.Z<<p),1/(c.Z<<p),0]);c.L(S,S,[y*c.Z,x*c.Z,0]),this._demMatrixCache[e.key]={matrix:S,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){const r=this.painter,l=r.width/devicePixelRatio,u=r.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===u||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new rt(r.context,{width:l,height:u,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new rt(r.context,{width:l,height:u,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(l,u,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,l,u))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let p=0,y=0;p<this._coordsTextureSize;p++)for(let x=0;x<this._coordsTextureSize;x++,y+=4)r[y+0]=255&x,r[y+1]=255&p,r[y+2]=x>>8<<4|p>>8,r[y+3]=0;const l=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),u=new rt(e,l,e.gl.RGBA,{premultiply:!1});return u.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=u,u}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),l=this.painter.context,u=l.gl,p=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),y=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),x=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),u.readPixels(p,x-y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,r),l.bindFramebuffer.set(null);const S=r[0]+(r[2]>>4<<8),k=r[1]+((15&r[2])<<8),E=this.coordsIndex[255-r[3]],z=E&&this.sourceCache.getTileByID(E);if(!z)return null;const D=this._coordsTextureSize,$=(1<<z.tileID.canonical.z)*D;return new c.$((z.tileID.canonical.x*D+S)/$+z.tileID.wrap,(z.tileID.canonical.y*D+k)/$,this.getElevation(z.tileID,S,k,D))}depthAtPoint(e){const r=new Uint8Array(4),l=this.painter.context,u=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),u.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,r),l.bindFramebuffer.set(null),(r[0]/16777216+r[1]/65536+r[2]/256+r[3])/256}getTerrainMesh(e){var r;const l=((r=this.painter.style.projection)===null||r===void 0?void 0:r.transitionState)>0,u=l&&e.canonical.y===0,p=l&&e.canonical.y===(1<<e.canonical.z)-1,y=`m_${u?"n":""}_${p?"s":""}`;if(this._meshCache[y])return this._meshCache[y];const x=this.painter.context,S=new c.ce,k=new c.aG,E=this.meshSize,z=c.Z/E,D=E*E;for(let ue=0;ue<=E;ue++)for(let xe=0;xe<=E;xe++)S.emplaceBack(xe*z,ue*z,0);for(let ue=0;ue<D;ue+=E+1)for(let xe=0;xe<E;xe++)k.emplaceBack(xe+ue,E+xe+ue+1,E+xe+ue+2),k.emplaceBack(xe+ue,E+xe+ue+2,xe+ue+1);const $=S.length,N=$+(E+1),J=(E+1)*E,Y=u?c.b8:0,Q=u?0:1,re=p?c.b9:c.Z,ne=p?0:1;for(let ue=0;ue<=E;ue++)S.emplaceBack(ue*z,Y,Q);for(let ue=0;ue<=E;ue++)S.emplaceBack(ue*z,re,ne);for(let ue=0;ue<E;ue++)k.emplaceBack(J+ue,N+ue,N+ue+1),k.emplaceBack(J+ue,N+ue+1,J+ue+1),k.emplaceBack(0+ue,$+ue+1,$+ue),k.emplaceBack(0+ue,0+ue+1,$+ue+1);const ae=S.length,ce=ae+2*(E+1);for(const ue of[0,1])for(let xe=0;xe<=E;xe++)for(const Ce of[0,1])S.emplaceBack(ue*c.Z,xe*z,Ce);for(let ue=0;ue<2*E;ue+=2)k.emplaceBack(ae+ue,ae+ue+1,ae+ue+3),k.emplaceBack(ae+ue,ae+ue+3,ae+ue+2),k.emplaceBack(ce+ue,ce+ue+3,ce+ue+1),k.emplaceBack(ce+ue,ce+ue+2,ce+ue+3);const de=new Zo(x.createVertexBuffer(S,Lo.members),x.createIndexBuffer(k),c.aF.simpleSegment(0,0,S.length,k.length));return this._meshCache[y]=de,de}getMeshFrameDelta(e){return 2*Math.PI*c.bq/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,r){var l;const{tileID:u}=this._getOverscaledTileIDFromLngLatZoom(e,r);return(l=this.getMinMaxElevation(u).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const r=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return r&&r.dem&&(l.minElevation=r.dem.min*this.exaggeration,l.maxElevation=r.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,r){const l=c.$.fromLngLat(e.wrap()),u=(1<<r)*c.Z,p=l.x*u,y=l.y*u,x=Math.floor(p/c.Z),S=Math.floor(y/c.Z);return{tileID:new c.Y(r,0,r,x,S),mercatorX:p,mercatorY:y}}}class uf{constructor(e,r,l){this._context=e,this._size=r,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new rt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(l.texture),{id:e,fbo:r,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(r=>e.id!==r),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const Ai={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Pr{constructor(e,r){this.painter=e,this.terrain=r,this.pool=new uf(e.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(l=>!e._layers[l].isHidden(r)),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const u=e.sourceCaches[l].getVisibleCoordinates();for(const p of u){const y=this.terrain.sourceCache.getTerrainCoords(p);for(const x in y)this._coordsAscending[l][x]||(this._coordsAscending[l][x]=[]),this._coordsAscending[l][x].push(y[x])}}this._coordsAscendingStr={};for(const l of e._order){const u=e._layers[l],p=u.source;if(Ai[u.type]&&!this._coordsAscendingStr[p]){this._coordsAscendingStr[p]={};for(const y in this._coordsAscending[p])this._coordsAscendingStr[p][y]=this._coordsAscending[p][y].map(x=>x.key).sort().join()}}for(const l of this._renderableTiles)for(const u in this._coordsAscendingStr){const p=this._coordsAscendingStr[u][l.tileID.key];p&&p!==l.rttCoords[u]&&(l.rtt=[])}}renderLayer(e,r){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),u=e.type,p=this.painter,y=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Ai[u]&&(this._prevType&&Ai[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(e.id),!y))return!0;if(Ai[this._prevType]||Ai[u]&&y){this._prevType=u;const x=this._stacks.length-1,S=this._stacks[x]||[];for(const k of this._renderableTiles){if(this.pool.isFull()&&(mc(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[x]){const z=this.pool.getObjectForId(k.rtt[x].id);if(z.stamp===k.rtt[x].stamp){this.pool.useObject(z);continue}}const E=this.pool.getOrCreateFreeObject();this.pool.useObject(E),this.pool.stampObject(E),k.rtt[x]={id:E.id,stamp:E.stamp},p.context.bindFramebuffer.set(E.fbo.framebuffer),p.context.clear({color:c.b6.transparent,stencil:0}),p.currentStencilSource=void 0;for(let z=0;z<S.length;z++){const D=p.style._layers[S[z]],$=D.source?this._coordsAscending[D.source][k.tileID.key]:[k.tileID];p.context.viewport.set([0,0,E.fbo.width,E.fbo.height]),p._renderTileClippingMasks(D,$,!0),p.renderLayer(p,p.style.sourceCaches[D.source],D,$,l),D.source&&(k.rttCoords[D.source]=this._coordsAscendingStr[D.source][k.tileID.key])}}return mc(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),Ai[u]}return!1}}const Or={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ph=R,cs={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Tt,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},el={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Ic{constructor(e,r,l=!1){this.mousedown=p=>{this.startMove(p,G.mousePos(this.element,p)),G.addEventListener(window,"mousemove",this.mousemove),G.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=p=>{this.move(p,G.mousePos(this.element,p))},this.mouseup=p=>{this._rotatePitchHanlder.dragEnd(p),this.offTemp()},this.touchstart=p=>{p.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=G.touchPos(this.element,p.targetTouches)[0],this.startMove(p,this._startPos),G.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.addEventListener(window,"touchend",this.touchend))},this.touchmove=p=>{p.targetTouches.length!==1?this.reset():(this._lastPos=G.touchPos(this.element,p.targetTouches)[0],this.move(p,this._lastPos))},this.touchend=p=>{p.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const u=new xh;this._rotatePitchHanlder=new qo({clickTolerance:3,move:(p,y)=>{const x=r.getBoundingClientRect(),S=new c.P((x.bottom-x.top)/2,(x.right-x.left)/2);return{bearingDelta:c.c9(new c.P(p.x,y.y),y,S),pitchDelta:l?-.5*(y.y-p.y):void 0}},moveStateManager:u,enable:!0,assignEvents:()=>{}}),this.map=e,G.addEventListener(r,"mousedown",this.mousedown),G.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),G.addEventListener(r,"touchcancel",this.reset)}startMove(e,r){this._rotatePitchHanlder.dragStart(e,r),G.disableDrag()}move(e,r){const l=this.map,{bearingDelta:u,pitchDelta:p}=this._rotatePitchHanlder.dragMove(e,r)||{};u&&l.setBearing(l.getBearing()+u),p&&l.setPitch(l.getPitch()+p)}off(){const e=this.element;G.removeEventListener(e,"mousedown",this.mousedown),G.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),G.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.removeEventListener(window,"touchend",this.touchend),G.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){G.enableDrag(),G.removeEventListener(window,"mousemove",this.mousemove),G.removeEventListener(window,"mouseup",this.mouseup),G.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.removeEventListener(window,"touchend",this.touchend)}}let ji;function tl(f,e,r){const l=new c.Q(f.lng,f.lat);if(f=new c.Q(f.lng,f.lat),e){const u=new c.Q(f.lng-360,f.lat),p=new c.Q(f.lng+360,f.lat),y=r.locationToScreenPoint(f).distSqr(e);r.locationToScreenPoint(u).distSqr(e)<y?f=u:r.locationToScreenPoint(p).distSqr(e)<y&&(f=p)}for(;Math.abs(f.lng-r.center.lng)>180;){const u=r.locationToScreenPoint(f);if(u.x>=0&&u.y>=0&&u.x<=r.width&&u.y<=r.height)break;f.lng>r.center.lng?f.lng-=360:f.lng+=360}return f.lng!==l.lng&&r.isPointOnMapSurface(r.locationToScreenPoint(f))?f:l}const Pn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function rl(f,e,r){const l=f.classList;for(const u in Pn)l.remove(`maplibregl-${r}-anchor-${u}`);l.add(`maplibregl-${r}-anchor-${e}`)}class Ks extends c.E{constructor(e){if(super(),this._onKeyPress=r=>{const l=r.code,u=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&u!==32&&u!==13||this.togglePopup()},this._onMapClick=r=>{const l=r.originalEvent.target,u=this._element;this._popup&&(l===u||u.contains(l))&&this.togglePopup()},this._update=r=>{var l;if(!this._map)return;const u=this._map.loaded()&&!this._map.isMoving();((r==null?void 0:r.type)==="terrain"||(r==null?void 0:r.type)==="render"&&!u)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?tl(this._lngLat,this._flatPos,this._map.transform):(l=this._lngLat)===null||l===void 0?void 0:l.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||r&&r.type!=="moveend"||(this._pos=this._pos.round()),G.setTransform(this._element,`${Pn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${p}`),K.frameAsync(new AbortController).then(()=>{this._updateOpacity(r&&r.type==="moveend")}).catch(()=>{})},this._onMove=r=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=r=>{this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=G.create("div");const r=G.createNS("http://www.w3.org/2000/svg","svg"),l=41,u=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${l}px`),r.setAttributeNS(null,"width",`${u}px`),r.setAttributeNS(null,"viewBox",`0 0 ${u} ${l}`);const p=G.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"stroke","none"),p.setAttributeNS(null,"stroke-width","1"),p.setAttributeNS(null,"fill","none"),p.setAttributeNS(null,"fill-rule","evenodd");const y=G.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"fill-rule","nonzero");const x=G.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"transform","translate(3.0, 29.0)"),x.setAttributeNS(null,"fill","#000000");const S=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Q of S){const re=G.createNS("http://www.w3.org/2000/svg","ellipse");re.setAttributeNS(null,"opacity","0.04"),re.setAttributeNS(null,"cx","10.5"),re.setAttributeNS(null,"cy","5.80029008"),re.setAttributeNS(null,"rx",Q.rx),re.setAttributeNS(null,"ry",Q.ry),x.appendChild(re)}const k=G.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const E=G.createNS("http://www.w3.org/2000/svg","path");E.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(E);const z=G.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"opacity","0.25"),z.setAttributeNS(null,"fill","#000000");const D=G.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),z.appendChild(D);const $=G.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$.setAttributeNS(null,"fill","#FFFFFF");const N=G.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(8.0, 8.0)");const J=G.createNS("http://www.w3.org/2000/svg","circle");J.setAttributeNS(null,"fill","#000000"),J.setAttributeNS(null,"opacity","0.25"),J.setAttributeNS(null,"cx","5.5"),J.setAttributeNS(null,"cy","5.5"),J.setAttributeNS(null,"r","5.4999962");const Y=G.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#FFFFFF"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962"),N.appendChild(J),N.appendChild(Y),y.appendChild(x),y.appendChild(k),y.appendChild(z),y.appendChild($),y.appendChild(N),r.appendChild(y),r.setAttributeNS(null,"height",l*this._scale+"px"),r.setAttributeNS(null,"width",u*this._scale+"px"),this._element.appendChild(r),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",r=>{r.preventDefault()}),this._element.addEventListener("mousedown",r=>{r.preventDefault()}),rl(this._element,this._anchor,"marker"),e&&e.className)for(const r of e.className.split(" "))this._element.classList.add(r);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),G.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const u=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var r,l;if(!(!((r=this._map)===null||r===void 0)&&r.terrain)){const z=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==z&&(this._element.style.opacity=z))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const u=this._map,p=u.terrain.depthAtPoint(this._pos),y=u.terrain.getElevationForLngLatZoom(this._lngLat,u.transform.tileZoom);if(u.transform.lngLatToCameraDepth(this._lngLat,y)-p<.006)return void(this._element.style.opacity=this._opacity);const x=-this._offset.y/u.transform.pixelsPerMeter,S=Math.sin(u.getPitch()*Math.PI/180)*x,k=u.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),E=u.transform.lngLatToCameraDepth(this._lngLat,y+S)-k>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&E&&this._popup.remove(),this._element.style.opacity=E?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,r){return(this._opacity===void 0||e===void 0&&r===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),r!==void 0&&(this._opacityWhenCovered=r),this._map&&this._updateOpacity(!0),this}}const Ec={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let us=0,Mn=!1;const Ac={maxWidth:100,unit:"metric"};function ol(f,e,r){const l=r&&r.maxWidth||100,u=f._container.clientHeight/2,p=f._container.clientWidth/2,y=f.unproject([p-l/2,u]),x=f.unproject([p+l/2,u]),S=Math.round(f.project(x).x-f.project(y).x),k=Math.min(l,S,f._container.clientWidth),E=y.distanceTo(x);if(r&&r.unit==="imperial"){const z=3.2808*E;z>5280?In(e,k,z/5280,f._getUIString("ScaleControl.Miles")):In(e,k,z,f._getUIString("ScaleControl.Feet"))}else r&&r.unit==="nautical"?In(e,k,E/1852,f._getUIString("ScaleControl.NauticalMiles")):E>=1e3?In(e,k,E/1e3,f._getUIString("ScaleControl.Kilometers")):In(e,k,E,f._getUIString("ScaleControl.Meters"))}function In(f,e,r,l){const u=function(p){const y=Math.pow(10,`${Math.floor(p)}`.length-1);let x=p/y;return x=x>=10?10:x>=5?5:x>=3?3:x>=2?2:x>=1?1:function(S){const k=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*k)/k}(x),y*x}(r);f.style.width=e*(u/r)+"px",f.innerHTML=`${u}&nbsp;${l}`}const il={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},zc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function nl(f){if(f){if(typeof f=="number"){const e=Math.round(Math.abs(f)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,f),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-f),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(f,0),right:new c.P(-f,0)}}if(f instanceof c.P||Array.isArray(f)){const e=c.P.convert(f);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(f.center||[0,0]),top:c.P.convert(f.top||[0,0]),"top-left":c.P.convert(f["top-left"]||[0,0]),"top-right":c.P.convert(f["top-right"]||[0,0]),bottom:c.P.convert(f.bottom||[0,0]),"bottom-left":c.P.convert(f["bottom-left"]||[0,0]),"bottom-right":c.P.convert(f["bottom-right"]||[0,0]),left:c.P.convert(f.left||[0,0]),right:c.P.convert(f.right||[0,0])}}return nl(new c.P(0,0))}const sl=R;b.AJAXError=c.ci,b.Event=c.l,b.Evented=c.E,b.LngLat=c.Q,b.MercatorCoordinate=c.$,b.Point=c.P,b.addProtocol=c.cj,b.config=c.a,b.removeProtocol=c.ck,b.AttributionControl=Xs,b.BoxZoomHandler=bh,b.CanvasSource=St,b.CooperativeGesturesHandler=Pc,b.DoubleClickZoomHandler=Th,b.DragPanHandler=Ws,b.DragRotateHandler=Ya,b.EdgeInsets=oo,b.FullscreenControl=class extends c.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var e;let r=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=r==null?void 0:r.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)r=r.shadowRoot.fullscreenElement;r===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){G.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=G.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);G.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},b.GeoJSONSource=tt,b.GeolocateControl=class extends c.E{constructor(f){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const r=new c.Q(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,u=this._map.getBearing(),p=c.e({bearing:u},this.options.fitBoundsOptions),y=ke.fromLngLat(r,l);this._map.fitBounds(y,p,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const r=new c.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Mn)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=G.create("button","maplibregl-ctrl-geolocate",this._container),G.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=G.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ks({element:this._dotElement}),this._circleElement=G.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ks({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))})}},this.options=c.e({},Ec,f)}onAdd(f){return this._map=f,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(e=!1){if(ji!==void 0&&!e)return ji;if(window.navigator.permissions===void 0)return ji=!!window.navigator.geolocation,ji;try{ji=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ji=!!window.navigator.geolocation}return ji})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),G.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,us=0,Mn=!1}_isOutOfMapMaxBounds(f){const e=this._map.getMaxBounds(),r=f.coords;return e&&(r.longitude<e.getWest()||r.longitude>e.getEast()||r.latitude<e.getSouth()||r.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const f=this._map.getBounds(),e=f.getSouthEast(),r=f.getNorthEast(),l=e.distanceTo(r),u=Math.ceil(this._accuracy/(l/this._map._container.clientHeight)*2);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":us--,Mn=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),us++,us>1?(f={maximumAge:6e5,timeout:0},Mn=!0):(f=this.options.positionOptions,Mn=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},b.GlobeControl=class{constructor(){this._toggleProjection=()=>{var f;const e=(f=this._map.getProjection())===null||f===void 0?void 0:f.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var f;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((f=this._map.getProjection())===null||f===void 0?void 0:f.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(f){return this._map=f,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=G.create("button","maplibregl-ctrl-globe",this._container),G.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},b.Hash=en,b.ImageSource=Je,b.KeyboardHandler=Sc,b.LngLatBounds=ke,b.LogoControl=Qa,b.Map=class extends _t{constructor(f){var e,r;c.cf.mark(c.cg.create);const l=Object.assign(Object.assign(Object.assign({},cs),f),{canvasContextAttributes:Object.assign(Object.assign({},cs.canvasContextAttributes),f.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const u=new si,p=new vi;if(l.minZoom!==void 0&&u.setMinZoom(l.minZoom),l.maxZoom!==void 0&&u.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&u.setMinPitch(l.minPitch),l.maxPitch!==void 0&&u.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&u.setRenderWorldCopies(l.renderWorldCopies),super(u,p,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Mc,this._controls=[],this._mapId=c.a3(),this._contextLost=x=>{x.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:x}))},this._contextRestored=x=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:x}))},this._onMapScroll=x=>{if(x.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Or),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ye.addThrottleControl(()=>this.isMoving()),this._requestManager=new Ae(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let x=!1;const S=_c(k=>{this._trackResize&&!this._removed&&(this.resize(k),this.redraw())},50);this._resizeObserver=new ResizeObserver(k=>{x?S(k):x=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ja(this,l),this._hash=l.hash&&new en(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,c.e({},l.fitBoundsOptions,{duration:0}))));const y=typeof l.style=="string"||((r=(e=l.style)===null||e===void 0?void 0:e.projection)===null||r===void 0?void 0:r.type)!=="globe";this.resize(null,y),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new Xs(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new Qa,l.logoPosition),this.on("style.load",()=>{if(y||this._resizeTransform(),this.transform.unmodified){const x=c.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(x)}}),this.on("data",x=>{this._update(x.dataType==="style"),this.fire(new c.l(`${x.dataType}data`,x))}),this.on("dataloading",x=>{this.fire(new c.l(`${x.dataType}dataloading`,x))}),this.on("dataabort",x=>{this.fire(new c.l("sourcedataabort",x))})}_getMapId(){return this._mapId}addControl(f,e){if(e===void 0&&(e=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=f.onAdd(this);this._controls.push(f);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(r,l.firstChild):l.appendChild(r),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(f);return e>-1&&this._controls.splice(e,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}calculateCameraOptionsFromTo(f,e,r,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,e,r,l)}resize(f,e=!0){const[r,l]=this._containerDimensions(),u=this._getClampedPixelRatio(r,l);if(this._resizeCanvas(r,l,u),this.painter.resize(r,l,u),this.painter.overLimit()){const y=this.painter.context.gl;this._maxCanvasSize=[y.drawingBufferWidth,y.drawingBufferHeight];const x=this._getClampedPixelRatio(r,l);this._resizeCanvas(r,l,x),this.painter.resize(r,l,x)}this._resizeTransform(e);const p=!this._moving;return p&&(this.stop(),this.fire(new c.l("movestart",f)).fire(new c.l("move",f))),this.fire(new c.l("resize",f)),p&&this.fire(new c.l("moveend",f)),this}_resizeTransform(f=!0){var e;const[r,l]=this._containerDimensions();this.transform.resize(r,l,f),(e=this._requestedCameraState)===null||e===void 0||e.resize(r,l,f)}_getClampedPixelRatio(f,e){const{0:r,1:l}=this._maxCanvasSize,u=this.getPixelRatio(),p=f*u,y=e*u;return Math.min(p>r?r/p:1,y>l?l/y:1)*u}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(ke.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.setMinZoom(f),this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.setMaxZoom(f),this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.setMinPitch(f),this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(f>=this.transform.minPitch)return this.transform.setMaxPitch(f),this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.setRenderWorldCopies(f),this._update()}project(f){return this.transform.locationToScreenPoint(c.Q.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.screenPointToLocation(c.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,e,r){if(f==="mouseenter"||f==="mouseover"){let l=!1;return{layers:e,listener:r,delegates:{mousemove:p=>{const y=e.filter(S=>this.getLayer(S)),x=y.length!==0?this.queryRenderedFeatures(p.point,{layers:y}):[];x.length?l||(l=!0,r.call(this,new kr(f,this,p.originalEvent,{features:x}))):l=!1},mouseout:()=>{l=!1}}}}if(f==="mouseleave"||f==="mouseout"){let l=!1;return{layers:e,listener:r,delegates:{mousemove:y=>{const x=e.filter(S=>this.getLayer(S));(x.length!==0?this.queryRenderedFeatures(y.point,{layers:x}):[]).length?l=!0:l&&(l=!1,r.call(this,new kr(f,this,y.originalEvent)))},mouseout:y=>{l&&(l=!1,r.call(this,new kr(f,this,y.originalEvent)))}}}}{const l=u=>{const p=e.filter(x=>this.getLayer(x)),y=p.length!==0?this.queryRenderedFeatures(u.point,{layers:p}):[];y.length&&(u.features=y,r.call(this,u),delete u.features)};return{layers:e,listener:r,delegates:{[f]:l}}}}_saveDelegatedListener(f,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(e)}_removeDelegatedListener(f,e,r){if(!this._delegatedListeners||!this._delegatedListeners[f])return;const l=this._delegatedListeners[f];for(let u=0;u<l.length;u++){const p=l[u];if(p.listener===r&&p.layers.length===e.length&&p.layers.every(y=>e.includes(y))){for(const y in p.delegates)this.off(y,p.delegates[y]);return void l.splice(u,1)}}}on(f,e,r){if(r===void 0)return super.on(f,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(f,l,r);this._saveDelegatedListener(f,u);for(const p in u.delegates)this.on(p,u.delegates[p]);return{unsubscribe:()=>{this._removeDelegatedListener(f,l,r)}}}once(f,e,r){if(r===void 0)return super.once(f,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(f,l,r);for(const p in u.delegates){const y=u.delegates[p];u.delegates[p]=(...x)=>{this._removeDelegatedListener(f,l,r),y(...x)}}this._saveDelegatedListener(f,u);for(const p in u.delegates)this.once(p,u.delegates[p]);return this}off(f,e,r){return r===void 0?super.off(f,e):(this._removeDelegatedListener(f,typeof e=="string"?[e]:e,r),this)}queryRenderedFeatures(f,e){if(!this.style)return[];let r;const l=f instanceof c.P||Array.isArray(f),u=l?f:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:f)||{},u instanceof c.P||typeof u[0]=="number")r=[c.P.convert(u)];else{const p=c.P.convert(u[0]),y=c.P.convert(u[1]);r=[p,new c.P(y.x,p.y),y,new c.P(p.x,y.y),p]}return this.style.queryRenderedFeatures(r,e,this.transform)}querySourceFeatures(f,e){return this.style.querySourceFeatures(f,e)}setStyle(f,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(f,e))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const e=this._locale[f];if(e==null)throw new Error(`Missing UI string '${f}'`);return e}_updateStyle(f,e){var r,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(f,e));const u=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new Fs(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,e,u):this.style.loadJSON(f,e,u),this):((l=(r=this.style)===null||r===void 0?void 0:r.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Fs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,e){if(typeof f=="string"){const r=this._requestManager.transformRequest(f,"Style");c.j(r,new AbortController).then(l=>{this._updateDiff(l.data,e)}).catch(l=>{l&&this.fire(new c.k(l))})}else typeof f=="object"&&this._updateDiff(f,e)}_updateDiff(f,e){try{this.style.setState(f,e)&&this._update(!0)}catch(r){c.w(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(f,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(f,e){return this._lazyInitEmptyStyle(),this.style.addSource(f,e),this._update(!0)}isSourceLoaded(f){const e=this.style&&this.style.sourceCaches[f];if(e!==void 0)return e.loaded();this.fire(new c.k(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const e=this.style.sourceCaches[f.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&e.reload();for(const r in this.style._layers){const l=this.style._layers[r];l.type==="hillshade"&&l.source===f.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ei(this.painter,e,f),this.painter.renderToTexture=new Pr(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=r=>{r.dataType==="style"?this.terrain.sourceCache.freeRtt():r.dataType==="source"&&r.tile&&(r.sourceId!==f.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(r.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:f})),this}getTerrain(){var f,e;return(e=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const e in f){const r=f[e]._tiles;for(const l in r){const u=r[l];if(u.state!=="loaded"&&u.state!=="errored")return!1}}return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,e,r={}){const{pixelRatio:l=1,sdf:u=!1,stretchX:p,stretchY:y,content:x,textFitWidth:S,textFitHeight:k}=r;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:z,data:D}=e,$=e;return this.style.addImage(f,{data:new c.R({width:E,height:z},new Uint8Array(D)),pixelRatio:l,stretchX:p,stretchY:y,content:x,textFitWidth:S,textFitHeight:k,sdf:u,version:0,userImage:$}),$.onAdd&&$.onAdd(this,f),this}}{const{width:E,height:z,data:D}=K.getImageData(e);this.style.addImage(f,{data:new c.R({width:E,height:z},D),pixelRatio:l,stretchX:p,stretchY:y,content:x,textFitWidth:S,textFitHeight:k,sdf:u,version:0})}}updateImage(f,e){const r=this.style.getImage(f);if(!r)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||c.b(e)?K.getImageData(e):e,{width:u,height:p,data:y}=l;if(u===void 0||p===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(u!==r.data.width||p!==r.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const x=!(e instanceof HTMLImageElement||c.b(e));return r.data.replace(y,x),this.style.updateImage(f,r),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return ye.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,e){return this._lazyInitEmptyStyle(),this.style.addLayer(f,e),this._update(!0)}moveLayer(f,e){return this.style.moveLayer(f,e),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,e,r){return this.style.setLayerZoomRange(f,e,r),this._update(!0)}setFilter(f,e,r={}){return this.style.setFilter(f,e,r),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,e,r,l={}){return this.style.setPaintProperty(f,e,r,l),this._update(!0)}getPaintProperty(f,e){return this.style.getPaintProperty(f,e)}setLayoutProperty(f,e,r,l={}){return this.style.setLayoutProperty(f,e,r,l),this._update(!0)}getLayoutProperty(f,e){return this.style.getLayoutProperty(f,e)}setGlyphs(f,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,e,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,e,r,l=>{l||this._update(!0)}),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,e,r=>{r||this._update(!0)}),this}setLight(f,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(f,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,e){return this.style.setFeatureState(f,e),this._update()}removeFeatureState(f,e){return this.style.removeFeatureState(f,e),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,e=0;return this._container&&(f=this._container.clientWidth||400,e=this._container.clientHeight||300),[f,e]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const e=this._canvasContainer=G.create("div","maplibregl-canvas-container",f);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=G.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),l=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],l);const u=this._controlContainer=G.create("div","maplibregl-control-container",f),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{p[y]=G.create("div",`maplibregl-ctrl-${y} `,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,e,r){this._canvas.width=Math.floor(r*f),this._canvas.height=Math.floor(r*e),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const f=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",l=>{e={requestedAttributes:f},l&&(e.statusMessage=l.statusMessage,e.type=l.type)},{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,f):this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f),!r){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new fh(r,this.transform),fe.testSupport(r)}migrateProjection(f,e){super.migrateProjection(f,e),this.painter.transform=f,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){var e,r,l,u,p;const y=this._idleTriggered?this._fadeDuration:0,x=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let S=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,D=K.now();this.style.zoomHistory.update(z,D);const $=new c.C(z,{now:D,fadeDuration:y,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),N=$.crossFadingFactor();N===1&&N===this._crossFadingFactor||(S=!0,this._crossFadingFactor=N),this.style.update($)}const k=((r=this.style.projection)===null||r===void 0?void 0:r.transitionState)>0!==x;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((u=this.style.projection)===null||u===void 0?void 0:u.transitionState,(p=this.style.projection)===null||p===void 0?void 0:p.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||k)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,y,this._crossSourceCollisions,k),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cf.mark(c.cg.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||S)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const E=this._sourcesDirty||this._styleDirty||this._placementDirty;return E||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||E||(this._fullyLoaded=!0,c.cf.mark(c.cg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ye.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),G.remove(this._canvasContainer),G.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cf.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,K.frame(this._frameRequest,f=>{c.cf.frame(f),this._frameRequest=null;try{this._render(f)}catch(e){if(!c.ch(e)&&!function(r){return r.message===ah}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return Ph}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(f){return this._lazyInitEmptyStyle(),this.style.setProjection(f),this._update(!0)}},b.MapMouseEvent=kr,b.MapTouchEvent=Bo,b.MapWheelEvent=yc,b.Marker=Ks,b.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const e=this._map.getZoom(),r=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,r)=>{const l=this._map._getUIString(`NavigationControl.${r}`);e.title=l,e.setAttribute("aria-label",l)},this.options=c.e({},el,f),this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),G.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),G.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=G.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ic(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){G.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,e){const r=G.create("button",f,this._container);return r.type="button",r.addEventListener("click",e),r}},b.Popup=class extends c.E{constructor(f){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&G.remove(this._content),this._container&&(G.remove(this._container),delete this._container),this._closeButton&&this._closeButton.removeEventListener("click",this._onClose),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var r;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=G.create("div","maplibregl-popup",this._map.getContainer()),this._tip=G.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const x of this.options.className.split(" "))this._container.classList.add(x);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?tl(this._lngLat,this._flatPos,this._map.transform):(r=this._lngLat)===null||r===void 0?void 0:r.wrap(),this._trackPointer&&!e)return;const l=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let u=this.options.anchor;const p=nl(this.options.offset);if(!u){const x=this._container.offsetWidth,S=this._container.offsetHeight;let k;k=l.y+p.bottom.y<S?["top"]:l.y>this._map.transform.height-S?["bottom"]:[],l.x<x/2?k.push("left"):l.x>this._map.transform.width-x/2&&k.push("right"),u=k.length===0?"bottom":k.join("-")}let y=l.add(p[u]);this.options.subpixelPositioning||(y=y.round()),G.setTransform(this._container,`${Pn[u]} translate(${y.x}px,${y.y}px)`),rl(this._container,u,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(il),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=c.Q.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const e=document.createDocumentFragment(),r=document.createElement("body");let l;for(r.innerHTML=f;l=r.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=G.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=G.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(zc);f&&f.focus()}},b.RasterDEMTileSource=it,b.RasterTileSource=Ve,b.ScaleControl=class{constructor(f){this._onMove=()=>{ol(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,ol(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ac),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){G.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},b.ScrollZoomHandler=Sh,b.Style=Fs,b.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=G.create("button","maplibregl-ctrl-terrain",this._container),G.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){G.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},b.TwoFingersTouchPitchHandler=wc,b.TwoFingersTouchRotateHandler=Ch,b.TwoFingersTouchZoomHandler=wh,b.TwoFingersTouchZoomRotateHandler=kc,b.VectorTileSource=Ne,b.VideoSource=Ue,b.addSourceType=(f,e)=>c._(void 0,void 0,void 0,function*(){if(bt(f))throw new Error(`A source type called "${f}" already exists.`);((r,l)=>{at[r]=l})(f,e)}),b.clearPrewarmedResources=function(){const f=Lr;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(_r),Lr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},b.createTileMesh=Bs,b.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},b.getRTLTextPluginStatus=function(){return Vt().getRTLTextPluginStatus()},b.getVersion=function(){return sl},b.getWorkerCount=function(){return or.workerCount},b.getWorkerUrl=function(){return c.a.WORKER_URL},b.importScriptInWorkers=function(f){return Vo().broadcast("IS",f)},b.prewarm=function(){yo().acquire(_r)},b.setMaxParallelImageRequests=function(f){c.a.MAX_PARALLEL_IMAGE_REQUESTS=f},b.setRTLTextPlugin=function(f,e){return Vt().setRTLTextPlugin(f,e)},b.setWorkerCount=function(f){or.workerCount=f},b.setWorkerUrl=function(f){c.a.WORKER_URL=f}});var P=d;return P})}(ld)),ld.exports}var h5=u5();const d5=l5(h5);function J0(n,s,d){if(n!==null)for(var _,w,P,b,c,R,Z,V=0,H=0,K,G=n.type,fe=G==="FeatureCollection",Be=G==="Feature",et=fe?n.features.length:1,We=0;We<et;We++){Z=fe?n.features[We].geometry:Be?n.geometry:n,K=Z?Z.type==="GeometryCollection":!1,c=K?Z.geometries.length:1;for(var lt=0;lt<c;lt++){var st=0,ye=0;if(b=K?Z.geometries[lt]:Z,b!==null){R=b.coordinates;var Ae=b.type;switch(V=0,Ae){case null:break;case"Point":if(s(R,H,We,st,ye)===!1)return!1;H++,st++;break;case"LineString":case"MultiPoint":for(_=0;_<R.length;_++){if(s(R[_],H,We,st,ye)===!1)return!1;H++,Ae==="MultiPoint"&&st++}Ae==="LineString"&&st++;break;case"Polygon":case"MultiLineString":for(_=0;_<R.length;_++){for(w=0;w<R[_].length-V;w++){if(s(R[_][w],H,We,st,ye)===!1)return!1;H++}Ae==="MultiLineString"&&st++,Ae==="Polygon"&&ye++}Ae==="Polygon"&&st++;break;case"MultiPolygon":for(_=0;_<R.length;_++){for(ye=0,w=0;w<R[_].length;w++){for(P=0;P<R[_][w].length-V;P++){if(s(R[_][w][P],H,We,st,ye)===!1)return!1;H++}ye++}st++}break;case"GeometryCollection":for(_=0;_<b.geometries.length;_++)if(J0(b.geometries[_],s)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function f5(n,s={}){if(n.bbox!=null&&s.recompute!==!0)return n.bbox;const d=[1/0,1/0,-1/0,-1/0];return J0(n,_=>{d[0]>_[0]&&(d[0]=_[0]),d[1]>_[1]&&(d[1]=_[1]),d[2]<_[0]&&(d[2]=_[0]),d[3]<_[1]&&(d[3]=_[1])}),d}const Q0=R1("map",()=>{const n=No({"weather-warnings":{id:"weather-warnings",homeMapLayerType:"fixed",title:"Weather Warnings",position:1,visible:!1,enabled:!1,icon:"icon-warning",multiTemporal:!1},"weather-forecast":{id:"weather-forecast",homeMapLayerType:"fixed",title:"Weather Forecast",position:2,visible:!1,enabled:!1,dateFormat:"yyyy-MM-dd HH:mm",icon:"icon-heavy-rain",multiTemporal:!0}}),s=$n(()=>Object.values(n.value).filter(K=>K.enabled&&K.homeMapLayerType==="fixed").sort((K,G)=>K.position-G.position));function d(K,G){n.value[K]&&(n.value[K].enabled=G)}function _(K,G){n.value[K]&&(n.value[K].visible=G)}const w=K=>{n.value["weather-forecast"]&&(n.value["weather-forecast"].dateFormat=K)},P=No({}),b=No({}),c=No(null);return{layers:n,sortedFixedLayers:s,timeLayerDates:P,selectedTimeLayerDate:b,activeTimeLayer:c,setTimeLayerDates:(K,G)=>{P.value[K]||(P.value[K]=No([])),P.value[K].value=G},setSelectedTimeLayerDate:(K,G)=>{b.value[K]=G},updateLayerState:d,updateLayerVisibility:_,setActiveTimeLayer:K=>{c.value=K},setWeatherForecastLayerDateFormat:w,getLayerById:K=>n.value[K]}});function Iu(n){"@babel/helpers - typeof";return Iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Iu(n)}function p5(n,s){if(!(n instanceof s))throw new TypeError("Cannot call a class as a function")}function m5(n,s){for(var d=0;d<s.length;d++){var _=s[d];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(n,_5(_.key),_)}}function g5(n,s,d){return s&&m5(n.prototype,s),Object.defineProperty(n,"prototype",{writable:!1}),n}function _5(n){var s=y5(n,"string");return Iu(s)=="symbol"?s:s+""}function y5(n,s){if(Iu(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Iu(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var v5=function(){function n(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};p5(this,n),this.element=s,this.listener=d}return g5(n,[{key:"bindScrollListener",value:function(){this.scrollableParents=i2(this.element);for(var d=0;d<this.scrollableParents.length;d++)this.scrollableParents[d].addEventListener("scroll",this.listener)}},{key:"unbindScrollListener",value:function(){if(this.scrollableParents)for(var d=0;d<this.scrollableParents.length;d++)this.scrollableParents[d].removeEventListener("scroll",this.listener)}},{key:"destroy",value:function(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}])}(),ws={_loadedStyleNames:new Set,getLoadedStyleNames:function(){return this._loadedStyleNames},isStyleNameLoaded:function(s){return this._loadedStyleNames.has(s)},setLoadedStyleName:function(s){this._loadedStyleNames.add(s)},deleteLoadedStyleName:function(s){this._loadedStyleNames.delete(s)},clearLoadedStyleNames:function(){this._loadedStyleNames.clear()}};function Eu(n){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Eu(n)}function ey(n,s){return C5(n)||w5(n,s)||x5(n,s)||b5()}function b5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x5(n,s){if(n){if(typeof n=="string")return ty(n,s);var d={}.toString.call(n).slice(8,-1);return d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set"?Array.from(n):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?ty(n,s):void 0}}function ty(n,s){(s==null||s>n.length)&&(s=n.length);for(var d=0,_=Array(s);d<s;d++)_[d]=n[d];return _}function w5(n,s){var d=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(d!=null){var _,w,P,b,c=[],R=!0,Z=!1;try{if(P=(d=d.call(n)).next,s!==0)for(;!(R=(_=P.call(d)).done)&&(c.push(_.value),c.length!==s);R=!0);}catch(V){Z=!0,w=V}finally{try{if(!R&&d.return!=null&&(b=d.return(),Object(b)!==b))return}finally{if(Z)throw w}}return c}}function C5(n){if(Array.isArray(n))return n}function ry(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);s&&(_=_.filter(function(w){return Object.getOwnPropertyDescriptor(n,w).enumerable})),d.push.apply(d,_)}return d}function tr(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?ry(Object(d),!0).forEach(function(_){Op(n,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):ry(Object(d)).forEach(function(_){Object.defineProperty(n,_,Object.getOwnPropertyDescriptor(d,_))})}return n}function Op(n,s,d){return(s=S5(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function S5(n){var s=T5(n,"string");return Eu(s)=="symbol"?s:s+""}function T5(n,s){if(Eu(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Eu(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var Zt={_getMeta:function(){return[fn(arguments.length<=0?void 0:arguments[0])||arguments.length<=0?void 0:arguments[0],Li(fn(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:arguments.length<=1?void 0:arguments[1])]},_getConfig:function(s,d){var _,w,P;return(_=(s==null||(w=s.instance)===null||w===void 0?void 0:w.$primevue)||(d==null||(P=d.ctx)===null||P===void 0||(P=P.appContext)===null||P===void 0||(P=P.config)===null||P===void 0||(P=P.globalProperties)===null||P===void 0?void 0:P.$primevue))===null||_===void 0?void 0:_.config},_getOptionValue:cm,_getPTValue:function(){var s,d,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,R=function(){var lt=Zt._getOptionValue.apply(Zt,arguments);return mi(lt)||Od(lt)?{class:lt}:lt},Z=((s=_.binding)===null||s===void 0||(s=s.value)===null||s===void 0?void 0:s.ptOptions)||((d=_.$primevueConfig)===null||d===void 0?void 0:d.ptOptions)||{},V=Z.mergeSections,H=V===void 0?!0:V,K=Z.mergeProps,G=K===void 0?!1:K,fe=c?Zt._useDefaultPT(_,_.defaultPT(),R,P,b):void 0,Be=Zt._usePT(_,Zt._getPT(w,_.$name),R,P,tr(tr({},b),{},{global:fe||{}})),et=Zt._getPTDatasets(_,P);return H||!H&&Be?G?Zt._mergeProps(_,G,fe,Be,et):tr(tr(tr({},fe),Be),et):tr(tr({},Be),et)},_getPTDatasets:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",_="data-pc-";return tr(tr({},d==="root"&&Op({},"".concat(_,"name"),hn(s.$name))),{},Op({},"".concat(_,"section"),hn(d)))},_getPT:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",_=arguments.length>2?arguments[2]:void 0,w=function(b){var c,R=_?_(b):b,Z=hn(d);return(c=R==null?void 0:R[Z])!==null&&c!==void 0?c:R};return s&&Object.hasOwn(s,"_usept")?{_usept:s._usept,originalValue:w(s.originalValue),value:w(s.value)}:w(s)},_usePT:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1?arguments[1]:void 0,_=arguments.length>2?arguments[2]:void 0,w=arguments.length>3?arguments[3]:void 0,P=arguments.length>4?arguments[4]:void 0,b=function(et){return _(et,w,P)};if(d&&Object.hasOwn(d,"_usept")){var c,R=d._usept||((c=s.$primevueConfig)===null||c===void 0?void 0:c.ptOptions)||{},Z=R.mergeSections,V=Z===void 0?!0:Z,H=R.mergeProps,K=H===void 0?!1:H,G=b(d.originalValue),fe=b(d.value);return G===void 0&&fe===void 0?void 0:mi(fe)?fe:mi(G)?G:V||!V&&fe?K?Zt._mergeProps(s,K,G,fe):tr(tr({},G),fe):fe}return b(d)},_useDefaultPT:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=arguments.length>2?arguments[2]:void 0,w=arguments.length>3?arguments[3]:void 0,P=arguments.length>4?arguments[4]:void 0;return Zt._usePT(s,d,_,w,P)},_loadStyles:function(){var s,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=arguments.length>1?arguments[1]:void 0,w=arguments.length>2?arguments[2]:void 0,P=Zt._getConfig(_,w),b={nonce:P==null||(s=P.csp)===null||s===void 0?void 0:s.nonce};Zt._loadCoreStyles(d,b),Zt._loadThemeStyles(d,b),Zt._loadScopedThemeStyles(d,b),Zt._removeThemeListeners(d),d.$loadStyles=function(){return Zt._loadThemeStyles(d,b)},Zt._themeChangeListener(d.$loadStyles)},_loadCoreStyles:function(){var s,d,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},w=arguments.length>1?arguments[1]:void 0;if(!ws.isStyleNameLoaded((s=_.$style)===null||s===void 0?void 0:s.name)&&(d=_.$style)!==null&&d!==void 0&&d.name){var P;jr.loadCSS(w),(P=_.$style)===null||P===void 0||P.loadCSS(w),ws.setLoadedStyleName(_.$style.name)}},_loadThemeStyles:function(){var s,d,_,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},P=arguments.length>1?arguments[1]:void 0;if(!(w!=null&&w.isUnstyled()||(w==null||(s=w.theme)===null||s===void 0?void 0:s.call(w))==="none")){if(!dr.isStyleNameLoaded("common")){var b,c,R=((b=w.$style)===null||b===void 0||(c=b.getCommonTheme)===null||c===void 0?void 0:c.call(b))||{},Z=R.primitive,V=R.semantic,H=R.global,K=R.style;jr.load(Z==null?void 0:Z.css,tr({name:"primitive-variables"},P)),jr.load(V==null?void 0:V.css,tr({name:"semantic-variables"},P)),jr.load(H==null?void 0:H.css,tr({name:"global-variables"},P)),jr.loadStyle(tr({name:"global-style"},P),K),dr.setLoadedStyleName("common")}if(!dr.isStyleNameLoaded((d=w.$style)===null||d===void 0?void 0:d.name)&&(_=w.$style)!==null&&_!==void 0&&_.name){var G,fe,Be,et,We=((G=w.$style)===null||G===void 0||(fe=G.getDirectiveTheme)===null||fe===void 0?void 0:fe.call(G))||{},lt=We.css,st=We.style;(Be=w.$style)===null||Be===void 0||Be.load(lt,tr({name:"".concat(w.$style.name,"-variables")},P)),(et=w.$style)===null||et===void 0||et.loadStyle(tr({name:"".concat(w.$style.name,"-style")},P),st),dr.setLoadedStyleName(w.$style.name)}if(!dr.isStyleNameLoaded("layer-order")){var ye,Ae,Ye=(ye=w.$style)===null||ye===void 0||(Ae=ye.getLayerOrderThemeCSS)===null||Ae===void 0?void 0:Ae.call(ye);jr.load(Ye,tr({name:"layer-order",first:!0},P)),dr.setLoadedStyleName("layer-order")}}},_loadScopedThemeStyles:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1?arguments[1]:void 0,_=s.preset();if(_&&s.$attrSelector){var w,P,b,c=((w=s.$style)===null||w===void 0||(P=w.getPresetTheme)===null||P===void 0?void 0:P.call(w,_,"[".concat(s.$attrSelector,"]")))||{},R=c.css,Z=(b=s.$style)===null||b===void 0?void 0:b.load(R,tr({name:"".concat(s.$attrSelector,"-").concat(s.$style.name)},d));s.scopedStyleEl=Z.el}},_themeChangeListener:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};ws.clearLoadedStyleNames(),Mo.on("theme:change",s)},_removeThemeListeners:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Mo.off("theme:change",s.$loadStyles)},_hook:function(s,d,_,w,P,b){var c,R,Z="on".concat(Z1(d)),V=Zt._getConfig(w,P),H=_==null?void 0:_.$instance,K=Zt._usePT(H,Zt._getPT(w==null||(c=w.value)===null||c===void 0?void 0:c.pt,s),Zt._getOptionValue,"hooks.".concat(Z)),G=Zt._useDefaultPT(H,V==null||(R=V.pt)===null||R===void 0||(R=R.directives)===null||R===void 0?void 0:R[s],Zt._getOptionValue,"hooks.".concat(Z)),fe={el:_,binding:w,vnode:P,prevVnode:b};K==null||K(H,fe),G==null||G(H,fe)},_mergeProps:function(){for(var s=arguments.length>1?arguments[1]:void 0,d=arguments.length,_=new Array(d>2?d-2:0),w=2;w<d;w++)_[w-2]=arguments[w];return lm(s)?s.apply(void 0,_):ks.apply(void 0,_)},_extend:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=function(c,R,Z,V,H){var K,G,fe,Be;R._$instances=R._$instances||{};var et=Zt._getConfig(Z,V),We=R._$instances[s]||{},lt=Fd(We)?tr(tr({},d),d==null?void 0:d.methods):{};R._$instances[s]=tr(tr({},We),{},{$name:s,$host:R,$binding:Z,$modifiers:Z==null?void 0:Z.modifiers,$value:Z==null?void 0:Z.value,$el:We.$el||R||void 0,$style:tr({classes:void 0,inlineStyles:void 0,load:function(){},loadCSS:function(){},loadStyle:function(){}},d==null?void 0:d.style),$primevueConfig:et,$attrSelector:(K=R.$pd)===null||K===void 0||(K=K[s])===null||K===void 0?void 0:K.attrSelector,defaultPT:function(){return Zt._getPT(et==null?void 0:et.pt,void 0,function(ye){var Ae;return ye==null||(Ae=ye.directives)===null||Ae===void 0?void 0:Ae[s]})},isUnstyled:function(){var ye,Ae;return((ye=R._$instances[s])===null||ye===void 0||(ye=ye.$binding)===null||ye===void 0||(ye=ye.value)===null||ye===void 0?void 0:ye.unstyled)!==void 0?(Ae=R._$instances[s])===null||Ae===void 0||(Ae=Ae.$binding)===null||Ae===void 0||(Ae=Ae.value)===null||Ae===void 0?void 0:Ae.unstyled:et==null?void 0:et.unstyled},theme:function(){var ye;return(ye=R._$instances[s])===null||ye===void 0||(ye=ye.$primevueConfig)===null||ye===void 0?void 0:ye.theme},preset:function(){var ye;return(ye=R._$instances[s])===null||ye===void 0||(ye=ye.$binding)===null||ye===void 0||(ye=ye.value)===null||ye===void 0?void 0:ye.dt},ptm:function(){var ye,Ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Ye=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Zt._getPTValue(R._$instances[s],(ye=R._$instances[s])===null||ye===void 0||(ye=ye.$binding)===null||ye===void 0||(ye=ye.value)===null||ye===void 0?void 0:ye.pt,Ae,tr({},Ye))},ptmo:function(){var ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",Ye=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Zt._getPTValue(R._$instances[s],ye,Ae,Ye,!1)},cx:function(){var ye,Ae,Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(ye=R._$instances[s])!==null&&ye!==void 0&&ye.isUnstyled()?void 0:Zt._getOptionValue((Ae=R._$instances[s])===null||Ae===void 0||(Ae=Ae.$style)===null||Ae===void 0?void 0:Ae.classes,Ye,tr({},nt))},sx:function(){var ye,Ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Ye=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,nt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Ye?Zt._getOptionValue((ye=R._$instances[s])===null||ye===void 0||(ye=ye.$style)===null||ye===void 0?void 0:ye.inlineStyles,Ae,tr({},nt)):void 0}},lt),R.$instance=R._$instances[s],(G=(fe=R.$instance)[c])===null||G===void 0||G.call(fe,R,Z,V,H),R["$".concat(s)]=R.$instance,Zt._hook(s,c,R,Z,V,H),R.$pd||(R.$pd={}),R.$pd[s]=tr(tr({},(Be=R.$pd)===null||Be===void 0?void 0:Be[s]),{},{name:s,instance:R._$instances[s]})},w=function(c){var R,Z,V,H=c._$instances[s],K=H==null?void 0:H.watch,G=function(et){var We,lt=et.newValue,st=et.oldValue;return K==null||(We=K.config)===null||We===void 0?void 0:We.call(H,lt,st)},fe=function(et){var We,lt=et.newValue,st=et.oldValue;return K==null||(We=K["config.ripple"])===null||We===void 0?void 0:We.call(H,lt,st)};H.$watchersCallback={config:G,"config.ripple":fe},K==null||(R=K.config)===null||R===void 0||R.call(H,H==null?void 0:H.$primevueConfig),Cs.on("config:change",G),K==null||(Z=K["config.ripple"])===null||Z===void 0||Z.call(H,H==null||(V=H.$primevueConfig)===null||V===void 0?void 0:V.ripple),Cs.on("config:ripple:change",fe)},P=function(c){var R=c._$instances[s].$watchersCallback;R&&(Cs.off("config:change",R.config),Cs.off("config:ripple:change",R["config.ripple"]))};return{created:function(c,R,Z,V){c.$pd||(c.$pd={}),c.$pd[s]={name:s,attrSelector:s2("pd")},_("created",c,R,Z,V)},beforeMount:function(c,R,Z,V){var H;Zt._loadStyles((H=c.$pd[s])===null||H===void 0?void 0:H.instance,R,Z),_("beforeMount",c,R,Z,V),w(c)},mounted:function(c,R,Z,V){var H;Zt._loadStyles((H=c.$pd[s])===null||H===void 0?void 0:H.instance,R,Z),_("mounted",c,R,Z,V)},beforeUpdate:function(c,R,Z,V){_("beforeUpdate",c,R,Z,V)},updated:function(c,R,Z,V){var H;Zt._loadStyles((H=c.$pd[s])===null||H===void 0?void 0:H.instance,R,Z),_("updated",c,R,Z,V)},beforeUnmount:function(c,R,Z,V){var H;P(c),Zt._removeThemeListeners((H=c.$pd[s])===null||H===void 0?void 0:H.instance),_("beforeUnmount",c,R,Z,V)},unmounted:function(c,R,Z,V){var H;(H=c.$pd[s])===null||H===void 0||(H=H.instance)===null||H===void 0||(H=H.scopedStyleEl)===null||H===void 0||(H=H.value)===null||H===void 0||H.remove(),_("unmounted",c,R,Z,V)}}},extend:function(){var s=Zt._getMeta.apply(Zt,arguments),d=ey(s,2),_=d[0],w=d[1];return tr({extend:function(){var b=Zt._getMeta.apply(Zt,arguments),c=ey(b,2),R=c[0],Z=c[1];return Zt.extend(R,tr(tr(tr({},w),w==null?void 0:w.methods),Z))}},Zt._extend(_,w))}},k5=jr.extend({name:"focustrap-directive"}),P5=Zt.extend({style:k5});function Au(n){"@babel/helpers - typeof";return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Au(n)}function oy(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);s&&(_=_.filter(function(w){return Object.getOwnPropertyDescriptor(n,w).enumerable})),d.push.apply(d,_)}return d}function iy(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?oy(Object(d),!0).forEach(function(_){M5(n,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):oy(Object(d)).forEach(function(_){Object.defineProperty(n,_,Object.getOwnPropertyDescriptor(d,_))})}return n}function M5(n,s,d){return(s=I5(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function I5(n){var s=E5(n,"string");return Au(s)=="symbol"?s:s+""}function E5(n,s){if(Au(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Au(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var A5=P5.extend("focustrap",{mounted:function(s,d){var _=d.value||{},w=_.disabled;w||(this.createHiddenFocusableElements(s,d),this.bind(s,d),this.autoElementFocus(s,d)),s.setAttribute("data-pd-focustrap",!0),this.$el=s},updated:function(s,d){var _=d.value||{},w=_.disabled;w&&this.unbind(s)},unmounted:function(s){this.unbind(s)},methods:{getComputedSelector:function(s){return':not(.p-hidden-focusable):not([data-p-hidden-focusable="true"])'.concat(s??"")},bind:function(s,d){var _=this,w=d.value||{},P=w.onFocusIn,b=w.onFocusOut;s.$_pfocustrap_mutationobserver=new MutationObserver(function(c){c.forEach(function(R){if(R.type==="childList"&&!s.contains(document.activeElement)){var Z=function(H){var K=N_(H)?N_(H,_.getComputedSelector(s.$_pfocustrap_focusableselector))?H:tu(s,_.getComputedSelector(s.$_pfocustrap_focusableselector)):tu(H);return Ir(K)?K:H.nextSibling&&Z(H.nextSibling)};su(Z(R.nextSibling))}})}),s.$_pfocustrap_mutationobserver.disconnect(),s.$_pfocustrap_mutationobserver.observe(s,{childList:!0}),s.$_pfocustrap_focusinlistener=function(c){return P&&P(c)},s.$_pfocustrap_focusoutlistener=function(c){return b&&b(c)},s.addEventListener("focusin",s.$_pfocustrap_focusinlistener),s.addEventListener("focusout",s.$_pfocustrap_focusoutlistener)},unbind:function(s){s.$_pfocustrap_mutationobserver&&s.$_pfocustrap_mutationobserver.disconnect(),s.$_pfocustrap_focusinlistener&&s.removeEventListener("focusin",s.$_pfocustrap_focusinlistener)&&(s.$_pfocustrap_focusinlistener=null),s.$_pfocustrap_focusoutlistener&&s.removeEventListener("focusout",s.$_pfocustrap_focusoutlistener)&&(s.$_pfocustrap_focusoutlistener=null)},autoFocus:function(s){this.autoElementFocus(this.$el,{value:iy(iy({},s),{},{autoFocus:!0})})},autoElementFocus:function(s,d){var _=d.value||{},w=_.autoFocusSelector,P=w===void 0?"":w,b=_.firstFocusableSelector,c=b===void 0?"":b,R=_.autoFocus,Z=R===void 0?!1:R,V=tu(s,"[autofocus]".concat(this.getComputedSelector(P)));Z&&!V&&(V=tu(s,this.getComputedSelector(c))),su(V)},onFirstHiddenElementFocus:function(s){var d,_=s.currentTarget,w=s.relatedTarget,P=w===_.$_pfocustrap_lasthiddenfocusableelement||!((d=this.$el)!==null&&d!==void 0&&d.contains(w))?tu(_.parentElement,this.getComputedSelector(_.$_pfocustrap_focusableselector)):_.$_pfocustrap_lasthiddenfocusableelement;su(P)},onLastHiddenElementFocus:function(s){var d,_=s.currentTarget,w=s.relatedTarget,P=w===_.$_pfocustrap_firsthiddenfocusableelement||!((d=this.$el)!==null&&d!==void 0&&d.contains(w))?r2(_.parentElement,this.getComputedSelector(_.$_pfocustrap_focusableselector)):_.$_pfocustrap_firsthiddenfocusableelement;su(P)},createHiddenFocusableElements:function(s,d){var _=this,w=d.value||{},P=w.tabIndex,b=P===void 0?0:P,c=w.firstFocusableSelector,R=c===void 0?"":c,Z=w.lastFocusableSelector,V=Z===void 0?"":Z,H=function(Be){return V0("span",{class:"p-hidden-accessible p-hidden-focusable",tabIndex:b,role:"presentation","aria-hidden":!0,"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0,onFocus:Be==null?void 0:Be.bind(_)})},K=H(this.onFirstHiddenElementFocus),G=H(this.onLastHiddenElementFocus);K.$_pfocustrap_lasthiddenfocusableelement=G,K.$_pfocustrap_focusableselector=R,K.setAttribute("data-pc-section","firstfocusableelement"),G.$_pfocustrap_firsthiddenfocusableelement=K,G.$_pfocustrap_focusableselector=V,G.setAttribute("data-pc-section","lastfocusableelement"),s.prepend(K),s.append(G)}}}),od=um(),ev={name:"Portal",props:{appendTo:{type:[String,Object],default:"body"},disabled:{type:Boolean,default:!1}},data:function(){return{mounted:!1}},mounted:function(){this.mounted=hm()},computed:{inline:function(){return this.disabled||this.appendTo==="self"}}};function z5(n,s,d,_,w,P){return P.inline?md(n.$slots,"default",{key:0}):w.mounted?(pi(),pa(jx,{key:1,to:d.appendTo},[md(n.$slots,"default")],8,["to"])):Dd("",!0)}ev.render=z5;var R5=({dt:n})=>`
.p-ink {
    display: block;
    position: absolute;
    background: ${n("ripple.background")};
    border-radius: 100%;
    transform: scale(0);
    pointer-events: none;
}

.p-ink-active {
    animation: ripple 0.4s linear;
}

@keyframes ripple {
    100% {
        opacity: 0;
        transform: scale(2.5);
    }
}
`,D5={root:"p-ink"},B5=jr.extend({name:"ripple-directive",style:R5,classes:D5}),L5=Zt.extend({style:B5});function zu(n){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},zu(n)}function F5(n){return N5(n)||j5(n)||$5(n)||O5()}function O5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $5(n,s){if(n){if(typeof n=="string")return $p(n,s);var d={}.toString.call(n).slice(8,-1);return d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set"?Array.from(n):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?$p(n,s):void 0}}function j5(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function N5(n){if(Array.isArray(n))return $p(n)}function $p(n,s){(s==null||s>n.length)&&(s=n.length);for(var d=0,_=Array(s);d<s;d++)_[d]=n[d];return _}function ny(n,s,d){return(s=V5(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function V5(n){var s=U5(n,"string");return zu(s)=="symbol"?s:s+""}function U5(n,s){if(zu(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(zu(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var Z5=L5.extend("ripple",{watch:{"config.ripple":function(s){s?(this.createRipple(this.$host),this.bindEvents(this.$host),this.$host.setAttribute("data-pd-ripple",!0),this.$host.style.overflow="hidden",this.$host.style.position="relative"):(this.remove(this.$host),this.$host.removeAttribute("data-pd-ripple"))}},unmounted:function(s){this.remove(s)},timeout:void 0,methods:{bindEvents:function(s){s.addEventListener("mousedown",this.onMouseDown.bind(this))},unbindEvents:function(s){s.removeEventListener("mousedown",this.onMouseDown.bind(this))},createRipple:function(s){var d=this.getInk(s);d||(d=V0("span",ny(ny({role:"presentation","aria-hidden":!0,"data-p-ink":!0,"data-p-ink-active":!1,class:!this.isUnstyled()&&this.cx("root"),onAnimationEnd:this.onAnimationEnd.bind(this)},this.$attrSelector,""),"p-bind",this.ptm("root"))),s.appendChild(d),this.$el=d)},remove:function(s){var d=this.getInk(s);d&&(this.$host.style.overflow="",this.$host.style.position="",this.unbindEvents(s),d.removeEventListener("animationend",this.onAnimationEnd),d.remove())},onMouseDown:function(s){var d=this,_=s.currentTarget,w=this.getInk(_);if(!(!w||getComputedStyle(w,null).display==="none")){if(!this.isUnstyled()&&pp(w,"p-ink-active"),w.setAttribute("data-p-ink-active","false"),!$_(w)&&!j_(w)){var P=Math.max(J1(_),o2(_));w.style.height=P+"px",w.style.width=P+"px"}var b=Bp(_),c=s.pageX-b.left+document.body.scrollTop-j_(w)/2,R=s.pageY-b.top+document.body.scrollLeft-$_(w)/2;w.style.top=R+"px",w.style.left=c+"px",!this.isUnstyled()&&j0(w,"p-ink-active"),w.setAttribute("data-p-ink-active","true"),this.timeout=setTimeout(function(){w&&(!d.isUnstyled()&&pp(w,"p-ink-active"),w.setAttribute("data-p-ink-active","false"))},401)}},onAnimationEnd:function(s){this.timeout&&clearTimeout(this.timeout),!this.isUnstyled()&&pp(s.currentTarget,"p-ink-active"),s.currentTarget.setAttribute("data-p-ink-active","false")},getInk:function(s){return s&&s.children?F5(s.children).find(function(d){return t2(d,"data-pc-name")==="ripple"}):void 0}}});function G5(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"pc",s=Zx();return"".concat(n).concat(s.replace("v-","").replaceAll("-","_"))}var sy=jr.extend({name:"common"});function Ru(n){"@babel/helpers - typeof";return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Ru(n)}function q5(n){return ov(n)||W5(n)||rv(n)||tv()}function W5(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function ru(n,s){return ov(n)||H5(n,s)||rv(n,s)||tv()}function tv(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rv(n,s){if(n){if(typeof n=="string")return ay(n,s);var d={}.toString.call(n).slice(8,-1);return d==="Object"&&n.constructor&&(d=n.constructor.name),d==="Map"||d==="Set"?Array.from(n):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?ay(n,s):void 0}}function ay(n,s){(s==null||s>n.length)&&(s=n.length);for(var d=0,_=Array(s);d<s;d++)_[d]=n[d];return _}function H5(n,s){var d=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(d!=null){var _,w,P,b,c=[],R=!0,Z=!1;try{if(P=(d=d.call(n)).next,s===0){if(Object(d)!==d)return;R=!1}else for(;!(R=(_=P.call(d)).done)&&(c.push(_.value),c.length!==s);R=!0);}catch(V){Z=!0,w=V}finally{try{if(!R&&d.return!=null&&(b=d.return(),Object(b)!==b))return}finally{if(Z)throw w}}return c}}function ov(n){if(Array.isArray(n))return n}function ly(n,s){var d=Object.keys(n);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(n);s&&(_=_.filter(function(w){return Object.getOwnPropertyDescriptor(n,w).enumerable})),d.push.apply(d,_)}return d}function Qt(n){for(var s=1;s<arguments.length;s++){var d=arguments[s]!=null?arguments[s]:{};s%2?ly(Object(d),!0).forEach(function(_){au(n,_,d[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(d)):ly(Object(d)).forEach(function(_){Object.defineProperty(n,_,Object.getOwnPropertyDescriptor(d,_))})}return n}function au(n,s,d){return(s=X5(s))in n?Object.defineProperty(n,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[s]=d,n}function X5(n){var s=K5(n,"string");return Ru(s)=="symbol"?s:s+""}function K5(n,s){if(Ru(n)!="object"||!n)return n;var d=n[Symbol.toPrimitive];if(d!==void 0){var _=d.call(n,s);if(Ru(_)!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}var Y5={name:"BaseComponent",props:{pt:{type:Object,default:void 0},ptOptions:{type:Object,default:void 0},unstyled:{type:Boolean,default:void 0},dt:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0}},watch:{isUnstyled:{immediate:!0,handler:function(s){Mo.off("theme:change",this._loadCoreStyles),s||(this._loadCoreStyles(),this._themeChangeListener(this._loadCoreStyles))}},dt:{immediate:!0,handler:function(s,d){var _=this;Mo.off("theme:change",this._themeScopedListener),s?(this._loadScopedThemeStyles(s),this._themeScopedListener=function(){return _._loadScopedThemeStyles(s)},this._themeChangeListener(this._themeScopedListener)):this._unloadScopedThemeStyles()}}},scopedStyleEl:void 0,rootEl:void 0,uid:void 0,$attrSelector:void 0,beforeCreate:function(){var s,d,_,w,P,b,c,R,Z,V,H,K=(s=this.pt)===null||s===void 0?void 0:s._usept,G=K?(d=this.pt)===null||d===void 0||(d=d.originalValue)===null||d===void 0?void 0:d[this.$.type.name]:void 0,fe=K?(_=this.pt)===null||_===void 0||(_=_.value)===null||_===void 0?void 0:_[this.$.type.name]:this.pt;(w=fe||G)===null||w===void 0||(w=w.hooks)===null||w===void 0||(P=w.onBeforeCreate)===null||P===void 0||P.call(w);var Be=(b=this.$primevueConfig)===null||b===void 0||(b=b.pt)===null||b===void 0?void 0:b._usept,et=Be?(c=this.$primevue)===null||c===void 0||(c=c.config)===null||c===void 0||(c=c.pt)===null||c===void 0?void 0:c.originalValue:void 0,We=Be?(R=this.$primevue)===null||R===void 0||(R=R.config)===null||R===void 0||(R=R.pt)===null||R===void 0?void 0:R.value:(Z=this.$primevue)===null||Z===void 0||(Z=Z.config)===null||Z===void 0?void 0:Z.pt;(V=We||et)===null||V===void 0||(V=V[this.$.type.name])===null||V===void 0||(V=V.hooks)===null||V===void 0||(H=V.onBeforeCreate)===null||H===void 0||H.call(V),this.$attrSelector=G5(),this.uid=this.$attrs.id||this.$attrSelector.replace("pc","pv_id_")},created:function(){this._hook("onCreated")},beforeMount:function(){var s;this.rootEl=U0(ga(this.$el)?this.$el:(s=this.$el)===null||s===void 0?void 0:s.parentElement,"[".concat(this.$attrSelector,"]")),this.rootEl&&(this.rootEl.$pc=Qt({name:this.$.type.name,attrSelector:this.$attrSelector},this.$params)),this._loadStyles(),this._hook("onBeforeMount")},mounted:function(){this._hook("onMounted")},beforeUpdate:function(){this._hook("onBeforeUpdate")},updated:function(){this._hook("onUpdated")},beforeUnmount:function(){this._hook("onBeforeUnmount")},unmounted:function(){this._removeThemeListeners(),this._unloadScopedThemeStyles(),this._hook("onUnmounted")},methods:{_hook:function(s){if(!this.$options.hostName){var d=this._usePT(this._getPT(this.pt,this.$.type.name),this._getOptionValue,"hooks.".concat(s)),_=this._useDefaultPT(this._getOptionValue,"hooks.".concat(s));d==null||d(),_==null||_()}},_mergeProps:function(s){for(var d=arguments.length,_=new Array(d>1?d-1:0),w=1;w<d;w++)_[w-1]=arguments[w];return lm(s)?s.apply(void 0,_):ks.apply(void 0,_)},_load:function(){ws.isStyleNameLoaded("base")||(jr.loadCSS(this.$styleOptions),this._loadGlobalStyles(),ws.setLoadedStyleName("base")),this._loadThemeStyles()},_loadStyles:function(){this._load(),this._themeChangeListener(this._load)},_loadCoreStyles:function(){var s,d;!ws.isStyleNameLoaded((s=this.$style)===null||s===void 0?void 0:s.name)&&(d=this.$style)!==null&&d!==void 0&&d.name&&(sy.loadCSS(this.$styleOptions),this.$options.style&&this.$style.loadCSS(this.$styleOptions),ws.setLoadedStyleName(this.$style.name))},_loadGlobalStyles:function(){var s=this._useGlobalPT(this._getOptionValue,"global.css",this.$params);Ir(s)&&jr.load(s,Qt({name:"global"},this.$styleOptions))},_loadThemeStyles:function(){var s,d;if(!(this.isUnstyled||this.$theme==="none")){if(!dr.isStyleNameLoaded("common")){var _,w,P=((_=this.$style)===null||_===void 0||(w=_.getCommonTheme)===null||w===void 0?void 0:w.call(_))||{},b=P.primitive,c=P.semantic,R=P.global,Z=P.style;jr.load(b==null?void 0:b.css,Qt({name:"primitive-variables"},this.$styleOptions)),jr.load(c==null?void 0:c.css,Qt({name:"semantic-variables"},this.$styleOptions)),jr.load(R==null?void 0:R.css,Qt({name:"global-variables"},this.$styleOptions)),jr.loadStyle(Qt({name:"global-style"},this.$styleOptions),Z),dr.setLoadedStyleName("common")}if(!dr.isStyleNameLoaded((s=this.$style)===null||s===void 0?void 0:s.name)&&(d=this.$style)!==null&&d!==void 0&&d.name){var V,H,K,G,fe=((V=this.$style)===null||V===void 0||(H=V.getComponentTheme)===null||H===void 0?void 0:H.call(V))||{},Be=fe.css,et=fe.style;(K=this.$style)===null||K===void 0||K.load(Be,Qt({name:"".concat(this.$style.name,"-variables")},this.$styleOptions)),(G=this.$style)===null||G===void 0||G.loadStyle(Qt({name:"".concat(this.$style.name,"-style")},this.$styleOptions),et),dr.setLoadedStyleName(this.$style.name)}if(!dr.isStyleNameLoaded("layer-order")){var We,lt,st=(We=this.$style)===null||We===void 0||(lt=We.getLayerOrderThemeCSS)===null||lt===void 0?void 0:lt.call(We);jr.load(st,Qt({name:"layer-order",first:!0},this.$styleOptions)),dr.setLoadedStyleName("layer-order")}}},_loadScopedThemeStyles:function(s){var d,_,w,P=((d=this.$style)===null||d===void 0||(_=d.getPresetTheme)===null||_===void 0?void 0:_.call(d,s,"[".concat(this.$attrSelector,"]")))||{},b=P.css,c=(w=this.$style)===null||w===void 0?void 0:w.load(b,Qt({name:"".concat(this.$attrSelector,"-").concat(this.$style.name)},this.$styleOptions));this.scopedStyleEl=c.el},_unloadScopedThemeStyles:function(){var s;(s=this.scopedStyleEl)===null||s===void 0||(s=s.value)===null||s===void 0||s.remove()},_themeChangeListener:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};ws.clearLoadedStyleNames(),Mo.on("theme:change",s)},_removeThemeListeners:function(){Mo.off("theme:change",this._loadCoreStyles),Mo.off("theme:change",this._load),Mo.off("theme:change",this._themeScopedListener)},_getHostInstance:function(s){return s?this.$options.hostName?s.$.type.name===this.$options.hostName?s:this._getHostInstance(s.$parentInstance):s.$parentInstance:void 0},_getPropValue:function(s){var d;return this[s]||((d=this._getHostInstance(this))===null||d===void 0?void 0:d[s])},_getOptionValue:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return cm(s,d,_)},_getPTValue:function(){var s,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,b=/./g.test(_)&&!!w[_.split(".")[0]],c=this._getPropValue("ptOptions")||((s=this.$primevueConfig)===null||s===void 0?void 0:s.ptOptions)||{},R=c.mergeSections,Z=R===void 0?!0:R,V=c.mergeProps,H=V===void 0?!1:V,K=P?b?this._useGlobalPT(this._getPTClassValue,_,w):this._useDefaultPT(this._getPTClassValue,_,w):void 0,G=b?void 0:this._getPTSelf(d,this._getPTClassValue,_,Qt(Qt({},w),{},{global:K||{}})),fe=this._getPTDatasets(_);return Z||!Z&&G?H?this._mergeProps(H,K,G,fe):Qt(Qt(Qt({},K),G),fe):Qt(Qt({},G),fe)},_getPTSelf:function(){for(var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length,_=new Array(d>1?d-1:0),w=1;w<d;w++)_[w-1]=arguments[w];return ks(this._usePT.apply(this,[this._getPT(s,this.$name)].concat(_)),this._usePT.apply(this,[this.$_attrsPT].concat(_)))},_getPTDatasets:function(){var s,d,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",w="data-pc-",P=_==="root"&&Ir((s=this.pt)===null||s===void 0?void 0:s["data-pc-section"]);return _!=="transition"&&Qt(Qt({},_==="root"&&Qt(Qt(au({},"".concat(w,"name"),hn(P?(d=this.pt)===null||d===void 0?void 0:d["data-pc-section"]:this.$.type.name)),P&&au({},"".concat(w,"extend"),hn(this.$.type.name))),{},au({},"".concat(this.$attrSelector),""))),{},au({},"".concat(w,"section"),hn(_)))},_getPTClassValue:function(){var s=this._getOptionValue.apply(this,arguments);return mi(s)||Od(s)?{class:s}:s},_getPT:function(s){var d=this,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",w=arguments.length>2?arguments[2]:void 0,P=function(c){var R,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,V=w?w(c):c,H=hn(_),K=hn(d.$name);return(R=Z?H!==K?V==null?void 0:V[H]:void 0:V==null?void 0:V[H])!==null&&R!==void 0?R:V};return s!=null&&s.hasOwnProperty("_usept")?{_usept:s._usept,originalValue:P(s.originalValue),value:P(s.value)}:P(s,!0)},_usePT:function(s,d,_,w){var P=function(Be){return d(Be,_,w)};if(s!=null&&s.hasOwnProperty("_usept")){var b,c=s._usept||((b=this.$primevueConfig)===null||b===void 0?void 0:b.ptOptions)||{},R=c.mergeSections,Z=R===void 0?!0:R,V=c.mergeProps,H=V===void 0?!1:V,K=P(s.originalValue),G=P(s.value);return K===void 0&&G===void 0?void 0:mi(G)?G:mi(K)?K:Z||!Z&&G?H?this._mergeProps(H,K,G):Qt(Qt({},K),G):G}return P(s)},_useGlobalPT:function(s,d,_){return this._usePT(this.globalPT,s,d,_)},_useDefaultPT:function(s,d,_){return this._usePT(this.defaultPT,s,d,_)},ptm:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._getPTValue(this.pt,s,Qt(Qt({},this.$params),d))},ptmi:function(){var s,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},w=ks(this.$_attrsWithoutPT,this.ptm(d,_));return w!=null&&w.hasOwnProperty("id")&&((s=w.id)!==null&&s!==void 0||(w.id=this.$id)),w},ptmo:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._getPTValue(s,d,Qt({instance:this},_),!1)},cx:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isUnstyled?void 0:this._getOptionValue(this.$style.classes,s,Qt(Qt({},this.$params),d))},sx:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(d){var w=this._getOptionValue(this.$style.inlineStyles,s,Qt(Qt({},this.$params),_)),P=this._getOptionValue(sy.inlineStyles,s,Qt(Qt({},this.$params),_));return[P,w]}}},computed:{globalPT:function(){var s,d=this;return this._getPT((s=this.$primevueConfig)===null||s===void 0?void 0:s.pt,void 0,function(_){return Li(_,{instance:d})})},defaultPT:function(){var s,d=this;return this._getPT((s=this.$primevueConfig)===null||s===void 0?void 0:s.pt,void 0,function(_){return d._getOptionValue(_,d.$name,Qt({},d.$params))||Li(_,Qt({},d.$params))})},isUnstyled:function(){var s;return this.unstyled!==void 0?this.unstyled:(s=this.$primevueConfig)===null||s===void 0?void 0:s.unstyled},$id:function(){return this.$attrs.id||this.uid},$inProps:function(){var s,d=Object.keys(((s=this.$.vnode)===null||s===void 0?void 0:s.props)||{});return Object.fromEntries(Object.entries(this.$props).filter(function(_){var w=ru(_,1),P=w[0];return d==null?void 0:d.includes(P)}))},$theme:function(){var s;return(s=this.$primevueConfig)===null||s===void 0?void 0:s.theme},$style:function(){return Qt(Qt({classes:void 0,inlineStyles:void 0,load:function(){},loadCSS:function(){},loadStyle:function(){}},(this._getHostInstance(this)||{}).$style),this.$options.style)},$styleOptions:function(){var s;return{nonce:(s=this.$primevueConfig)===null||s===void 0||(s=s.csp)===null||s===void 0?void 0:s.nonce}},$primevueConfig:function(){var s;return(s=this.$primevue)===null||s===void 0?void 0:s.config},$name:function(){return this.$options.hostName||this.$.type.name},$params:function(){var s=this._getHostInstance(this)||this.$parent;return{instance:this,props:this.$props,state:this.$data,attrs:this.$attrs,parent:{instance:s,props:s==null?void 0:s.$props,state:s==null?void 0:s.$data,attrs:s==null?void 0:s.$attrs}}},$_attrsPT:function(){return Object.entries(this.$attrs||{}).filter(function(s){var d=ru(s,1),_=d[0];return _==null?void 0:_.startsWith("pt:")}).reduce(function(s,d){var _=ru(d,2),w=_[0],P=_[1],b=w.split(":"),c=q5(b),R=c.slice(1);return R==null||R.reduce(function(Z,V,H,K){return!Z[V]&&(Z[V]=H===K.length-1?P:{}),Z[V]},s),s},{})},$_attrsWithoutPT:function(){return Object.entries(this.$attrs||{}).filter(function(s){var d=ru(s,1),_=d[0];return!(_!=null&&_.startsWith("pt:"))}).reduce(function(s,d){var _=ru(d,2),w=_[0],P=_[1];return s[w]=P,s},{})}}},J5=({dt:n})=>`
.p-popover {
    margin-block-start: ${n("popover.gutter")};
    background: ${n("popover.background")};
    color: ${n("popover.color")};
    border: 1px solid ${n("popover.border.color")};
    border-radius: ${n("popover.border.radius")};
    box-shadow: ${n("popover.shadow")};
}

.p-popover-content {
    padding: ${n("popover.content.padding")};
}

.p-popover-flipped {
    margin-block-start: calc(${n("popover.gutter")} * -1);
    margin-block-end: ${n("popover.gutter")};
}

.p-popover-enter-from {
    opacity: 0;
    transform: scaleY(0.8);
}

.p-popover-leave-to {
    opacity: 0;
}

.p-popover-enter-active {
    transition: transform 0.12s cubic-bezier(0, 0, 0.2, 1), opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
}

.p-popover-leave-active {
    transition: opacity 0.1s linear;
}

.p-popover:after,
.p-popover:before {
    bottom: 100%;
    left: calc(${n("popover.arrow.offset")} + ${n("popover.arrow.left")});
    content: " ";
    height: 0;
    width: 0;
    position: absolute;
    pointer-events: none;
}

.p-popover:after {
    border-width: calc(${n("popover.gutter")} - 2px);
    margin-left: calc(-1 * (${n("popover.gutter")} - 2px));
    border-style: solid;
    border-color: transparent;
    border-bottom-color: ${n("popover.background")};
}

.p-popover:before {
    border-width: ${n("popover.gutter")};
    margin-left: calc(-1 * ${n("popover.gutter")});
    border-style: solid;
    border-color: transparent;
    border-bottom-color: ${n("popover.border.color")};
}

.p-popover-flipped:after,
.p-popover-flipped:before {
    bottom: auto;
    top: 100%;
}

.p-popover.p-popover-flipped:after {
    border-bottom-color: transparent;
    border-top-color: ${n("popover.background")};
}

.p-popover.p-popover-flipped:before {
    border-bottom-color: transparent;
    border-top-color: ${n("popover.border.color")};
}
`,Q5={root:"p-popover p-component",content:"p-popover-content"},ez=jr.extend({name:"popover",style:J5,classes:Q5}),tz={name:"BasePopover",extends:Y5,props:{dismissable:{type:Boolean,default:!0},appendTo:{type:[String,Object],default:"body"},baseZIndex:{type:Number,default:0},autoZIndex:{type:Boolean,default:!0},breakpoints:{type:Object,default:null},closeOnEscape:{type:Boolean,default:!0}},style:ez,provide:function(){return{$pcPopover:this,$parentInstance:this}}},iv={name:"Popover",extends:tz,inheritAttrs:!1,emits:["show","hide"],data:function(){return{visible:!1}},watch:{dismissable:{immediate:!0,handler:function(s){s?this.bindOutsideClickListener():this.unbindOutsideClickListener()}}},selfClick:!1,target:null,eventTarget:null,outsideClickListener:null,scrollHandler:null,resizeListener:null,container:null,styleElement:null,overlayEventListener:null,documentKeydownListener:null,beforeUnmount:function(){this.dismissable&&this.unbindOutsideClickListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.destroyStyle(),this.unbindResizeListener(),this.target=null,this.container&&this.autoZIndex&&mp.clear(this.container),this.overlayEventListener&&(od.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null),this.container=null},mounted:function(){this.breakpoints&&this.createStyle()},methods:{toggle:function(s,d){this.visible?this.hide():this.show(s,d)},show:function(s,d){this.visible=!0,this.eventTarget=s.currentTarget,this.target=d||s.currentTarget},hide:function(){this.visible=!1},onContentClick:function(){this.selfClick=!0},onEnter:function(s){var d=this;Y1(s,{position:"absolute",top:"0",left:"0"}),this.alignOverlay(),this.dismissable&&this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.autoZIndex&&mp.set("overlay",s,this.baseZIndex+this.$primevue.config.zIndex.overlay),this.overlayEventListener=function(_){d.container.contains(_.target)&&(d.selfClick=!0)},this.focus(),od.on("overlay-click",this.overlayEventListener),this.$emit("show"),this.closeOnEscape&&this.bindDocumentKeyDownListener()},onLeave:function(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.unbindDocumentKeyDownListener(),od.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null,this.$emit("hide")},onAfterLeave:function(s){this.autoZIndex&&mp.clear(s)},alignOverlay:function(){K1(this.container,this.target,!1);var s=Bp(this.container),d=Bp(this.target),_=0;s.left<d.left&&(_=d.left-s.left),this.container.style.setProperty(g2("popover.arrow.left").name,"".concat(_,"px")),s.top<d.top&&(this.container.setAttribute("data-p-popover-flipped","true"),!this.isUnstyled&&j0(this.container,"p-popover-flipped"))},onContentKeydown:function(s){s.code==="Escape"&&this.closeOnEscape&&(this.hide(),su(this.target))},onButtonKeydown:function(s){switch(s.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":s.preventDefault()}},focus:function(){var s=this.container.querySelector("[autofocus]");s&&s.focus()},onKeyDown:function(s){s.code==="Escape"&&this.closeOnEscape&&(this.visible=!1)},bindDocumentKeyDownListener:function(){this.documentKeydownListener||(this.documentKeydownListener=this.onKeyDown.bind(this),window.document.addEventListener("keydown",this.documentKeydownListener))},unbindDocumentKeyDownListener:function(){this.documentKeydownListener&&(window.document.removeEventListener("keydown",this.documentKeydownListener),this.documentKeydownListener=null)},bindOutsideClickListener:function(){var s=this;!this.outsideClickListener&&hm()&&(this.outsideClickListener=function(d){s.visible&&!s.selfClick&&!s.isTargetClicked(d)&&(s.visible=!1),s.selfClick=!1},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener:function(){var s=this;this.scrollHandler||(this.scrollHandler=new v5(this.target,function(){s.visible&&(s.visible=!1)})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var s=this;this.resizeListener||(this.resizeListener=function(){s.visible&&!n2()&&(s.visible=!1)},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isTargetClicked:function(s){return this.eventTarget&&(this.eventTarget===s.target||this.eventTarget.contains(s.target))},containerRef:function(s){this.container=s},createStyle:function(){if(!this.styleElement&&!this.isUnstyled){var s;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",q0(this.styleElement,"nonce",(s=this.$primevue)===null||s===void 0||(s=s.config)===null||s===void 0||(s=s.csp)===null||s===void 0?void 0:s.nonce),document.head.appendChild(this.styleElement);var d="";for(var _ in this.breakpoints)d+=`
                        @media screen and (max-width: `.concat(_,`) {
                            .p-popover[`).concat(this.$attrSelector,`] {
                                width: `).concat(this.breakpoints[_],` !important;
                            }
                        }
                    `);this.styleElement.innerHTML=d}},destroyStyle:function(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)},onOverlayClick:function(s){od.emit("overlay-click",{originalEvent:s,target:this.target})}},directives:{focustrap:A5,ripple:Z5},components:{Portal:ev}},rz=["aria-modal"];function oz(n,s,d,_,w,P){var b=rw("Portal"),c=iw("focustrap");return pi(),pa(b,{appendTo:n.appendTo},{default:fd(function(){return[Io(t1,ks({name:"p-popover",onEnter:P.onEnter,onLeave:P.onLeave,onAfterLeave:P.onAfterLeave},n.ptm("transition")),{default:fd(function(){return[w.visible?Ox((pi(),fa("div",ks({key:0,ref:P.containerRef,role:"dialog","aria-modal":w.visible,onClick:s[3]||(s[3]=function(){return P.onOverlayClick&&P.onOverlayClick.apply(P,arguments)}),class:n.cx("root")},n.ptmi("root")),[n.$slots.container?md(n.$slots,"container",{key:0,closeCallback:P.hide,keydownCallback:function(Z){return P.onButtonKeydown(Z)}}):(pi(),fa("div",ks({key:1,class:n.cx("content"),onClick:s[0]||(s[0]=function(){return P.onContentClick&&P.onContentClick.apply(P,arguments)}),onMousedown:s[1]||(s[1]=function(){return P.onContentClick&&P.onContentClick.apply(P,arguments)}),onKeydown:s[2]||(s[2]=function(){return P.onContentKeydown&&P.onContentKeydown.apply(P,arguments)})},n.ptm("content")),[md(n.$slots,"default")],16))],16,rz)),[[c]]):Dd("",!0)]}),_:3},16,["onEnter","onLeave","onAfterLeave"])]}),_:3},8,["appendTo"])}iv.render=oz;const dm=(n,s)=>{const d=n.__vccOpts||n;for(const[_,w]of s)d[_]=w;return d},iz={class:"layer-icon"},nz=["xlink:href"],sz={class:"layer-title"},az={__name:"LayerItem",props:{id:{type:String,required:!0},homeMapLayerType:{type:String,required:!0},position:{type:Number,required:!0},title:{type:String,required:!0},icon:{type:String,required:!1},enabled:{type:Boolean,required:!1,default:!1},visible:{type:Boolean,required:!1,default:!1},multiTemporal:{type:Boolean,required:!1,default:!1}},emits:["update:toggleLayer"],setup(n,{emit:s}){const d=n,_=s,w=No(d.visible),P=No(d.enabled);ki(()=>d.visible,c=>{w.value=c}),ki(()=>d.enabled,c=>{P.value=c});const b=()=>{w.value=!w.value,_("update:toggleLayer",{layerId:d.id,visible:w.value})};return(c,R)=>P.value?(pi(),fa("div",{key:0,class:kd(["layer-control",{active:n.visible}]),onClick:b},[So("div",iz,[(pi(),fa("svg",null,[So("use",{"xlink:href":n.icon?`#${n.icon}`:"#icon-layers"},null,8,nz)]))]),So("div",sz,Gp(n.title),1)],2)):Dd("",!0)}},lz=dm(az,[["__scopeId","data-v-fe358537"]]),nv=6048e5,cz=864e5,cy=Symbol.for("constructDateFrom");function Ms(n,s){return typeof n=="function"?n(s):n&&typeof n=="object"&&cy in n?n[cy](s):n instanceof Date?new n.constructor(s):new Date(s)}function Ki(n,s){return Ms(s||n,n)}let uz={};function $d(){return uz}function Du(n,s){var c,R,Z,V;const d=$d(),_=(s==null?void 0:s.weekStartsOn)??((R=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:R.weekStartsOn)??d.weekStartsOn??((V=(Z=d.locale)==null?void 0:Z.options)==null?void 0:V.weekStartsOn)??0,w=Ki(n,s==null?void 0:s.in),P=w.getDay(),b=(P<_?7:0)+P-_;return w.setDate(w.getDate()-b),w.setHours(0,0,0,0),w}function bd(n,s){return Du(n,{...s,weekStartsOn:1})}function sv(n,s){const d=Ki(n,s==null?void 0:s.in),_=d.getFullYear(),w=Ms(d,0);w.setFullYear(_+1,0,4),w.setHours(0,0,0,0);const P=bd(w),b=Ms(d,0);b.setFullYear(_,0,4),b.setHours(0,0,0,0);const c=bd(b);return d.getTime()>=P.getTime()?_+1:d.getTime()>=c.getTime()?_:_-1}function uy(n){const s=Ki(n),d=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return d.setUTCFullYear(s.getFullYear()),+n-+d}function hz(n,...s){const d=Ms.bind(null,s.find(_=>typeof _=="object"));return s.map(d)}function hy(n,s){const d=Ki(n,s==null?void 0:s.in);return d.setHours(0,0,0,0),d}function dz(n,s,d){const[_,w]=hz(d==null?void 0:d.in,n,s),P=hy(_),b=hy(w),c=+P-uy(P),R=+b-uy(b);return Math.round((c-R)/cz)}function fz(n,s){const d=sv(n,s),_=Ms(n,0);return _.setFullYear(d,0,4),_.setHours(0,0,0,0),bd(_)}function pz(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function mz(n){return!(!pz(n)&&typeof n!="number"||isNaN(+Ki(n)))}function gz(n,s){const d=Ki(n,s==null?void 0:s.in);return d.setFullYear(d.getFullYear(),0,1),d.setHours(0,0,0,0),d}const _z={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},yz=(n,s,d)=>{let _;const w=_z[n];return typeof w=="string"?_=w:s===1?_=w.one:_=w.other.replace("{{count}}",s.toString()),d!=null&&d.addSuffix?d.comparison&&d.comparison>0?"in "+_:_+" ago":_};function yp(n){return(s={})=>{const d=s.width?String(s.width):n.defaultWidth;return n.formats[d]||n.formats[n.defaultWidth]}}const vz={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},bz={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},xz={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},wz={date:yp({formats:vz,defaultWidth:"full"}),time:yp({formats:bz,defaultWidth:"full"}),dateTime:yp({formats:xz,defaultWidth:"full"})},Cz={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Sz=(n,s,d,_)=>Cz[n];function ou(n){return(s,d)=>{const _=d!=null&&d.context?String(d.context):"standalone";let w;if(_==="formatting"&&n.formattingValues){const b=n.defaultFormattingWidth||n.defaultWidth,c=d!=null&&d.width?String(d.width):b;w=n.formattingValues[c]||n.formattingValues[b]}else{const b=n.defaultWidth,c=d!=null&&d.width?String(d.width):n.defaultWidth;w=n.values[c]||n.values[b]}const P=n.argumentCallback?n.argumentCallback(s):s;return w[P]}}const Tz={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},kz={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Pz={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Mz={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Iz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ez={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Az=(n,s)=>{const d=Number(n),_=d%100;if(_>20||_<10)switch(_%10){case 1:return d+"st";case 2:return d+"nd";case 3:return d+"rd"}return d+"th"},zz={ordinalNumber:Az,era:ou({values:Tz,defaultWidth:"wide"}),quarter:ou({values:kz,defaultWidth:"wide",argumentCallback:n=>n-1}),month:ou({values:Pz,defaultWidth:"wide"}),day:ou({values:Mz,defaultWidth:"wide"}),dayPeriod:ou({values:Iz,defaultWidth:"wide",formattingValues:Ez,defaultFormattingWidth:"wide"})};function iu(n){return(s,d={})=>{const _=d.width,w=_&&n.matchPatterns[_]||n.matchPatterns[n.defaultMatchWidth],P=s.match(w);if(!P)return null;const b=P[0],c=_&&n.parsePatterns[_]||n.parsePatterns[n.defaultParseWidth],R=Array.isArray(c)?Dz(c,H=>H.test(b)):Rz(c,H=>H.test(b));let Z;Z=n.valueCallback?n.valueCallback(R):R,Z=d.valueCallback?d.valueCallback(Z):Z;const V=s.slice(b.length);return{value:Z,rest:V}}}function Rz(n,s){for(const d in n)if(Object.prototype.hasOwnProperty.call(n,d)&&s(n[d]))return d}function Dz(n,s){for(let d=0;d<n.length;d++)if(s(n[d]))return d}function Bz(n){return(s,d={})=>{const _=s.match(n.matchPattern);if(!_)return null;const w=_[0],P=s.match(n.parsePattern);if(!P)return null;let b=n.valueCallback?n.valueCallback(P[0]):P[0];b=d.valueCallback?d.valueCallback(b):b;const c=s.slice(w.length);return{value:b,rest:c}}}const Lz=/^(\d+)(th|st|nd|rd)?/i,Fz=/\d+/i,Oz={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},$z={any:[/^b/i,/^(a|c)/i]},jz={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Nz={any:[/1/i,/2/i,/3/i,/4/i]},Vz={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Uz={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Zz={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Gz={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},qz={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Wz={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Hz={ordinalNumber:Bz({matchPattern:Lz,parsePattern:Fz,valueCallback:n=>parseInt(n,10)}),era:iu({matchPatterns:Oz,defaultMatchWidth:"wide",parsePatterns:$z,defaultParseWidth:"any"}),quarter:iu({matchPatterns:jz,defaultMatchWidth:"wide",parsePatterns:Nz,defaultParseWidth:"any",valueCallback:n=>n+1}),month:iu({matchPatterns:Vz,defaultMatchWidth:"wide",parsePatterns:Uz,defaultParseWidth:"any"}),day:iu({matchPatterns:Zz,defaultMatchWidth:"wide",parsePatterns:Gz,defaultParseWidth:"any"}),dayPeriod:iu({matchPatterns:qz,defaultMatchWidth:"any",parsePatterns:Wz,defaultParseWidth:"any"})},Xz={code:"en-US",formatDistance:yz,formatLong:wz,formatRelative:Sz,localize:zz,match:Hz,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Kz(n,s){const d=Ki(n,s==null?void 0:s.in);return dz(d,gz(d))+1}function Yz(n,s){const d=Ki(n,s==null?void 0:s.in),_=+bd(d)-+fz(d);return Math.round(_/nv)+1}function av(n,s){var V,H,K,G;const d=Ki(n,s==null?void 0:s.in),_=d.getFullYear(),w=$d(),P=(s==null?void 0:s.firstWeekContainsDate)??((H=(V=s==null?void 0:s.locale)==null?void 0:V.options)==null?void 0:H.firstWeekContainsDate)??w.firstWeekContainsDate??((G=(K=w.locale)==null?void 0:K.options)==null?void 0:G.firstWeekContainsDate)??1,b=Ms((s==null?void 0:s.in)||n,0);b.setFullYear(_+1,0,P),b.setHours(0,0,0,0);const c=Du(b,s),R=Ms((s==null?void 0:s.in)||n,0);R.setFullYear(_,0,P),R.setHours(0,0,0,0);const Z=Du(R,s);return+d>=+c?_+1:+d>=+Z?_:_-1}function Jz(n,s){var c,R,Z,V;const d=$d(),_=(s==null?void 0:s.firstWeekContainsDate)??((R=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:R.firstWeekContainsDate)??d.firstWeekContainsDate??((V=(Z=d.locale)==null?void 0:Z.options)==null?void 0:V.firstWeekContainsDate)??1,w=av(n,s),P=Ms((s==null?void 0:s.in)||n,0);return P.setFullYear(w,0,_),P.setHours(0,0,0,0),Du(P,s)}function Qz(n,s){const d=Ki(n,s==null?void 0:s.in),_=+Du(d,s)-+Jz(d,s);return Math.round(_/nv)+1}function hr(n,s){const d=n<0?"-":"",_=Math.abs(n).toString().padStart(s,"0");return d+_}const _s={y(n,s){const d=n.getFullYear(),_=d>0?d:1-d;return hr(s==="yy"?_%100:_,s.length)},M(n,s){const d=n.getMonth();return s==="M"?String(d+1):hr(d+1,2)},d(n,s){return hr(n.getDate(),s.length)},a(n,s){const d=n.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return d.toUpperCase();case"aaa":return d;case"aaaaa":return d[0];case"aaaa":default:return d==="am"?"a.m.":"p.m."}},h(n,s){return hr(n.getHours()%12||12,s.length)},H(n,s){return hr(n.getHours(),s.length)},m(n,s){return hr(n.getMinutes(),s.length)},s(n,s){return hr(n.getSeconds(),s.length)},S(n,s){const d=s.length,_=n.getMilliseconds(),w=Math.trunc(_*Math.pow(10,d-3));return hr(w,s.length)}},Tl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},dy={G:function(n,s,d){const _=n.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return d.era(_,{width:"abbreviated"});case"GGGGG":return d.era(_,{width:"narrow"});case"GGGG":default:return d.era(_,{width:"wide"})}},y:function(n,s,d){if(s==="yo"){const _=n.getFullYear(),w=_>0?_:1-_;return d.ordinalNumber(w,{unit:"year"})}return _s.y(n,s)},Y:function(n,s,d,_){const w=av(n,_),P=w>0?w:1-w;if(s==="YY"){const b=P%100;return hr(b,2)}return s==="Yo"?d.ordinalNumber(P,{unit:"year"}):hr(P,s.length)},R:function(n,s){const d=sv(n);return hr(d,s.length)},u:function(n,s){const d=n.getFullYear();return hr(d,s.length)},Q:function(n,s,d){const _=Math.ceil((n.getMonth()+1)/3);switch(s){case"Q":return String(_);case"QQ":return hr(_,2);case"Qo":return d.ordinalNumber(_,{unit:"quarter"});case"QQQ":return d.quarter(_,{width:"abbreviated",context:"formatting"});case"QQQQQ":return d.quarter(_,{width:"narrow",context:"formatting"});case"QQQQ":default:return d.quarter(_,{width:"wide",context:"formatting"})}},q:function(n,s,d){const _=Math.ceil((n.getMonth()+1)/3);switch(s){case"q":return String(_);case"qq":return hr(_,2);case"qo":return d.ordinalNumber(_,{unit:"quarter"});case"qqq":return d.quarter(_,{width:"abbreviated",context:"standalone"});case"qqqqq":return d.quarter(_,{width:"narrow",context:"standalone"});case"qqqq":default:return d.quarter(_,{width:"wide",context:"standalone"})}},M:function(n,s,d){const _=n.getMonth();switch(s){case"M":case"MM":return _s.M(n,s);case"Mo":return d.ordinalNumber(_+1,{unit:"month"});case"MMM":return d.month(_,{width:"abbreviated",context:"formatting"});case"MMMMM":return d.month(_,{width:"narrow",context:"formatting"});case"MMMM":default:return d.month(_,{width:"wide",context:"formatting"})}},L:function(n,s,d){const _=n.getMonth();switch(s){case"L":return String(_+1);case"LL":return hr(_+1,2);case"Lo":return d.ordinalNumber(_+1,{unit:"month"});case"LLL":return d.month(_,{width:"abbreviated",context:"standalone"});case"LLLLL":return d.month(_,{width:"narrow",context:"standalone"});case"LLLL":default:return d.month(_,{width:"wide",context:"standalone"})}},w:function(n,s,d,_){const w=Qz(n,_);return s==="wo"?d.ordinalNumber(w,{unit:"week"}):hr(w,s.length)},I:function(n,s,d){const _=Yz(n);return s==="Io"?d.ordinalNumber(_,{unit:"week"}):hr(_,s.length)},d:function(n,s,d){return s==="do"?d.ordinalNumber(n.getDate(),{unit:"date"}):_s.d(n,s)},D:function(n,s,d){const _=Kz(n);return s==="Do"?d.ordinalNumber(_,{unit:"dayOfYear"}):hr(_,s.length)},E:function(n,s,d){const _=n.getDay();switch(s){case"E":case"EE":case"EEE":return d.day(_,{width:"abbreviated",context:"formatting"});case"EEEEE":return d.day(_,{width:"narrow",context:"formatting"});case"EEEEEE":return d.day(_,{width:"short",context:"formatting"});case"EEEE":default:return d.day(_,{width:"wide",context:"formatting"})}},e:function(n,s,d,_){const w=n.getDay(),P=(w-_.weekStartsOn+8)%7||7;switch(s){case"e":return String(P);case"ee":return hr(P,2);case"eo":return d.ordinalNumber(P,{unit:"day"});case"eee":return d.day(w,{width:"abbreviated",context:"formatting"});case"eeeee":return d.day(w,{width:"narrow",context:"formatting"});case"eeeeee":return d.day(w,{width:"short",context:"formatting"});case"eeee":default:return d.day(w,{width:"wide",context:"formatting"})}},c:function(n,s,d,_){const w=n.getDay(),P=(w-_.weekStartsOn+8)%7||7;switch(s){case"c":return String(P);case"cc":return hr(P,s.length);case"co":return d.ordinalNumber(P,{unit:"day"});case"ccc":return d.day(w,{width:"abbreviated",context:"standalone"});case"ccccc":return d.day(w,{width:"narrow",context:"standalone"});case"cccccc":return d.day(w,{width:"short",context:"standalone"});case"cccc":default:return d.day(w,{width:"wide",context:"standalone"})}},i:function(n,s,d){const _=n.getDay(),w=_===0?7:_;switch(s){case"i":return String(w);case"ii":return hr(w,s.length);case"io":return d.ordinalNumber(w,{unit:"day"});case"iii":return d.day(_,{width:"abbreviated",context:"formatting"});case"iiiii":return d.day(_,{width:"narrow",context:"formatting"});case"iiiiii":return d.day(_,{width:"short",context:"formatting"});case"iiii":default:return d.day(_,{width:"wide",context:"formatting"})}},a:function(n,s,d){const w=n.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return d.dayPeriod(w,{width:"abbreviated",context:"formatting"});case"aaa":return d.dayPeriod(w,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return d.dayPeriod(w,{width:"narrow",context:"formatting"});case"aaaa":default:return d.dayPeriod(w,{width:"wide",context:"formatting"})}},b:function(n,s,d){const _=n.getHours();let w;switch(_===12?w=Tl.noon:_===0?w=Tl.midnight:w=_/12>=1?"pm":"am",s){case"b":case"bb":return d.dayPeriod(w,{width:"abbreviated",context:"formatting"});case"bbb":return d.dayPeriod(w,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return d.dayPeriod(w,{width:"narrow",context:"formatting"});case"bbbb":default:return d.dayPeriod(w,{width:"wide",context:"formatting"})}},B:function(n,s,d){const _=n.getHours();let w;switch(_>=17?w=Tl.evening:_>=12?w=Tl.afternoon:_>=4?w=Tl.morning:w=Tl.night,s){case"B":case"BB":case"BBB":return d.dayPeriod(w,{width:"abbreviated",context:"formatting"});case"BBBBB":return d.dayPeriod(w,{width:"narrow",context:"formatting"});case"BBBB":default:return d.dayPeriod(w,{width:"wide",context:"formatting"})}},h:function(n,s,d){if(s==="ho"){let _=n.getHours()%12;return _===0&&(_=12),d.ordinalNumber(_,{unit:"hour"})}return _s.h(n,s)},H:function(n,s,d){return s==="Ho"?d.ordinalNumber(n.getHours(),{unit:"hour"}):_s.H(n,s)},K:function(n,s,d){const _=n.getHours()%12;return s==="Ko"?d.ordinalNumber(_,{unit:"hour"}):hr(_,s.length)},k:function(n,s,d){let _=n.getHours();return _===0&&(_=24),s==="ko"?d.ordinalNumber(_,{unit:"hour"}):hr(_,s.length)},m:function(n,s,d){return s==="mo"?d.ordinalNumber(n.getMinutes(),{unit:"minute"}):_s.m(n,s)},s:function(n,s,d){return s==="so"?d.ordinalNumber(n.getSeconds(),{unit:"second"}):_s.s(n,s)},S:function(n,s){return _s.S(n,s)},X:function(n,s,d){const _=n.getTimezoneOffset();if(_===0)return"Z";switch(s){case"X":return py(_);case"XXXX":case"XX":return la(_);case"XXXXX":case"XXX":default:return la(_,":")}},x:function(n,s,d){const _=n.getTimezoneOffset();switch(s){case"x":return py(_);case"xxxx":case"xx":return la(_);case"xxxxx":case"xxx":default:return la(_,":")}},O:function(n,s,d){const _=n.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+fy(_,":");case"OOOO":default:return"GMT"+la(_,":")}},z:function(n,s,d){const _=n.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+fy(_,":");case"zzzz":default:return"GMT"+la(_,":")}},t:function(n,s,d){const _=Math.trunc(+n/1e3);return hr(_,s.length)},T:function(n,s,d){return hr(+n,s.length)}};function fy(n,s=""){const d=n>0?"-":"+",_=Math.abs(n),w=Math.trunc(_/60),P=_%60;return P===0?d+String(w):d+String(w)+s+hr(P,2)}function py(n,s){return n%60===0?(n>0?"-":"+")+hr(Math.abs(n)/60,2):la(n,s)}function la(n,s=""){const d=n>0?"-":"+",_=Math.abs(n),w=hr(Math.trunc(_/60),2),P=hr(_%60,2);return d+w+s+P}const my=(n,s)=>{switch(n){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},lv=(n,s)=>{switch(n){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},eR=(n,s)=>{const d=n.match(/(P+)(p+)?/)||[],_=d[1],w=d[2];if(!w)return my(n,s);let P;switch(_){case"P":P=s.dateTime({width:"short"});break;case"PP":P=s.dateTime({width:"medium"});break;case"PPP":P=s.dateTime({width:"long"});break;case"PPPP":default:P=s.dateTime({width:"full"});break}return P.replace("{{date}}",my(_,s)).replace("{{time}}",lv(w,s))},tR={p:lv,P:eR},rR=/^D+$/,oR=/^Y+$/,iR=["D","DD","YY","YYYY"];function nR(n){return rR.test(n)}function sR(n){return oR.test(n)}function aR(n,s,d){const _=lR(n,s,d);if(console.warn(_),iR.includes(n))throw new RangeError(_)}function lR(n,s,d){const _=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${s}\`) for formatting ${_} to the input \`${d}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const cR=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,uR=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,hR=/^'([^]*?)'?$/,dR=/''/g,fR=/[a-zA-Z]/;function pR(n,s,d){var V,H,K,G;const _=$d(),w=_.locale??Xz,P=_.firstWeekContainsDate??((H=(V=_.locale)==null?void 0:V.options)==null?void 0:H.firstWeekContainsDate)??1,b=_.weekStartsOn??((G=(K=_.locale)==null?void 0:K.options)==null?void 0:G.weekStartsOn)??0,c=Ki(n,d==null?void 0:d.in);if(!mz(c))throw new RangeError("Invalid time value");let R=s.match(uR).map(fe=>{const Be=fe[0];if(Be==="p"||Be==="P"){const et=tR[Be];return et(fe,w.formatLong)}return fe}).join("").match(cR).map(fe=>{if(fe==="''")return{isToken:!1,value:"'"};const Be=fe[0];if(Be==="'")return{isToken:!1,value:mR(fe)};if(dy[Be])return{isToken:!0,value:fe};if(Be.match(fR))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Be+"`");return{isToken:!1,value:fe}});w.localize.preprocessor&&(R=w.localize.preprocessor(c,R));const Z={firstWeekContainsDate:P,weekStartsOn:b,locale:w};return R.map(fe=>{if(!fe.isToken)return fe.value;const Be=fe.value;(sR(Be)||nR(Be))&&aR(Be,s,String(n));const et=dy[Be[0]];return et(c,Be,w.localize,Z)}).join("")}function mR(n){const s=n.match(hR);return s?s[1].replace(dR,"'"):n}const gR={key:0,class:"time-picker"},_R=["disabled"],yR={class:"date-display"},vR=["disabled"],bR={__name:"DateNavigator",setup(n){const s=Q0(),d=No(0),_=$n(()=>{var K;const H=s.activeTimeLayer;return H?((K=s.timeLayerDates[H])==null?void 0:K.value)||[]:[]}),w=$n(()=>{const H=s.activeTimeLayer,K=H&&s.getLayerById(H);return K?K.dateFormat:"yyyy-MM-dd HH:mm"});console.log(w);const P=$n(()=>_.value[d.value]||""),b=$n(()=>pR(new Date(P.value),w.value)),c=$n(()=>d.value>=_.value.length-1),R=$n(()=>d.value<=0),Z=()=>{c.value||(d.value++,s.setSelectedTimeLayerDate(s.activeTimeLayer,P.value))},V=()=>{R.value||(d.value--,s.setSelectedTimeLayerDate(s.activeTimeLayer,P.value))};return ki(_,H=>{H.length?(d.value=0,s.setSelectedTimeLayerDate(s.activeTimeLayer,P.value)):d.value=0}),(H,K)=>_.value.length?(pi(),fa("div",gR,[So("button",{onClick:V,disabled:R.value,class:"nav-button"},"",8,_R),So("span",yR,Gp(b.value),1),So("button",{onClick:Z,disabled:c.value,class:"nav-button"},"",8,vR)])):Dd("",!0)}},xR=dm(bR,[["__scopeId","data-v-62956c2e"]]),wR={class:"basemap-control"},CR={class:"fixed-layer-control"},SR={class:"date-navigator-control"},TR={__name:"Map",props:{mapSettingsUrl:{type:String,required:!0},initialBounds:{type:String,required:!1}},setup(n){const s=n,d=Q0(),_=Tx(null),w=No();let P=No([]),b;const c=async()=>(await fetch(s.mapSettingsUrl)).json(),R=async()=>{const ye={container:_.value,style:"https://tiles.basemaps.cartocdn.com/gl/voyager-gl-style/style.json",center:[0,0],zoom:4,scrollZoom:!1};if(s.initialBounds)try{const Ae=JSON.parse(s.initialBounds);ye.bounds=[[Ae[0],Ae[1]],[Ae[2],Ae[3]]],ye.fitBoundsOptions={padding:20}}catch(Ae){console.error("Error parsing initial bounds",Ae)}b=new d5.Map(ye),b.on("load",async()=>{const Ae=await c();Z(Ae)})},Z=ye=>{const{boundaryTilesUrl:Ae,showWarningsLayer:Ye,capGeojsonUrl:nt,showLocationForecastLayer:rt,locationForecastDateDisplayFormat:Xe,homeForecastDataUrl:mt,weatherIconsUrl:kt,forecastClusterConfig:ot}=ye;V(Ae),Ye&&(d.updateLayerState("weather-warnings",!0),H(nt)),rt&&(d.updateLayerState("weather-forecast",!0),d.setWeatherForecastLayerDateFormat(Xe),K(mt,kt,ot))},V=ye=>{b.addSource("admin-boundary-source",{type:"vector",tiles:[ye]}),b.addLayer({id:"admin-boundary-fill",type:"fill",source:"admin-boundary-source","source-layer":"default",filter:["==","level",0],paint:{"fill-color":"#fff","fill-opacity":0}}),b.addLayer({id:"admin-boundary-line",type:"line",source:"admin-boundary-source","source-layer":"default",filter:["==","level",0],paint:{"line-color":"#C0FF24","line-width":1,"line-offset":1}}),b.addLayer({id:"admin-boundary-line-2",type:"line",source:"admin-boundary-source","source-layer":"default",filter:["==","level",0],paint:{"line-color":"#000","line-width":1.5}})},H=ye=>{fetch(ye).then(Ae=>Ae.json()).then(Ae=>{if(Ae.features.length>0){const Ye=f5(Ae);b.fitBounds(Ye,{padding:50}),b.addSource("weather-warnings",{type:"geojson",data:Ae}),b.addLayer({id:"weather-warnings",type:"fill",source:"weather-warnings",paint:{"fill-color":["case",["==",["get","severity"],"Extreme"],"#d72f2a",["==",["get","severity"],"Severe"],"#f89904",["==",["get","severity"],"Moderate"],"#e4e616",["==",["get","severity"],"Minor"],"#53ffff",["==",["get","severity"],"Unknown"],"#3366ff","black"],"fill-opacity":.7,"fill-outline-color":"#000"}}),d.updateLayerVisibility("weather-warnings",!0)}})},K=(ye,Ae,Ye)=>{b.addSource("weather-forecast",{type:"geojson",data:{type:"FeatureCollection",features:[]},...Ye}),b.addLayer({id:"weather-forecast",type:"symbol",layout:{"icon-image":["get","condition"],"icon-size":.3,"icon-allow-overlap":!0},source:"weather-forecast"}),fetch(ye).then(nt=>nt.json()).then(nt=>{G(Ae),fe(nt);const{data:rt}=nt;rt&&rt.length&&d.updateLayerVisibility("weather-forecast",!0)})},G=ye=>{fetch(ye).then(Ae=>Ae.json()).then(Ae=>{Ae&&Array.isArray(Ae)&&Ae.forEach(Ye=>{b.loadImage(Ye.url).then(nt=>{b.addImage(Ye.id,nt.data)})})})},fe=ye=>{const{multi_period:Ae,data:Ye}=ye;P.value=Ye;const nt=new Date,rt=Ye.reduce((Xe,mt)=>{const kt=new Date(mt.datetime);return Ae&&kt.toDateString()===nt.toDateString()&&kt.getHours()<nt.getHours()||Xe.push(mt.datetime),Xe},[]);d.setActiveTimeLayer("weather-forecast"),d.setTimeLayerDates("weather-forecast",rt)},Be=ye=>{const Ae=P.value.find(Ye=>Ye.datetime===ye);Ae&&b.getSource("weather-forecast").setData(Ae)},et=()=>b==null?void 0:b.zoomIn(),We=()=>b==null?void 0:b.zoomOut(),lt=ye=>{w.value.toggle(ye)},st=({layerId:ye,visible:Ae})=>{d.updateLayerVisibility(ye,Ae);const Ye=d.getLayerById(ye),nt=b.getLayer(ye);nt&&b.setLayoutProperty(nt.id,"visibility",Ae?"visible":"none"),Ye.multiTemporal&&(Ae?d.setActiveTimeLayer(ye):d.setActiveTimeLayer(null))};return ki(d.selectedTimeLayerDate,ye=>{if(ye[d.activeTimeLayer]){const Ae=ye[d.activeTimeLayer];d.activeTimeLayer==="weather-forecast"&&Be(Ae)}}),Ad(()=>R()),om(()=>b==null?void 0:b.remove()),(ye,Ae)=>(pi(),fa(ti,null,[So("div",{ref_key:"mapContainer",ref:_,class:"map-container"},null,512),So("div",{class:"zoom-controls"},[So("button",{onClick:et},"+"),So("button",{onClick:We},"")]),So("div",wR,[So("div",{class:"basemap-icon icon",onClick:lt},Ae[0]||(Ae[0]=[So("svg",null,[So("use",{"xlink:href":"#icon-layer-group"})],-1)])),Io(Cp(iv),{ref_key:"basemapChooserRef",ref:w},{default:fd(()=>Ae[1]||(Ae[1]=[I0(" Hello ")])),_:1},512)]),So("div",CR,[(pi(!0),fa(ti,null,nw(Cp(d).sortedFixedLayers,Ye=>(pi(),pa(lz,{key:Ye.id,title:Ye.title,enabled:Ye.enabled,visible:Ye.visible,"home-map-layer-type":Ye.homeMapLayerType,position:Ye.position,id:Ye.id,icon:Ye.icon,"onUpdate:toggleLayer":st},null,8,["title","enabled","visible","home-map-layer-type","position","id","icon"]))),128))]),So("div",SR,[Io(xR)])],64))}},kR=dm(TR,[["__scopeId","data-v-029e037c"]]),gy={__name:"HomeMap",props:{mapSettingsUrl:{type:String,required:!0},cityDetailUrl:{type:String,required:!1},initialBounds:{type:String,required:!1}},setup(n){return(s,d)=>(pi(),pa(kR,{initialBounds:n.initialBounds,mapSettingsUrl:n.mapSettingsUrl},null,8,["initialBounds","mapSettingsUrl"]))}},PR=P1(),id=document.getElementById("home-map");if(id){const n=S1(gy,L1({dataset:{...id.dataset},component:gy}));n.use(U2,{theme:{preset:a5}}),n.use(PR),n.use(B1,{rootElement:id}),n.mount(id)}
